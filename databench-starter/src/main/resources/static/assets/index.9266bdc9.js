var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,a=(e,t)=>{for(var n in t||(t={}))r.call(t,n)&&s(e,n,t[n]);if(i)for(var n of i(t))o.call(t,n)&&s(e,n,t[n]);return e},l=(e,i)=>t(e,n(i)),c=(e,t)=>{var n={};for(var s in e)r.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&i)for(var s of i(e))t.indexOf(s)<0&&o.call(e,s)&&(n[s]=e[s]);return n},u=(e,t,n)=>(s(e,"symbol"!=typeof t?t+"":t,n),n);import{h,R as d,c as f,M as g,i as p,p as m,j as v,k as y,n as _,q as b,s as w,T as C,D as S,t as x,v as E,w as k,x as L,y as D,A as N,z as I,I as T,m as M,B as A,F as O,C as R,_ as P,E as F,G as B,J as W,K as z,L as V,N as U,O as H,Q as j,S as G,U as K,V as q,W as $,X as Y,u as X,b as Z}from"./vendor.144db54d.js";import{n as Q,c as J,i as ee,a as te,d as ne,b as ie,e as re,f as oe,m as se,g as ae,r as le,h as ce,j as ue,k as he,l as de,o as fe,p as ge}from"./index.914a4512.js";function pe(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var me=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return Uv},get Circle(){return Hv},get Ellipse(){return Gv},get Image(){return qv},get Line(){return Yv},get Marker(){return Zv},get Path(){return sy},get Polygon(){return ly},get Polyline(){return cy},get Rect(){return uy},get Text(){return hy}},Symbol.toStringTag,{value:"Module"})),ve=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return ky},get Circle(){return Ly},get Dom(){return Dy},get Ellipse(){return Ny},get Image(){return Iy},get Line(){return Ty},get Marker(){return Oy},get Path(){return Ry},get Polygon(){return Py},get Polyline(){return Fy},get Rect(){return By},get Text(){return Uy}},Symbol.toStringTag,{value:"Module"}));const ye=e=>{const{position:t="bottom"}=e,[n,i]=h.exports.useState(!1);return d.createElement("div",{className:f("tool-tip-container",t),onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1)},d.createElement("div",{className:"content"},e.children),n&&d.createElement("div",{className:f("tip",t)},e.tip))},_e=e=>{const t=e,{className:n,type:i,style:r,tip:o,onClick:s}=t,u=c(t,["className","type","style","tip","onClick"]),h=()=>d.createElement("svg",l(a({onClick:s,style:a({width:"1em",height:"1em",verticalAlign:"-0.15em",fill:"currentColor",overflow:"hidden"},r),className:f("icon",n)},u),{"aria-hidden":"true"}),d.createElement("use",{xlinkHref:`#databench-icon-${i}`}));return o?d.createElement(ye,{tip:o},h()):d.createElement(d.Fragment,null,h())};function be(e){const t=h.exports.useContext(g),{stores:n}=t;return e?n[e]:n}var we=p((e=>{const{uiStore:t,dataStore:n}=be("BenchStore");return d.createElement(d.Fragment,null,d.createElement("div",{className:f(e.className)},d.createElement("div",{className:"footer-container "},d.createElement("div",{className:"footer-item px-14 green",onClick:t.toggleTheme},d.createElement(_e,{type:"theme"})),d.createElement("div",{className:"footer-item"},d.createElement(_e,{type:"user"}),d.createElement("div",{className:"ml-4"},"测试用户")),d.createElement("div",{className:"footer-item"},d.createElement(_e,{type:"workspace2"}),d.createElement("div",{className:"ml-4"},n.workspaceData.description)),d.createElement("div",{className:"footer-item",onClick:()=>{t.toggleWindowFooterVisible()}},d.createElement(_e,{type:"log"}),d.createElement("div",{className:"ml-4"},"控制台")))))}));const Ce={dashboard:{name:"dashboard",label:"仪表盘"},development:{name:"development",label:"数据开发",icon:"code"},operation:{name:"operation",label:"作业运维"},query:{name:"query",label:"临时查询",color:"text-purple-400",icon:"search"},resource:{name:"resource",label:"资源",icon:"resource4"},component:{name:"component",label:"数据组件"},meta:{name:"meta",label:"元数据",icon:"table"},document:{name:"document",label:"文档"},trash:{name:"trash",label:"回收站",color:"text-red-400"},history:{name:"history",label:"历史记录"},approval:{name:"approval",label:"审批"},setting:{name:"setting",label:"设置"},"":{name:"",label:"关闭"}};var Se,xe,Ee,ke=e=>{const{activeMenu:t,chooseMenu:n}=e,i=e=>f("nav-item",{active:t===e}),r=Object.keys(Ce).filter((e=>""!==e)).map((e=>Ce[e]));return d.createElement(d.Fragment,null,d.createElement("nav",{className:f(e.className,"nav")},r.map((e=>d.createElement(ye,{position:"right",tip:e.label,key:e.name},d.createElement("div",{className:i(e.name),onClick:()=>n(e.name)},d.createElement(_e,{type:e.icon||e.name})))))))},Le={exports:{}};Se=Le,xe=["alignContent","MozAlignContent","WebkitAlignContent","MSAlignContent","OAlignContent","alignItems","MozAlignItems","WebkitAlignItems","MSAlignItems","OAlignItems","alignSelf","MozAlignSelf","WebkitAlignSelf","MSAlignSelf","OAlignSelf","all","MozAll","WebkitAll","MSAll","OAll","animation","MozAnimation","WebkitAnimation","MSAnimation","OAnimation","animationDelay","MozAnimationDelay","WebkitAnimationDelay","MSAnimationDelay","OAnimationDelay","animationDirection","MozAnimationDirection","WebkitAnimationDirection","MSAnimationDirection","OAnimationDirection","animationDuration","MozAnimationDuration","WebkitAnimationDuration","MSAnimationDuration","OAnimationDuration","animationFillMode","MozAnimationFillMode","WebkitAnimationFillMode","MSAnimationFillMode","OAnimationFillMode","animationIterationCount","MozAnimationIterationCount","WebkitAnimationIterationCount","MSAnimationIterationCount","OAnimationIterationCount","animationName","MozAnimationName","WebkitAnimationName","MSAnimationName","OAnimationName","animationPlayState","MozAnimationPlayState","WebkitAnimationPlayState","MSAnimationPlayState","OAnimationPlayState","animationTimingFunction","MozAnimationTimingFunction","WebkitAnimationTimingFunction","MSAnimationTimingFunction","OAnimationTimingFunction","backfaceVisibility","MozBackfaceVisibility","WebkitBackfaceVisibility","MSBackfaceVisibility","OBackfaceVisibility","background","MozBackground","WebkitBackground","MSBackground","OBackground","backgroundAttachment","MozBackgroundAttachment","WebkitBackgroundAttachment","MSBackgroundAttachment","OBackgroundAttachment","backgroundBlendMode","MozBackgroundBlendMode","WebkitBackgroundBlendMode","MSBackgroundBlendMode","OBackgroundBlendMode","backgroundClip","MozBackgroundClip","WebkitBackgroundClip","MSBackgroundClip","OBackgroundClip","backgroundColor","MozBackgroundColor","WebkitBackgroundColor","MSBackgroundColor","OBackgroundColor","backgroundImage","MozBackgroundImage","WebkitBackgroundImage","MSBackgroundImage","OBackgroundImage","backgroundOrigin","MozBackgroundOrigin","WebkitBackgroundOrigin","MSBackgroundOrigin","OBackgroundOrigin","backgroundPosition","MozBackgroundPosition","WebkitBackgroundPosition","MSBackgroundPosition","OBackgroundPosition","backgroundRepeat","MozBackgroundRepeat","WebkitBackgroundRepeat","MSBackgroundRepeat","OBackgroundRepeat","backgroundSize","MozBackgroundSize","WebkitBackgroundSize","MSBackgroundSize","OBackgroundSize","blockSize","MozBlockSize","WebkitBlockSize","MSBlockSize","OBlockSize","border","MozBorder","WebkitBorder","MSBorder","OBorder","borderBlockEnd","MozBorderBlockEnd","WebkitBorderBlockEnd","MSBorderBlockEnd","OBorderBlockEnd","borderBlockEndColor","MozBorderBlockEndColor","WebkitBorderBlockEndColor","MSBorderBlockEndColor","OBorderBlockEndColor","borderBlockEndStyle","MozBorderBlockEndStyle","WebkitBorderBlockEndStyle","MSBorderBlockEndStyle","OBorderBlockEndStyle","borderBlockEndWidth","MozBorderBlockEndWidth","WebkitBorderBlockEndWidth","MSBorderBlockEndWidth","OBorderBlockEndWidth","borderBlockStart","MozBorderBlockStart","WebkitBorderBlockStart","MSBorderBlockStart","OBorderBlockStart","borderBlockStartColor","MozBorderBlockStartColor","WebkitBorderBlockStartColor","MSBorderBlockStartColor","OBorderBlockStartColor","borderBlockStartStyle","MozBorderBlockStartStyle","WebkitBorderBlockStartStyle","MSBorderBlockStartStyle","OBorderBlockStartStyle","borderBlockStartWidth","MozBorderBlockStartWidth","WebkitBorderBlockStartWidth","MSBorderBlockStartWidth","OBorderBlockStartWidth","borderBottom","MozBorderBottom","WebkitBorderBottom","MSBorderBottom","OBorderBottom","borderBottomColor","MozBorderBottomColor","WebkitBorderBottomColor","MSBorderBottomColor","OBorderBottomColor","borderBottomLeftRadius","MozBorderBottomLeftRadius","WebkitBorderBottomLeftRadius","MSBorderBottomLeftRadius","OBorderBottomLeftRadius","borderBottomRightRadius","MozBorderBottomRightRadius","WebkitBorderBottomRightRadius","MSBorderBottomRightRadius","OBorderBottomRightRadius","borderBottomStyle","MozBorderBottomStyle","WebkitBorderBottomStyle","MSBorderBottomStyle","OBorderBottomStyle","borderBottomWidth","MozBorderBottomWidth","WebkitBorderBottomWidth","MSBorderBottomWidth","OBorderBottomWidth","borderCollapse","MozBorderCollapse","WebkitBorderCollapse","MSBorderCollapse","OBorderCollapse","borderColor","MozBorderColor","WebkitBorderColor","MSBorderColor","OBorderColor","borderImage","MozBorderImage","WebkitBorderImage","MSBorderImage","OBorderImage","borderImageOutset","MozBorderImageOutset","WebkitBorderImageOutset","MSBorderImageOutset","OBorderImageOutset","borderImageRepeat","MozBorderImageRepeat","WebkitBorderImageRepeat","MSBorderImageRepeat","OBorderImageRepeat","borderImageSlice","MozBorderImageSlice","WebkitBorderImageSlice","MSBorderImageSlice","OBorderImageSlice","borderImageSource","MozBorderImageSource","WebkitBorderImageSource","MSBorderImageSource","OBorderImageSource","borderImageWidth","MozBorderImageWidth","WebkitBorderImageWidth","MSBorderImageWidth","OBorderImageWidth","borderInlineEnd","MozBorderInlineEnd","WebkitBorderInlineEnd","MSBorderInlineEnd","OBorderInlineEnd","borderInlineEndColor","MozBorderInlineEndColor","WebkitBorderInlineEndColor","MSBorderInlineEndColor","OBorderInlineEndColor","borderInlineEndStyle","MozBorderInlineEndStyle","WebkitBorderInlineEndStyle","MSBorderInlineEndStyle","OBorderInlineEndStyle","borderInlineEndWidth","MozBorderInlineEndWidth","WebkitBorderInlineEndWidth","MSBorderInlineEndWidth","OBorderInlineEndWidth","borderInlineStart","MozBorderInlineStart","WebkitBorderInlineStart","MSBorderInlineStart","OBorderInlineStart","borderInlineStartColor","MozBorderInlineStartColor","WebkitBorderInlineStartColor","MSBorderInlineStartColor","OBorderInlineStartColor","borderInlineStartStyle","MozBorderInlineStartStyle","WebkitBorderInlineStartStyle","MSBorderInlineStartStyle","OBorderInlineStartStyle","borderInlineStartWidth","MozBorderInlineStartWidth","WebkitBorderInlineStartWidth","MSBorderInlineStartWidth","OBorderInlineStartWidth","borderLeft","MozBorderLeft","WebkitBorderLeft","MSBorderLeft","OBorderLeft","borderLeftColor","MozBorderLeftColor","WebkitBorderLeftColor","MSBorderLeftColor","OBorderLeftColor","borderLeftStyle","MozBorderLeftStyle","WebkitBorderLeftStyle","MSBorderLeftStyle","OBorderLeftStyle","borderLeftWidth","MozBorderLeftWidth","WebkitBorderLeftWidth","MSBorderLeftWidth","OBorderLeftWidth","borderRadius","MozBorderRadius","WebkitBorderRadius","MSBorderRadius","OBorderRadius","borderRight","MozBorderRight","WebkitBorderRight","MSBorderRight","OBorderRight","borderRightColor","MozBorderRightColor","WebkitBorderRightColor","MSBorderRightColor","OBorderRightColor","borderRightStyle","MozBorderRightStyle","WebkitBorderRightStyle","MSBorderRightStyle","OBorderRightStyle","borderRightWidth","MozBorderRightWidth","WebkitBorderRightWidth","MSBorderRightWidth","OBorderRightWidth","borderSpacing","MozBorderSpacing","WebkitBorderSpacing","MSBorderSpacing","OBorderSpacing","borderStyle","MozBorderStyle","WebkitBorderStyle","MSBorderStyle","OBorderStyle","borderTop","MozBorderTop","WebkitBorderTop","MSBorderTop","OBorderTop","borderTopColor","MozBorderTopColor","WebkitBorderTopColor","MSBorderTopColor","OBorderTopColor","borderTopLeftRadius","MozBorderTopLeftRadius","WebkitBorderTopLeftRadius","MSBorderTopLeftRadius","OBorderTopLeftRadius","borderTopRightRadius","MozBorderTopRightRadius","WebkitBorderTopRightRadius","MSBorderTopRightRadius","OBorderTopRightRadius","borderTopStyle","MozBorderTopStyle","WebkitBorderTopStyle","MSBorderTopStyle","OBorderTopStyle","borderTopWidth","MozBorderTopWidth","WebkitBorderTopWidth","MSBorderTopWidth","OBorderTopWidth","borderWidth","MozBorderWidth","WebkitBorderWidth","MSBorderWidth","OBorderWidth","bottom","MozBottom","WebkitBottom","MSBottom","OBottom","boxDecorationBreak","MozBoxDecorationBreak","WebkitBoxDecorationBreak","MSBoxDecorationBreak","OBoxDecorationBreak","boxShadow","MozBoxShadow","WebkitBoxShadow","MSBoxShadow","OBoxShadow","boxSizing","MozBoxSizing","WebkitBoxSizing","MSBoxSizing","OBoxSizing","breakAfter","MozBreakAfter","WebkitBreakAfter","MSBreakAfter","OBreakAfter","breakBefore","MozBreakBefore","WebkitBreakBefore","MSBreakBefore","OBreakBefore","breakInside","MozBreakInside","WebkitBreakInside","MSBreakInside","OBreakInside","captionSide","MozCaptionSide","WebkitCaptionSide","MSCaptionSide","OCaptionSide","caretColor","MozCaretColor","WebkitCaretColor","MSCaretColor","OCaretColor","ch","MozCh","WebkitCh","MSCh","OCh","clear","MozClear","WebkitClear","MSClear","OClear","clip","MozClip","WebkitClip","MSClip","OClip","clipPath","MozClipPath","WebkitClipPath","MSClipPath","OClipPath","cm","MozCm","WebkitCm","MSCm","OCm","color","MozColor","WebkitColor","MSColor","OColor","columnCount","MozColumnCount","WebkitColumnCount","MSColumnCount","OColumnCount","columnFill","MozColumnFill","WebkitColumnFill","MSColumnFill","OColumnFill","columnGap","MozColumnGap","WebkitColumnGap","MSColumnGap","OColumnGap","columnRule","MozColumnRule","WebkitColumnRule","MSColumnRule","OColumnRule","columnRuleColor","MozColumnRuleColor","WebkitColumnRuleColor","MSColumnRuleColor","OColumnRuleColor","columnRuleStyle","MozColumnRuleStyle","WebkitColumnRuleStyle","MSColumnRuleStyle","OColumnRuleStyle","columnRuleWidth","MozColumnRuleWidth","WebkitColumnRuleWidth","MSColumnRuleWidth","OColumnRuleWidth","columnSpan","MozColumnSpan","WebkitColumnSpan","MSColumnSpan","OColumnSpan","columnWidth","MozColumnWidth","WebkitColumnWidth","MSColumnWidth","OColumnWidth","columns","MozColumns","WebkitColumns","MSColumns","OColumns","content","MozContent","WebkitContent","MSContent","OContent","counterIncrement","MozCounterIncrement","WebkitCounterIncrement","MSCounterIncrement","OCounterIncrement","counterReset","MozCounterReset","WebkitCounterReset","MSCounterReset","OCounterReset","cursor","MozCursor","WebkitCursor","MSCursor","OCursor","deg","MozDeg","WebkitDeg","MSDeg","ODeg","direction","MozDirection","WebkitDirection","MSDirection","ODirection","display","MozDisplay","WebkitDisplay","MSDisplay","ODisplay","dpcm","MozDpcm","WebkitDpcm","MSDpcm","ODpcm","dpi","MozDpi","WebkitDpi","MSDpi","ODpi","dppx","MozDppx","WebkitDppx","MSDppx","ODppx","em","MozEm","WebkitEm","MSEm","OEm","emptyCells","MozEmptyCells","WebkitEmptyCells","MSEmptyCells","OEmptyCells","ex","MozEx","WebkitEx","MSEx","OEx","filter","MozFilter","WebkitFilter","MSFilter","OFilter","flexBasis","MozFlexBasis","WebkitFlexBasis","MSFlexBasis","OFlexBasis","flexDirection","MozFlexDirection","WebkitFlexDirection","MSFlexDirection","OFlexDirection","flexFlow","MozFlexFlow","WebkitFlexFlow","MSFlexFlow","OFlexFlow","flexGrow","MozFlexGrow","WebkitFlexGrow","MSFlexGrow","OFlexGrow","flexShrink","MozFlexShrink","WebkitFlexShrink","MSFlexShrink","OFlexShrink","flexWrap","MozFlexWrap","WebkitFlexWrap","MSFlexWrap","OFlexWrap","float","MozFloat","WebkitFloat","MSFloat","OFloat","font","MozFont","WebkitFont","MSFont","OFont","fontFamily","MozFontFamily","WebkitFontFamily","MSFontFamily","OFontFamily","fontFeatureSettings","MozFontFeatureSettings","WebkitFontFeatureSettings","MSFontFeatureSettings","OFontFeatureSettings","fontKerning","MozFontKerning","WebkitFontKerning","MSFontKerning","OFontKerning","fontLanguageOverride","MozFontLanguageOverride","WebkitFontLanguageOverride","MSFontLanguageOverride","OFontLanguageOverride","fontSize","MozFontSize","WebkitFontSize","MSFontSize","OFontSize","fontSizeAdjust","MozFontSizeAdjust","WebkitFontSizeAdjust","MSFontSizeAdjust","OFontSizeAdjust","fontStretch","MozFontStretch","WebkitFontStretch","MSFontStretch","OFontStretch","fontStyle","MozFontStyle","WebkitFontStyle","MSFontStyle","OFontStyle","fontSynthesis","MozFontSynthesis","WebkitFontSynthesis","MSFontSynthesis","OFontSynthesis","fontVariant","MozFontVariant","WebkitFontVariant","MSFontVariant","OFontVariant","fontVariantAlternates","MozFontVariantAlternates","WebkitFontVariantAlternates","MSFontVariantAlternates","OFontVariantAlternates","fontVariantCaps","MozFontVariantCaps","WebkitFontVariantCaps","MSFontVariantCaps","OFontVariantCaps","fontVariantEastAsian","MozFontVariantEastAsian","WebkitFontVariantEastAsian","MSFontVariantEastAsian","OFontVariantEastAsian","fontVariantLigatures","MozFontVariantLigatures","WebkitFontVariantLigatures","MSFontVariantLigatures","OFontVariantLigatures","fontVariantNumeric","MozFontVariantNumeric","WebkitFontVariantNumeric","MSFontVariantNumeric","OFontVariantNumeric","fontVariantPosition","MozFontVariantPosition","WebkitFontVariantPosition","MSFontVariantPosition","OFontVariantPosition","fontWeight","MozFontWeight","WebkitFontWeight","MSFontWeight","OFontWeight","fr","MozFr","WebkitFr","MSFr","OFr","grad","MozGrad","WebkitGrad","MSGrad","OGrad","grid","MozGrid","WebkitGrid","MSGrid","OGrid","gridArea","MozGridArea","WebkitGridArea","MSGridArea","OGridArea","gridAutoColumns","MozGridAutoColumns","WebkitGridAutoColumns","MSGridAutoColumns","OGridAutoColumns","gridAutoFlow","MozGridAutoFlow","WebkitGridAutoFlow","MSGridAutoFlow","OGridAutoFlow","gridAutoRows","MozGridAutoRows","WebkitGridAutoRows","MSGridAutoRows","OGridAutoRows","gridColumn","MozGridColumn","WebkitGridColumn","MSGridColumn","OGridColumn","gridColumnEnd","MozGridColumnEnd","WebkitGridColumnEnd","MSGridColumnEnd","OGridColumnEnd","gridColumnGap","MozGridColumnGap","WebkitGridColumnGap","MSGridColumnGap","OGridColumnGap","gridColumnStart","MozGridColumnStart","WebkitGridColumnStart","MSGridColumnStart","OGridColumnStart","gridGap","MozGridGap","WebkitGridGap","MSGridGap","OGridGap","gridRow","MozGridRow","WebkitGridRow","MSGridRow","OGridRow","gridRowEnd","MozGridRowEnd","WebkitGridRowEnd","MSGridRowEnd","OGridRowEnd","gridRowGap","MozGridRowGap","WebkitGridRowGap","MSGridRowGap","OGridRowGap","gridRowStart","MozGridRowStart","WebkitGridRowStart","MSGridRowStart","OGridRowStart","gridTemplate","MozGridTemplate","WebkitGridTemplate","MSGridTemplate","OGridTemplate","gridTemplateAreas","MozGridTemplateAreas","WebkitGridTemplateAreas","MSGridTemplateAreas","OGridTemplateAreas","gridTemplateColumns","MozGridTemplateColumns","WebkitGridTemplateColumns","MSGridTemplateColumns","OGridTemplateColumns","gridTemplateRows","MozGridTemplateRows","WebkitGridTemplateRows","MSGridTemplateRows","OGridTemplateRows","height","MozHeight","WebkitHeight","MSHeight","OHeight","hyphens","MozHyphens","WebkitHyphens","MSHyphens","OHyphens","hz","MozHz","WebkitHz","MSHz","OHz","imageOrientation","MozImageOrientation","WebkitImageOrientation","MSImageOrientation","OImageOrientation","imageRendering","MozImageRendering","WebkitImageRendering","MSImageRendering","OImageRendering","imageResolution","MozImageResolution","WebkitImageResolution","MSImageResolution","OImageResolution","imeMode","MozImeMode","WebkitImeMode","MSImeMode","OImeMode","in","MozIn","WebkitIn","MSIn","OIn","inherit","MozInherit","WebkitInherit","MSInherit","OInherit","initial","MozInitial","WebkitInitial","MSInitial","OInitial","inlineSize","MozInlineSize","WebkitInlineSize","MSInlineSize","OInlineSize","isolation","MozIsolation","WebkitIsolation","MSIsolation","OIsolation","justifyContent","MozJustifyContent","WebkitJustifyContent","MSJustifyContent","OJustifyContent","khz","MozKhz","WebkitKhz","MSKhz","OKhz","left","MozLeft","WebkitLeft","MSLeft","OLeft","letterSpacing","MozLetterSpacing","WebkitLetterSpacing","MSLetterSpacing","OLetterSpacing","lineBreak","MozLineBreak","WebkitLineBreak","MSLineBreak","OLineBreak","lineHeight","MozLineHeight","WebkitLineHeight","MSLineHeight","OLineHeight","listStyle","MozListStyle","WebkitListStyle","MSListStyle","OListStyle","listStyleImage","MozListStyleImage","WebkitListStyleImage","MSListStyleImage","OListStyleImage","listStylePosition","MozListStylePosition","WebkitListStylePosition","MSListStylePosition","OListStylePosition","listStyleType","MozListStyleType","WebkitListStyleType","MSListStyleType","OListStyleType","margin","MozMargin","WebkitMargin","MSMargin","OMargin","marginBlockEnd","MozMarginBlockEnd","WebkitMarginBlockEnd","MSMarginBlockEnd","OMarginBlockEnd","marginBlockStart","MozMarginBlockStart","WebkitMarginBlockStart","MSMarginBlockStart","OMarginBlockStart","marginBottom","MozMarginBottom","WebkitMarginBottom","MSMarginBottom","OMarginBottom","marginInlineEnd","MozMarginInlineEnd","WebkitMarginInlineEnd","MSMarginInlineEnd","OMarginInlineEnd","marginInlineStart","MozMarginInlineStart","WebkitMarginInlineStart","MSMarginInlineStart","OMarginInlineStart","marginLeft","MozMarginLeft","WebkitMarginLeft","MSMarginLeft","OMarginLeft","marginRight","MozMarginRight","WebkitMarginRight","MSMarginRight","OMarginRight","marginTop","MozMarginTop","WebkitMarginTop","MSMarginTop","OMarginTop","mask","MozMask","WebkitMask","MSMask","OMask","maskClip","MozMaskClip","WebkitMaskClip","MSMaskClip","OMaskClip","maskComposite","MozMaskComposite","WebkitMaskComposite","MSMaskComposite","OMaskComposite","maskImage","MozMaskImage","WebkitMaskImage","MSMaskImage","OMaskImage","maskMode","MozMaskMode","WebkitMaskMode","MSMaskMode","OMaskMode","maskOrigin","MozMaskOrigin","WebkitMaskOrigin","MSMaskOrigin","OMaskOrigin","maskPosition","MozMaskPosition","WebkitMaskPosition","MSMaskPosition","OMaskPosition","maskRepeat","MozMaskRepeat","WebkitMaskRepeat","MSMaskRepeat","OMaskRepeat","maskSize","MozMaskSize","WebkitMaskSize","MSMaskSize","OMaskSize","maskType","MozMaskType","WebkitMaskType","MSMaskType","OMaskType","maxHeight","MozMaxHeight","WebkitMaxHeight","MSMaxHeight","OMaxHeight","maxWidth","MozMaxWidth","WebkitMaxWidth","MSMaxWidth","OMaxWidth","minBlockSize","MozMinBlockSize","WebkitMinBlockSize","MSMinBlockSize","OMinBlockSize","minHeight","MozMinHeight","WebkitMinHeight","MSMinHeight","OMinHeight","minInlineSize","MozMinInlineSize","WebkitMinInlineSize","MSMinInlineSize","OMinInlineSize","minWidth","MozMinWidth","WebkitMinWidth","MSMinWidth","OMinWidth","mixBlendMode","MozMixBlendMode","WebkitMixBlendMode","MSMixBlendMode","OMixBlendMode","mm","MozMm","WebkitMm","MSMm","OMm","ms","MozMs","WebkitMs","MSMs","OMs","objectFit","MozObjectFit","WebkitObjectFit","MSObjectFit","OObjectFit","objectPosition","MozObjectPosition","WebkitObjectPosition","MSObjectPosition","OObjectPosition","offsetBlockEnd","MozOffsetBlockEnd","WebkitOffsetBlockEnd","MSOffsetBlockEnd","OOffsetBlockEnd","offsetBlockStart","MozOffsetBlockStart","WebkitOffsetBlockStart","MSOffsetBlockStart","OOffsetBlockStart","offsetInlineEnd","MozOffsetInlineEnd","WebkitOffsetInlineEnd","MSOffsetInlineEnd","OOffsetInlineEnd","offsetInlineStart","MozOffsetInlineStart","WebkitOffsetInlineStart","MSOffsetInlineStart","OOffsetInlineStart","opacity","MozOpacity","WebkitOpacity","MSOpacity","OOpacity","order","MozOrder","WebkitOrder","MSOrder","OOrder","orphans","MozOrphans","WebkitOrphans","MSOrphans","OOrphans","outline","MozOutline","WebkitOutline","MSOutline","OOutline","outlineColor","MozOutlineColor","WebkitOutlineColor","MSOutlineColor","OOutlineColor","outlineOffset","MozOutlineOffset","WebkitOutlineOffset","MSOutlineOffset","OOutlineOffset","outlineStyle","MozOutlineStyle","WebkitOutlineStyle","MSOutlineStyle","OOutlineStyle","outlineWidth","MozOutlineWidth","WebkitOutlineWidth","MSOutlineWidth","OOutlineWidth","overflow","MozOverflow","WebkitOverflow","MSOverflow","OOverflow","overflowWrap","MozOverflowWrap","WebkitOverflowWrap","MSOverflowWrap","OOverflowWrap","overflowX","MozOverflowX","WebkitOverflowX","MSOverflowX","OOverflowX","overflowY","MozOverflowY","WebkitOverflowY","MSOverflowY","OOverflowY","padding","MozPadding","WebkitPadding","MSPadding","OPadding","paddingBlockEnd","MozPaddingBlockEnd","WebkitPaddingBlockEnd","MSPaddingBlockEnd","OPaddingBlockEnd","paddingBlockStart","MozPaddingBlockStart","WebkitPaddingBlockStart","MSPaddingBlockStart","OPaddingBlockStart","paddingBottom","MozPaddingBottom","WebkitPaddingBottom","MSPaddingBottom","OPaddingBottom","paddingInlineEnd","MozPaddingInlineEnd","WebkitPaddingInlineEnd","MSPaddingInlineEnd","OPaddingInlineEnd","paddingInlineStart","MozPaddingInlineStart","WebkitPaddingInlineStart","MSPaddingInlineStart","OPaddingInlineStart","paddingLeft","MozPaddingLeft","WebkitPaddingLeft","MSPaddingLeft","OPaddingLeft","paddingRight","MozPaddingRight","WebkitPaddingRight","MSPaddingRight","OPaddingRight","paddingTop","MozPaddingTop","WebkitPaddingTop","MSPaddingTop","OPaddingTop","pageBreakAfter","MozPageBreakAfter","WebkitPageBreakAfter","MSPageBreakAfter","OPageBreakAfter","pageBreakBefore","MozPageBreakBefore","WebkitPageBreakBefore","MSPageBreakBefore","OPageBreakBefore","pageBreakInside","MozPageBreakInside","WebkitPageBreakInside","MSPageBreakInside","OPageBreakInside","pc","MozPc","WebkitPc","MSPc","OPc","perspective","MozPerspective","WebkitPerspective","MSPerspective","OPerspective","perspectiveOrigin","MozPerspectiveOrigin","WebkitPerspectiveOrigin","MSPerspectiveOrigin","OPerspectiveOrigin","pointerEvents","MozPointerEvents","WebkitPointerEvents","MSPointerEvents","OPointerEvents","position","MozPosition","WebkitPosition","MSPosition","OPosition","pt","MozPt","WebkitPt","MSPt","OPt","px","MozPx","WebkitPx","MSPx","OPx","q","MozQ","WebkitQ","MSQ","OQ","quotes","MozQuotes","WebkitQuotes","MSQuotes","OQuotes","rad","MozRad","WebkitRad","MSRad","ORad","rem","MozRem","WebkitRem","MSRem","ORem","resize","MozResize","WebkitResize","MSResize","OResize","revert","MozRevert","WebkitRevert","MSRevert","ORevert","right","MozRight","WebkitRight","MSRight","ORight","rubyAlign","MozRubyAlign","WebkitRubyAlign","MSRubyAlign","ORubyAlign","rubyMerge","MozRubyMerge","WebkitRubyMerge","MSRubyMerge","ORubyMerge","rubyPosition","MozRubyPosition","WebkitRubyPosition","MSRubyPosition","ORubyPosition","s","MozS","WebkitS","MSS","OS","scrollBehavior","MozScrollBehavior","WebkitScrollBehavior","MSScrollBehavior","OScrollBehavior","scrollSnapCoordinate","MozScrollSnapCoordinate","WebkitScrollSnapCoordinate","MSScrollSnapCoordinate","OScrollSnapCoordinate","scrollSnapDestination","MozScrollSnapDestination","WebkitScrollSnapDestination","MSScrollSnapDestination","OScrollSnapDestination","scrollSnapType","MozScrollSnapType","WebkitScrollSnapType","MSScrollSnapType","OScrollSnapType","shapeImageThreshold","MozShapeImageThreshold","WebkitShapeImageThreshold","MSShapeImageThreshold","OShapeImageThreshold","shapeMargin","MozShapeMargin","WebkitShapeMargin","MSShapeMargin","OShapeMargin","shapeOutside","MozShapeOutside","WebkitShapeOutside","MSShapeOutside","OShapeOutside","tabSize","MozTabSize","WebkitTabSize","MSTabSize","OTabSize","tableLayout","MozTableLayout","WebkitTableLayout","MSTableLayout","OTableLayout","textAlign","MozTextAlign","WebkitTextAlign","MSTextAlign","OTextAlign","textAlignLast","MozTextAlignLast","WebkitTextAlignLast","MSTextAlignLast","OTextAlignLast","textCombineUpright","MozTextCombineUpright","WebkitTextCombineUpright","MSTextCombineUpright","OTextCombineUpright","textDecoration","MozTextDecoration","WebkitTextDecoration","MSTextDecoration","OTextDecoration","textDecorationColor","MozTextDecorationColor","WebkitTextDecorationColor","MSTextDecorationColor","OTextDecorationColor","textDecorationLine","MozTextDecorationLine","WebkitTextDecorationLine","MSTextDecorationLine","OTextDecorationLine","textDecorationStyle","MozTextDecorationStyle","WebkitTextDecorationStyle","MSTextDecorationStyle","OTextDecorationStyle","textEmphasis","MozTextEmphasis","WebkitTextEmphasis","MSTextEmphasis","OTextEmphasis","textEmphasisColor","MozTextEmphasisColor","WebkitTextEmphasisColor","MSTextEmphasisColor","OTextEmphasisColor","textEmphasisPosition","MozTextEmphasisPosition","WebkitTextEmphasisPosition","MSTextEmphasisPosition","OTextEmphasisPosition","textEmphasisStyle","MozTextEmphasisStyle","WebkitTextEmphasisStyle","MSTextEmphasisStyle","OTextEmphasisStyle","textIndent","MozTextIndent","WebkitTextIndent","MSTextIndent","OTextIndent","textOrientation","MozTextOrientation","WebkitTextOrientation","MSTextOrientation","OTextOrientation","textOverflow","MozTextOverflow","WebkitTextOverflow","MSTextOverflow","OTextOverflow","textRendering","MozTextRendering","WebkitTextRendering","MSTextRendering","OTextRendering","textShadow","MozTextShadow","WebkitTextShadow","MSTextShadow","OTextShadow","textTransform","MozTextTransform","WebkitTextTransform","MSTextTransform","OTextTransform","textUnderlinePosition","MozTextUnderlinePosition","WebkitTextUnderlinePosition","MSTextUnderlinePosition","OTextUnderlinePosition","top","MozTop","WebkitTop","MSTop","OTop","touchAction","MozTouchAction","WebkitTouchAction","MSTouchAction","OTouchAction","transform","MozTransform","WebkitTransform","msTransform","OTransform","transformBox","MozTransformBox","WebkitTransformBox","MSTransformBox","OTransformBox","transformOrigin","MozTransformOrigin","WebkitTransformOrigin","MSTransformOrigin","OTransformOrigin","transformStyle","MozTransformStyle","WebkitTransformStyle","MSTransformStyle","OTransformStyle","transition","MozTransition","WebkitTransition","MSTransition","OTransition","transitionDelay","MozTransitionDelay","WebkitTransitionDelay","MSTransitionDelay","OTransitionDelay","transitionDuration","MozTransitionDuration","WebkitTransitionDuration","MSTransitionDuration","OTransitionDuration","transitionProperty","MozTransitionProperty","WebkitTransitionProperty","MSTransitionProperty","OTransitionProperty","transitionTimingFunction","MozTransitionTimingFunction","WebkitTransitionTimingFunction","MSTransitionTimingFunction","OTransitionTimingFunction","turn","MozTurn","WebkitTurn","MSTurn","OTurn","unicodeBidi","MozUnicodeBidi","WebkitUnicodeBidi","MSUnicodeBidi","OUnicodeBidi","unset","MozUnset","WebkitUnset","MSUnset","OUnset","verticalAlign","MozVerticalAlign","WebkitVerticalAlign","MSVerticalAlign","OVerticalAlign","vh","MozVh","WebkitVh","MSVh","OVh","visibility","MozVisibility","WebkitVisibility","MSVisibility","OVisibility","vmax","MozVmax","WebkitVmax","MSVmax","OVmax","vmin","MozVmin","WebkitVmin","MSVmin","OVmin","vw","MozVw","WebkitVw","MSVw","OVw","whiteSpace","MozWhiteSpace","WebkitWhiteSpace","MSWhiteSpace","OWhiteSpace","widows","MozWidows","WebkitWidows","MSWidows","OWidows","width","MozWidth","WebkitWidth","MSWidth","OWidth","willChange","MozWillChange","WebkitWillChange","MSWillChange","OWillChange","wordBreak","MozWordBreak","WebkitWordBreak","MSWordBreak","OWordBreak","wordSpacing","MozWordSpacing","WebkitWordSpacing","MSWordSpacing","OWordSpacing","wordWrap","MozWordWrap","WebkitWordWrap","MSWordWrap","OWordWrap","writingMode","MozWritingMode","WebkitWritingMode","MSWritingMode","OWritingMode","zIndex","MozZIndex","WebkitZIndex","MSZIndex","OZIndex","fontSize","MozFontSize","WebkitFontSize","MSFontSize","OFontSize","flex","MozFlex","WebkitFlex","MSFlex","OFlex","fr","MozFr","WebkitFr","MSFr","OFr","overflowScrolling","MozOverflowScrolling","WebkitOverflowScrolling","MSOverflowScrolling","OOverflowScrolling","userSelect","MozUserSelect","WebkitUserSelect","MSUserSelect","OUserSelect"],Ee=m.exports,Se.exports=function(e,t,n){var i=e[t];if(i){var r=[];if(Object.keys(i).forEach((function(e){-1===xe.indexOf(e)&&r.push(e)})),r.length)throw new Error("Prop "+t+" passed to "+n+". Has invalid keys "+r.join(", "))}},Se.exports.isRequired=function(e,t,n){if(!e[t])throw new Error("Prop "+t+" passed to "+n+" is required");return Se.exports(e,t,n)},Se.exports.supportingArrays=Ee.oneOfType([Ee.arrayOf(Se.exports),Se.exports]);var De=Le.exports;function Ne(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!=e&&this.setState(e)}function Ie(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!=n?n:null}.bind(this))}function Te(e,t){try{var n=this.props,i=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,i)}finally{this.props=n,this.state=i}}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oe(e,t,n){return t&&Ae(e.prototype,t),n&&Ae(e,n),e}function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Be(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function He(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?Ue(e):t}function je(e){return function(){var t,n=We(e);if(Ve()){var i=We(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return He(this,t)}}Ne.__suppressDeprecationWarning=!0,Ie.__suppressDeprecationWarning=!0,Te.__suppressDeprecationWarning=!0;var Ge=function(e){Be(n,d.PureComponent);var t=je(n);function n(){return Me(this,n),t.apply(this,arguments)}return Oe(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,i=e.split,r=e.style,o=e.size,s=e.eleRef,a=["Pane",i,n],l={flex:1,position:"relative",outline:"none"};return void 0!==o&&("vertical"===i?l.width=o:(l.height=o,l.display="flex"),l.flex="none"),l=Object.assign({},l,r||{}),d.createElement("div",{ref:s,className:a.join(" "),style:l},t)}}]),n}();Ge.propTypes={className:v.string.isRequired,children:v.node.isRequired,size:v.oneOfType([v.string,v.number]),split:v.oneOf(["vertical","horizontal"]),style:De,eleRef:v.func},Ge.defaultProps={};var Ke=function(e){Be(n,d.Component);var t=je(n);function n(){return Me(this,n),t.apply(this,arguments)}return Oe(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.onClick,i=e.onDoubleClick,r=e.onMouseDown,o=e.onTouchEnd,s=e.onTouchStart,a=e.resizerClassName,l=e.split,c=e.style,u=[a,l,t];return d.createElement("span",{role:"presentation",className:u.join(" "),style:c,onMouseDown:function(e){return r(e)},onTouchStart:function(e){e.preventDefault(),s(e)},onTouchEnd:function(e){e.preventDefault(),o(e)},onClick:function(e){n&&(e.preventDefault(),n(e))},onDoubleClick:function(e){i&&(e.preventDefault(),i(e))}})}}]),n}();function qe(e,t){if(e.selection)e.selection.empty();else try{t.getSelection().removeAllRanges()}catch(n){}}function $e(e,t,n,i){if("number"==typeof i){var r="number"==typeof t?t:0,o="number"==typeof n&&n>=0?n:1/0;return Math.max(r,Math.min(o,i))}return void 0!==e?e:t}Ke.propTypes={className:v.string.isRequired,onClick:v.func,onDoubleClick:v.func,onMouseDown:v.func.isRequired,onTouchStart:v.func.isRequired,onTouchEnd:v.func.isRequired,split:v.oneOf(["vertical","horizontal"]),style:De,resizerClassName:v.string.isRequired},Ke.defaultProps={resizerClassName:"Resizer"};var Ye=function(e){Be(n,d.Component);var t=je(n);function n(e){var i;Me(this,n),(i=t.call(this,e)).onMouseDown=i.onMouseDown.bind(Ue(i)),i.onTouchStart=i.onTouchStart.bind(Ue(i)),i.onMouseMove=i.onMouseMove.bind(Ue(i)),i.onTouchMove=i.onTouchMove.bind(Ue(i)),i.onMouseUp=i.onMouseUp.bind(Ue(i));var r=e.size,o=e.defaultSize,s=e.minSize,a=e.maxSize,l=e.primary,c=void 0!==r?r:$e(o,s,a,null);return i.state={active:!1,resized:!1,pane1Size:"first"===l?c:void 0,pane2Size:"second"===l?c:void 0,instanceProps:{size:r}},i}return Oe(n,[{key:"componentDidMount",value:function(){document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("touchmove",this.onTouchMove),this.setState(n.getSizeUpdate(this.props,this.state))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("touchmove",this.onTouchMove)}},{key:"onMouseDown",value:function(e){var t=Object.assign({},e,{touches:[{clientX:e.clientX,clientY:e.clientY}]});this.onTouchStart(t)}},{key:"onTouchStart",value:function(e){var t=this.props,n=t.allowResize,i=t.onDragStarted,r=t.split;if(n){qe(document,window);var o="vertical"===r?e.touches[0].clientX:e.touches[0].clientY;"function"==typeof i&&i(),this.setState({active:!0,position:o})}}},{key:"onMouseMove",value:function(e){var t=Object.assign({},e,{touches:[{clientX:e.clientX,clientY:e.clientY}]});this.onTouchMove(t)}},{key:"onTouchMove",value:function(e){var t=this.props,n=t.allowResize,i=t.maxSize,r=t.minSize,o=t.onChange,s=t.split,a=t.step,l=this.state,c=l.active,u=l.position;if(n&&c){qe(document,window);var h="first"===this.props.primary,d=h?this.pane1:this.pane2,f=h?this.pane2:this.pane1;if(d){var g=d,p=f;if(g.getBoundingClientRect){var m=g.getBoundingClientRect().width,v=g.getBoundingClientRect().height,y="vertical"===s?m:v,_=u-("vertical"===s?e.touches[0].clientX:e.touches[0].clientY);if(a){if(Math.abs(_)<a)return;_=~~(_/a)*a}var b=h?_:-_;parseInt(window.getComputedStyle(g).order)>parseInt(window.getComputedStyle(p).order)&&(b=-b);var w=i;if(void 0!==i&&i<=0){var C=this.splitPane;w="vertical"===s?C.getBoundingClientRect().width+i:C.getBoundingClientRect().height+i}var S=y-b,x=u-_;S<r?S=r:void 0!==i&&S>w?S=w:this.setState({position:x,resized:!0}),o&&o(S),this.setState(Re({draggedSize:S},h?"pane1Size":"pane2Size",S))}}}}},{key:"onMouseUp",value:function(){var e=this.props,t=e.allowResize,n=e.onDragFinished,i=this.state,r=i.active,o=i.draggedSize;t&&r&&("function"==typeof n&&n(o),this.setState({active:!1}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.allowResize,i=t.children,r=t.className,o=t.onResizerClick,s=t.onResizerDoubleClick,a=t.paneClassName,l=t.pane1ClassName,c=t.pane2ClassName,u=t.paneStyle,h=t.pane1Style,f=t.pane2Style,g=t.resizerClassName,p=t.resizerStyle,m=t.split,v=t.style,y=this.state,_=y.pane1Size,b=y.pane2Size,w=n?"":"disabled",C=g?"".concat(g," ").concat("Resizer"):g,S=function(e){return d.Children.toArray(e).filter((function(e){return e}))}(i),x=Fe({display:"flex",flex:1,height:"100%",position:"absolute",outline:"none",overflow:"hidden",MozUserSelect:"text",WebkitUserSelect:"text",msUserSelect:"text",userSelect:"text"},v);"vertical"===m?Object.assign(x,{flexDirection:"row",left:0,right:0}):Object.assign(x,{bottom:0,flexDirection:"column",minHeight:"100%",top:0,width:"100%"});var E=["SplitPane",r,m,w],k=Fe({},u,{},h),L=Fe({},u,{},f),D=["Pane1",a,l].join(" "),N=["Pane2",a,c].join(" ");return d.createElement("div",{className:E.join(" "),ref:function(t){e.splitPane=t},style:x},d.createElement(Ge,{className:D,key:"pane1",eleRef:function(t){e.pane1=t},size:_,split:m,style:k},S[0]),d.createElement(Ke,{className:w,onClick:o,onDoubleClick:s,onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onTouchEnd:this.onMouseUp,key:"resizer",resizerClassName:C,split:m,style:p||{}}),d.createElement(Ge,{className:N,key:"pane2",eleRef:function(t){e.pane2=t},size:b,split:m,style:L},S[1]))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return n.getSizeUpdate(e,t)}},{key:"getSizeUpdate",value:function(e,t){var n={};if(t.instanceProps.size===e.size&&void 0!==e.size)return{};var i=void 0!==e.size?e.size:$e(e.defaultSize,e.minSize,e.maxSize,t.draggedSize);void 0!==e.size&&(n.draggedSize=i);var r="first"===e.primary;return n[r?"pane1Size":"pane2Size"]=i,n[r?"pane2Size":"pane1Size"]=void 0,n.instanceProps={size:e.size},n}}]),n}();Ye.propTypes={allowResize:v.bool,children:v.arrayOf(v.node).isRequired,className:v.string,primary:v.oneOf(["first","second"]),minSize:v.oneOfType([v.string,v.number]),maxSize:v.oneOfType([v.string,v.number]),defaultSize:v.oneOfType([v.string,v.number]),size:v.oneOfType([v.string,v.number]),split:v.oneOf(["vertical","horizontal"]),onDragStarted:v.func,onDragFinished:v.func,onChange:v.func,onResizerClick:v.func,onResizerDoubleClick:v.func,style:De,resizerStyle:De,paneClassName:v.string,pane1ClassName:v.string,pane2ClassName:v.string,paneStyle:De,pane1Style:De,pane2Style:De,resizerClassName:v.string,step:v.number},Ye.defaultProps={allowResize:!0,minSize:50,primary:"first",split:"vertical",paneClassName:"",pane1ClassName:"",pane2ClassName:""},function(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!=typeof e.getDerivedStateFromProps&&"function"!=typeof t.getSnapshotBeforeUpdate)return e;var n=null,i=null,r=null;if("function"==typeof t.componentWillMount?n="componentWillMount":"function"==typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"==typeof t.componentWillReceiveProps?i="componentWillReceiveProps":"function"==typeof t.UNSAFE_componentWillReceiveProps&&(i="UNSAFE_componentWillReceiveProps"),"function"==typeof t.componentWillUpdate?r="componentWillUpdate":"function"==typeof t.UNSAFE_componentWillUpdate&&(r="UNSAFE_componentWillUpdate"),null!==n||null!==i||null!==r){var o=e.displayName||e.name,s="function"==typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+o+" uses "+s+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==i?"\n  "+i:"")+(null!==r?"\n  "+r:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"==typeof e.getDerivedStateFromProps&&(t.componentWillMount=Ne,t.componentWillReceiveProps=Ie),"function"==typeof t.getSnapshotBeforeUpdate){if("function"!=typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=Te;var a=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var i=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;a.call(this,e,t,i)}}}(Ye);var Xe=Ye,Ze={exports:{}},Qe={exports:{}},Je={},et={exports:{}};!function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}(et);var tt={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(tt);var nt=et.exports;Object.defineProperty(Je,"__esModule",{value:!0}),Je.default=void 0;var it=nt(tt.exports),rt="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==y?y:Function("return this")(),ot="object"===(void 0===y?"undefined":(0,it.default)(y))&&y&&y.Math===Math&&y.Array===Array?y:rt;Je.default=ot;var st={},at={exports:{}},lt={exports:{}},ct={exports:{}};!function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i},e.exports.__esModule=!0,e.exports.default=e.exports}(ct),function(e){var t=ct.exports;e.exports=function(e){if(Array.isArray(e))return t(e)},e.exports.__esModule=!0,e.exports.default=e.exports}(lt);var ut={exports:{}};!function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports}(ut);var ht={exports:{}};!function(e){var t=ct.exports;e.exports=function(e,n){if(e){if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}(ht);var dt={exports:{}};!function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports}(dt),function(e){var t=lt.exports,n=ut.exports,i=ht.exports,r=dt.exports;e.exports=function(e){return t(e)||n(e)||i(e)||r()},e.exports.__esModule=!0,e.exports.default=e.exports}(at);var ft={};Object.defineProperty(ft,"__esModule",{value:!0}),ft.default=void 0;var gt=function(e){return e instanceof Array};ft.default=gt;var pt=et.exports;Object.defineProperty(st,"__esModule",{value:!0}),st.default=void 0;var mt=pt(at.exports),vt=pt(ft),yt=function e(t){return t.reduce((function(t,n){return[].concat((0,mt.default)(t),(0,mt.default)((0,vt.default)(n)?e(n):[n]))}),[])};st.default=yt;var _t={},bt={};Object.defineProperty(bt,"__esModule",{value:!0}),bt.default=function(e){return"string"==typeof e};var wt={};Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=void 0;var Ct=function(e){return void 0===e};wt.default=Ct;var St={},xt={};Object.defineProperty(xt,"__esModule",{value:!0}),xt.default=void 0;var Et=function(e){return e!=e};xt.default=Et;var kt=et.exports;Object.defineProperty(St,"__esModule",{value:!0}),St.default=void 0;var Lt=kt(xt),Dt=function(e){return"number"==typeof e&&!(0,Lt.default)(e)};St.default=Dt;var Nt=et.exports;Object.defineProperty(_t,"__esModule",{value:!0}),_t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;try{(0,Mt.default)(t)&&(t=String(t));var i=((0,It.default)(t)?t.split("."):t).reduce((function(e,t){return e[t]}),e);return(0,Tt.default)(i)?n:i}catch(r){return n}};var It=Nt(bt),Tt=Nt(wt),Mt=Nt(St);var At={},Ot={};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=void 0;var Rt=function(e){return"function"==typeof e};Ot.default=Rt;var Pt=et.exports;Object.defineProperty(At,"__esModule",{value:!0}),At.default=void 0;var Ft=Pt(bt),Bt=Pt(Ot),Wt=Pt(_t),zt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t=(0,Ft.default)(t)?t.split("."):t;for(var n=(0,Wt.default)(e,t),i=(0,Wt.default)(e,t.slice(0,-1)),r=arguments.length,o=new Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];return(0,Bt.default)(n)?n.call.apply(n,[i].concat(o)):n};At.default=zt;var Vt={};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.default=void 0;var Ut=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;return function(){for(var i=this,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return clearTimeout(t),t=setTimeout((function(){e.apply(i,o)}),n)}};Vt.default=Ut;var Ht={exports:{}},jt={exports:{}},Gt="__global_unique_id__",Kt=function(){return y[Gt]=(y[Gt]||0)+1},qt=function(){};!function(e,t){t.__esModule=!0;var n=h.exports;o(n);var i=o(m.exports),r=o(Kt);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}o(qt);var c=1073741823;function u(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(n,i){e=n,t.forEach((function(t){return t(e,i)}))}}}t.default=function(e,t){var o,h,d="__create-react-context-"+(0,r.default)()+"__",f=function(e){function n(){var t,i;s(this,n);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return t=i=a(this,e.call.apply(e,[this].concat(o))),i.emitter=u(i.props.value),a(i,t)}return l(n,e),n.prototype.getChildContext=function(){var e;return(e={})[d]=this.emitter,e},n.prototype.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n=this.props.value,i=e.value,r=void 0;((o=n)===(s=i)?0!==o||1/o==1/s:o!=o&&s!=s)?r=0:(r="function"==typeof t?t(n,i):c,0!==(r|=0)&&this.emitter.set(e.value,r))}var o,s},n.prototype.render=function(){return this.props.children},n}(n.Component);f.childContextTypes=((o={})[d]=i.default.object.isRequired,o);var g=function(t){function n(){var e,i;s(this,n);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return e=i=a(this,t.call.apply(t,[this].concat(o))),i.state={value:i.getValue()},i.onUpdate=function(e,t){0!=((0|i.observedBits)&t)&&i.setState({value:i.getValue()})},a(i,e)}return l(n,t),n.prototype.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?c:t},n.prototype.componentDidMount=function(){this.context[d]&&this.context[d].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?c:e},n.prototype.componentWillUnmount=function(){this.context[d]&&this.context[d].off(this.onUpdate)},n.prototype.getValue=function(){return this.context[d]?this.context[d].get():e},n.prototype.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(n.Component);return g.contextTypes=((h={})[d]=i.default.object,h),{Provider:f,Consumer:g}},e.exports=t.default}(jt,jt.exports),function(e,t){t.__esModule=!0;var n=r(h.exports),i=r(jt.exports);function r(e){return e&&e.__esModule?e:{default:e}}t.default=n.default.createContext||i.default,e.exports=t.default}(Ht,Ht.exports);var $t={},Yt={exports:{}};!function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports}(Yt);var Xt={exports:{}};!function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports}(Xt);var Zt=et.exports;Object.defineProperty($t,"__esModule",{value:!0}),$t.default=void 0;var Qt=Zt(Yt.exports),Jt=Zt(Xt.exports),en=Zt(Ot),tn=Zt(wt);function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){(0,Qt.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}$t.default=function e(){var t=this;(0,Jt.default)(this,e),this.listeners={},this.getEventMap=function(e){return t.listeners[e]||(t.listeners[e]=new Map),t.listeners[e]},this.on=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.once,o=void 0!==r&&r;return(0,en.default)(n)?(t.getEventMap(e).set(n,o?function(){n.apply(void 0,arguments),t.off(e,n)}:n),t):(console.error("[EventBus Error] listener is not a function"),t)},this.once=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.on(e,n,rn(rn({},i),{},{once:!0}))},this.off=function(e,n){var i=t.getEventMap(e);return(0,tn.default)(n)?i.clear():i.delete(n),t},this.emit=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return t.getEventMap(e).forEach((function(e){return e.apply(void 0,i)}))}};var on={};Object.defineProperty(on,"__esModule",{value:!0}),on.default=void 0;var sn=function(e){return Promise.resolve().then(e)};on.default=sn;var an={};Object.defineProperty(an,"__esModule",{value:!0}),an.default=void 0;var ln=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.disable,i=void 0===n?function(){return!1}:n,r=new Map,o=function(t){if(r.has(t))return r.get(t);for(var n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];var a=e.call.apply(e,[this,t].concat(o));return i.call(this,{cache:r,key:t,result:a,drop:function(){return r.delete(t)}})||r.set(t,a),a};return o.cache=r,o};an.default=ln;var cn={},un={};Object.defineProperty(un,"__esModule",{value:!0}),un.default=void 0;var hn=function(e){return null===e};un.default=hn;var dn=et.exports;Object.defineProperty(cn,"__esModule",{value:!0}),cn.default=void 0;var fn=dn(tt.exports),gn=dn(ft),pn=dn(un),mn=function(e){return"object"===(0,fn.default)(e)&&!((0,gn.default)(e)||(0,pn.default)(e))};cn.default=mn;var vn={},yn=et.exports;Object.defineProperty(vn,"__esModule",{value:!0}),vn.default=void 0;var _n=yn(wt),bn=yn(At),wn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return(0,_n.default)(e)?(0,bn.default)(t):(0,bn.default)(e)}),void 0)};vn.default=wn;var Cn={exports:{}},Sn={exports:{}};!function(e,t,n,i,r,o){function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i,r=l(e);return!(i=t?(n=l(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments))||"object"!=typeof i&&"function"!=typeof i?u(this):i}}function d(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function g(){var e=0,t=new Map;return function(n){var i=t.get(n);return i||(i=(++e).toString(32),t.set(n,i)),i}}function p(e){var t,n,i,s=_(o(e,"type.$$typeof",e.type)),a=(n=o(t=e,"key")||t.index,i=o(t,"memoizedProps._nk")||o(t,"pendingProps._nk"),r(i)&&y.test(i)?"".concat(i,".").concat(n):i||n);return"".concat(s,",").concat(a)}function m(e){var t,n,i,s=C(e.type),a=(n=o(t=e,"key")||t.index,i=o(t,"props._nk"),r(i)&&w.test(i)?"".concat(i,".").concat(n):i||n);return"".concat(s,",").concat(a)}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var v,y=/^iAr/,_=g(),b=function(e,n){var r,o,s=(r=function e(t){return t.return?[t].concat(d(e(t.return))):[t]}(e),o=n,r.map((function(e){var n=p(e);return i(o)?t(o,void 0,e,n):n})).filter(Boolean).join("|"));return _(s)},w=/^iAr/,C=g(),S=function(e,n){var r,o,s=(r=function e(t){return t.__?[t].concat(d(e(t.__))):[t]}(e),o=n,r.map((function(e){var n=m(e);return i(o)?t(o,void 0,e,n):n})).filter(Boolean).join("|"));return C(s)},x=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(r,n.Component);var e,i=h(r);function r(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return a(u(e=i.call.apply(i,[this].concat(n))),"key",null),a(u(e),"genKey",(function(t){switch(v||((e._reactInternalFiber||e._reactInternals)&&(v="React"),e.__v&&(v="Preact")),v){case"Preact":e.key=S(e.__v,t);break;case"React":var n=e._reactInternalFiber||e._reactInternals;e.key=b(n,t)}return e.key})),e}return(e=[{key:"render",value:function(){var e=this.props,n=e.children,i=e.prefix,r=e.onHandleNode;return t(n,void 0,"".concat(i).concat(this.key||this.genKey(r)))}}])&&s(r.prototype,e),r}();a(x,"defaultProps",{onHandleNode:void 0,prefix:""}),e.default=x,Object.defineProperty(e,"__esModule",{value:!0})}(Sn.exports,At,h.exports,Ot,bt,_t),Cn.exports=Sn.exports;var xn={},En=et.exports;Object.defineProperty(xn,"__esModule",{value:!0}),xn.default=void 0;var kn=En(wt),Ln=En(un),Dn=function(e){return!((0,kn.default)(e)||(0,Ln.default)(e))};xn.default=Dn,function(e,t,n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v,y,_,b){t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var w="default"in s?s.default:s;function C(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)),i}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function k(e,t,n){return t&&E(e.prototype,t),n&&E(e,n),e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};for(var n,i={},r=Object.keys(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?A(e):t}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=I(e);return O(this,t?(n=I(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments))}}function P(e,t){return W(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(l){a=!0,r=l}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(e,t)||V(e,t)||H()}function F(e){return W(e)||z(e)||V(e)||H()}function B(e){return function(e){if(Array.isArray(e))return U(e)}(e)||z(e)||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e){if(Array.isArray(e))return e}function z(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function V(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function H(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,_=_&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b;var j=function(e){return e instanceof RegExp},G=c(),K=G.Provider,q=G.Consumer,$=c(),Y=$.Provider,X=$.Consumer,Z=new u,Q=function(){N(t,s.Component);var e=R(t);function t(n){var i;return x(this,t),i=e.call(this,n),t.currentContextValue=n.value,i}return k(t,[{key:"shouldComponentUpdate",value:function(e){return e.value!==this.props.value&&(t.currentContextValue=e.value,Z.emit("update",e.value)),e.children!==this.props.children||e.value!==this.props.value}},{key:"render",value:function(){return this.props.children}}]),t}();function J(){if(!l(s.useContext))return{};if(t=s.useContext(G))return t;var e=P(s.useState(Q.currentContextValue),2),t=e[0],n=e[1];return s.useEffect((function(){var e=o(n);return Z.on("update",e),function(){return Z.off("update",e)}}),[]),t}function ee(e){var t=e.children;return e=M(e,["children"]),w.createElement(K,D({},e,{_nk:"".concat(re,"11")}),w.createElement(Q,D({},e,{_nk:"".concat(re,"21")}),t))}function te(e){var t=e.children;return w.createElement(q,{_nk:"".concat(re,"31")},(function(e){return e?r(t,void 0,e):w.createElement(ie,{_nk:"".concat(re,"41")},t)}))}function ne(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){var t=(e=F(e))[0];e.slice(1).forEach((function(e){var n;l(i(t,e))&&!i(t,[e,"_overridden"])&&(n=t[e].bind(t),t[e]=function(e){d(e)||ce(e);for(var t=arguments.length,i=new Array(1<t?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return n.apply(void 0,[e].concat(i))},t[e]._overridden=!0)}))}))}catch(r){console.warn("activation override failed:",r)}}L(Q,"eventBus",Z),L(Q,"currentContextValue",void 0);var ie=function(){N(t,s.PureComponent);var e=R(t);function t(n){var i;return x(this,t),L(A(i=e.call(this,n)),"state",{context:Q.currentContextValue}),L(A(i),"updateListener",o((function(e){i.setState({context:e})}))),Z.on("update",i.updateListener),i}return k(t,[{key:"componentWillUnmount",value:function(){Z.off("update",this.updateListener)}},{key:"render",value:function(){var e=this.props.children,t=this.state.context;return r(e,void 0,t)}}]),t}(),re="qj9A",oe=[],se=new Map,ae=new u,le=f((function(e){[G,$].includes(e)||(oe.push(e),setTimeout((function(){return ae.emit("update")})))})),ce=f((function(e){e=i(e,"_context")||i(e,"context"),i(e,"$$typeof")===i(G,"$$typeof")&&le(e)}));ne([w,"createElement"]);var ue=function(){N(t,s.PureComponent);var e=R(t);function t(n){var i;x(this,t),L(A(i=e.call(this,n)),"unmount",null);var r=n.value;return 0===r.length?(i.state={ctxValue:null},O(i)):((n=P(r,1)[0]).ctx,r=n.value,n=n.onUpdate,i.state={ctxValue:r},i.unmount=n((function(e){i.setState({ctxValue:e})})),i)}return k(t,[{key:"componentWillUnmount",value:function(){r(this.unmount)}},{key:"render",value:function(){var e=(r=this.props).value,n=r.children;if(0===e.length)return n;var i=this.state.ctxValue,r=(e=(r=F(e))[0].ctx,r.slice(1));return e=e.Provider,n=g(i)?n:w.createElement(e,{value:i,_nk:"".concat("lqEk","11")},n),0<r.length?w.createElement(t,{value:r,_nk:"".concat("lqEk","21")},n):n}}]),t}(),he=function(){N(t,s.Component);var e=R(t);function t(n){var r;x(this,t),L(A(r=e.call(this,n)),"updateListener",null),L(A(r),"ctxInfo",null);var o=n.value,s=n.ctx;return n=n.id,g(o)?O(r):(r.updateListener=i(se.get(s),n,new Map),r.ctxInfo={ctx:s,value:o,onUpdate:function(e){return r.updateListener.set(e,e),function(){return r.updateListener.delete(e)}}},r)}return k(t,[{key:"componentWillUnmount",value:function(){var e=(n=this.props).value,t=n.ctx,n=n.id;g(e)||se.set(t,S(S({},i(se.get(t),void 0,{})),{},L({},n,this.updateListener)))}},{key:"shouldComponentUpdate",value:function(e){var t=e.value;return(e=this.props.prevValue!==t)&&r(this.updateListener,"forEach",(function(e){return e(t)})),e}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,i=t.renderWrapper,r=t.renderContent;return t.id,i((function(t){return r(g(n)?t:[].concat(B(t),[e.ctxInfo]))}))}}]),t}(),de="SsUr",fe={},ge=function(){N(t,s.PureComponent);var e=R(t);function t(n){var i;return x(this,t),L(A(i=e.call(this,n)),"renderWrapper",(function(e){var t=i.props.id;return fe[t].reduce((function(e,n){var i=n.Consumer;return function(r){return w.createElement(i,{_nk:"".concat(de,"11")},(function(i){return w.createElement(he,{value:i,ctx:n,renderWrapper:e,renderContent:r,id:t,_nk:"".concat(de,"21")})}))}}),(function(e){return e([])}))(e)})),n=n.id,fe[n]||(fe[n]=B(oe)),i}return k(t,[{key:"render",value:function(){var e=this.props.children;return this.renderWrapper(e)}}]),t}(),pe="46lG",me=l(s.lazy)&&!g(s.Suspense),ve=function(e){return e=e.children,r(e)},ye=me?s.lazy((function(){return new Promise((function(){return null}))})):function(){return null},_e=function(){N(t,s.Component);var e=R(t);function t(){return x(this,t),e.apply(this,arguments)}return k(t,[{key:"componentDidMount",value:function(){r(this.props,"onStart")}},{key:"componentWillUnmount",value:function(){r(this.props,"onEnd")}},{key:"render",value:function(){return null}}]),t}(),be=me?function(){N(t,s.Component);var e=R(t);function t(){var n;x(this,t);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return L(A(n=e.call.apply(e,[this].concat(r))),"state",{suspense:!1}),L(A(n),"onSuspenseStart",(function(){n.setState({suspense:!0})})),L(A(n),"onSuspenseEnd",(function(){n.setState({suspense:!1})})),L(A(n),"sus$$",{onSuspenseStart:n.onSuspenseStart,onSuspenseEnd:n.onSuspenseEnd}),n}return k(t,[{key:"render",value:function(){var e=this.props.children;return w.createElement(s.Fragment,null,r(e,void 0,this.sus$$),this.state.suspense&&w.createElement(ye,{_nk:"".concat(pe,"31")}))}}]),t}():ve,we=me?function(e){var t=e.children;return e=e.sus$$,w.createElement(s.Suspense,{fallback:w.createElement(_e,{onStart:e.onSuspenseStart,onEnd:e.onSuspenseEnd,_nk:"".concat(pe,"21")}),_nk:"".concat(pe,"11")},t)}:ve,Ce=function(){N(t,s.Component);var e=R(t);function t(){return x(this,t),e.apply(this,arguments)}return k(t,[{key:"componentDidCatch",value:function(e){var t=this.props.error$$;r(t,void 0,e,(function(){r(t,void 0,null)}))}},{key:"render",value:function(){return this.props.children}}]),t}();L(Ce,"getDerivedStateFromError",(function(){return null}));var Se=function(){N(t,s.Component);var e=R(t);function t(){var n;x(this,t);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return L(A(n=e.call.apply(e,[this].concat(r))),"state",{error:null}),L(A(n),"throwError",(function(e,t){return n.setState({error:e},t)})),n}return k(t,[{key:"render",value:function(){if(this.state.error)throw this.state.error;return r(this.props.children,void 0,this.throwError)}}]),t}(),xe="lajT";function Ee(e){var t=e.id,n=e.children,i=(r=e.bridgeProps).sus$$,r=(e=r.ctx$$,r.error$$);return w.createElement(Ce,{error$$:r,_nk:"".concat(xe,"11")},w.createElement(we,{sus$$:i,_nk:"".concat(xe,"21")},w.createElement(ue,{id:t,value:e,_nk:"".concat(xe,"31")},n)))}function ke(e){var t=e.id,n=e.children;return w.createElement(Se,{_nk:"".concat(xe,"41")},(function(e){return w.createElement(be,{_nk:"".concat(xe,"51")},(function(i){return w.createElement(ge,{id:t,_nk:"".concat(xe,"61")},(function(t){return r(n,void 0,{bridgeProps:{sus$$:i,ctx$$:t,error$$:e}})}))}))}))}function Le(e){var t=function(){N(n,s.Component);var t=R(n);function n(){var e;x(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return L(A(e=t.call.apply(t,[this].concat(r))),"drop",null),e}return k(n,[{key:"componentWillUnmount",value:function(){r(this.drop)}},{key:"render",value:function(){var t=this,n=this.props,o=n.forwardedRef,s=M(n,["forwardedRef"]);return w.createElement(X,{_nk:"".concat(Ne,"11")},(function(){var n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).attach;return w.createElement(e,D({ref:function(e){[Ie,Te].every((function(t){return!l(i(e,t))}))||(t.drop=r(n,void 0,e),g(o)||(p(o)&&"current"in o?o.current=e:r(o,void 0,e)))}},s,{_nk:"".concat(Ne,"21")}))}))}}]),n}();return l(e.prototype.componentDidMount)&&(e.prototype._componentDidMount=e.prototype.componentDidMount,e.prototype.componentDidMount=function(){var t=this;h((function(){return e.prototype._componentDidMount.call(t)}))}),l(s.forwardRef)?m(s.forwardRef((function(e,n){return w.createElement(t,D({},e,{forwardedRef:n,_nk:"".concat(Ne,"31")}))})),e):m(t,e)}var De,Ne="XKTv",Ie="componentDidActivate",Te="componentWillUnactivate",Me=(me=(f=function(e,t){var n,i;[s.useRef,s.useContext,s.useEffect].some((function(e){return!l(e)}))||(i=s.useContext($))&&(n=s.useRef({}).current,i=i.attach,n[e]=t,n.drop=i(n),s.useEffect((function(){return function(){return r(n.drop)}}),[]))}).bind(null,Ie),ve=f.bind(null,Te),"bNyU"),Ae=function(){N(t,s.PureComponent);var e=R(t);function t(n){var o;x(this,t);for(var s=arguments.length,a=new Array(1<s?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return L(A(o=e.call.apply(e,[this,n].concat(a))),"eventBus",new u),L(A(o),"listeners",new Map),L(A(o),"wrapper",null),L(A(o),"cache",void 0),L(A(o),"attach",(function(e){var t,n=o.listeners;return e?(e.isKeepAlive&&h((function(){var t=o.props,n=t.id;(n=t.store.get(n)).aliveNodesId=new Set([].concat(B(n.aliveNodesId),[e.id]))})),n.set(e,(L(t={},Ie,(function(){return r(e,Ie)})),L(t,Te,(function(){return r(e,Te)})),t)),function(){n.delete(e)}):function(){return null}})),L(A(o),"contextValue",{id:o.props.id,attach:o.attach}),L(A(o),"drop",(function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).delay,t=void 0===e?1200:e;return new Promise((function(e){function n(){clearTimeout(r),o.eventBus.off(Te,n),o.cache.willDrop=!0,a.nodes.delete(l),a.helpers=S({},a.helpers),a.smartForceUpdate((function(){return e(!0)}))}var r,s=o.props,a=s.scope,l=s.id;if(!i(o.cache,"cached")&&!i(o.cache,"willDrop"))return o.eventBus.on(Te,n),void(r=setTimeout((function(){o.eventBus.off(Te,n),e(!1)}),t));n()}))})),L(A(o),"refresh",(function(){return new Promise((function(e){i(o.cache,"cached")&&e(!1),o.setState({key:Math.random()},(function(){return e(!0)}))}))})),o.state={children:n.children,bridgeProps:n.bridgeProps,key:Math.random()},o}return k(t,[{key:"componentDidMount",value:function(){var e,t=this,n=(o=this.props).store,i=o.id,r=this.listeners,o=this.wrapper;if(!n.has(i)){try{e=B(o.children)}catch(s){e=[o.children]}this.cache=(L(e={listeners:r,aliveNodesId:[],inited:!1,cached:!1,wrapper:o,nodes:e},Ie,(function(){return t[Ie]()})),L(e,Te,(function(){return t[Te]()})),e),n.set(i,this.cache)}}},{key:"componentWillUnmount",value:function(){var e=(n=this.props).store,t=n.keepers,n=n.id;try{var i=e.get(n);i.nodes.forEach((function(e){i.wrapper.appendChild(e)}))}catch(r){}e.delete(n),t.delete(n)}},{key:Ie,value:function(){this.eventBus.emit(Ie),this.listeners.forEach((function(e){return r(e,[Ie])}))}},{key:Te,value:function(){this.eventBus.emit(Te),B(this.listeners).reverse().forEach((function(e){return e=P(e,2)[1],r(e,[Te])}))}},{key:"render",value:function(){var e=this,t=(r=this.props).id,n=(M(r,["id"]),this.state),i=n.children,r=n.bridgeProps,o=n.key;return w.createElement("div",{ref:function(t){e.wrapper=t},_nk:"".concat(Me,"11")},w.createElement("div",{key:"keeper-container",className:"ka-content"},w.createElement(Ee,{id:t,bridgeProps:r,_nk:"".concat(Me,"21")},w.createElement(Y,{value:this.contextValue,_nk:"".concat(Me,"31")},w.Children.map(i,(function(e,t){return w.cloneElement(e,{key:"".concat(e.key||"",":").concat(o,":").concat(t)})}))))))}}]),t}(),Oe="UVSV",Re="drop",Pe="refresh",Fe=function(){N(t,s.Component);var e=R(t);function t(){var s;x(this,t);for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return L(A(s=e.call.apply(e,[this].concat(l))),"store",new Map),L(A(s),"nodes",new Map),L(A(s),"keepers",new Map),L(A(s),"debouncedForceUpdate",o((function(e){return s.forceUpdate(e)}))),L(A(s),"updateCallbackList",[]),L(A(s),"smartForceUpdate",(function(e){s.updateCallbackList.push(e),s.debouncedForceUpdate((function(){s.updateCallbackList.forEach((function(e){return r(e)})),s.updateCallbackList=[]}))})),L(A(s),"update",(function(e,t){return new Promise((function(n){var i=s.keepers.get(e),r=!i,o=Date.now(),a=s.nodes.get(e)||null;s.nodes.set(e,S(S({id:e,createTime:o,updateTime:o},a),t)),r?(s.helpers=S({},s.helpers),s.forceUpdate(n)):(a=t.children,r=t.bridgeProps,i.setState({children:a,bridgeProps:r},n))}))})),L(A(s),"keep",(function(e,t){return new Promise((function(n){s.update(e,S({id:e},t)).then((function(){n(s.store.get(e))}))}))})),L(A(s),"getCachingNodesByName",(function(e){return s.getCachingNodes().filter((function(t){return j(e)?e.test(t.name):t.name===e}))})),L(A(s),"getScopeIds",(function(e){return n(e.map((function e(t){var n=i(s.getCache(t),"aliveNodesId",[]);return 0<n.size?[t,B(n).map(e)]:[t].concat(B(n))})))})),L(A(s),"dropById",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s.handleNodes.apply(s,[[e],Re].concat(n))})),L(A(s),"dropScopeByIds",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s.handleNodes.apply(s,[s.getScopeIds(e),Re].concat(n))})),L(A(s),"drop",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s.handleNodes.apply(s,[s.getCachingNodesByName(e).map((function(e){return e.id})),Re].concat(n))})),L(A(s),"dropScope",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s.dropScopeByIds.apply(s,[s.getCachingNodesByName(e).map((function(e){return e.id}))].concat(n))})),L(A(s),"refreshById",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s.handleNodes.apply(s,[[e],Pe].concat(n))})),L(A(s),"refreshScopeByIds",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s.handleNodes.apply(s,[s.getScopeIds(e),Pe].concat(n))})),L(A(s),"refresh",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s.handleNodes.apply(s,[s.getCachingNodesByName(e).map((function(e){return e.id})),Pe].concat(n))})),L(A(s),"refreshScope",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s.refreshScopeByIds.apply(s,[s.getCachingNodesByName(e).map((function(e){return e.id}))].concat(n))})),L(A(s),"handleNodes",(function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Re,n=arguments.length,i=new Array(2<n?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return new Promise((function(n){var o=[];e.forEach((function(e){s.store.get(e)&&(e=s.keepers.get(e),o.push(e))})),0!==o.length?Promise.all(o.map((function(e){return r.apply(void 0,[e,t].concat(i))}))).then((function(e){return n(e.every(Boolean))})):n(!1)}))})),L(A(s),"clear",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.handleNodes.apply(s,[s.getCachingNodes().map((function(e){return e.id})),Re].concat(t))})),L(A(s),"getCache",(function(e){return s.store.get(e)})),L(A(s),"getNode",(function(e){return s.nodes.get(e)})),L(A(s),"getCachingNodes",(function(){return B(s.nodes.values())})),L(A(s),"helpers",{keep:s.keep,update:s.update,drop:s.drop,dropScope:s.dropScope,dropById:s.dropById,dropScopeByIds:s.dropScopeByIds,refresh:s.refresh,refreshScope:s.refreshScope,refreshById:s.refreshById,refreshScopeByIds:s.refreshScopeByIds,getScopeIds:s.getScopeIds,clear:s.clear,getCache:s.getCache,getNode:s.getNode,getCachingNodes:s.getCachingNodes}),s}return k(t,[{key:"render",value:function(){var e=this,t=void 0===(t=this.props.children)?null:t;return w.createElement(ee,{value:this.helpers,_nk:"".concat(Oe,"11")},t,w.createElement("div",{style:{display:"none"},_nk:"".concat(Oe,"21")},B(this.nodes.values()).map((function(t){var n=t.children,i=M(t,["children"]);return w.createElement(Ae,D({key:i.id},i,{scope:e,store:e.store,keepers:e.keepers,ref:function(t){e.keepers.set(i.id,t)},_nk:"iAr".concat(Oe,"31")}),n)}))))}}]),t}();i(t,"document")&&(De=r(t,"document.createElement","div"),a.render(w.createElement(Fe,{_nk:"".concat(Oe,"41")}),De));var Be="X7Aa";function We(e){return{drop:e.drop,dropScope:e.dropScope,refresh:e.refresh,refreshScope:e.refreshScope,clear:e.clear,getCachingNodes:e.getCachingNodes}}function ze(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return!!b(e)&&(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight)}function Ve(e){return l(i(t,"document.querySelectorAll"))?[].concat(B(v(r(e,"querySelectorAll","*"),[])),[e]).filter(ze):[]}var Ue,He=i(t,"document.body"),je=i(t,"document.scrollingElement",i(t,"document.documentElement",{})),Ge=function(e){return"<KeepAlive ".concat(e?'name="'.concat(e,'" '):"","/> Too many transient updates, may have encountered an infinite loop of updates, forced to pause the update\nThere are serious performance issues with the update results you are currently seeing\nMay encounter an implied bug, please don't use KeepAlive and contact the author to solve")};function Ke(e){var t=e.idPrefix,n=e.helpers,r=e.props;return(e=g(n))&&console.error("You should not use <KeepAlive /> outside a <AliveScope>"),e?i(r,"children",null):w.createElement(_,{prefix:t,key:r._nk,_nk:"".concat(Be,"11")},(function(e){return w.createElement(ke,{key:e,id:e,_nk:"".concat(Be,"21")},(function(t){return w.createElement(Ue,D({key:e},r,t,{id:e,_helpers:n,_nk:"".concat(Be,"31")}))}))}))}f=function(){N(i,s.Component);var e=R(i);function i(s){var a;return x(this,i),L(A(a=e.call(this,s)),"updateTimes",0),L(A(a),"errorTips",o((function(){var e=a.props.name;console.error(Ge(e))}),100)),L(A(a),"releaseUpdateTimes",o((function(){a.updateTimes=0}),16)),L(A(a),"needForceStopUpdate",(function(){var e=64<a.updateTimes;return e&&a.errorTips(),a.updateTimes++,a.releaseUpdateTimes(),e})),L(A(a),"id",null),L(A(a),"isKeepAlive",!0),L(A(a),"cached",!1),L(A(a),"inject",(function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=a.props,n=t.id,i=t.saveScrollPosition;n=t._helpers.getCache(n);try{n.nodes.forEach((function(e){a.placeholder.appendChild(e)})),e&&i&&r(n.revertScrollPos)}catch(o){}})),L(A(a),"eject",(function(){var e,i=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],o=a.props,s=o.id,l=o._helpers.getCache(s);s=n(n([a.props.saveScrollPosition]).map((function(e){return!0===e?l.nodes:"screen"===e?[je,He]:B(v(r(t,"document.querySelectorAll",e),[]))}))).filter(Boolean);try{i&&0<s.length&&(l.revertScrollPos=(e=B(new Set(B(n(s.map(Ve))))).map((function(e){return[e,{x:e.scrollLeft,y:e.scrollTop}]})),function(){e.forEach((function(e){var t=(n=P(e,2))[0],n=(e=n[1]).x;e=e.y,t.scrollLeft=n,t.scrollTop=e}))})),l.nodes.forEach((function(e){i?a.placeholder.removeChild(e):l.wrapper.appendChild(e)}))}catch(c){}})),L(A(a),"init",(function(){var e=(i=a.props)._helpers,t=i.id,n=i.children,i=M(i,["_helpers","id","children"]);e.keep(t,S({children:n,getInstance:function(){return A(a)}},i)).then((function(e){e&&(a.inject(),e.inited?r(A(a),Ie):e.inited=!0,a.cached=!1)}))})),L(A(a),"update",(function(){var e=(i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})._helpers,t=i.id,n=i.name,i=M(i,["_helpers","id","name"]);!e||a.cached||a.needForceStopUpdate(n)||e.update(t,S({name:n,getInstance:function(){return A(a)}},i))})),a.id=s.id,a.init(),[Ie,Te].forEach((function(e){a[e]=function(){var t=(i=a.props).id,n=i._helpers,i=n.getCache(t);(t=n.getNode(t))&&e===Ie&&(t.updateTime=Date.now()),t=e===Te,i&&!i.willDrop?(r(i,e),i.cached=t,a.cached=t):a.cached&&!t&&a.init()}})),a}return k(i,[{key:"shouldComponentUpdate",value:function(e){return this.update(e),!1}},{key:"componentWillUnmount",value:function(){var e=(i=this.props).id,t=i._helpers,n=void 0===(o=i.when)||o,i=t.getCache(e),o=(n=P((o=r(n),y(o)?o:[o]),2))[0];n=n[1],i&&(this.eject(),delete i.getInstance,o||(n?([i].concat(B(t.getScopeIds([e]).map((function(e){return t.getCache(e)})))).forEach((function(e){e.willDrop=!0})),h((function(){return t.dropScopeByIds([e])}))):(i.willDrop=!0,h((function(){return t.dropById(e)})))),r(this,Te))}},{key:"render",value:function(){var e=this;return w.createElement("div",{key:"keep-alive-placeholder",className:"ka-wrapper",ref:function(t){e.placeholder=t}})}}]),i}(),L(f,"defaultProps",{saveScrollPosition:!0}),f=l(i(t,"document.getElementById"))?(Ue=Le(f),l(s.useContext)?function(e){var t=e.id;return e=M(e,["id"]),Ke({idPrefix:t,helpers:J(),props:e})}:function(e){var t=e.id,n=M(e,["id"]);return w.createElement(te,{_nk:"".concat(Be,"41")},(function(e){return Ke({idPrefix:t,helpers:e,props:n})}))}):function(e){return e=e.children,w.createElement("div",{key:"keep-alive-placeholder",className:"ka-wrapper"},w.createElement("div",{key:"keeper-container",className:"ka-content"},e))},e.AliveScope=Fe,e.KeepAlive=f,e.NodeKey=_,e.autoFixContext=ne,e.createContext=function(e,t){return t=c(e,t),le(t),t},e.default=f,e.fixContext=le,e.useActivate=me,e.useAliveController=function(){if(!l(s.useContext))return{};var e=J();return e?We(e):{}},e.useUnactivate=ve,e.withActivation=Le,e.withAliveScope=function(e){function t(t){var n=t.helpers,i=t.props;return t=t.forwardedRef,w.createElement(e,D({},i,n,{ref:t,_nk:"".concat(Be,"51")}))}var n=l(s.useContext)?function(e){var n=e.forwardedRef;return e=M(e,["forwardedRef"]),t({helpers:We(J()||{}),props:e,forwardedRef:n})}:function(e){var n=e.forwardedRef,i=M(e,["forwardedRef"]);return w.createElement(te,{_nk:"".concat(Be,"42")},(function(){return t({helpers:We(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),props:i,forwardedRef:n})}))};return l(s.forwardRef)?m(s.forwardRef((function(e,t){return w.createElement(n,D({},e,{forwardedRef:t,_nk:"".concat(Be,"61")}))})),e):m(n,e)},Object.defineProperty(e,"__esModule",{value:!0})}(Qe.exports,Je,st,_t,At,Vt,h.exports,_.exports,Ot,Ht.exports,$t,on,bt,an,wt,cn,b,vn,ft,Cn.exports,xn),Ze.exports=Qe.exports;var Nn="object"==typeof y&&y&&y.Object===Object&&y,In="object"==typeof self&&self&&self.Object===Object&&self;Nn||In||Function("return this")();var Tn="object"==typeof y&&y&&y.Object===Object&&y,Mn="object"==typeof self&&self&&self.Object===Object&&self;function An(){return"undefined"==typeof document||void 0===document.visibilityState||"hidden"!==document.visibilityState}Tn||Mn||Function("return this")();var On=[],Rn=!1;if("undefined"!=typeof window&&window.addEventListener&&!Rn){var Pn=function(){if(An()&&(void 0===navigator.onLine||navigator.onLine))for(var e=0;e<On.length;e++){(0,On[e])()}};window.addEventListener("visibilitychange",Pn,!1),window.addEventListener("focus",Pn,!1),Rn=!0}var Fn=[],Bn=!1;if("undefined"!=typeof window&&window.addEventListener&&!Bn){window.addEventListener("visibilitychange",(function(){if(An())for(var e=0;e<Fn.length;e++){(0,Fn[e])()}}),!1),Bn=!0}var Wn=d.createContext({});Wn.displayName="UseRequestConfigContext";Wn.Provider;var zn=function(e,t){var n=h.exports.useRef(!1);h.exports.useEffect((function(){if(n.current)return e();n.current=!0}),t)};function Vn(e,t){return e?"function"==typeof e?e():"current"in e?e.current:e:t}var Un=function(e){var t=function(e){var t=h.exports.useRef(e);t.current=e;var n=h.exports.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.current.apply(this,e)}),n.current}(e);h.exports.useEffect((function(){return function(){"function"==typeof t&&t()}}),[])},Hn=function(e){var t=h.exports.useRef(0),n=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}(h.exports.useState(e),2),i=n[0],r=n[1],o=h.exports.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){r(e)}))}),[]);return Un((function(){cancelAnimationFrame(t.current)})),[i,o]};function jn(e){var t=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}(Hn((function(){var t=Vn(e);return{width:(t||{}).clientWidth,height:(t||{}).clientHeight}})),2),n=t[0],i=t[1];return h.exports.useLayoutEffect((function(){var t=Vn(e);if(!t)return function(){};var n=new w((function(e){e.forEach((function(e){i({width:e.target.clientWidth,height:e.target.clientHeight})}))}));return n.observe(t),function(){n.disconnect()}}),[e]),n}function Gn(e){return"function"==typeof e}var Kn,qn=(Kn="object"==typeof window?window.localStorage:null)?function(e,t){var n=Kn,i=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}(h.exports.useState((function(){return s()})),2),r=i[0],o=i[1];function s(){try{var i=n.getItem(e);if(i)return JSON.parse(i)}catch(r){console.error(r)}return Gn(t)?t():t}return zn((function(){o(s())}),[e]),[r,h.exports.useCallback((function(t){if(void 0===t)n.removeItem(e),o(void 0);else if(Gn(t)){var i=t(s());try{n.setItem(e,JSON.stringify(i)),o(i)}catch(r){console.error(r)}}else try{n.setItem(e,JSON.stringify(t)),o(t)}catch(r){console.error(r)}}),[e])]}:function(e,t){return[Gn(t)?t():t,function(){}]},$n=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Yn={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Xn={esc:"Escape",tab:"Tab",enter:"Enter",space:" ",up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete"]},Zn={ctrl:function(e){return e.ctrlKey},shift:function(e){return e.shiftKey},alt:function(e){return e.altKey},meta:function(e){return e.metaKey}},Qn=function(){};function Jn(e){return Object.prototype.toString.call(e).replace(/^\[object (.+)\]$/,"$1").toLowerCase()}function ei(e,t){var n,i;if(!e.key)return!1;if("number"===Jn(t))return e.keyCode===t;var r=t.split("."),o=0;try{for(var s=$n(r),a=s.next();!a.done;a=s.next()){var l=a.value,c=Zn[l],u=Xn[l],h=Yn[l];(c&&c(e)||(u&&"array"===Jn(u)?u.includes(e.key):u===e.key)||(h&&"array"===Jn(h)?h.includes(e.keyCode):h===e.keyCode)||e.key.toUpperCase()===l.toUpperCase())&&o++}}catch(d){n={error:d}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o===r.length}var ti=["keydown"];function ni(e,t,n){void 0===t&&(t=Qn),void 0===n&&(n={});var i=n.events,r=void 0===i?ti:i,o=n.target,s=h.exports.useRef(t);s.current=t,h.exports.useEffect((function(){var t,n,i=function(t){if(function(e){var t=Jn(e);return"function"===t?e:"string"===t||"number"===t?function(t){return ei(t,e)}:"array"===t?function(t){return e.some((function(e){return ei(t,e)}))}:e?function(){return!0}:function(){return!1}}(e)(t))return s.current(t)},a=Vn(o,window);try{for(var l=$n(r),c=l.next();!c.done;c=l.next()){var u=c.value;a.addEventListener(u,i)}}catch(h){t={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return function(){var e,t;try{for(var n=$n(r),o=n.next();!o.done;o=n.next()){var s=o.value;a.removeEventListener(s,i)}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}}}),[r,e,o])}var ii=function(){return(ii=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};const ri=C.DirectoryTree,oi=(e,t)=>{const[n,i]=qn(e,t);return{obj:n,setObj:i,setObjValue:e=>{i(Q((e=>JSON.parse(JSON.stringify(e)))(n),e))}}},si=(e,t)=>{const{obj:n,setObjValue:i}=oi(e,{}),r=e=>n[e]||t;return{getCache:r,getUpdateCacheValue:e=>t=>((e,t)=>{const n=r(e);t(n),i((t=>t[e]=n))})(e,t),removeCache:e=>{i((t=>{delete t[e]}))}}},ai=p((e=>{const{titleRender:t,rightMenuRender:n,onClick:i=(()=>{}),rootTreeNodes:r,cacheKey:o,showIcon:s}=e,{getCache:a,getUpdateCacheValue:l}=si("___tree_caches",{epNodeList:[]}),c=a(o),u=l(o),{uiStore:h}=be("BenchStore");return d.createElement("div",{className:"common-tree"},r.length>0&&d.createElement(ri,{blockNode:!0,switcherIcon:d.createElement(S,null),titleRender:e=>{const i=e,r=t&&t(i)||e.title,o=d.createElement("span",{className:"w-full block break-all"},r);return n?d.createElement(x,{trigger:["contextMenu"],overlay:n(i)},o):o},showIcon:void 0===s||s,className:"tree",expandedKeys:c.epNodeList,selectedKeys:[h.uiSetting.curTabKey||""],onExpand:e=>u((t=>t.epNodeList=e)),onSelect:(e,{node:t})=>J((e=>i(t,e))),treeData:r}))}));const li={development:[{name:"bigdata",desc:"大数据",icon:"code_fill",id:-1},{name:"common",desc:"通用",icon:"file",id:-2},{name:"database",desc:"数据库",icon:"database2",id:-3}],query:[],resource:[{name:"file",desc:"文件资源",icon:"cloud-upload",id:-5},{name:"datasource",desc:"数据源",icon:"database2",id:-6},{name:"executor",desc:"执行资源",icon:"server",id:-7}],component:[{name:"c_common",desc:"通用组件",icon:"common",id:-8},{name:"compute",desc:"计算组件",icon:"compute",id:-9},{name:"storage",desc:"存储组件",icon:"storage",id:-10},{name:"schedule",desc:"调度组件",icon:"schedule",id:-11}],document:[]},ci={bigdata:"blue",common:"indigo",database:"purple",custom:"green",datasource:"indigo",file:"green",executor:"purple",compute:"green",storage:"purple",schedule:"blue",c_common:"orange"},ui={manual_record:"手动",system:"系统",auto_parse:"解析"};var hi={},di={exports:{}};!function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(this,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(di);var fi=E(k),gi={},pi={exports:{}};!function(e){var t=Yt.exports;function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}e.exports=function(e){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?n(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports}(pi);var mi=et.exports;Object.defineProperty(gi,"__esModule",{value:!0}),gi.default=function(e,t){var n=(0,vi.default)({},e);Array.isArray(t)&&t.forEach((function(e){delete n[e]}));return n};var vi=mi(pi.exports);var yi={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(0,h.exports.createContext)({prefixCls:"",firstLevel:!0,inlineCollapsed:!1});e.default=t}(yi);var _i={},bi=tt.exports;Object.defineProperty(_i,"__esModule",{value:!0}),_i.cloneElement=function(e,t){return xi(e,e,t)},_i.isValidElement=void 0,_i.replaceElement=xi;var wi=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==bi(e)&&"function"!=typeof e)return{default:e};var n=Ci(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(h.exports);function Ci(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Ci=function(e){return e?n:t})(e)}var Si=wi.isValidElement;function xi(e,t,n){return Si(e)?wi.cloneElement(e,"function"==typeof n?n(e.props||{}):n):t}_i.isValidElement=Si,function(e){var t=et.exports,n=tt.exports;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=t(di.exports),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var i=u(t);if(i&&i.has(e))return i.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}r.default=e,i&&i.set(e,r);return r}(h.exports),o=fi,s=t(D.exports),a=t(gi),l=t(yi),c=_i;function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}var d=function(e){var t,n,u=e.popupClassName,h=e.icon,d=e.title,f=e.theme,g=r.useContext(l.default),p=g.prefixCls,m=g.inlineCollapsed,v=g.antdMenuTheme,y=(0,o.useFullPath)();if(h){var _=(0,c.isValidElement)(d)&&"span"===d.type;n=r.createElement(r.Fragment,null,(0,c.cloneElement)(h,{className:(0,s.default)((0,c.isValidElement)(h)?null===(t=h.props)||void 0===t?void 0:t.className:"","".concat(p,"-item-icon"))}),_?d:r.createElement("span",{className:"".concat(p,"-title-content")},d))}else n=m&&!y.length&&d&&"string"==typeof d?r.createElement("div",{className:"".concat(p,"-inline-collapsed-noicon")},d.charAt(0)):r.createElement("span",{className:"".concat(p,"-title-content")},d);var b=r.useMemo((function(){return(0,i.default)((0,i.default)({},g),{firstLevel:!1})}),[g]);return r.createElement(l.default.Provider,{value:b},r.createElement(o.SubMenu,(0,i.default)({},(0,a.default)(e,["icon"]),{title:n,popupClassName:(0,s.default)(p,"".concat(p,"-").concat(f||v),u)})))};e.default=d}(hi);var Ei=L(hi);const ki=e=>e.toLocaleLowerCase().endsWith("sql")||"hive"===e.toLocaleLowerCase(),Li=e=>{const t=e.content.nodeType||e.content.fileType;return ki(t)?"sql":"shell"===t?"ini":"markdown"===t?"markdown":"java"},Di=e=>({flinkX:"bigdata",dataX:"bigdata",shell:"bigdata",sparkSql:"bigdata",hive:"database",mysql:"database",virtual:"common",jdbc_hive:"datasource",jdbc_mysql:"datasource",jar:"",file:"",function:"",markdown:"bigdata",component_default:"c_common",component_flink:"compute",component_spark:"compute",component_hdfs:"storage",component_yarn:"schedule",executor_client:"executor",executor_server:"executor"}[e]),Ni=(e,t)=>(()=>{switch(e){case"development":switch(t){case"bigdata":return["shell","sparkSql","dataX"];case"common":return["virtual"];case"database":return["mysql","hive"];default:return[]}case"query":return["mysql","hive"];case"resource":switch(t){case"datasource":return["jdbc_mysql","jdbc_hive"];case"executor":return[]}return[];case"document":return["markdown"];case"component":switch(t){case"c_common":return["component_default"];case"compute":return["component_flink","component_spark"];case"storage":return["component_hdfs"];case"schedule":return["component_yarn"]}default:return[]}})().map((t=>({key:`${t}`,name:t.replaceAll(e+"_","")}))),Ii=e=>d.createElement(_e,{type:Ti[e]||e,className:ci[Di(e)]||"default"}),Ti={sparkSql:"SparkSQL",virtual:"java",jar:"java",jdbc_hive:"hive",jdbc_mysql:"mysql"},Mi=(e,t)=>li[e].map((e=>({key:`category_${e.name}`,title:e.desc,icon:d.createElement(_e,{className:f("icon",ci[e.name]),type:e.icon}),children:t.filter((t=>t.category===e.name)),isLeaf:!1,directory:!0,id:e.id,category:e.name,parentId:0}))),Ai=e=>{if(!e)return;if(!Array.isArray(e)){const t=e;t.children=t.children||[];const n=Ai(t.children).filter((e=>void 0!==e));return l(a({title:t.name,key:t.name},t),{isLeaf:0==n.length,icon:n.length>0?e=>Ri(e):void 0,children:n,id:-1,directory:!1,parentId:0})}return e.map((e=>Ai(e)))},Oi=(e,t)=>{const n=(e,t,i)=>{e.children=t.filter((t=>t.parentId==e.id)),e.children.forEach((e=>{n(e,t,i)})),e.children=e.children.concat(i.filter((t=>t.parentId===e.id)))},i=e.files.map((e=>{return{id:(t=e).id,key:`file_${t.id}`,title:t.name,isLeaf:!0,category:t.category,data:t,directory:!1,icon:e=>Ii(t.fileType),parentId:t.folderId};var t})),r=e.folders.map((e=>{return{id:(t=e).id,key:`folder_${t.id}`,title:t.name,isLeaf:!1,category:t.category,icon:Ri,data:t,directory:!0,parentId:t.parentId};var t}));if(t){const e=t.origin,n=t.mode;if("add"===n){const n=l(a({},e),{id:0,title:"",key:"empty",directory:!1,parentId:t.parentId||0,input:!0,isLeaf:!0,disabled:!0,icon:e=>"folder"===t.type?Ri(e):t.iconType&&Ii(t.iconType)});i.unshift(n)}else"rename"===n&&[...i,...r].forEach((t=>{t.id===e.id&&t.directory===e.directory&&(t.input=!0,t.disabled=!0)}))}return r.forEach((e=>n(e,r,i))),[...r,...i].filter((e=>0===e.parentId))},Ri=(e,t)=>d.createElement(_e,{className:t||"text-blue-400",type:"folder-"+(e.expanded?"open":"close")}),Pi=e=>e.map((e=>e.children&&e.children.length>0?d.createElement(Ei,{key:e.key||e.name,title:e.name,onTitleClick:e=>{e.domEvent.stopPropagation()}},Pi(e.children)):d.createElement(N.Item,{key:e.key||e.name,onClick:e=>{e.domEvent.stopPropagation()}},e.name)));function Fi(e,t){if(0===arguments.length)return null;const n=t||"{y}-{m}-{d} {h}:{i}:{s}";let i;"object"==typeof e?i=e:("string"==typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e)),"number"==typeof e&&10===e.toString().length&&(e*=1e3),i=new Date(e));const r={y:i.getFullYear(),m:i.getMonth()+1,d:i.getDate(),h:i.getHours(),i:i.getMinutes(),s:i.getSeconds(),a:i.getDay()},o=n.replace(/{(y|m|d|h|i|s|a)+}/g,((e,t)=>{let n=r[t];return"a"===t?["日","一","二","三","四","五","六"][n]:(e.length>0&&n<10&&(n="0"+n),n||0)}));return o}const Bi=e=>{const{menu:t,cacheKey:n,onRightMenuClick:i,onSetup:r,treeData:o,onFileEnter:s=(()=>{})}=e,{uiStore:a}=be("BenchStore"),[l,c]=h.exports.useState([]),[u,g]=h.exports.useState(),[p,m]=h.exports.useState("");h.exports.useEffect((()=>{c(r(Oi(o,u)))}),[o,u]),h.exports.useEffect((()=>{console.log("set tree data",I(o))}),[o]);return d.createElement("div",{className:f(["file-tree",e.className])},d.createElement(ai,{onClick:(e,n)=>{if(!e.directory){const i=e.data;a.addTab({key:e.key,type:i.fileType,id:i.id,label:i.name,tmp:!n,menu:t})}},rightMenuRender:e=>e.input?d.createElement(d.Fragment,null):d.createElement(N,{onClick:t=>{var n;t.domEvent.stopPropagation();const r=t.keyPath[t.keyPath.length-1],o=e;r.startsWith("create")?g({type:"create_folder"===t.key?"folder":"file",iconType:t.key,origin:o,mode:"add",parentId:o.directory?(null==(n=o.data)?void 0:n.id)||0:o.data.folderId}):r.startsWith("rename")&&(m(o.title),g({mode:"rename",iconType:o.data.fileType,type:o.directory?"folder":"file",origin:o,parentId:o.parentId})),i(e,t.key)}},Pi(((e,t)=>{const n=t.key;let i=t.category,r=[];return"trash"!==e?("executor"===i?r.push({name:"新建",key:"create",children:[{name:"客户端",key:"executor_client"},{name:"服务",key:"executor_server"}]}):r.push({name:"datasource"===i?"新增":"新建",key:"create",children:Ni(e,i)}),ee(n)||(r.push({name:"重命名",key:"rename"}),r.push({name:"删除",key:"delete"}))):te(n)&&r.push({name:"还原"}),te(n)||"trash"===e||t.directory&&r.push({name:"新建文件夹",key:"create_folder"}),r})(t,e))),titleRender:e=>d.createElement("div",{className:"tree-node-title"},(e=>{if(e.input){const e=()=>{g(void 0),m("")};return d.createElement(T,{spellCheck:!1,autoFocus:!0,size:"small",value:p,onBlur:()=>e(),onClick:e=>e.stopPropagation(),onChange:e=>m(e.target.value),onPressEnter:()=>{e(),u&&""!==p.trim()&&s(p,u)}})}const t=e.data;return d.createElement(d.Fragment,null,e.directory?e.title:d.createElement(d.Fragment,null,t.name,d.createElement("div",{className:"date"},t.createTime>0&&Fi(t.createTime)))," ")})(e)),cacheKey:n||t,rootTreeNodes:l}))};const Wi=e=>{const{bizData:t,menu:n,onRightMenuClick:i,refreshTreeData:r}=e,[o,s]=qn(`___biz_${t.id}`,!1),{uiStore:a}=be("BenchStore"),l="dependency3";return d.createElement("div",{className:"biz-item"},d.createElement("div",{onClick:()=>s(!o),className:f("title-line",{expanded:o})},d.createElement("div",{className:"left"},d.createElement(_e,{type:""+(o?"down2":"right2")}),t.name),d.createElement("div",{className:f(["right",o])},[l].map((e=>{const i=e;return d.createElement(_e,{key:i,onClick:e=>{(e=>{e===l&&a.addTab({tmp:!1,key:`biz_${t.id}_kanban`,menu:n,id:t.id,type:"dep_kanban",label:`${t.name}`})})(i),e.stopPropagation()},type:i})})))),o&&t.bizTreeData&&d.createElement(Bi,{refreshTreeData:r,onRightMenuClick:i,menu:"development",cacheKey:"biz_"+t.id,onSetup:e=>Mi("development",e),treeData:t.bizTreeData,onFileEnter:e.onFileEnter}))};const zi=e=>d.createElement("div",{className:"operation-bar-container operation-bar operation"},d.createElement(d.Fragment,null,e.options.map((t=>d.createElement(_e,{className:t.disabled?"disabled":"",type:t.icon,key:t.icon,tip:t.disabled?void 0:t.label,onClick:()=>!t.disabled&&e.onClick(t)})))));var Vi=p((e=>{const{moduleName:t,className:n}=e,[i,r]=h.exports.useState([]),{dataStore:o,uiStore:s}=be("BenchStore");Ze.exports.useAliveController();const c=o.workspaceData;h.exports.useEffect((()=>{i.includes(t)||(r([...i,t]),u())}),[t]);const u=async()=>{"development"==t?await o.fetchBizList():"query"==t?await o.fetchTempQueryTreeData():"trash"==t?await o.fetchDeleteFileList():"resource"===t?await o.fetchResourceTreeData():"document"===t?await o.fetchDocumentTreeData():"component"===t&&await o.fetchComponentTreeData()},g=(e,t)=>{if("delete"===t){const t=e.id,n=e.directory;(n?ne(t):ie(t)).then((e=>{e&&(M.success("删除成功！"),u(),!n&&s.closeTab(`file_${t}`))}))}},p=(e,n,i,r)=>{r=r||-1;const o=n.parentId||0,a=n.type,l=n.origin;if("add"===n.mode)if("folder"===a)re({workspaceId:c.id,bizId:r,name:e,moduleType:i,category:l.category,parentId:o}).then((()=>{M.success("创建成功！"),u()}));else{const a=n.iconType;oe({workspaceId:c.id,bizId:r,name:e,moduleType:i,fileType:a,folderId:o}).then((e=>{M.success("创建成功！"),u(),s.addTab({key:`file_${e.id}`,type:a,id:e.id,label:e.name,tmp:!0,menu:t})}))}else"rename"===n.mode&&("folder"===a?se({id:l.id,name:e,parentId:o}).then((()=>{M.success("修改成功！"),u()})):ae({id:l.id,name:e,folderId:o}).then((()=>{M.success("修改成功！"),u()})))},m=[{name:"refresh",icon:"refresh2"}];return"development"===t&&m.unshift({name:"biz",icon:"biz"}),function(e,t){var n=h.exports.useRef({});h.exports.useEffect((function(){if(n.current){var i=Object.keys(ii(ii({},n.current),t)),r={};i.forEach((function(e){n.current[e]!==t[e]&&(r[e]={from:n.current[e],to:t[e]})})),Object.keys(r).length&&console.log("[why-did-you-update]",e,r)}n.current=t}))}("why",l(a({},e),{moduleName:t,initedMenuList:i,dataStore:o,uiStore:s,tmpData:I(c.tmpQueryTreeData)})),d.createElement(d.Fragment,null,d.createElement("div",{className:f("module-container",n)},d.createElement("div",{className:"header"},d.createElement("div",{className:"title"},Ce[t].label),d.createElement(zi,{options:m,onClick:e=>{"refresh"===e.name&&u().then((()=>M.success("刷新成功！")))}})),d.createElement("div",{className:"main"},d.createElement(Ze.exports.AliveScope,null,(()=>{const e=e=>{return i=e,[{key:`category_${(n=Ce[t]).name}`,title:n.label,icon:e=>Ri(e,n.color),isLeaf:!1,children:i,id:-1,directory:!0,parentId:0}];var n,i};switch(t){case"development":return d.createElement(d.Fragment,null,c.bizList&&d.createElement(Ze.exports.KeepAlive,{id:t,name:t},d.createElement("div",{className:"biz-list"},c.bizList.map((e=>d.createElement(Wi,{onFileEnter:(t,n)=>p(t,n,"development",e.id),onRightMenuClick:g,key:e.id,bizData:e,menu:t,refreshTreeData:u}))))));case"query":const n=c.tmpQueryTreeData;return console.log("query data",I(n)),d.createElement(d.Fragment,null,n&&d.createElement(Ze.exports.KeepAlive,{id:t,name:t,data:n},d.createElement(Bi,{onFileEnter:(e,n)=>{p(e,n,t)},onRightMenuClick:g,menu:t,onSetup:e,treeData:n,refreshTreeData:u})));case"trash":const i={folders:[],files:c.deleteFileList||[]};return d.createElement(d.Fragment,null,i&&d.createElement(Ze.exports.KeepAlive,{id:t,name:t},d.createElement(Bi,{onRightMenuClick:g,menu:t,onSetup:e,treeData:i,refreshTreeData:u})));case"operation":const r=[{name:"运维大盘"},{name:"周期任务运维",children:["周期作业","周期实例","补数据实例"].map((e=>({name:e})))}];return d.createElement(d.Fragment,null,d.createElement(Ze.exports.KeepAlive,{id:t,name:t},d.createElement("div",{className:"flex flex-col"},d.createElement(ai,{showIcon:!1,rootTreeNodes:Ai(r),cacheKey:"operation",onClick:(e,n)=>{const i=e.key,r=i;["周期任务运维"].includes(r)||s.addTab({key:i,label:i,id:-1,type:r,menu:t,tmp:!1})}}))));case"resource":const o=c.resourceTreeData;return d.createElement(d.Fragment,null,o&&d.createElement(Ze.exports.KeepAlive,{id:t,name:t},d.createElement(Bi,{onFileEnter:(e,n)=>{p(e,n,t)},onRightMenuClick:g,menu:t,onSetup:e=>Mi(t,e),treeData:o,refreshTreeData:u})));case"component":const a=c.componentTreeData;return d.createElement(d.Fragment,null,a&&d.createElement(Ze.exports.KeepAlive,{id:t,name:t},d.createElement(Bi,{onFileEnter:(e,n)=>{p(e,n,t)},onRightMenuClick:g,menu:t,onSetup:e=>Mi(t,e),treeData:a,refreshTreeData:u})));case"document":const l=c.documentTreeData;return d.createElement(d.Fragment,null,l&&d.createElement(Ze.exports.KeepAlive,{id:t,name:t},d.createElement(Bi,{onFileEnter:(e,n)=>{p(e,n,t)},onRightMenuClick:g,menu:t,onSetup:e,treeData:l,refreshTreeData:u})));default:return d.createElement(d.Fragment,null)}})()))))}));const Ui=e=>{const{activeKey:t,className:n,onChangeTab:i,onCloseTab:r,showCloseIcon:o,titleRender:s=(e=>e.label),options:a,mode:l="horizontal",renderRightMenu:c}=e;return d.createElement("div",{className:f("tabs",l,n),style:e.style},a.map((e=>{const n=t===e.key,o=d.createElement("div",{onClick:()=>{i(e.key)},key:e.key,className:f("tab-item",{active:n})},s(e),r&&d.createElement("span",{className:"close",onClick:t=>{t.stopPropagation();const n=a.find((t=>t.key==e.key));n&&r(e.key,n)}},d.createElement(_e,{type:"close"})));return c?d.createElement(x,{key:e.key,trigger:["contextMenu"],overlay:c(e)},o):o})))},Hi=(e,t,n)=>{const{dataStore:i,uiStore:r}=be("BenchStore"),o=e.key,s=e.id,a=i.workspaceData.fileList.find((e=>e.id===s)),l=null==a?void 0:a.cfg,[c,u]=h.exports.useState(!1),d=()=>(u(!1),i.fetchFileDetail(s).then((e=>{e&&(t&&t(e),g())})).then((()=>{u(!0)}))),f=()=>r.setTabChange(o,!0),g=()=>r.setTabChange(o,!1);return h.exports.useEffect((()=>{if(s)return d().catch((e=>{console.error("加载文件异常",e),setTimeout((()=>{r.closeTab(o)}),500)})),()=>{n&&n()}}),[o]),{inited:c,fileData:a,cfg:l,dataStore:i,changeCfg:e=>{i.changeFileCfg(s,e),f()},changeContent:e=>{i.changeFileContent(s,e),f()},hideWindowFooter:()=>{r.setWindowFooterVisible(!0)},refresh:()=>d().then((()=>{M.success("刷新成功！")})),save:()=>{var e;return null==(e=i.saveFile(s))?void 0:e.then((()=>g()))}}};const ji={jdbc_hive:"/assets/jdbc_hive.d07ad940.png",jdbc_mysql:"/assets/jdbc_mysql.d27a7aa9.png"},Gi=A((e=>{const{windowTab:t}=e,{fileData:n,changeCfg:i,cfg:r,refresh:o,save:s}=Hi(e.windowTab),a=void 0!==(l=null==n?void 0:n.content.fileType)&&l.startsWith("jdbc");var l;const c=t.id,u=a&&r.param,h=e=>{i((t=>e(t.param)))};return d.createElement(d.Fragment,null,d.createElement("div",{className:"p-20 m-auto w-3/4"},d.createElement("div",{className:"my-20"},d.createElement("img",{style:{background:"transparent",height:"180px",userSelect:"none",margin:"auto",width:"auto"},src:ji[t.type]})),u&&a&&d.createElement(d.Fragment,null,d.createElement(O,{labelAlign:"left",labelCol:{span:2}},d.createElement(O.Item,{label:"JDBC连接"},d.createElement("input",{spellCheck:!1,className:"input w-full",value:u.jdbcUrl,onChange:e=>h((t=>t.jdbcUrl=e.target.value))})),d.createElement(O.Item,{label:"用户名"},d.createElement("input",{spellCheck:!1,className:"input w-full",value:u.username,onChange:e=>h((t=>t.username=e.target.value))})),d.createElement(O.Item,{label:"密码"},d.createElement("input",{spellCheck:!1,type:"password",className:"input w-full",value:u.password,onChange:e=>h((t=>t.password=e.target.value))})))),d.createElement("button",{className:"mr-10 button",onClick:o},"刷新"),d.createElement("button",{className:"mr-10 button",onClick:()=>{(e=>le.POST(`/resource/datasource/checkConnection?fileId=${e}`))(c).then((e=>{e?M.success("测试通过！"):M.error("测试不通过！")}))}},"测试连通性"),d.createElement("button",{className:"button",onClick:s},"保存")))}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var Ki=function(e,t){return(Ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function qi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Ki(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var $i=function(){return($i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function Yi(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function Xi(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(t){o(t)}}function a(e){try{l(i.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}function Zi(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Qi(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function Ji(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var er=function(e){return null!==e&&"function"!=typeof e&&isFinite(e.length)},tr=function(e,t){return!!er(e)&&e.indexOf(t)>-1},nr=function(e,t){if(!er(e))return e;for(var n=[],i=0;i<e.length;i++){var r=e[i];t(r,i)&&n.push(r)}return n},ir={}.toString,rr=function(e,t){return ir.call(e)==="[object "+t+"]"},or=function(e){return rr(e,"Function")},sr=function(e){return null==e},ar=function(e){return Array.isArray?Array.isArray(e):rr(e,"Array")},lr=function(e){var t=typeof e;return null!==e&&"object"===t||"function"===t};function cr(e,t){if(e)if(ar(e))for(var n=0,i=e.length;n<i&&!1!==t(e[n],n);n++);else if(lr(e))for(var r in e)if(e.hasOwnProperty(r)&&!1===t(e[r],r))break}var ur=Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];return cr(e,(function(n,i){or(e)&&"prototype"===i||t.push(i)})),t};function hr(e,t){var n=ur(t),i=n.length;if(sr(e))return!i;for(var r=0;r<i;r+=1){var o=n[r];if(t[o]!==e[o]||!(o in e))return!1}return!0}var dr=function(e){return"object"==typeof e&&null!==e},fr=function(e){if(!dr(e)||!rr(e,"Object"))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t};var gr=function(e,t){if(void 0===t&&(t=[]),ar(e))for(var n=0;n<e.length;n+=1)gr(e[n],t);else t.push(e);return t},pr=function(e){if(ar(e))return e.reduce((function(e,t){return Math.max(e,t)}),e[0])},mr=function(e){if(ar(e))return e.reduce((function(e,t){return Math.min(e,t)}),e[0])},vr=function(e){var t=e.filter((function(e){return!isNaN(e)}));if(!t.length)return{min:0,max:0};if(ar(e[0])){for(var n=[],i=0;i<e.length;i++)n=n.concat(e[i]);t=n}var r=pr(t);return{min:mr(t),max:r}},yr=Array.prototype,_r=yr.splice,br=yr.indexOf,wr=Array.prototype.splice,Cr=function(e,t){if(!er(e))return[];for(var n=e?t.length:0,i=n-1;n--;){var r=void 0,o=t[n];n!==i&&o===r||(r=o,wr.call(e,o,1))}return e},Sr=function(e,t,n){if(!ar(e)&&!fr(e))return e;var i=n;return cr(e,(function(e,n){i=t(i,e,n)})),i},xr=function(e){return rr(e,"String")};function Er(e,t){void 0===t&&(t=new Map);var n=[];if(Array.isArray(e))for(var i=0,r=e.length;i<r;i++){var o=e[i];t.has(o)||(n.push(o),t.set(o,!0))}return n}function kr(e){if(er(e))return e[0]}function Lr(e){if(er(e)){return e[e.length-1]}}var Dr=Object.prototype.hasOwnProperty;function Nr(e,t){if(!t||!ar(e))return{};for(var n,i={},r=or(t)?t:function(e){return e[t]},o=0;o<e.length;o++){var s=e[o];n=r(s),Dr.call(i,n)?i[n].push(s):i[n]=[s]}return i}function Ir(e,t){if(!t)return{0:e};if(!or(t)){var n=ar(t)?t:t.replace(/\s+/g,"").split("*");t=function(e){for(var t="_",i=0,r=n.length;i<r;i++)t+=e[n[i]]&&e[n[i]].toString();return t}}return Nr(e,t)}function Tr(e,t){if(e["_wrap_"+t])return e["_wrap_"+t];var n=function(n){e[t](n)};return e["_wrap_"+t]=n,n}var Mr={};var Ar=function(e,t){var n=t.toString(),i=n.indexOf(".");if(-1===i)return Math.round(e);var r=n.substr(i+1).length;return r>20&&(r=20),parseFloat(e.toFixed(r))},Or=function(e){return rr(e,"Number")},Rr=Number.isInteger?Number.isInteger:function(e){return Or(e)&&e%1==0};function Pr(e,t,n){return void 0===n&&(n=1e-5),Math.abs(e-t)<n}var Fr=function(e,t){return(e%t+t)%t},Br=180/Math.PI,Wr=parseInt,zr=Math.PI/180,Vr=function(e){return zr*e},Ur=function(e,t){return e.hasOwnProperty(t)},Hr=Object.values?function(e){return Object.values(e)}:function(e){var t=[];return cr(e,(function(n,i){or(e)&&"prototype"===i||t.push(n)})),t},jr=function(e){return sr(e)?"":e.toString()};var Gr=function(e){var t=jr(e);return t.charAt(0).toUpperCase()+t.substring(1)},Kr={}.toString,qr=function(e){return Kr.call(e).replace(/^\[object /,"").replace(/]$/,"")},$r=function(e){return rr(e,"Boolean")},Yr=function(e){return rr(e,"Date")};var Xr=Object.prototype,Zr=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Xr)};function Qr(e){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,16)})(e)}function Jr(e){(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout)(e)}function eo(e,t){for(var n in t)t.hasOwnProperty(n)&&"constructor"!==n&&void 0!==t[n]&&(e[n]=t[n])}function to(e,t,n,i){return t&&eo(e,t),n&&eo(e,n),i&&eo(e,i),e}var no=function(e){if("object"!=typeof e||null===e)return e;var t;if(ar(e)){t=[];for(var n=0,i=e.length;n<i;n++)"object"==typeof e[n]&&null!=e[n]?t[n]=no(e[n]):t[n]=e[n]}else for(var r in t={},e)"object"==typeof e[r]&&null!=e[r]?t[r]=no(e[r]):t[r]=e[r];return t};function io(e,t,n){var i;return function(){var r=this,o=arguments,s=function(){i=null,n||e.apply(r,o)},a=n&&!i;clearTimeout(i),i=setTimeout(s,t),a&&e.apply(r,o)}}var ro=function(e,t){if(!or(e))throw new TypeError("Expected a function");var n=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o=t?t.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var a=e.apply(this,i);return s.set(o,a),a};return n.cache=new Map,n};function oo(e,t,n,i){for(var r in n=n||0,i=i||5,t)if(t.hasOwnProperty(r)){var o=t[r];null!==o&&fr(o)?(fr(e[r])||(e[r]={}),n<i?oo(e[r],o,n+1,i):e[r]=t[r]):ar(o)?(e[r]=[],e[r]=e[r].concat(o)):void 0!==o&&(e[r]=o)}}var so=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=0;i<t.length;i+=1)oo(e,t[i]);return e},ao=function(e,t){if(!er(e))return-1;var n=Array.prototype.indexOf;if(n)return n.call(e,t);for(var i=-1,r=0;r<e.length;r++)if(e[r]===t){i=r;break}return i},lo=Object.prototype.hasOwnProperty;function co(e){if(sr(e))return!0;if(er(e))return!e.length;var t=qr(e);if("Map"===t||"Set"===t)return!e.size;if(Zr(e))return!Object.keys(e).length;for(var n in e)if(lo.call(e,n))return!1;return!0}var uo,ho=function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(xr(e)||xr(t))return!1;if(er(e)||er(t)){if(e.length!==t.length)return!1;for(var n=!0,i=0;i<e.length&&(n=ho(e[i],t[i]));i++);return n}if(dr(e)||dr(t)){var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(n=!0,i=0;i<r.length&&(n=ho(e[r[i]],t[r[i]]));i++);return n}return!1},fo=function(e,t){if(!er(e))return e;for(var n=[],i=0;i<e.length;i++){var r=e[i];n.push(t(r,i))}return n},go=function(e){return e},po=function(e,t,n){for(var i=0,r=xr(t)?t.split("."):t;e&&i<r.length;)e=e[r[i++]];return void 0===e||i<r.length?n:e},mo=Object.prototype.hasOwnProperty,vo=function(e,t,n){var i,r,o,s,a=0;n||(n={});var l=function(){a=!1===n.leading?0:Date.now(),i=null,s=e.apply(r,o),i||(r=o=null)},c=function(){var c=Date.now();a||!1!==n.leading||(a=c);var u=t-(c-a);return r=this,o=arguments,u<=0||u>t?(i&&(clearTimeout(i),i=null),a=c,s=e.apply(r,o),i||(r=o=null)):i||!1===n.trailing||(i=setTimeout(l,u)),s};return c.cancel=function(){clearTimeout(i),a=0,i=r=o=null},c},yo=function(e){return er(e)?Array.prototype.slice.call(e):[]},_o={},bo=function(e){return _o[e=e||"g"]?_o[e]+=1:_o[e]=1,e+_o[e]},wo=function(){};function Co(e){return sr(e)?0:er(e)?e.length:Object.keys(e).length}var So=ro((function(e,t){void 0===t&&(t={});var n=t.fontSize,i=t.fontFamily,r=t.fontWeight,o=t.fontStyle,s=t.fontVariant;return uo||(uo=document.createElement("canvas").getContext("2d")),uo.font=[o,s,r,n+"px",i].join(" "),uo.measureText(xr(e)?e:"").width}),(function(e,t){return void 0===t&&(t={}),Qi([e],Hr(t)).join("")})),xo=function(){function e(){this.map={}}return e.prototype.has=function(e){return void 0!==this.map[e]},e.prototype.get=function(e,t){var n=this.map[e];return void 0===n?t:n},e.prototype.set=function(e,t){this.map[e]=t},e.prototype.clear=function(){this.map={}},e.prototype.delete=function(e){delete this.map[e]},e.prototype.size=function(){return Object.keys(this.map).length},e}(),Eo=Object.freeze(Object.defineProperty({__proto__:null,contains:tr,includes:tr,difference:function(e,t){return void 0===t&&(t=[]),nr(e,(function(e){return!tr(t,e)}))},find:function(e,t){if(!ar(e))return null;var n;if(or(t)&&(n=t),fr(t)&&(n=function(e){return hr(e,t)}),n)for(var i=0;i<e.length;i+=1)if(n(e[i]))return e[i];return null},findIndex:function(e,t,n){void 0===n&&(n=0);for(var i=n;i<e.length;i++)if(t(e[i],i))return i;return-1},firstValue:function(e,t){for(var n=null,i=0;i<e.length;i++){var r=e[i][t];if(!sr(r)){n=ar(r)?r[0]:r;break}}return n},flatten:function(e){if(!ar(e))return[];for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]);return t},flattenDeep:gr,getRange:vr,pull:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=0;i<t.length;i++)for(var r=t[i],o=-1;(o=br.call(e,r))>-1;)_r.call(e,o,1);return e},pullAt:Cr,reduce:Sr,remove:function(e,t){var n=[];if(!er(e))return n;for(var i=-1,r=[],o=e.length;++i<o;){var s=e[i];t(s,i,e)&&(n.push(s),r.push(i))}return Cr(e,r),n},sortBy:function(e,t){var n;if(or(t))n=function(e,n){return t(e)-t(n)};else{var i=[];xr(t)?i.push(t):ar(t)&&(i=t),n=function(e,t){for(var n=0;n<i.length;n+=1){var r=i[n];if(e[r]>t[r])return 1;if(e[r]<t[r])return-1}return 0}}return e.sort(n),e},union:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Er([].concat.apply([],e))},uniq:Er,valuesOfKey:function(e,t){for(var n=[],i={},r=0;r<e.length;r++){var o=e[r][t];if(!sr(o)){ar(o)||(o=[o]);for(var s=0;s<o.length;s++){var a=o[s];i[a]||(n.push(a),i[a]=!0)}}}return n},head:kr,last:Lr,startsWith:function(e,t){return!(!ar(e)&&!xr(e))&&e[0]===t},endsWith:function(e,t){return!(!ar(e)&&!xr(e))&&e[e.length-1]===t},filter:nr,every:function(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0},some:function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n))return!0;return!1},group:function(e,t){if(!t)return[e];var n=Ir(e,t),i=[];for(var r in n)i.push(n[r]);return i},groupBy:Nr,groupToMap:Ir,getWrapBehavior:function(e,t){return e["_wrap_"+t]},wrapBehavior:Tr,number2color:function(e){var t=Mr[e];if(!t){for(var n=e.toString(16),i=n.length;i<6;i++)n="0"+n;t="#"+n,Mr[e]=t}return t},parseRadius:function(e){var t=0,n=0,i=0,r=0;return ar(e)?1===e.length?t=n=i=r=e[0]:2===e.length?(t=i=e[0],n=r=e[1]):3===e.length?(t=e[0],n=r=e[1],i=e[2]):(t=e[0],n=e[1],i=e[2],r=e[3]):t=n=i=r=e,{r1:t,r2:n,r3:i,r4:r}},clamp:function(e,t,n){return e<t?t:e>n?n:e},fixedBase:Ar,isDecimal:function(e){return Or(e)&&e%1!=0},isEven:function(e){return Or(e)&&e%2==0},isInteger:Rr,isNegative:function(e){return Or(e)&&e<0},isNumberEqual:Pr,isOdd:function(e){return Or(e)&&e%2!=0},isPositive:function(e){return Or(e)&&e>0},max:pr,maxBy:function(e,t){if(ar(e)){for(var n,i=-1/0,r=0;r<e.length;r++){var o=e[r],s=or(t)?t(o):o[t];s>i&&(n=o,i=s)}return n}},min:mr,minBy:function(e,t){if(ar(e)){for(var n,i=1/0,r=0;r<e.length;r++){var o=e[r],s=or(t)?t(o):o[t];s<i&&(n=o,i=s)}return n}},mod:Fr,toDegree:function(e){return Br*e},toInteger:Wr,toRadian:Vr,forIn:cr,has:Ur,hasKey:Ur,hasValue:function(e,t){return tr(Hr(e),t)},keys:ur,isMatch:hr,values:Hr,lowerCase:function(e){return jr(e).toLowerCase()},lowerFirst:function(e){var t=jr(e);return t.charAt(0).toLowerCase()+t.substring(1)},substitute:function(e,t){return e&&t?e.replace(/\\?\{([^{}]+)\}/g,(function(e,n){return"\\"===e.charAt(0)?e.slice(1):void 0===t[n]?"":t[n]})):e},upperCase:function(e){return jr(e).toUpperCase()},upperFirst:Gr,getType:qr,isArguments:function(e){return rr(e,"Arguments")},isArray:ar,isArrayLike:er,isBoolean:$r,isDate:Yr,isError:function(e){return rr(e,"Error")},isFunction:or,isFinite:function(e){return Or(e)&&isFinite(e)},isNil:sr,isNull:function(e){return null===e},isNumber:Or,isObject:lr,isObjectLike:dr,isPlainObject:fr,isPrototype:Zr,isRegExp:function(e){return rr(e,"RegExp")},isString:xr,isType:rr,isUndefined:function(e){return void 0===e},isElement:function(e){return e instanceof Element||e instanceof HTMLDocument},requestAnimationFrame:Qr,clearAnimationFrame:Jr,augment:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e[0],i=1;i<e.length;i++){var r=e[i];or(r)&&(r=r.prototype),to(n.prototype,r)}},clone:no,debounce:io,memoize:ro,deepMix:so,each:cr,extend:function(e,t,n,i){or(t)||(n=t,t=e,e=function(){});var r=Object.create?function(e,t){return Object.create(e,{constructor:{value:t}})}:function(e,t){function n(){}n.prototype=e;var i=new n;return i.constructor=t,i},o=r(t.prototype,e);return e.prototype=to(o,e.prototype),e.superclass=r(t.prototype,t),to(o,n),to(e,i),e},indexOf:ao,isEmpty:co,isEqual:ho,isEqualWith:function(e,t,n){return or(n)?!!n(e,t):ho(e,t)},map:fo,mapValues:function(e,t){void 0===t&&(t=go);var n={};return lr(e)&&!sr(e)&&Object.keys(e).forEach((function(i){n[i]=t(e[i],i)})),n},mix:to,assign:to,get:po,set:function(e,t,n){var i=e,r=xr(t)?t.split("."):t;return r.forEach((function(e,t){t<r.length-1?(lr(i[e])||(i[e]=Or(r[t+1])?[]:{}),i=i[e]):i[e]=n})),e},pick:function(e,t){if(null===e||!fr(e))return{};var n={};return cr(t,(function(t){mo.call(e,t)&&(n[t]=e[t])})),n},omit:function(e,t){return Sr(e,(function(e,n,i){return t.includes(i)||(e[i]=n),e}),{})},throttle:vo,toArray:yo,toString:jr,uniqueId:bo,noop:wo,identity:function(e){return e},size:Co,measureTextWidth:So,getEllipsisText:function(e,t,n,i){void 0===i&&(i="...");var r,o,s=So(i,n),a=xr(e)?e:jr(e),l=t,c=[];if(So(e,n)<=t)return e;for(;r=a.substr(0,16),!((o=So(r,n))+s>l&&o>l);)if(c.push(r),l-=o,!(a=a.substr(16)))return c.join("");for(;r=a.substr(0,1),!((o=So(r,n))+s>l);)if(c.push(r),l-=o,!(a=a.substr(1)))return c.join("");return""+c.join("")+i},Cache:xo},Symbol.toStringTag,{value:"Module"})),ko={getDefaultCfg:function(){return{}},getEvents:function(){return{}},updateCfg:function(e){return Object.assign(this,e),!0},shouldBegin:function(){return!0},shouldUpdate:function(){return!0},shouldEnd:function(){return!0},bind:function(e){var t=this,n=this.events;this.graph=e,"drag-canvas"!==this.type&&"brush-select"!==this.type&&"lasso-select"!==this.type||e.get("canvas").set("draggable",!0),cr(n,(function(t,n){e.on(n,t)})),document.addEventListener("visibilitychange",(function(){t.keydown=!1}))},unbind:function(e){var t=this.events,n=e.get("canvas").get("draggable");"drag-canvas"!==this.type&&"brush-select"!==this.type&&"lasso-select"!==this.type||e.get("canvas").set("draggable",!1),cr(t,(function(t,n){e.off(n,t)})),e.get("canvas").set("draggable",n)},get:function(e){return this[e]},set:function(e,t){return this[e]=t,this}},Lo=function(){function e(){}return e.registerBehavior=function(t,n){if(!n)throw new Error("please specify handler for this behavior: ".concat(t));var i=no(ko);Object.assign(i,n);var r=function(e){var t=this;Object.assign(this,this.getDefaultCfg(),e);var n=this.getEvents();this.events=null;var i={};n&&(cr(n,(function(e,n){i[n]=Tr(t,e)})),this.events=i)};r.prototype=i,e.types[t]=r},e.hasBehavior=function(t){return!!e.types[t]},e.getBehavior=function(t){return e.types[t]},e.types={},e}(),Do=function(){function e(){this._events={}}return e.prototype.on=function(e,t,n){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,once:!!n}),this},e.prototype.once=function(e,t){return this.on(e,t,!0)},e.prototype.emit=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=this._events[e]||[],o=this._events["*"]||[],s=function(i){for(var r=i.length,o=0;o<r;o++)if(i[o]){var s=i[o],a=s.callback;s.once&&(i.splice(o,1),0===i.length&&delete t._events[e],r--,o--),a.apply(t,n)}};s(r),s(o)},e.prototype.off=function(e,t){if(e)if(t){for(var n=this._events[e]||[],i=n.length,r=0;r<i;r++)n[r].callback===t&&(n.splice(r,1),i--,r--);0===n.length&&delete this._events[e]}else delete this._events[e];else this._events={};return this},e.prototype.getEvents=function(){return this._events},e}(),No="undefined"!=typeof Float32Array?Float32Array:Array;function Io(){var e=new No(9);return No!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function To(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Mo(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*s-a*c,d=-u*o+a*l,f=c*o-s*l,g=n*h+i*d+r*f;return g?(g=1/g,e[0]=h*g,e[1]=(-u*i+r*c)*g,e[2]=(a*i-r*s)*g,e[3]=d*g,e[4]=(u*n-r*l)*g,e[5]=(-a*n+r*o)*g,e[6]=f*g,e[7]=(-c*n+i*l)*g,e[8]=(s*n-i*o)*g,e):null}function Ao(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],f=n[1],g=n[2],p=n[3],m=n[4],v=n[5],y=n[6],_=n[7],b=n[8];return e[0]=d*i+f*s+g*c,e[1]=d*r+f*a+g*u,e[2]=d*o+f*l+g*h,e[3]=p*i+m*s+v*c,e[4]=p*r+m*a+v*u,e[5]=p*o+m*l+v*h,e[6]=y*i+_*s+b*c,e[7]=y*r+_*a+b*u,e[8]=y*o+_*l+b*h,e}function Oo(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Ro(e,t){var n=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=n,e[2]=0,e[3]=-n,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Po(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Fo(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],g=t[12],p=t[13],m=t[14],v=t[15],y=n*a-i*s,_=n*l-r*s,b=n*c-o*s,w=i*l-r*a,C=i*c-o*a,S=r*c-o*l,x=u*p-h*g,E=u*m-d*g,k=u*v-f*g,L=h*m-d*p,D=h*v-f*p,N=d*v-f*m,I=y*N-_*D+b*L+w*k-C*E+S*x;return I?(I=1/I,e[0]=(a*N-l*D+c*L)*I,e[1]=(l*k-s*N-c*E)*I,e[2]=(s*D-a*k+c*x)*I,e[3]=(r*D-i*N-o*L)*I,e[4]=(n*N-r*k+o*E)*I,e[5]=(i*k-n*D-o*x)*I,e[6]=(p*S-m*C+v*w)*I,e[7]=(m*b-g*S-v*_)*I,e[8]=(g*C-p*b+v*y)*I,e):null}function Bo(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Wo=Ao,zo=Bo,Vo=Object.freeze(Object.defineProperty({__proto__:null,create:Io,fromMat4:To,clone:function(e){var t=new No(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromValues:function(e,t,n,i,r,o,s,a,l){var c=new No(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=i,c[4]=r,c[5]=o,c[6]=s,c[7]=a,c[8]=l,c},set:function(e,t,n,i,r,o,s,a,l,c){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e[4]=o,e[5]=s,e[6]=a,e[7]=l,e[8]=c,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(e===t){var n=t[1],i=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=i,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},invert:Mo,adjoint:function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e[0]=s*u-a*c,e[1]=r*c-i*u,e[2]=i*a-r*s,e[3]=a*l-o*u,e[4]=n*u-r*l,e[5]=r*o-n*a,e[6]=o*c-s*l,e[7]=i*l-n*c,e[8]=n*s-i*o,e},determinant:function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*(c*o-s*l)+n*(-c*r+s*a)+i*(l*r-o*a)},multiply:Ao,translate:function(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],f=n[1];return e[0]=i,e[1]=r,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=d*i+f*s+c,e[7]=d*r+f*a+u,e[8]=d*o+f*l+h,e},rotate:function(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(n),f=Math.cos(n);return e[0]=f*i+d*s,e[1]=f*r+d*a,e[2]=f*o+d*l,e[3]=f*s-d*i,e[4]=f*a-d*r,e[5]=f*l-d*o,e[6]=c,e[7]=u,e[8]=h,e},scale:function(e,t,n){var i=n[0],r=n[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromTranslation:Oo,fromRotation:Ro,fromScaling:Po,fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromQuat:function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,h=i*a,d=r*s,f=r*a,g=r*l,p=o*s,m=o*a,v=o*l;return e[0]=1-h-g,e[3]=u-v,e[6]=d+m,e[1]=u+v,e[4]=1-c-g,e[7]=f-p,e[2]=d-m,e[5]=f+p,e[8]=1-c-h,e},normalFromMat4:Fo,projection:function(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},subtract:Bo,multiplyScalar:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},multiplyScalarAndAdd:function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e[3]=t[3]+n[3]*i,e[4]=t[4]+n[4]*i,e[5]=t[5]+n[5]*i,e[6]=t[6]+n[6]*i,e[7]=t[7]+n[7]*i,e[8]=t[8]+n[8]*i,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},equals:function(e,t){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=t[0],d=t[1],f=t[2],g=t[3],p=t[4],m=t[5],v=t[6],y=t[7],_=t[8];return Math.abs(n-h)<=1e-6*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-d)<=1e-6*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(r-f)<=1e-6*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(o-g)<=1e-6*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(s-p)<=1e-6*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-m)<=1e-6*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-v)<=1e-6*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(c-y)<=1e-6*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-_)<=1e-6*Math.max(1,Math.abs(u),Math.abs(_))},mul:Wo,sub:zo},Symbol.toStringTag,{value:"Module"}));function Uo(){var e=new No(16);return No!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ho(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function jo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Go(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],g=t[12],p=t[13],m=t[14],v=t[15],y=n*a-i*s,_=n*l-r*s,b=n*c-o*s,w=i*l-r*a,C=i*c-o*a,S=r*c-o*l,x=u*p-h*g,E=u*m-d*g,k=u*v-f*g,L=h*m-d*p,D=h*v-f*p,N=d*v-f*m,I=y*N-_*D+b*L+w*k-C*E+S*x;return I?(I=1/I,e[0]=(a*N-l*D+c*L)*I,e[1]=(r*D-i*N-o*L)*I,e[2]=(p*S-m*C+v*w)*I,e[3]=(d*C-h*S-f*w)*I,e[4]=(l*k-s*N-c*E)*I,e[5]=(n*N-r*k+o*E)*I,e[6]=(m*b-g*S-v*_)*I,e[7]=(u*S-d*b+f*_)*I,e[8]=(s*D-a*k+c*x)*I,e[9]=(i*k-n*D-o*x)*I,e[10]=(g*C-p*b+v*y)*I,e[11]=(h*b-u*C-f*y)*I,e[12]=(a*E-s*L-l*x)*I,e[13]=(n*L-i*E+r*x)*I,e[14]=(p*_-g*w-m*y)*I,e[15]=(u*w-h*_+d*y)*I,e):null}function Ko(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],g=t[11],p=t[12],m=t[13],v=t[14],y=t[15],_=n[0],b=n[1],w=n[2],C=n[3];return e[0]=_*i+b*a+w*h+C*p,e[1]=_*r+b*l+w*d+C*m,e[2]=_*o+b*c+w*f+C*v,e[3]=_*s+b*u+w*g+C*y,_=n[4],b=n[5],w=n[6],C=n[7],e[4]=_*i+b*a+w*h+C*p,e[5]=_*r+b*l+w*d+C*m,e[6]=_*o+b*c+w*f+C*v,e[7]=_*s+b*u+w*g+C*y,_=n[8],b=n[9],w=n[10],C=n[11],e[8]=_*i+b*a+w*h+C*p,e[9]=_*r+b*l+w*d+C*m,e[10]=_*o+b*c+w*f+C*v,e[11]=_*s+b*u+w*g+C*y,_=n[12],b=n[13],w=n[14],C=n[15],e[12]=_*i+b*a+w*h+C*p,e[13]=_*r+b*l+w*d+C*m,e[14]=_*o+b*c+w*f+C*v,e[15]=_*s+b*u+w*g+C*y,e}function qo(e,t,n){var i,r,o,s,a,l,c,u,h,d,f,g,p=n[0],m=n[1],v=n[2];return t===e?(e[12]=t[0]*p+t[4]*m+t[8]*v+t[12],e[13]=t[1]*p+t[5]*m+t[9]*v+t[13],e[14]=t[2]*p+t[6]*m+t[10]*v+t[14],e[15]=t[3]*p+t[7]*m+t[11]*v+t[15]):(i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],g=t[11],e[0]=i,e[1]=r,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=f,e[11]=g,e[12]=i*p+a*m+h*v+t[12],e[13]=r*p+l*m+d*v+t[13],e[14]=o*p+c*m+f*v+t[14],e[15]=s*p+u*m+g*v+t[15]),e}function $o(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Yo(e,t){var n=t[0],i=t[1],r=t[2],o=t[4],s=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.hypot(n,i,r),e[1]=Math.hypot(o,s,a),e[2]=Math.hypot(l,c,u),e}function Xo(e,t){var n=new No(3);Yo(n,t);var i=1/n[0],r=1/n[1],o=1/n[2],s=t[0]*i,a=t[1]*r,l=t[2]*o,c=t[4]*i,u=t[5]*r,h=t[6]*o,d=t[8]*i,f=t[9]*r,g=t[10]*o,p=s+u+g,m=0;return p>0?(m=2*Math.sqrt(p+1),e[3]=.25*m,e[0]=(h-f)/m,e[1]=(d-l)/m,e[2]=(a-c)/m):s>u&&s>g?(m=2*Math.sqrt(1+s-u-g),e[3]=(h-f)/m,e[0]=.25*m,e[1]=(a+c)/m,e[2]=(d+l)/m):u>g?(m=2*Math.sqrt(1+u-s-g),e[3]=(d-l)/m,e[0]=(a+c)/m,e[1]=.25*m,e[2]=(h+f)/m):(m=2*Math.sqrt(1+g-s-u),e[3]=(a-c)/m,e[0]=(d+l)/m,e[1]=(h+f)/m,e[2]=.25*m),e}function Zo(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,h=i*a,d=r*s,f=r*a,g=r*l,p=o*s,m=o*a,v=o*l;return e[0]=1-h-g,e[1]=u+v,e[2]=d-m,e[3]=0,e[4]=u-v,e[5]=1-c-g,e[6]=f+p,e[7]=0,e[8]=d+m,e[9]=f-p,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var Qo=function(e,t,n,i,r){var o,s=1/Math.tan(t/2);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(o=1/(i-r),e[10]=(r+i)*o,e[14]=2*r*i*o):(e[10]=-1,e[14]=-2*i),e};var Jo=function(e,t,n,i,r,o,s){var a=1/(t-n),l=1/(i-r),c=1/(o-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(r+i)*l,e[14]=(s+o)*c,e[15]=1,e};function es(){var e=new No(3);return No!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ts(e){var t=new No(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ns(e){var t=e[0],n=e[1],i=e[2];return Math.hypot(t,n,i)}function is(e,t,n){var i=new No(3);return i[0]=e,i[1]=t,i[2]=n,i}function rs(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function os(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e}function ss(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function as(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function ls(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function cs(e,t){var n=t[0],i=t[1],r=t[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function us(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function hs(e,t,n,i){var r=t[0],o=t[1],s=t[2];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e[2]=s+i*(n[2]-s),e}function ds(e,t,n){var i=t[0],r=t[1],o=t[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,e[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,e[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,e[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,e}function fs(e,t,n){var i=t[0],r=t[1],o=t[2];return e[0]=i*n[0]+r*n[3]+o*n[6],e[1]=i*n[1]+r*n[4]+o*n[7],e[2]=i*n[2]+r*n[5]+o*n[8],e}var gs=as,ps=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return Math.hypot(n,i,r)},ms=ns;function vs(){var e=new No(4);return No!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ys(e,t,n,i){var r=new No(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function _s(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,e[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,e[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,e[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,e}function bs(){var e=new No(4);return No!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function ws(e,t,n){n*=.5;var i=Math.sin(n);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(n),e}function Cs(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=n[0],l=n[1],c=n[2],u=n[3];return e[0]=i*u+s*a+r*c-o*l,e[1]=r*u+s*l+o*a-i*c,e[2]=o*u+s*c+i*l-r*a,e[3]=s*u-i*a-r*l-o*c,e}function Ss(e,t,n,i){var r,o,s,a,l,c=t[0],u=t[1],h=t[2],d=t[3],f=n[0],g=n[1],p=n[2],m=n[3];return(o=c*f+u*g+h*p+d*m)<0&&(o=-o,f=-f,g=-g,p=-p,m=-m),1-o>1e-6?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-i)*r)/s,l=Math.sin(i*r)/s):(a=1-i,l=i),e[0]=a*c+l*f,e[1]=a*u+l*g,e[2]=a*h+l*p,e[3]=a*d+l*m,e}function xs(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=n*n+i*i+r*r+o*o,a=s?1/s:0;return e[0]=-n*a,e[1]=-i*a,e[2]=-r*a,e[3]=o*a,e}function Es(e,t,n,i){var r=.5*Math.PI/180;t*=r,n*=r,i*=r;var o=Math.sin(t),s=Math.cos(t),a=Math.sin(n),l=Math.cos(n),c=Math.sin(i),u=Math.cos(i);return e[0]=o*l*u-s*a*c,e[1]=s*a*u+o*l*c,e[2]=s*l*c-o*a*u,e[3]=s*l*u+o*a*c,e}es(),function(){var e=vs()}();var ks=ys,Ls=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Ds=Cs,Ns=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=n*n+i*i+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=i*s,e[2]=r*s,e[3]=o*s,e};function Is(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Ts(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function Ms(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function As(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function Os(e,t){var n=t[0]-e[0],i=t[1]-e[1];return Math.hypot(n,i)}function Rs(e,t){var n=t[0],i=t[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e}function Ps(e,t){return e[0]*t[0]+e[1]*t[1]}function Fs(e,t){return e[0]===t[0]&&e[1]===t[1]}es(),is(1,0,0),is(0,1,0),bs(),bs(),Io();var Bs=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e};function Ws(e,t,n){var i=[0,0,0,0,0,0,0,0,0];return Ro(i,n),Ao(e,i,t)}function zs(e,t,n){var i=[0,0,0,0,0,0,0,0,0];return Po(i,n),Ao(e,i,t)}function Vs(e,t,n){return Ao(e,n,t)}function Us(e,t){for(var n,i,r,o,s=e?[].concat(e):[1,0,0,0,1,0,0,0,1],a=0,l=t.length;a<l;a++){var c=t[a];switch(c[0]){case"t":n=s,i=s,r=[c[1],c[2]],o=void 0,Oo(o=[0,0,0,0,0,0,0,0,0],r),Ao(n,o,i);break;case"s":zs(s,s,[c[1],c[2]]);break;case"r":Ws(s,s,c[1]);break;case"m":Vs(s,s,c[1])}}return s}!function(){var e,t=(e=new No(2),No!=Float32Array&&(e[0]=0,e[1]=0),e)}();var Hs=function(e,t){var n=e.nodes,i=e.edges,r=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach((function(e,t){o[e.id]=t;r.push([])})),i&&i.forEach((function(e){var n=e.source,i=e.target,s=o[n],a=o[i];!s&&0!==s||!a&&0!==a||(r[s][a]=1,t||(r[a][s]=1))})),r},js=function(e,t){return e===t},Gs=function(){function e(e,t){void 0===t&&(t=null),this.value=e,this.next=t}return e.prototype.toString=function(e){return e?e(this.value):"".concat(this.value)},e}(),Ks=function(){function e(e){void 0===e&&(e=js),this.head=null,this.tail=null,this.compare=e}return e.prototype.prepend=function(e){var t=new Gs(e,this.head);return this.head=t,this.tail||(this.tail=t),this},e.prototype.append=function(e){var t=new Gs(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},e.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t},e.prototype.find=function(e){var t=e.value,n=void 0===t?void 0:t,i=e.callback,r=void 0===i?void 0:i;if(!this.head)return null;for(var o=this.head;o;){if(r&&r(o.value))return o;if(void 0!==n&&this.compare(o.value,n))return o;o=o.next}return null},e.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e},e.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e},e.prototype.fromArray=function(e){var t=this;return e.forEach((function(e){return t.append(e)})),this},e.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e},e.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t},e.prototype.toString=function(e){return void 0===e&&(e=void 0),this.toArray().map((function(t){return t.toString(e)})).toString()},e}(),qs=function(){function e(){this.linkedList=new Ks}return e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},e.prototype.enqueue=function(e){this.linkedList.append(e)},e.prototype.dequeue=function(){var e=this.linkedList.deleteHead();return e?e.value:null},e.prototype.toString=function(e){return this.linkedList.toString(e)},e}(),$s=function(e,t,n){void 0===t&&(t=[]);var i=t.filter((function(t){return t.source===e||t.target===e}));if("target"===n){return i.filter((function(t){return t.source===e})).map((function(e){return e.target}))}if("source"===n){return i.filter((function(t){return t.target===e})).map((function(e){return e.source}))}return i.map((function(t){return t.source===e?t.target:t.source}))},Ys=function(e,t){return t.filter((function(t){return t.source===e||t.target===e}))},Xs=function(e){void 0===e&&(e=0);var t="".concat(Math.random()).split(".")[1].substr(0,5),n="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(e,"-").concat(t).concat(n)};var Zs=function(e,t,n,i){void 0===i&&(i=!0);var r=function(e){void 0===e&&(e={});var t,n=e,i=function(){},r=(t={},function(e){var n=e.next;return!t[n]&&(t[n]=!0,!0)});return n.allowTraversal=e.allowTraversal||r,n.enter=e.enter||i,n.leave=e.leave||i,n}(n),o=new qs,s=e.edges,a=void 0===s?[]:s;o.enqueue(t);for(var l="",c=function(){var e=o.dequeue();r.enter({current:e,previous:l}),$s(e,a,i?"target":void 0).forEach((function(t){r.allowTraversal({previous:l,current:e,next:t})&&o.enqueue(t)})),r.leave({current:e,previous:l}),l=e};!o.isEmpty();)c()},Qs=function(e){for(var t=e.nodes,n=void 0===t?[]:t,i=e.edges,r=void 0===i?[]:i,o=[],s={},a={},l={},c=[],u=0,h=function e(t){a[t.id]=u,l[t.id]=u,u+=1,o.push(t),s[t.id]=!0;for(var i=$s(t.id,r,"target").filter((function(e){return n.map((function(e){return e.id})).indexOf(e)>-1})),h=function(r){var o=i[r];if(a[o]||0===a[o])s[o]&&(l[t.id]=Math.min(l[t.id],a[o]));else{var c=n.filter((function(e){return e.id===o}));c.length>0&&e(c[0]),l[t.id]=Math.min(l[t.id],l[o])}},d=0;d<i.length;d++)h(d);if(l[t.id]===a[t.id]){for(var f=[];o.length>0;){var g=o.pop();if(s[g.id]=!1,f.push(g),g===t)break}f.length>0&&c.push(f)}},d=0,f=n;d<f.length;d++){var g=f[d];a[g.id]||0===a[g.id]||h(g)}return c};function Js(e,t){return t?Qs(e):function(e){for(var t=e.nodes,n=void 0===t?[]:t,i=e.edges,r=void 0===i?[]:i,o=[],s={},a=[],l=function e(t){a.push(t),s[t.id]=!0;for(var i=$s(t.id,r),o=function(t){var r=i[t];if(!s[r]){var o=n.filter((function(e){return e.id===r}));o.length>0&&e(o[0])}},l=0;l<i.length;++l)o(l)},c=0;c<n.length;c++){var u=n[c];if(!s[u.id]){l(u);for(var h=[];a.length>0;)h.push(a.pop());o.push(h)}}return o}(e)}var ea=function(e){var t={},n=e.nodes,i=void 0===n?[]:n,r=e.edges,o=void 0===r?[]:r;return i.forEach((function(e){t[e.id]={degree:0,inDegree:0,outDegree:0}})),o.forEach((function(e){t[e.source].degree++,t[e.source].outDegree++,t[e.target].degree++,t[e.target].inDegree++})),t},ta=function(e,t){return ea(e)[t]?ea(e)[t].inDegree:0},na=function(e,t){return ea(e)[t]?ea(e)[t].outDegree:0};function ia(e,t,n,i){i.enter({current:t,previous:n});var r=e.edges;$s(t,void 0===r?[]:r,"target").forEach((function(r){i.allowTraversal({previous:n,current:t,next:r})&&ia(e,r,t,i)})),i.leave({current:t,previous:n})}function ra(e,t,n){ia(e,t,"",function(e){void 0===e&&(e={});var t,n=e,i=function(){},r=(t={},function(e){var n=e.next;return!t[n]&&(t[n]=!0,!0)});return n.allowTraversal=e.allowTraversal||r,n.enter=e.enter||i,n.leave=e.leave||i,n}(n))}var oa=function(e){var t=null,n=e.nodes,i={},r={},o={},s={};(void 0===n?[]:n).forEach((function(e){r[e.id]=e}));for(var a={enter:function(e){var n=e.current,s=e.previous;if(o[n]){t={};for(var a=n,l=s;l!==n;)t[a]=l,a=l,l=i[l];t[a]=l}else o[n]=n,delete r[n],i[n]=s},leave:function(e){var t=e.current;s[t]=t,delete o[t]},allowTraversal:function(e){var n=e.next;return!t&&!s[n]}};Object.keys(r).length;){ra(e,Object.keys(r)[0],a)}return t},sa=function(e,t,n){var i,r;void 0===n&&(n=!0);for(var o=[],s=0,a=Js(e,!1);s<a.length;s++){var l=a[s];if(l.length)for(var c=l[0],u=c.id,h=[c],d=((i={})[u]=c,i),f=((r={})[u]=new Set,r);h.length>0;)for(var g=h.pop(),p=g.id,m=$s(p,e.edges),v=function(i){var r,s=m[i],a=e.nodes.find((function(e){return e.id===s}));if(s===p)o.push(((r={})[s]=g,r));else if(s in f){if(!f[p].has(a)){for(var l=!0,c=[a,g],u=d[p];f[s].size&&!f[s].has(u)&&(c.push(u),u!==d[u.id]);)u=d[u.id];if(c.push(u),t&&n?(l=!1,c.findIndex((function(e){return t.indexOf(e.id)>-1}))>-1&&(l=!0)):t&&!n&&c.findIndex((function(e){return t.indexOf(e.id)>-1}))>-1&&(l=!1),l){for(var v={},y=1;y<c.length;y+=1)v[c[y-1].id]=c[y];c.length&&(v[c[c.length-1].id]=c[0]),o.push(v)}f[s].add(g)}}else d[s]=g,h.push(a),f[s]=new Set([g])},y=0;y<m.length;y+=1)v(y)}return o},aa=function(e,t,n){void 0===n&&(n=!0);for(var i=[],r=new Set,o=[],s=[],a={},l={},c=function e(l,c,u){var h=!1;if(t&&!1===n&&t.indexOf(l.id)>-1)return h;i.push(l),r.add(l);for(var d=u[l.id],f=0;f<d.length;f+=1){if((m=a[d[f]])===c){for(var g={},p=1;p<i.length;p+=1)g[i[p-1].id]=i[p];i.length&&(g[i[i.length-1].id]=i[0]),s.push(g),h=!0}else r.has(m)||e(m,c,u)&&(h=!0)}if(h)!function(e){for(var t=[e];t.length>0;){var n=t.pop();r.has(n)&&(r.delete(n),o[n.id].forEach((function(e){t.push(e)})),o[n.id].clear())}}(l);else for(f=0;f<d.length;f+=1){var m=a[d[f]];o[m.id].has(l)||o[m.id].add(l)}return i.pop(),h},u=e.nodes,h=void 0===u?[]:u,d=0;d<h.length;d+=1){var f=h[d],g=f.id;l[g]=d,a[d]=f}if(t&&n){var p=function(e){var n=t[e];l[h[e].id]=l[n],l[n]=0,a[0]=h.find((function(e){return e.id===n})),a[l[h[e].id]]=h[e]};for(d=0;d<t.length;d++)p(d)}for(var m=function(i){for(var r,o,a=1/0,c=0;c<i.length;c+=1)for(var u=i[c],h=0;h<u.length;h++){var d=l[u[h].id];d<a&&(a=d,o=c)}var f=i[o],g=[];for(c=0;c<f.length;c+=1){var p=f[c];g[p.id]=[];for(var m=0,v=$s(p.id,e.edges,"target").filter((function(e){return f.map((function(e){return e.id})).indexOf(e)>-1}));m<v.length;m++){var y=v[m];y!==p.id||!1===n&&t.indexOf(p.id)>-1?g[p.id].push(l[y]):s.push(((r={})[p.id]=p,r))}}return{component:f,adjList:g,minIdx:a}},v=0;v<h.length;){var y=h.filter((function(e){return l[e.id]>=v})),_=Qs({nodes:y,edges:e.edges}).filter((function(e){return e.length>1}));if(0===_.length)break;var b=m(_),w=b.minIdx,C=b.adjList,S=b.component;if(!(S.length>1))break;S.forEach((function(e){o[e.id]=new Set}));var x=a[w];if(t&&n&&-1===t.indexOf(x.id))return s;c(x,x,C),v=w+1}return s},la=function(e,t,n,i){return void 0===i&&(i=!0),t?aa(e,n,i):sa(e,n,i)},ca=function(e,t,n,i){var r=e.nodes,o=void 0===r?[]:r,s=e.edges,a=void 0===s?[]:s,l={},c={},u={};o.forEach((function(e,n){var i=e.id;c[i]=1/0,i===t&&(c[i]=0)}));for(var h=o.length,d=function(e){var t=function(e,t,n){for(var i,r=1/0,o=0;o<t.length;o++){var s=t[o].id;!n[s]&&e[s]<=r&&(r=e[s],i=t[o])}return i}(c,o,l),r=t.id;if(l[r]=!0,c[r]===1/0)return"continue";(n?function(e,t){return t.filter((function(t){return t.source===e}))}(r,a):Ys(r,a)).forEach((function(e){var n=e.target,o=e.source,s=n===r?o:n,a=i&&e[i]?e[i]:1;c[s]>c[t.id]+a?(c[s]=c[t.id]+a,u[s]=[t.id]):c[s]===c[t.id]+a&&u[s].push(t.id)}))},f=0;f<h;f++)d();u[t]=[t];var g={};for(var p in c)c[p]!==1/0&&ua(t,p,u,g);var m={};for(var p in g)m[p]=g[p][0];return{length:c,path:m,allPath:g}};function ua(e,t,n,i){if(e===t)return[e];if(i[t])return i[t];for(var r=[],o=0,s=n[t];o<s.length;o++){var a=ua(e,s[o],n,i);if(!a)return;for(var l=0,c=a;l<c.length;l++){var u=c[l];ar(u)?r.push(Ji(Ji([],u,!0),[t],!1)):r.push([u,t])}}return i[t]=r,i[t]}var ha,da=function(e,t,n,i,r){var o=ca(e,t,i,r),s=o.length,a=o.path,l=o.allPath;return{length:s[n],path:a[n],allPath:l[n]}},fa=function(e,t,n,i){var r;if(t===n)return[[t]];var o=e.edges,s=void 0===o?[]:o,a=[t],l=((r={})[t]=!0,r),c=[],u=[],h=i?$s(t,s,"target"):$s(t,s);for(c.push(h);a.length>0&&c.length>0;){var d=c[c.length-1];if(d.length){var f=d.shift();if(f&&(a.push(f),l[f]=!0,h=i?$s(f,s,"target"):$s(f,s),c.push(h.filter((function(e){return!l[e]})))),a[a.length-1]===n){var g=a.map((function(e){return e}));u.push(g);p=a.pop();l[p]=!1,c.pop()}}else{var p=a.pop();l[p]=!1,c.pop()}}return u},ga=function(e,t){for(var n=Hs(e,t),i=[],r=n.length,o=0;o<r;o+=1){i[o]=[];for(var s=0;s<r;s+=1)o===s?i[o][s]=0:0!==n[o][s]&&n[o][s]?i[o][s]=n[o][s]:i[o][s]=1/0}for(var a=0;a<r;a+=1)for(o=0;o<r;o+=1)for(s=0;s<r;s+=1)i[o][s]>i[o][a]+i[a][s]&&(i[o][s]=i[o][a]+i[a][s]);return i},pa=function(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n="weight"),void 0===i&&(i=1e3);var r=e.nodes,o=void 0===r?[]:r,s=e.edges,a=void 0===s?[]:s,l={},c={};o.forEach((function(e,t){var n=Xs();e.clusterId=n,l[n]={id:n,nodes:[e]},c[e.id]={node:e,idx:t}}));var u=Hs(e,t),h={};u.forEach((function(e,t){var n=o[t].id;h[n]={},e.forEach((function(e,t){if(e){var i=o[t].id;h[n][i]=e}}))}));for(var d=0,f=function(){var e=!1;if(o.forEach((function(t){var n={};Object.keys(h[t.id]).forEach((function(e){var i=h[t.id][e],r=c[e].node.clusterId;n[r]||(n[r]=0),n[r]+=i}));var i=-1/0,r=[];if(Object.keys(n).forEach((function(e){i<n[e]?(i=n[e],r=[e]):i===n[e]&&r.push(e)})),1!==r.length||r[0]!==t.clusterId){var o=r.indexOf(t.clusterId);if(o>=0&&r.splice(o,1),r&&r.length){e=!0;var s=l[t.clusterId],a=s.nodes.indexOf(t);s.nodes.splice(a,1);var u=Math.floor(Math.random()*r.length),d=l[r[u]];d.nodes.push(t),t.clusterId=d.id}}})),!e)return"break";d++};d<i;){if("break"===f())break}Object.keys(l).forEach((function(e){var t=l[e];t.nodes&&t.nodes.length||delete l[e]}));var g=[],p={};a.forEach((function(e){var t=e.source,i=e.target,r=e[n]||1,o=c[t].node.clusterId,s=c[i].node.clusterId,a="".concat(o,"---").concat(s);if(p[a])p[a].weight+=r,p[a].count++;else{var l={source:o,target:s,weight:r,count:1};p[a]=l,g.push(l)}}));var m=[];return Object.keys(l).forEach((function(e){m.push(l[e])})),{clusters:m,clusterEdges:g}},ma=function(){function e(e){this.arr=e}return e.prototype.getArr=function(){return this.arr||[]},e.prototype.add=function(t){var n,i=t.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new e(i);if(!(null==i?void 0:i.length))return new e(this.arr);if(this.arr.length===i.length){var r=[];for(var o in this.arr)r[o]=this.arr[o]+i[o];return new e(r)}},e.prototype.subtract=function(t){var n,i=t.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new e(i);if(!(null==i?void 0:i.length))return new e(this.arr);if(this.arr.length===i.length){var r=[];for(var o in this.arr)r[o]=this.arr[o]-i[o];return new e(r)}},e.prototype.avg=function(t){var n=[];if(0!==t)for(var i in this.arr)n[i]=this.arr[i]/t;return new e(n)},e.prototype.negate=function(){var t=[];for(var n in this.arr)t[n]=-this.arr[n];return new e(t)},e.prototype.squareEuclideanDistance=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=Math.pow(this.arr[r]-e.arr[r],2);return i}},e.prototype.euclideanDistance=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=Math.pow(this.arr[r]-e.arr[r],2);return Math.sqrt(i)}console.error("The two vectors are unequal in length.")},e.prototype.normalize=function(){var t=[],n=no(this.arr);n.sort((function(e,t){return e-t}));var i=n[n.length-1],r=n[0];for(var o in this.arr)t[o]=(this.arr[o]-r)/(i-r);return new e(t)},e.prototype.norm2=function(){var e;if(!(null===(e=this.arr)||void 0===e?void 0:e.length))return 0;var t=0;for(var n in this.arr)t+=Math.pow(this.arr[n],2);return Math.sqrt(t)},e.prototype.dot=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=this.arr[r]*e.arr[r];return i}console.error("The two vectors are unequal in length.")},e.prototype.equal=function(e){var t,n=e.arr;if((null===(t=this.arr)||void 0===t?void 0:t.length)!==(null==n?void 0:n.length))return!1;for(var i in this.arr)if(this.arr[i]!==n[i])return!1;return!0},e}(),va=function(e,t){void 0===t&&(t=void 0);var n=[];return e.forEach((function(e){void 0===t&&n.push(e),void 0!==e[t]&&n.push(e[t])})),n};(ha||(ha={})).EuclideanDistance="euclideanDistance";var ya=function(e,t,n){var i=function(e,t,n){var i=[];(null==t?void 0:t.length)?i=t:(e.forEach((function(e){i=i.concat(Object.keys(e))})),i=Er(i));var r={};return i.forEach((function(t){var i=[];e.forEach((function(e){void 0!==e[t]&&""!==e[t]&&i.push(e[t])})),i.length&&!(null==n?void 0:n.includes(t))&&(r[t]=Er(i))})),r}(e,t,n),r=[];return Object.keys(i).length?(e.forEach((function(e,t){var n=[];if(1===Object.keys(i).length){var o=Object.keys(i)[0];i[o].every((function(e){return!isNaN(Number(e))}))&&(n=[e[o]])}else Object.keys(i).forEach((function(t){for(var r=e[t],o=i[t],s=o.findIndex((function(e){return r===e})),a=[],l=0;l<o.length;l++)l===s?a.push(1):a.push(0);n=n.concat(a)}));r[t]=n})),r):r},_a=function(e,t,n,i){void 0===n&&(n=ha.EuclideanDistance);var r=0;switch(n){case ha.EuclideanDistance:r=new ma(e).euclideanDistance(new ma(t))}return r},ba=function(e,t,n,i){for(var r=t.length,o=2*i,s=0,a=0;a<r;a++)for(var l=e[a].clusterId,c=0;c<r;c++){if(l===e[c].clusterId)s+=(t[a][c]||0)-(n[a]||0)*(n[c]||0)/o}return s*=1/o},wa=function(e,t){void 0===e&&(e=[]);for(var n=e.length,i=new ma([]),r=0;r<n;r++)i=i.add(new ma(t[r]));var o=i.avg(n);o.normalize();var s=0;for(r=0;r<n;r++){s+=(l=new ma(t[r])).squareEuclideanDistance(o)}var a=[];e.forEach((function(){a.push([])}));for(r=0;r<n;r++){var l=new ma(t[r]);e[r].clusterInertial=0;for(var c=0;c<n;c++)if(r!==c){var u=new ma(t[c]);a[r][c]=l.squareEuclideanDistance(u),e[r].clusterInertial+=a[r][c]}else a[r][c]=0}var h=0,d=2*n*s;for(r=0;r<n;r++){var f=e[r].clusterId;for(c=0;c<n;c++){var g=e[c].clusterId;if(r!==c&&f===g)h+=e[r].clusterInertial*e[c].clusterInertial/Math.pow(d,2)-a[r][c]/d}}return Number(h.toFixed(4))},Ca=function(e,t,n,i,r,o,s,a,l){void 0===t&&(t=!1),void 0===n&&(n="weight"),void 0===i&&(i=1e-4),void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===s&&(s=[]),void 0===a&&(a=["id"]),void 0===l&&(l=1);var c=e.nodes,u=void 0===c?[]:c,h=e.edges,d=void 0===h?[]:h,f=[];if(r){u.forEach((function(e,t){e.properties=e.properties||{},e.originIndex=t}));var g=[];u.every((function(e){return e.hasOwnProperty("nodeType")}))&&(g=Array.from(new Set(u.map((function(e){return e.nodeType})))),u.forEach((function(e){e.properties.nodeType=g.findIndex((function(t){return t===e.nodeType}))})));var p=va(u,o);f=ya(p,s,a)}var m=1,v={},y={};u.forEach((function(e,t){var n=String(m++);e.clusterId=n,v[n]={id:n,nodes:[e]},y[e.id]={node:e,idx:t}}));var _=Hs(e,t),b=[],w={},C=0;_.forEach((function(e,t){var n=0,i=u[t].id;w[i]={},e.forEach((function(e,t){if(e){n+=e;var r=u[t].id;w[i][r]=e,C+=e}})),b.push(n)})),C/=2;for(var S=1/0,x=1/0,E=0,k=[],L={};;){S=r&&u.every((function(e){return e.hasOwnProperty("properties")}))?ba(u,_,b,C)+wa(u,f)*l:ba(u,_,b,C),0===E&&(x=S,k=u,L=v);var D=S>0&&S>x&&S-x<i;if(S>x&&(k=u.map((function(e){return{node:e,clusterId:e.clusterId}})),L=no(v),x=S),D||E>100)break;E++,Object.keys(v).forEach((function(e){var t=0;d.forEach((function(i){var r=i.source,o=i.target,s=y[r].node.clusterId,a=y[o].node.clusterId;(s===e&&a!==e||a===e&&s!==e)&&(t+=i[n]||1)})),v[e].sumTot=t})),u.forEach((function(e,t){var i,o=v[e.clusterId],s=0,a=b[t]/(2*C),c=0,u=o.nodes;u.forEach((function(e){var n=y[e.id].idx;c+=_[t][n]||0}));var h=c-o.sumTot*a,g=u.filter((function(t){return t.id!==e.id})),p=[];g.forEach((function(e,t){p[t]=f[e.originIndex]}));var m=wa(g,f)*l,S=w[e.id];if(Object.keys(S).forEach((function(n){var o=y[n].node.clusterId;if(o!==e.clusterId){var c=v[o],u=c.nodes;if(u&&u.length){var d=0;u.forEach((function(e){var n=y[e.id].idx;d+=_[t][n]||0}));var g=d-c.sumTot*a,p=u.concat([e]),b=[];p.forEach((function(e,t){b[t]=f[e.originIndex]}));var w=wa(p,f)*l,C=g-h;r&&(C=g+w-(h+m)),C>s&&(s=C,i=c)}}})),s>0){i.nodes.push(e);var x=e.clusterId;e.clusterId=i.id;var E=o.nodes.indexOf(e);o.nodes.splice(E,1);var k=0,L=0;d.forEach((function(e){var t=e.source,r=e.target,o=y[t].node.clusterId,s=y[r].node.clusterId;(o===i.id&&s!==i.id||s===i.id&&o!==i.id)&&(k+=e[n]||1),(o===x&&s!==x||s===x&&o!==x)&&(L+=e[n]||1)})),i.sumTot=k,o.sumTot=L}}))}var N={},I=0;Object.keys(L).forEach((function(e){var t=L[e];if(t.nodes&&t.nodes.length){var n=String(I+1);n!==e&&(t.id=n,t.nodes=t.nodes.map((function(e){return{id:e.id,clusterId:n}})),L[n]=t,N[e]=n,delete L[e],I++)}else delete L[e]})),k.forEach((function(e){var t=e.node,n=e.clusterId;t.clusterId=n,t.clusterId&&N[t.clusterId]&&(t.clusterId=N[t.clusterId])}));var T=[],M={};d.forEach((function(e){var t=e.source,i=e.target,r=e[n]||1,o=y[t].node.clusterId,s=y[i].node.clusterId,a="".concat(o,"---").concat(s);if(M[a])M[a].weight+=r,M[a].count++;else{var l={source:o,target:s,weight:r,count:1};M[a]=l,T.push(l)}}));var A=[];return Object.keys(L).forEach((function(e){A.push(L[e])})),{clusters:A,clusterEdges:T}},Sa=function(e,t,n,i,r,o,s,a){return void 0===t&&(t=!1),void 0===n&&(n="weight"),void 0===i&&(i=1e-4),void 0===r&&(r=void 0),void 0===o&&(o=[]),void 0===s&&(s=["id"]),void 0===a&&(a=1),Ca(e,t,n,i,!0,r,o,s,a)},xa=function(e,t){var n;void 0===t&&(t=1);for(var i=no(e),r=i.nodes,o=void 0===r?[]:r,s=i.edges,a=void 0===s?[]:s,l=function(){var e=ea({nodes:o,edges:a}),i=Object.keys(e);i.sort((function(t,n){var i,r;return(null===(i=e[t])||void 0===i?void 0:i.degree)-(null===(r=e[n])||void 0===r?void 0:r.degree)}));var r=i[0];if(!o.length||(null===(n=e[r])||void 0===n?void 0:n.degree)>=t)return"break";var s=o.findIndex((function(e){return e.id===r}));o.splice(s,1),a=a.filter((function(e){return!(e.source===r||e.target===r)}))};;){if("break"===l())break}return{nodes:o,edges:a}},Ea=function(e,t,n){var i=[];switch(e){case ha.EuclideanDistance:i=t[n];break;default:i=[]}return i},ka=function(e,t,n,i,r,o){void 0===t&&(t=3),void 0===n&&(n=void 0),void 0===i&&(i=[]),void 0===r&&(r=["id"]),void 0===o&&(o=ha.EuclideanDistance);var s=e.nodes,a=void 0===s?[]:s,l=e.edges,c=void 0===l?[]:l,u={clusters:[{id:"0",nodes:a}],clusterEdges:[]};if(o===ha.EuclideanDistance&&!a.every((function(e){return e.hasOwnProperty(n)})))return u;var h=[],d=[];if(o===ha.EuclideanDistance&&(h=va(a,n),d=ya(h,i,r)),!d.length)return u;for(var f=Er(d.map((function(e){return e.join("")}))),g=Math.min(t,a.length,f.length),p=0;p<a.length;p++)a[p].originIndex=p;var m=[],v=[],y=[];for(p=0;p<g;p++)if(0===p){var _=Math.floor(Math.random()*a.length);switch(o){case ha.EuclideanDistance:m[p]=d[_];break;default:m[p]=[]}v.push(_),y[p]=[a[_]],a[_].clusterId=String(p)}else{for(var b=-1/0,w=0,C=function(e){if(!v.includes(e)){for(var t=0,n=0;n<m.length;n++){var i=0;switch(o){case ha.EuclideanDistance:i=_a(d[a[e].originIndex],m[n],o)}t+=i}var r=t/m.length;r>b&&!m.find((function(t){return ho(t,Ea(o,d,a[e].originIndex))}))&&(b=r,w=e)}},S=0;S<a.length;S++)C(S);m[p]=Ea(o,d,w),v.push(w),y[p]=[a[w]],a[w].clusterId=String(p)}for(var x=0;;){for(p=0;p<a.length;p++){var E=0,k=1/0;if(0!==x||!v.includes(p)){for(var L=0;L<m.length;L++){var D=0;switch(o){case ha.EuclideanDistance:D=_a(d[p],m[L],o)}D<k&&(k=D,E=L)}if(void 0!==a[p].clusterId)for(var N=y[Number(a[p].clusterId)].length-1;N>=0;N--)y[Number(a[p].clusterId)][N].id===a[p].id&&y[Number(a[p].clusterId)].splice(N,1);a[p].clusterId=String(E),y[E].push(a[p])}}var I=!1;for(p=0;p<y.length;p++){var T=y[p],M=new ma([]);for(L=0;L<T.length;L++)M=M.add(new ma(d[T[L].originIndex]));var A=M.avg(T.length);A.equal(new ma(m[p]))||(I=!0,m[p]=A.getArr())}if(x++,a.every((function(e){return void 0!==e.clusterId}))&&I||x>=1e3)break}var O=[],R={};return c.forEach((function(e){var t,n,i=e.source,r=e.target,o=null===(t=a.find((function(e){return e.id===i})))||void 0===t?void 0:t.clusterId,s=null===(n=a.find((function(e){return e.id===r})))||void 0===n?void 0:n.clusterId,l="".concat(o,"---").concat(s);if(R[l])R[l].count++;else{var c={source:o,target:s,count:1};R[l]=c,O.push(c)}})),{clusters:y,clusterEdges:O}},La=function(e,t){var n=new ma(t),i=n.norm2(),r=new ma(e),o=r.norm2(),s=n.dot(r),a=i*o;return a?s/a:0},Da=function(e,t,n,i,r){void 0===e&&(e=[]),void 0===n&&(n=void 0),void 0===i&&(i=[]),void 0===r&&(r=[]);var o=no(e.filter((function(e){return e.id!==t.id}))),s=e.findIndex((function(e){return e.id===t.id})),a=va(e,n),l=ya(a,i,r),c=l[s],u=[];return o.forEach((function(e,n){if(e.id!==t.id){var i=l[n],r=La(i,c);u.push(r),e.cosineSimilarity=r}})),o.sort((function(e,t){return t.cosineSimilarity-e.cosineSimilarity})),{allCosineSimilarity:u,similarNodes:o}},Na=function(){function e(e){this.count=e.length,this.parent={};for(var t=0,n=e;t<n.length;t++){var i=n[t];this.parent[i]=i}}return e.prototype.find=function(e){for(;this.parent[e]!==e;)e=this.parent[e];return e},e.prototype.union=function(e,t){var n=this.find(e),i=this.find(t);n!==i&&(n<i?(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]):(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]))},e.prototype.connected=function(e,t){return this.find(e)===this.find(t)},e}(),Ia=function(e,t){return e-t},Ta=function(){function e(e){void 0===e&&(e=Ia),this.compareFn=e,this.list=[]}return e.prototype.getLeft=function(e){return 2*e+1},e.prototype.getRight=function(e){return 2*e+2},e.prototype.getParent=function(e){return 0===e?null:Math.floor((e-1)/2)},e.prototype.isEmpty=function(){return this.list.length<=0},e.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},e.prototype.delMin=function(){var e=this.top(),t=this.list.pop();return this.list.length>0&&(this.list[0]=t,this.moveDown(0)),e},e.prototype.insert=function(e){if(null!==e){this.list.push(e);var t=this.list.length-1;return this.moveUp(t),!0}return!1},e.prototype.moveUp=function(e){for(var t=this.getParent(e);e&&e>0&&this.compareFn(this.list[t],this.list[e])>0;){var n=this.list[t];this.list[t]=this.list[e],this.list[e]=n,e=t,t=this.getParent(e)}},e.prototype.moveDown=function(e){var t,n=e,i=this.getLeft(e),r=this.getRight(e),o=this.list.length;null!==i&&i<o&&this.compareFn(this.list[n],this.list[i])>0?n=i:null!==r&&r<o&&this.compareFn(this.list[n],this.list[r])>0&&(n=r),e!==n&&(t=[this.list[n],this.list[e]],this.list[e]=t[0],this.list[n]=t[1],this.moveDown(n))},e}(),Ma=function(e,t){var n=[],i=e.nodes,r=void 0===i?[]:i,o=e.edges,s=void 0===o?[]:o;if(0===r.length)return n;var a=r[0],l=new Set;l.add(a);var c=new Ta((function(e,n){return t?e.weight-n.weight:0}));for(Ys(a.id,s).forEach((function(e){c.insert(e)}));!c.isEmpty();){var u=c.delMin(),h=u.source,d=u.target;l.has(h)&&l.has(d)||(n.push(u),l.has(h)||(l.add(h),Ys(h,s).forEach((function(e){c.insert(e)}))),l.has(d)||(l.add(d),Ys(d,s).forEach((function(e){c.insert(e)}))))}return n},Aa=function(e,t){var n=[],i=e.nodes,r=void 0===i?[]:i,o=e.edges,s=void 0===o?[]:o;if(0===r.length)return n;var a=s.map((function(e){return e}));t&&a.sort((function(e,t){return e.weight-t.weight}));for(var l=new Na(r.map((function(e){return e.id})));a.length>0;){var c=a.shift(),u=c.source,h=c.target;l.connected(u,h)||(n.push(c),l.union(u,h))}return n},Oa=function(e,t,n){return n?{prim:Ma,kruskal:Aa}[n](e,t):Aa(e,t)},Ra=function(e,t,n){"number"!=typeof t&&(t=1e-6),"number"!=typeof n&&(n=.85);for(var i,r=1,o=0,s=1e3,a=e.nodes,l=void 0===a?[]:a,c=e.edges,u=void 0===c?[]:c,h=l.length,d={},f={},g=0;g<h;++g){d[m=(w=l[g]).id]=1/h,f[m]=1/h}for(var p=ea(e);s>0&&r>t;){o=0;for(g=0;g<h;++g){var m=(w=l[g]).id;if(i=0,0===p[w.id].inDegree)d[m]=0;else{for(var v=$s(m,u,"source"),y=0;y<v.length;++y){var _=v[y],b=p[_].outDegree;b>0&&(i+=f[_]/b)}d[m]=n*i,o+=d[m]}}o=(1-o)/h,r=0;for(g=0;g<h;++g){var w;i=d[m=(w=l[g]).id]+o,r+=Math.abs(i-f[m]),f[m]=i}s-=1}return f},Pa=function(e,t,n,i){void 0===e&&(e=-1),void 0===t&&(t=-1),void 0===n&&(n=-1),void 0===i&&(i="-1"),this.id=e,this.from=t,this.to=n,this.label=i},Fa=function(){function e(e,t){void 0===e&&(e=-1),void 0===t&&(t="-1"),this.id=e,this.label=t,this.edges=[],this.edgeMap={}}return e.prototype.addEdge=function(e){this.edges.push(e),this.edgeMap[e.id]=e},e}(),Ba=function(){function e(e,t,n){void 0===e&&(e=-1),void 0===t&&(t=!0),void 0===n&&(n=!1),this.id=e,this.edgeIdAutoIncrease=t,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n}return e.prototype.getNodeNum=function(){return this.nodes.length},e.prototype.addNode=function(e,t){if(!this.nodeMap[e]){var n=new Fa(e,t);this.nodes.push(n),this.nodeMap[e]=n,this.nodeLabelMap[t]||(this.nodeLabelMap[t]=[]),this.nodeLabelMap[t].push(e)}},e.prototype.addEdge=function(e,t,n,i){if((this.edgeIdAutoIncrease||void 0===e)&&(e=this.counter++),!(this.nodeMap[t]&&this.nodeMap[n]&&this.nodeMap[n].edgeMap[e])){var r=new Pa(e,t,n,i);if(this.edges.push(r),this.edgeMap[e]=r,this.nodeMap[t].addEdge(r),this.edgeLabelMap[i]||(this.edgeLabelMap[i]=[]),this.edgeLabelMap[i].push(r),!this.directed){var o=new Pa(e,n,t,i);this.nodeMap[n].addEdge(o),this.edgeLabelMap[i].push(o)}}},e}(),Wa=function(){function e(e,t,n,i,r){this.fromNode=e,this.toNode=t,this.nodeEdgeNodeLabel={nodeLabel1:n||"-1",edgeLabel:i||"-1",nodeLabel2:r||"-1"}}return e.prototype.equalTo=function(e){return this.fromNode===e.formNode&&this.toNode===e.toNode&&this.nodeEdgeNodeLabel===e.nodeEdgeNodeLabel},e.prototype.notEqualTo=function(e){return!this.equalTo(e)},e}(),za=function(){function e(){this.rmpath=[],this.dfsEdgeList=[]}return e.prototype.equalTo=function(e){var t=this.dfsEdgeList.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(this.dfsEdgeList[n]!==e[n])return!1;return!0},e.prototype.notEqualTo=function(e){return!this.equalTo(e)},e.prototype.pushBack=function(e,t,n,i,r){return this.dfsEdgeList.push(new Wa(e,t,n,i,r)),this.dfsEdgeList},e.prototype.toGraph=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=!1);var n=new Ba(e,!0,t);return this.dfsEdgeList.forEach((function(e){var t=e.fromNode,i=e.toNode,r=e.nodeEdgeNodeLabel,o=r.nodeLabel1,s=r.edgeLabel,a=r.nodeLabel2;"-1"!==o&&n.addNode(t,o),"-1"!==a&&n.addNode(i,a),"-1"!==o&&a!==o&&n.addEdge(void 0,t,i,s)})),n},e.prototype.buildRmpath=function(){this.rmpath=[];for(var e=void 0,t=this.dfsEdgeList.length-1;t>=0;t--){var n=this.dfsEdgeList[t],i=n.fromNode,r=n.toNode;i<r&&(void 0===e||r===e)&&(this.rmpath.push(t),e=i)}return this.rmpath},e.prototype.getNodeNum=function(){var e={};return this.dfsEdgeList.forEach((function(t){e[t.fromNode]||(e[t.fromNode]=!0),e[t.toNode]||(e[t.toNode]=!0)})),Object.keys(e).length},e}(),Va=function(){function e(e){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],e){for(;e;){var t=e.edge;this.edges.push(t),this.nodesUsed[t.from]=1,this.nodesUsed[t.to]=1,this.edgesUsed[t.id]=1,e=e.preNode}this.edges=this.edges.reverse()}}return e.prototype.hasNode=function(e){return 1===this.nodesUsed[e.id]},e.prototype.hasEdge=function(e){return 1===this.edgesUsed[e.id]},e}(),Ua=function(){function e(e){var t=e.graphs,n=e.minSupport,i=void 0===n?2:n,r=e.minNodeNum,o=void 0===r?1:r,s=e.maxNodeNum,a=void 0===s?4:s,l=e.top,c=void 0===l?10:l,u=e.directed,h=void 0!==u&&u,d=e.verbose,f=void 0!==d&&d;this.graphs=t,this.dfsCode=new za,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=i,this.top=c,this.directed=h,this.counter=0,this.maxNodeNum=a,this.minNodeNum=o,this.verbose=f,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return e.prototype.findForwardRootEdges=function(e,t){var n=this,i=[],r=e.nodeMap;return t.edges.forEach((function(e){(n.directed||t.label<=r[e.to].label)&&i.push(e)})),i},e.prototype.findBackwardEdge=function(e,t,n,i){if(!this.directed&&t===n)return null;for(var r=e.nodeMap,o=r[n.to].edges,s=o.length,a=0;a<s;a++){var l=o[a];if(!i.hasEdge(l)&&l.to===t.from)if(this.directed){if(r[t.from].label<r[n.to].label||r[t.from].label===r[n.to].label&&t.label<=l.label)return l}else if(t.label<l.label||t.label===l.label&&r[t.to].label<=r[n.to].label)return l}return null},e.prototype.findForwardPureEdges=function(e,t,n,i){for(var r=[],o=t.to,s=e.nodeMap[o].edges,a=s.length,l=0;l<a;l++){var c=s[l],u=e.nodeMap[c.to];n<=u.label&&!i.hasNode(u)&&r.push(c)}return r},e.prototype.findForwardRmpathEdges=function(e,t,n,i){for(var r=[],o=e.nodeMap,s=o[t.to].label,a=o[t.from].edges,l=a.length,c=0;c<l;c++){var u=a[c],h=o[u.to].label;t.to===u.to||n>h||i.hasNode(o[u.to])||(t.label<u.label||t.label===u.label&&s<=h)&&r.push(u)}return r},e.prototype.getSupport=function(e){var t={};return e.forEach((function(e){t[e.graphId]||(t[e.graphId]=!0)})),Object.keys(t).length},e.prototype.findMinLabel=function(e){var t=void 0;return Object.keys(e).forEach((function(n){var i=e[n],r=i.nodeLabel1,o=i.edgeLabel,s=i.nodeLabel2;t?(r<t.nodeLabel1||r===t.nodeLabel1&&o<t.edgeLabel||r===t.nodeLabel1&&o===t.edgeLabel&&s<t.nodeLabel2)&&(t={nodeLabel1:r,edgeLabel:o,nodeLabel2:s}):t={nodeLabel1:r,edgeLabel:o,nodeLabel2:s}})),t},e.prototype.isMin=function(){var e=this,t=this.dfsCode;if(this.verbose&&console.log("isMin checking",t),1===t.dfsEdgeList.length)return!0;var n=this.directed,i=t.toGraph(-1,n),r=i.nodeMap,o=new za,s={};i.nodes.forEach((function(t){e.findForwardRootEdges(i,t).forEach((function(e){var n=r[e.to],o="".concat(t.label,"-").concat(e.label,"-").concat(n.label);s[o]||(s[o]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:n.label});var a={graphId:i.id,edge:e,preNode:null};s[o].projected.push(a)}))}));var a=this.findMinLabel(s);if(a){o.dfsEdgeList.push(new Wa(0,1,a.nodeLabel1,a.edgeLabel,a.nodeLabel2));var l="".concat(a.nodeLabel1,"-").concat(a.edgeLabel,"-").concat(a.nodeLabel2);return function s(a){for(var l=o.buildRmpath(),c=o.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,u=o.dfsEdgeList[l[0]].toNode,h={},d=!1,f=0,g=n?-1:0,p=function(t){if(d)return"break";a.forEach((function(n){var r=new Va(n),s=e.findBackwardEdge(i,r.edges[l[t]],r.edges[l[0]],r);s&&(h[s.label]||(h[s.label]={projected:[],edgeLabel:s.label}),h[s.label].projected.push({graphId:i.id,edge:h,preNode:n}),f=o.dfsEdgeList[l[t]].fromNode,d=!0)}))},m=l.length-1;m>g;m--){if("break"===p(m))break}if(d){var v=e.findMinLabel(h);o.dfsEdgeList.push(new Wa(u,f,"-1",v.edgeLabel,"-1"));var y=o.dfsEdgeList.length-1;return e.dfsCode.dfsEdgeList[y]===o.dfsEdgeList[y]&&s(h[v.edgeLabel].projected)}var _={};d=!1;var b=0;a.forEach((function(t){var n=new Va(t),o=e.findForwardPureEdges(i,n.edges[l[0]],c,n);o.length>0&&(d=!0,b=u,o.forEach((function(e){var n="".concat(e.label,"-").concat(r[e.to].label);_[n]||(_[n]={projected:[],edgeLabel:e.label,nodeLabel2:r[e.to].label}),_[n].projected.push({graphId:i.id,edge:e,preNode:t})})))}));var w=l.length,C=function(t){if(d)return"break";var n=l[t];a.forEach((function(t){var s=new Va(t),a=e.findForwardRmpathEdges(i,s.edges[n],c,s);a.length>0&&(d=!0,b=o.dfsEdgeList[n].fromNode,a.forEach((function(e){var n="".concat(e.label,"-").concat(r[e.to].label);_[n]||(_[n]={projected:[],edgeLabel:e.label,nodeLabel2:r[e.to].label}),_[n].projected.push({graphId:i.id,edge:e,preNode:t})})))}))};for(m=0;m<w;m++){if("break"===C(m))break}if(!d)return!0;var S=e.findMinLabel(_);o.dfsEdgeList.push(new Wa(b,u+1,"-1",S.edgeLabel,S.nodeLabel2));var x=o.dfsEdgeList.length-1;return t.dfsEdgeList[x]===o.dfsEdgeList[x]&&s(_["".concat(S.edgeLabel,"-").concat(S.nodeLabel2)].projected)}(s[l].projected)}},e.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var e=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(no(e))}},e.prototype.subGraphMining=function(e){var t=this;if(!(this.getSupport(e)<this.minSupport)&&this.isMin()){this.report();var n=this.dfsCode.getNodeNum(),i=this.dfsCode.buildRmpath(),r=this.dfsCode.dfsEdgeList[i[0]].toNode,o=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,s={},a={};e.forEach((function(e){for(var l=t.graphs[e.graphId],c=l.nodeMap,u=new Va(e),h=i.length-1;h>=0;h--){var d=t.findBackwardEdge(l,u.edges[i[h]],u.edges[i[0]],u);if(d){var f="".concat(t.dfsCode.dfsEdgeList[i[h]].fromNode,"-").concat(d.label);a[f]||(a[f]={projected:[],toNodeId:t.dfsCode.dfsEdgeList[i[h]].fromNode,edgeLabel:d.label}),a[f].projected.push({graphId:e.graphId,edge:d,preNode:e})}}if(!(n>=t.maxNodeNum)){t.findForwardPureEdges(l,u.edges[i[0]],o,u).forEach((function(t){var n="".concat(r,"-").concat(t.label,"-").concat(c[t.to].label);s[n]||(s[n]={projected:[],fromNodeId:r,edgeLabel:t.label,nodeLabel2:c[t.to].label}),s[n].projected.push({graphId:e.graphId,edge:t,preNode:e})}));var g=function(n){t.findForwardRmpathEdges(l,u.edges[i[n]],o,u).forEach((function(r){var o="".concat(t.dfsCode.dfsEdgeList[i[n]].fromNode,"-").concat(r.label,"-").concat(c[r.to].label);s[o]||(s[o]={projected:[],fromNodeId:t.dfsCode.dfsEdgeList[i[n]].fromNode,edgeLabel:r.label,nodeLabel2:c[r.to].label}),s[o].projected.push({graphId:e.graphId,edge:r,preNode:e})}))};for(h=0;h<i.length;h++)g(h)}})),Object.keys(a).forEach((function(e){var n=a[e],i=n.toNodeId,o=n.edgeLabel;t.dfsCode.dfsEdgeList.push(new Wa(r,i,"-1",o,"-1")),t.subGraphMining(a[e].projected),t.dfsCode.dfsEdgeList.pop()})),Object.keys(s).forEach((function(e){var n=s[e],i=n.fromNodeId,o=n.edgeLabel,a=n.nodeLabel2;t.dfsCode.dfsEdgeList.push(new Wa(i,r+1,"-1",o,a)),t.subGraphMining(s[e].projected),t.dfsCode.dfsEdgeList.pop()}))}},e.prototype.generate1EdgeFrequentSubGraphs=function(){var e=this.graphs,t=this.directed,n=this.minSupport,i=this.frequentSize1Subgraphs,r={},o={},s={},a={};return Object.keys(e).forEach((function(n){var i=e[n],l=i.nodeMap;i.nodes.forEach((function(e,i){var c=e.label,u="".concat(n,"-").concat(c);if(!s[u]){var h=r[c]||0;h++,r[c]=h}s[u]={graphKey:n,label:c},e.edges.forEach((function(e){var i=c,r=l[e.to].label;if(!t&&i>r){var s=r;r=i,i=s}var u=e.label,h="".concat(n,"-").concat(i,"-").concat(u,"-").concat(r),d="".concat(i,"-").concat(u,"-").concat(r);if(!o[d]){var f=o[d]||0;f++,o[d]=f}a[h]={graphId:n,nodeLabel1:i,edgeLabel:u,nodeLabel2:r}}))}))})),Object.keys(r).forEach((function(e){if(!(r[e]<n)){var t={nodes:[],edges:[]};t.nodes.push({id:"0",label:e}),i.push(t)}})),i},e.prototype.run=function(){var e=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var t=this.graphs;this.directed;var n={};Object.keys(t).forEach((function(i){var r=t[i],o=r.nodeMap;r.nodes.forEach((function(t){e.findForwardRootEdges(r,t).forEach((function(e){var r=o[e.to],s="".concat(t.label,"-").concat(e.label,"-").concat(r.label);n[s]||(n[s]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:r.label});var a={graphId:i,edge:e,preNode:null};n[s].projected.push(a)}))}))})),Object.keys(n).forEach((function(t){var i=n[t],r=i.projected,o=i.nodeLabel1,s=i.edgeLabel,a=i.nodeLabel2;e.dfsCode.dfsEdgeList.push(new Wa(0,1,o,s,a)),e.subGraphMining(r),e.dfsCode.dfsEdgeList.pop()}))}},e}(),Ha=function(e){var t=e.graphs,n=e.directed,i=void 0!==n&&n,r=e.nodeLabelProp,o=void 0===r?"cluster":r,s=e.edgeLabelProp,a=void 0===s?"cluster":s,l=function(e,t,n,i){var r={};return Object.keys(e).forEach((function(o,s){var a=e[o],l=new Ba(s,!0,t),c={};a.nodes.forEach((function(e,t){l.addNode(t,e[n]),c[e.id]=t})),a.edges.forEach((function(e,t){var n=c[e.source],r=c[e.target];l.addEdge(-1,n,r,e[i])})),l&&l.getNodeNum()&&(r[l.id]=l)})),r}(t,i,o,a),c=e.minSupport,u=e.maxNodeNum,h=e.minNodeNum,d=e.verbose,f=e.top,g=new Ua({graphs:l,minSupport:c,maxNodeNum:u,minNodeNum:h,top:f,verbose:d,directed:i});return g.run(),function(e,t,n){var i=[];return e.forEach((function(e){var r={nodes:[],edges:[]};e.nodes.forEach((function(e){var n;r.nodes.push(((n={id:"".concat(e.id)})[t]=e.label,n))})),e.edges.forEach((function(e){var t;r.edges.push(((t={source:"".concat(e.from),target:"".concat(e.to)})[n]=e.label,t))})),i.push(r)})),i}(g.frequentSubgraphs,o,a)},ja=function(e,t,n,i){void 0===n&&(n="cluster"),void 0===i&&(i=2);var r=[],o=e.nodes;return t.forEach((function(e,t){r.push(Ga(o,e,t,n,i))})),r},Ga=function(e,t,n,i,r){var o=[n],s=[],a={};return t.forEach((function(t,l){if(t<=r&&n!==l){o.push(l),s.push(e[l]);var c=e[l][i];a[c]?(a[c].count++,a[c].dists.push(t)):a[c]={count:1,dists:[t]}}})),Object.keys(a).forEach((function(e){a[e].dists=a[e].dists.sort((function(e,t){return e-t}))})),{nodeIdx:n,nodeId:e[n].id,nodeIdxs:o,neighbors:s,neighborNum:o.length-1,nodeLabelCountMap:a}},Ka=function(e,t,n,i){var r=n.nodes;return i||(i={}),Object.keys(e).forEach((function(o){var s,a;if(!i||!i[o]){i[o]={nodes:[],edges:[]};var l=e[o],c=null===(s=t[l.start])||void 0===s?void 0:s.nodeIdxs,u=null===(a=t[l.end])||void 0===a?void 0:a.nodeIdxs;if(c&&u){var h=new Set(u),d=c.filter((function(e){return h.has(e)}));if(d&&d.length){for(var f={},g=d.length,p=0;p<g;p++){var m=r[d[p]];i[o].nodes.push(m),f[m.id]=!0}n.edges.forEach((function(e){f[e.source]&&f[e.target]&&i[o].edges.push(e)}))}}}})),i},qa=function(e,t,n,i){var r,o,s={};e.nodes.forEach((function(e){s[e.id]=e}));var a=0;return!(null===(r=null==t?void 0:t.edges)||void 0===r?void 0:r.length)||(null===(o=null==t?void 0:t.nodes)||void 0===o?void 0:o.length)<2?0:(e.edges.forEach((function(e){var r=s[e.source][n],o=s[e.target][n],l=null==t?void 0:t.nodes[0][n],c=null==t?void 0:t.nodes[1][n],u=null==t?void 0:t.edges[0][i];e[i]===u&&(r===l&&o===c||r===c&&o===l)&&a++})),a)},$a=function(e,t){var n={},i={};return e.forEach((function(e,r){n[e.id]={idx:r,node:e,degree:0,inDegree:0,outDegree:0};var o=e[t];i[o]||(i[o]=[]),i[o].push(e)})),{nodeMap:n,nodeLabelMap:i}},Ya=function(e,t,n){var i={},r={};return e.forEach((function(e,o){i["".concat(Xs)]={idx:o,edge:e};var s=e[t];r[s]||(r[s]=[]),r[s].push(e);var a=n[e.source];a&&(a.degree++,a.outDegree++);var l=n[e.target];l&&(l.degree++,l.inDegree++)})),{edgeMap:i,edgeLabelMap:r}},Xa=function(e,t,n){var i=t.length,r={};return t.forEach((function(t,o){for(var s=n?0:o+1,a=e[o].id,l=s;l<i;l++)if(o!==l){var c=e[l].id,u=t[l];r["".concat(a,"-").concat(c)]=u,n||(r["".concat(c,"-").concat(a)]=u)}})),r},Za=function(e,t,n,i,r,o,s,a,l,c,u){var h,d="".concat(t.id,"-").concat(n.id);if(c&&c[d])return c[d];var f=u?u[d]:void 0;if(!f){var g=((h={})[d]={start:i[t.id].idx,end:i[n.id].idx,distance:r},h);f=(u=Ka(g,o,e,u))[d]}return qa(f,s,a,l)},Qa=function(e,t,n,i){var r,o,s,a=null===(r=e[t])||void 0===r?void 0:r.degree,l=null===(o=e[t])||void 0===o?void 0:o.inDegree,c=null===(s=e[t])||void 0===s?void 0:s.outDegree;return void 0===e[t]&&(a=1/0,l=1/0,c=1/0,i[t].forEach((function(e){var t=n[e.id].degree;a>t&&(a=t);var i=n[e.id].inDegree;l>i&&(l=i);var r=n[e.id].outDegree;c>r&&(c=r)})),e[t]={degree:a,inDegree:l,outDegree:c}),{minPatternNodeLabelDegree:a,minPatternNodeLabelInDegree:l,minPatternNodeLabelOutDegree:c}},Ja=function(e,t,n,i,r,o,s){var a;if(void 0===n&&(n=!1),void 0===o&&(o="cluster"),void 0===s&&(s="cluster"),e&&e.nodes){var l=e.nodes.length;if(l){var c=ga(e,n),u=ga(t,n),h=Xa(e.nodes,c,n),d=Xa(t.nodes,u,n),f=$a(e.nodes,o),g=f.nodeMap,p=f.nodeLabelMap,m=$a(t.nodes,o),v=m.nodeMap,y=m.nodeLabelMap;Ya(e.edges,s,g);var _=Ya(t.edges,s,v).edgeLabelMap,b=[];null==u||u.forEach((function(e){b=b.concat(e)})),r||(r=Math.max.apply(Math,Ji(Ji([],b,!1),[2],!1))),i||(i=r);var w=ja(e,c,o,i),C=ja(t,u,o,i),S=function(e,t,n,i,r){var o=Math.ceil(n/t),s={},a=0;return i.forEach((function(e,i){for(var l=0,c=0,u=e.nodeIdxs,h=e.neighborNum-1;l<o;){for(var d=u[1+Math.floor(Math.random()*h)],f=0;(s["".concat(i,"-").concat(d)]||s["".concat(d,"-").concat(i)])&&(d=Math.floor(Math.random()*t),!(++f>2*t)););if(f<2*t&&(s["".concat(i,"-").concat(d)]={start:i,end:d,distance:r[i][d]},l++,++a>=n))return s;if(++c>2*t)break}l<o&&(o=(o+(o-l))/(t-i-1))})),s}(0,l,Math.min(100,l*(l-1)/2),w,c),x=Ka(S,w,e),E=Ha({graphs:x,nodeLabelProp:o,edgeLabelProp:s,minSupport:1,minNodeNum:1,maxNodeNum:4,directed:n}).slice(0,10),k=E.length,L=[];E.forEach((function(e,t){L[t]={},Object.keys(x).forEach((function(n){var i=x[n],r=qa(i,e,o,s);L[t][n]=r}))}));var D=function(e,t,n){for(var i=1/0,r=0,o=function(t){var n=e[t],o=Object.keys(n).sort((function(e,t){return n[e]-n[t]})),s=[];o.forEach((function(e,t){s[t%10]||(s[t%10]={graphs:[],totalCount:0,aveCount:0}),s[t%10].graphs.push(e),s[t%10].totalCount+=n[e]}));var a=0,l=[];s.forEach((function(e){var t=e.totalCount/e.graphs.length;e.aveCount=t,l.push(t);var i=0,r=e.length;e.graphs.forEach((function(t,r){var o=n[t];e.graphs.forEach((function(e,t){r!==t&&(i+=Math.abs(o-n[e]))}))})),a+=i/=r*(r-1)/2})),a/=s.length;var c=0;l.forEach((function(e,t){l.forEach((function(n,i){t!==i&&(c+=Math.abs(e-n))})),c/=l.length*(l.length-1)/2}));var u=c-a;i<u&&(i=u,r=t)},s=0;s<t;s++)o(s);return{structure:n[r],structureCountMap:e[r]}}(L,k,E),N=D.structure,I=D.structureCountMap,T=t.nodes[0],M=[],A=null===(a=t.nodes[0])||void 0===a?void 0:a[o],O=-1/0;t.nodes.forEach((function(e){var t=e[o],n=p[t];(null==n?void 0:n.length)>O&&(O=n.length,M=n,A=t,T=e)}));var R={},P={},F={},B={},W={},z={};Object.keys(y).forEach((function(i,r){W[i]=[],n&&(z[i]=[]);var a=y[i],l={};a.forEach((function(e){var t=d["".concat(T.id,"-").concat(e.id)];if(t&&W[i].push(t),l["".concat(T.id,"-").concat(e.id)]={start:0,end:v[e.id].idx,distance:t},n){var r=d["".concat(e.id,"-").concat(T.id)];r&&z[i].push(r)}})),W[i]=W[i].sort((function(e,t){return e-t})),n&&(z[i]=z[i].sort((function(e,t){return e-t}))),P=Ka(l,C,t,P);var c=[];if(Object.keys(l).forEach((function(e){if(F[e])c.push(F[e]);else{var t=P[e];F[e]=qa(t,N,o,s),c.push(F[e])}})),c=c.sort((function(e,t){return t-e})),B["".concat(T.id,"-").concat(i)]=c,i!==A)for(var u=function(t){var n=M[t],r=w[g[n.id].idx],a=r.nodeLabelCountMap[i],l=y[i].length;if(!a||a.count<l)return M.splice(t,1),"continue";for(var u=!1,d=0;d<l;d++)if(a.dists[d]>W[i][d]){u=!0;break}if(u)return M.splice(t,1),"continue";var f={};r.neighbors.forEach((function(e){var t=h["".concat(n.id,"-").concat(e.id)];f["".concat(n.id,"-").concat(e.id)]={start:g[n.id].idx,end:g[e.id].idx,distance:t}})),x=Ka(f,w,e,x);var p=[];Object.keys(f).forEach((function(e){if(I[e])p.push(I[e]);else{var t=x[e];I[e]=qa(t,N,o,s),p.push(I[e])}})),p=p.sort((function(e,t){return t-e}));var m=!1;for(d=0;d<l;d++)if(p[d]<c[d]){m=!0;break}return m?(M.splice(t,1),"continue"):void 0},f=((null==M?void 0:M.length)||0)-1;f>=0;f--)u(f)}));var V=[];null==M||M.forEach((function(i){for(var a=g[i.id].idx,l=Ga(e.nodes,c[a],a,o,r).neighbors,u=!1,d=l.length-1;d>=0;d--){if(l.length+1<t.nodes.length)return void(u=!0);var f=l[d],p=f[o];if(y[p]&&y[p].length)if(W[p]&&W[p].length){var m="".concat(i.id,"-").concat(f.id),_=h[m],b=W[p].length-1;if(_>W[p][b])l.splice(d,1);else{if(n){var C="".concat(f.id,"-").concat(i.id),S=h[C];if(b=z[p].length-1,S>z[p][b]){l.splice(d,1);continue}}var E=I[m]?I[m]:Za(e,i,f,g,_,w,N,o,s,I,x),k="".concat(T.id,"-").concat(p);if(E<B[k][B[k].length-1])l.splice(d,1);else{var L=Qa(R,p,v,y),D=L.minPatternNodeLabelDegree;L.minPatternNodeLabelInDegree,L.minPatternNodeLabelOutDegree,g[f.id].degree<D&&l.splice(d,1)}}}else l.splice(d,1);else l.splice(d,1)}u||V.push({nodes:[i].concat(l)})}));var U=ca(t,T.id,!1).length,H={};n?(Object.keys(U).forEach((function(e){var t=v[e].node[o];H[t]?H[t].push(U[e]):H[t]=[U[e]]})),Object.keys(H).forEach((function(e){H[e].sort((function(e,t){return e-t}))}))):H=W;for(var j=function(i){var r=V[i],a=r.nodes[0],l={},c={};r.nodes.forEach((function(e,t){c[e.id]={idx:t,node:e,degree:0,inDegree:0,outDegree:0};var n=e[o];l[n]?l[n]++:l[n]=1}));var u=[],h={};e.edges.forEach((function(e){c[e.source]&&c[e.target]&&(u.push(e),h[e[s]]?h[e[s]]++:h[e[s]]=1,c[e.source].degree++,c[e.target].degree++,c[e.source].outDegree++,c[e.target].inDegree++)}));for(var d=Object.keys(_).length,f=!1,p=0;p<d;p++){var m=Object.keys(_)[p];if(!h[m]||h[m]<_[m].length){f=!0;break}}if(f)return V.splice(i,1),"continue";var b=u.length;if(b<t.edges.length)return V.splice(i,1),"break";var w=!1,C=function(e){var t=u[e],i=t[s],r=_[i];if(!r||!r.length)return h[i]--,r&&h[i]<r.length?(w=!0,"break"):(u.splice(e,1),c[t.source].degree--,c[t.target].degree--,c[t.source].outDegree--,c[t.target].inDegree--,"continue");var a=c[t.source].node[o],l=c[t.target].node[o],d=!1;return r.forEach((function(e){var t=v[e.source].node,i=v[e.target].node;t[o]===a&&i[o]===l&&(d=!0),n||t[o]!==l||i[o]!==a||(d=!0)})),d?void 0:(h[i]--,r&&h[i]<r.length?(w=!0,"break"):(u.splice(e,1),c[t.source].degree--,c[t.target].degree--,c[t.source].outDegree--,c[t.target].inDegree--,"continue"))};for(p=b-1;p>=0;p--){if("break"===C(p))break}if(w)return V.splice(i,1),"continue";r.edges=u;var S=ca(r,r.nodes[0].id,!1).length;if(Object.keys(S).reverse().forEach((function(e){if(e!==r.nodes[0].id&&!w){if(S[e]===1/0){var t=c[e].node[o];if(l[t]--,l[t]<y[t].length)return void(w=!0);var n=r.nodes.indexOf(c[e].node);return r.nodes.splice(n,1),void(c[e]=void 0)}var i=g[e].node[o];if(!H[i]||!H[i].length||S[e]>H[i][H[i].length-1]){t=c[e].node[o];if(l[t]--,l[t]<y[t].length)return void(w=!0);n=r.nodes.indexOf(c[e].node);r.nodes.splice(n,1),c[e]=void 0}}})),w)return V.splice(i,1),"continue";for(var x=!0,E=0;x&&!w;){if(x=!1,n?c[a.id].degree<v[T.id].degree||c[a.id].inDegree<v[T.id].inDegree||c[a.id].outDegree<v[T.id].outDegree:c[a.id].degree<v[T.id].degree){w=!0;break}if(l[a[o]]<y[a[o]].length){w=!0;break}for(var k=r.nodes.length-1;k>=0;k--){var L=r.nodes[k],D=c[L.id].degree,N=c[L.id].inDegree,I=c[L.id].outDegree,M=L[o],A=Qa(R,M,v,y),O=A.minPatternNodeLabelDegree,P=A.minPatternNodeLabelInDegree,F=A.minPatternNodeLabelOutDegree;if(n?D<O||N<P||I<F:D<O){if(l[L[o]]--,l[L[o]]<y[L[o]].length){w=!0;break}r.nodes.splice(k,1),c[L.id]=void 0,x=!0}}if(w||!x&&0!==E)break;for(var B=(b=u.length)-1;B>=0;B--){var W=u[B];if(!c[W.source]||!c[W.target]){u.splice(B,1);var z=W[s];if(h[z]--,c[W.source]&&(c[W.source].degree--,c[W.source].outDegree--),c[W.target]&&(c[W.target].degree--,c[W.target].inDegree--),_[z]&&h[z]<_[z].length){w=!0;break}x=!0}}E++}return w||w||r.nodes.length<t.nodes.length||u.length<t.edges.length?(V.splice(i,1),"continue"):void 0},G=V.length-1;G>=0;G--){if("break"===j(G))break}var K=V.length,q=function(e){var t=V[e],n={};t.edges.forEach((function(e){var t="".concat(e.source,"-").concat(e.target,"-").concat(e.label);n[t]?n[t]++:n[t]=1}));for(var i=function(e){var t=V[e],i={};t.edges.forEach((function(e){var t="".concat(e.source,"-").concat(e.target,"-").concat(e.label);i[t]?i[t]++:i[t]=1}));var r=!0;Object.keys(i).length!==Object.keys(n).length?r=!1:Object.keys(n).forEach((function(e){i[e]!==n[e]&&(r=!1)})),r&&V.splice(e,1)},r=K-1;r>e;r--)i(r);K=V.length};for(G=0;G<=K-1;G++)q(G);return V}}},el=function(){function e(e){void 0===e&&(e=10),this.linkedList=new Ks,this.maxStep=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},e.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},e.prototype.push=function(e){this.linkedList.prepend(e),this.length>this.maxStep&&this.linkedList.deleteTail()},e.prototype.pop=function(){var e=this.linkedList.deleteHead();return e?e.value:null},e.prototype.toArray=function(){return this.linkedList.toArray().map((function(e){return e.value}))},e.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},e}(),tl=oa,nl={getAdjMatrix:Hs,breadthFirstSearch:Zs,connectedComponent:Js,getDegree:ea,getInDegree:ta,getOutDegree:na,detectCycle:oa,detectDirectedCycle:tl,detectAllCycles:la,detectAllDirectedCycle:aa,detectAllUndirectedCycle:sa,depthFirstSearch:ra,dijkstra:ca,findAllPath:fa,findShortestPath:da,floydWarshall:ga,labelPropagation:pa,louvain:Ca,iLouvain:Sa,kCore:xa,kMeans:ka,cosineSimilarity:La,nodesCosineSimilarity:Da,minimumSpanningTree:Oa,pageRank:Ra,getNeighbors:$s,Stack:el,GADDI:Ja},il=Object.freeze(Object.defineProperty({__proto__:null,getAdjMatrix:Hs,breadthFirstSearch:Zs,connectedComponent:Js,getDegree:ea,getInDegree:ta,getOutDegree:na,detectCycle:oa,detectDirectedCycle:tl,detectAllCycles:la,detectAllDirectedCycle:aa,detectAllUndirectedCycle:sa,depthFirstSearch:ra,dijkstra:ca,findAllPath:fa,findShortestPath:da,floydWarshall:ga,labelPropagation:pa,louvain:Ca,iLouvain:Sa,kCore:xa,kMeans:ka,cosineSimilarity:La,nodesCosineSimilarity:Da,minimumSpanningTree:Oa,pageRank:Ra,getNeighbors:$s,Stack:el,GADDI:Ja,default:nl},Symbol.toStringTag,{value:"Module"})),rl=Us,ol=function(e,t,n){return e>=t&&e<=n},sl=function(e,t,n,i){var r=n.x-e.x,o=n.y-e.y,s=t.x-e.x,a=t.y-e.y,l=i.x-n.x,c=i.y-n.y,u=s*c-a*l,h=1/u;if(u*u>1e-4*(s*s+a*a)*(l*l+c*c)){var d=(r*c-o*l)*h,f=(r*a-o*s)*h;return ol(d,0,1)&&ol(f,0,1)?{x:e.x+d*s,y:e.y+d*a}:null}return null},al=function(e,t){var n=e.x,i=e.y,r=e.width,o=e.height,s=[],a={x:n+r/2,y:i+o/2};s.push({x:n,y:i}),s.push({x:n+r,y:i}),s.push({x:n+r,y:i+o}),s.push({x:n,y:i+o}),s.push({x:n,y:i});for(var l=null,c=1;c<s.length&&!(l=sl(s[c-1],s[c],a,t));c++);return l},ll=function(e,t){var n=e.x,i=e.y,r=e.r,o=t.x-n,s=t.y-i;if(o*o+s*s<r*r)return null;var a=Math.atan(s/o);return{x:n+Math.abs(r*Math.cos(a))*Math.sign(o),y:i+Math.abs(r*Math.sin(a))*Math.sign(s)}},cl=function(e,t){var n=e.rx,i=e.ry,r=e.x,o=e.y,s=t.x-r,a=t.y-o,l=Math.atan2(a/i,s/n);return l<0&&(l+=2*Math.PI),{x:r+n*Math.cos(l),y:o+i*Math.sin(l)}},ul=function(e,t,n){void 0===n&&(n=1);var i=[e.x,e.y,n];return t&&!isNaN(t[0])||(t=[1,0,0,0,1,0,0,0,1]),fs(i,i,t),{x:i[0],y:i[1]}},hl=function(e,t,n){void 0===n&&(n=1),t&&!isNaN(t[0])||(t=[1,0,0,0,1,0,0,0,1]);var i=Mo([1,0,0,0,1,0,0,0,1],t);i||(i=[1,0,0,0,1,0,0,0,1]);var r=[e.x,e.y,n];return fs(r,r,i),{x:r[0],y:r[1]}},dl=function(e,t,n){var i=e.x-t.x,r=e.y-t.y,o=e.x-n.x,s=e.y-n.y,a=(e.x*e.x-t.x*t.x-t.y*t.y+e.y*e.y)/2,l=(e.x*e.x-n.x*n.x-n.y*n.y+e.y*e.y)/2,c=r*o-i*s;return{x:-(s*a-r*l)/c,y:-(i*l-o*a)/c}},fl=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},gl=function(e,t){e.translate(t.x,t.y)},pl=function(e,t,n,i){void 0===i&&(i={duration:500});var r=e.getMatrix();r||(r=[1,0,0,0,1,0,0,0,1]);var o=e.getCanvasBBox(),s=t.x-o.minX,a=t.y-o.minY;if(n){var l=s*r[0],c=a*r[4],u=0,h=0,d=0,f=0;e.animate((function(e){return r=rl(r,[["t",(d=l*e)-u,(f=c*e)-h]]),u=d,h=f,{matrix:r}}),i)}else{var g=rl(r,[["t",s,a]]);e.setMatrix(g)}};function ml(e,t,n){return(n[0]-e[0])*(t[1]-e[1])==(t[0]-e[0])*(n[1]-e[1])&&Math.min(e[0],t[0])<=n[0]&&n[0]<=Math.max(e[0],t[0])&&Math.min(e[1],t[1])<=n[1]&&n[1]<=Math.max(e[1],t[1])}var vl=function(e,t,n){var i=!1,r=e.length;function o(e){return Math.abs(e)<1e-6?0:e<0?-1:1}if(r<=2)return!1;for(var s=0;s<r;s++){var a=e[s],l=e[(s+1)%r];if(ml(a,l,[t,n]))return!0;o(a[1]-n)>0!=o(l[1]-n)>0&&o(t-(n-a[1])*(a[0]-l[0])/(a[1]-l[1])-a[0])<0&&(i=!i)}return i},yl=function(e,t){return!(t.minX>e.maxX||t.maxX<e.minX||t.minY>e.maxY||t.maxY<e.minY)},_l=function(e,t){var n=function(e){var t=e.map((function(e){return e[0]})),n=e.map((function(e){return e[1]}));return{minX:Math.min.apply(null,t),maxX:Math.max.apply(null,t),minY:Math.min.apply(null,n),maxY:Math.max.apply(null,n)}},i=function(e){for(var t=[],n=e.length,i=0;i<n-1;i++){var r=e[i],o=e[i+1];t.push({from:{x:r[0],y:r[1]},to:{x:o[0],y:o[1]}})}if(t.length>1){var s=e[0],a=e[n-1];t.push({from:{x:a[0],y:a[1]},to:{x:s[0],y:s[1]}})}return t};if(e.length<2||t.length<2)return!1;var r=n(e),o=n(t);if(!yl(r,o))return!1;var s=!1;if(cr(t,(function(t){if(vl(e,t[0],t[1]))return s=!0,!1})),s)return!0;if(cr(e,(function(e){if(vl(t,e[0],e[1]))return s=!0,!1})),s)return!0;var a=i(e),l=i(t),c=!1;return cr(l,(function(e){if(function(e,t){var n=!1;return cr(e,(function(e){if(sl(e.from,e.to,t.from,t.to))return n=!0,!1})),n}(a,e))return c=!0,!1})),c},bl=function(){function e(e,t,n,i){this.x1=e,this.y1=t,this.x2=n,this.y2=i}return e.prototype.getBBox=function(){var e=Math.min(this.x1,this.x2),t=Math.min(this.y1,this.y2),n=Math.max(this.x1,this.x2),i=Math.max(this.y1,this.y2);return{x:e,y:t,minX:e,minY:t,maxX:n,maxY:i,width:n-e,height:i-t}},e}(),wl=function(e,t){return{top:[e.minX,e.minY,e.maxX,e.minY],left:[e.minX,e.minY,e.minX,e.maxY],bottom:[e.minX,e.maxY,e.maxX,e.maxY],right:[e.maxX,e.minY,e.maxX,e.maxY]}[t]},Cl=function(e,t){var n=(t.x2-t.x1)*(e.y1-t.y1)-(t.y2-t.y1)*(e.x1-t.x1),i=(e.x2-e.x1)*(e.y1-t.y1)-(e.y2-e.y1)*(e.x1-t.x1),r=(t.y2-t.y1)*(e.x2-e.x1)-(t.x2-t.x1)*(e.y2-e.y1);if(r){var o=n/r,s=i/r;if(o>=0&&o<=1&&s>=0&&s<=1)return o}return Number.POSITIVE_INFINITY},Sl=function(e,t){for(var n=["top","left","bottom","right"],i=e.getBBox(),r=0,o=[],s=0;s<4;s++){var a=wl(i,n[s]),l=a[0],c=a[1],u=a[2],h=a[3];o[s]=sl({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},{x:l,y:c},{x:u,y:h}),o[s]&&(r+=1)}return[o,r]},xl=function(e,t){for(var n=["top","left","bottom","right"],i=e.getBBox(),r=Number.POSITIVE_INFINITY,o=0,s=0;s<4;s++){var a=wl(i,n[s]),l=a[0],c=a[1],u=a[2],h=a[3],d=Cl(t,new bl(l,c,u,h));(d=Math.abs(d-.5))>=0&&d<=1&&(o+=1,r=d<r?d:r)}return 0===o?-1:r},El=function(e){var t=0,n=0;if(e.length>0){for(var i=0,r=e;i<r.length;i++){var o=r[i];t+=o.x,n+=o.y}t/=e.length,n/=e.length}return{x:t,y:n}},kl=function(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)},Ll=function(e,t){var n,i=t.x1,r=t.y1,o=t.x2-i,s=t.y2-r,a=e.x-i,l=e.y-r,c=a*o+l*s;n=c<=0||(c=(a=o-a)*o+(l=s-l)*s)<=0?0:c*c/(o*o+s*s);var u=a*a+l*l-n;return u<0&&(u=0),u},Dl=function(e,t,n){return void 0===n&&(n=.001),Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)<Math.pow(n,2)},Nl=function(e,t){var n=e.x<t.x,i=e.x>t.x+t.width,r=e.y>t.y+t.height,o=e.y<t.y;if(!(n||i||r||o))return 0;if(r&&!n&&!i)return Math.pow(t.y+t.height-e.y,2);if(o&&!n&&!i)return Math.pow(e.y-t.y,2);if(n&&!r&&!o)return Math.pow(t.x-e.x,2);if(i&&!r&&!o)return Math.pow(t.x+t.width-e.x,2);var s=Math.min(Math.abs(t.x-e.x),Math.abs(t.x+t.width-e.x)),a=Math.min(Math.abs(t.y-e.y),Math.abs(t.y+t.height-e.y));return s*s+a*a},Il=function(e,t,n){return e+(t-e)*n},Tl=Object.freeze(Object.defineProperty({__proto__:null,compare:function(e){return function(t,n){return t[e]-n[e]}},getLineIntersect:sl,getRectIntersectByPoint:al,getCircleIntersectByPoint:ll,getEllipseIntersectByPoint:cl,applyMatrix:ul,invertMatrix:hl,getCircleCenterByPoints:dl,distance:fl,scaleMatrix:function(e,t){var n=[];return e.forEach((function(e){var i=[];e.forEach((function(e){i.push(e*t)})),n.push(i)})),n},floydWarshall:function(e){for(var t=[],n=e.length,i=0;i<n;i+=1){t[i]=[];for(var r=0;r<n;r+=1)i===r?t[i][r]=0:0!==e[i][r]&&e[i][r]?t[i][r]=e[i][r]:t[i][r]=1/0}for(var o=0;o<n;o+=1)for(i=0;i<n;i+=1)for(r=0;r<n;r+=1)t[i][r]>t[i][o]+t[o][r]&&(t[i][r]=t[i][o]+t[o][r]);return t},getAdjMatrix:function(e,t){var n=e.nodes,i=e.edges,r=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach((function(e,t){o[e.id]=t;r.push([])})),i&&i.forEach((function(e){var n=e.source,i=e.target,s=o[n],a=o[i];r[s][a]=1,t||(r[a][s]=1)})),r},translate:gl,move:pl,scale:function(e,t){var n=e.getMatrix();n||(n=[1,0,0,0,1,0,0,0,1]);var i=t;ar(t)||(i=[t,t]),ar(t)&&1===t.length&&(i=[t[0],t[0]]),n=rl(n,[["s",i[0],i[1]]]),e.setMatrix(n)},rotate:function(e,t){var n=e.getMatrix();n||(n=[1,0,0,0,1,0,0,0,1]),n=rl(n,[["r",t]]),e.setMatrix(n)},getDegree:function(e,t,n){for(var i=[],r=0;r<e;r++)i[r]=0;return n.forEach((function(e){e.source&&(i[t[e.source]]+=1),e.target&&(i[t[e.target]]+=1)})),i},isPointInPolygon:vl,intersectBBox:yl,isPolygonsIntersect:_l,Line:bl,getBBoxBoundLine:wl,itemIntersectByLine:Sl,fractionToLine:xl,getPointsCenter:El,squareDist:kl,pointLineSquareDist:Ll,isPointsOverlap:Dl,pointRectSquareDist:Nl,pointLineDistance:function(e,t){var n=e[0],i=e[1],r=e[2],o=e[3],s=t.x,a=t.y,l=[r-n,o-i];if(Fs(l,[0,0]))return NaN;var c=[-l[1],l[0]];Rs(c,c);var u=[s-n,a-i];return Math.abs(Ps(u,c))},lerp:Il},Symbol.toStringTag,{value:"Module"})),Ml="rgb(95, 149, 255)",Al="rgb(253, 253, 253)",Ol="rgb(247, 250, 255)",Rl="rgb(224, 224, 224)",Pl="rgb(224, 224, 224)",Fl={version:"0.5.5",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:Ml,fill:"rgb(239, 244, 255)"},size:20,color:Ml,linkPoints:{size:8,lineWidth:1,fill:Ol,stroke:Ml}},nodeStateStyles:{active:{fill:Ol,stroke:Ml,lineWidth:2,shadowColor:Ml,shadowBlur:10},selected:{fill:"rgb(255, 255, 255)",stroke:Ml,lineWidth:4,shadowColor:Ml,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:"rgb(223, 234, 255)",stroke:"#4572d9",lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:"rgb(247, 250, 255)",stroke:"rgb(191, 213, 255)",lineWidth:1},disable:{fill:"rgb(250, 250, 250)",stroke:"rgb(224, 224, 224)",lineWidth:1}},edgeLabel:{style:{fill:"rgb(0, 0, 0)",textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:Rl,lineAppendWidth:2},color:Rl},edgeStateStyles:{active:{stroke:Ml,lineWidth:1},selected:{stroke:Ml,lineWidth:2,shadowColor:Ml,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:Ml,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:"rgb(234, 234, 234)",lineWidth:1},disable:{stroke:"rgb(245, 245, 245)",lineWidth:1}},comboLabel:{style:{fill:"rgb(0, 0, 0)",textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:Al,lineWidth:1,stroke:Pl,r:5,width:20,height:10},size:[20,5],color:Pl,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:Ml,lineWidth:1,fill:"rgb(247, 250, 255)"},selected:{stroke:Ml,lineWidth:2,fill:Al,shadowColor:Ml,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:"#4572d9",lineWidth:2,fill:Al,"text-shape":{fontWeight:500}},inactive:{stroke:"rgb(224, 224, 224)",fill:Al,lineWidth:1},disable:{stroke:"rgb(234, 234, 234)",fill:"rgb(250, 250, 250)",lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},windowFontFamily:"undefined"!=typeof window&&window.getComputedStyle&&document.body&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},Bl={" ":.3329986572265625,a:.5589996337890625,A:.6569992065429687,b:.58599853515625,B:.6769989013671875,c:.5469985961914062,C:.7279998779296875,d:.58599853515625,D:.705999755859375,e:.554998779296875,E:.63699951171875,f:.37299957275390627,F:.5769989013671875,g:.5909988403320312,G:.7479995727539063,h:.555999755859375,H:.7199996948242188,i:.255999755859375,I:.23699951171875,j:.26699981689453123,J:.5169998168945312,k:.5289993286132812,K:.6899993896484375,l:.23499908447265624,L:.5879989624023437,m:.854998779296875,M:.8819992065429687,n:.5589996337890625,N:.7189987182617188,o:.58599853515625,O:.7669998168945312,p:.58599853515625,P:.6419998168945312,q:.58599853515625,Q:.7669998168945312,r:.3649993896484375,R:.6759994506835938,s:.504998779296875,S:.6319992065429687,t:.354998779296875,T:.6189987182617187,u:.5599990844726562,U:.7139999389648437,v:.48199920654296874,V:.6389999389648438,w:.754998779296875,W:.929998779296875,x:.5089996337890625,X:.63699951171875,y:.4959991455078125,Y:.66199951171875,z:.48699951171875,Z:.6239990234375,0:.6,1:.40099945068359377,2:.6,3:.6,4:.6,5:.6,6:.6,7:.5469985961914062,8:.6,9:.6,"[":.3329986572265625,"]":.3329986572265625,",":.26399993896484375,".":.26399993896484375,";":.26399993896484375,":":.26399993896484375,"{":.3329986572265625,"}":.3329986572265625,"\\":.5,"|":.19499969482421875,"=":.604998779296875,"+":.604998779296875,"-":.604998779296875,_:.5,"`":.3329986572265625," ~":.8329986572265625,"!":.3329986572265625,"@":.8579986572265625,"#":.6,$:.6,"%":.9699996948242188,"^":.517999267578125,"&":.7259994506835937,"*":.505999755859375,"(":.3329986572265625,")":.3329986572265625,"<":.604998779296875,">":.604998779296875,"/":.5,"?":.53699951171875},Wl=Math.PI,zl=Math.sin,Vl=Math.cos,Ul=zl(Wl/8),Hl=Vl(Wl/8),jl=function(e,t){var n=e.getBBox(),i={x:n.minX,y:n.minY},r={x:n.maxX,y:n.maxY};if(t){var o=t.getMatrix();o||(o=[1,0,0,0,1,0,0,0,1]),i=ul(i,o),r=ul(r,o)}var s=i.x,a=i.y,l=r.x,c=r.y;return{x:s,y:a,minX:s,minY:a,maxX:l,maxY:c,width:l-s,height:c-a}},Gl=function(e){var t=e.sourceNode||e.targetNode,n=t.get("group").getMatrix();n||(n=[1,0,0,0,1,0,0,0,1]);var i=t.getKeyShape().getBBox(),r=e.loopCfg||{},o=r.dist||2*Math.max(i.width,i.height),s=r.position||Fl.defaultLoopPosition,a=[n[6],n[7]],l=[e.startPoint.x,e.startPoint.y],c=[e.endPoint.x,e.endPoint.y],u=i.height/2,h=i.height/2,d=u*Ul,f=u*Hl,g=h*Ul,p=h*Hl;if(l[0]===c[0]&&l[1]===c[1]){switch(s){case"top":l=[a[0]-d,a[1]-f],c=[a[0]+g,a[1]-p];break;case"top-right":u=i.height/2,h=i.width/2,l=[a[0]+(d=u*Ul),a[1]-(f=u*Hl)],c=[a[0]+(p=h*Hl),a[1]-(g=h*Ul)];break;case"right":u=i.width/2,h=i.width/2,l=[a[0]+(f=u*Hl),a[1]-(d=u*Ul)],c=[a[0]+(p=h*Hl),a[1]+(g=h*Ul)];break;case"bottom-right":u=i.width/2,h=i.height/2,l=[a[0]+(f=u*Hl),a[1]+(d=u*Ul)],c=[a[0]+(g=h*Ul),a[1]+(p=h*Hl)];break;case"bottom":u=i.height/2,h=i.height/2,l=[a[0]+(d=u*Ul),a[1]+(f=u*Hl)],c=[a[0]-(g=h*Ul),a[1]+(p=h*Hl)];break;case"bottom-left":u=i.height/2,h=i.width/2,l=[a[0]-(d=u*Ul),a[1]+(f=u*Hl)],c=[a[0]-(p=h*Hl),a[1]+(g=h*Ul)];break;case"left":u=i.width/2,h=i.width/2,l=[a[0]-(f=u*Hl),a[1]+(d=u*Ul)],c=[a[0]-(p=h*Hl),a[1]-(g=h*Ul)];break;case"top-left":u=i.width/2,h=i.height/2,l=[a[0]-(f=u*Hl),a[1]-(d=u*Ul)],c=[a[0]-(g=h*Ul),a[1]-(p=h*Hl)];break;default:u=i.width/2,h=i.width/2,l=[a[0]-(d=u*Ul),a[1]-(f=u*Hl)],c=[a[0]+(g=h*Ul),a[1]-(p=h*Hl)]}if(!1===r.clockwise){var m=[l[0],l[1]];l=[c[0],c[1]],c=[m[0],m[1]]}}var v=[l[0]-a[0],l[1]-a[1]],y=(u+o)/u,_=(h+o)/h;!1===r.clockwise&&(y=(h+o)/h,_=(u+o)/u);var b=As([0,0],v,y),w=[a[0]+b[0],a[1]+b[1]],C=As([0,0],[c[0]-a[0],c[1]-a[1]],_),S=[a[0]+C[0],a[1]+C[1]];return e.startPoint={x:l[0],y:l[1]},e.endPoint={x:c[0],y:c[1]},e.controlPoints=[{x:w[0],y:w[1]},{x:S[0],y:S[1]}],e},Kl=function(e,t,n,i,r){var o=1e-4,s=[],a=null==e?void 0:e.getPoint(t);if(!a)return{x:0,y:0,angle:0};if(t<o)s=e.getStartTangent().reverse();else if(t>.9999)s=e.getEndTangent();else{var l=null==e?void 0:e.getPoint(t+o);s.push([a.x,a.y]),s.push([l.x,l.y])}var c=Math.atan2(s[1][1]-s[0][1],s[1][0]-s[0][0]);if(c<0&&(c+=2*Wl),n&&(a.x+=Vl(c)*n,a.y+=zl(c)*n),i){var u=c-Wl/2;c>.5*Wl&&c<1.5*Wl&&(u-=Wl),a.x+=Vl(u)*i,a.y+=zl(u)*i}var h={x:a.x,y:a.y,angle:c};return r?(c>.5*Wl&&c<1.5*Wl&&(c-=Wl),$i({rotate:c},h)):h},ql=function e(t,n){if(!1===n(t))return!1;if(t&&t.children)for(var i=t.children.length-1;i>=0;i--)if(!e(t.children[i],n))return!1;return!0},$l=function e(t,n){if(t&&t.children)for(var i=t.children.length-1;i>=0;i--)if(!e(t.children[i],n))return;return!1!==n(t)},Yl=function(e,t){"function"==typeof t&&ql(e,t)},Xl=function(e,t){"function"==typeof t&&$l(e,t)},Zl=function(e,t){return t*(Bl[e]||1)},Ql=function(e,t){var n=0,i=new RegExp("[一-龥]+");return e.split("").forEach((function(e){i.test(e)?n+=t:n+=Zl(e,t)})),[n,t]},Jl=function(e,t){var n=[],i={},r={};e.forEach((function(e){r[e.id]=e})),e.forEach((function(e,t){var o=no(e);o.itemType="combo",o.children=void 0,o.parentId===o.id?(console.warn("The parentId for combo ".concat(o.id," can not be the same as the combo's id")),delete o.parentId):o.parentId&&!r[o.parentId]&&(console.warn("The parent combo for combo ".concat(o.id," does not exist!")),delete o.parentId);var s=i[o.id];if(s){if(o.children=s.children,i[o.id]=o,!(s=o).parentId)return void n.push(s);var a=i[s.parentId];if(a)a.children?a.children.push(o):a.children=[o];else{var l={id:s.parentId,children:[s]};i[s.parentId]=l,i[o.id]=o}}else if(xr(e.parentId)){var c=i[e.parentId];if(c)c.children?c.children.push(o):c.children=[o],i[o.id]=o;else{var u={id:e.parentId,children:[o]};i[u.id]=u,i[o.id]=o}}else n.push(o),i[o.id]=o}));var o={};(t||[]).forEach((function(e){o[e.id]=e;var t=i[e.comboId];if(t){var n={id:e.id,comboId:e.comboId};t.children?t.children.push(n):t.children=[n],n.itemType="node",i[e.id]=n}}));var s=0;return n.forEach((function(e){e.depth=s+10,ql(e,(function(e){var t,n=i[e.id].itemType;t="node"===n?i[e.comboId]:i[e.parentId],e.depth=t&&"node"===n?s+1:s+10,s<e.depth&&(s=e.depth);var r=o[e.id];return r&&(r.depth=e.depth),!0}))})),n},ec=function(e,t,n){var i,r=e,o={root:{children:e}},s=!1,a="root";(e||[]).forEach((function(e){if(!s)return e.id===t?(i=e,"combo"===e.itemType?i.parentId=n:i.comboId=n,void(s=!0)):void Yl(e,(function(e){return o[e.id]={children:e.children},r=o[e.parentId||e.comboId||"root"].children,!e||!e.removed&&t!==e.id||!r||(a=e.parentId||e.comboId||"root",i=e,"combo"===e.itemType?i.parentId=n:i.comboId=n,s=!0,!1)}))}));var l=(r=o[a].children)?r.indexOf(i):-1;if(l>-1&&r.splice(l,1),s||(i={id:t,itemType:"node",comboId:n},o[t]={children:void 0}),t){var c=!1;if(n){var u=0;(e||[]).forEach((function(e){c||Yl(e,(function(e){return n!==e.id||(c=!0,e.children?e.children.push(i):e.children=[i],u=e.depth,"node"===i.itemType?i.depth=u+2:i.depth=u+1,!1)}))}))}else n&&c||"node"===i.itemType||e.push(i);var h=i.depth;Yl(i,(function(e){return"node"===e.itemType?h+=2:h+=1,e.depth=h,!0}))}return e},tc=function(e,t,n){var i={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,x:void 0,y:void 0,width:void 0,height:void 0,centerX:void 0,centerY:void 0};if(!e||0===e.length){var r=(null==n?void 0:n.getModel())||{},o=r.x,s=r.y;return{minX:o,minY:s,maxX:o,maxY:s,x:o,y:s,width:void 0,height:void 0}}return e.forEach((function(e){var n=t.findById(e.id);if(n&&n.isVisible()){n.set("bboxCanvasCache",void 0);var r=n.getCanvasBBox();r.x&&i.minX>r.minX&&(i.minX=r.minX),r.y&&i.minY>r.minY&&(i.minY=r.minY),r.x&&i.maxX<r.maxX&&(i.maxX=r.maxX),r.y&&i.maxY<r.maxY&&(i.maxY=r.maxY)}})),i.x=(i.minX+i.maxX)/2,i.y=(i.minY+i.maxY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2,Object.keys(i).forEach((function(e){i[e]!==1/0&&i[e]!==-1/0||(i[e]=void 0)})),i},nc=function(e){var t={};return Object.keys(e).forEach((function(n){var i=e[n];if(lr(i)&&!ar(i)){var r={};Object.keys(i).forEach((function(e){var t=i[e];("img"!==e||xr(t))&&(r[e]=no(t))})),t[n]=r}else t[n]=no(i)})),t},ic=Object.freeze(Object.defineProperty({__proto__:null,getBBox:jl,getLoopCfgs:Gl,getLabelPosition:Kl,traverseTree:Yl,traverseTreeUp:Xl,getLetterWidth:Zl,getTextSize:Ql,plainCombosToTrees:Jl,reconstructTree:ec,getComboBBox:tc,shouldRefreshEdge:function(e){var t=Or(e.x)||Or(e.y)||e.type||e.anchorPoints||e.size;return e.style&&(t=t||Or(e.style.r)||Or(e.style.width)||Or(e.style.height)||Or(e.style.rx)||Or(e.style.ry)),t},cloneBesidesImg:nc},Symbol.toStringTag,{value:"Module"})),rc=function(e){var t;if(!e)return console.error("G6 Error Tips: the data must be defined"),!1;var n=e.nodes,i=e.edges,r=e.combos,o=void 0===r?[]:r;if(!n&&!i){var s=!0;return Yl(e,(function(e){return!!xr(e.id)||(s=!1,!1)})),s}var a=(n||[]).find((function(e){return!xr(e.id)}));if(a)return console.warn("G6 Warning Tips: missing 'id' property, or %c".concat(a.id,"%c is not a string."),"font-size: 20px; color: red;",""),!1;var l=(n||[]).map((function(e){return e.id})),c=null===(t=o)||void 0===t?void 0:t.map((function(e){return e.id})),u=Ji(Ji([],l,!0),c,!0),h=(i||[]).find((function(e){return!u.includes(e.source)||!u.includes(e.target)}));return!h||(console.warn("G6 Warning Tips: The source %c".concat(h.source,"%c or the target %c").concat(h.target,"%c of the edge do not exist in the nodes or combos."),"font-size: 20px; color: red;","","font-size: 20px; color: red;",""),!1)},oc=function(){function e(e){this.graph=e,this.destroyed=!1,this.modes=e.get("modes")||{default:[]},this.formatModes(),this.mode=e.get("defaultMode")||"default",this.currentBehaves=[],this.setMode(this.mode)}return e.prototype.formatModes=function(){cr(this.modes,(function(e){cr(e,(function(t,n){xr(t)&&(e[n]={type:t})}))}))},e.prototype.setBehaviors=function(e){var t,n=this.graph,i=this.modes[e],r=[];cr(i||[],(function(e){var i=Lo.getBehavior(e.type||e);i&&(t=new i(e))&&(t.bind(n),r.push(t))})),this.currentBehaves=r},e.mergeBehaviors=function(e,t){return cr(t,(function(t){e.indexOf(t)<0&&(xr(t)&&(t={type:t}),e.push(t))})),e},e.filterBehaviors=function(e,t){var n=[];return e.forEach((function(e){var i="";i=xr(e)?e:e.type,t.indexOf(i)<0&&n.push(e)})),n},e.prototype.setMode=function(e){var t=this.modes,n=this.graph,i=e;t[i]&&(n.emit("beforemodechange",{mode:e}),cr(this.currentBehaves,(function(e){e.delegate&&e.delegate.remove(),e.unbind(n)})),this.setBehaviors(i),n.emit("aftermodechange",{mode:e}),this.mode=e)},e.prototype.getMode=function(){return this.mode},e.prototype.manipulateBehaviors=function(t,n,i){var r,o=this;if(r=ar(t)?t:[t],ar(n))return cr(n,(function(t){o.modes[t]?o.modes[t]=i?e.mergeBehaviors(o.modes[t]||[],r):e.filterBehaviors(o.modes[t]||[],r):i&&(o.modes[t]=r)})),this;var s=n;return n||(s=this.mode),this.modes[s]||i&&(this.modes[s]=r),this.modes[s]=i?e.mergeBehaviors(this.modes[s]||[],r):e.filterBehaviors(this.modes[s]||[],r),this.formatModes(),this.setMode(this.mode),this},e.prototype.updateBehavior=function(e,t,n){xr(e)&&(e={type:e});var i=[];if(n&&n!==this.mode&&"default"!==n){if(!(i=this.modes[n])||!i.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;var r=i.length;for(s=0;s<r;s++){if((a=i[s]).type===e.type||a===e.type)return a===e.type&&(a={type:a}),Object.assign(a,t),i[s]=a,this;s===r-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}else{if(!(i=this.currentBehaves)||!i.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var o=i.length,s=0;s<o;s++){var a;if((a=i[s]).type===e.type)return a.updateCfg(t),this;s===o-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}return this},e.prototype.destroy=function(){this.graph=null,this.modes=null,this.currentBehaves=null,this.destroyed=!0},e}(),sc="\t\n\v\f\r   ᠎             　\u2028\u2029",ac=new RegExp("([a-z])["+sc+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+sc+"]*,?["+sc+"]*)+)","ig"),lc=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+sc+"]*,?["+sc+"]*","ig"),cc=function(e){if(!e)return null;if(ar(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},n=[];return String(e).replace(ac,(function(i,r,o){var s=[],a=r.toLowerCase();if(o.replace(lc,(function(e,t){t&&s.push(+t)})),"m"===a&&s.length>2&&(n.push([r].concat(s.splice(0,2))),a="l",r="m"===r?"l":"L"),"o"===a&&1===s.length&&n.push([r,s[0]]),"r"===a)n.push([r].concat(s));else for(;s.length>=t[a]&&(n.push([r].concat(s.splice(0,t[a]))),t[a]););return e})),n},uc=function(e,t){for(var n=[],i=0,r=e.length;r-2*!t>i;i+=2){var o=[{x:+e[i-2],y:+e[i-1]},{x:+e[i],y:+e[i+1]},{x:+e[i+2],y:+e[i+3]},{x:+e[i+4],y:+e[i+5]}];t?i?r-4===i?o[3]={x:+e[0],y:+e[1]}:r-2===i&&(o[2]={x:+e[0],y:+e[1]},o[3]={x:+e[2],y:+e[3]}):o[0]={x:+e[r-2],y:+e[r-1]}:r-4===i?o[3]=o[2]:i||(o[0]={x:+e[i],y:+e[i+1]}),n.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return n},hc=function(e,t,n,i,r){var o=[];if(null===r&&null===i&&(i=n),e=+e,t=+t,n=+n,i=+i,null!==r){var s=Math.PI/180,a=e+n*Math.cos(-i*s),l=e+n*Math.cos(-r*s);o=[["M",a,t+n*Math.sin(-i*s)],["A",n,n,0,+(r-i>180),0,l,t+n*Math.sin(-r*s)]]}else o=[["M",e,t],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]];return o},dc=function(e){if(!(e=cc(e))||!e.length)return[["M",0,0]];var t,n,i=[],r=0,o=0,s=0,a=0,l=0;"M"===e[0][0]&&(s=r=+e[0][1],a=o=+e[0][2],l++,i[0]=["M",r,o]);for(var c=3===e.length&&"M"===e[0][0]&&"R"===e[1][0].toUpperCase()&&"Z"===e[2][0].toUpperCase(),u=void 0,h=void 0,d=l,f=e.length;d<f;d++){if(i.push(u=[]),(t=(h=e[d])[0])!==t.toUpperCase())switch(u[0]=t.toUpperCase(),u[0]){case"A":u[1]=h[1],u[2]=h[2],u[3]=h[3],u[4]=h[4],u[5]=h[5],u[6]=+h[6]+r,u[7]=+h[7]+o;break;case"V":u[1]=+h[1]+o;break;case"H":u[1]=+h[1]+r;break;case"R":for(var g=2,p=(n=[r,o].concat(h.slice(1))).length;g<p;g++)n[g]=+n[g]+r,n[++g]=+n[g]+o;i.pop(),i=i.concat(uc(n,c));break;case"O":i.pop(),(n=hc(r,o,h[1],h[2])).push(n[0]),i=i.concat(n);break;case"U":i.pop(),i=i.concat(hc(r,o,h[1],h[2],h[3])),u=["U"].concat(i[i.length-1].slice(-2));break;case"M":s=+h[1]+r,a=+h[2]+o;break;default:for(g=1,p=h.length;g<p;g++)u[g]=+h[g]+(g%2?r:o)}else if("R"===t)n=[r,o].concat(h.slice(1)),i.pop(),i=i.concat(uc(n,c)),u=["R"].concat(h.slice(-2));else if("O"===t)i.pop(),(n=hc(r,o,h[1],h[2])).push(n[0]),i=i.concat(n);else if("U"===t)i.pop(),i=i.concat(hc(r,o,h[1],h[2],h[3])),u=["U"].concat(i[i.length-1].slice(-2));else for(var m=0,v=h.length;m<v;m++)u[m]=h[m];if("O"!==(t=t.toUpperCase()))switch(u[0]){case"Z":r=+s,o=+a;break;case"H":r=u[1];break;case"V":o=u[1];break;case"M":s=u[u.length-2],a=u[u.length-1];break;default:r=u[u.length-2],o=u[u.length-1]}}return i},fc=function(e,t,n,i){return[e,t,n,i,n,i]},gc=function(e,t,n,i,r,o){var s=1/3,a=2/3;return[s*e+a*n,s*t+a*i,s*r+a*n,s*o+a*i,r,o]},pc=function(e,t,n,i,r,o,s,a,l,c){n===i&&(n+=1);var u,h,d,f,g,p=120*Math.PI/180,m=Math.PI/180*(+r||0),v=[],y=function(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}};if(c)h=c[0],d=c[1],f=c[2],g=c[3];else{e=(u=y(e,t,-m)).x,t=u.y,a=(u=y(a,l,-m)).x,l=u.y,e===a&&t===l&&(a+=1,l+=1);var _=(e-a)/2,b=(t-l)/2,w=_*_/(n*n)+b*b/(i*i);w>1&&(n*=w=Math.sqrt(w),i*=w);var C=n*n,S=i*i,x=(o===s?-1:1)*Math.sqrt(Math.abs((C*S-C*b*b-S*_*_)/(C*b*b+S*_*_)));f=x*n*b/i+(e+a)/2,g=x*-i*_/n+(t+l)/2,h=Math.asin(((t-g)/i).toFixed(9)),d=Math.asin(((l-g)/i).toFixed(9)),h=e<f?Math.PI-h:h,d=a<f?Math.PI-d:d,h<0&&(h=2*Math.PI+h),d<0&&(d=2*Math.PI+d),s&&h>d&&(h-=2*Math.PI),!s&&d>h&&(d-=2*Math.PI)}var E=d-h;if(Math.abs(E)>p){var k=d,L=a,D=l;d=h+p*(s&&d>h?1:-1),a=f+n*Math.cos(d),l=g+i*Math.sin(d),v=pc(a,l,n,i,r,0,s,L,D,[d,k,f,g])}E=d-h;var N=Math.cos(h),I=Math.sin(h),T=Math.cos(d),M=Math.sin(d),A=Math.tan(E/4),O=4/3*n*A,R=4/3*i*A,P=[e,t],F=[e+O*I,t-R*N],B=[a+O*M,l-R*T],W=[a,l];if(F[0]=2*P[0]-F[0],F[1]=2*P[1]-F[1],c)return[F,B,W].concat(v);for(var z=[],V=0,U=(v=[F,B,W].concat(v).join().split(",")).length;V<U;V++)z[V]=V%2?y(v[V-1],v[V],m).y:y(v[V],v[V+1],m).x;return z},mc=function(e,t){var n,i=dc(e),r=t&&dc(t),o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=[],l=[],c="",u="",h=function(e,t,n){var i,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(pc.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"===n||"S"===n?(i=2*t.x-t.bx,r=2*t.y-t.by):(i=t.x,r=t.y),e=["C",i,r].concat(e.slice(1));break;case"T":"Q"===n||"T"===n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(gc(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(gc(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(fc(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(fc(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(fc(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(fc(t.x,t.y,t.X,t.Y))}return e},d=function(e,t){if(e[t].length>7){e[t].shift();for(var o=e[t];o.length;)a[t]="A",r&&(l[t]="A"),e.splice(t++,0,["C"].concat(o.splice(0,6)));e.splice(t,1),n=Math.max(i.length,r&&r.length||0)}},f=function(e,t,o,s,a){e&&t&&"M"===e[a][0]&&"M"!==t[a][0]&&(t.splice(a,0,["M",s.x,s.y]),o.bx=0,o.by=0,o.x=e[a][1],o.y=e[a][2],n=Math.max(i.length,r&&r.length||0))};n=Math.max(i.length,r&&r.length||0);for(var g=0;g<n;g++){i[g]&&(c=i[g][0]),"C"!==c&&(a[g]=c,g&&(u=a[g-1])),i[g]=h(i[g],o,u),"A"!==a[g]&&"C"===c&&(a[g]="C"),d(i,g),r&&(r[g]&&(c=r[g][0]),"C"!==c&&(l[g]=c,g&&(u=l[g-1])),r[g]=h(r[g],s,u),"A"!==l[g]&&"C"===c&&(l[g]="C"),d(r,g)),f(i,r,o,s,g),f(r,i,s,o,g);var p=i[g],m=r&&r[g],v=p.length,y=r&&m.length;o.x=p[v-2],o.y=p[v-1],o.bx=parseFloat(p[v-4])||o.x,o.by=parseFloat(p[v-3])||o.y,s.bx=r&&(parseFloat(m[y-4])||s.x),s.by=r&&(parseFloat(m[y-3])||s.y),s.x=r&&m[y-2],s.y=r&&m[y-1]}return r?[i,r]:i},vc=/,?([a-z]),?/gi,yc=function(e){return e.join(",").replace(vc,"$1")},_c=function(e,t,n,i,r){return e*(e*(-3*t+9*n-9*i+3*r)+6*t-12*n+6*i)-3*t+3*n},bc=function(e,t,n,i,r,o,s,a,l){null===l&&(l=1);for(var c=(l=l>1?1:l<0?0:l)/2,u=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,f=0;f<12;f++){var g=c*u[f]+c,p=_c(g,e,n,r,s),m=_c(g,t,i,o,a),v=p*p+m*m;d+=h[f]*Math.sqrt(v)}return c*d},wc=function(e,t,n,i,r,o,s,a){for(var l,c,u,h,d=[],f=[[],[]],g=0;g<2;++g)if(0===g?(c=6*e-12*n+6*r,l=-3*e+9*n-9*r+3*s,u=3*n-3*e):(c=6*t-12*i+6*o,l=-3*t+9*i-9*o+3*a,u=3*i-3*t),Math.abs(l)<1e-12){if(Math.abs(c)<1e-12)continue;(h=-u/c)>0&&h<1&&d.push(h)}else{var p=c*c-4*u*l,m=Math.sqrt(p);if(!(p<0)){var v=(-c+m)/(2*l);v>0&&v<1&&d.push(v);var y=(-c-m)/(2*l);y>0&&y<1&&d.push(y)}}for(var _,b=d.length,w=b;b--;)_=1-(h=d[b]),f[0][b]=_*_*_*e+3*_*_*h*n+3*_*h*h*r+h*h*h*s,f[1][b]=_*_*_*t+3*_*_*h*i+3*_*h*h*o+h*h*h*a;return f[0][w]=e,f[1][w]=t,f[0][w+1]=s,f[1][w+1]=a,f[0].length=f[1].length=w+2,{min:{x:Math.min.apply(0,f[0]),y:Math.min.apply(0,f[1])},max:{x:Math.max.apply(0,f[0]),y:Math.max.apply(0,f[1])}}},Cc=function(e,t,n,i,r,o,s,a){if(!(Math.max(e,n)<Math.min(r,s)||Math.min(e,n)>Math.max(r,s)||Math.max(t,i)<Math.min(o,a)||Math.min(t,i)>Math.max(o,a))){var l=(e-n)*(o-a)-(t-i)*(r-s);if(l){var c=((e*i-t*n)*(r-s)-(e-n)*(r*a-o*s))/l,u=((e*i-t*n)*(o-a)-(t-i)*(r*a-o*s))/l,h=+c.toFixed(2),d=+u.toFixed(2);if(!(h<+Math.min(e,n).toFixed(2)||h>+Math.max(e,n).toFixed(2)||h<+Math.min(r,s).toFixed(2)||h>+Math.max(r,s).toFixed(2)||d<+Math.min(t,i).toFixed(2)||d>+Math.max(t,i).toFixed(2)||d<+Math.min(o,a).toFixed(2)||d>+Math.max(o,a).toFixed(2)))return{x:c,y:u}}}},Sc=function(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height},xc=function(e,t,n,i,r){if(r)return[["M",+e+ +r,t],["l",n-2*r,0],["a",r,r,0,0,1,r,r],["l",0,i-2*r],["a",r,r,0,0,1,-r,r],["l",2*r-n,0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-i],["a",r,r,0,0,1,r,-r],["z"]];var o=[["M",e,t],["l",n,0],["l",0,i],["l",-n,0],["z"]];return o.parsePathArray=yc,o},Ec=function(e,t,n,i){return null===e&&(e=t=n=i=0),null===t&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,w:n,height:i,h:i,x2:e+n,y2:t+i,cx:e+n/2,cy:t+i/2,r1:Math.min(n,i)/2,r2:Math.max(n,i)/2,r0:Math.sqrt(n*n+i*i)/2,path:xc(e,t,n,i),vb:[e,t,n,i].join(" ")}},kc=function(e,t,n,i,r,o,s,a){ar(e)||(e=[e,t,n,i,r,o,s,a]);var l=wc.apply(null,e);return Ec(l.min.x,l.min.y,l.max.x-l.min.x,l.max.y-l.min.y)},Lc=function(e,t,n,i,r,o,s,a,l){var c=1-l,u=Math.pow(c,3),h=Math.pow(c,2),d=l*l,f=d*l,g=e+2*l*(n-e)+d*(r-2*n+e),p=t+2*l*(i-t)+d*(o-2*i+t),m=n+2*l*(r-n)+d*(s-2*r+n),v=i+2*l*(o-i)+d*(a-2*o+i);return{x:u*e+3*h*l*n+3*c*l*l*r+f*s,y:u*t+3*h*l*i+3*c*l*l*o+f*a,m:{x:g,y:p},n:{x:m,y:v},start:{x:c*e+l*n,y:c*t+l*i},end:{x:c*r+l*s,y:c*o+l*a},alpha:90-180*Math.atan2(g-m,p-v)/Math.PI}},Dc=function(e,t,n){if(!function(e,t){return e=Ec(e),t=Ec(t),Sc(t,e.x,e.y)||Sc(t,e.x2,e.y)||Sc(t,e.x,e.y2)||Sc(t,e.x2,e.y2)||Sc(e,t.x,t.y)||Sc(e,t.x2,t.y)||Sc(e,t.x,t.y2)||Sc(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}(kc(e),kc(t)))return n?0:[];for(var i=~~(bc.apply(0,e)/8),r=~~(bc.apply(0,t)/8),o=[],s=[],a={},l=n?0:[],c=0;c<i+1;c++){var u=Lc.apply(0,e.concat(c/i));o.push({x:u.x,y:u.y,t:c/i})}for(c=0;c<r+1;c++){u=Lc.apply(0,t.concat(c/r));s.push({x:u.x,y:u.y,t:c/r})}for(c=0;c<i;c++)for(var h=0;h<r;h++){var d=o[c],f=o[c+1],g=s[h],p=s[h+1],m=Math.abs(f.x-d.x)<.001?"y":"x",v=Math.abs(p.x-g.x)<.001?"y":"x",y=Cc(d.x,d.y,f.x,f.y,g.x,g.y,p.x,p.y);if(y){if(a[y.x.toFixed(4)]===y.y.toFixed(4))continue;a[y.x.toFixed(4)]=y.y.toFixed(4);var _=d.t+Math.abs((y[m]-d[m])/(f[m]-d[m]))*(f.t-d.t),b=g.t+Math.abs((y[v]-g[v])/(p[v]-g[v]))*(p.t-g.t);_>=0&&_<=1&&b>=0&&b<=1&&(n?l+=1:l.push({x:y.x,y:y.y,t1:_,t2:b}))}}return l};function Nc(e,t){var n=[],i=[];return e.length&&function e(t,r){if(1===t.length)n.push(t[0]),i.push(t[0]);else{for(var o=[],s=0;s<t.length-1;s++)0===s&&n.push(t[0]),s===t.length-2&&i.push(t[s+1]),o[s]=[(1-r)*t[s][0]+r*t[s+1][0],(1-r)*t[s][1]+r*t[s+1][1]];e(o,r)}}(e,t),{left:n,right:i.reverse()}}var Ic=function(e,t,n){if(1===n)return[[].concat(e)];var i=[];if("L"===t[0]||"C"===t[0]||"Q"===t[0])i=i.concat(function(e,t,n){var i=[[e[1],e[2]]];n=n||2;var r=[];"A"===t[0]?(i.push(t[6]),i.push(t[7])):"C"===t[0]?(i.push([t[1],t[2]]),i.push([t[3],t[4]]),i.push([t[5],t[6]])):"S"===t[0]||"Q"===t[0]?(i.push([t[1],t[2]]),i.push([t[3],t[4]])):i.push([t[1],t[2]]);for(var o=i,s=1/n,a=0;a<n-1;a++){var l=Nc(o,s/(1-s*a));r.push(l.left),o=l.right}return r.push(o),r.map((function(e){var t=[];return 4===e.length&&(t.push("C"),t=t.concat(e[2])),e.length>=3&&(3===e.length&&t.push("Q"),t=t.concat(e[1])),2===e.length&&t.push("L"),t.concat(e[e.length-1])}))}(e,t,n));else{var r=[].concat(e);"M"===r[0]&&(r[0]="L");for(var o=0;o<=n-1;o++)i.push(r)}return i},Tc=function(e,t){if(e.length!==t.length)return!1;var n=!0;return cr(e,(function(e,i){if(e!==t[i])return n=!1,!1})),n};function Mc(e,t,n){var i=null,r=n;return t<r&&(r=t,i="add"),e<r&&(r=e,i="del"),{type:i,min:r}}var Ac=function(e,t){var n=function(e,t){var n,i,r=e.length,o=t.length,s=0;if(0===r||0===o)return null;for(var a=[],l=0;l<=r;l++)a[l]=[],a[l][0]={min:l};for(var c=0;c<=o;c++)a[0][c]={min:c};for(l=1;l<=r;l++)for(n=e[l-1],c=1;c<=o;c++){i=t[c-1],s=Tc(n,i)?0:1;var u=a[l-1][c].min+1,h=a[l][c-1].min+1,d=a[l-1][c-1].min+s;a[l][c]=Mc(u,h,d)}return a}(e,t),i=e.length,r=t.length,o=[],s=1,a=1;if(n[i][r].min!==i){for(var l=1;l<=i;l++){var c=n[l][l].min;a=l;for(var u=s;u<=r;u++)n[l][u].min<c&&(c=n[l][u].min,a=u);s=a,n[l][s].type&&o.push({index:l-1,type:n[l][s].type})}for(l=o.length-1;l>=0;l--)s=o[l].index,"add"===o[l].type?e.splice(s,0,[].concat(e[s])):e.splice(s,1)}var h=r-(i=e.length);if(i<r)for(l=0;l<h;l++)"z"===e[i-1][0]||"Z"===e[i-1][0]?e.splice(i-2,0,e[i-2]):e.push(e[i-1]),i+=1;return e};function Oc(e,t,n){for(var i,r=[].concat(e),o=1/(n+1),s=Rc(t)[0],a=1;a<=n;a++)o*=a,0===(i=Math.floor(e.length*o))?r.unshift([s[0]*o+e[i][0]*(1-o),s[1]*o+e[i][1]*(1-o)]):r.splice(i,0,[s[0]*o+e[i][0]*(1-o),s[1]*o+e[i][1]*(1-o)]);return r}function Rc(e){var t=[];switch(e[0]){case"M":case"L":t.push([e[1],e[2]]);break;case"A":t.push([e[6],e[7]]);break;case"Q":t.push([e[3],e[4]]),t.push([e[1],e[2]]);break;case"T":t.push([e[1],e[2]]);break;case"C":t.push([e[5],e[6]]),t.push([e[1],e[2]]),t.push([e[3],e[4]]);break;case"S":t.push([e[3],e[4]]),t.push([e[1],e[2]]);break;case"H":case"V":t.push([e[1],e[1]])}return t}var Pc=function(e,t){if(e.length<=1)return e;for(var n,i=0;i<t.length;i++)if(e[i][0]!==t[i][0])switch(n=Rc(e[i]),t[i][0]){case"M":e[i]=["M"].concat(n[0]);break;case"L":e[i]=["L"].concat(n[0]);break;case"A":e[i]=[].concat(t[i]),e[i][6]=n[0][0],e[i][7]=n[0][1];break;case"Q":if(n.length<2){if(!(i>0)){e[i]=t[i];break}n=Oc(n,e[i-1],1)}e[i]=["Q"].concat(n.reduce((function(e,t){return e.concat(t)}),[]));break;case"T":e[i]=["T"].concat(n[0]);break;case"C":if(n.length<3){if(!(i>0)){e[i]=t[i];break}n=Oc(n,e[i-1],2)}e[i]=["C"].concat(n.reduce((function(e,t){return e.concat(t)}),[]));break;case"S":if(n.length<2){if(!(i>0)){e[i]=t[i];break}n=Oc(n,e[i-1],1)}e[i]=["S"].concat(n.reduce((function(e,t){return e.concat(t)}),[]));break;default:e[i]=t[i]}return e},Fc=Object.freeze(Object.defineProperty({__proto__:null,catmullRomToBezier:uc,fillPath:function(e,t){if(1===e.length)return e;var n=e.length-1,i=t.length-1,r=n/i,o=[];if(1===e.length&&"M"===e[0][0]){for(var s=0;s<i-n;s++)e.push(e[0]);return e}for(s=0;s<i;s++){var a=Math.floor(r*s);o[a]=(o[a]||0)+1}var l=o.reduce((function(t,i,r){return r===n?t.concat(e[n]):t.concat(Ic(e[r],e[r+1],i))}),[]);return l.unshift(e[0]),"Z"!==t[i]&&"z"!==t[i]||l.push("Z"),l},fillPathByDiff:Ac,formatPath:Pc,intersection:function(e,t){return function(e,t,n){var i,r,o,s,a,l,c,u,h,d;e=mc(e),t=mc(t);for(var f=n?0:[],g=0,p=e.length;g<p;g++){var m=e[g];if("M"===m[0])i=a=m[1],r=l=m[2];else{"C"===m[0]?(h=[i,r].concat(m.slice(1)),i=h[6],r=h[7]):(h=[i,r,i,r,a,l,a,l],i=a,r=l);for(var v=0,y=t.length;v<y;v++){var _=t[v];if("M"===_[0])o=c=_[1],s=u=_[2];else{"C"===_[0]?(d=[o,s].concat(_.slice(1)),o=d[6],s=d[7]):(d=[o,s,o,s,c,u,c,u],o=c,s=u);var b=Dc(h,d,n);if(n)f+=b;else{for(var w=0,C=b.length;w<C;w++)b[w].segment1=g,b[w].segment2=v,b[w].bez1=h,b[w].bez2=d;f=f.concat(b)}}}}}return f}(e,t)},parsePathArray:yc,parsePathString:cc,pathToAbsolute:dc,pathToCurve:mc,rectPath:xc},Symbol.toStringTag,{value:"Module"})),Bc=function(){function e(e,t){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=e,this.name=e,this.originalEvent=t,this.timeStamp=t.timeStamp}return e.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.toString=function(){return"[Event (type="+this.type+")]"},e.prototype.save=function(){},e.prototype.restore=function(){},e}();function Wc(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}var zc="undefined"!=typeof window&&void 0!==window.document;function Vc(e,t){if(e.isCanvas())return!0;for(var n=t.getParent(),i=!1;n;){if(n===e){i=!0;break}n=n.getParent()}return i}function Uc(e){return e.cfg.visible&&e.cfg.capture}var Hc=function(e){function t(t){var n=e.call(this)||this;n.destroyed=!1;var i=n.getDefaultCfg();return n.cfg=to(i,t),n}return qi(t,e),t.prototype.getDefaultCfg=function(){return{}},t.prototype.get=function(e){return this.cfg[e]},t.prototype.set=function(e,t){this.cfg[e]=t},t.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},t}(Do),jc=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Gc=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},Kc=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},qc=function(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"},$c=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},Yc=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},Xc=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Zc=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],Qc=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Jc(e){return e?eu(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new Yc:"undefined"!=typeof navigator?eu(navigator.userAgent):"undefined"!=typeof process&&process.version?new Kc(process.version.slice(1)):null}function eu(e){var t=function(e){return""!==e&&Zc.reduce((function(t,n){var i=n[0],r=n[1];if(t)return t;var o=r.exec(e);return!!o&&[i,o]}),!1)}(e);if(!t)return null;var n=t[0],i=t[1];if("searchbot"===n)return new $c;var r=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);r?r.length<3&&(r=jc(jc([],r,!0),function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(3-r.length),!0)):r=[];var o=r.join("."),s=function(e){for(var t=0,n=Qc.length;t<n;t++){var i=Qc[t],r=i[0];if(i[1].exec(e))return r}return null}(e),a=Xc.exec(e);return a&&a[1]?new qc(n,o,s,a[1]):new Gc(n,o,s)}function tu(e,t){var n=[],i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=t[0],f=t[1],g=t[2],p=t[3],m=t[4],v=t[5],y=t[6],_=t[7],b=t[8];return n[0]=d*i+f*s+g*c,n[1]=d*r+f*a+g*u,n[2]=d*o+f*l+g*h,n[3]=p*i+m*s+v*c,n[4]=p*r+m*a+v*u,n[5]=p*o+m*l+v*h,n[6]=y*i+_*s+b*c,n[7]=y*r+_*a+b*u,n[8]=y*o+_*l+b*h,n}function nu(e,t){var n=[],i=t[0],r=t[1];return n[0]=e[0]*i+e[3]*r+e[6],n[1]=e[1]*i+e[4]*r+e[7],n}function iu(e){var t=[],n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*s-a*c,d=-u*o+a*l,f=c*o-s*l,g=n*h+i*d+r*f;return g?(g=1/g,t[0]=h*g,t[1]=(-u*i+r*c)*g,t[2]=(a*i-r*s)*g,t[3]=d*g,t[4]=(u*n-r*l)*g,t[5]=(-a*n+r*o)*g,t[6]=f*g,t[7]=(-c*n+i*l)*g,t[8]=(s*n-i*o)*g,t):null}var ru=Us,ou=["zIndex","capture","visible","type"],su=["repeat"];function au(e,t){var n={},i=t.attrs;for(var r in e)n[r]=i[r];return n}function lu(e,t){var n={},i=t.attr();return cr(e,(function(e,t){-1!==su.indexOf(t)||ho(i[t],e)||(n[t]=e)})),n}function cu(e,t){if(t.onFrame)return e;var n=t.startTime,i=t.delay,r=t.duration,o=Object.prototype.hasOwnProperty;return cr(e,(function(e){n+i<e.startTime+e.delay+e.duration&&r>e.delay&&cr(t.toAttrs,(function(t,n){o.call(e.toAttrs,n)&&(delete e.toAttrs[n],delete e.fromAttrs[n])}))})),e}var uu=function(e){function t(t){var n=e.call(this,t)||this;n.attrs={};var i=n.getDefaultAttrs();return to(i,t.attrs),n.attrs=i,n.initAttrs(i),n.initAnimate(),n}return qi(t,e),t.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},t.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},t.prototype.onCanvasChange=function(e){},t.prototype.initAttrs=function(e){},t.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},t.prototype.isGroup=function(){return!1},t.prototype.getParent=function(){return this.get("parent")},t.prototype.getCanvas=function(){return this.get("canvas")},t.prototype.attr=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t[0],r=t[1];if(!i)return this.attrs;if(lr(i)){for(var o in i)this.setAttr(o,i[o]);return this.afterAttrsChange(i),this}return 2===t.length?(this.setAttr(i,r),this.afterAttrsChange(((e={})[i]=r,e)),this):this.attrs[i]},t.prototype.isClipped=function(e,t){var n=this.getClip();return n&&!n.isHit(e,t)},t.prototype.setAttr=function(e,t){var n=this.attrs[e];n!==t&&(this.attrs[e]=t,this.onAttrChange(e,t,n))},t.prototype.onAttrChange=function(e,t,n){"matrix"===e&&this.set("totalMatrix",null)},t.prototype.afterAttrsChange=function(e){if(this.cfg.isClipShape){var t=this.cfg.applyTo;t&&t.onCanvasChange("clip")}else this.onCanvasChange("attr")},t.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},t.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},t.prototype.setZIndex=function(e){this.set("zIndex",e);var t=this.getParent();return t&&t.sort(),this},t.prototype.toFront=function(){var e=this.getParent();if(e){var t=e.getChildren();this.get("el");var n=t.indexOf(this);t.splice(n,1),t.push(this),this.onCanvasChange("zIndex")}},t.prototype.toBack=function(){var e=this.getParent();if(e){var t=e.getChildren();this.get("el");var n=t.indexOf(this);t.splice(n,1),t.unshift(this),this.onCanvasChange("zIndex")}},t.prototype.remove=function(e){void 0===e&&(e=!0);var t=this.getParent();t?(Wc(t.getChildren(),this),t.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),e&&this.destroy()},t.prototype.resetMatrix=function(){this.attr("matrix",this.getDefaultMatrix()),this.onCanvasChange("matrix")},t.prototype.getMatrix=function(){return this.attr("matrix")},t.prototype.setMatrix=function(e){this.attr("matrix",e),this.onCanvasChange("matrix")},t.prototype.getTotalMatrix=function(){var e=this.cfg.totalMatrix;if(!e){var t=this.attr("matrix"),n=this.cfg.parentMatrix;e=n&&t?tu(n,t):t||n,this.set("totalMatrix",e)}return e},t.prototype.applyMatrix=function(e){var t=this.attr("matrix"),n=null;n=e&&t?tu(e,t):t||e,this.set("totalMatrix",n),this.set("parentMatrix",e)},t.prototype.getDefaultMatrix=function(){return null},t.prototype.applyToMatrix=function(e){var t=this.attr("matrix");return t?nu(t,e):e},t.prototype.invertFromMatrix=function(e){var t=this.attr("matrix");if(t){var n=iu(t);if(n)return nu(n,e)}return e},t.prototype.setClip=function(e){var t=this.getCanvas(),n=null;if(e){var i=this.getShapeBase()[Gr(e.type)];i&&(n=new i({type:e.type,isClipShape:!0,applyTo:this,attrs:e.attrs,canvas:t}))}return this.set("clipShape",n),this.onCanvasChange("clip"),n},t.prototype.getClip=function(){var e=this.cfg.clipShape;return e||null},t.prototype.clone=function(){var e=this,t=this.attrs,n={};cr(t,(function(e,i){ar(t[i])?n[i]=function(e){for(var t=[],n=0;n<e.length;n++)ar(e[n])?t.push([].concat(e[n])):t.push(e[n]);return t}(t[i]):n[i]=t[i]}));var i=new(0,this.constructor)({attrs:n});return cr(ou,(function(t){i.set(t,e.get(t))})),i},t.prototype.destroy=function(){this.destroyed||(this.attrs={},e.prototype.destroy.call(this))},t.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},t.prototype.animate=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.get("timeline")||this.get("canvas")){this.set("animating",!0);var n=this.get("timeline");n||(n=this.get("canvas").get("timeline"),this.set("timeline",n));var i=this.get("animations")||[];n.timer||n.initTimer();var r,o,s,a,l,c=e[0],u=e[1],h=e[2],d=void 0===h?"easeLinear":h,f=e[3],g=void 0===f?wo:f,p=e[4],m=void 0===p?0:p;or(c)?(r=c,c={}):lr(c)&&c.onFrame&&(r=c.onFrame,o=c.repeat),lr(u)?(u=(l=u).duration,d=l.easing||"easeLinear",m=l.delay||0,o=l.repeat||o||!1,g=l.callback||wo,s=l.pauseCallback||wo,a=l.resumeCallback||wo):(Or(g)&&(m=g,g=null),or(d)?(g=d,d="easeLinear"):d=d||"easeLinear");var v=lu(c,this),y={fromAttrs:au(v,this),toAttrs:v,duration:u,easing:d,repeat:o,callback:g,pauseCallback:s,resumeCallback:a,delay:m,startTime:n.getTime(),id:bo(),onFrame:r,pathFormatted:!1};i.length>0?i=cu(i,y):n.addAnimator(this),i.push(y),this.set("animations",i),this.set("_pause",{isPaused:!1})}},t.prototype.stopAnimate=function(e){var t=this;void 0===e&&(e=!0),cr(this.get("animations"),(function(n){e&&(n.onFrame?t.attr(n.onFrame(1)):t.attr(n.toAttrs)),n.callback&&n.callback()})),this.set("animating",!1),this.set("animations",[])},t.prototype.pauseAnimate=function(){var e=this.get("timeline"),t=this.get("animations"),n=e.getTime();return cr(t,(function(e){e._paused=!0,e._pauseTime=n,e.pauseCallback&&e.pauseCallback()})),this.set("_pause",{isPaused:!0,pauseTime:n}),this},t.prototype.resumeAnimate=function(){var e=this.get("timeline").getTime(),t=this.get("animations"),n=this.get("_pause").pauseTime;return cr(t,(function(t){t.startTime=t.startTime+(e-n),t._paused=!1,t._pauseTime=null,t.resumeCallback&&t.resumeCallback()})),this.set("_pause",{isPaused:!1}),this.set("animations",t),this},t.prototype.emitDelegation=function(e,t){var n,i=this,r=t.propagationPath;this.getEvents(),"mouseenter"===e?n=t.fromShape:"mouseleave"===e&&(n=t.toShape);for(var o=function(e){var o=r[e],a=o.get("name");if(a){if((o.isGroup()||o.isCanvas&&o.isCanvas())&&n&&Vc(o,n))return"break";ar(a)?cr(a,(function(e){i.emitDelegateEvent(o,e,t)})):s.emitDelegateEvent(o,a,t)}},s=this,a=0;a<r.length;a++){if("break"===o(a))break}},t.prototype.emitDelegateEvent=function(e,t,n){var i=this.getEvents(),r=t+":"+n.type;(i[r]||i["*"])&&(n.name=r,n.currentTarget=e,n.delegateTarget=this,n.delegateObject=e.get("delegateObject"),this.emit(r,n))},t.prototype.translate=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var n=this.getMatrix(),i=ru(n,[["t",e,t]]);return this.setMatrix(i),this},t.prototype.move=function(e,t){var n=this.attr("x")||0,i=this.attr("y")||0;return this.translate(e-n,t-i),this},t.prototype.moveTo=function(e,t){return this.move(e,t)},t.prototype.scale=function(e,t){var n=this.getMatrix(),i=ru(n,[["s",e,t||e]]);return this.setMatrix(i),this},t.prototype.rotate=function(e){var t=this.getMatrix(),n=ru(t,[["r",e]]);return this.setMatrix(n),this},t.prototype.rotateAtStart=function(e){var t=this.attr(),n=t.x,i=t.y,r=this.getMatrix(),o=ru(r,[["t",-n,-i],["r",e],["t",n,i]]);return this.setMatrix(o),this},t.prototype.rotateAtPoint=function(e,t,n){var i=this.getMatrix(),r=ru(i,[["t",-e,-t],["r",n],["t",e,t]]);return this.setMatrix(r),this},t}(Hc),hu={};function du(e,t){if(e.set("canvas",t),e.isGroup()){var n=e.get("children");n.length&&n.forEach((function(e){du(e,t)}))}}function fu(e,t){if(e.set("timeline",t),e.isGroup()){var n=e.get("children");n.length&&n.forEach((function(e){fu(e,t)}))}}var gu,pu,mu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.isCanvas=function(){return!1},t.prototype.getBBox=function(){var e=1/0,t=-1/0,n=1/0,i=-1/0,r=[],o=[],s=this.getChildren().filter((function(e){return e.get("visible")&&(!e.isGroup()||e.isGroup()&&e.getChildren().length>0)}));return s.length>0?(cr(s,(function(e){var t=e.getBBox();r.push(t.minX,t.maxX),o.push(t.minY,t.maxY)})),e=mr(r),t=pr(r),n=mr(o),i=pr(o)):(e=0,t=0,n=0,i=0),{x:e,y:n,minX:e,minY:n,maxX:t,maxY:i,width:t-e,height:i-n}},t.prototype.getCanvasBBox=function(){var e=1/0,t=-1/0,n=1/0,i=-1/0,r=[],o=[],s=this.getChildren().filter((function(e){return e.get("visible")&&(!e.isGroup()||e.isGroup()&&e.getChildren().length>0)}));return s.length>0?(cr(s,(function(e){var t=e.getCanvasBBox();r.push(t.minX,t.maxX),o.push(t.minY,t.maxY)})),e=mr(r),t=pr(r),n=mr(o),i=pr(o)):(e=0,t=0,n=0,i=0),{x:e,y:n,minX:e,minY:n,maxX:t,maxY:i,width:t-e,height:i-n}},t.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.children=[],t},t.prototype.onAttrChange=function(t,n,i){if(e.prototype.onAttrChange.call(this,t,n,i),"matrix"===t){var r=this.getTotalMatrix();this._applyChildrenMarix(r)}},t.prototype.applyMatrix=function(t){var n=this.getTotalMatrix();e.prototype.applyMatrix.call(this,t);var i=this.getTotalMatrix();i!==n&&this._applyChildrenMarix(i)},t.prototype._applyChildrenMarix=function(e){cr(this.getChildren(),(function(t){t.applyMatrix(e)}))},t.prototype.addShape=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],i=e[1];lr(n)?i=n:i.type=n;var r=hu[i.type];r||(r=Gr(i.type),hu[i.type]=r);var o=this.getShapeBase(),s=new o[r](i);return this.add(s),s},t.prototype.addGroup=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,i=e[0],r=e[1];if(or(i))n=new i(r||{parent:this});else{var o=i||{},s=this.getGroupBase();n=new s(o)}return this.add(n),n},t.prototype.getCanvas=function(){return this.isCanvas()?this:this.get("canvas")},t.prototype.getShape=function(e,t,n){if(!Uc(this))return null;var i,r=this.getChildren();if(this.isCanvas())i=this._findShape(r,e,t,n);else{var o=[e,t,1];o=this.invertFromMatrix(o),this.isClipped(o[0],o[1])||(i=this._findShape(r,o[0],o[1],n))}return i},t.prototype._findShape=function(e,t,n,i){for(var r=null,o=e.length-1;o>=0;o--){var s=e[o];if(Uc(s)&&(s.isGroup()?r=s.getShape(t,n,i):s.isHit(t,n)&&(r=s)),r)break}return r},t.prototype.add=function(e){var t=this.getCanvas(),n=this.getChildren(),i=this.get("timeline"),r=e.getParent();r&&function(e,t,n){void 0===n&&(n=!0),n?t.destroy():(t.set("parent",null),t.set("canvas",null)),Wc(e.getChildren(),t)}(r,e,!1),e.set("parent",this),t&&du(e,t),i&&fu(e,i),n.push(e),e.onCanvasChange("add"),this._applyElementMatrix(e)},t.prototype._applyElementMatrix=function(e){var t=this.getTotalMatrix();t&&e.applyMatrix(t)},t.prototype.getChildren=function(){return this.get("children")},t.prototype.sort=function(){var e,t=this.getChildren();cr(t,(function(e,t){return e._INDEX=t,e})),t.sort((e=function(e,t){return e.get("zIndex")-t.get("zIndex")},function(t,n){var i=e(t,n);return 0===i?t._INDEX-n._INDEX:i})),this.onCanvasChange("sort")},t.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var e=this.getChildren(),t=e.length-1;t>=0;t--)e[t].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},t.prototype.destroy=function(){this.get("destroyed")||(this.clear(),e.prototype.destroy.call(this))},t.prototype.getFirst=function(){return this.getChildByIndex(0)},t.prototype.getLast=function(){var e=this.getChildren();return this.getChildByIndex(e.length-1)},t.prototype.getChildByIndex=function(e){return this.getChildren()[e]},t.prototype.getCount=function(){return this.getChildren().length},t.prototype.contain=function(e){return this.getChildren().indexOf(e)>-1},t.prototype.removeChild=function(e,t){void 0===t&&(t=!0),this.contain(e)&&e.remove(t)},t.prototype.findAll=function(e){var t=[];return cr(this.getChildren(),(function(n){e(n)&&t.push(n),n.isGroup()&&(t=t.concat(n.findAll(e)))})),t},t.prototype.find=function(e){var t=null;return cr(this.getChildren(),(function(n){if(e(n)?t=n:n.isGroup()&&(t=n.find(e)),t)return!1})),t},t.prototype.findById=function(e){return this.find((function(t){return t.get("id")===e}))},t.prototype.findByClassName=function(e){return this.find((function(t){return t.get("className")===e}))},t.prototype.findAllByName=function(e){return this.findAll((function(t){return t.get("name")===e}))},t}(uu),vu=0,yu=0,_u=0,bu=0,wu=0,Cu=0,Su="object"==typeof performance&&performance.now?performance:Date,xu="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Eu(){return wu||(xu(ku),wu=Su.now()+Cu)}function ku(){wu=0}function Lu(){this._call=this._time=this._next=null}function Du(e,t,n){var i=new Lu;return i.restart(e,t,n),i}function Nu(){wu=(bu=Su.now())+Cu,vu=yu=0;try{!function(){Eu(),++vu;for(var e,t=gu;t;)(e=wu-t._time)>=0&&t._call.call(null,e),t=t._next;--vu}()}finally{vu=0,function(){var e,t,n=gu,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:gu=t);pu=e,Tu(i)}(),wu=0}}function Iu(){var e=Su.now(),t=e-bu;t>1e3&&(Cu-=t,bu=e)}function Tu(e){vu||(yu&&(yu=clearTimeout(yu)),e-wu>24?(e<1/0&&(yu=setTimeout(Nu,e-Su.now()-Cu)),_u&&(_u=clearInterval(_u))):(_u||(bu=Su.now(),_u=setInterval(Iu,1e3)),vu=1,xu(Nu)))}function Mu(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Au(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Ou(){}Lu.prototype=Du.prototype={constructor:Lu,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?Eu():+n)+(null==t?0:+t),this._next||pu===this||(pu?pu._next=this:gu=this,pu=this),this._call=e,this._time=n,Tu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Tu())}};var Ru=1/.7,Pu="\\s*([+-]?\\d+)\\s*",Fu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wu=/^#([0-9a-f]{3,8})$/,zu=new RegExp("^rgb\\("+[Pu,Pu,Pu]+"\\)$"),Vu=new RegExp("^rgb\\("+[Bu,Bu,Bu]+"\\)$"),Uu=new RegExp("^rgba\\("+[Pu,Pu,Pu,Fu]+"\\)$"),Hu=new RegExp("^rgba\\("+[Bu,Bu,Bu,Fu]+"\\)$"),ju=new RegExp("^hsl\\("+[Fu,Bu,Bu]+"\\)$"),Gu=new RegExp("^hsla\\("+[Fu,Bu,Bu,Fu]+"\\)$"),Ku={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function qu(){return this.rgb().formatHex()}function $u(){return this.rgb().formatRgb()}function Yu(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Wu.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Xu(t):3===n?new eh(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Zu(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Zu(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=zu.exec(e))?new eh(t[1],t[2],t[3],1):(t=Vu.exec(e))?new eh(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Uu.exec(e))?Zu(t[1],t[2],t[3],t[4]):(t=Hu.exec(e))?Zu(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ju.exec(e))?rh(t[1],t[2]/100,t[3]/100,1):(t=Gu.exec(e))?rh(t[1],t[2]/100,t[3]/100,t[4]):Ku.hasOwnProperty(e)?Xu(Ku[e]):"transparent"===e?new eh(NaN,NaN,NaN,0):null}function Xu(e){return new eh(e>>16&255,e>>8&255,255&e,1)}function Zu(e,t,n,i){return i<=0&&(e=t=n=NaN),new eh(e,t,n,i)}function Qu(e){return e instanceof Ou||(e=Yu(e)),e?new eh((e=e.rgb()).r,e.g,e.b,e.opacity):new eh}function Ju(e,t,n,i){return 1===arguments.length?Qu(e):new eh(e,t,n,null==i?1:i)}function eh(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function th(){return"#"+ih(this.r)+ih(this.g)+ih(this.b)}function nh(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function ih(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function rh(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new sh(e,t,n,i)}function oh(e){if(e instanceof sh)return new sh(e.h,e.s,e.l,e.opacity);if(e instanceof Ou||(e=Yu(e)),!e)return new sh;if(e instanceof sh)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,a=o-r,l=(o+r)/2;return a?(s=t===o?(n-i)/a+6*(n<i):n===o?(i-t)/a+2:(t-n)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new sh(s,a,l,e.opacity)}function sh(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function ah(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function lh(e){return function(){return e}}function ch(e){return 1==(e=+e)?uh:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):lh(isNaN(t)?n:t)}}function uh(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):lh(isNaN(e)?t:e)}Mu(Ou,Yu,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:qu,formatHex:qu,formatHsl:function(){return oh(this).formatHsl()},formatRgb:$u,toString:$u}),Mu(eh,Ju,Au(Ou,{brighter:function(e){return e=null==e?Ru:Math.pow(Ru,e),new eh(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new eh(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:th,formatHex:th,formatRgb:nh,toString:nh})),Mu(sh,(function(e,t,n,i){return 1===arguments.length?oh(e):new sh(e,t,n,null==i?1:i)}),Au(Ou,{brighter:function(e){return e=null==e?Ru:Math.pow(Ru,e),new sh(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new sh(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new eh(ah(e>=240?e-240:e+120,r,i),ah(e,r,i),ah(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var hh=function e(t){var n=ch(t);function i(e,t){var i=n((e=Ju(e)).r,(t=Ju(t)).r),r=n(e.g,t.g),o=n(e.b,t.b),s=uh(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function dh(e,t){t||(t=[]);var n,i=e?Math.min(t.length,e.length):0,r=t.slice();return function(o){for(n=0;n<i;++n)r[n]=e[n]*(1-o)+t[n]*o;return r}}function fh(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function gh(e,t){var n,i=t?t.length:0,r=e?Math.min(i,e.length):0,o=new Array(r),s=new Array(i);for(n=0;n<r;++n)o[n]=wh(e[n],t[n]);for(;n<i;++n)s[n]=t[n];return function(e){for(n=0;n<r;++n)s[n]=o[n](e);return s}}function ph(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function mh(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function vh(e,t){var n,i={},r={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?i[n]=wh(e[n],t[n]):r[n]=t[n];return function(e){for(n in i)r[n]=i[n](e);return r}}var yh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_h=new RegExp(yh.source,"g");function bh(e,t){var n,i,r,o=yh.lastIndex=_h.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=yh.exec(e))&&(i=_h.exec(t));)(r=i.index)>o&&(r=t.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:mh(n,i)})),o=_h.lastIndex;return o<t.length&&(r=t.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,i=0;i<t;++i)a[(n=l[i]).i]=n.x(e);return a.join("")})}function wh(e,t){var n,i=typeof t;return null==t||"boolean"===i?lh(t):("number"===i?mh:"string"===i?(n=Yu(t))?(t=n,hh):bh:t instanceof Yu?hh:t instanceof Date?ph:fh(t)?dh:Array.isArray(t)?gh:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?vh:mh)(e,t)}function Ch(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function Sh(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var xh=function e(t){function n(e){return Math.pow(e,t)}return t=+t,n.exponent=e,n}(3),Eh=function e(t){function n(e){return 1-Math.pow(1-e,t)}return t=+t,n.exponent=e,n}(3),kh=function e(t){function n(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,n.exponent=e,n}(3),Lh=Math.PI,Dh=Lh/2;function Nh(e){return(1-Math.cos(Lh*e))/2}function Ih(e){return 1.0009775171065494*(Math.pow(2,-10*e)-.0009765625)}function Th(e){return((e*=2)<=1?Ih(1-e):2-Ih(e-1))/2}function Mh(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var Ah=4/11,Oh=7.5625;function Rh(e){return(e=+e)<Ah?Oh*e*e:e<.7272727272727273?Oh*(e-=.5454545454545454)*e+.75:e<.9090909090909091?Oh*(e-=.8181818181818182)*e+.9375:Oh*(e-=.9545454545454546)*e+.984375}var Ph=function e(t){function n(e){return(e=+e)*e*(t*(e-1)+e)}return t=+t,n.overshoot=e,n}(1.70158),Fh=function e(t){function n(e){return--e*e*((e+1)*t+e)+1}return t=+t,n.overshoot=e,n}(1.70158),Bh=function e(t){function n(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,n.overshoot=e,n}(1.70158),Wh=2*Math.PI,zh=function e(t,n){var i=Math.asin(1/(t=Math.max(1,t)))*(n/=Wh);function r(e){return t*Ih(- --e)*Math.sin((i-e)/n)}return r.amplitude=function(t){return e(t,n*Wh)},r.period=function(n){return e(t,n)},r}(1,.3),Vh=function e(t,n){var i=Math.asin(1/(t=Math.max(1,t)))*(n/=Wh);function r(e){return 1-t*Ih(e=+e)*Math.sin((e+i)/n)}return r.amplitude=function(t){return e(t,n*Wh)},r.period=function(n){return e(t,n)},r}(1,.3),Uh=function e(t,n){var i=Math.asin(1/(t=Math.max(1,t)))*(n/=Wh);function r(e){return((e=2*e-1)<0?t*Ih(-e)*Math.sin((i-e)/n):2-t*Ih(e)*Math.sin((i+e)/n))/2}return r.amplitude=function(t){return e(t,n*Wh)},r.period=function(n){return e(t,n)},r}(1,.3),Hh=Object.freeze(Object.defineProperty({__proto__:null,easeLinear:function(e){return+e},easeQuad:Ch,easeQuadIn:function(e){return e*e},easeQuadOut:function(e){return e*(2-e)},easeQuadInOut:Ch,easeCubic:Sh,easeCubicIn:function(e){return e*e*e},easeCubicOut:function(e){return--e*e*e+1},easeCubicInOut:Sh,easePoly:kh,easePolyIn:xh,easePolyOut:Eh,easePolyInOut:kh,easeSin:Nh,easeSinIn:function(e){return 1==+e?1:1-Math.cos(e*Dh)},easeSinOut:function(e){return Math.sin(e*Dh)},easeSinInOut:Nh,easeExp:Th,easeExpIn:function(e){return Ih(1-+e)},easeExpOut:function(e){return 1-Ih(e)},easeExpInOut:Th,easeCircle:Mh,easeCircleIn:function(e){return 1-Math.sqrt(1-e*e)},easeCircleOut:function(e){return Math.sqrt(1- --e*e)},easeCircleInOut:Mh,easeBounce:Rh,easeBounceIn:function(e){return 1-Rh(1-e)},easeBounceOut:Rh,easeBounceInOut:function(e){return((e*=2)<=1?1-Rh(1-e):Rh(e-1)+1)/2},easeBack:Bh,easeBackIn:Ph,easeBackOut:Fh,easeBackInOut:Bh,easeElastic:Vh,easeElasticIn:zh,easeElasticOut:Vh,easeElasticInOut:Uh},Symbol.toStringTag,{value:"Module"})),jh={};var Gh=[1,0,0,0,1,0,0,0,1];function Kh(e,t,n){var i,r=t.startTime;if(n<r+t.delay||t._paused)return!1;var o,s=t.duration,a=t.easing,l=jh[(o=a).toLowerCase()]||Hh[o];if(n=n-r-t.delay,t.repeat)i=l(i=n%s/s);else{if(!((i=n/s)<1))return t.onFrame?e.attr(t.onFrame(1)):e.attr(t.toAttrs),!0;i=l(i)}if(t.onFrame){var c=t.onFrame(i);e.attr(c)}else!function(e,t,n){var i={},r=t.fromAttrs,o=t.toAttrs;if(!e.destroyed){var s,a,l,c;for(var u in o)if(!ho(r[u],o[u]))if("path"===u){var h=o[u],d=r[u];h.length>d.length?(h=cc(o[u]),d=cc(r[u]),d=Ac(d,h),d=Pc(d,h),t.fromAttrs.path=d,t.toAttrs.path=h):t.pathFormatted||(h=cc(o[u]),d=cc(r[u]),d=Pc(d,h),t.fromAttrs.path=d,t.toAttrs.path=h,t.pathFormatted=!0),i[u]=[];for(var f=0;f<h.length;f++){for(var g=h[f],p=d[f],m=[],v=0;v<g.length;v++)Or(g[v])&&p&&Or(p[v])?(s=wh(p[v],g[v]),m.push(s(n))):m.push(g[v]);i[u].push(m)}}else if("matrix"===u){var y=(l=r[u]||Gh,(fh(c=o[u]||Gh)?dh:gh)(l,c))(n);i[u]=y}else["fill","stroke","fillStyle","strokeStyle"].includes(u)&&(a=o[u],/^[r,R,L,l]{1}[\s]*\(/.test(a))?i[u]=o[u]:or(o[u])||(s=wh(r[u],o[u]),i[u]=s(n));e.attr(i)}}(e,t,i);return!1}var qh=function(){function e(e){this.animators=[],this.current=0,this.timer=null,this.canvas=e}return e.prototype.initTimer=function(){var e,t,n,i=this;this.timer=Du((function(r){if(i.current=r,i.animators.length>0){for(var o=i.animators.length-1;o>=0;o--)if((e=i.animators[o]).destroyed)i.removeAnimator(o);else{if(!e.isAnimatePaused())for(var s=(t=e.get("animations")).length-1;s>=0;s--)n=t[s],Kh(e,n,r)&&(t.splice(s,1),!1,n.callback&&n.callback());0===t.length&&i.removeAnimator(o)}i.canvas.get("autoDraw")||i.canvas.draw()}}))},e.prototype.addAnimator=function(e){this.animators.push(e)},e.prototype.removeAnimator=function(e){this.animators.splice(e,1)},e.prototype.isAnimating=function(){return!!this.animators.length},e.prototype.stop=function(){this.timer&&this.timer.stop()},e.prototype.stopAllAnimations=function(e){void 0===e&&(e=!0),this.animators.forEach((function(t){t.stopAnimate(e)})),this.animators=[],this.canvas.draw()},e.prototype.getTime=function(){return this.current},e}(),$h=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function Yh(e,t,n){n.name=t,n.target=e,n.currentTarget=e,n.delegateTarget=e,e.emit(t,n)}function Xh(e,t,n){if(n.bubbles){var i=void 0,r=!1;if("mouseenter"===t?(i=n.fromShape,r=!0):"mouseleave"===t&&(r=!0,i=n.toShape),e.isCanvas()&&r)return;if(i&&Vc(e,i))return void(n.bubbles=!1);n.name=t,n.currentTarget=e,n.delegateTarget=e,e.emit(t,n)}}var Zh=function(){function e(e){var t=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(e){var n=e.type;t._triggerEvent(n,e)},this._onDocumentMove=function(e){if(t.canvas.get("el")!==e.target&&(t.dragging||t.currentShape)){var n=t._getPointInfo(e);t.dragging&&t._emitEvent("drag",e,n,t.draggingShape)}},this._onDocumentMouseUp=function(e){if(t.canvas.get("el")!==e.target&&t.dragging){var n=t._getPointInfo(e);t.draggingShape&&t._emitEvent("drop",e,n,null),t._emitEvent("dragend",e,n,t.draggingShape),t._afterDrag(t.draggingShape,n,e)}},this.canvas=e.canvas}return e.prototype.init=function(){this._bindEvents()},e.prototype._bindEvents=function(){var e=this,t=this.canvas.get("el");cr($h,(function(n){t.addEventListener(n,e._eventCallback)})),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._clearEvents=function(){var e=this,t=this.canvas.get("el");cr($h,(function(n){t.removeEventListener(n,e._eventCallback)})),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._getEventObj=function(e,t,n,i,r,o){var s=new Bc(e,t);return s.fromShape=r,s.toShape=o,s.x=n.x,s.y=n.y,s.clientX=n.clientX,s.clientY=n.clientY,s.propagationPath.push(i),s},e.prototype._getShape=function(e,t){return this.canvas.getShape(e.x,e.y,t)},e.prototype._getPointInfo=function(e){var t=this.canvas,n=t.getClientByEvent(e),i=t.getPointByEvent(e);return{x:i.x,y:i.y,clientX:n.x,clientY:n.y}},e.prototype._triggerEvent=function(e,t){var n=this._getPointInfo(t),i=this._getShape(n,t),r=this["_on"+e],o=!1;if(r)r.call(this,n,i,t);else{var s=this.currentShape;"mouseenter"===e||"dragenter"===e||"mouseover"===e?(this._emitEvent(e,t,n,null,null,i),i&&this._emitEvent(e,t,n,i,null,i),"mouseenter"===e&&this.draggingShape&&this._emitEvent("dragenter",t,n,null)):"mouseleave"===e||"dragleave"===e||"mouseout"===e?(o=!0,s&&this._emitEvent(e,t,n,s,s,null),this._emitEvent(e,t,n,null,s,null),"mouseleave"===e&&this.draggingShape&&this._emitEvent("dragleave",t,n,null)):this._emitEvent(e,t,n,i,null,null)}if(o||(this.currentShape=i),i&&!i.get("destroyed")){var a=this.canvas;a.get("el").style.cursor=i.attr("cursor")||a.get("cursor")}},e.prototype._onmousedown=function(e,t,n){0===n.button&&(this.mousedownShape=t,this.mousedownPoint=e,this.mousedownTimeStamp=n.timeStamp),this._emitEvent("mousedown",n,e,t,null,null)},e.prototype._emitMouseoverEvents=function(e,t,n,i){var r=this.canvas.get("el");n!==i&&(n&&(this._emitEvent("mouseout",e,t,n,n,i),this._emitEvent("mouseleave",e,t,n,n,i),i&&!i.get("destroyed")||(r.style.cursor=this.canvas.get("cursor"))),i&&(this._emitEvent("mouseover",e,t,i,n,i),this._emitEvent("mouseenter",e,t,i,n,i)))},e.prototype._emitDragoverEvents=function(e,t,n,i,r){i?(i!==n&&(n&&this._emitEvent("dragleave",e,t,n,n,i),this._emitEvent("dragenter",e,t,i,n,i)),r||this._emitEvent("dragover",e,t,i)):n&&this._emitEvent("dragleave",e,t,n,n,i),r&&this._emitEvent("dragover",e,t,i)},e.prototype._afterDrag=function(e,t,n){e&&(e.set("capture",!0),this.draggingShape=null),this.dragging=!1;var i=this._getShape(t,n);i!==e&&this._emitMouseoverEvents(n,t,e,i),this.currentShape=i},e.prototype._onmouseup=function(e,t,n){if(0===n.button){var i=this.draggingShape;this.dragging?(i&&this._emitEvent("drop",n,e,t),this._emitEvent("dragend",n,e,i),this._afterDrag(i,e,n)):(this._emitEvent("mouseup",n,e,t),t===this.mousedownShape&&this._emitEvent("click",n,e,t),this.mousedownShape=null,this.mousedownPoint=null)}},e.prototype._ondragover=function(e,t,n){n.preventDefault();var i=this.currentShape;this._emitDragoverEvents(n,e,i,t,!0)},e.prototype._onmousemove=function(e,t,n){var i=this.canvas,r=this.currentShape,o=this.draggingShape;if(this.dragging)o&&this._emitDragoverEvents(n,e,r,t,!1),this._emitEvent("drag",n,e,o);else{var s=this.mousedownPoint;if(s){var a=this.mousedownShape,l=n.timeStamp-this.mousedownTimeStamp,c=s.clientX-e.clientX,u=s.clientY-e.clientY;l>120||c*c+u*u>40?a&&a.get("draggable")?((o=this.mousedownShape).set("capture",!1),this.draggingShape=o,this.dragging=!0,this._emitEvent("dragstart",n,e,o),this.mousedownShape=null,this.mousedownPoint=null):!a&&i.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",n,e,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(n,e,r,t),this._emitEvent("mousemove",n,e,t)):(this._emitMouseoverEvents(n,e,r,t),this._emitEvent("mousemove",n,e,t))}else this._emitMouseoverEvents(n,e,r,t),this._emitEvent("mousemove",n,e,t)}},e.prototype._emitEvent=function(e,t,n,i,r,o){var s=this._getEventObj(e,t,n,i,r,o);if(i){s.shape=i,Yh(i,e,s);for(var a=i.getParent();a;)a.emitDelegation(e,s),s.propagationStopped||Xh(a,e,s),s.propagationPath.push(a),a=a.getParent()}else{Yh(this.canvas,e,s)}},e.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},e}(),Qh=Jc(),Jh=Qh&&"firefox"===Qh.name,ed=function(e){function t(t){var n=e.call(this,t)||this;return n.initContainer(),n.initDom(),n.initEvents(),n.initTimeline(),n}return qi(t,e),t.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.cursor="default",t.supportCSSTransform=!1,t},t.prototype.initContainer=function(){var e=this.get("container");xr(e)&&(e=document.getElementById(e),this.set("container",e))},t.prototype.initDom=function(){var e=this.createDom();this.set("el",e),this.get("container").appendChild(e),this.setDOMSize(this.get("width"),this.get("height"))},t.prototype.initEvents=function(){var e=new Zh({canvas:this});e.init(),this.set("eventController",e)},t.prototype.initTimeline=function(){var e=new qh(this);this.set("timeline",e)},t.prototype.setDOMSize=function(e,t){var n=this.get("el");zc&&(n.style.width=e+"px",n.style.height=t+"px")},t.prototype.changeSize=function(e,t){this.setDOMSize(e,t),this.set("width",e),this.set("height",t),this.onCanvasChange("changeSize")},t.prototype.getRenderer=function(){return this.get("renderer")},t.prototype.getCursor=function(){return this.get("cursor")},t.prototype.setCursor=function(e){this.set("cursor",e);var t=this.get("el");zc&&t&&(t.style.cursor=e)},t.prototype.getPointByEvent=function(e){if(this.get("supportCSSTransform")){if(Jh&&!sr(e.layerX)&&e.layerX!==e.offsetX)return{x:e.layerX,y:e.layerY};if(!sr(e.offsetX))return{x:e.offsetX,y:e.offsetY}}var t=this.getClientByEvent(e),n=t.x,i=t.y;return this.getPointByClient(n,i)},t.prototype.getClientByEvent=function(e){var t=e;return e.touches&&(t="touchend"===e.type?e.changedTouches[0]:e.touches[0]),{x:t.clientX,y:t.clientY}},t.prototype.getPointByClient=function(e,t){var n=this.get("el").getBoundingClientRect();return{x:e-n.left,y:t-n.top}},t.prototype.getClientByPoint=function(e,t){var n=this.get("el").getBoundingClientRect();return{x:e+n.left,y:t+n.top}},t.prototype.draw=function(){},t.prototype.removeDom=function(){var e=this.get("el");e.parentNode.removeChild(e)},t.prototype.clearEvents=function(){this.get("eventController").destroy()},t.prototype.isCanvas=function(){return!0},t.prototype.getParent=function(){return null},t.prototype.destroy=function(){var t=this.get("timeline");this.get("destroyed")||(this.clear(),t&&t.stop(),this.clearEvents(),this.removeDom(),e.prototype.destroy.call(this))},t}(mu),td=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.isGroup=function(){return!0},t.prototype.isEntityGroup=function(){return!1},t.prototype.clone=function(){for(var t=e.prototype.clone.call(this),n=this.getChildren(),i=0;i<n.length;i++){var r=n[i];t.add(r.clone())}return t},t}(mu),nd=function(e){function t(t){return e.call(this,t)||this}return qi(t,e),t.prototype._isInBBox=function(e,t){var n=this.getBBox();return n.minX<=e&&n.maxX>=e&&n.minY<=t&&n.maxY>=t},t.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t),this.clearCacheBBox()},t.prototype.getBBox=function(){var e=this.cfg.bbox;return e||(e=this.calculateBBox(),this.set("bbox",e)),e},t.prototype.getCanvasBBox=function(){var e=this.cfg.canvasBBox;return e||(e=this.calculateCanvasBBox(),this.set("canvasBBox",e)),e},t.prototype.applyMatrix=function(t){e.prototype.applyMatrix.call(this,t),this.set("canvasBBox",null)},t.prototype.calculateCanvasBBox=function(){var e=this.getBBox(),t=this.getTotalMatrix(),n=e.minX,i=e.minY,r=e.maxX,o=e.maxY;if(t){var s=nu(t,[e.minX,e.minY]),a=nu(t,[e.maxX,e.minY]),l=nu(t,[e.minX,e.maxY]),c=nu(t,[e.maxX,e.maxY]);n=Math.min(s[0],a[0],l[0],c[0]),r=Math.max(s[0],a[0],l[0],c[0]),i=Math.min(s[1],a[1],l[1],c[1]),o=Math.max(s[1],a[1],l[1],c[1])}var u=this.attrs;if(u.shadowColor){var h=u.shadowBlur,d=void 0===h?0:h,f=u.shadowOffsetX,g=void 0===f?0:f,p=u.shadowOffsetY,m=void 0===p?0:p,v=n-d+g,y=r+d+g,_=i-d+m,b=o+d+m;n=Math.min(n,v),r=Math.max(r,y),i=Math.min(i,_),o=Math.max(o,b)}return{x:n,y:i,minX:n,minY:i,maxX:r,maxY:o,width:r-n,height:o-i}},t.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},t.prototype.isClipShape=function(){return this.get("isClipShape")},t.prototype.isInShape=function(e,t){return!1},t.prototype.isOnlyHitBox=function(){return!1},t.prototype.isHit=function(e,t){var n=this.get("startArrowShape"),i=this.get("endArrowShape"),r=[e,t,1],o=(r=this.invertFromMatrix(r))[0],s=r[1],a=this._isInBBox(o,s);if(this.isOnlyHitBox())return a;if(a&&!this.isClipped(o,s)){if(this.isInShape(o,s))return!0;if(n&&n.isHit(o,s))return!0;if(i&&i.isHit(o,s))return!0}return!1},t}(uu),id=new Map;function rd(e,t){id.set(e,t)}function od(e){return id.get(e)}function sd(e){var t=e.attr();return{x:t.x,y:t.y,width:t.width,height:t.height}}function ad(e){var t=e.attr(),n=t.x,i=t.y,r=t.r;return{x:n-r,y:i-r,width:2*r,height:2*r}}function ld(e){return Math.min.apply(null,e)}function cd(e){return Math.max.apply(null,e)}function ud(e,t,n,i){var r=e-n,o=t-i;return Math.sqrt(r*r+o*o)}function hd(e,t){return Math.abs(e-t)<.001}function dd(e,t){var n=ld(e),i=ld(t);return{x:n,y:i,width:cd(e)-n,height:cd(t)-i}}function fd(e){return(e+2*Math.PI)%(2*Math.PI)}var gd={box:function(e,t,n,i){return dd([e,n],[t,i])},length:function(e,t,n,i){return ud(e,t,n,i)},pointAt:function(e,t,n,i,r){return{x:(1-r)*e+r*n,y:(1-r)*t+r*i}},pointDistance:function(e,t,n,i,r,o){var s=(n-e)*(r-e)+(i-t)*(o-t);return s<0?ud(e,t,r,o):s>(n-e)*(n-e)+(i-t)*(i-t)?ud(n,i,r,o):this.pointToLine(e,t,n,i,r,o)},pointToLine:function(e,t,n,i,r,o){var s=[n-e,i-t];if(Fs(s,[0,0]))return Math.sqrt((r-e)*(r-e)+(o-t)*(o-t));var a=[-s[1],s[0]];Rs(a,a);var l=[r-e,o-t];return Math.abs(Ps(l,a))},tangentAngle:function(e,t,n,i){return Math.atan2(i-t,n-e)}};function pd(e,t,n,i,r,o){var s,a=1/0,l=[n,i],c=20;o&&o>200&&(c=o/10);for(var u=1/c,h=u/10,d=0;d<=c;d++){var f=d*u,g=[r.apply(null,e.concat([f])),r.apply(null,t.concat([f]))];(y=ud(l[0],l[1],g[0],g[1]))<a&&(s=f,a=y)}if(0===s)return{x:e[0],y:t[0]};if(1===s){var p=e.length;return{x:e[p-1],y:t[p-1]}}a=1/0;for(d=0;d<32&&!(h<1e-4);d++){var m=s-h,v=s+h,y=(g=[r.apply(null,e.concat([m])),r.apply(null,t.concat([m]))],ud(l[0],l[1],g[0],g[1]));if(m>=0&&y<a)s=m,a=y;else{var _=[r.apply(null,e.concat([v])),r.apply(null,t.concat([v]))],b=ud(l[0],l[1],_[0],_[1]);v<=1&&b<a?(s=v,a=b):h*=.5}}return{x:r.apply(null,e.concat([s])),y:r.apply(null,t.concat([s]))}}function md(e,t,n,i){var r=1-i;return r*r*e+2*i*r*t+i*i*n}function vd(e,t,n){var i=e+n-2*t;if(hd(i,0))return[.5];var r=(e-t)/i;return r<=1&&r>=0?[r]:[]}function yd(e,t,n,i){return 2*(1-i)*(t-e)+2*i*(n-t)}function _d(e,t,n,i,r,o,s){var a=md(e,n,r,s),l=md(t,i,o,s),c=gd.pointAt(e,t,n,i,s),u=gd.pointAt(n,i,r,o,s);return[[e,t,c.x,c.y,a,l],[a,l,u.x,u.y,r,o]]}function bd(e,t,n,i,r,o,s){if(0===s)return(ud(e,t,n,i)+ud(n,i,r,o)+ud(e,t,r,o))/2;var a=_d(e,t,n,i,r,o,.5),l=a[0],c=a[1];return l.push(s-1),c.push(s-1),bd.apply(null,l)+bd.apply(null,c)}var wd={box:function(e,t,n,i,r,o){var s=vd(e,n,r)[0],a=vd(t,i,o)[0],l=[e,r],c=[t,o];return void 0!==s&&l.push(md(e,n,r,s)),void 0!==a&&c.push(md(t,i,o,a)),dd(l,c)},length:function(e,t,n,i,r,o){return bd(e,t,n,i,r,o,3)},nearestPoint:function(e,t,n,i,r,o,s,a){return pd([e,n,r],[t,i,o],s,a,md)},pointDistance:function(e,t,n,i,r,o,s,a){var l=this.nearestPoint(e,t,n,i,r,o,s,a);return ud(l.x,l.y,s,a)},interpolationAt:md,pointAt:function(e,t,n,i,r,o,s){return{x:md(e,n,r,s),y:md(t,i,o,s)}},divide:function(e,t,n,i,r,o,s){return _d(e,t,n,i,r,o,s)},tangentAngle:function(e,t,n,i,r,o,s){var a=yd(e,n,r,s),l=yd(t,i,o,s);return fd(Math.atan2(l,a))}};function Cd(e,t,n,i,r){var o=1-r;return o*o*o*e+3*t*r*o*o+3*n*r*r*o+i*r*r*r}function Sd(e,t,n,i,r){var o=1-r;return 3*(o*o*(t-e)+2*o*r*(n-t)+r*r*(i-n))}function xd(e,t,n,i){var r,o,s,a=-3*e+9*t-9*n+3*i,l=6*e-12*t+6*n,c=3*t-3*e,u=[];if(hd(a,0))hd(l,0)||(r=-c/l)>=0&&r<=1&&u.push(r);else{var h=l*l-4*a*c;hd(h,0)?u.push(-l/(2*a)):h>0&&(o=(-l-(s=Math.sqrt(h)))/(2*a),(r=(-l+s)/(2*a))>=0&&r<=1&&u.push(r),o>=0&&o<=1&&u.push(o))}return u}function Ed(e,t,n,i,r,o,s,a,l){var c=Cd(e,n,r,s,l),u=Cd(t,i,o,a,l),h=gd.pointAt(e,t,n,i,l),d=gd.pointAt(n,i,r,o,l),f=gd.pointAt(r,o,s,a,l),g=gd.pointAt(h.x,h.y,d.x,d.y,l),p=gd.pointAt(d.x,d.y,f.x,f.y,l);return[[e,t,h.x,h.y,g.x,g.y,c,u],[c,u,p.x,p.y,f.x,f.y,s,a]]}function kd(e,t,n,i,r,o,s,a,l){if(0===l)return function(e,t){for(var n=0,i=e.length,r=0;r<i;r++)n+=ud(e[r],t[r],e[(r+1)%i],t[(r+1)%i]);return n/2}([e,n,r,s],[t,i,o,a]);var c=Ed(e,t,n,i,r,o,s,a,.5),u=c[0],h=c[1];return u.push(l-1),h.push(l-1),kd.apply(null,u)+kd.apply(null,h)}var Ld={extrema:xd,box:function(e,t,n,i,r,o,s,a){for(var l=[e,s],c=[t,a],u=xd(e,n,r,s),h=xd(t,i,o,a),d=0;d<u.length;d++)l.push(Cd(e,n,r,s,u[d]));for(d=0;d<h.length;d++)c.push(Cd(t,i,o,a,h[d]));return dd(l,c)},length:function(e,t,n,i,r,o,s,a){return kd(e,t,n,i,r,o,s,a,3)},nearestPoint:function(e,t,n,i,r,o,s,a,l,c,u){return pd([e,n,r,s],[t,i,o,a],l,c,Cd,u)},pointDistance:function(e,t,n,i,r,o,s,a,l,c,u){var h=this.nearestPoint(e,t,n,i,r,o,s,a,l,c,u);return ud(h.x,h.y,l,c)},interpolationAt:Cd,pointAt:function(e,t,n,i,r,o,s,a,l){return{x:Cd(e,n,r,s,l),y:Cd(t,i,o,a,l)}},divide:function(e,t,n,i,r,o,s,a,l){return Ed(e,t,n,i,r,o,s,a,l)},tangentAngle:function(e,t,n,i,r,o,s,a,l){var c=Sd(e,n,r,s,l),u=Sd(t,i,o,a,l);return fd(Math.atan2(u,c))}};function Dd(e,t,n,i,r,o){return n*Math.cos(r)*Math.cos(o)-i*Math.sin(r)*Math.sin(o)+e}function Nd(e,t,n,i,r,o){return n*Math.sin(r)*Math.cos(o)+i*Math.cos(r)*Math.sin(o)+t}var Id=function(e,t,n,i,r,o,s){for(var a=function(e,t,n){return Math.atan(-t/e*Math.tan(n))}(n,i,r),l=1/0,c=-1/0,u=[o,s],h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var d=a+h;o<s?o<d&&d<s&&u.push(d):s<d&&d<o&&u.push(d)}for(h=0;h<u.length;h++){var f=Dd(e,0,n,i,r,u[h]);f<l&&(l=f),f>c&&(c=f)}var g=function(e,t,n){return Math.atan(t/(e*Math.tan(n)))}(n,i,r),p=1/0,m=-1/0,v=[o,s];for(h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var y=g+h;o<s?o<y&&y<s&&v.push(y):s<y&&y<o&&v.push(y)}for(h=0;h<v.length;h++){var _=Nd(0,t,n,i,r,v[h]);_<p&&(p=_),_>m&&(m=_)}return{x:l,y:p,width:c-l,height:m-p}};var Td=function(e){return function(e){if(e.length<2)return 0;for(var t=0,n=0;n<e.length-1;n++){var i=e[n],r=e[n+1];t+=ud(i[0],i[1],r[0],r[1])}return t}(e)};function Md(e,t){return e&&t?{minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}:e||t}function Ad(e,t){var n=e.get("startArrowShape"),i=e.get("endArrowShape");return n&&(t=Md(t,n.getCanvasBBox())),i&&(t=Md(t,i.getCanvasBBox())),t}var Od=null;function Rd(){if(!Od){var e=document.createElement("canvas");e.width=1,e.height=1,Od=e.getContext("2d")}return Od}function Pd(e,t,n){var i=1;return xr(e)&&(i=e.split("\n").length),i>1?t*i+function(e,t){return t?t-e:.14*e}(t,n)*(i-1):t}function Fd(e){var t=e.fontSize,n=e.fontFamily,i=e.fontWeight;return[e.fontStyle,e.fontVariant,i,t+"px",n].join(" ").trim()}var Bd=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,Wd=/[^\s\,]+/gi;function zd(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=[[0,0],[1,1]]);for(var i=!!t,r=[],o=0,s=e.length;o<s;o+=2)r.push([e[o],e[o+1]]);var a,l,c,u=function(e,t,n,i){var r,o,s,a,l,c,u,h=[],d=!!i;if(d){s=i[0],a=i[1];for(var f=0,g=e.length;f<g;f+=1)s=Ts([0,0],s,m=e[f]),a=Ms([0,0],a,m)}f=0;for(var p=e.length;f<p;f+=1){var m=e[f];if(0!==f||n)if(f!==p-1||n){r=e[[f?f-1:p-1,f-1][n?0:1]],o=e[n?(f+1)%p:f+1];var v=[0,0];v=As(v=Bs(v,o,r),v,t);var y=Os(m,r),_=Os(m,o),b=y+_;0!==b&&(y/=b,_/=b);var w=As([0,0],v,-y),C=As([0,0],v,_);c=Is([0,0],m,w),l=Ts([0,0],l=Is([0,0],m,C),Ms([0,0],o,m)),l=Ms([0,0],l,Ts([0,0],o,m)),c=Ts([0,0],c=Is([0,0],m,w=As([0,0],w=Bs([0,0],l,m),-y/_)),Ms([0,0],r,m)),c=Ms([0,0],c,Ts([0,0],r,m)),l=Is([0,0],m,C=As([0,0],C=Bs([0,0],m,c),_/y)),d&&(c=Ts([0,0],c=Ms([0,0],c,s),a),l=Ts([0,0],l=Ms([0,0],l,s),a)),h.push(u),h.push(c),u=l}else c=m,h.push(u),h.push(c);else u=m}return n&&h.push(h.shift()),h}(r,.4,i,n),h=r.length,d=[];for(o=0;o<h-1;o+=1)a=u[2*o],l=u[2*o+1],c=r[o+1],d.push(["C",a[0],a[1],l[0],l[1],c[0],c[1]]);return i&&(a=u[h],l=u[h+1],c=r[0],d.push(["C",a[0],a[1],l[0],l[1],c[0],c[1]])),d}var Vd="\t\n\v\f\r   ᠎             　\u2028\u2029",Ud=new RegExp("([a-z])["+Vd+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Vd+"]*,?["+Vd+"]*)+)","ig"),Hd=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Vd+"]*,?["+Vd+"]*","ig");function jd(e){if(!e)return null;if(ar(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},n=[];return String(e).replace(Ud,(function(e,i,r){var o=[],s=i.toLowerCase();if(r.replace(Hd,(function(e,t){t&&o.push(+t)})),"m"===s&&o.length>2&&(n.push([i].concat(o.splice(0,2))),s="l",i="m"===i?"l":"L"),"o"===s&&1===o.length&&n.push([i,o[0]]),"r"===s)n.push([i].concat(o));else for(;o.length>=t[s]&&(n.push([i].concat(o.splice(0,t[s]))),t[s]););return""})),n}var Gd=/[a-z]/;function Kd(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function qd(e){var t=jd(e);if(!t||!t.length)return[["M",0,0]];for(var n=!1,i=0;i<t.length;i++){var r=t[i][0];if(Gd.test(r)||["V","H","T","S"].indexOf(r)>=0){n=!0;break}}if(!n)return t;var o=[],s=0,a=0,l=0,c=0,u=0,h=t[0];"M"!==h[0]&&"m"!==h[0]||(l=s=+h[1],c=a=+h[2],u++,o[0]=["M",s,a]);i=u;for(var d=t.length;i<d;i++){var f=t[i],g=o[i-1],p=[],m=(r=f[0]).toUpperCase();if(r!==m)switch(p[0]=m,m){case"A":p[1]=f[1],p[2]=f[2],p[3]=f[3],p[4]=f[4],p[5]=f[5],p[6]=+f[6]+s,p[7]=+f[7]+a;break;case"V":p[1]=+f[1]+a;break;case"H":p[1]=+f[1]+s;break;case"M":l=+f[1]+s,c=+f[2]+a,p[1]=l,p[2]=c;break;default:for(var v=1,y=f.length;v<y;v++)p[v]=+f[v]+(v%2?s:a)}else p=t[i];switch(m){case"Z":s=+l,a=+c;break;case"H":p=["L",s=p[1],a];break;case"V":p=["L",s,a=p[1]];break;case"T":s=p[1],a=p[2];var _=Kd([g[1],g[2]],[g[3],g[4]]);p=["Q",_[0],_[1],s,a];break;case"S":s=p[p.length-2],a=p[p.length-1];var b=g.length,w=Kd([g[b-4],g[b-3]],[g[b-2],g[b-1]]);p=["C",w[0],w[1],p[1],p[2],s,a];break;case"M":l=p[p.length-2],c=p[p.length-1];break;default:s=p[p.length-2],a=p[p.length-1]}o.push(p)}return o}function $d(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Yd(e,t){return $d(e)*$d(t)?(e[0]*t[0]+e[1]*t[1])/($d(e)*$d(t)):1}function Xd(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(Yd(e,t))}function Zd(e,t){return e[0]===t[0]&&e[1]===t[1]}function Qd(e,t){var n=t[1],i=t[2],r=Fr(Vr(t[3]),2*Math.PI),o=t[4],s=t[5],a=e[0],l=e[1],c=t[6],u=t[7],h=Math.cos(r)*(a-c)/2+Math.sin(r)*(l-u)/2,d=-1*Math.sin(r)*(a-c)/2+Math.cos(r)*(l-u)/2,f=h*h/(n*n)+d*d/(i*i);f>1&&(n*=Math.sqrt(f),i*=Math.sqrt(f));var g=n*n*(d*d)+i*i*(h*h),p=g?Math.sqrt((n*n*(i*i)-g)/g):1;o===s&&(p*=-1),isNaN(p)&&(p=0);var m=i?p*n*d/i:0,v=n?p*-i*h/n:0,y=(a+c)/2+Math.cos(r)*m-Math.sin(r)*v,_=(l+u)/2+Math.sin(r)*m+Math.cos(r)*v,b=[(h-m)/n,(d-v)/i],w=[(-1*h-m)/n,(-1*d-v)/i],C=Xd([1,0],b),S=Xd(b,w);return Yd(b,w)<=-1&&(S=Math.PI),Yd(b,w)>=1&&(S=0),0===s&&S>0&&(S-=2*Math.PI),1===s&&S<0&&(S+=2*Math.PI),{cx:y,cy:_,rx:Zd(e,[c,u])?0:n,ry:Zd(e,[c,u])?0:i,startAngle:C,endAngle:C+S,xRotation:r,arcFlag:o,sweepFlag:s}}function Jd(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function ef(e){for(var t=[],n=null,i=null,r=null,o=0,s=(e=function(e){var t=e||[];return ar(t)?t:xr(t)?(cr(t=t.match(Bd),(function(e,n){if((e=e.match(Wd))[0].length>1){var i=e[0].charAt(0);e.splice(1,0,e[0].substr(1)),e[0]=i}cr(e,(function(t,n){isNaN(t)||(e[n]=+t)})),t[n]=e})),t):void 0}(e)).length,a=0;a<s;a++){var l=e[a];i=e[a+1];var c=l[0],u={command:c,prePoint:n,params:l,startTangent:null,endTangent:null};switch(c){case"M":r=[l[1],l[2]],o=a;break;case"A":var h=Qd(n,l);u.arcParams=h}if("Z"===c)n=r,i=e[o+1];else{var d=l.length;n=[l[d-2],l[d-1]]}i&&"Z"===i[0]&&(i=e[o],t[o]&&(t[o].prePoint=n)),u.currentPoint=n,t[o]&&Zd(n,t[o].currentPoint)&&(t[o].prePoint=u.prePoint);var f=i?[i[i.length-2],i[i.length-1]]:null;u.nextPoint=f;var g=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[g[0]-n[0],g[1]-n[1]],u.endTangent=[n[0]-g[0],n[1]-g[1]];else if("Q"===c){var p=[l[1],l[2]];u.startTangent=[g[0]-p[0],g[1]-p[1]],u.endTangent=[n[0]-p[0],n[1]-p[1]]}else if("T"===c){p=Jd((y=t[a-1]).currentPoint,g);"Q"===y.command?(u.command="Q",u.startTangent=[g[0]-p[0],g[1]-p[1]],u.endTangent=[n[0]-p[0],n[1]-p[1]]):(u.command="TL",u.startTangent=[g[0]-n[0],g[1]-n[1]],u.endTangent=[n[0]-g[0],n[1]-g[1]])}else if("C"===c){var m=[l[1],l[2]],v=[l[3],l[4]];u.startTangent=[g[0]-m[0],g[1]-m[1]],u.endTangent=[n[0]-v[0],n[1]-v[1]],0===u.startTangent[0]&&0===u.startTangent[1]&&(u.startTangent=[m[0]-v[0],m[1]-v[1]]),0===u.endTangent[0]&&0===u.endTangent[1]&&(u.endTangent=[v[0]-m[0],v[1]-m[1]])}else if("S"===c){var y;m=Jd((y=t[a-1]).currentPoint,g),v=[l[1],l[2]];"C"===y.command?(u.command="C",u.startTangent=[g[0]-m[0],g[1]-m[1]],u.endTangent=[n[0]-v[0],n[1]-v[1]]):(u.command="SQ",u.startTangent=[g[0]-v[0],g[1]-v[1]],u.endTangent=[n[0]-v[0],n[1]-v[1]])}else if("A"===c){var _=.001,b=u.arcParams||{},w=b.cx,C=void 0===w?0:w,S=b.cy,x=void 0===S?0:S,E=b.rx,k=void 0===E?0:E,L=b.ry,D=void 0===L?0:L,N=b.sweepFlag,I=void 0===N?0:N,T=b.startAngle,M=void 0===T?0:T,A=b.endAngle,O=void 0===A?0:A;0===I&&(_*=-1);var R=k*Math.cos(M-_)+C,P=D*Math.sin(M-_)+x;u.startTangent=[R-r[0],P-r[1]];var F=k*Math.cos(M+O+_)+C,B=D*Math.sin(M+O-_)+x;u.endTangent=[g[0]-F,g[1]-B]}t.push(u)}return t}function tf(e,t){var n=e.prePoint,i=e.currentPoint,r=e.nextPoint,o=Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2),s=Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2),a=Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2),l=Math.acos((o+s-a)/(2*Math.sqrt(o)*Math.sqrt(s)));if(!l||0===Math.sin(l)||Pr(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(r[1]-i[1],r[0]-i[0])),u=Math.abs(Math.atan2(r[0]-i[0],r[1]-i[1]));return c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u,{xExtra:Math.cos(l/2-c)*(t/2*(1/Math.sin(l/2)))-t/2||0,yExtra:Math.cos(u-l/2)*(t/2*(1/Math.sin(l/2)))-t/2||0}}rd("rect",sd),rd("image",sd),rd("circle",ad),rd("marker",ad),rd("polyline",(function(e){for(var t=e.attr().points,n=[],i=[],r=0;r<t.length;r++){var o=t[r];n.push(o[0]),i.push(o[1])}var s=dd(n,i),a=s.x,l=s.y,c={minX:a,minY:l,maxX:a+s.width,maxY:l+s.height};return{x:(c=Ad(e,c)).minX,y:c.minY,width:c.maxX-c.minX,height:c.maxY-c.minY}})),rd("polygon",(function(e){for(var t=e.attr().points,n=[],i=[],r=0;r<t.length;r++){var o=t[r];n.push(o[0]),i.push(o[1])}return dd(n,i)})),rd("text",(function(e){var t=e.attr(),n=t.x,i=t.y,r=t.text,o=t.fontSize,s=t.lineHeight,a=t.font;a||(a=Fd(t));var l,c=function(e,t){var n=Rd(),i=0;return sr(e)||""===e||(n.save(),n.font=t,xr(e)&&e.includes("\n")?cr(e.split("\n"),(function(e){var t=n.measureText(e).width;i<t&&(i=t)})):i=n.measureText(e).width,n.restore()),i}(r,a);if(c){var u=t.textAlign,h=t.textBaseline,d=Pd(r,o,s),f={x:n,y:i-d};u&&("end"===u||"right"===u?f.x-=c:"center"===u&&(f.x-=c/2)),h&&("top"===h?f.y+=d:"middle"===h&&(f.y+=d/2)),l={x:f.x,y:f.y,width:c,height:d}}else l={x:n,y:i,width:0,height:0};return l})),rd("path",(function(e){var t=e.attr(),n=t.path,i=t.stroke?t.lineWidth:0,r=function(e,t){for(var n=[],i=[],r=[],o=0;o<e.length;o++){var s=(p=e[o]).currentPoint,a=p.params,l=p.prePoint,c=void 0;switch(p.command){case"Q":c=wd.box(l[0],l[1],a[1],a[2],a[3],a[4]);break;case"C":c=Ld.box(l[0],l[1],a[1],a[2],a[3],a[4],a[5],a[6]);break;case"A":var u=p.arcParams;c=Id(u.cx,u.cy,u.rx,u.ry,u.xRotation,u.startAngle,u.endAngle);break;default:n.push(s[0]),i.push(s[1])}c&&(p.box=c,n.push(c.x,c.x+c.width),i.push(c.y,c.y+c.height)),t&&("L"===p.command||"M"===p.command)&&p.prePoint&&p.nextPoint&&r.push(p)}n=n.filter((function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0})),i=i.filter((function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0}));var h=mr(n),d=mr(i),f=pr(n),g=pr(i);if(0===r.length)return{x:h,y:d,width:f-h,height:g-d};for(o=0;o<r.length;o++){var p;(s=(p=r[o]).currentPoint)[0]===h?h-=tf(p,t).xExtra:s[0]===f&&(f+=tf(p,t).xExtra),s[1]===d?d-=tf(p,t).yExtra:s[1]===g&&(g+=tf(p,t).yExtra)}return{x:h,y:d,width:f-h,height:g-d}}(e.get("segments")||ef(n),i),o=r.x,s=r.y,a={minX:o,minY:s,maxX:o+r.width,maxY:s+r.height};return{x:(a=Ad(e,a)).minX,y:a.minY,width:a.maxX-a.minX,height:a.maxY-a.minY}})),rd("line",(function(e){var t=e.attr(),n=t.x1,i=t.y1,r=t.x2,o=t.y2,s={minX:Math.min(n,r),maxX:Math.max(n,r),minY:Math.min(i,o),maxY:Math.max(i,o)};return{x:(s=Ad(e,s)).minX,y:s.minY,width:s.maxX-s.minX,height:s.maxY-s.minY}})),rd("ellipse",(function(e){var t=e.attr(),n=t.x,i=t.y,r=t.rx,o=t.ry;return{x:n-r,y:i-o,width:2*r,height:2*o}}));var nf=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.item=n.item,i.canvasX=n.canvasX,i.canvasY=n.canvasY,i.wheelDelta=n.wheelDelta,i.detail=n.detail,i}return qi(t,e),t}(Bc),rf=function(e){return"".concat(e,"-").concat(Math.random()).concat(Date.now())},of=function(e){if(ar(e))switch(e.length){case 4:return e;case 3:return e.push(e[1]),e;case 2:return e.concat(e);case 1:return[e[0],e[0],e[0],e[0]];default:return[0,0,0,0]}if(Or(e))return[e,e,e,e];if(xr(e)){var t=parseInt(e,10);return[t,t,t,t]}return[0,0,0,0]},sf=function(e){return Number.isNaN(Number(e))},af=function(e){for(var t=1/0,n=-1/0,i=1/0,r=-1/0,o=0;o<e.length;o++){var s=e[o].getBBox(),a=s.minX,l=s.minY,c=s.maxX,u=s.maxY;a<t&&(t=a),l<i&&(i=l),c>n&&(n=c),u>r&&(r=u)}return{x:Math.floor(t),y:Math.floor(i),width:Math.ceil(n)-Math.floor(t),height:Math.ceil(r)-Math.floor(i),minX:t,minY:i,maxX:n,maxY:r}},lf=Object.freeze(Object.defineProperty({__proto__:null,uniqueId:rf,formatPadding:of,cloneEvent:function(e){var t=new nf(e.type,e);return t.clientX=e.clientX,t.clientY=e.clientY,t.x=e.x,t.y=e.y,t.target=e.target,t.currentTarget=e.currentTarget,t.bubbles=!0,t.item=e.item,t},isViewportChanged:function(e){if(!e)return!1;for(var t=[1,0,0,0,1,0,0,0,1],n=0;n<9;n++)if(e[n]!==t[n])return!0;return!1},isNaN:sf,calculationItemsBBox:af,processParallelEdges:function(e,t,n,i,r){void 0===t&&(t=15),void 0===n&&(n="quadratic"),void 0===i&&(i=void 0),void 0===r&&(r=void 0);for(var o=e.length,s=2*t,a=["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left"],l={},c=[],u={},h=0;h<o;h++){var d=e[h],f=d.source,g=d.target,p="".concat(f,"-").concat(g);if(!c[h]){l[p]||(l[p]=[]),c[h]=!0,l[p].push(d);for(var m=0;m<o;m++)if(h!==m){var v=e[m],y=v.source,_=v.target;c[m]||(f===_&&g===y?(l[p].push(v),c[m]=!0,u["".concat(y,"|").concat(_,"|").concat(l[p].length-1)]=!0):f===y&&g===_&&(l[p].push(v),c[m]=!0))}}}for(var b in l)for(var w=l[b],C=w.length,S=0;S<C;S++){var x=w[S];if(x.source!==x.target)if(1===C&&i&&x.source!==x.target)x.type=i;else{x.type=n;var E=(S%2==0?1:-1)*(u["".concat(x.source,"|").concat(x.target,"|").concat(S)]?-1:1);x.curveOffset=C%2==1?E*Math.ceil(S/2)*s:E*(Math.floor(S/2)*s+t)}else r&&(x.type=r),x.loopCfg={position:a[S%8],dist:20*Math.floor(S/8)+50}}return e}},Symbol.toStringTag,{value:"Module"})),cf=function(){function e(e){this.destroyed=!1,this.graph=e,this.destroyed=!1}return e.prototype.getViewCenter=function(){var e=this.getFormatPadding(),t=this.graph,n=this.graph.get("width"),i=t.get("height");return{x:(n-e[1]-e[3])/2+e[3],y:(i-e[0]-e[2])/2+e[0]}},e.prototype.fitCenter=function(){var e=this.graph,t=e.get("group");t.resetMatrix();var n=t.getCanvasBBox();if(0!==n.width&&0!==n.height){var i=this.getViewCenter(),r=n.x+n.width/2,o=n.y+n.height/2;e.translate(i.x-r,i.y-o)}},e.prototype.fitView=function(){var e=this.graph,t=this.getFormatPadding(),n=e.get("width"),i=e.get("height"),r=e.get("group");r.resetMatrix();var o=r.getCanvasBBox();if(0!==o.width&&0!==o.height){var s=this.getViewCenter(),a=o.x+o.width/2,l=o.y+o.height/2;e.translate(s.x-a,s.y-l);var c=(n-t[1]-t[3])/o.width,u=(i-t[0]-t[2])/o.height,h=c;c>u&&(h=u),e.zoom(h,s)||console.warn("zoom failed, ratio out of range, ratio: %f",h)}},e.prototype.fitViewByRules=function(e){var t=e.onlyOutOfViewPort,n=void 0!==t&&t,i=e.direction,r=void 0===i?"both":i,o=e.ratioRule,s=void 0===o?"min":o,a=this.graph,l=this.getFormatPadding(),c=a.get("width"),u=a.get("height"),h=a.get("group");h.resetMatrix();var d=h.getCanvasBBox();if(0!==d.width&&0!==d.height){var f=this.getViewCenter(),g=d.x+d.width/2,p=d.y+d.height/2;a.translate(f.x-g,f.y-p);var m,v=(c-l[1]-l[3])/d.width,y=(u-l[0]-l[2])/d.height;m="x"===r?v:"y"===r?y:"max"===s?Math.max(v,y):Math.min(v,y),n&&(m=m<1?m:1);var _=a.getZoom()*m,b=a.get("minZoom");_<b&&(_=b,console.warn("fitview failed, ratio out of range, ratio: %f",m,"graph minzoom has been used instead")),a.zoomTo(_,f)}},e.prototype.getFormatPadding=function(){var e=this.graph.get("fitViewPadding");return of(e)},e.prototype.focusPoint=function(e,t,n){var i=this,r=this.getViewCenter(),o=this.getPointByCanvas(r.x,r.y),s=this.graph.get("group").getMatrix();if(s||(s=[1,0,0,0,1,0,0,0,1]),t){var a=(o.x-e.x)*s[0],l=(o.y-e.y)*s[4],c=0,u=0,h=0,d=0;this.graph.get("canvas").animate((function(e){h=a*e,d=l*e,i.graph.translate(h-c,d-u),c=h,u=d}),$i({},n))}else this.graph.translate((o.x-e.x)*s[0],(o.y-e.y)*s[4])},e.prototype.getPointByCanvas=function(e,t){var n=this.graph.get("group").getMatrix();return n||(n=[1,0,0,0,1,0,0,0,1]),hl({x:e,y:t},n)},e.prototype.getPointByClient=function(e,t){var n=this.graph.get("canvas").getPointByClient(e,t);return this.getPointByCanvas(n.x,n.y)},e.prototype.getClientByPoint=function(e,t){var n=this.graph.get("canvas"),i=this.getCanvasByPoint(e,t),r=n.getClientByPoint(i.x,i.y);return{x:r.x,y:r.y}},e.prototype.getCanvasByPoint=function(e,t){var n=this.graph.get("group").getMatrix();return n||(n=[1,0,0,0,1,0,0,0,1]),ul({x:e,y:t},n)},e.prototype.focus=function(e,t,n){if(xr(e)&&(e=this.graph.findById(e)),e){var i=0,r=0;if(e.getType&&"edge"===e.getType()){var o=e.getSource().get("group").getMatrix(),s=e.getTarget().get("group").getMatrix();o&&s?(i=(o[6]+s[6])/2,r=(o[7]+s[7])/2):(o||s)&&(i=o?o[6]:s[6],r=o?o[7]:s[7])}else{var a=e.get("group").getMatrix();a||(a=[1,0,0,0,1,0,0,0,1]),i=a[6],r=a[7]}this.focusPoint({x:i,y:r},t,n)}},e.prototype.changeSize=function(e,t){var n=this.graph;if(!Or(e)||!Or(t))throw Error("invalid canvas width & height, please make sure width & height type is number");n.set({width:e,height:t}),n.get("canvas").changeSize(e,t),n.get("plugins").forEach((function(e){e.get("gridContainer")&&e.positionInit()}))},e.prototype.destroy=function(){this.graph=null,this.destroyed=!1},e}();function uf(e){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hf(e){if("string"!=typeof e)return e;var t=function(e){if("string"!=typeof e)return e;try{return JSON.parse(e.trim())}catch(t){return e.trim()}},n=t(e);if("string"!=typeof n)return n;for(var i=function(e){return e[e.length-1]},r=e.trim(),o=[],s=[],a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.some((function(e){return i(s)===e}))},l=null,c=0,u="";c<r.length;){var h=r[c],d=a('"',"'");if(d||h.trim()){var f="\\"===r[c-1],g=a("}"),p=a("]"),m=a(","),v=i(o);if(d)if(i(s)!==h||f)u+=h;else{s.pop();var y=t(u);v.push(y),l=y,u=""}else if(p&&","===h)u&&(v.push(t(u)),u="");else if(g&&":"===h)s.push(","),u&&(v.push(u),u="");else if(m&&","===h)u&&(v.push(t(u)),u=""),s.pop();else if("}"===h&&(g||m)){u&&(v.push(t(u)),u=""),m&&s.pop();for(var _={},b=1;b<v.length;b+=2)_[v[b-1]]=v[b];o.pop(),o.length&&i(o).push(_),s.pop(),l=_}else"]"===h&&p?(u&&(v.push(t(u)),u=""),o.pop(),o.length&&i(o).push(v),s.pop(),l=v):"{"===h?(o.push([]),s.push("}")):"["===h?(o.push([]),s.push("]")):'"'===h?s.push('"'):"'"===h?s.push("'"):u+=h;c+=1}else c+=1}return l||u}function df(e,t){var n={},i=e.getAttributeNames&&e.getAttributeNames()||[],r=e.children&&Array.from(e.children).map((function(e){return df(e,t)})),o={},s=e.tagName?e.tagName.toLowerCase():"group";return"text"===s&&(n.text=e.innerText),o.type=s,"img"===s&&(o.type="image"),Array.from(i).forEach((function(t){var i=t.split("-").reduce((function(e,t){return e+t.charAt(0).toUpperCase()+t.slice(1)})),r=e.getAttribute(t);try{if("style"===i||"attrs"===i){var s=hf(r);n=$i($i({},n),s)}else o[i]=hf(r)}catch(a){if("style"===i)throw a;o[i]=r}})),o.attrs=n,t&&t.style&&o.name&&"object"===uf(t.style[o.name])&&(o.attrs=$i($i({},o.attrs),t.style[o.name])),t&&t.style&&o.keyshape&&(o.attrs=$i($i({},o.attrs),t.style)),r.length&&(o.children=r),o}function ff(e,t){var n;void 0===t&&(t={x:0,y:0});var i=$i({x:0,y:0,width:0,height:0},t);if(null===(n=e.children)||void 0===n?void 0:n.length){var r=e.attrs,o=void 0===r?{}:r,s=o.marginTop,a=$i({},t);s&&(a.y+=s);for(var l=0;l<e.children.length;l++){e.children[l].attrs.key="".concat(o.key||"root"," -").concat(l," ");var c=ff(e.children[l],a);if(c.bbox){var u=c.bbox;"inline"===c.attrs.next?a.x+=c.bbox.width:a.y+=c.bbox.height,u.width+u.x>i.width&&(i.width=u.width+u.x),u.height+u.y>i.height&&(i.height=u.height+u.y)}}}return e.bbox=function(e,t,n){var i,r,o=e.attrs,s=void 0===o?{}:o,a={x:t.x||0,y:t.y||0,width:n.width||0,height:n.height||0};switch(e.type){case"maker":case"circle":s.r&&(r=2*s.r,i=2*s.r);break;case"text":s.text&&(r=Ql(s.text,s.fontSize||12)[0],i=16,a.y+=i,a.height=i,a.width=r,e.attrs=$i({fontSize:12,fill:"#000"},s));break;default:s.width&&(r=s.width),s.height&&(i=s.height)}return i>=0&&(a.height=i),r>=0&&(a.width=r),s.marginTop&&(a.y+=s.marginTop),s.marginLeft&&(a.x+=s.marginLeft),a}(e,t,i),e.attrs=$i($i({},e.attrs),e.bbox),e}function gf(e,t){var n,i,r,o,s=(e||{}).type,a=((null==t?void 0:t.attrs)||{}).key;if(a&&e&&(e.attrs.key=a),!e&&t)return{action:"delete",val:t,type:s,key:a};if(e&&!t)return{action:"add",val:e,type:s};if(!e&&!t)return{action:"same",type:s};var l=[];if((null===(n=e.children)||void 0===n?void 0:n.length)>0||(null===(i=t.children)||void 0===i?void 0:i.length)>0)for(var c=Math.max(null===(r=e.children)||void 0===r?void 0:r.length,null===(o=t.children)||void 0===o?void 0:o.length),u=t.children||[],h=e.children||[],d=0;d<c;d+=1)l.push(gf(h[d],u[d]));var f=Object.keys(t.attrs),g=Object.keys(e.attrs);return t.type!==e.type?{action:"restructure",nowTarget:e,formerTarget:t,key:a,children:l}:f.filter((function(e){return"children"!==e})).some((function(n){return e.attrs[n]!==t.attrs[n]||!g.includes(n)}))?{action:"change",val:e,children:l,type:s,key:a}:{action:"same",children:l,type:s,key:a}}function pf(e){var t={},n=function(t){var n=function(e){return function(t){for(var n=e.length,i=[],r=0,o="";r<n;)if("{"===e[r]&&"{"===e[r+1])i.push(o),o="",r+=2;else if("}"===e[r]&&"}"===e[r+1]){if(i.length){var s=i.pop();o=po(t,o,s.endsWith("=")?'"{'.concat(o,'}"'):o),i.push(s+o)}r+=2,o=""}else o+=e[r],r+=1;return i.push(o),i.map((function(e,t){return i[t-1]&&i[t-1].endsWith("=")?'"{'.concat(e,'}"'):e})).join("")}}("function"==typeof e?e(t):e)(t),i=document.createElement("div");i.innerHTML=n;var r=ff(df(i.children[0],t));return i.remove(),r};return{draw:function(e,i){var r=n(e),o=i;return function e(t){var n=t.attrs,r=void 0===n?{}:n,s=t.bbox,a=t.type,l=t.children,c=Yi(t,["attrs","bbox","type","children"]);if("group"!==t.type){var u=i.addShape(t.type,$i({attrs:r,origin:{bbox:s,type:a,children:l}},c));t.keyshape&&(o=u)}t.children&&t.children.forEach((function(t){return e(t)}))}(r),t[e.id]=[r],o},update:function(e,i){t[e.id]||(t[e.id]=[]);var r=i.getContainer(),o=r.get("children"),s=n(e),a=gf(s,t[e.id].pop()),l=function e(t){var n;"group"!==t.type&&r.addShape(t.type,{attrs:t.attrs}),(null===(n=t.children)||void 0===n?void 0:n.length)&&t.children.map((function(t){return e(t)}))},c=function e(t){var n,i=o.find((function(e){return e.attrs.key===t.attrs.key}));i&&r.removeChild(i),(null===(n=t.children)||void 0===n?void 0:n.length)&&t.children.map((function(t){return e(t)}))};!function e(t){var n=t.key;if("group"!==t.type){var r=o.find((function(e){return e.attrs.key===n}));switch(t.action){case"change":if(r){var s=t.val.keyshape?i.getOriginStyle():{};r.attr($i($i({},s),t.val.attrs))}break;case"add":l(t.val);break;case"delete":c(t.val);break;case"restructure":c(t.formerTarget),l(t.nowTarget)}}t.children&&t.children.forEach((function(t){return e(t)}))}(a),t[e.id].push(s)},getAnchorPoints:function(){return[[0,.5],[1,.5],[.5,1],[.5,0]]}}}var mf={};function vf(e){return mf[e]||(mf[e]=Gr(e)),mf[e]}var yf={defaultShapeType:"defaultType",className:null,getShape:function(e){var t=this;return t[e]||t[t.defaultShapeType]||t["simple-circle"]},draw:function(e,t,n){var i=this.getShape(e);n.shapeMap={};var r=i.draw(t,n);return i.afterDraw&&i.afterDraw(t,n,r),r},baseUpdate:function(e,t,n,i){var r,o,s=this.getShape(e);s.update&&(s.mergeStyle=null===(r=s.getOptions)||void 0===r?void 0:r.call(s,t,i),null===(o=s.update)||void 0===o||o.call(s,t,n,i)),s.afterUpdate&&s.afterUpdate(t,n)},setState:function(e,t,n,i){this.getShape(e).setState(t,n,i)},shouldUpdate:function(e){return!!this.getShape(e).update},getControlPoints:function(e,t){return this.getShape(e).getControlPoints(t)},getAnchorPoints:function(e,t){return this.getShape(e).getAnchorPoints(t)}},_f={options:{},draw:function(e,t){return this.drawShape(e,t)},drawShape:function(){},afterDraw:function(){},afterUpdate:function(){},setState:function(){},getControlPoints:function(e){return e.controlPoints},getAnchorPoints:function(e){var t=this.options.anchorPoints;return e.anchorPoints||t}},bf=function(){function e(){}return e.registerFactory=function(t,n){var i=vf(t),r=$i($i({},yf),n);return e[i]=r,r.className=i,r},e.getFactory=function(t){return e[vf(t)]},e.registerNode=function(t,n,i){var r,o=e.Node;if("string"==typeof n||"function"==typeof n){var s=pf(n);r=$i($i({},o.getShape("single-node")),s)}else if(n.jsx){s=pf(n.jsx);r=$i($i($i({},o.getShape("single-node")),s),n)}else{o.getShape(i);var a=i?o.getShape(i):_f;r=$i($i({},a),n)}return r.type=t,r.itemType="node",o[t]=r,r},e.registerEdge=function(t,n,i){var r=e.Edge,o=i?r.getShape(i):_f,s=$i($i({},o),n);return s.type=t,s.itemType="edge",r[t]=s,s},e.registerCombo=function(t,n,i){var r=e.Combo,o=i?r.getShape(i):_f,s=$i($i({},o),n);return s.type=t,s.itemType="combo",r[t]=s,s},e}();bf.registerFactory("node",{defaultShapeType:"circle"}),bf.registerFactory("edge",{defaultShapeType:"line"}),bf.registerFactory("combo",{defaultShapeType:"circle"});var wf=function(){function e(e){this._cfg={},this.destroyed=!1;this._cfg=Object.assign({id:void 0,type:"item",model:{},group:void 0,animate:!1,visible:!0,locked:!1,event:!0,keyShape:void 0,states:[]},this.getDefaultCfg(),e);var t=this.get("model"),n=t.id,i=this.get("type");n||(n=rf(i),this.get("model").id=n),this.set("id",n);var r=e.group;r&&(r.set("item",this),r.set("id",n)),this.init(),this.draw();var o=t.shape||t.type||("edge"===i?"line":"circle"),s=this.get("shapeFactory");if(s&&s[o]){var a=s[o].options;if(a&&a.stateStyles){var l=this.get("styles")||t.stateStyles;l=so({},a.stateStyles,l),this.set("styles",l)}}}return e.prototype.calculateBBox=function(){var e=this.get("keyShape"),t=this.get("group"),n=jl(e,t);return n.x=n.minX,n.y=n.minY,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n.centerX=(n.minX+n.maxX)/2,n.centerY=(n.minY+n.maxY)/2,n},e.prototype.calculateCanvasBBox=function(){var e=this.get("keyShape"),t=this.get("group"),n=jl(e,t);return n.x=n.minX,n.y=n.minY,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n.centerX=(n.minX+n.maxX)/2,n.centerY=(n.minY+n.maxY)/2,n},e.prototype.drawInner=function(){var e=this,t=e.get("shapeFactory"),n=e.get("group"),i=e.get("model");n.clear();var r=i.visible;if(void 0===r||r||e.changeVisibility(r),t){e.updatePosition(i);var o=e.getShapeCfg(i),s=o.type,a=t.draw(s,o,n);a&&(e.set("keyShape",a),a.set("isKeyShape",!0),a.set("draggable",!0)),this.setOriginStyle(),this.set("currentShape",s),this.restoreStates(t,s)}},e.prototype.setOriginStyle=function(){var e=this.get("group"),t=e.get("children"),n=this.getKeyShape(),i=this,r=n.get("name");if(this.get("originStyle")){var o=this.get("originStyle");r&&!o[r]&&(o[r]={});var s=this.getCurrentStatesStyle(),a=function(e){var n=t[e],a=n.get("name"),l=n.attr();if(a&&a!==r){var c=s[a];o[a]||(o[a]={}),c?Object.keys(l).forEach((function(e){var t=l[e];t!==c[e]&&(o[a][e]=t)})):o[a]="image"!==n.get("type")?no(l):i.getShapeStyleByName(a)}else{var u=n.attr(),h={};Object.keys(s).forEach((function(e){var t=s[e];e!==r&&fr(t)||(h[e]=t)})),Object.keys(u).forEach((function(e){var t=u[e];h[e]!==t&&(r?o[r][e]=t:o[e]=t)}))}};for(c=0;c<t.length;c++)a(c);delete o.path,delete o.matrix,delete o.x,delete o.y,o[r]&&(delete o[r].x,delete o[r].y,delete o[r].matrix,delete o[r].path),i.set("originStyle",o)}else{for(var l={},c=0;c<t.length;c++){var u=t[c],h=u.get("type"),d=u.get("name");if(d&&d!==r)l[d]="image"!==h?no(u.attr()):i.getShapeStyleByName(d),"text"===h&&l[d]&&(delete l[d].x,delete l[d].y,delete l[d].matrix);else{var f=i.getShapeStyleByName();if(delete f.path,delete f.matrix,r)if(d)l[r]=f;else{var g=rf("shape");u.set("name",g),e.shapeMap[g]=u,l[g]="image"!==h?no(u.attr()):i.getShapeStyleByName(d)}else Object.assign(l,f)}}i.set("originStyle",l)}},e.prototype.restoreStates=function(e,t){var n=this;cr(n.get("states"),(function(i){e.setState(t,i,!0,n)}))},e.prototype.init=function(){var e=bf.getFactory(this.get("type"));this.set("shapeFactory",e)},e.prototype.get=function(e){return this._cfg[e]},e.prototype.set=function(e,t){fr(e)?this._cfg=$i($i({},this._cfg),e):this._cfg[e]=t},e.prototype.getDefaultCfg=function(){return{}},e.prototype.clearCache=function(){this.set("bboxCache",null),this.set("bboxCanvasCache",null)},e.prototype.beforeDraw=function(){},e.prototype.afterDraw=function(){},e.prototype.afterUpdate=function(){},e.prototype.draw=function(){this.beforeDraw(),this.drawInner(),this.afterDraw()},e.prototype.getShapeStyleByName=function(e){var t,n=this.get("group");if(t=e?n.shapeMap[e]:this.getKeyShape()){var i={};return cr(t.attr(),(function(e,t){("img"!==t||xr(e))&&(i[t]=e)})),i}return{}},e.prototype.getShapeCfg=function(e,t){var n=this.get("styles");if(n){var i=e;return i.style=$i($i({},n),e.style),i}return e},e.prototype.getStateStyle=function(e){var t=this.get("styles");return t&&t[e]},e.prototype.getOriginStyle=function(){return this.get("originStyle")},e.prototype.getCurrentStatesStyle=function(){var e=this,t={},n=e.getStates();return n&&n.length?(cr(e.getStates(),(function(n){t=Object.assign(t,e.getStateStyle(n))})),t):this.get("originStyle")},e.prototype.setState=function(e,t){var n=this.get("states"),i=this.get("shapeFactory"),r=e,o=e;xr(t)&&(r="".concat(e,":").concat(t),o="".concat(e,":"));var s=n;if($r(t)){var a=n.indexOf(o);if(t){if(a>-1)return;n.push(r)}else a>-1&&n.splice(a,1)}else if(xr(t)){var l=n.filter((function(e){return e.includes(o)}));l.length>0&&this.clearStates(l),(s=s.filter((function(e){return!e.includes(o)}))).push(r),this.set("states",s)}if(i){var c=this.get("model").type;i.setState(c,e,t,this)}},e.prototype.clearStates=function(e){var t=this,n=t.getStates(),i=t.get("shapeFactory"),r=t.get("model").type;e||(e=n),xr(e)&&(e=[e]);var o=n.filter((function(t){return-1===e.indexOf(t)}));t.set("states",o),e.forEach((function(e){i.setState(r,e,!1,t)}))},e.prototype.getContainer=function(){return this.get("group")},e.prototype.getKeyShape=function(){return this.get("keyShape")},e.prototype.getModel=function(){return this.get("model")},e.prototype.getType=function(){return this.get("type")},e.prototype.getID=function(){return this.get("id")},e.prototype.isItem=function(){return!0},e.prototype.getStates=function(){return this.get("states")},e.prototype.hasState=function(e){return this.getStates().indexOf(e)>=0},e.prototype.refresh=function(e){var t=this.get("model");this.updatePosition(t),this.updateShape(e),this.afterUpdate(),this.clearCache()},e.prototype.getUpdateType=function(e){},e.prototype.update=function(e,t){void 0===t&&(t=void 0);var n=this.get("model");if("move"===t)this.updatePosition(e);else{var i=n.visible,r=e.visible;i!==r&&void 0!==r&&this.changeVisibility(r);var o={x:n.x,y:n.y};e.x=isNaN(+e.x)?n.x:+e.x,e.y=isNaN(+e.y)?n.y:+e.y;var s=this.get("styles");if(e.stateStyles)to(s,e.stateStyles),delete e.stateStyles;Object.assign(n,e),o.x===e.x&&o.y===e.y||this.updatePosition(e),this.updateShape(t)}this.afterUpdate(),this.clearCache()},e.prototype.updateShape=function(e){var t=this.get("shapeFactory"),n=this.get("model"),i=n.type;if(t.shouldUpdate(i)&&i===this.get("currentShape")){var r=this.getShapeCfg(n,e);t.baseUpdate(i,r,this,e),"move"!==e&&this.setOriginStyle()}else this.draw();this.restoreStates(t,i)},e.prototype.updatePosition=function(e){var t=this.get("model"),n=isNaN(+e.x)?+t.x:+e.x,i=isNaN(+e.y)?+t.y:+e.y,r=this.get("group");if(isNaN(n)||isNaN(i))return!1;t.x=n,t.y=i;var o=r.getMatrix();return(!o||o[6]!==n||o[7]!==i)&&(r.resetMatrix(),gl(r,{x:n,y:i}),this.clearCache(),!0)},e.prototype.getBBox=function(){var e=this.get("bboxCache");return e||(e=this.calculateBBox(),this.set("bboxCache",e)),e},e.prototype.getCanvasBBox=function(){var e=this.get("bboxCanvasCache");return e||(e=this.calculateCanvasBBox(),this.set("bboxCanvasCache",e)),e},e.prototype.toFront=function(){this.get("group").toFront()},e.prototype.toBack=function(){this.get("group").toBack()},e.prototype.show=function(){this.changeVisibility(!0)},e.prototype.hide=function(){this.changeVisibility(!1)},e.prototype.changeVisibility=function(e){var t=this.get("group");e?t.show():t.hide(),this.set("visible",e)},e.prototype.isVisible=function(){return this.get("visible")},e.prototype.enableCapture=function(e){var t=this.get("group");t&&t.set("capture",e)},e.prototype.destroy=function(){if(!this.destroyed){var e=this.get("animate"),t=this.get("group");e&&t.stopAnimate(),t.shapeMap={},this.clearCache(),t.remove(),this._cfg=null,this.destroyed=!0}},e}(),Cf={source:"start",target:"end"},Sf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultCfg=function(){return{type:"edge",sourceNode:null,targetNode:null,startPoint:null,endPoint:null,linkCenter:!1}},t.prototype.setEnd=function(e,t){var n=Cf[e]+"Point",i=e+"Node",r=this.get(i);r&&!r.destroyed&&r.removeEdge(this),fr(t)?(this.set(n,t),this.set(i,null)):t&&(t.addEdge(this),this.set(i,t),this.set(n,null))},t.prototype.getLinkPoint=function(e,t,n){var i=Cf[e]+"Point",r=e+"Node",o=this.get(i);if(!o){var s=this.get(r),a=e+"Anchor",l=this.getPrePoint(e,n),c=t[a];sr(c)||(o=s.getLinkPointByAnchor(c)),o=o||s.getLinkPoint(l),sr(o.index)||this.set("".concat(e,"AnchorIndex"),o.index)}return o},t.prototype.getPrePoint=function(e,t){if(t&&t.length)return t["source"===e?0:t.length-1];var n="source"===e?"target":"source";return this.getEndPoint(n)},t.prototype.getEndPoint=function(e){var t=e+"Node",n=Cf[e]+"Point",i=this.get(t);return i?i.get("model"):this.get(n)},t.prototype.getControlPointsByCenter=function(e){var t=this.getEndPoint("source"),n=this.getEndPoint("target"),i=this.get("shapeFactory"),r=e.type;return i.getControlPoints(r,{startPoint:t,endPoint:n})},t.prototype.getEndCenter=function(e){var t=e+"Node",n=Cf[e]+"Point",i=this.get(t);if(i){var r=i.getBBox();return{x:r.centerX,y:r.centerY}}return this.get(n)},t.prototype.init=function(){e.prototype.init.call(this),this.setSource(this.get("source")),this.setTarget(this.get("target"))},t.prototype.getShapeCfg=function(t,n){var i=this,r=i.get("linkCenter"),o=(null==n?void 0:n.includes("move"))?t:e.prototype.getShapeCfg.call(this,t);if(r)o.startPoint=i.getEndCenter("source"),o.endPoint=i.getEndCenter("target");else{var s=o.controlPoints||i.getControlPointsByCenter(o);o.startPoint=i.getLinkPoint("source",t,s),o.endPoint=i.getLinkPoint("target",t,s)}return o.sourceNode=i.get("sourceNode"),o.targetNode=i.get("targetNode"),o},t.prototype.getModel=function(){var e=this.get("model"),t=this.get("source".concat("Node")),n=this.get("target".concat("Node"));return t?delete e["source".concat("Node")]:e.source=this.get("start".concat("Point")),n?delete e["target".concat("Node")]:e.target=this.get("end".concat("Point")),xr(e.source)||fr(e.source)||(e.source=e.source.getID()),xr(e.target)||fr(e.target)||(e.target=e.target.getID()),e},t.prototype.setSource=function(e){this.setEnd("source",e),this.set("source",e)},t.prototype.setTarget=function(e){this.setEnd("target",e),this.set("target",e)},t.prototype.getSource=function(){return this.get("source")},t.prototype.getTarget=function(){return this.get("target")},t.prototype.updatePosition=function(){return!1},t.prototype.update=function(e,t){void 0===t&&(t=void 0);var n=this.get("model"),i=n.visible,r=e.visible;i!==r&&void 0!==r&&this.changeVisibility(r);var o=this.get("styles");e.stateStyles&&(to(o,e.stateStyles),delete e.stateStyles);Object.assign(n,e),this.updateShape(t),this.afterUpdate(),this.clearCache()},t.prototype.destroy=function(){var t=this.get("source".concat("Node")),n=this.get("target".concat("Node"));t&&!t.destroyed&&t.removeEdge(this),n&&!n.destroyed&&n.removeEdge(this),e.prototype.destroy.call(this)},t}(wf),xf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getNearestPoint=function(e,t){for(var n=0,i=e[0],r=fl(e[0],t),o=0;o<e.length;o++){var s=e[o],a=fl(s,t);a<r&&(i=s,r=a,n=o)}return i.anchorIndex=n,i},t.prototype.getDefaultCfg=function(){return{type:"node",edges:[]}},t.prototype.getEdges=function(){return this.get("edges")},t.prototype.getInEdges=function(){var e=this;return this.get("edges").filter((function(t){return t.get("target")===e}))},t.prototype.getOutEdges=function(){var e=this;return this.get("edges").filter((function(t){return t.get("source")===e}))},t.prototype.getNeighbors=function(e){var t=this,n=this.get("edges");if("target"===e){return n.filter((function(e){return e.getSource()===t})).map((function(e){return e.getTarget()}))}if("source"===e){return n.filter((function(e){return e.getTarget()===t})).map((function(e){return e.getSource()}))}return n.map((function(e){return e.getSource()===t?e.getTarget():e.getSource()}))},t.prototype.getLinkPointByAnchor=function(e){return this.getAnchorPoints()[e]},t.prototype.getLinkPoint=function(e){var t,n,i=this.get("keyShape").get("type"),r=this.get("type"),o=this.getBBox();"combo"===r?(t=o.centerX||(o.maxX+o.minX)/2,n=o.centerY||(o.maxY+o.minY)/2):(t=o.centerX,n=o.centerY);var s,a=this.getAnchorPoints();switch(i){case"circle":s=ll({x:t,y:n,r:o.width/2},e);break;case"ellipse":s=cl({x:t,y:n,rx:o.width/2,ry:o.height/2},e);break;default:s=al(o,e)}var l=s;return a.length&&(l||(l=e),l=this.getNearestPoint(a,l)),l||(l={x:t,y:n}),l},t.prototype.getAnchorPoints=function(){var e=this.get("anchorPointsCache");if(!e){e=[];var t=this.get("shapeFactory"),n=this.getBBox(),i=this.get("model"),r=this.getShapeCfg(i),o=i.type;cr(t.getAnchorPoints(o,r)||[],(function(t,i){var r={x:n.minX+t[0]*n.width,y:n.minY+t[1]*n.height,anchorIndex:i};e.push(r)})),this.set("anchorPointsCache",e)}return e},t.prototype.addEdge=function(e){this.get("edges").push(e)},t.prototype.lock=function(){this.set("locked",!0)},t.prototype.unlock=function(){this.set("locked",!1)},t.prototype.hasLocked=function(){return this.get("locked")},t.prototype.removeEdge=function(e){var t=this.getEdges(),n=t.indexOf(e);n>-1&&t.splice(n,1)},t.prototype.clearCache=function(){this.set("bboxCache",null),this.set("anchorPointsCache",null)},t.prototype.getUpdateType=function(e){var t,n,i,r,o;if(e){var s=!sr(e.x),a=!sr(e.y),l=Object.keys(e);return 1===l.length&&(s||a)||2===l.length&&s&&a?"move":Or(e.x)||Or(e.y)||e.type||e.anchorPoints||e.size||(null==e?void 0:e.style)&&((null===(t=null==e?void 0:e.style)||void 0===t?void 0:t.r)||(null===(n=null==e?void 0:e.style)||void 0===n?void 0:n.width)||(null===(i=null==e?void 0:e.style)||void 0===i?void 0:i.height)||(null===(r=null==e?void 0:e.style)||void 0===r?void 0:r.rx)||(null===(o=null==e?void 0:e.style)||void 0===o?void 0:o.ry))?"bbox|label":l.includes("label")||l.includes("labelCfg")?"style|label":"style"}},t}(wf),Ef=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultCfg=function(){return{type:"combo",nodes:[],edges:[],combos:[]}},t.prototype.getShapeCfg=function(e){var t=this.get("styles"),n=this.get("bbox");if(t&&n){var i=e,r={r:Math.hypot(n.height,n.width)/2||Fl.defaultCombo.size[0]/2,width:n.width||Fl.defaultCombo.size[0],height:n.height||Fl.defaultCombo.size[1]};i.style=$i($i($i({},t),e.style),r);var o=e.padding||Fl.defaultCombo.padding;return Or(o)?(r.r+=o,r.width+=2*o,r.height+=2*o):(r.r+=o[0],r.width+=o[1]+o[3]||2*o[1],r.height+=o[0]+o[2]||2*o[0]),this.set("sizeCache",r),i}return e},t.prototype.calculateCanvasBBox=function(){if(!this.destroyed){var e=this.get("keyShape"),t=this.get("group"),n=jl(e,t);n.centerX=(n.minX+n.maxX)/2,n.centerY=(n.minY+n.maxY)/2;var i=this.get("sizeCache"),r=this.get("bboxCache")||{},o=r.x,s=r.x;if(i)i.width=Math.max(i.width,n.width),i.height=Math.max(i.height,n.height),"circle"===e.get("type")?(n.width=2*i.r,n.height=2*i.r):(n.width=i.width,n.height=i.height),n.minX=n.centerX-n.width/2,n.minY=n.centerY-n.height/2,n.maxX=n.centerX+n.width/2,n.maxY=n.centerY+n.height/2;else n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n.centerX=(n.minX+n.maxX)/2,n.centerY=(n.minY+n.maxY)/2;return n.x=n.minX,n.y=n.minY,n.x===o&&n.y===s||this.set("anchorPointsCache",null),n}},t.prototype.getChildren=function(){return{nodes:this.getNodes(),combos:this.getCombos()}},t.prototype.getNodes=function(){return this.get("nodes")},t.prototype.getCombos=function(){return this.get("combos")},t.prototype.addChild=function(e){switch(e.getType()){case"node":this.addNode(e);break;case"combo":this.addCombo(e);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},t.prototype.addCombo=function(e){return this.get("combos").push(e),!0},t.prototype.addNode=function(e){return this.get("nodes").push(e),!0},t.prototype.removeChild=function(e){switch(e.getType()){case"node":this.removeNode(e);break;case"combo":this.removeCombo(e);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},t.prototype.removeCombo=function(e){if(e){var t=this.getCombos(),n=t.indexOf(e);return n>-1&&(t.splice(n,1),!0)}},t.prototype.removeNode=function(e){if(e){var t=this.getNodes(),n=t.indexOf(e);return n>-1&&(t.splice(n,1),!0)}},t.prototype.getUpdateType=function(e){},t.prototype.getBBox=function(){return this.set("bboxCanvasCache",null),this.calculateCanvasBBox()},t.prototype.clearCache=function(){this.set("bboxCache",null),this.set("bboxCanvasCache",null),this.set("anchorPointsCache",null)},t.prototype.destroy=function(){if(!this.destroyed){var e=this.get("animate"),t=this.get("group");e&&t.stopAnimate(),t.shapeMap={},this.clearCache(),this.set("sizeCache",null),this.set("bbox",null),t.remove(),this._cfg=null,this.destroyed=!0}},t}(xf),kf=function(){function e(e){var t=this;this.edgeToBeUpdateMap={},this.throttleRefresh=vo((function(e){var n,i=t.graph;if(i&&!i.get("destroyed")){var r=t.edgeToBeUpdateMap;r&&(null===(n=Object.keys(r))||void 0===n?void 0:n.length)&&(Object.keys(r).forEach((function(e){var t=r[e].edge;t&&!t.destroyed&&t.refresh(r[e].updateType)})),t.edgeToBeUpdateMap={})}}),16,{trailing:!0,leading:!0}),this.graph=e,this.destroyed=!1}return e.prototype.addItem=function(e,t){var n=this.graph,i="vedge"===e?"edge":e,r=n.get("".concat(i,"Group"))||n.get("group"),o=Gr(i),s=null,a=n.get(i+Gr("stateStyles"))||{},l=n.get("default"+o);t.stateStyles&&(a=t.stateStyles),l&&cr(l,(function(e,n){lr(e)&&!ar(e)?t[n]=so({},e,t[n]):ar(e)?t[n]=t[n]||no(l[n]):t[n]=t[n]||l[n]}));var c=n.get(i+"Mapper");if(c){var u=c(t);u.stateStyles&&(a=u.stateStyles,delete u.stateStyles),cr(u,(function(e,n){lr(e)&&!ar(e)?t[n]=so({},t[n],e):t[n]=u[n]||t[n]}))}if(n.emit("beforeadditem",{type:e,model:t}),"edge"===e||"vedge"===e){var h=void 0,d=void 0;if(h=t.source,d=t.target,h&&xr(h)&&(h=n.findById(h)),d&&xr(d)&&(d=n.findById(d)),!h||!d)return void console.warn("The source or target node of edge ".concat(t.id," does not exist!"));h.getType&&"combo"===h.getType()&&(t.isComboEdge=!0),d.getType&&"combo"===d.getType()&&(t.isComboEdge=!0),s=new Sf({model:t,source:h,target:d,styles:a,linkCenter:n.get("linkCenter"),group:r.addGroup()})}else if("node"===e)s=new xf({model:t,styles:a,group:r.addGroup()});else if("combo"===e){var f=t.children,g=tc(f,n);isNaN(g.x)?isNaN(t.x)&&(t.x=100*Math.random()):t.x=g.x,isNaN(g.y)?isNaN(t.y)&&(t.y=100*Math.random()):t.y=g.y;var p=r.addGroup();p.setZIndex(t.depth);var m=(s=new Ef({model:t,styles:a,bbox:t.collapsed?tc([],n):g,group:p})).getModel();(f||[]).forEach((function(e){var t=n.findById(e.id);s.addChild(t),e.depth=m.depth+2})),t.collapsed&&setTimeout((function(){s.destroyed||n.collapseCombo(s)}),0)}if(s)return n.get("".concat(e,"s")).push(s),n.get("itemMap")[s.get("id")]=s,n.emit("afteradditem",{item:s,model:t}),s},e.prototype.updateItem=function(e,t){var n,i,r=this,o=this.graph;if(xr(e)&&(e=o.findById(e)),e&&!e.destroyed){var s="";e.getType&&(s=e.getType());var a=o.get(s+"Mapper"),l=e.getModel(),c=e.getUpdateType(t);if(a){var u=a(so({},l,t)),h=so({},l,u,t);u.stateStyles&&(e.set("styles",h.stateStyles),delete h.stateStyles),cr(h,(function(e,n){t[n]=e}))}else cr(t,(function(e,n){l[n]&&lr(e)&&!ar(e)&&(t[n]=$i($i({},l[n]),t[n]))}));if(o.emit("beforeupdateitem",{item:e,cfg:t}),"edge"===s){if(t.source){var d=t.source;xr(d)&&(d=o.findById(d)),e.setSource(d)}if(t.target){var f=t.target;xr(f)&&(f=o.findById(f)),e.setTarget(f)}e.update(t)}if("node"===s||"combo"===s){e.update(t,c);var g=e.getEdges(),p=(null==c?void 0:c.includes("bbox"))||"move"===c;if("node"===s)"move"===c?cr(g,(function(e){r.edgeToBeUpdateMap[e.getID()]={edge:e,updateType:c},r.throttleRefresh()})):p&&cr(g,(function(e){e.refresh(c)}));else if(p&&"combo"===s){var m=e.get("shapeFactory"),v=l.type||"circle";(void 0===l.animate||void 0===t.animate?null===(i=null===(n=m[v])||void 0===n?void 0:n.options)||void 0===i?void 0:i.animate:l.animate||t.animate)?setTimeout((function(){if(e&&!e.destroyed){var t=e.getKeyShape();t&&!t.destroyed&&cr(g,(function(e){e&&!e.destroyed&&e.refresh()}))}}),201):cr(g,(function(e){e.refresh()}))}}o.emit("afterupdateitem",{item:e,cfg:t})}},e.prototype.updateCombo=function(e,t){var n,i,r=this,o=this.graph;if(xr(e)&&(e=o.findById(e)),e&&!e.destroyed){var s=e.getModel(),a=tc(t,o,e),l=a.x,c=a.y;e.set("bbox",a),e.update({x:l||s.x,y:c||s.y});var u=e.get("shapeFactory"),h=s.type||"circle";(void 0===s.animate?null===(i=null===(n=u[h])||void 0===n?void 0:n.options)||void 0===i?void 0:i.animate:s.animate)?setTimeout((function(){if(e&&!e.destroyed){var t=e.getKeyShape();t&&!t.destroyed&&(e.getShapeCfg(s),r.updateComboEdges(e))}}),201):this.updateComboEdges(e)}},e.prototype.updateComboEdges=function(e){for(var t=e.getEdges()||[],n=0;n<t.length;n++){var i=t[n];if(i&&!i.destroyed){var r=i.get("shapeFactory"),o=i.getShapeCfg(i.getModel()),s=i.getContainer();s.clear();var a=r.draw(o.type,o,s);i.set("keyShape",a),a.set("isKeyShape",!0),a.set("draggable",!0),i.setOriginStyle()}}},e.prototype.collapseCombo=function(e){var t=this.graph;xr(e)&&(e=t.findById(e));var n=e.getChildren();n.nodes.forEach((function(e){t.hideItem(e)})),n.combos.forEach((function(e){t.hideItem(e)}))},e.prototype.expandCombo=function(e){var t=this.graph;xr(e)&&(e=t.findById(e));var n=e.getChildren();n.nodes.forEach((function(e){t.showItem(e)})),n.combos.forEach((function(e){e.getModel().collapsed?e.show():t.showItem(e)}))},e.prototype.removeItem=function(e){var t=this,n=this.graph;if(xr(e)&&(e=n.findById(e)),e&&!e.destroyed){var i=no(e.getModel());n.emit("beforeremoveitem",{item:i});var r="";e.getType&&(r=e.getType());var o=n.get("".concat(r,"s")),s=o.indexOf(e);if(s>-1&&o.splice(s,1),"edge"===r){var a=n.get("v".concat(r,"s")),l=a.indexOf(e);l>-1&&a.splice(l,1)}var c=e.get("id");delete n.get("itemMap")[c];var u=n.get("comboTrees"),h=e.get("id");if("node"===r){var d=e.getModel().comboId;if(u&&d){var f=u,g=!1;u.forEach((function(e){g||Yl(e,(function(e){if(e.id===h&&f){var t=f.indexOf(e);return f.splice(t,1),g=!0,!1}return f=e.children,!0}))}))}for(var p=(_=e.getEdges()).length-1;p>=0;p--)n.removeItem(_[p],!1);d&&n.updateCombo(d)}else if("combo"===r){var m,v=e.getModel().parentId,y=!1;(u||[]).forEach((function(e){y||Yl(e,(function(e){return e.id!==h||(m=e,y=!0,!1)}))})),m.removed=!0,m&&m.children&&m.children.forEach((function(e){t.removeItem(e.id)}));var _;for(p=(_=e.getEdges()).length;p>=0;p--)n.removeItem(_[p],!1);v&&n.updateCombo(v)}e.destroy(),n.emit("afterremoveitem",{item:i,type:r})}},e.prototype.setItemState=function(e,t,n){var i=this.graph,r=t;xr(n)&&(r="".concat(t,":").concat(n)),e.hasState(r)===n&&n||xr(n)&&e.hasState(r)||(i.emit("beforeitemstatechange",{item:e,state:r,enabled:n}),e.setState(t,n),i.autoPaint(),i.emit("afteritemstatechange",{item:e,state:r,enabled:n}))},e.prototype.priorityState=function(e,t){var n=this.graph,i=e;xr(e)&&(i=n.findById(e)),this.setItemState(i,t,!1),this.setItemState(i,t,!0)},e.prototype.clearItemStates=function(e,t){var n=this.graph;xr(e)&&(e=n.findById(e)),n.emit("beforeitemstatesclear",{item:e,states:t}),e.clearStates(t),n.emit("afteritemstatesclear",{item:e,states:t})},e.prototype.refreshItem=function(e){var t=this.graph;xr(e)&&(e=t.findById(e)),t.emit("beforeitemrefresh",{item:e}),e.refresh(),t.emit("afteritemrefresh",{item:e})},e.prototype.addCombos=function(e,t){var n=this,i=this.graph;(e||[]).forEach((function(e){Xl(e,(function(e){var i;return t.forEach((function(t){t.id===e.id&&(t.children=e.children,t.depth=e.depth,i=t)})),i&&n.addItem("combo",i),!0}))}));var r=i.get("comboGroup");r&&r.sort()},e.prototype.changeItemVisibility=function(e,t){var n=this,i=this.graph;if(xr(e)&&(e=i.findById(e)),e){if(i.emit("beforeitemvisibilitychange",{item:e,visible:t}),e.changeVisibility(t),e.getType&&"node"===e.getType())cr(e.getEdges(),(function(e){(!t||e.get("source").isVisible()&&e.get("target").isVisible())&&n.changeItemVisibility(e,t)}));else if(e.getType&&"combo"===e.getType()){var r=i.get("comboTrees"),o=e.get("id"),s=[],a=!1;(r||[]).forEach((function(e){a||e.children&&0!==e.children.length&&Yl(e,(function(e){return e.id!==o||(s=e.children,a=!0,!1)}))})),s&&(!t||t&&!e.getModel().collapsed)&&s.forEach((function(e){var r=i.findById(e.id);n.changeItemVisibility(r,t)})),cr(e.getEdges(),(function(e){(!t||e.get("source").isVisible()&&e.get("target").isVisible())&&n.changeItemVisibility(e,t)}))}return i.emit("afteritemvisibilitychange",{item:e,visible:t}),e}console.warn("The item to be shown or hidden does not exist!")},e.prototype.destroy=function(){this.graph=null,this.destroyed=!0},e}(),Lf=null,Df=function(){function e(e){this.graph=e,this.cachedStates={enabled:{},disabled:{}},this.destroyed=!1}return e.checkCache=function(e,t,n){if(n[t]){var i=n[t].indexOf(e);i>=0&&n[t].splice(i,1)}},e.cacheState=function(e,t,n){n[t]||(n[t]=[]),n[t].push(e)},e.prototype.updateState=function(t,n,i){var r=this,o=e.checkCache,s=e.cacheState;if(!t.destroyed){var a=this.cachedStates,l=a.enabled,c=a.disabled;i?(o(t,n,c),s(t,n,l)):(o(t,n,l),s(t,n,c)),Lf&&clearTimeout(Lf),Lf=setTimeout((function(){Lf=null,r.updateGraphStates()}),16)}},e.prototype.updateStates=function(e,t,n){var i=this;xr(t)?this.updateState(e,t,n):t.forEach((function(t){i.updateState(e,t,n)}))},e.prototype.updateGraphStates=function(){var e=this.graph.get("states"),t=this.cachedStates;cr(t.disabled,(function(t,n){e[n]&&(e[n]=e[n].filter((function(e){return t.indexOf(e)<0&&!t.destroyed})))})),cr(t.enabled,(function(t,n){if(e[n]){var i={};e[n].forEach((function(e){e.destroyed||(i[e.get("id")]=!0)})),t.forEach((function(t){if(!t.destroyed){var r=t.get("id");i[r]||(i[r]=!0,e[n].push(t))}}))}else e[n]=t})),this.graph.emit("graphstatechange",{states:e}),this.cachedStates={enabled:{},disabled:{}}},e.prototype.destroy=function(){this.graph=null,this.cachedStates=null,Lf&&clearTimeout(Lf),Lf=null,this.destroyed=!0},e}(),Nf=function(e,t){return e&&t?e.replace(/\\?\{([^{}]+)\}/g,(function(e,n){if("\\"===e.charAt(0))return e.slice(1);var i=t[n];return 0===i&&(i="0"),i||""})):e},If=function(e){var t=[];if(e.length<2)throw new Error("point length must largn than 2, now it's ".concat(e.length));for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r.x,s=r.y;t.push(o),t.push(s)}var a=zd(t);return a.unshift(["M",e[0].x,e[0].y]),a},Tf=function(e,t,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r={x:(1-n)*e.x+n*t.x,y:(1-n)*e.y+n*t.y},o=[0,0];Rs(o,[t.x-e.x,t.y-e.y]),o&&(o[0]||o[1])||(o=[0,0]);var s=[-o[1]*i,o[0]*i];return r.x+=s[0],r.y+=s[1],r},Mf=function(e){var t=[];return e.forEach((function(e){if("A"!==e[0])for(var n=1;n<e.length;n+=2)t.push([e[n],e[n+1]]);else{var i=e.length;t.push([e[i-2],e[i-1]])}})),t},Af=function(e){if(e.length<2)throw new Error("point length must largn than 2, now it's ".concat(e.length));var t=e[0],n=e[1],i=e[e.length-1],r=e[e.length-2];e.unshift(i),e.unshift(r),e.push(t),e.push(n);for(var o=[],s=1;s<e.length-2;s+=1){var a=e[s-1].x,l=e[s-1].y,c=e[s].x,u=e[s].y,h=e[s+1].x,d=e[s+1].y,f=c+(h-a)/6,g=u+(d-l)/6,p=h-((s!==e.length-2?e[s+2].x:h)-c)/6,m=d-((s!==e.length-2?e[s+2].y:d)-u)/6;o.push(["C",f,g,p,m,h,d])}return o.unshift(["M",i.x,i.y]),o},Of=function(e,t){return As([0,0],Rs([0,0],e),t)},Rf=function(e,t){var n=[e[1]-t[1],t[0]-e[0]],i=Math.sqrt(n[0]*n[0]+n[1]*n[1]);if(0===i)throw new Error("p0 should not be equal to p1");return[n[0]/i,n[1]/i]},Pf=function(e,t){return[t[0]-e[0],t[1]-e[1]]};function Ff(e,t){var n,i,r;if(!e||e.length<1)return"";if(1===e.length)return i=[(n=e)[0][0],n[0][1]-t],r=[n[0][0],n[0][1]+t],"M ".concat(i," A ").concat(t,",").concat(t,",0,0,0,").concat(r," A ").concat(t,",").concat(t,",0,0,0,").concat(i);if(2===e.length)return function(e){var n=As([0,0],Rf(e[0],e[1]),t),i=As([0,0],n,-1),r=Is([0,0],e[0],n),o=Is([0,0],e[1],n),s=Is([0,0],e[1],i),a=Is([0,0],e[0],i);return"M ".concat(r," L ").concat(o," A ").concat([t,t,"0,0,0",s].join(",")," L ").concat(a," A ").concat([t,t,"0,0,0",r].join(","))}(e);for(var o=new Array(e.length),s=0;s<o.length;++s){var a=0===s?e[e.length-1]:e[s-1],l=e[s],c=As([0,0],Rf(a,l),t);o[s]=[Is([0,0],a,c),Is([0,0],l,c)]}var u="A ".concat([t,t,"0,0,0,"].join(","));return(o=o.map((function(e,t){var n="";return 0===t&&(n="M ".concat(o[o.length-1][1]," ")),n+="".concat(u+e[0]," L ").concat(e[1])}))).join(" ")}function Bf(e,t){var n,i,r,o=e.length;if(!e||o<1)return"";if(1===o)return i=[(n=e)[0][0],n[0][1]-t],r=[n[0][0],n[0][1]+t],"M ".concat(i," A ").concat([t,t,"0,0,0",r].join(",")," A ").concat([t,t,"0,0,0",i].join(","));if(2===o)return function(e){var n=Pf(e[0],e[1]),i=Of(n,t),r=Is([0,0],e[0],As([0,0],i,-1)),o=Is([0,0],e[1],i),s=1.2*t,a=Of(Rs([0,0],n),s),l=As([0,0],a,-1),c=Is([0,0],r,l),u=Is([0,0],o,l),h=Is([0,0],r,a);return"M ".concat(r," C ").concat([c,u,o].join(",")," S ").concat([h,r].join(",")," Z")}(e);for(var s=e.map((function(t,n){var i=e[(n+1)%o];return{p:t,v:Rs([0,0],Pf(t,i))}})),a=0;a<s.length;++a){var l=Rs([0,0],Is([0,0],s[a>0?a-1:o-1].v,As([0,0],s[a].v,-1)));s[a].p=Is([0,0],s[a].p,As([0,0],l,t))}return s.map((function(e){var t=e.p;return{x:t[0],y:t[1]}}))}var Wf=Object.freeze(Object.defineProperty({__proto__:null,getSpline:If,getControlPoint:Tf,pointsToPolygon:function(e,t){var n=e.length;if(!n)return"";for(var i="",r=0;r<n;r++){var o=e[r];i+=Nf(0===r?"M{x} {y}":"L{x} {y}",o)}return t&&(i+="Z"),i},pathToPoints:Mf,getClosedSpline:Af,roundedHull:Ff,paddedHull:Bf},Symbol.toStringTag,{value:"Module"})),zf=function(e,t,n){return(e.y-n.y)*(t.x-n.x)-(e.x-n.x)*(t.y-n.y)},Vf=function(e){var t=e.map((function(e){return{x:e.getModel().x,y:e.getModel().y}}));if(t.sort((function(e,t){return e.x===t.x?e.y-t.y:e.x-t.x})),1===t.length)return t;for(var n=[],i=0;i<t.length;i++){for(;n.length>=2&&zf(n[n.length-2],n[n.length-1],t[i])<=0;)n.pop();n.push(t[i])}var r=[];for(i=t.length-1;i>=0;i--){for(;r.length>=2&&zf(r[r.length-2],r[r.length-1],t[i])<=0;)r.pop();r.push(t[i])}return r.pop(),n.pop(),n.concat(r)},Uf={maxRoutingIterations:100,maxMarchingIterations:100,pixelGroupSize:2,edgeR0:10,edgeR1:10,nodeR0:5,nodeR1:10,morphBuffer:5,threshold:.001,skip:16,nodeInfluenceFactor:1,edgeInfluenceFactor:1,negativeNodeInfluenceFactor:-.5};function Hf(e,t,n){var i=!1,r=function(e,n){return t.cells[e+n*t.width]},o=function(e,t){var i=0;return r(e-1,t-1)>=n&&(i+=1),r(e,t-1)>n&&(i+=2),r(e-1,t)>n&&(i+=4),r(e,t)>n&&(i+=8),i},s=function(n,i){for(var r,s,a=n,l=i,c=0;c<t.width*t.height;c++){if(r=a,s=l,e.findIndex((function(e){return e.x===a&&e.y===l}))>-1){if(e[0].x===a&&e[0].y===l)return!0}else e.push({x:a,y:l});var u=o(a,l);switch(u){case-1:return console.warn("Marched out of bounds"),!0;case 0:case 3:case 2:case 7:a++;break;case 12:case 14:case 4:a--;break;case 6:0===r&&(-1===s?a-=1:a+=1);break;case 1:case 13:case 5:l--;break;case 9:1===r&&(0===s?l-=1:l+=1);break;case 10:case 8:case 11:l++;break;default:return console.warn("Marching squares invalid state: ".concat(u)),!0}}};this.march=function(){for(var e=0;e<t.width&&!i;e+=1)for(var a=0;a<t.height&&!i;a+=1)r(e,a)>n&&15!==o(e,a)&&(i=s(e,a));return i}}var jf=function(e,t){var n=Number.POSITIVE_INFINITY,i=null;return e.forEach((function(e){var r=xl(e,t);r>=0&&r<n&&(i=e,n=r)})),i};function Gf(e,t,n,i,r){var o=function(e,t,n){var i=null,r=Number.POSITIVE_INFINITY;return t.forEach((function(t){var o={x:e.getModel().x,y:e.getModel().y},s={x:t.getModel().x,y:t.getModel().y},a=kl(o,s),l=new bl(o.x,o.y,s.x,s.y),c=n.reduce((function(e,t){return xl(t,l)>0?e+1:e}),0);a*Math.pow(c+1,2)<r&&(i=t,r=a*Math.pow(c+1,2))})),i}(e,n,t);if(null===o)return[];return function(e){for(var n=[];e.length>0;){var i=e.pop();if(0===e.length){n.push(i);break}var r=e.pop(),o=new bl(i.x1,i.y1,r.x2,r.y2);jf(t,o)?(n.push(i),e.push(r)):e.push(o)}return n}(function(e,t,n,i){var r=[],o=[];o.push(e);for(var s=!0,a=0,l=function(e,t){var n=!1;return t.forEach((function(t){n||(Dl(e,{x:t.x1,y:t.y1})||Dl(e,{x:t.x2,y:t.y2}))&&(n=!0)})),n},c=function(e,t){for(var n=0,i=t;n<i.length;n++){var r=i[n].getBBox(),o=[[r.x,r.y],[r.x+r.width,r.y],[r.x,r.y+r.height],[r.x+r.width,r.y+r.height]];if(vl(o,e.x,e.y))return!0}return!1};s&&a<n;){s=!1;for(var u=function(){var e=o.pop(),n=jf(t,e);if(n){var u=Sl(n,e),h=u[0];if(2===u[1]){var d=function(a){for(var u=i,d=$f(n,u,h,a),f=l(d,o)||l(d,r),g=c(d,t);!f&&g&&u>=1;)d=$f(n,u/=1.5,h,a),f=l(d,o)||l(d,r),g=c(d,t);!d||f||a&&g||(o.push(new bl(e.x1,e.y1,d.x,d.y)),o.push(new bl(d.x,d.y,e.x2,e.y2)),s=!0)};d(!0),s||d(!1)}}s||r.push(e),a+=1};!s&&o.length;)u()}for(;o.length;)r.push(o.pop());return r}(new bl(e.getModel().x,e.getModel().y,o.getModel().x,o.getModel().y),t,i,r))}var Kf=function(e,t,n){var i=Object.assign(Uf,n),r=El(e.map((function(e){return{x:e.getModel().x,y:e.getModel().y}})));e=e.sort((function(e,t){return kl({x:e.getModel().x,y:e.getModel().y},r)-kl({x:t.getModel().x,y:t.getModel().y},r)}));var o=[],s=[];e.forEach((function(e){Gf(e,t,o,i.maxRoutingIterations,i.morphBuffer).forEach((function(e){s.push(e)})),o.push(e)}));for(var a,l,c,u,h,d=function(e,t,n){var i={minX:Number.POSITIVE_INFINITY,minY:Number.POSITIVE_INFINITY,maxX:Number.NEGATIVE_INFINITY,maxY:Number.NEGATIVE_INFINITY,width:0,height:0,x:0,y:0},r=[];e.forEach((function(e){r.push(e.getBBox())})),t.forEach((function(e){r.push(e.getBBox())}));for(var o=0,s=r;o<s.length;o++){var a=s[o];i.minX=(a.minX<i.minX?a.minX:i.minX)-n,i.minY=(a.minY<i.minY?a.minY:i.minY)-n,i.maxX=(a.maxX>i.maxX?a.maxX:i.maxX)+n,i.maxY=(a.maxY>i.maxY?a.maxY:i.maxY)+n}return i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.x=i.minX,i.y=i.minY,i}(e,s,i.nodeR0),f=(a=d.width,l=d.height,c=i.pixelGroupSize,u=Math.ceil(a/c),h=Math.ceil(l/c),{cells:new Float32Array(Math.max(0,u*h)).fill(0),width:u,height:h}),g=[],p=[],m=0;m<i.maxMarchingIterations;m++)if(qf(e,t,s,d,f,i),p=[],new Hf(g=[],f,i.threshold).march()){var v=g.map((function(e){return{x:Math.round(e.x*i.pixelGroupSize+d.minX),y:Math.round(e.y*i.pixelGroupSize+d.minY)}}));if(v){var y=v.length;if(i.skip>1)for(y=Math.floor(v.length/i.skip);y<3&&i.skip>1;)i.skip-=1,y=Math.floor(v.length/i.skip);for(var _=0,b=0;b<y;b+=1,_+=i.skip)p.push({x:v[_].x,y:v[_].y})}if(p&&function(){for(var t=0,n=e;t<n.length;t++){var i=n[t],r=p.map((function(e){return[e.x,e.y]}));if(!vl(r,i.getBBox().centerX,i.getBBox().centerY))return!1}return!0}())return p;if(i.threshold*=.9,m<=.5*i.maxMarchingIterations)i.memberInfluenceFactor*=1.2,i.edgeInfluenceFactor*=1.2;else{if(!(0!==i.nonMemberInfluenceFactor&&t.length>0))break;i.nonMemberInfluenceFactor*=.8}}return p};function qf(e,t,n,i,r,o){function s(e,t){var n=Math.floor((e-t)/o.pixelGroupSize);return n<0?0:n}function a(e,t){return e*o.pixelGroupSize+t}var l=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),c=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1),u=function(e,t){return[Math.min(s(e.minX,t+i.minX),r.width),Math.min(s(e.minY,t+i.minY),r.height),Math.min(s(e.maxX,-t+i.minX),r.width),Math.min(s(e.maxY,-t+i.minY),r.height)]},h=function(e,t){for(var n=e.getBBox(),s=u(n,o.nodeR1),l=s[0],c=s[1],h=s[2],d=s[3],f=c;f<d;f+=1)for(var g=l;g<h;g+=1)if(!(t<0&&r[g+f*r.width]<=0)){var p=a(g,i.minX),m=a(f,i.minY),v=Nl({x:p,y:m},{x:n.minX,y:n.minY,width:n.width,height:n.height});if(v<Math.pow(o.nodeR1,2)){var y=Math.sqrt(v)-o.nodeR1;r.cells[g+f*r.width]+=t*y*y}}};o.nodeInfluenceFactor&&e.forEach((function(e){h(e,o.nodeInfluenceFactor/l)})),o.edgeInfluenceFactor&&n.forEach((function(e){!function(e,t){for(var n=e.getBBox(),s=u(n,o.edgeR1),l=s[0],c=s[1],h=s[2],d=s[3],f=c;f<d;f+=1)for(var g=l;g<h;g+=1)if(!(t<0&&r.cells[g+f*r.width]<=0)){var p=a(g,i.minX),m=a(f,i.minY),v=Ll({x:p,y:m},e);if(v<Math.pow(o.edgeR1,2)){var y=Math.sqrt(v)-o.edgeR1;r.cells[g+f*r.width]+=t*y*y}}}(e,o.edgeInfluenceFactor/c)})),o.negativeNodeInfluenceFactor&&t.forEach((function(e){h(e,o.negativeNodeInfluenceFactor/l)}))}function $f(e,t,n,i){var r=e.getBBox(),o=n[0],s=n[1],a=n[2],l=n[3],c={topLeft:{x:r.minX-t,y:r.minY-t},topRight:{x:r.maxX+t,y:r.minY-t},bottomLeft:{x:r.minX-t,y:r.maxY+t},bottomRight:{x:r.maxX+t,y:r.maxY+t}},u=r.height*r.width;function h(e,t){return r.width*(.5*(e.y-r.minY+(t.y-r.minY)))}if(s)return o?i?c.topLeft:c.bottomRight:a?i?c.bottomLeft:c.topRight:h(s,l)<.5*u?s.y>l.y?i?c.topLeft:c.bottomRight:i?c.topRight:c.bottomLeft:s.y<l.y?i?c.bottomLeft:c.topRight:i?c.bottomRight:c.topLeft;if(l){if(o)return i?c.topRight:c.bottomLeft;if(a)return i?c.bottomRight:c.topLeft}return h(o,a)<.5*u?o.x>a.x?i?c.topLeft:c.bottomRight:i?c.bottomLeft:c.topRight:o.x<a.x?i?c.topRight:c.bottomLeft:i?c.bottomRight:c.topLeft}var Yf=function(){function e(e,t){this.cfg=so(this.getDefaultCfg(),t),this.graph=e,this.id=this.cfg.id,this.group=this.cfg.group,this.members=this.cfg.members.map((function(t){return xr(t)?e.findById(t):t})),this.nonMembers=this.cfg.nonMembers.map((function(t){return xr(t)?e.findById(t):t})),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()}return e.prototype.getDefaultCfg=function(){return{id:"g6-hull",type:"round-convex",members:[],nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10}},e.prototype.setPadding=function(){var e=this.members.length&&this.members[0].getKeyShape().getCanvasBBox().width/2;this.padding=this.cfg.padding>0?this.cfg.padding+e:10+e,this.cfg.bubbleCfg={nodeR0:this.padding-e,nodeR1:this.padding-e,morphBuffer:this.padding-e}},e.prototype.setType=function(){this.type=this.cfg.type,this.members.length<3&&(this.type="round-convex"),"round-convex"!==this.type&&"smooth-convex"!==this.type&&"bubble"!==this.type&&(console.warn("The hull type should be either round-convex, smooth-convex or bubble, round-convex is used by default."),this.type="round-convex")},e.prototype.calcPath=function(e,t){var n,i,r;switch(this.type){case"round-convex":i=jd(r=Ff((n=Vf(e)).map((function(e){return[e.x,e.y]})),this.padding));break;case"smooth-convex":2===(n=Vf(e)).length?i=jd(r=Ff(n.map((function(e){return[e.x,e.y]})),this.padding)):n.length>2&&(r=Bf(n.map((function(e){return[e.x,e.y]})),this.padding),i=Af(r));break;case"bubble":i=(n=Kf(e,t,this.cfg.bubbleCfg)).length>=2&&Af(n)}return i},e.prototype.render=function(){this.group.addShape("path",{attrs:$i({path:this.path},this.cfg.style),id:this.id,name:this.cfg.id,capture:!1}),this.group.toBack()},e.prototype.addMember=function(e){if(e){xr(e)&&(e=this.graph.findById(e)),this.members.push(e);var t=this.nonMembers.indexOf(e);return t>-1&&this.nonMembers.splice(t,1),this.updateData(this.members,this.nonMembers),!0}},e.prototype.addNonMember=function(e){if(e){xr(e)&&(e=this.graph.findById(e)),this.nonMembers.push(e);var t=this.members.indexOf(e);return t>-1&&this.members.splice(t,1),this.updateData(this.members,this.nonMembers),!0}},e.prototype.removeMember=function(e){if(e){xr(e)&&(e=this.graph.findById(e));var t=this.members.indexOf(e);return t>-1&&(this.members.splice(t,1),this.updateData(this.members,this.nonMembers),!0)}},e.prototype.removeNonMember=function(e){if(e){xr(e)&&(e=this.graph.findById(e));var t=this.nonMembers.indexOf(e);return t>-1&&(this.nonMembers.splice(t,1),this.updateData(this.members,this.nonMembers),!0)}},e.prototype.updateData=function(e,t){var n=this;this.group.findById(this.id).remove(),e&&(this.members=e.map((function(e){return xr(e)?n.graph.findById(e):e}))),t&&(this.nonMembers=t.map((function(e){return xr(e)?n.graph.findById(e):e}))),this.path=this.calcPath(this.members,this.nonMembers),this.render()},e.prototype.updateStyle=function(e){this.group.findById(this.id).attr($i({},e))},e.prototype.updateCfg=function(e){var t=this;this.cfg=so(this.cfg,e),this.id=this.cfg.id,this.group=this.cfg.group,e.members&&(this.members=this.cfg.members.map((function(e){return xr(e)?t.graph.findById(e):e}))),e.nonMembers&&(this.nonMembers=this.cfg.nonMembers.map((function(e){return xr(e)?t.graph.findById(e):e}))),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()},e.prototype.contain=function(e){var t,n,i=this,r=(t=xr(e)?this.graph.findById(e):e).getKeyShape();if("path"===t.get("type"))n=Mf(r.attr("path"));else{var o=r.getCanvasBBox();n=[[o.minX,o.minY],[o.maxX,o.minY],[o.maxX,o.maxY],[o.minX,o.maxY]]}return n=n.map((function(e){var t=i.graph.getPointByCanvas(e[0],e[1]);return[t.x,t.y]})),_l(n,Mf(this.path))},e.prototype.destroy=function(){this.group.remove(),this.cfg=null},e}(),Xf=Us,Zf=function(e){function t(t){var n=e.call(this)||this;return n.cfg=so(n.getDefaultCfg(),t),n.init(),n.animating=!1,n.destroyed=!1,n.cfg.enabledStack&&(n.undoStack=new el(n.cfg.maxStep),n.redoStack=new el(n.cfg.maxStep)),n}return qi(t,e),t.prototype.init=function(){this.initCanvas();var e=new cf(this),t=new oc(this),n=new kf(this),i=new Df(this);this.set({viewController:e,modeController:t,itemController:n,stateController:i}),this.initLayoutController(),this.initEventController(),this.initGroups(),this.initPlugins()},t.prototype.initGroups=function(){var e=this.get("canvas");if(e){var t=(e.get("el")||{}).id,n=void 0===t?"g6":t,i=e.addGroup({id:"".concat(n,"-root"),className:Fl.rootContainerClassName});if(this.get("groupByTypes")){var r=i.addGroup({id:"".concat(n,"-edge"),className:Fl.edgeContainerClassName}),o=i.addGroup({id:"".concat(n,"-node"),className:Fl.nodeContainerClassName}),s=i.addGroup({id:"".concat(n,"-combo"),className:Fl.comboContainerClassName});s.toBack(),this.set({nodeGroup:o,edgeGroup:r,comboGroup:s})}var a=i.addGroup({id:"".concat(n,"-delegate"),className:Fl.delegateContainerClassName});this.set({delegateGroup:a}),this.set("group",i)}},t.prototype.getDefaultCfg=function(){return{container:void 0,width:void 0,height:void 0,renderer:"canvas",modes:{},plugins:[],data:{},fitViewPadding:10,minZoom:.2,maxZoom:10,event:!0,groupByTypes:!0,directed:!1,autoPaint:!0,nodes:[],edges:[],combos:[],vedges:[],itemMap:{},linkCenter:!1,defaultNode:{},defaultEdge:{},nodeStateStyles:{},edgeStateStyles:{},states:{},animate:!1,animateCfg:{onFrame:void 0,duration:500,easing:"easeLinear"},callback:void 0,enabledStack:!1,maxStep:10,tooltips:[]}},t.prototype.set=function(e,t){return fr(e)?this.cfg=$i($i({},this.cfg),e):this.cfg[e]=t,"enabledStack"!==e||!t||this.undoStack||this.redoStack||(this.undoStack=new el(this.cfg.maxStep),this.redoStack=new el(this.cfg.maxStep)),this},t.prototype.get=function(e){var t;return null===(t=this.cfg)||void 0===t?void 0:t[e]},t.prototype.getGroup=function(){return this.get("group")},t.prototype.getContainer=function(){return this.get("container")},t.prototype.getMinZoom=function(){return this.get("minZoom")},t.prototype.setMinZoom=function(e){return this.set("minZoom",e)},t.prototype.getMaxZoom=function(){return this.get("maxZoom")},t.prototype.setMaxZoom=function(e){return this.set("maxZoom",e)},t.prototype.getWidth=function(){return this.get("width")},t.prototype.getHeight=function(){return this.get("height")},t.prototype.clearItemStates=function(e,t){xr(e)&&(e=this.findById(e));var n=this.get("itemController");t||(t=e.get("states")),n.clearItemStates(e,t),this.get("stateController").updateStates(e,t,!1)},t.prototype.node=function(e){"function"==typeof e&&this.set("nodeMapper",e)},t.prototype.edge=function(e){"function"==typeof e&&this.set("edgeMapper",e)},t.prototype.combo=function(e){"function"==typeof e&&this.set("comboMapper",e)},t.prototype.findById=function(e){return this.get("itemMap")[e]},t.prototype.find=function(e,t){var n;return cr(this.get("".concat(e,"s")),(function(e,i){if(t(e,i))return n=e})),n},t.prototype.findAll=function(e,t){var n=[];return cr(this.get("".concat(e,"s")),(function(e,i){t(e,i)&&n.push(e)})),n},t.prototype.findAllByState=function(e,t){return this.findAll(e,(function(e){return e.hasState(t)}))},t.prototype.getAnimateCfgWithCallback=function(e){var t,n=e.animateCfg,i=e.callback;if(n)if(t=no(n),n.callback){var r=n.callback;t.callback=function(){i(),r()}}else t.callback=i;else t={duration:500,callback:i};return t},t.prototype.translate=function(e,t,n,i){var r=this,o=this.get("group"),s=no(o.getMatrix());if(s||(s=[1,0,0,0,1,0,0,0,1]),n){var a=this.getAnimateCfgWithCallback({animateCfg:i,callback:function(){return r.emit("viewportchange",{action:"translate",matrix:o.getMatrix()})}});pl(o,{x:o.getCanvasBBox().x+e,y:o.getCanvasBBox().y+t},n,a||{duration:500,easing:"easeCubic"})}else s=Xf(s,[["t",e,t]]),o.setMatrix(s),this.emit("viewportchange",{action:"translate",matrix:s}),this.autoPaint()},t.prototype.moveTo=function(e,t,n,i){var r=this.get("group");pl(r,{x:e,y:t},n,i||{duration:500,easing:"easeCubic"}),this.emit("viewportchange",{action:"move",matrix:r.getMatrix()})},t.prototype.fitView=function(e,t){e&&this.set("fitViewPadding",e);var n=this.get("viewController");t?n.fitViewByRules(t):n.fitView(),this.autoPaint()},t.prototype.fitCenter=function(){this.get("viewController").fitCenter(),this.autoPaint()},t.prototype.addBehaviors=function(e,t){return this.get("modeController").manipulateBehaviors(e,t,!0),this},t.prototype.removeBehaviors=function(e,t){return this.get("modeController").manipulateBehaviors(e,t,!1),this},t.prototype.updateBehavior=function(e,t,n){return this.get("modeController").updateBehavior(e,t,n),this},t.prototype.zoom=function(e,t,n,i){var r=this,o=this.get("group"),s=no(o.getMatrix()),a=this.get("minZoom"),l=this.get("maxZoom");if(s||(s=[1,0,0,0,1,0,0,0,1]),s=Xf(s,t?[["t",-t.x,-t.y],["s",e,e],["t",t.x,t.y]]:[["s",e,e]]),a&&s[0]<a||l&&s[0]>l)return!1;if(n){var c=no(o.getMatrix());c||(c=[1,0,0,0,1,0,0,0,1]);var u=c[0],h=u*e,d=this.getAnimateCfgWithCallback({animateCfg:i,callback:function(){return r.emit("viewportchange",{action:"zoom",matrix:o.getMatrix()})}});o.animate((function(e){if(1===e)c=s;else{var n=Il(u,h,e)/c[0];c=Xf(c,t?[["t",-t.x,-t.y],["s",n,n],["t",t.x,t.y]]:[["s",n,n]])}return{matrix:c}}),d)}else o.setMatrix(s),this.emit("viewportchange",{action:"zoom",matrix:s}),this.autoPaint();return!0},t.prototype.zoomTo=function(e,t,n,i){var r=e/this.getZoom();return this.zoom(r,t,n,i)},t.prototype.focusItem=function(e,t,n){var i=this.get("viewController"),r=!1;t?r=!0:void 0===t&&(r=this.get("animate"));var o={};n?o=n:void 0===n&&(o=this.get("animateCfg")),i.focus(e,r,o),this.autoPaint()},t.prototype.autoPaint=function(){this.get("autoPaint")&&this.paint()},t.prototype.paint=function(){this.emit("beforepaint"),this.get("canvas").draw(),this.emit("afterpaint")},t.prototype.getPointByClient=function(e,t){return this.get("viewController").getPointByClient(e,t)},t.prototype.getClientByPoint=function(e,t){return this.get("viewController").getClientByPoint(e,t)},t.prototype.getPointByCanvas=function(e,t){return this.get("viewController").getPointByCanvas(e,t)},t.prototype.getCanvasByPoint=function(e,t){return this.get("viewController").getCanvasByPoint(e,t)},t.prototype.getGraphCenterPoint=function(){var e=this.get("group").getCanvasBBox();return{x:(e.minX+e.maxX)/2,y:(e.minY+e.maxY)/2}},t.prototype.getViewPortCenterPoint=function(){return this.getPointByCanvas(this.get("width")/2,this.get("height")/2)},t.prototype.showItem=function(e,t){void 0===t&&(t=!0);var n=this.get("itemController").changeItemVisibility(e,!0);if(t&&this.get("enabledStack")){var i=n.getID(),r={},o={};switch(n.getType()){case"node":r.nodes=[{id:i,visible:!1}],o.nodes=[{id:i,visible:!0}];break;case"edge":r.nodes=[{id:i,visible:!1}],o.edges=[{id:i,visible:!0}];break;case"combo":r.nodes=[{id:i,visible:!1}],o.combos=[{id:i,visible:!0}]}this.pushStack("visible",{before:r,after:o})}},t.prototype.hideItem=function(e,t){void 0===t&&(t=!0);var n=this.get("itemController").changeItemVisibility(e,!1);if(t&&this.get("enabledStack")){var i=n.getID(),r={},o={};switch(n.getType()){case"node":r.nodes=[{id:i,visible:!0}],o.nodes=[{id:i,visible:!1}];break;case"edge":r.nodes=[{id:i,visible:!0}],o.edges=[{id:i,visible:!1}];break;case"combo":r.nodes=[{id:i,visible:!0}],o.combos=[{id:i,visible:!1}]}this.pushStack("visible",{before:r,after:o})}},t.prototype.refreshItem=function(e){this.get("itemController").refreshItem(e)},t.prototype.setAutoPaint=function(e){this.set("autoPaint",e),this.get("canvas").set("autoDraw",e)},t.prototype.remove=function(e,t){void 0===t&&(t=!0),this.removeItem(e,t)},t.prototype.removeItem=function(e,t){void 0===t&&(t=!0);var n=e;if(xr(e)&&(n=this.findById(e)),!n&&xr(e))console.warn("The item to be removed does not exist!");else if(n){var i="";if(n.getType&&(i=n.getType()),t&&this.get("enabledStack")){var r=$i($i({},n.getModel()),{itemType:i}),o={};switch(i){case"node":o.nodes=[r],o.edges=[];for(var s=n.getEdges(),a=s.length-1;a>=0;a--)o.edges.push($i($i({},s[a].getModel()),{itemType:"edge"}));break;case"edge":o.edges=[r];break;case"combo":o.combos=[r]}this.pushStack("delete",{before:o,after:{}})}if("node"===i)n.getModel().comboId&&this.updateComboTree(n,void 0,!1);if(this.get("itemController").removeItem(n),"combo"===i){var l=ec(this.get("comboTrees"));this.set("comboTrees",l)}}},t.prototype.addItem=function(e,t,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0);var r=this.get("comboSorted");this.set("comboSorted",r&&!i);var o=this.get("itemController");if(!function(e,t){if("node"===e||"combo"===e){if(t.id&&!xr(t.id))return console.warn("G6 Warning Tips: missing 'id' property, or the 'id' %c".concat(t.id,"%c is not a string."),"font-size: 20px; color: red;",""),!1}else if(!("edge"!==e||t.source&&t.target))return console.warn("G6 Warning Tips: missing 'source' or 'target' for the edge."),!1;return!0}(e,t))return!1;if(!t.id||!this.findById(t.id)){var s,a=this.get("comboTrees");if(a||(a=[]),"combo"===e){var l=this.get("itemMap"),c=!1;if(a.forEach((function(n){c||Xl(n,(function(n){if(t.parentId===n.id){c=!0;var i=$i({id:t.id,depth:n.depth+2},t);n.children?n.children.push(i):n.children=[i],t.depth=i.depth,s=o.addItem(e,t)}var r=l[n.id];return c&&r&&r.getType&&"combo"===r.getType()&&o.updateCombo(r,n.children),!0}))})),!c){var u=$i({id:t.id,depth:0},t);t.depth=u.depth,a.push(u),s=o.addItem(e,t)}this.set("comboTrees",a)}else if("node"===e&&xr(t.comboId)&&a){var h;(h=this.findById(t.comboId))&&h.getType&&"combo"!==h.getType()&&console.warn("'".concat(t.comboId,"' is not a id of a combo in the graph, the node will be added without combo.")),s=o.addItem(e,t);var d=this.get("itemMap"),f=!1,g=!1;(a||[]).forEach((function(e){g||f||Xl(e,(function(e){if(e.id===t.id)return g=!0,!1;if(t.comboId===e.id&&!g){f=!0;var n=no(t);n.itemType="node",e.children?e.children.push(n):e.children=[n],n.depth=e.depth+1}return f&&d[e.id].getType&&"combo"===d[e.id].getType()&&o.updateCombo(d[e.id],e.children),!0}))}))}else s=o.addItem(e,t);if("node"===e&&t.comboId||"combo"===e&&t.parentId)(h=this.findById(t.comboId||t.parentId))&&h.getType&&"combo"===h.getType()&&h.addChild(s);var p=this.get("combos");if(p&&p.length>0&&this.sortCombos(),this.autoPaint(),n&&this.get("enabledStack")){var m=$i($i({},s.getModel()),{itemType:e}),v={};switch(e){case"node":v.nodes=[m];break;case"edge":v.edges=[m];break;case"combo":v.combos=[m]}this.pushStack("add",{before:{},after:v})}return s}console.warn("This item exists already. Be sure the id %c".concat(t.id,"%c is unique."),"font-size: 20px; color: red;","")},t.prototype.add=function(e,t,n,i){return void 0===n&&(n=!0),void 0===i&&(i=!0),this.addItem(e,t,n,i)},t.prototype.updateItem=function(e,t,n){var i=this;void 0===n&&(n=!0);var r,o=this.get("itemController");r=xr(e)?this.findById(e):e;var s=no(r.getModel()),a="";r.getType&&(a=r.getType());var l=Ji([],r.getStates(),!0);if("combo"===a&&cr(l,(function(e){return i.setItemState(r,e,!1)})),o.updateItem(r,t),"combo"===a&&cr(l,(function(e){return i.setItemState(r,e,!0)})),n&&this.get("enabledStack")){var c={nodes:[],edges:[],combos:[]},u={nodes:[],edges:[],combos:[]},h=$i({id:s.id},t);switch(a){case"node":c.nodes.push(s),u.nodes.push(h);break;case"edge":c.edges.push(s),u.edges.push(h);break;case"combo":c.combos.push(s),u.combos.push(h)}"node"===a&&c.nodes.push(s),this.pushStack("update",{before:c,after:u})}},t.prototype.update=function(e,t,n){void 0===n&&(n=!0),this.updateItem(e,t,n)},t.prototype.setItemState=function(e,t,n){xr(e)&&(e=this.findById(e)),this.get("itemController").setItemState(e,t,n);var i=this.get("stateController");xr(n)?i.updateState(e,"".concat(t,":").concat(n),!0):i.updateState(e,t,n)},t.prototype.priorityState=function(e,t){this.get("itemController").priorityState(e,t)},t.prototype.data=function(e){rc(e),this.set("data",e)},t.prototype.render=function(){var e=this;this.set("comboSorted",!1);var t=this.get("data");if(this.get("enabledStack")&&this.clearStack(),!t)throw new Error("data must be defined first");var n=t.nodes,i=void 0===n?[]:n,r=t.edges,o=void 0===r?[]:r,s=t.combos,a=void 0===s?[]:s;if(this.clear(!0),this.emit("beforerender"),cr(i,(function(t){e.add("node",t,!1,!1)})),a&&0!==a.length){var l=Jl(a,i);this.set("comboTrees",l),e.addCombos(a)}cr(o,(function(t){e.add("edge",t,!1,!1)}));var c=e.get("animate");(e.get("fitView")||e.get("fitCenter"))&&e.set("animate",!1);var u=e.get("layoutController");if(u){if(u.layout((function(){e.get("fitView")?e.fitView():e.get("fitCenter")&&e.fitCenter();e.autoPaint(),e.emit("afterrender"),(e.get("fitView")||e.get("fitCenter"))&&e.set("animate",c)})),this.destroyed)return}else e.get("fitView")&&e.fitView(),e.get("fitCenter")&&e.fitCenter(),e.emit("afterrender"),e.set("animate",c);this.get("groupByTypes")||(a&&0!==a.length?this.sortCombos():t.nodes&&t.edges&&t.nodes.length<t.edges.length?this.getNodes().forEach((function(e){e.toFront()})):this.getEdges().forEach((function(e){e.toBack()})));this.get("enabledStack")&&this.pushStack("render")},t.prototype.read=function(e){this.data(e),this.render()},t.prototype.diffItems=function(e,t,n){var i,r=this,o=this.get("itemMap");cr(n,(function(n){if(i=o[n.id]){if(r.get("animate")&&"node"===e){var s=i.getContainer().getMatrix();s||(s=[1,0,0,0,1,0,0,0,1]),i.set("originAttrs",{x:s[6],y:s[7]})}r.updateItem(i,n,!1)}else i=r.addItem(e,n,!1);i&&t["".concat(e,"s")].push(i)}))},t.prototype.changeData=function(e,t){void 0===t&&(t=!0);var n=this,i=e||n.get("data");if(!rc(i))return this;t&&this.get("enabledStack")&&this.pushStack("changedata",{before:n.save(),after:i}),this.set("comboSorted",!1),this.removeHulls(),this.getNodes().map((function(e){return n.clearItemStates(e)})),this.getEdges().map((function(e){return n.clearItemStates(e)}));var r=this.get("canvas"),o=r.get("localRefresh");r.set("localRefresh",!1),n.get("data")||(n.data(i),n.render());var s=this.get("itemMap"),a={nodes:[],edges:[]},l=i.combos;if(l){var c=Jl(l,i.nodes);this.set("comboTrees",c)}else this.set("comboTrees",[]);this.diffItems("node",a,i.nodes),cr(s,(function(e,t){s[t].getModel().depth=0,e.getType&&"edge"===e.getType()||(e.getType&&"combo"===e.getType()?(delete s[t],e.destroy()):a.nodes.indexOf(e)<0&&(delete s[t],n.remove(e,!1)))}));for(var u=this.getCombos(),h=u.length-1;h>=0;h--)u[h].destroyed&&u.splice(h,1);l&&(n.addCombos(l),this.get("groupByTypes")||this.sortCombos()),this.diffItems("edge",a,i.edges),cr(s,(function(e,t){(!e.getType||"node"!==e.getType()&&"combo"!==e.getType())&&a.edges.indexOf(e)<0&&(delete s[t],n.remove(e,!1))})),this.set({nodes:a.nodes,edges:a.edges});var d=this.get("layoutController");return d&&(d.changeData(),n.get("animate")&&!d.getLayoutType()?n.positionsAnimate():n.autoPaint()),setTimeout((function(){r.set("localRefresh",o)}),16),this},t.prototype.addCombos=function(e){var t=this.get("comboTrees");this.get("itemController").addCombos(t,e)},t.prototype.createCombo=function(e,t){var n=this;this.set("comboSorted",!1);var i,r="";if(e){if(xr(e))r=e,i={id:e};else{if(!(r=e.id))return void console.warn("Create combo failed. Please assign a unique string id for the adding combo.");i=e}var o=t.map((function(e){var t=n.findById(e),i=t.getModel(),o="";t.getType&&(o=t.getType());var s={id:t.getID(),itemType:o};return"combo"===o?(s.parentId=r,i.parentId=r):"node"===o&&(s.comboId=r,i.comboId=r),s}));i.children=o,this.addItem("combo",i,!1),this.set("comboSorted",!1);var s=this.get("comboTrees");(s||[]).forEach((function(e){Xl(e,(function(e){return e.id!==r||(e.itemType="combo",e.children=o,!1)}))})),s&&this.sortCombos()}},t.prototype.uncombo=function(e){var t,n=this,i=e;if(xr(e)&&(i=this.findById(e)),!i||i.getType&&"combo"!==i.getType())console.warn("The item is not a combo!");else{var r=i.getModel().parentId,o=this.get("comboTrees");o||(o=[]);var s,a=this.get("itemMap"),l=i.get("id"),c=[],u=this.get("combos"),h=this.findById(r);if(o.forEach((function(e){s||Xl(e,(function(e){var t;if(e.id===l){s=e,i.getEdges().forEach((function(e){n.removeItem(e,!1)}));var o=u.indexOf(i);u.splice(o,1),delete a[l],i.destroy(),n.emit("afterremoveitem",{item:i,type:"combo"})}return!r||!s||e.id!==r||(h.removeCombo(i),-1!==(o=(c=e.children).indexOf(s))&&c.splice(o,1),null===(t=s.children)||void 0===t||t.forEach((function(e){var t=n.findById(e.id),i=t.getModel();t.getType&&"combo"===t.getType()?(e.parentId=r,delete e.comboId,i.parentId=r,delete i.comboId):t.getType&&"node"===t.getType()&&(e.comboId=r,i.comboId=r),h.addChild(t),c.push(e)})),!1)}))})),!r&&s){var d=o.indexOf(s);o.splice(d,1),null===(t=s.children)||void 0===t||t.forEach((function(e){e.parentId=void 0;var t=n.findById(e.id).getModel();delete t.parentId,delete t.comboId,"node"!==e.itemType&&o.push(e)}))}}},t.prototype.updateCombos=function(){var e=this,t=this,n=this.get("comboTrees"),i=t.get("itemController"),r=t.get("itemMap");(n||[]).forEach((function(t){Xl(t,(function(t){if(!t)return!0;var n=r[t.id];if(n&&n.getType&&"combo"===n.getType()){var o=Ji([],n.getStates(),!0);cr(o,(function(t){return e.setItemState(n,t,!1)})),i.updateCombo(n,t.children),cr(o,(function(t){return e.setItemState(n,t,!0)}))}return!0}))})),t.sortCombos()},t.prototype.updateCombo=function(e){var t,n=this,i=e;if(xr(e)&&(i=this.findById(e)),!i||i.getType&&"combo"!==i.getType())console.warn("The item to be updated is not a combo!");else{t=i.get("id");var r=this.get("comboTrees"),o=this.get("itemController"),s=this.get("itemMap");(r||[]).forEach((function(e){Xl(e,(function(e){if(!e)return!0;var i=s[e.id];if(t===e.id&&i&&i.getType&&"combo"===i.getType()){var r=Ji([],i.getStates(),!0);cr(r,(function(e){i.getStateStyle(e)&&n.setItemState(i,e,!1)})),o.updateCombo(i,e.children),cr(r,(function(e){i.getStateStyle(e)&&n.setItemState(i,e,!0)})),t&&(t=e.parentId)}return!0}))}))}},t.prototype.updateComboTree=function(e,t,n){void 0===n&&(n=!0);var i;this.set("comboSorted",!1);var r,o=(i=xr(e)?this.findById(e):e).getModel(),s=o.comboId||o.parentId,a="";if(i.getType&&(a=i.getType()),t&&"combo"===a){var l,c=this.get("comboTrees"),u=!0;if((c||[]).forEach((function(e){l||Yl(e,(function(e){if(!l)return e.id===i.getID()&&(l=e),!0}))})),Yl(l,(function(e){return e.id!==t||(u=!1,!1)})),!u)return void console.warn("Failed to update the combo tree! The parentId points to a descendant of the combo!")}if(n&&this.get("enabledStack")){var h={},d={};"combo"===a?(h.combos=[{id:o.id,parentId:o.parentId}],d.combos=[{id:o.id,parentId:t}]):"node"===a&&(h.nodes=[{id:o.id,parentId:o.comboId}],d.nodes=[{id:o.id,parentId:t}]),this.pushStack("updateComboTree",{before:h,after:d})}if(o.parentId||o.comboId){var f=this.findById(o.parentId||o.comboId);f&&f.removeChild(i)}("combo"===a?o.parentId=t:"node"===a&&(o.comboId=t),t)&&((r=this.findById(t))&&r.addChild(i));s&&((r=this.findById(s))&&r.removeChild(i));var g=ec(this.get("comboTrees"),o.id,t);this.set("comboTrees",g),this.updateCombos()},t.prototype.save=function(){var e=[],t=[],n=[];return cr(this.get("nodes"),(function(t){e.push(t.getModel())})),cr(this.get("edges"),(function(e){t.push(e.getModel())})),cr(this.get("combos"),(function(e){n.push(e.getModel())})),{nodes:e,edges:t,combos:n}},t.prototype.changeSize=function(e,t){return this.get("viewController").changeSize(e,t),this},t.prototype.refresh=function(){var e=this;if(e.emit("beforegraphrefresh"),e.get("animate"))e.positionsAnimate();else{var t=e.get("nodes"),n=e.get("edges"),i=e.get("edges");cr(t,(function(e){e.refresh()})),cr(n,(function(e){e.refresh()})),cr(i,(function(e){e.refresh()}))}e.emit("aftergraphrefresh"),e.autoPaint()},t.prototype.getNodes=function(){return this.get("nodes")},t.prototype.getEdges=function(){return this.get("edges")},t.prototype.getCombos=function(){return this.get("combos")},t.prototype.getComboChildren=function(e){if(xr(e)&&(e=this.findById(e)),e&&(!e.getType||"combo"===e.getType()))return e.getChildren();console.warn("The combo does not exist!")},t.prototype.positionsAnimate=function(){var e=this;e.emit("beforeanimate");var t=e.get("animateCfg"),n=t.onFrame,i=e.getNodes(),r=i.map((function(e){var t=e.getModel();return{id:t.id,x:t.x,y:t.y}}));e.isAnimating()&&e.stopAnimate(),e.get("canvas").animate((function(t){cr(r,(function(i){var r=e.findById(i.id);if(r&&!r.destroyed){var o=r.get("originAttrs"),s=r.get("model");if(!o){var a=r.getContainer().getMatrix();a||(a=[1,0,0,0,1,0,0,0,1]),o={x:a[6],y:a[7]},r.set("originAttrs",o)}if(n){var l=n(r,t,i,o);r.set("model",Object.assign(s,l))}else s.x=o.x+(i.x-o.x)*t,s.y=o.y+(i.y-o.y)*t}})),e.refreshPositions()}),{duration:t.duration,easing:t.easing,callback:function(){cr(i,(function(e){e.set("originAttrs",null)})),t.callback&&t.callback(),e.emit("afteranimate"),e.animating=!1}})},t.prototype.refreshPositions=function(){var e=this;e.emit("beforegraphrefreshposition");var t,n=e.get("nodes"),i=e.get("edges"),r=e.get("vedges"),o=e.get("combos"),s={};cr(n,(function(e){t=e.getModel();var n=e.get("originAttrs");if(!n||t.x!==n.x||t.y!==n.y){var i=e.updatePosition({x:t.x,y:t.y});s[t.id]=i,t.comboId&&(s[t.comboId]=s[t.comboId]||i)}})),o&&0!==o.length&&e.updateCombos(),cr(i,(function(e){var t=e.getSource().getModel(),n=e.getTarget();if(!fr(n)){var i=n.getModel();(s[t.id]||s[i.id]||e.getModel().isComboEdge)&&e.refresh()}})),cr(r,(function(e){e.refresh()})),e.emit("aftergraphrefreshposition"),e.autoPaint()},t.prototype.stopAnimate=function(){this.get("canvas").stopAnimate()},t.prototype.isAnimating=function(){return this.animating},t.prototype.getZoom=function(){var e=this.get("group").getMatrix();return e?e[0]:1},t.prototype.getCurrentMode=function(){return this.get("modeController").getMode()},t.prototype.setMode=function(e){return this.get("modeController").setMode(e),this},t.prototype.clear=function(e){var t;return void 0===e&&(e=!1),null===(t=this.get("canvas"))||void 0===t||t.clear(),this.initGroups(),this.set({itemMap:{},nodes:[],edges:[],groups:[],combos:[],comboTrees:[]}),e||this.emit("afterrender"),this},t.prototype.updateLayout=function(e,t,n){var i=this,r=this.get("layoutController");if(xr(e)&&(e={type:e}),t){var o=n;o||(o="begin"===t?{x:0,y:0}:{x:this.getWidth()/2,y:this.getHeight()/2}),o=this.getPointByCanvas(o.x,o.y);var s=["force","gForce","fruchterman"];s.includes(e.type)||!e.type&&s.includes(null==r?void 0:r.layoutType)?e.center=[o.x,o.y]:this.once("afterlayout",(function(e){var n=i.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];o.x=o.x*n[0]+n[6],o.y=o.y*n[0]+n[7];var r=i.getGroup().getCanvasBBox(),s=r.minX,a=r.maxX,l=r.minY,c={x:(s+a)/2,y:(l+r.maxY)/2};"begin"===t&&(c.x=s,c.y=l),i.translate(o.x-c.x,o.y-c.y)}))}var a=this.get("layout"),l={};Object.assign(l,a,e),this.set("layout",l),r.isLayoutTypeSame(l)&&l.gpuEnabled===a.gpuEnabled?r.updateLayoutCfg(l):r.changeLayout(l)},t.prototype.destroyLayout=function(){this.get("layoutController").destroyLayout()},t.prototype.layout=function(){var e=this.get("layoutController"),t=this.get("layout");t&&e&&(t.workerEnabled?e.layout():e.layoutMethod?e.relayout(!0):e.layout())},t.prototype.collapseCombo=function(e){var t=this;if(xr(e)&&(e=this.findById(e)),e){this.emit("beforecollapseexpandcombo",{action:"expand",item:e});var n=e.getModel();this.get("itemController").collapseCombo(e),n.collapsed=!0;var i=this.getEdges().concat(this.get("vedges")),r=[],o=[],s=this.get("comboTrees"),a=!1;(s||[]).forEach((function(e){a||Yl(e,(function(e){if(a&&e.depth<=n.depth)return!1;if(n.id===e.id&&(a=!0),a){var i=t.findById(e.id);i&&i.getType&&"combo"===i.getType()&&(r=r.concat(i.getNodes()),o=o.concat(i.getCombos()))}return!0}))}));var l={},c=[];i.forEach((function(e){if(!e.isVisible()||e.getModel().isVEdge){var i=e.getSource(),s=e.getTarget();if((r.includes(i)||o.includes(i))&&!r.includes(s)&&!o.includes(s)||i.getModel().id===n.id){if((d=e.getModel()).isVEdge)return void t.removeItem(e,!1);for(var a=s.getModel();!s.isVisible();){if(!(s=t.findById(a.parentId||a.comboId))||!a.parentId&&!a.comboId)return;a=s.getModel()}var u=a.id;if(l["".concat(n.id,"-").concat(u)])return void(l["".concat(n.id,"-").concat(u)]+=d.size||1);var h=t.addItem("vedge",{source:n.id,target:u,isVEdge:!0},!1);l["".concat(n.id,"-").concat(u)]=d.size||1,c.push(h)}else if(!r.includes(i)&&!o.includes(i)&&(r.includes(s)||o.includes(s))||s.getModel().id===n.id){var d;if((d=e.getModel()).isVEdge)return void t.removeItem(e,!1);for(var f=i.getModel();!i.isVisible();){if(!(i=t.findById(f.parentId||f.comboId))||!f.parentId&&!f.comboId)return;f=i.getModel()}var g=f.id;if(l["".concat(g,"-").concat(n.id)])return void(l["".concat(g,"-").concat(n.id)]+=d.size||1);h=t.addItem("vedge",{target:n.id,source:g,isVEdge:!0},!1);l["".concat(g,"-").concat(n.id)]=d.size||1,c.push(h)}}})),c.forEach((function(e){var n=e.getModel();t.updateItem(e,{size:l["".concat(n.source,"-").concat(n.target)]},!1)})),this.emit("aftercollapseexpandcombo",{action:"collapse",item:e})}else console.warn("The combo to be collapsed does not exist!")},t.prototype.expandCombo=function(e){var t=this;if(xr(e)&&(e=this.findById(e)),!e||e.getType&&"combo"!==e.getType())console.warn("The combo to be collapsed does not exist!");else{this.emit("beforecollapseexpandcombo",{action:"expand",item:e});var n=e.getModel();this.get("itemController").expandCombo(e),n.collapsed=!1;var i=this.getEdges().concat(this.get("vedges")),r=[],o=[],s=this.get("comboTrees"),a=!1;(s||[]).forEach((function(e){a||Yl(e,(function(e){if(a&&e.depth<=n.depth)return!1;if(n.id===e.id&&(a=!0),a){var i=t.findById(e.id);i&&i.getType&&"combo"===i.getType()&&(r=r.concat(i.getNodes()),o=o.concat(i.getCombos()))}return!0}))}));var l={},c={};i.forEach((function(e){if(!e.isVisible()||e.getModel().isVEdge){var i=e.getSource(),s=e.getTarget(),a=i.get("id"),u=s.get("id");if((r.includes(i)||o.includes(i))&&!r.includes(s)&&!o.includes(s)||a===n.id){if(e.getModel().isVEdge)return void t.removeItem(e,!1);for(var h=s.getModel();!s.isVisible();){if(!(s=t.findById(h.comboId||h.parentId))||!h.parentId&&!h.comboId)return;h=s.getModel()}u=h.id;for(var d=i.getModel();!i.isVisible();){if(!(i=t.findById(d.comboId||d.parentId))||!d.parentId&&!d.comboId)return;if(d.comboId===n.id||d.parentId===n.id)break;d=i.getModel()}if(a=d.id,u){var f="".concat(a,"-").concat(u);if(l[f])return l[f]+=e.getModel().size||1,void t.updateItem(c[f],{size:l[f]},!1);var g=t.addItem("vedge",{source:a,target:u,isVEdge:!0},!1);l[f]=e.getModel().size||1,c[f]=g}}else if(!r.includes(i)&&!o.includes(i)&&(r.includes(s)||o.includes(s))||u===n.id){if(e.getModel().isVEdge)return void t.removeItem(e,!1);for(d=i.getModel();!i.isVisible();){if(!(i=t.findById(d.comboId||d.parentId))||!d.parentId&&!d.comboId)return;d=i.getModel()}a=d.id;for(h=s.getModel();!s.isVisible();){if(!(s=t.findById(h.comboId||h.parentId))||!h.parentId&&!h.comboId)return;if(h.comboId===n.id||h.parentId===n.id)break;h=s.getModel()}if(u=h.id,a){f="".concat(a,"-").concat(u);if(l[f])return l[f]+=e.getModel().size||1,void t.updateItem(c[f],{size:l[f]},!1);g=t.addItem("vedge",{target:u,source:a,isVEdge:!0},!1);l[f]=e.getModel().size||1,c[f]=g}}else(r.includes(i)||o.includes(i))&&(r.includes(s)||o.includes(s))&&i.isVisible()&&s.isVisible()&&e.show()}})),this.emit("aftercollapseexpandcombo",{action:"expand",item:e})}},t.prototype.collapseExpandCombo=function(e){if(xr(e)&&(e=this.findById(e)),e&&(!e.getType||"combo"===e.getType())){for(var t=e.getModel(),n=this.findById(t.parentId);n;){var i=n.getModel();if(i.collapsed)return console.warn("Fail to expand the combo since it's ancestor combo is collapsed."),void(n=void 0);n=this.findById(i.parentId)}t.collapsed?this.expandCombo(e):this.collapseCombo(e),this.updateCombo(e)}},t.prototype.sortCombos=function(){var e=this;if(!this.get("comboSorted")){this.set("comboSorted",!0);var t=[],n={};(this.get("comboTrees")||[]).forEach((function(e){Yl(e,(function(e){return t[e.depth]?t[e.depth].push(e.id):t[e.depth]=[e.id],n[e.id]=e.depth,!0}))})),(this.getEdges().concat(this.get("vedges"))||[]).forEach((function(e){var i=e.getModel(),r=n[i.source]||0,o=n[i.target]||0,s=Math.max(r,o);t[s]?t[s].push(i.id):t[s]=[i.id]})),t.forEach((function(t){if(t&&t.length)for(var n=t.length-1;n>=0;n--){var i=e.findById(t[n]);i&&i.toFront()}}))}},t.prototype.getNeighbors=function(e,t){var n=e;return xr(e)&&(n=this.findById(e)),n.getNeighbors(t)},t.prototype.getNodeDegree=function(e,t,n){void 0===t&&(t=void 0),void 0===n&&(n=!1);var i=e;xr(e)&&(i=this.findById(e));var r=this.get("degrees");r&&!n||(r=ea(this.save()),this.set("degrees",r));var o=r[i.getID()],s=0;if(!o)return 0;switch(t){case"in":s=o.inDegree;break;case"out":s=o.outDegree;break;case"all":s=o;break;default:s=o.degree}return s},t.prototype.getUndoStack=function(){return this.undoStack},t.prototype.getRedoStack=function(){return this.redoStack},t.prototype.getStackData=function(){return this.get("enabledStack")?{undoStack:this.undoStack.toArray(),redoStack:this.redoStack.toArray()}:null},t.prototype.clearStack=function(){this.get("enabledStack")&&(this.undoStack.clear(),this.redoStack.clear())},t.prototype.pushStack=function(e,t,n){if(void 0===e&&(e="update"),void 0===n&&(n="undo"),this.get("enabledStack")){var i=t?no(t):{before:{},after:no(this.save())};"redo"===n?this.redoStack.push({action:e,data:i}):this.undoStack.push({action:e,data:i}),this.emit("stackchange",{undoStack:this.undoStack,redoStack:this.redoStack})}else console.warn("请先启用 undo & redo 功能，在实例化 Graph 时候配置 enabledStack: true !")},t.prototype.getAdjMatrix=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=this.get("directed"));var n=this.get("adjMatrix");return n&&e||(n=Hs(this.save(),t),this.set("adjMatrix",n)),n},t.prototype.getShortestPathMatrix=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=this.get("directed"));var n=this.get("adjMatrix"),i=this.get("shortestPathMatrix");return n&&e||(n=Hs(this.save(),t),this.set("adjMatrix",n)),i&&e||(i=ga(this.save(),t),this.set("shortestPathMatrix",i)),i},t.prototype.on=function(t,n,i){return e.prototype.on.call(this,t,n,i)},t.prototype.destroy=function(){var e,t,n,i,r;this.clear(),this.clearStack(),null===(e=this.get("itemController"))||void 0===e||e.destroy(),null===(t=this.get("modeController"))||void 0===t||t.destroy(),null===(n=this.get("viewController"))||void 0===n||n.destroy(),null===(i=this.get("stateController"))||void 0===i||i.destroy(),null===(r=this.get("canvas"))||void 0===r||r.destroy(),this.cfg=null,this.destroyed=!0,this.redoStack=null,this.undoStack=null},t.prototype.createHull=function(e){if(e.members&&!(e.members.length<1)){var t=this.get("hullGroup"),n=this.get("hullMap");if(n||(n={},this.set("hullMap",n)),t&&!t.get("destroyed")||((t=this.get("group").addGroup({id:"hullGroup"})).toBack(),this.set("hullGroup",t)),n[e.id])return console.warn("Existed hull id."),n[e.id];var i=t.addGroup({id:"".concat(e.id,"-container")}),r=new Yf(this,$i($i({},e),{group:i}));return n[r.id]=r,r}console.warn("Create hull failed! The members is empty.")},t.prototype.getHulls=function(){return this.get("hullMap")},t.prototype.getHullById=function(e){return this.get("hullMap")[e]},t.prototype.removeHull=function(e){var t,n;n=xr(e)?this.getHullById(e):e,null===(t=this.get("hullMap"))||void 0===t||delete t[n.id],n.destroy()},t.prototype.removeHulls=function(){var e=this.getHulls();e&&Object.keys(e).length&&(Object.keys(e).forEach((function(t){e[t].destroy()})),this.set("hullMap",{}))},t}(Do);function Qf(e){return(Qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Jf=Us,eg=["startArrow","endArrow"],tg={lineWidth:1,stroke:void 0,fill:void 0,lineAppendWidth:1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,x:0,y:0,r:10,width:20,height:20,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},ng={edge:{lineWidth:1,stroke:"#000",lineDash:void 0,startArrow:!1,endArrow:!1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},node:tg,combo:tg},ig={options:{labelCfg:{style:{fontFamily:Fl.windowFontFamily}},descriptionCfg:{style:{fontFamily:Fl.windowFontFamily}}},itemType:"",type:"",getCustomConfig:function(e){return{}},getOptions:function(e,t){return"move"===t||(null==t?void 0:t.includes("bbox"))?{}:so({},this.options,this.getCustomConfig(e)||{},e)},draw:function(e,t){t.shapeMap={},this.mergeStyle=this.getOptions(e);var n=this.drawShape(e,t);if(n.set("className",this.itemType+"-shape"),t.shapeMap[this.itemType+"-shape"]=n,e.label){var i=this.drawLabel(e,t);i.set("className",this.itemType+"-label"),t.shapeMap[this.itemType+"-label"]=i}return n},afterDraw:function(e,t,n){},drawShape:function(e,t){return null},drawLabel:function(e,t){var n=(this.mergeStyle||this.getOptions(e)||{}).labelCfg||{},i=this.getLabelStyle(e,n,t),r=i.rotate;delete i.rotate;var o=t.addShape("text",{attrs:i,draggable:!0,className:"text-shape",name:"text-shape",labelRelated:!0});if(t.shapeMap["text-shape"]=o,!isNaN(r)&&""!==r){var s=o.getBBox(),a=[1,0,0,0,1,0,0,0,1];if(i.rotateCenter)switch(i.rotateCenter){case"center":a=Jf(a,[["t",-s.width/2,-s.height/2],["r",r],["t",s.width/2,s.height/2]]);break;case"lefttop":a=Jf(a,[["t",-i.x,-i.y],["r",r],["t",i.x,i.y]]);break;case"leftcenter":a=Jf(a,[["t",-i.x,-i.y-s.height/2],["r",r],["t",i.x,i.y+s.height/2]]);break;default:a=Jf(a,[["t",-s.width/2,-s.height/2],["r",r],["t",s.width/2,s.height/2]])}else a=Jf(a,[["t",-i.x,-i.y-s.height/2],["r",r],["t",i.x,i.y+s.height/2]]);o.setMatrix(a)}if(i.background){var l=this.drawLabelBg(e,t,o),c=this.itemType+"-label-bg";l.set("classname",c),t.shapeMap[c]=l,o.toFront()}return o},drawLabelBg:function(e,t,n){var i=to({},this.options.labelCfg,e.labelCfg),r=this.getLabelBgStyleByPosition(n,i),o=t.addShape("rect",{name:"text-bg-shape",attrs:r,labelRelated:!0});return t.shapeMap["text-bg-shape"]=o,o},getLabelStyleByPosition:function(e,t,n){return{text:e.label}},getLabelBgStyleByPosition:function(e,t){return{}},getLabelStyle:function(e,t,n){var i=this.getLabelStyleByPosition(e,t,n),r="".concat(this.itemType,"Label"),o=Fl[r]?Fl[r].style:null;return $i($i($i({},o),i),t.style)},getShapeStyle:function(e){return e.style},update:function(e,t,n){this.updateShapeStyle(e,t,n),this.updateLabel(e,t,n)},updateShapeStyle:function(e,t,n){var i,r=t.getContainer(),o=t.getKeyShape(),s=to({},o.attr(),e.style),a=function(e){var t,n=s[e];if(fr(n)){var a=(null===(i=r.shapeMap)||void 0===i?void 0:i[e])||r.find((function(t){return t.get("name")===e}));null==a||a.attr(n)}else o.attr(((t={})[e]=n,t))};for(var l in s)a(l)},updateLabel:function(e,t,n){var i,r;if(e.label||""===e.label){var o=t.getContainer(),s=(this.mergeStyle||this.getOptions({},n)||{}).labelCfg,a=void 0===s?{}:s,l=this.itemType+"-label",c=o.shapeMap[l]||o.find((function(e){return e.get("className")===l})),u=this.itemType+"-label-bg",h=o.shapeMap[u]||o.find((function(e){return e.get("className")===u}));if(c){(!n||"bbox|label"===n||"edge"===this.itemType&&"style"!==n)&&(a=so(a,e.labelCfg));var d=this.getLabelStyleByPosition(e,a,o),f=null===(i=e.labelCfg)||void 0===i?void 0:i.style,g=$i($i({},d),f),p=g.rotate;if(delete g.rotate,isNaN(p)||""===p)1!==(null===(r=c.getMatrix())||void 0===r?void 0:r[4])&&c.resetMatrix(),c.attr(g);else{var m=[1,0,0,0,1,0,0,0,1];m=Jf(m,[["t",-g.x,-g.y],["r",p],["t",g.x,g.y]]),g.matrix=m,c.attr(g)}if(h)if(g.background){var v=this.getLabelBgStyleByPosition(c,a);h.attr(v)}else o.removeChild(h);else g.background&&((h=this.drawLabelBg(e,o,c)).set("classname",u),o.shapeMap[u]=h,c.toFront())}else{var y=this.drawLabel(e,o);y.set("className",l),o.shapeMap[l]=y}}},afterUpdate:function(e,t){},setState:function(e,t,n){var i,r,o,s=n.get("keyShape");if(s&&!s.destroyed){var a=n.getType(),l=$r(t)?e:"".concat(e,":").concat(t),c=this.getStateStyle(l,n),u=n.getStateStyle(l);if(u||c){var h=to({},u||c),d=n.getContainer(),f={x:1,y:1,cx:1,cy:1,matrix:1};if("combo"===a&&(f.r=1,f.width=1,f.height=1),t){var g=function(e){var t,n=h[e];if(fr(n)&&!eg.includes(e)){var i=(null===(o=d.shapeMap)||void 0===o?void 0:o[e])||d.find((function(t){return t.get("name")===e}));null==i||i.attr(n)}else s.attr(((t={})[e]=n,t))};for(var p in h)g(p)}else{var m=nc(n.getCurrentStatesStyle()),v=to({},n.getModel().style,nc(n.getOriginStyle())),y=s.get("name"),_=s.attr(),b={};Object.keys(_).forEach((function(e){if("img"!==e){var t=_[e];t&&"object"===Qf(t)?b[e]=no(t):b[e]=t}}));var w={},C=function(e){var t=h[e];if(fr(t)&&!eg.includes(e)){var n=d.shapeMap[e]||d.find((function(t){return t.get("name")===e}));if(n){var i=nc(n.attr());cr(t,(function(t,r){if(e===y&&b[r]&&!f[r]){delete b[r];var o=v[e][r]||ng[a][r];s.attr(r,o)}else if(i[r]||0===i[r]){delete i[r];var l=v[e][r]||ng[a][r];n.attr(r,l)}})),w[e]=i}}else if(b[e]&&!f[e]){delete b[e];var r=v[e]||(v[y]?v[y][e]:void 0)||ng[a][e];s.attr(e,r)}};for(var S in h)C(S);for(var p in y?w[y]=b:to(w,b),m)if(!f[p]){var x=m[p];fr(x)&&!eg.includes(p)||(y?(to(v[y],((r={})[p]=x,r)),delete v[p]):to(v,((i={})[p]=x,i)),delete m[p])}var E={};so(E,v,w,m);var k=!1,L=function(e){var t,n,i=E[e];if(fr(i)&&!eg.includes(e)){var r=d.shapeMap[e]||d.find((function(t){return t.get("name")===e}));r&&(("text"===r.get("type")||r.get("labelRelated"))&&(delete i.x,delete i.y,delete i.matrix),e===y&&("combo"===a&&(delete i.r,delete i.width,delete i.height),k=!0),r.attr(i))}else if(!k){var o=i||ng[a][e];"combo"===a?y||s.attr(((t={})[e]=o,t)):s.attr(((n={})[e]=o,n))}};for(var D in E)L(D)}}}},getStateStyle:function(e,t){var n=t.getModel(),i=t.getType(),r=this.getOptions(n),o=r.stateStyles,s=r.style,a=void 0===s?{}:s,l=n.stateStyles?n.stateStyles[e]:o&&o[e];return"combo"===i?no(l):to({},a,l)},getControlPoints:function(e){return e.controlPoints},getAnchorPoints:function(e){var t,n;return(null==e?void 0:e.anchorPoints)||(null===(t=this.getCustomConfig(e))||void 0===t?void 0:t.anchorPoints)||(null===(n=this.options)||void 0===n?void 0:n.anchorPoints)}},rg={itemType:"node",shapeType:"single-node",labelPosition:"center",offset:Fl.nodeLabel.offset,getSize:function(e){var t,n=(null===(t=this.mergeStyle)||void 0===t?void 0:t.size)||e.size||this.getOptions({}).size||Fl.defaultNode.size;return ar(n)&&1===n.length&&(n=[n[0],n[0]]),ar(n)||(n=[n,n]),n},getLabelStyleByPosition:function(e,t){var n=t.position||this.labelPosition;if("center"===n)return{x:0,y:0,text:e.label};var i=t.offset;sr(i)&&(i=this.offset);var r,o=this.getSize(e);switch(n){case"top":r={x:0,y:-o[1]/2-i,textBaseline:"bottom"};break;case"bottom":r={x:0,y:o[1]/2+i,textBaseline:"top"};break;case"left":r={x:-o[0]/2-i,y:0,textAlign:"right"};break;default:r={x:o[0]/2+i,y:0,textAlign:"left"}}return r.text=e.label,r},getLabelBgStyleByPosition:function(e,t){var n;if(!e)return{};var i=null===(n=t.style)||void 0===n?void 0:n.background;if(!i)return{};var r=e.getBBox(),o=of(i.padding),s=r.width+o[1]+o[3],a=r.height+o[0]+o[2];return $i($i({x:r.minX-o[3],y:r.minY-o[0]},i),{width:s,height:a})},drawShape:function(e,t){var n=this.shapeType,i=this.getShapeStyle(e),r=t.addShape(n,{attrs:i,draggable:!0,name:"node-shape"});return t.shapeMap["node-shape"]=r,r},updateLinkPoints:function(e,t){var n,i=(this.mergeStyle||this.getOptions(e)).linkPoints,r=t.shapeMap["link-point-left"]||t.find((function(e){return"link-point-left"===e.get("className")})),o=t.shapeMap["link-point-right"]||t.find((function(e){return"link-point-right"===e.get("className")})),s=t.shapeMap["link-point-top"]||t.find((function(e){return"link-point-top"===e.get("className")})),a=t.shapeMap["link-point-bottom"]||t.find((function(e){return"link-point-bottom"===e.get("className")}));r&&(n=r.attr()),o&&!n&&(n=o.attr()),s&&!n&&(n=s.attr()),a&&!n&&(n=a.attr()),n||(n=i);var l=to({},n,e.linkPoints),c=l.fill,u=l.stroke,h=l.lineWidth,d=l.size/2;d||(d=l.r);var f=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},g=f.left,p=f.right,m=f.top,v=f.bottom,y=this.getSize(e),_=y[0],b=y[1],w={r:d,fill:c,stroke:u,lineWidth:h};if(r)g||void 0===g?r.attr($i($i({},w),{x:-_/2,y:0})):(r.remove(),delete t.shapeMap["link-point-left"]);else if(g){var C="link-point-left";t.shapeMap[C]=t.addShape("circle",{attrs:$i($i({},w),{x:-_/2,y:0}),className:C,name:C,isAnchorPoint:!0})}if(o)p||void 0===p||(o.remove(),delete t.shapeMap["link-point-right"]),o.attr($i($i({},w),{x:_/2,y:0}));else if(p){var S="link-point-right";t.shapeMap[S]=t.addShape("circle",{attrs:$i($i({},w),{x:_/2,y:0}),className:S,name:S,isAnchorPoint:!0})}if(s)m||void 0===m||(s.remove(),delete t.shapeMap["link-point-top"]),s.attr($i($i({},w),{x:0,y:-b/2}));else if(m){var x="link-point-top";t.shapeMap[x]=t.addShape("circle",{attrs:$i($i({},w),{x:0,y:-b/2}),className:x,name:x,isAnchorPoint:!0})}if(a)v||void 0===v?a.attr($i($i({},w),{x:0,y:b/2})):(a.remove(),delete t.shapeMap["link-point-bottom"]);else if(v){var E="link-point-bottom";t.shapeMap[E]=t.addShape("circle",{attrs:$i($i({},w),{x:0,y:b/2}),className:E,name:E,isAnchorPoint:!0})}},updateShape:function(e,t,n,i,r){t.get("keyShape").attr($i({},n)),this.updateLabel(e,t,r),i&&this.updateIcon(e,t)},updateIcon:function(e,t){var n=this,i=t.getContainer(),r=(this.mergeStyle||this.getOptions(e)).icon,o=e.icon?e.icon:{show:void 0,text:void 0},s=o.show,a=o.text,l=i.shapeMap["".concat(this.type,"-icon")]||i.find((function(e){return e.get("name")==="".concat(n.type,"-icon")}));if(l)if(s||void 0===s){var c=to({},l.attr(),r),u=c.width,h=void 0===u?20:u,d=c.height,f=void 0===d?20:d;("iconfont"===c.fontFamily||c.hasOwnProperty("text"))&&(h=0,f=0),l.attr($i($i({},c),{x:-h/2,y:-f/2}))}else l.remove();else if(s){var g="".concat(this.type,"-icon");if(a)i.shapeMap[g]=i.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:g,name:g});else{h=r.width,f=r.height;i.shapeMap[g]=i.addShape("image",{attrs:$i($i({},r),{x:-h/2,y:-f/2}),className:g,name:g})}var p=i.shapeMap["node-label"]||i.find((function(e){return"node-label"===e.get("name")}));p&&p.toFront()}}},og=$i($i({},ig),rg);bf.registerNode("single-node",og);var sg={itemType:"edge",labelPosition:"center",refX:0,refY:0,labelAutoRotate:!1,options:{size:Fl.defaultEdge.size,style:{x:0,y:0,stroke:Fl.defaultEdge.style.stroke,lineAppendWidth:Fl.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:Fl.edgeLabel.style.fill,fontSize:Fl.edgeLabel.style.fontSize,fontFamily:Fl.windowFontFamily}},stateStyles:$i({},Fl.edgeStateStyles)},getPath:function(e){var t=[];return cr(e,(function(e,n){0===n?t.push(["M",e.x,e.y]):t.push(["L",e.x,e.y])})),t},getShapeStyle:function(e){var t=to({},this.options.style,{stroke:e.color},e.style),n=e.size||Fl.defaultEdge.size,i=(e=this.getPathPoints(e)).startPoint,r=e.endPoint,o=this.getControlPoints(e),s=[i];o&&(s=s.concat(o)),s.push(r);var a=this.getPath(s);return to({},Fl.defaultEdge.style,{stroke:Fl.defaultEdge.color,lineWidth:n,path:a},t)},updateShapeStyle:function(e,t,n){var i,r=t.getContainer(),o=(null===(i=t.getKeyShape)||void 0===i?void 0:i.call(t))||r.shapeMap["edge-shape"],s=e.size,a=(e=this.getPathPoints(e)).startPoint,l=e.endPoint,c=this.getControlPoints(e),u=[a];c&&(u=u.concat(c)),u.push(l);var h=o.attr(),d=e.style||{};void 0===d.stroke&&(d.stroke=e.color);var f=e.sourceNode,g=e.targetNode,p={radius:d.radius};c||(p={source:f,target:g,offset:d.offset,radius:d.radius});var m=this.getPath(u,p),v={};"move"===n?v={path:m}:(h.endArrow&&!1===d.endArrow&&(e.style.endArrow={path:""}),h.startArrow&&!1===d.startArrow&&(e.style.startArrow={path:""}),void 0===(v=$i({},e.style)).lineWidth&&(v.lineWdith=(Or(s)?s:null==s?void 0:s[0])||h.lineWidth),void 0===v.path&&(v.path=m),void 0===v.stroke&&(v.stroke=h.stroke||e.color)),o&&o.attr(v)},getLabelStyleByPosition:function(e,t,n){var i,r=t.position||this.labelPosition,o={},s=null==n?void 0:n.shapeMap["edge-shape"];i="start"===r?0:"end"===r?1:.5;var a,l=t.refX||this.refX,c=t.refY||this.refY;if(e.startPoint.x===e.endPoint.x&&e.startPoint.y===e.endPoint.y)return o.x=e.startPoint.x+l,o.y=e.startPoint.y+c,o.text=e.label,o;a=sr(t.autoRotate)?this.labelAutoRotate:t.autoRotate;var u=Kl(s,i,l,c,a);return o.x=u.x,o.y=u.y,o.rotate=u.rotate,o.textAlign=this._getTextAlign(r,u.angle),o.text=e.label,o},getLabelBgStyleByPosition:function(e,t){if(!e)return{};var n=e.getBBox(),i=t.style&&t.style.background;if(!i)return{};var r=i.padding,o=n.width+r[1]+r[3],s=n.height+r[0]+r[2],a=$i($i({},i),{width:o,height:s,x:n.minX-r[3],y:n.minY-r[0],matrix:[1,0,0,0,1,0,0,0,1]});return(sr(t.autoRotate)?this.labelAutoRotate:t.autoRotate)&&(a.matrix=e.attr("matrix")||[1,0,0,0,1,0,0,0,1]),a},_getTextAlign:function(e,t){var n="center";return t?(t%=2*Math.PI,"center"!==e&&(n=t>=0&&t<=Math.PI/2||t>=1.5*Math.PI&&t<2*Math.PI?e:function(e){var t=e;return"start"===e?t="end":"end"===e&&(t="start"),t}(e)),n):e},getControlPoints:function(e){return e.controlPoints},getPathPoints:function(e){return e},drawShape:function(e,t){var n=this.getShapeStyle(e),i=t.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:n});return t.shapeMap["edge-shape"]=i,i},drawLabel:function(e,t){var n=this.options.labelCfg,i=so({},n,e.labelCfg),r=this.getLabelStyle(e,i,t),o=r.rotate;delete r.rotate;var s=t.addShape("text",{attrs:r,name:"text-shape",labelRelated:!0});if(t.shapeMap["text-shape"]=s,isNaN(o)||""===o||s.rotateAtStart(o),r.background){var a=this.drawLabelBg(e,t,s,r,o),l=this.itemType+"-label-bg";a.set("classname",l),t.shapeMap[l]=a,s.toFront()}return s},drawLabelBg:function(e,t,n,i,r){var o=this.options.labelCfg,s=so({},o,e.labelCfg),a=this.getLabelBgStyleByPosition(n,s),l=t.addShape("rect",{name:"text-bg-shape",attrs:a,labelRelated:!0});return t.shapeMap["text-bg-shape"]=l,l}},ag=$i($i({},ig),sg);bf.registerEdge("single-edge",ag),bf.registerEdge("line",{getControlPoints:function(){}},"single-edge"),bf.registerEdge("spline",{getPath:function(e){return If(e)}},"single-edge"),bf.registerEdge("arc",{curveOffset:20,clockwise:1,getControlPoints:function(e){var t,n,i=e.startPoint,r=e.endPoint,o=(i.x+r.x)/2,s=(i.y+r.y)/2;if(void 0!==e.controlPoints){if(n=e.controlPoints[0],t=dl(i,n,r),i.x<=r.x&&i.y>r.y?this.clockwise=t.x>n.x?0:1:i.x<=r.x&&i.y<r.y?this.clockwise=t.x>n.x?1:0:i.x>r.x&&i.y<=r.y?this.clockwise=t.y<n.y?0:1:this.clockwise=t.y<n.y?1:0,(n.x-i.x)/(n.y-i.y)==(r.x-i.x)/(r.y-i.y))return[]}else{void 0===e.curveOffset&&(e.curveOffset=this.curveOffset),ar(e.curveOffset)&&(e.curveOffset=e.curveOffset[0]),e.curveOffset<0?this.clockwise=0:this.clockwise=1;var a={x:r.x-i.x,y:r.y-i.y},l=Math.atan2(a.y,a.x);n={x:e.curveOffset*Math.cos(-Math.PI/2+l)+o,y:e.curveOffset*Math.sin(-Math.PI/2+l)+s},t=dl(i,n,r)}var c=fl(i,t);return[{x:c,y:c}]},getPath:function(e){var t=[];return t.push(["M",e[0].x,e[0].y]),2===e.length?t.push(["L",e[1].x,e[1].y]):t.push(["A",e[1].x,e[1].y,0,0,this.clockwise,e[2].x,e[2].y]),t}},"single-edge"),bf.registerEdge("quadratic",{curvePosition:.5,curveOffset:-20,getControlPoints:function(e){var t=e.controlPoints;if(!t||!t.length){var n=e.startPoint,i=e.endPoint;void 0===e.curveOffset&&(e.curveOffset=this.curveOffset),void 0===e.curvePosition&&(e.curvePosition=this.curvePosition),ar(this.curveOffset)&&(e.curveOffset=e.curveOffset[0]),ar(this.curvePosition)&&(e.curvePosition=e.curveOffset[0]),t=[Tf(n,i,e.curvePosition,e.curveOffset)]}return t},getPath:function(e){var t=[];return t.push(["M",e[0].x,e[0].y]),t.push(["Q",e[1].x,e[1].y,e[2].x,e[2].y]),t}},"single-edge"),bf.registerEdge("cubic",{curvePosition:[.5,.5],curveOffset:[-20,20],getControlPoints:function(e){var t=e.controlPoints;if(void 0===e.curveOffset&&(e.curveOffset=this.curveOffset),void 0===e.curvePosition&&(e.curvePosition=this.curvePosition),Or(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),Or(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]),!t||!t.length||t.length<2){var n=e.startPoint,i=e.endPoint;t=[Tf(n,i,e.curvePosition[0],e.curveOffset[0]),Tf(n,i,e.curvePosition[1],e.curveOffset[1])]}return t},getPath:function(e){var t=[];return t.push(["M",e[0].x,e[0].y]),t.push(["C",e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y]),t}},"single-edge"),bf.registerEdge("cubic-vertical",{curvePosition:[.5,.5],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(e){var t=e.startPoint,n=e.endPoint;void 0===e.curvePosition&&(e.curvePosition=this.curvePosition),void 0===e.curveOffset&&(e.curveOffset=this.curveOffset),void 0===e.minCurveOffset&&(e.minCurveOffset=this.minCurveOffset),Or(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),Or(e.minCurveOffset)&&(e.minCurveOffset=[e.minCurveOffset,-e.minCurveOffset]),Or(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]);var i=n.y-t.y,r=[0,0];return e.curveOffset?r=e.curveOffset:Math.abs(i)<Math.abs(e.minCurveOffset[0])&&(r=e.minCurveOffset),[{x:t.x,y:t.y+i*this.curvePosition[0]+r[0]},{x:n.x,y:n.y-i*this.curvePosition[1]+r[1]}]}},"cubic"),bf.registerEdge("cubic-horizontal",{curvePosition:[.5,.5],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(e){var t=e.startPoint,n=e.endPoint;void 0===e.curvePosition&&(e.curvePosition=this.curvePosition),void 0===e.curveOffset&&(e.curveOffset=this.curveOffset),void 0===e.minCurveOffset&&(e.minCurveOffset=this.minCurveOffset),Or(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),Or(e.minCurveOffset)&&(e.minCurveOffset=[e.minCurveOffset,-e.minCurveOffset]),Or(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]);var i=n.x-t.x,r=[0,0];return e.curveOffset?r=e.curveOffset:Math.abs(i)<Math.abs(e.minCurveOffset[0])&&(r=e.minCurveOffset),[{x:t.x+i*this.curvePosition[0]+r[0],y:t.y},{x:n.x-i*this.curvePosition[1]+r[1],y:n.y}]}},"cubic"),bf.registerEdge("loop",{getPathPoints:function(e){return Gl(e)},getControlPoints:function(e){return e.controlPoints},afterDraw:function(e){e.controlPoints=void 0},afterUpdate:function(e){e.controlPoints=void 0}},"cubic");var lg={itemType:"combo",shapeType:"single-combo",labelPosition:"top",refX:Fl.comboLabel.refX,refY:Fl.comboLabel.refY,options:{style:{stroke:Fl.defaultCombo.style.stroke,fill:Fl.defaultCombo.style.fill,lineWidth:Fl.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Fl.comboLabel.style.fill,fontSize:Fl.comboLabel.style.fontSize,fontFamily:Fl.windowFontFamily}},stateStyles:$i({},Fl.comboStateStyles)},getSize:function(e){var t=no(e.size||this.options.size||Fl.defaultCombo.size);return ar(t)&&1===t.length&&(t=[t[0],t[0]]),ar(t)||(t=[t,t]),t},getLabelStyleByPosition:function(e,t){var n=t.position||this.labelPosition,i=e.style,r=e.padding||this.options.padding;ar(r)&&(r=r[0]);var o=t.refX,s=t.refY;sr(o)&&(o=this.refX),sr(s)&&(s=this.refY);var a,l=this.getSize(e),c=(Math.max(i.r,l[0]/2)||l[0]/2)+r;switch(n){case"top":a={x:0,y:-c-s,textBaseline:"bottom",textAlign:"center"};break;case"bottom":a={x:0,y:c+s,textBaseline:"bottom",textAlign:"center"};break;case"left":a={x:-c+o,y:0,textAlign:"left"};break;case"center":a={x:0,y:0,text:e.label,textAlign:"center"};break;default:a={x:c+o,y:0,textAlign:"right"}}return a.text=e.label,a},drawShape:function(e,t){var n=this.shapeType,i=this.getShapeStyle(e);return t.addShape(n,{attrs:i,draggable:!0,name:"combo-shape"})},updateShape:function(e,t,n){var i=t.get("keyShape");(void 0===e.animate?this.options.animate:e.animate)&&i.animate?i.animate(n,{duration:200,easing:"easeLinear"}):i.attr($i({},n)),this.updateLabel(e,t)}},cg=$i($i({},ig),lg);bf.registerCombo("single-combo",cg),bf.registerCombo("circle",{options:{size:[Fl.defaultCombo.size[0],Fl.defaultCombo.size[0]],padding:Fl.defaultCombo.padding[0],animate:!0,style:{stroke:Fl.defaultCombo.style.stroke,fill:Fl.defaultCombo.style.fill,lineWidth:Fl.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Fl.comboLabel.style.fill,fontSize:Fl.comboLabel.style.fontSize},refX:0,refY:0},stateStyles:$i({},Fl.comboStateStyles)},shapeType:"circle",labelPosition:"top",drawShape:function(e,t){var n=this.getShapeStyle(e);return delete n.height,delete n.width,t.addShape("circle",{attrs:n,className:"circle-combo",name:"circle-combo",draggable:!0})},getShapeStyle:function(e){var t=this.options.style,n=e.padding||this.options.padding;ar(n)&&(n=n[0]);var i,r=to({},t,{stroke:e.color},e.style);if(e.fixSize)i=Or(e.fixSize)?e.fixSize:e.fixSize[0];else{var o=this.getSize(e);i=!Or(r.r)||isNaN(r.r)?o[0]/2||Fl.defaultCombo.style.r:Math.max(r.r,o[0]/2)||o[0]/2}r.r=i+n;var s=$i({x:0,y:0},r);return e.style?e.style.r=i:e.style={r:i},s},update:function(e,t){var n=this.getSize(e),i=e.padding||this.options.padding;ar(i)&&(i=i[0]);var r,o=no(e.style);r=e.fixSize?Or(e.fixSize)?e.fixSize:e.fixSize[0]:Math.max(o.r,n[0]/2)||n[0]/2,o.r=r+i;var s=t.get("sizeCache");s&&(s.r=o.r);var a={stroke:e.color},l=to({},t.get("keyShape").attr(),a,o);e.style?e.style.r=r:e.style={r:r},this.updateShape(e,t,l,!0)}},"single-combo"),bf.registerCombo("rect",{options:{size:[40,5],padding:[25,20,15,20],animate:!0,style:{radius:0,stroke:Fl.defaultCombo.style.stroke,fill:Fl.defaultCombo.style.fill,lineWidth:Fl.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Fl.comboLabel.style.fill,fontSize:Fl.comboLabel.style.fontSize,fontFamily:Fl.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:$i({},Fl.comboStateStyles)},shapeType:"rect",labelPosition:"top",drawShape:function(e,t){var n=this.getShapeStyle(e);return t.addShape("rect",{attrs:n,className:"rect-combo",name:"rect-combo",draggable:!0})},getLabelStyleByPosition:function(e,t){var n=t.position||this.labelPosition,i=e.style,r=e.padding||this.options.padding;Or(r)&&(r=[r,r,r,r]);var o=t.refX,s=t.refY;sr(o)&&(o=this.refX),sr(s)&&(s=this.refY);var a,l=i.width/2+r[3],c=i.height/2+r[0];switch(n){case"top":a={x:0-l+o,y:0-c+s,textBaseline:"top",textAlign:"left"};break;case"bottom":a={x:0,y:c+s,textBaseline:"bottom",textAlign:"center"};break;case"left":a={x:0-l+s,y:0,textAlign:"left"};break;case"center":a={x:0,y:0,text:e.label,textAlign:"center"};break;default:a={x:l+o,y:0,textAlign:"right"}}return a.text=e.label,a},getShapeStyle:function(e){var t=this.options.style,n=e.padding||this.options.padding;Or(n)&&(n=[n,n,n,n]);var i,r,o=to({},t,{stroke:e.color},e.style),s=this.getSize(e),a=e.collapsed&&e.fixCollapseSize?e.fixCollapseSize:e.fixSize;a?Or(a)?(i=a,r=a):(i=a[0],r=a[1]):(i=!Or(o.width)||isNaN(o.width)?s[0]||Fl.defaultCombo.style.width:Math.max(o.width,s[0])||s[0],r=!Or(o.height)||isNaN(o.height)?s[1]||Fl.defaultCombo.style.height:Math.max(o.height,s[1])||s[1]);var l=-i/2-n[3],c=-r/2-n[0];o.width=i+n[1]+n[3],o.height=r+n[0]+n[2];var u=$i({x:l,y:c},o);return e.style?(e.style.width=i,e.style.height=r):e.style={width:i,height:r},u},update:function(e,t){var n=this.getSize(e),i=e.padding||this.options.padding;Or(i)&&(i=[i,i,i,i]);var r,o,s=no(e.style),a=e.collapsed&&e.fixCollapseSize?e.fixCollapseSize:e.fixSize;a?Or(a)?(r=a,o=a):(r=a[0],o=a[1]):(r=Math.max(s.width,n[0])||n[0],o=Math.max(s.height,n[1])||n[1]),s.width=r+i[1]+i[3],s.height=o+i[0]+i[2];var l=t.get("sizeCache");l&&(l.width=s.width,l.height=s.height),s.x=-r/2-i[3],s.y=-o/2-i[0];var c={stroke:e.color},u=to({},t.get("keyShape").attr(),c,s);e.style?(e.style.width=r,e.style.height=o):e.style={width:r,height:o},this.updateShape(e,t,u,!1)},updateShape:function(e,t,n){var i=t.get("keyShape");(void 0===e.animate?this.options.animate:e.animate)&&i.animate?i.animate(n,{duration:200,easing:"easeLinear"}):i.attr($i({},n)),this.updateLabel(e,t)}},"single-combo"),bf.registerNode("simple-circle",{options:{size:Fl.defaultNode.size,style:{x:0,y:0,stroke:Fl.defaultNode.style.stroke,fill:Fl.defaultNode.style.fill,lineWidth:Fl.defaultNode.style.lineWidth},labelCfg:{style:{fill:Fl.nodeLabel.style.fill,fontSize:Fl.nodeLabel.style.fontSize,fontFamily:Fl.windowFontFamily}},stateStyles:$i({},Fl.nodeStateStyles)},shapeType:"simple-circle",labelPosition:"center",shapeMap:{},drawShape:function(e,t){var n=this.getShapeStyle(e),i="".concat(this.type,"-keyShape"),r=t.addShape("circle",{attrs:n,className:"".concat(this.type,"-keyShape"),name:i,draggable:!0});return t.shapeMap[i]=r,r},getShapeStyle:function(e){var t=(this.mergeStyle||this.getOptions(e)).style,n={stroke:e.color},i=so({},t,n),r=this.getSize(e)[0]/2;return $i({x:0,y:0,r:r},i)},update:function(e,t,n){var i=this.getSize(e),r={stroke:e.color,r:i[0]/2},o=t.get("keyShape"),s=so({},o.attr(),r,e.style);this.updateShape(e,t,s,!0,n)}},"single-node"),bf.registerNode("simple-rect",{options:{size:[100,30],style:{radius:0,stroke:Fl.defaultNode.style.stroke,fill:Fl.defaultNode.style.fill,lineWidth:Fl.defaultNode.style.lineWidth},labelCfg:{style:{fill:Fl.nodeLabel.style.fill,fontSize:Fl.nodeLabel.style.fontSize,fontFamily:Fl.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:$i({},Fl.nodeStateStyles)},shapeType:"simple-rect",labelPosition:"center",drawShape:function(e,t){var n=this.getShapeStyle(e);return t.addShape("rect",{attrs:n,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0})},getShapeStyle:function(e){var t=to({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),n=this.getSize(e),i=t.width||n[0],r=t.height||n[1];return $i({x:-i/2,y:-r/2,width:i,height:r},t)},update:function(e,t,n){t.getContainer();var i=(this.mergeStyle||this.getOptions(e)).style,r=this.getSize(e),o=t.get("keyShape");e.size||(r[0]=o.attr("width")||i.width,r[1]=o.attr("height")||i.height);var s={stroke:e.color,x:-r[0]/2,y:-r[1]/2,width:r[0],height:r[1]},a=to({},i,o.attr(),s);a=to(a,e.style),this.updateShape(e,t,a,!1,n)}},"single-node"),bf.registerNode("image",{options:{img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ",size:200,labelCfg:{style:{fontFamily:Fl.windowFontFamily}},clipCfg:{show:!1,type:"circle",r:50,rx:50,ry:35,width:50,height:35,points:[[30,12],[12,30],[30,48],[48,30]],path:[["M",25,25],["L",50,25],["A",12.5,12.5,0,1,1,50,50],["A",12.5,12.5,0,1,0,50,50],["L",25,75],["Z"]],x:0,y:0}},shapeType:"image",labelPosition:"bottom",drawShape:function(e,t){var n=this.shapeType,i=this.getShapeStyle(e);delete i.fill;var r=t.addShape(n,{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return this.drawClip(e,r),r},drawClip:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).clipCfg;if(n.show){var i=n.type,r=n.x,o=n.y,s=n.style;if("circle"===i){var a=n.r;t.setClip({type:"circle",attrs:$i({r:a,x:r,y:o},s)})}else if("rect"===i){var l=n.width,c=n.height,u=r-l/2,h=o-c/2;t.setClip({type:"rect",attrs:$i({x:u,y:h,width:l,height:c},s)})}else if("ellipse"===i){var d=n.rx,f=n.ry;t.setClip({type:"ellipse",attrs:$i({x:r,y:o,rx:d,ry:f},s)})}else if("polygon"===i){var g=n.points;t.setClip({type:"polygon",attrs:$i({points:g},s)})}else if("path"===i){var p=n.path;t.setClip({type:"path",attrs:$i({path:p},s)})}}},getShapeStyle:function(e){var t=this.mergeStyle||this.getOptions(e),n=t.style,i=t.img,r=this.getSize(e),o=r[0],s=r[1];return n&&(o=n.width||r[0],s=n.height||r[1]),$i({x:-o/2,y:-s/2,width:o,height:s,img:i},n)},updateShapeStyle:function(e,t){var n=t.getContainer(),i="".concat(this.itemType,"-shape"),r=n.shapeMap[i]||n.find((function(e){return e.get("className")===i}))||t.getKeyShape(),o=this.getShapeStyle(e);r&&!r.destroyed&&r.attr(o)}},"single-node");var ug,hg,dg={collapse:function(e,t,n){return[["M",e-n,t],["a",n,n,0,1,0,2*n,0],["a",n,n,0,1,0,2*-n,0],["M",e-n+4,t],["L",e+n-4,t]]},expand:function(e,t,n){return[["M",e-n,t],["a",n,n,0,1,0,2*n,0],["a",n,n,0,1,0,2*-n,0],["M",e-n+4,t],["L",e-n+2*n-4,t],["M",e-n+n,t-n+4],["L",e,t+n-4]]},upTriangle:function(e,t,n){var i=n*Math.cos(Math.PI/6),r=n*Math.sin(Math.PI/6);return[["M",e-i,t+r],["L",e+i,t+r],["L",e,t-n],["Z"]]},downTriangle:function(e,t,n){var i=n*Math.cos(Math.PI/6),r=n*Math.sin(Math.PI/6);return[["M",e-i,t-r],["L",e+i,t-r],["L",e,t+n],["Z"]]}},fg=Object.freeze(Object.defineProperty({__proto__:null,defaultSubjectColors:["#5F95FF","#61DDAA","#65789B","#F6BD16","#7262FD","#78D3F8","#9661BC","#F6903D","#008685","#F08BB4"]},Symbol.toStringTag,{value:"Module"})),gg=Us,pg=$i($i($i($i($i($i({},lf),ic),Wf),Tl),fg),{transform:gg,mat3:Vo}),mg=function(){function e(e){this.graph=e,this.layoutCfg=e.get("layout")||{},this.layoutType=this.getLayoutType(),this.layoutMethods=[],this.initLayout()}return e.prototype.initLayout=function(){},e.prototype.getLayoutType=function(){return this.getLayoutCfgType(this.layoutCfg)},e.prototype.getLayoutCfgType=function(e){var t=e.type;if(t)return t;var n=e.pipes;return Array.isArray(n)?n.map((function(e){return(null==e?void 0:e.type)||""})):null},e.prototype.isLayoutTypeSame=function(e){var t=this.getLayoutCfgType(e);return Array.isArray(this.layoutType)?this.layoutType.every((function(e,n){return e===t[n]})):(null==e?void 0:e.type)===this.layoutType},e.prototype.refreshLayout=function(){var e=this.graph;e&&(e.get("animate")?e.positionsAnimate():e.refreshPositions())},e.prototype.changeLayout=function(e){this.layoutCfg=e,this.destoryLayoutMethods(),this.layout()},e.prototype.changeData=function(){this.destoryLayoutMethods(),this.layout()},e.prototype.destoryLayoutMethods=function(){var e=this.layoutMethods;null==e||e.forEach((function(e){e.destroy()})),this.layoutMethods=[]},e.prototype.destroyLayout=function(){var e=this.graph;this.destoryLayoutMethods(),e.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0},e.prototype.setDataFromGraph=function(){for(var e=[],t=[],n=[],i=[],r=[],o=[],s=this.graph.getNodes(),a=this.graph.getEdges(),l=this.graph.getCombos(),c=s.length,u=0;u<c;u++){var h=s[u];if(h&&!h.destroyed){var d=h.getModel();h.isVisible()?e.push(d):t.push(d)}}var f=a.length;for(u=0;u<f;u++){var g=a[u];if(g&&!g.destroyed){d=g.getModel();g.isVisible()?d.isComboEdge?r.push(d):n.push(d):i.push(d)}}var p=l.length;for(u=0;u<p;u++){var m=l[u];if(!m.destroyed){d=m.getModel();m.isVisible()?o.push(d):i.push(d)}}return{nodes:e,hiddenNodes:t,edges:n,hiddenEdges:i,combos:o,hiddenCombos:[],comboEdges:r}},e.prototype.reLayoutMethod=function(e,t){var n=this;return new Promise((function(i,r){var o=n.graph,s=null==t?void 0:t.type;t.onLayoutEnd=function(){o.emit("aftersublayout",{type:s}),i()},e.init(n.data),"force"===s&&(e.ticking=!1,e.forceSimulation.stop()),o.emit("beforesublayout",{type:s}),e.execute(),e.isCustomLayout&&t.onLayoutEnd&&t.onLayoutEnd()}))},e.prototype.relayout=function(e){var t=this,n=this,i=n.graph,r=n.layoutMethods,o=n.layoutCfg;if(e){this.data=this.setDataFromGraph();var s=this.data.nodes;if(!s)return!1;this.initPositions(o.center,s)}i.emit("beforelayout");var a=Promise.resolve();null==r||r.forEach((function(e,n){var i=o[n];a=a.then((function(){return t.reLayoutMethod(e,i)}))})),a.then((function(){o.onAllLayoutEnd&&o.onAllLayoutEnd()})).catch((function(e){console.warn("relayout failed",e)}))},e.prototype.filterLayoutData=function(e,t){var n,i,r=e.nodes,o=e.edges,s=Yi(e,["nodes","edges"]);if(!r)return e;n=or(null==t?void 0:t.nodesFilter)?t.nodesFilter:function(){return!0};var a=r.filter(n);if(or(null==t?void 0:t.edgesFilter))i=t.edgesFilter;else{var l=a.reduce((function(e,t){return e[t.id]=!0,e}),{});i=function(e){return l[e.source]&&l[e.target]}}return $i({nodes:a,edges:o.filter(i)},s)},e.prototype.getLayoutBBox=function(e){var t=Nr(this.graph.getNodes(),(function(e){return e.getModel().layoutOrder})),n=Object.values(t).map((function(e){var t=af(e);return t.size=[t.width,t.height],t}));return{groupNodes:Object.values(Nr(e,"layoutOrder")),layoutNodes:n}},e.prototype.layoutAnimate=function(){},e.prototype.moveToZero=function(){var e=this.graph.get("data").nodes;if(void 0!==e[0].x&&null!==e[0].x&&!sf(e[0].x)){for(var t=[0,0],n=e.length,i=0;i<n;i++){var r=e[i];t[0]+=r.x,t[1]+=r.y}t[0]/=e.length,t[1]/=e.length;for(i=0;i<n;i++){(r=e[i]).x-=t[0],r.y-=t[1]}}},e.prototype.initPositions=function(e,t){var n=this.graph;if(!t)return!1;var i=t?t.length:0;if(i){var r=.85*n.get("width"),o=.85*n.get("height"),s=Math.ceil(Math.sqrt(i)*(r/o)),a=r/(s-1),l=o/(Math.ceil(i/s)-1);isFinite(a)&&a||(a=0),isFinite(l)&&a||(l=0);for(var c=e[0]-r/2,u=e[1]-o/2,h=!0,d=0;d<i;d++){var f=t[d];sf(+f.x)&&(h=!1,f.x=d%s*a+c),sf(+f.y)&&(h=!1,f.y=Math.floor(d/s)*l+u)}return h}},e.prototype.destroy=function(){this.graph=null,this.destoryLayoutMethods(),this.destroyed=!0},e}(),vg=function(e){this.graph=e,this.destroyed=!1,this.initEvents()};(hg=ug||(ug={})).CLICK="click",hg.DBLCLICK="dblclick",hg.MOUSEDOWN="mousedown",hg.MOUDEUP="mouseup",hg.CONTEXTMENU="contextmenu",hg.MOUSEENTER="mouseenter",hg.MOUSEOUT="mouseout",hg.MOUSEOVER="mouseover",hg.MOUSEMOVE="mousemove",hg.MOUSELEAVE="mouseleave",hg.DRAGSTART="dragstart",hg.DRAGEND="dragend",hg.DRAG="drag",hg.DRAGENTER="dragenter",hg.DRAGLEAVE="dragleave",hg.DRAGOVER="dragover",hg.DRAGOUT="dragout",hg.DDROP="drop",hg.KEYUP="keyup",hg.KEYDOWN="keydown",hg.WHEEL="wheel",hg.FOCUS="focus",hg.BLUR="blur",hg.TOUCHSTART="touchstart",hg.TOUCHMOVE="touchmove",hg.TOUCHEND="touchend",hg.CANVAS_TOUCHSTART="canvas:touchstart",hg.CANVAS_TOUCHMOVE="canvas:touchmove",hg.CANVAS_TOUCHEND="canvas:touchend",hg.NODE_TOUCHSTART="node:touchstart",hg.NODE_TOUCHMOVE="node:touchmove",hg.NODE_TOUCHEND="node:touchend",hg.COMBO_TOUCHSTART="combo:touchstart",hg.COMBO_TOUCHMOVE="combo:touchmove",hg.COMBO_TOUCHEND="combo:touchend",hg.EDGE_TOUCHSTART="edge:touchstart",hg.EDGE_TOUCHMOVE="edge:touchmove",hg.EDGE_TOUCHEND="edge:touchend",hg.NODE_CONTEXTMENU="node:contextmenu",hg.NODE_CLICK="node:click",hg.NODE_DBLCLICK="node:dblclick",hg.NODE_MOUSEDOWN="node:mousedown",hg.NODE_MOUSEUP="node:mouseup",hg.NODE_MOUSEENTER="node:mouseenter",hg.NODE_MOUSELEAVE="node:mouseleave",hg.NODE_MOUSEMOVE="node:mousemove",hg.NODE_MOUSEOUT="node:mouseout",hg.NODE_MOUSEOVER="node:mouseover",hg.NODE_DROP="node:drop",hg.NODE_DRAGOVER="node:dragover",hg.NODE_DRAGENTER="node:dragenter",hg.NODE_DRAGLEAVE="node:dragleave",hg.NODE_DRAGSTART="node:dragstart",hg.NODE_DRAG="node:drag",hg.NODE_DRAGEND="node:dragend",hg.NODE_TAP="node:tap",hg.NODE_PANSTART="node:panstart",hg.NODE_PANMOVE="node:panmove",hg.NODE_PANEND="node:panend",hg.COMBO_CONTEXTMENU="combo:contextmenu",hg.COMBO_CLICK="combo:click",hg.COMBO_DBLCLICK="combo:dblclick",hg.COMBO_MOUSEDOWN="combo:mousedown",hg.COMBO_MOUSEUP="combo:mouseup",hg.COMBO_MOUSEENTER="combo:mouseenter",hg.COMBO_MOUSELEAVE="combo:mouseleave",hg.COMBO_MOUSEMOVE="combo:mousemove",hg.COMBO_MOUSEOUT="combo:mouseout",hg.COMBO_MOUSEOVER="combo:mouseover",hg.COMBO_DROP="combo:drop",hg.COMBO_DRAGOVER="combo:dragover",hg.COMBO_DRAGENTER="combo:dragenter",hg.COMBO_DRAGLEAVE="combo:dragleave",hg.COMBO_DRAGSTART="combo:dragstart",hg.COMBO_DRAG="combo:drag",hg.COMBO_DRAGEND="combo:dragend",hg.COMBO_TAP="combo:tap",hg.COMBO_PANSTART="combo:panstart",hg.COMBO_PANMOVE="combo:panmove",hg.COMBO_PANEND="combo:panend",hg.EDGE_CONTEXTMENU="edge:contextmenu",hg.EDGE_CLICK="edge:click",hg.EDGE_DBLCLICK="edge:dblclick",hg.EDGE_MOUSEDOWN="edge:mousedown",hg.EDGE_MOUSEUP="edge:mouseup",hg.EDGE_MOUSEENTER="edge:mouseenter",hg.EDGE_MOUSELEAVE="edge:mouseleave",hg.EDGE_MOUSEMOVE="edge:mousemove",hg.EDGE_MOUSEOUT="edge:mouseout",hg.EDGE_MOUSEOVER="edge:mouseover",hg.EDGE_DROP="edge:drop",hg.EDGE_DRAGOVER="edge:dragover",hg.EDGE_DRAGENTER="edge:dragenter",hg.EDGE_DRAGLEAVE="edge:dragleave",hg.CANVAS_CONTEXTMENU="canvas:contextmenu",hg.CANVAS_CLICK="canvas:click",hg.CANVAS_DBLCLICK="canvas:dblclick",hg.CANVAS_MOUSEDOWN="canvas:mousedown",hg.CANVAS_MOUSEUP="canvas:mouseup",hg.CANVAS_MOUSEENTER="canvas:mouseenter",hg.CANVAS_MOUSELEAVE="canvas:mouseleave",hg.CANVAS_MOUSEMOVE="canvas:mousemove",hg.CANVAS_MOUSEOUT="canvas:mouseout",hg.CANVAS_MOUSEOVER="canvas:mouseover",hg.CANVAS_DROP="canvas:drop",hg.CANVAS_DRAGENTER="canvas:dragenter",hg.CANVAS_DRAGLEAVE="canvas:dragleave",hg.CANVAS_DRAGSTART="canvas:dragstart",hg.CANVAS_DRAG="canvas:drag",hg.CANVAS_DRAGEND="canvas:dragend",hg.CANVAS_TAP="canvas:tap",hg.CANVAS_PANSTART="canvas:panstart",hg.CANVAS_PANMOVE="canvas:panmove",hg.CANVAS_PANEND="canvas:panend",hg.BEFORERENDER="beforerender",hg.AFTERRENDER="afterrender",hg.BEFOREADDITEM="beforeadditem",hg.AFTERADDITEM="afteradditem",hg.BEFOREREMOVEITEM="beforeremoveitem",hg.AFTERREMOVEITEM="afterremoveitem",hg.BEFOREUPDATEITEM="beforeupdateitem",hg.AFTERUPDATEITEM="afterupdateitem",hg.BEFOREITEMVISIBILITYCHANGE="beforeitemvisibilitychange",hg.AFTERITEMVISIBILITYCHANGE="afteritemvisibilitychange",hg.BEFOREITEMSTATECHANGE="beforeitemstatechange",hg.AFTERITEMSTATECHANGE="afteritemstatechange",hg.BEFOREITEMREFRESH="beforeitemrefresh",hg.AFTERITEMREFRESH="afteritemrefresh",hg.BEFOREITEMSTATESCLEAR="beforeitemstatesclear",hg.AFTERITEMSTATESCLEAR="afteritemstatesclear",hg.BEFOREMODECHANGE="beforemodechange",hg.AFTERMODECHANGE="aftermodechange",hg.BEFORELAYOUT="beforelayout",hg.AFTERLAYOUT="afterlayout",hg.BEFORECREATEEDGE="beforecreateedge",hg.AFTERCREATEEDGE="aftercreateedge",hg.BEFOREGRAPHREFRESHPOSITION="beforegraphrefreshposition",hg.AFTERGRAPHREFRESHPOSITION="aftergraphrefreshposition",hg.BEFOREGRAPHREFRESH="beforegraphrefresh",hg.AFTERGRAPHREFRESH="aftergraphrefresh",hg.BEFOREANIMATE="beforeanimate",hg.AFTERANIMATE="afteranimate",hg.BEFOREPAINT="beforepaint",hg.AFTERPAINT="afterpaint",hg.BEFORECOLLAPSEEXPANDCOMBO="beforecollapseexpandcombo",hg.AFTERCOLLAPSEEXPANDCOMBO="aftercollapseexpandcombo",hg.GRAPHSTATECHANGE="graphstatechange",hg.AFTERACTIVATERELATIONS="afteractivaterelations",hg.NODESELECTCHANGE="nodeselectchange",hg.TOOLTIPCHANGE="tooltipchange",hg.WHEELZOOM="wheelzoom",hg.VIEWPORTCHANGE="viewportchange",hg.DRAGNODEEND="dragnodeend",hg.STACKCHANGE="stackchange",hg.TAP="tap",hg.PINCHSTART="pinchstart",hg.PINCHMOVE="pinchmove",hg.PANSTART="panstart",hg.PANMOVE="panmove",hg.PANEND="panend";var yg=bf.registerNode,_g=bf.registerEdge,bg=bf.registerCombo,wg=Lo.registerBehavior,Cg=Fl,Sg={},xg={},Eg={},kg={};Object.defineProperty(kg,"__esModule",{value:!0}),kg.MESSAGE=kg.ALGORITHM=void 0;kg.ALGORITHM={pageRank:"pageRank",breadthFirstSearch:"breadthFirstSearch",connectedComponent:"connectedComponent",depthFirstSearch:"depthFirstSearch",detectCycle:"detectCycle",detectDirectedCycle:"detectDirectedCycle",detectAllCycles:"detectAllCycles",detectAllDirectedCycle:"detectAllDirectedCycle",detectAllUndirectedCycle:"detectAllUndirectedCycle",dijkstra:"dijkstra",findAllPath:"findAllPath",findShortestPath:"findShortestPath",floydWarshall:"floydWarshall",getAdjMatrix:"getAdjMatrix",getDegree:"getDegree",getInDegree:"getInDegree",getNeighbors:"getNeighbors",getOutDegree:"getOutDegree",labelPropagation:"labelPropagation",louvain:"louvain",GADDI:"GADDI",minimumSpanningTree:"minimumSpanningTree",SUCCESS:"SUCCESS",FAILURE:"FAILURE"};kg.MESSAGE={SUCCESS:"SUCCESS",FAILURE:"FAILURE"};var Lg={},Dg={},Ng={};Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.default=void 0;var Ig=function(e,t){var n=e.nodes,i=e.edges,r=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach((function(e,t){o[e.id]=t;r.push([])})),i&&i.forEach((function(e){var n=e.source,i=e.target,s=o[n],a=o[i];!s&&0!==s||!a&&0!==a||(r[s][a]=1,t||(r[a][s]=1))})),r};Ng.default=Ig;var Tg={},Mg={},Ag={};Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.default=Ag.LinkedListNode=void 0;var Og=function(e,t){return e===t},Rg=function(){function e(e,t){void 0===t&&(t=null),this.value=e,this.next=t}return e.prototype.toString=function(e){return e?e(this.value):"".concat(this.value)},e}();Ag.LinkedListNode=Rg;var Pg=function(){function e(e){void 0===e&&(e=Og),this.head=null,this.tail=null,this.compare=e}return e.prototype.prepend=function(e){var t=new Rg(e,this.head);return this.head=t,this.tail||(this.tail=t),this},e.prototype.append=function(e){var t=new Rg(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},e.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t},e.prototype.find=function(e){var t=e.value,n=void 0===t?void 0:t,i=e.callback,r=void 0===i?void 0:i;if(!this.head)return null;for(var o=this.head;o;){if(r&&r(o.value))return o;if(void 0!==n&&this.compare(o.value,n))return o;o=o.next}return null},e.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e},e.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e},e.prototype.fromArray=function(e){var t=this;return e.forEach((function(e){return t.append(e)})),this},e.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e},e.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t},e.prototype.toString=function(e){return void 0===e&&(e=void 0),this.toArray().map((function(t){return t.toString(e)})).toString()},e}();Ag.default=Pg,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.default=void 0;var Fg,Bg=(Fg=Ag)&&Fg.__esModule?Fg:{default:Fg};var Wg=function(){function e(){this.linkedList=new Bg.default}return e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},e.prototype.enqueue=function(e){this.linkedList.append(e)},e.prototype.dequeue=function(){var e=this.linkedList.deleteHead();return e?e.value:null},e.prototype.toString=function(e){return this.linkedList.toString(e)},e}();Mg.default=Wg;var zg={};Object.defineProperty(zg,"__esModule",{value:!0}),zg.uniqueId=zg.getOutEdgesNodeId=zg.getNeighbors=zg.getEdgesByNodeId=void 0;zg.getNeighbors=function(e,t,n){void 0===t&&(t=[]);var i=t.filter((function(t){return t.source===e||t.target===e}));if("target"===n){return i.filter((function(t){return t.source===e})).map((function(e){return e.target}))}if("source"===n){return i.filter((function(t){return t.target===e})).map((function(e){return e.source}))}return i.map((function(t){return t.source===e?t.target:t.source}))};zg.getOutEdgesNodeId=function(e,t){return t.filter((function(t){return t.source===e}))};zg.getEdgesByNodeId=function(e,t){return t.filter((function(t){return t.source===e||t.target===e}))};zg.uniqueId=function(e){void 0===e&&(e=0);var t="".concat(Math.random()).split(".")[1].substr(0,5),n="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(e,"-").concat(t).concat(n)},Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.default=void 0;var Vg=function(e){return e&&e.__esModule?e:{default:e}}(Mg),Ug=zg;var Hg=function(e,t,n,i){void 0===i&&(i=!0);var r=function(e){void 0===e&&(e={});var t,n=e,i=function(){},r=(t={},function(e){var n=e.next;return!t[n]&&(t[n]=!0,!0)});return n.allowTraversal=e.allowTraversal||r,n.enter=e.enter||i,n.leave=e.leave||i,n}(n),o=new Vg.default,s=e.edges,a=void 0===s?[]:s;o.enqueue(t);for(var l="",c=function(){var e=o.dequeue();r.enter({current:e,previous:l}),(0,Ug.getNeighbors)(e,a,i?"target":void 0).forEach((function(t){r.allowTraversal({previous:l,current:e,next:t})&&o.enqueue(t)})),r.leave({current:e,previous:l}),l=e};!o.isEmpty();)c()};Tg.default=Hg;var jg={};Object.defineProperty(jg,"__esModule",{value:!0}),jg.default=function(e,t){return t?qg(e):Kg(e)},jg.detectStrongConnectComponents=jg.detectConnectedComponents=void 0;var Gg=zg,Kg=function(e){for(var t=e.nodes,n=void 0===t?[]:t,i=e.edges,r=void 0===i?[]:i,o=[],s={},a=[],l=function e(t){a.push(t),s[t.id]=!0;for(var i=(0,Gg.getNeighbors)(t.id,r),o=function(t){var r=i[t];if(!s[r]){var o=n.filter((function(e){return e.id===r}));o.length>0&&e(o[0])}},l=0;l<i.length;++l)o(l)},c=0;c<n.length;c++){var u=n[c];if(!s[u.id]){l(u);for(var h=[];a.length>0;)h.push(a.pop());o.push(h)}}return o};jg.detectConnectedComponents=Kg;var qg=function(e){for(var t=e.nodes,n=void 0===t?[]:t,i=e.edges,r=void 0===i?[]:i,o=[],s={},a={},l={},c=[],u=0,h=function e(t){a[t.id]=u,l[t.id]=u,u+=1,o.push(t),s[t.id]=!0;for(var i=(0,Gg.getNeighbors)(t.id,r,"target").filter((function(e){return n.map((function(e){return e.id})).indexOf(e)>-1})),h=function(r){var o=i[r];if(a[o]||0===a[o])s[o]&&(l[t.id]=Math.min(l[t.id],a[o]));else{var c=n.filter((function(e){return e.id===o}));c.length>0&&e(c[0]),l[t.id]=Math.min(l[t.id],l[o])}},d=0;d<i.length;d++)h(d);if(l[t.id]===a[t.id]){for(var f=[];o.length>0;){var g=o.pop();if(s[g.id]=!1,f.push(g),g===t)break}f.length>0&&c.push(f)}},d=0,f=n;d<f.length;d++){var g=f[d];a[g.id]||0===a[g.id]||h(g)}return c};jg.detectStrongConnectComponents=qg;var $g={};Object.defineProperty($g,"__esModule",{value:!0}),$g.getOutDegree=$g.getInDegree=$g.default=void 0;var Yg=function(e){var t={},n=e.nodes,i=void 0===n?[]:n,r=e.edges,o=void 0===r?[]:r;return i.forEach((function(e){t[e.id]={degree:0,inDegree:0,outDegree:0}})),o.forEach((function(e){t[e.source].degree++,t[e.source].outDegree++,t[e.target].degree++,t[e.target].inDegree++})),t},Xg=Yg;$g.default=Xg;$g.getInDegree=function(e,t){return Yg(e)[t]?Yg(e)[t].inDegree:0};$g.getOutDegree=function(e,t){return Yg(e)[t]?Yg(e)[t].outDegree:0};var Zg={},Qg={};Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.default=function(e,t,n){ep(e,t,"",function(e){void 0===e&&(e={});var t=e,n=function(){},i=(r={},function(e){var t=e.next;return!r[t]&&(r[t]=!0,!0)});var r;return t.allowTraversal=e.allowTraversal||i,t.enter=e.enter||n,t.leave=e.leave||n,t}(n))};var Jg=zg;function ep(e,t,n,i){i.enter({current:t,previous:n});var r=e.edges,o=void 0===r?[]:r;(0,Jg.getNeighbors)(t,o,"target").forEach((function(r){i.allowTraversal({previous:n,current:t,next:r})&&ep(e,r,t,i)})),i.leave({current:t,previous:n})}function tp(e){return(tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.detectAllUndirectedCycle=Zg.detectAllDirectedCycle=Zg.detectAllCycles=Zg.default=void 0;var np=function(e){return e&&e.__esModule?e:{default:e}}(Qg),ip=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==tp(e)&&"function"!=typeof e)return{default:e};var n=op(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(jg),rp=zg;function op(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(op=function(e){return e?n:t})(e)}var sp=function(e,t,n){var i,r;void 0===n&&(n=!0);for(var o=[],s=0,a=(0,ip.default)(e,!1);s<a.length;s++){var l=a[s];if(l.length)for(var c=l[0],u=c.id,h=[c],d=((i={})[u]=c,i),f=((r={})[u]=new Set,r);h.length>0;)for(var g=h.pop(),p=g.id,m=(0,rp.getNeighbors)(p,e.edges),v=function(i){var r,s=m[i],a=e.nodes.find((function(e){return e.id===s}));if(s===p)o.push(((r={})[s]=g,r));else if(s in f){if(!f[p].has(a)){for(var l=!0,c=[a,g],u=d[p];f[s].size&&!f[s].has(u)&&(c.push(u),u!==d[u.id]);)u=d[u.id];if(c.push(u),t&&n?(l=!1,c.findIndex((function(e){return t.indexOf(e.id)>-1}))>-1&&(l=!0)):t&&!n&&c.findIndex((function(e){return t.indexOf(e.id)>-1}))>-1&&(l=!1),l){for(var v={},y=1;y<c.length;y+=1)v[c[y-1].id]=c[y];c.length&&(v[c[c.length-1].id]=c[0]),o.push(v)}f[s].add(g)}}else d[s]=g,h.push(a),f[s]=new Set([g])},y=0;y<m.length;y+=1)v(y)}return o};Zg.detectAllUndirectedCycle=sp;var ap=function(e,t,n){void 0===n&&(n=!0);for(var i=[],r=new Set,o=[],s=[],a={},l={},c=function e(l,c,u){var h=!1;if(t&&!1===n&&t.indexOf(l.id)>-1)return h;i.push(l),r.add(l);for(var d=u[l.id],f=0;f<d.length;f+=1){if((m=a[d[f]])===c){for(var g={},p=1;p<i.length;p+=1)g[i[p-1].id]=i[p];i.length&&(g[i[i.length-1].id]=i[0]),s.push(g),h=!0}else r.has(m)||e(m,c,u)&&(h=!0)}if(h)!function(e){for(var t=[e];t.length>0;){var n=t.pop();r.has(n)&&(r.delete(n),o[n.id].forEach((function(e){t.push(e)})),o[n.id].clear())}}(l);else for(f=0;f<d.length;f+=1){var m=a[d[f]];o[m.id].has(l)||o[m.id].add(l)}return i.pop(),h},u=e.nodes,h=void 0===u?[]:u,d=0;d<h.length;d+=1){var f=h[d],g=f.id;l[g]=d,a[d]=f}if(t&&n){var p=function(e){var n=t[e];l[h[e].id]=l[n],l[n]=0,a[0]=h.find((function(e){return e.id===n})),a[l[h[e].id]]=h[e]};for(d=0;d<t.length;d++)p(d)}for(var m=function(i){for(var r,o,a=1/0,c=0;c<i.length;c+=1)for(var u=i[c],h=0;h<u.length;h++){var d=l[u[h].id];d<a&&(a=d,o=c)}var f=i[o],g=[];for(c=0;c<f.length;c+=1){var p=f[c];g[p.id]=[];for(var m=0,v=(0,rp.getNeighbors)(p.id,e.edges,"target").filter((function(e){return f.map((function(e){return e.id})).indexOf(e)>-1}));m<v.length;m++){var y=v[m];y!==p.id||!1===n&&t.indexOf(p.id)>-1?g[p.id].push(l[y]):s.push(((r={})[p.id]=p,r))}}return{component:f,adjList:g,minIdx:a}},v=0;v<h.length;){var y=h.filter((function(e){return l[e.id]>=v})),_=(0,ip.detectStrongConnectComponents)({nodes:y,edges:e.edges}).filter((function(e){return e.length>1}));if(0===_.length)break;var b=m(_),w=b.minIdx,C=b.adjList,S=b.component;if(!(S.length>1))break;S.forEach((function(e){o[e.id]=new Set}));var x=a[w];if(t&&n&&-1===t.indexOf(x.id))return s;c(x,x,C),v=w+1}return s};Zg.detectAllDirectedCycle=ap;Zg.detectAllCycles=function(e,t,n,i){return void 0===i&&(i=!0),t?ap(e,n,i):sp(e,n,i)};var lp=function(e){var t=null,n=e.nodes,i={},r={},o={},s={};(void 0===n?[]:n).forEach((function(e){r[e.id]=e}));for(var a={enter:function(e){var n=e.current,s=e.previous;if(o[n]){t={};for(var a=n,l=s;l!==n;)t[a]=l,a=l,l=i[l];t[a]=l}else o[n]=n,delete r[n],i[n]=s},leave:function(e){var t=e.current;s[t]=t,delete o[t]},allowTraversal:function(e){var n=e.next;return!t&&!s[n]}};Object.keys(r).length;){var l=Object.keys(r)[0];(0,np.default)(e,l,a)}return t};Zg.default=lp;var cp={},up={exports:{}};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
!function(e){var t,n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v,_,b,w,C,S,x,E;!function(k){var L="object"==typeof y?y:"object"==typeof self?self:"object"==typeof this?this:{};function D(e,t){return e!==L&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,i){return e[n]=t?t(n,i):i}}!function(e){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};t=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},r=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=function(e,t){return function(n,i){t(n,i,e)}},s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=function(e,t,n,i){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{l(i.next(e))}catch(t){o(t)}}function a(e){try{l(i.throw(e))}catch(t){o(t)}}function l(e){e.done?n(e.value):r(e.value).then(s,a)}l((i=i.apply(e,t||[])).next())}))},l=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return l([e,t])}}function l(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},c=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||E(t,e,n)},E=Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]},u=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},h=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},d=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e},f=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i},g=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},p=function(e){return this instanceof p?(this.v=e,this):new p(e)},m=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{l(r[e](t))}catch(n){h(o[0][3],n)}}function l(e){e.value instanceof p?Promise.resolve(e.value.v).then(c,u):h(o[0][2],e)}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}},v=function(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:p(e[i](t)),done:"return"===i}:r?r(t):t}:r}},_=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=u(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,o){r(i,o,(t=e[n](t)).done,t.value)}))}}function r(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}},b=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var k=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&E(t,e,n);return k(t,e),t},C=function(e){return e&&e.__esModule?e:{default:e}},S=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},x=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n},e("__extends",t),e("__assign",n),e("__rest",i),e("__decorate",r),e("__param",o),e("__metadata",s),e("__awaiter",a),e("__generator",l),e("__exportStar",c),e("__createBinding",E),e("__values",u),e("__read",h),e("__spread",d),e("__spreadArrays",f),e("__spreadArray",g),e("__await",p),e("__asyncGenerator",m),e("__asyncDelegator",v),e("__asyncValues",_),e("__makeTemplateObject",b),e("__importStar",w),e("__importDefault",C),e("__classPrivateFieldGet",S),e("__classPrivateFieldSet",x)}(D(L,D(e.exports)))}()}(up);var hp=E(Eo);Object.defineProperty(cp,"__esModule",{value:!0}),cp.default=void 0;var dp=up.exports,fp=hp,gp=zg,pp=function(e,t,n,i){var r=e.nodes,o=void 0===r?[]:r,s=e.edges,a=void 0===s?[]:s,l={},c={},u={};o.forEach((function(e,n){var i=e.id;c[i]=1/0,i===t&&(c[i]=0)}));for(var h=o.length,d=function(e){var t=function(e,t,n){for(var i,r=1/0,o=0;o<t.length;o++){var s=t[o].id;!n[s]&&e[s]<=r&&(r=e[s],i=t[o])}return i}(c,o,l),r=t.id;if(l[r]=!0,c[r]===1/0)return"continue";(n?(0,gp.getOutEdgesNodeId)(r,a):(0,gp.getEdgesByNodeId)(r,a)).forEach((function(e){var n=e.target,o=e.source,s=n===r?o:n,a=i&&e[i]?e[i]:1;c[s]>c[t.id]+a?(c[s]=c[t.id]+a,u[s]=[t.id]):c[s]===c[t.id]+a&&u[s].push(t.id)}))},f=0;f<h;f++)d();u[t]=[t];var g={};for(var p in c)c[p]!==1/0&&mp(t,p,u,g);var m={};for(var p in g)m[p]=g[p][0];return{length:c,path:m,allPath:g}};function mp(e,t,n,i){if(e===t)return[e];if(i[t])return i[t];for(var r=[],o=0,s=n[t];o<s.length;o++){var a=mp(e,s[o],n,i);if(!a)return;for(var l=0,c=a;l<c.length;l++){var u=c[l];(0,fp.isArray)(u)?r.push((0,dp.__spreadArray)((0,dp.__spreadArray)([],u,!0),[t],!1)):r.push([u,t])}}return i[t]=r,i[t]}cp.default=pp;var vp={};Object.defineProperty(vp,"__esModule",{value:!0}),vp.findShortestPath=vp.findAllPath=void 0;var yp=function(e){return e&&e.__esModule?e:{default:e}}(cp),_p=zg;vp.findShortestPath=function(e,t,n,i,r){var o=(0,yp.default)(e,t,i,r),s=o.length,a=o.path,l=o.allPath;return{length:s[n],path:a[n],allPath:l[n]}};vp.findAllPath=function(e,t,n,i){var r;if(t===n)return[[t]];var o=e.edges,s=void 0===o?[]:o,a=[t],l=((r={})[t]=!0,r),c=[],u=[],h=i?(0,_p.getNeighbors)(t,s,"target"):(0,_p.getNeighbors)(t,s);for(c.push(h);a.length>0&&c.length>0;){var d=c[c.length-1];if(d.length){var f=d.shift();if(f&&(a.push(f),l[f]=!0,h=i?(0,_p.getNeighbors)(f,s,"target"):(0,_p.getNeighbors)(f,s),c.push(h.filter((function(e){return!l[e]})))),a[a.length-1]===n){var g=a.map((function(e){return e}));u.push(g);p=a.pop();l[p]=!1,c.pop()}}else{var p=a.pop();l[p]=!1,c.pop()}}return u};var bp={};Object.defineProperty(bp,"__esModule",{value:!0}),bp.default=void 0;var wp=function(e){return e&&e.__esModule?e:{default:e}}(Ng);var Cp=function(e,t){for(var n=(0,wp.default)(e,t),i=[],r=n.length,o=0;o<r;o+=1){i[o]=[];for(var s=0;s<r;s+=1)o===s?i[o][s]=0:0!==n[o][s]&&n[o][s]?i[o][s]=n[o][s]:i[o][s]=1/0}for(var a=0;a<r;a+=1)for(o=0;o<r;o+=1)for(s=0;s<r;s+=1)i[o][s]>i[o][a]+i[a][s]&&(i[o][s]=i[o][a]+i[a][s]);return i};bp.default=Cp;var Sp={};Object.defineProperty(Sp,"__esModule",{value:!0}),Sp.default=void 0;var xp=function(e){return e&&e.__esModule?e:{default:e}}(Ng),Ep=zg;var kp=function(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n="weight"),void 0===i&&(i=1e3);var r=e.nodes,o=void 0===r?[]:r,s=e.edges,a=void 0===s?[]:s,l={},c={};o.forEach((function(e,t){var n=(0,Ep.uniqueId)();e.clusterId=n,l[n]={id:n,nodes:[e]},c[e.id]={node:e,idx:t}}));var u=(0,xp.default)(e,t),h={};u.forEach((function(e,t){var n=o[t].id;h[n]={},e.forEach((function(e,t){if(e){var i=o[t].id;h[n][i]=e}}))}));for(var d=0,f=function(){var e=!1;if(o.forEach((function(t){var n={};Object.keys(h[t.id]).forEach((function(e){var i=h[t.id][e],r=c[e].node.clusterId;n[r]||(n[r]=0),n[r]+=i}));var i=-1/0,r=[];if(Object.keys(n).forEach((function(e){i<n[e]?(i=n[e],r=[e]):i===n[e]&&r.push(e)})),1!==r.length||r[0]!==t.clusterId){var o=r.indexOf(t.clusterId);if(o>=0&&r.splice(o,1),r&&r.length){e=!0;var s=l[t.clusterId],a=s.nodes.indexOf(t);s.nodes.splice(a,1);var u=Math.floor(Math.random()*r.length),d=l[r[u]];d.nodes.push(t),t.clusterId=d.id}}})),!e)return"break";d++};d<i;){if("break"===f())break}Object.keys(l).forEach((function(e){var t=l[e];t.nodes&&t.nodes.length||delete l[e]}));var g=[],p={};a.forEach((function(e){var t=e.source,i=e.target,r=e[n]||1,o=c[t].node.clusterId,s=c[i].node.clusterId,a="".concat(o,"---").concat(s);if(p[a])p[a].weight+=r,p[a].count++;else{var l={source:o,target:s,weight:r,count:1};p[a]=l,g.push(l)}}));var m=[];return Object.keys(l).forEach((function(e){m.push(l[e])})),{clusters:m,clusterEdges:g}};Sp.default=kp;var Lp={},Dp={};Object.defineProperty(Dp,"__esModule",{value:!0}),Dp.default=void 0;var Np=hp,Ip=function(){function e(e){this.arr=e}return e.prototype.getArr=function(){return this.arr||[]},e.prototype.add=function(t){var n,i=t.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new e(i);if(!(null==i?void 0:i.length))return new e(this.arr);if(this.arr.length===i.length){var r=[];for(var o in this.arr)r[o]=this.arr[o]+i[o];return new e(r)}},e.prototype.subtract=function(t){var n,i=t.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new e(i);if(!(null==i?void 0:i.length))return new e(this.arr);if(this.arr.length===i.length){var r=[];for(var o in this.arr)r[o]=this.arr[o]-i[o];return new e(r)}},e.prototype.avg=function(t){var n=[];if(0!==t)for(var i in this.arr)n[i]=this.arr[i]/t;return new e(n)},e.prototype.negate=function(){var t=[];for(var n in this.arr)t[n]=-this.arr[n];return new e(t)},e.prototype.squareEuclideanDistance=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=Math.pow(this.arr[r]-e.arr[r],2);return i}},e.prototype.euclideanDistance=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=Math.pow(this.arr[r]-e.arr[r],2);return Math.sqrt(i)}console.error("The two vectors are unequal in length.")},e.prototype.normalize=function(){var t=[],n=(0,Np.clone)(this.arr);n.sort((function(e,t){return e-t}));var i=n[n.length-1],r=n[0];for(var o in this.arr)t[o]=(this.arr[o]-r)/(i-r);return new e(t)},e.prototype.norm2=function(){var e;if(!(null===(e=this.arr)||void 0===e?void 0:e.length))return 0;var t=0;for(var n in this.arr)t+=Math.pow(this.arr[n],2);return Math.sqrt(t)},e.prototype.dot=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var i=0;for(var r in this.arr)i+=this.arr[r]*e.arr[r];return i}console.error("The two vectors are unequal in length.")},e.prototype.equal=function(e){var t,n=e.arr;if((null===(t=this.arr)||void 0===t?void 0:t.length)!==(null==n?void 0:n.length))return!1;for(var i in this.arr)if(this.arr[i]!==n[i])return!1;return!0},e}();Dp.default=Ip;var Tp={},Mp={};Object.defineProperty(Mp,"__esModule",{value:!0}),Mp.secondReg=Mp.dateReg=void 0;Mp.secondReg=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/;Mp.dateReg=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/,Object.defineProperty(Tp,"__esModule",{value:!0}),Tp.getPropertyWeight=Tp.getAllSortProperties=Tp.getAllProperties=Tp.default=void 0;var Ap=Mp,Op=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=100);var n={};e.forEach((function(e){e.properties&&Object.keys(e.properties).forEach((function(t){"id"===t||!"".concat(e.properties[t]).match(Ap.secondReg)&&!"".concat(e.properties[t]).match(Ap.dateReg)&&isNaN(Number(e.properties[t]))?n.hasOwnProperty(t)&&delete n[t]:n.hasOwnProperty(t)?n[t]+=1:n[t]=1}))}));var i=Object.keys(n).sort((function(e,t){return n[t]-n[e]}));return i.length<t?i:i.slice(0,t)};Tp.getAllSortProperties=Op;var Rp=function(e,t){return t.map((function(t){if(e.hasOwnProperty(t)){if(!isNaN(Number(e[t])))return Number(e[t]);if(e[t].match(Ap.secondReg)||e[t].match(Ap.dateReg))return Number(Date.parse(new Date(e[t])))/1e3}return 0}))},Pp=function(e){for(var t=Op(e),n=[],i=0;i<e.length;i++)n[i]=Rp(e[i].properties,t);return n};Tp.getPropertyWeight=Pp;var Fp=function(e,t){void 0===t&&(t=void 0);var n=[];return e.forEach((function(e){void 0===t&&n.push(e),void 0!==e[t]&&n.push(e[t])})),n};Tp.getAllProperties=Fp;var Bp={getAllSortProperties:Op,getPropertyWeight:Pp,getAllProperties:Fp};Tp.default=Bp;var Wp,zp={},Vp={};Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.DistanceType=void 0,Vp.DistanceType=Wp,(Wp||(Vp.DistanceType=Wp={})).EuclideanDistance="euclideanDistance",Object.defineProperty(zp,"__esModule",{value:!0}),zp.oneHot=zp.getDistance=zp.getAllKeyValueMap=zp.default=void 0;var Up=hp,Hp=Vp,jp=function(e){return e&&e.__esModule?e:{default:e}}(Dp);var Gp=function(e,t,n){var i=[];(null==t?void 0:t.length)?i=t:(e.forEach((function(e){i=i.concat(Object.keys(e))})),i=(0,Up.uniq)(i));var r={};return i.forEach((function(t){var i=[];e.forEach((function(e){void 0!==e[t]&&""!==e[t]&&i.push(e[t])})),i.length&&!(null==n?void 0:n.includes(t))&&(r[t]=(0,Up.uniq)(i))})),r};zp.getAllKeyValueMap=Gp;var Kp=function(e,t,n){var i=Gp(e,t,n),r=[];return Object.keys(i).length?(e.forEach((function(e,t){var n=[];if(1===Object.keys(i).length){var o=Object.keys(i)[0];i[o].every((function(e){return!isNaN(Number(e))}))&&(n=[e[o]])}else Object.keys(i).forEach((function(t){for(var r=e[t],o=i[t],s=o.findIndex((function(e){return r===e})),a=[],l=0;l<o.length;l++)l===s?a.push(1):a.push(0);n=n.concat(a)}));r[t]=n})),r):r};zp.oneHot=Kp;var qp=function(e,t,n,i){void 0===n&&(n=Hp.DistanceType.EuclideanDistance);var r=0;switch(n){case Hp.DistanceType.EuclideanDistance:r=new jp.default(e).euclideanDistance(new jp.default(t))}return r};zp.getDistance=qp;var $p={getAllKeyValueMap:Gp,oneHot:Kp,getDistance:qp};zp.default=$p,Object.defineProperty(Lp,"__esModule",{value:!0}),Lp.default=void 0;var Yp=hp,Xp=em(Ng),Zp=em(Dp),Qp=Tp,Jp=zp;function em(e){return e&&e.__esModule?e:{default:e}}var tm=function(e,t,n,i){for(var r=t.length,o=2*i,s=0,a=0;a<r;a++)for(var l=e[a].clusterId,c=0;c<r;c++){if(l===e[c].clusterId)s+=(t[a][c]||0)-(n[a]||0)*(n[c]||0)/o}return s*=1/o},nm=function(e,t){void 0===e&&(e=[]);for(var n=e.length,i=new Zp.default([]),r=0;r<n;r++)i=i.add(new Zp.default(t[r]));var o=i.avg(n);o.normalize();var s=0;for(r=0;r<n;r++){s+=(l=new Zp.default(t[r])).squareEuclideanDistance(o)}var a=[];e.forEach((function(){a.push([])}));for(r=0;r<n;r++){var l=new Zp.default(t[r]);e[r].clusterInertial=0;for(var c=0;c<n;c++)if(r!==c){var u=new Zp.default(t[c]);a[r][c]=l.squareEuclideanDistance(u),e[r].clusterInertial+=a[r][c]}else a[r][c]=0}var h=0,d=2*n*s;for(r=0;r<n;r++){var f=e[r].clusterId;for(c=0;c<n;c++){var g=e[c].clusterId;if(r!==c&&f===g)h+=e[r].clusterInertial*e[c].clusterInertial/Math.pow(d,2)-a[r][c]/d}}return Number(h.toFixed(4))},im=function(e,t,n,i,r,o,s,a,l){void 0===t&&(t=!1),void 0===n&&(n="weight"),void 0===i&&(i=1e-4),void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===s&&(s=[]),void 0===a&&(a=["id"]),void 0===l&&(l=1);var c=e.nodes,u=void 0===c?[]:c,h=e.edges,d=void 0===h?[]:h,f=[];if(r){u.forEach((function(e,t){e.properties=e.properties||{},e.originIndex=t}));var g=[];u.every((function(e){return e.hasOwnProperty("nodeType")}))&&(g=Array.from(new Set(u.map((function(e){return e.nodeType})))),u.forEach((function(e){e.properties.nodeType=g.findIndex((function(t){return t===e.nodeType}))})));var p=(0,Qp.getAllProperties)(u,o);f=(0,Jp.oneHot)(p,s,a)}var m=1,v={},y={};u.forEach((function(e,t){var n=String(m++);e.clusterId=n,v[n]={id:n,nodes:[e]},y[e.id]={node:e,idx:t}}));var _=(0,Xp.default)(e,t),b=[],w={},C=0;_.forEach((function(e,t){var n=0,i=u[t].id;w[i]={},e.forEach((function(e,t){if(e){n+=e;var r=u[t].id;w[i][r]=e,C+=e}})),b.push(n)})),C/=2;for(var S=1/0,x=1/0,E=0,k=[],L={};;){S=r&&u.every((function(e){return e.hasOwnProperty("properties")}))?tm(u,_,b,C)+nm(u,f)*l:tm(u,_,b,C),0===E&&(x=S,k=u,L=v);var D=S>0&&S>x&&S-x<i;if(S>x&&(k=u.map((function(e){return{node:e,clusterId:e.clusterId}})),L=(0,Yp.clone)(v),x=S),D||E>100)break;E++,Object.keys(v).forEach((function(e){var t=0;d.forEach((function(i){var r=i.source,o=i.target,s=y[r].node.clusterId,a=y[o].node.clusterId;(s===e&&a!==e||a===e&&s!==e)&&(t+=i[n]||1)})),v[e].sumTot=t})),u.forEach((function(e,t){var i,o=v[e.clusterId],s=0,a=b[t]/(2*C),c=0,u=o.nodes;u.forEach((function(e){var n=y[e.id].idx;c+=_[t][n]||0}));var h=c-o.sumTot*a,g=u.filter((function(t){return t.id!==e.id})),p=[];g.forEach((function(e,t){p[t]=f[e.originIndex]}));var m=nm(g,f)*l,S=w[e.id];if(Object.keys(S).forEach((function(n){var o=y[n].node.clusterId;if(o!==e.clusterId){var c=v[o],u=c.nodes;if(u&&u.length){var d=0;u.forEach((function(e){var n=y[e.id].idx;d+=_[t][n]||0}));var g=d-c.sumTot*a,p=u.concat([e]),b=[];p.forEach((function(e,t){b[t]=f[e.originIndex]}));var w=nm(p,f)*l,C=g-h;r&&(C=g+w-(h+m)),C>s&&(s=C,i=c)}}})),s>0){i.nodes.push(e);var x=e.clusterId;e.clusterId=i.id;var E=o.nodes.indexOf(e);o.nodes.splice(E,1);var k=0,L=0;d.forEach((function(e){var t=e.source,r=e.target,o=y[t].node.clusterId,s=y[r].node.clusterId;(o===i.id&&s!==i.id||s===i.id&&o!==i.id)&&(k+=e[n]||1),(o===x&&s!==x||s===x&&o!==x)&&(L+=e[n]||1)})),i.sumTot=k,o.sumTot=L}}))}var N={},I=0;Object.keys(L).forEach((function(e){var t=L[e];if(t.nodes&&t.nodes.length){var n=String(I+1);n!==e&&(t.id=n,t.nodes=t.nodes.map((function(e){return{id:e.id,clusterId:n}})),L[n]=t,N[e]=n,delete L[e],I++)}else delete L[e]})),k.forEach((function(e){var t=e.node,n=e.clusterId;t.clusterId=n,t.clusterId&&N[t.clusterId]&&(t.clusterId=N[t.clusterId])}));var T=[],M={};d.forEach((function(e){var t=e.source,i=e.target,r=e[n]||1,o=y[t].node.clusterId,s=y[i].node.clusterId,a="".concat(o,"---").concat(s);if(M[a])M[a].weight+=r,M[a].count++;else{var l={source:o,target:s,weight:r,count:1};M[a]=l,T.push(l)}}));var A=[];return Object.keys(L).forEach((function(e){A.push(L[e])})),{clusters:A,clusterEdges:T}};Lp.default=im;var rm={},om={};Object.defineProperty(om,"__esModule",{value:!0}),om.default=void 0;var sm=function(){function e(e){this.count=e.length,this.parent={};for(var t=0,n=e;t<n.length;t++){var i=n[t];this.parent[i]=i}}return e.prototype.find=function(e){for(;this.parent[e]!==e;)e=this.parent[e];return e},e.prototype.union=function(e,t){var n=this.find(e),i=this.find(t);n!==i&&(n<i?(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]):(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]))},e.prototype.connected=function(e,t){return this.find(e)===this.find(t)},e}();om.default=sm;var am={};Object.defineProperty(am,"__esModule",{value:!0}),am.default=void 0;var lm=function(e,t){return e-t},cm=function(){function e(e){void 0===e&&(e=lm),this.compareFn=e,this.list=[]}return e.prototype.getLeft=function(e){return 2*e+1},e.prototype.getRight=function(e){return 2*e+2},e.prototype.getParent=function(e){return 0===e?null:Math.floor((e-1)/2)},e.prototype.isEmpty=function(){return this.list.length<=0},e.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},e.prototype.delMin=function(){var e=this.top(),t=this.list.pop();return this.list.length>0&&(this.list[0]=t,this.moveDown(0)),e},e.prototype.insert=function(e){if(null!==e){this.list.push(e);var t=this.list.length-1;return this.moveUp(t),!0}return!1},e.prototype.moveUp=function(e){for(var t=this.getParent(e);e&&e>0&&this.compareFn(this.list[t],this.list[e])>0;){var n=this.list[t];this.list[t]=this.list[e],this.list[e]=n,e=t,t=this.getParent(e)}},e.prototype.moveDown=function(e){var t,n=e,i=this.getLeft(e),r=this.getRight(e),o=this.list.length;null!==i&&i<o&&this.compareFn(this.list[n],this.list[i])>0?n=i:null!==r&&r<o&&this.compareFn(this.list[n],this.list[r])>0&&(n=r),e!==n&&(t=[this.list[n],this.list[e]],this.list[e]=t[0],this.list[n]=t[1],this.moveDown(n))},e}();am.default=cm,Object.defineProperty(rm,"__esModule",{value:!0}),rm.default=void 0;var um=fm(om),hm=fm(am),dm=zg;function fm(e){return e&&e.__esModule?e:{default:e}}var gm=function(e,t){var n=[],i=e.nodes,r=void 0===i?[]:i,o=e.edges,s=void 0===o?[]:o;if(0===r.length)return n;var a=r[0],l=new Set;l.add(a);var c=new hm.default((function(e,n){return t?e.weight-n.weight:0}));for((0,dm.getEdgesByNodeId)(a.id,s).forEach((function(e){c.insert(e)}));!c.isEmpty();){var u=c.delMin(),h=u.source,d=u.target;l.has(h)&&l.has(d)||(n.push(u),l.has(h)||(l.add(h),(0,dm.getEdgesByNodeId)(h,s).forEach((function(e){c.insert(e)}))),l.has(d)||(l.add(d),(0,dm.getEdgesByNodeId)(d,s).forEach((function(e){c.insert(e)}))))}return n},pm=function(e,t){var n=[],i=e.nodes,r=void 0===i?[]:i,o=e.edges,s=void 0===o?[]:o;if(0===r.length)return n;var a=s.map((function(e){return e}));t&&a.sort((function(e,t){return e.weight-t.weight}));for(var l=new um.default(r.map((function(e){return e.id})));a.length>0;){var c=a.shift(),u=c.source,h=c.target;l.connected(u,h)||(n.push(c),l.union(u,h))}return n},mm=function(e,t,n){return n?{prim:gm,kruskal:pm}[n](e,t):pm(e,t)};rm.default=mm;var vm={};Object.defineProperty(vm,"__esModule",{value:!0}),vm.default=void 0;var ym=function(e){return e&&e.__esModule?e:{default:e}}($g),_m=zg;var bm=function(e,t,n){"number"!=typeof t&&(t=1e-6),"number"!=typeof n&&(n=.85);for(var i,r=1,o=0,s=1e3,a=e.nodes,l=void 0===a?[]:a,c=e.edges,u=void 0===c?[]:c,h=l.length,d={},f={},g=0;g<h;++g){d[m=(w=l[g]).id]=1/h,f[m]=1/h}for(var p=(0,ym.default)(e);s>0&&r>t;){o=0;for(g=0;g<h;++g){var m=(w=l[g]).id;if(i=0,0===p[w.id].inDegree)d[m]=0;else{for(var v=(0,_m.getNeighbors)(m,u,"source"),y=0;y<v.length;++y){var _=v[y],b=p[_].outDegree;b>0&&(i+=f[_]/b)}d[m]=n*i,o+=d[m]}}o=(1-o)/h,r=0;for(g=0;g<h;++g){var w;i=d[m=(w=l[g]).id]+o,r+=Math.abs(i-f[m]),f[m]=i}s-=1}return f};vm.default=bm;var wm={},Cm={},Sm={};Object.defineProperty(Sm,"__esModule",{value:!0}),Sm.VACANT_NODE_LABEL=Sm.VACANT_NODE_ID=Sm.VACANT_GRAPH_ID=Sm.VACANT_EDGE_LABEL=Sm.VACANT_EDGE_ID=Sm.Node=Sm.Graph=Sm.Edge=Sm.AUTO_EDGE_ID=void 0;Sm.VACANT_EDGE_ID=-1;Sm.VACANT_NODE_ID=-1;Sm.VACANT_EDGE_LABEL="-1";Sm.VACANT_NODE_LABEL="-1";Sm.VACANT_GRAPH_ID=-1;Sm.AUTO_EDGE_ID="-1";var xm=function(e,t,n,i){void 0===e&&(e=-1),void 0===t&&(t=-1),void 0===n&&(n=-1),void 0===i&&(i="-1"),this.id=e,this.from=t,this.to=n,this.label=i};Sm.Edge=xm;var Em=function(){function e(e,t){void 0===e&&(e=-1),void 0===t&&(t="-1"),this.id=e,this.label=t,this.edges=[],this.edgeMap={}}return e.prototype.addEdge=function(e){this.edges.push(e),this.edgeMap[e.id]=e},e}();Sm.Node=Em;var km=function(){function e(e,t,n){void 0===e&&(e=-1),void 0===t&&(t=!0),void 0===n&&(n=!1),this.id=e,this.edgeIdAutoIncrease=t,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n}return e.prototype.getNodeNum=function(){return this.nodes.length},e.prototype.addNode=function(e,t){if(!this.nodeMap[e]){var n=new Em(e,t);this.nodes.push(n),this.nodeMap[e]=n,this.nodeLabelMap[t]||(this.nodeLabelMap[t]=[]),this.nodeLabelMap[t].push(e)}},e.prototype.addEdge=function(e,t,n,i){if((this.edgeIdAutoIncrease||void 0===e)&&(e=this.counter++),!(this.nodeMap[t]&&this.nodeMap[n]&&this.nodeMap[n].edgeMap[e])){var r=new xm(e,t,n,i);if(this.edges.push(r),this.edgeMap[e]=r,this.nodeMap[t].addEdge(r),this.edgeLabelMap[i]||(this.edgeLabelMap[i]=[]),this.edgeLabelMap[i].push(r),!this.directed){var o=new xm(e,n,t,i);this.nodeMap[n].addEdge(o),this.edgeLabelMap[i].push(o)}}},e}();Sm.Graph=km,Object.defineProperty(Cm,"__esModule",{value:!0}),Cm.default=void 0;var Lm=hp,Dm=Sm,Nm=function(){function e(e,t,n,i,r){this.fromNode=e,this.toNode=t,this.nodeEdgeNodeLabel={nodeLabel1:n||Dm.VACANT_NODE_LABEL,edgeLabel:i||Dm.VACANT_EDGE_LABEL,nodeLabel2:r||Dm.VACANT_NODE_LABEL}}return e.prototype.equalTo=function(e){return this.fromNode===e.formNode&&this.toNode===e.toNode&&this.nodeEdgeNodeLabel===e.nodeEdgeNodeLabel},e.prototype.notEqualTo=function(e){return!this.equalTo(e)},e}(),Im=function(){function e(){this.rmpath=[],this.dfsEdgeList=[]}return e.prototype.equalTo=function(e){var t=this.dfsEdgeList.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(this.dfsEdgeList[n]!==e[n])return!1;return!0},e.prototype.notEqualTo=function(e){return!this.equalTo(e)},e.prototype.pushBack=function(e,t,n,i,r){return this.dfsEdgeList.push(new Nm(e,t,n,i,r)),this.dfsEdgeList},e.prototype.toGraph=function(e,t){void 0===e&&(e=Dm.VACANT_GRAPH_ID),void 0===t&&(t=!1);var n=new Dm.Graph(e,!0,t);return this.dfsEdgeList.forEach((function(e){var t=e.fromNode,i=e.toNode,r=e.nodeEdgeNodeLabel,o=r.nodeLabel1,s=r.edgeLabel,a=r.nodeLabel2;o!==Dm.VACANT_NODE_LABEL&&n.addNode(t,o),a!==Dm.VACANT_NODE_LABEL&&n.addNode(i,a),o!==Dm.VACANT_NODE_LABEL&&a!==o&&n.addEdge(void 0,t,i,s)})),n},e.prototype.buildRmpath=function(){this.rmpath=[];for(var e=void 0,t=this.dfsEdgeList.length-1;t>=0;t--){var n=this.dfsEdgeList[t],i=n.fromNode,r=n.toNode;i<r&&(void 0===e||r===e)&&(this.rmpath.push(t),e=i)}return this.rmpath},e.prototype.getNodeNum=function(){var e={};return this.dfsEdgeList.forEach((function(t){e[t.fromNode]||(e[t.fromNode]=!0),e[t.toNode]||(e[t.toNode]=!0)})),Object.keys(e).length},e}(),Tm=function(){function e(e){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],e){for(;e;){var t=e.edge;this.edges.push(t),this.nodesUsed[t.from]=1,this.nodesUsed[t.to]=1,this.edgesUsed[t.id]=1,e=e.preNode}this.edges=this.edges.reverse()}}return e.prototype.hasNode=function(e){return 1===this.nodesUsed[e.id]},e.prototype.hasEdge=function(e){return 1===this.edgesUsed[e.id]},e}(),Mm=function(){function e(e){var t=e.graphs,n=e.minSupport,i=void 0===n?2:n,r=e.minNodeNum,o=void 0===r?1:r,s=e.maxNodeNum,a=void 0===s?4:s,l=e.top,c=void 0===l?10:l,u=e.directed,h=void 0!==u&&u,d=e.verbose,f=void 0!==d&&d;this.graphs=t,this.dfsCode=new Im,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=i,this.top=c,this.directed=h,this.counter=0,this.maxNodeNum=a,this.minNodeNum=o,this.verbose=f,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return e.prototype.findForwardRootEdges=function(e,t){var n=this,i=[],r=e.nodeMap;return t.edges.forEach((function(e){(n.directed||t.label<=r[e.to].label)&&i.push(e)})),i},e.prototype.findBackwardEdge=function(e,t,n,i){if(!this.directed&&t===n)return null;for(var r=e.nodeMap,o=r[n.to].edges,s=o.length,a=0;a<s;a++){var l=o[a];if(!i.hasEdge(l)&&l.to===t.from)if(this.directed){if(r[t.from].label<r[n.to].label||r[t.from].label===r[n.to].label&&t.label<=l.label)return l}else if(t.label<l.label||t.label===l.label&&r[t.to].label<=r[n.to].label)return l}return null},e.prototype.findForwardPureEdges=function(e,t,n,i){for(var r=[],o=t.to,s=e.nodeMap[o].edges,a=s.length,l=0;l<a;l++){var c=s[l],u=e.nodeMap[c.to];n<=u.label&&!i.hasNode(u)&&r.push(c)}return r},e.prototype.findForwardRmpathEdges=function(e,t,n,i){for(var r=[],o=e.nodeMap,s=o[t.to].label,a=o[t.from].edges,l=a.length,c=0;c<l;c++){var u=a[c],h=o[u.to].label;t.to===u.to||n>h||i.hasNode(o[u.to])||(t.label<u.label||t.label===u.label&&s<=h)&&r.push(u)}return r},e.prototype.getSupport=function(e){var t={};return e.forEach((function(e){t[e.graphId]||(t[e.graphId]=!0)})),Object.keys(t).length},e.prototype.findMinLabel=function(e){var t=void 0;return Object.keys(e).forEach((function(n){var i=e[n],r=i.nodeLabel1,o=i.edgeLabel,s=i.nodeLabel2;t?(r<t.nodeLabel1||r===t.nodeLabel1&&o<t.edgeLabel||r===t.nodeLabel1&&o===t.edgeLabel&&s<t.nodeLabel2)&&(t={nodeLabel1:r,edgeLabel:o,nodeLabel2:s}):t={nodeLabel1:r,edgeLabel:o,nodeLabel2:s}})),t},e.prototype.isMin=function(){var e=this,t=this.dfsCode;if(this.verbose&&console.log("isMin checking",t),1===t.dfsEdgeList.length)return!0;var n=this.directed,i=t.toGraph(Dm.VACANT_GRAPH_ID,n),r=i.nodeMap,o=new Im,s={};i.nodes.forEach((function(t){e.findForwardRootEdges(i,t).forEach((function(e){var n=r[e.to],o="".concat(t.label,"-").concat(e.label,"-").concat(n.label);s[o]||(s[o]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:n.label});var a={graphId:i.id,edge:e,preNode:null};s[o].projected.push(a)}))}));var a=this.findMinLabel(s);if(a){o.dfsEdgeList.push(new Nm(0,1,a.nodeLabel1,a.edgeLabel,a.nodeLabel2));var l="".concat(a.nodeLabel1,"-").concat(a.edgeLabel,"-").concat(a.nodeLabel2);return function s(a){for(var l=o.buildRmpath(),c=o.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,u=o.dfsEdgeList[l[0]].toNode,h={},d=!1,f=0,g=n?-1:0,p=function(t){if(d)return"break";a.forEach((function(n){var r=new Tm(n),s=e.findBackwardEdge(i,r.edges[l[t]],r.edges[l[0]],r);s&&(h[s.label]||(h[s.label]={projected:[],edgeLabel:s.label}),h[s.label].projected.push({graphId:i.id,edge:h,preNode:n}),f=o.dfsEdgeList[l[t]].fromNode,d=!0)}))},m=l.length-1;m>g;m--){if("break"===p(m))break}if(d){var v=e.findMinLabel(h);o.dfsEdgeList.push(new Nm(u,f,Dm.VACANT_NODE_LABEL,v.edgeLabel,Dm.VACANT_NODE_LABEL));var y=o.dfsEdgeList.length-1;return e.dfsCode.dfsEdgeList[y]===o.dfsEdgeList[y]&&s(h[v.edgeLabel].projected)}var _={};d=!1;var b=0;a.forEach((function(t){var n=new Tm(t),o=e.findForwardPureEdges(i,n.edges[l[0]],c,n);o.length>0&&(d=!0,b=u,o.forEach((function(e){var n="".concat(e.label,"-").concat(r[e.to].label);_[n]||(_[n]={projected:[],edgeLabel:e.label,nodeLabel2:r[e.to].label}),_[n].projected.push({graphId:i.id,edge:e,preNode:t})})))}));var w=l.length,C=function(t){if(d)return"break";var n=l[t];a.forEach((function(t){var s=new Tm(t),a=e.findForwardRmpathEdges(i,s.edges[n],c,s);a.length>0&&(d=!0,b=o.dfsEdgeList[n].fromNode,a.forEach((function(e){var n="".concat(e.label,"-").concat(r[e.to].label);_[n]||(_[n]={projected:[],edgeLabel:e.label,nodeLabel2:r[e.to].label}),_[n].projected.push({graphId:i.id,edge:e,preNode:t})})))}))};for(m=0;m<w;m++){if("break"===C(m))break}if(!d)return!0;var S=e.findMinLabel(_);o.dfsEdgeList.push(new Nm(b,u+1,Dm.VACANT_NODE_LABEL,S.edgeLabel,S.nodeLabel2));var x=o.dfsEdgeList.length-1;return t.dfsEdgeList[x]===o.dfsEdgeList[x]&&s(_["".concat(S.edgeLabel,"-").concat(S.nodeLabel2)].projected)}(s[l].projected)}},e.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var e=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,Lm.clone)(e))}},e.prototype.subGraphMining=function(e){var t=this;if(!(this.getSupport(e)<this.minSupport)&&this.isMin()){this.report();var n=this.dfsCode.getNodeNum(),i=this.dfsCode.buildRmpath(),r=this.dfsCode.dfsEdgeList[i[0]].toNode,o=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,s={},a={};e.forEach((function(e){for(var l=t.graphs[e.graphId],c=l.nodeMap,u=new Tm(e),h=i.length-1;h>=0;h--){var d=t.findBackwardEdge(l,u.edges[i[h]],u.edges[i[0]],u);if(d){var f="".concat(t.dfsCode.dfsEdgeList[i[h]].fromNode,"-").concat(d.label);a[f]||(a[f]={projected:[],toNodeId:t.dfsCode.dfsEdgeList[i[h]].fromNode,edgeLabel:d.label}),a[f].projected.push({graphId:e.graphId,edge:d,preNode:e})}}if(!(n>=t.maxNodeNum)){t.findForwardPureEdges(l,u.edges[i[0]],o,u).forEach((function(t){var n="".concat(r,"-").concat(t.label,"-").concat(c[t.to].label);s[n]||(s[n]={projected:[],fromNodeId:r,edgeLabel:t.label,nodeLabel2:c[t.to].label}),s[n].projected.push({graphId:e.graphId,edge:t,preNode:e})}));var g=function(n){t.findForwardRmpathEdges(l,u.edges[i[n]],o,u).forEach((function(r){var o="".concat(t.dfsCode.dfsEdgeList[i[n]].fromNode,"-").concat(r.label,"-").concat(c[r.to].label);s[o]||(s[o]={projected:[],fromNodeId:t.dfsCode.dfsEdgeList[i[n]].fromNode,edgeLabel:r.label,nodeLabel2:c[r.to].label}),s[o].projected.push({graphId:e.graphId,edge:r,preNode:e})}))};for(h=0;h<i.length;h++)g(h)}})),Object.keys(a).forEach((function(e){var n=a[e],i=n.toNodeId,o=n.edgeLabel;t.dfsCode.dfsEdgeList.push(new Nm(r,i,"-1",o,"-1")),t.subGraphMining(a[e].projected),t.dfsCode.dfsEdgeList.pop()})),Object.keys(s).forEach((function(e){var n=s[e],i=n.fromNodeId,o=n.edgeLabel,a=n.nodeLabel2;t.dfsCode.dfsEdgeList.push(new Nm(i,r+1,Dm.VACANT_NODE_LABEL,o,a)),t.subGraphMining(s[e].projected),t.dfsCode.dfsEdgeList.pop()}))}},e.prototype.generate1EdgeFrequentSubGraphs=function(){var e=this.graphs,t=this.directed,n=this.minSupport,i=this.frequentSize1Subgraphs,r={},o={},s={},a={};return Object.keys(e).forEach((function(n){var i=e[n],l=i.nodeMap;i.nodes.forEach((function(e,i){var c=e.label,u="".concat(n,"-").concat(c);if(!s[u]){var h=r[c]||0;h++,r[c]=h}s[u]={graphKey:n,label:c},e.edges.forEach((function(e){var i=c,r=l[e.to].label;if(!t&&i>r){var s=r;r=i,i=s}var u=e.label,h="".concat(n,"-").concat(i,"-").concat(u,"-").concat(r),d="".concat(i,"-").concat(u,"-").concat(r);if(!o[d]){var f=o[d]||0;f++,o[d]=f}a[h]={graphId:n,nodeLabel1:i,edgeLabel:u,nodeLabel2:r}}))}))})),Object.keys(r).forEach((function(e){if(!(r[e]<n)){var t={nodes:[],edges:[]};t.nodes.push({id:"0",label:e}),i.push(t)}})),i},e.prototype.run=function(){var e=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var t=this.graphs;this.directed;var n={};Object.keys(t).forEach((function(i){var r=t[i],o=r.nodeMap;r.nodes.forEach((function(t){e.findForwardRootEdges(r,t).forEach((function(e){var r=o[e.to],s="".concat(t.label,"-").concat(e.label,"-").concat(r.label);n[s]||(n[s]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:r.label});var a={graphId:i,edge:e,preNode:null};n[s].projected.push(a)}))}))})),Object.keys(n).forEach((function(t){var i=n[t],r=i.projected,o=i.nodeLabel1,s=i.edgeLabel,a=i.nodeLabel2;e.dfsCode.dfsEdgeList.push(new Nm(0,1,o,s,a)),e.subGraphMining(r),e.dfsCode.dfsEdgeList.pop()}))}},e}(),Am=function(e){var t=e.graphs,n=e.directed,i=void 0!==n&&n,r=e.nodeLabelProp,o=void 0===r?"cluster":r,s=e.edgeLabelProp,a=void 0===s?"cluster":s,l=function(e,t,n,i){var r={};return Object.keys(e).forEach((function(o,s){var a=e[o],l=new Dm.Graph(s,!0,t),c={};a.nodes.forEach((function(e,t){l.addNode(t,e[n]),c[e.id]=t})),a.edges.forEach((function(e,t){var n=c[e.source],r=c[e.target];l.addEdge(-1,n,r,e[i])})),l&&l.getNodeNum()&&(r[l.id]=l)})),r}(t,i,o,a),c=e.minSupport,u=e.maxNodeNum,h=e.minNodeNum,d=e.verbose,f=e.top,g=new Mm({graphs:l,minSupport:c,maxNodeNum:u,minNodeNum:h,top:f,verbose:d,directed:i});return g.run(),function(e,t,n){var i=[];return e.forEach((function(e){var r={nodes:[],edges:[]};e.nodes.forEach((function(e){var n;r.nodes.push(((n={id:"".concat(e.id)})[t]=e.label,n))})),e.edges.forEach((function(e){var t;r.edges.push(((t={source:"".concat(e.from),target:"".concat(e.to)})[n]=e.label,t))})),i.push(r)})),i}(g.frequentSubgraphs,o,a)};Cm.default=Am,Object.defineProperty(wm,"__esModule",{value:!0}),wm.default=void 0;var Om=up.exports,Rm=Wm(bp),Pm=Wm(Cm),Fm=Wm(cp),Bm=zg;function Wm(e){return e&&e.__esModule?e:{default:e}}var zm=function(e,t,n,i){void 0===n&&(n="cluster"),void 0===i&&(i=2);var r=[],o=e.nodes;return t.forEach((function(e,t){r.push(Vm(o,e,t,n,i))})),r},Vm=function(e,t,n,i,r){var o=[n],s=[],a={};return t.forEach((function(t,l){if(t<=r&&n!==l){o.push(l),s.push(e[l]);var c=e[l][i];a[c]?(a[c].count++,a[c].dists.push(t)):a[c]={count:1,dists:[t]}}})),Object.keys(a).forEach((function(e){a[e].dists=a[e].dists.sort((function(e,t){return e-t}))})),{nodeIdx:n,nodeId:e[n].id,nodeIdxs:o,neighbors:s,neighborNum:o.length-1,nodeLabelCountMap:a}},Um=function(e,t,n,i){var r=n.nodes;return i||(i={}),Object.keys(e).forEach((function(o){var s,a;if(!i||!i[o]){i[o]={nodes:[],edges:[]};var l=e[o],c=null===(s=t[l.start])||void 0===s?void 0:s.nodeIdxs,u=null===(a=t[l.end])||void 0===a?void 0:a.nodeIdxs;if(c&&u){var h=new Set(u),d=c.filter((function(e){return h.has(e)}));if(d&&d.length){for(var f={},g=d.length,p=0;p<g;p++){var m=r[d[p]];i[o].nodes.push(m),f[m.id]=!0}n.edges.forEach((function(e){f[e.source]&&f[e.target]&&i[o].edges.push(e)}))}}}})),i},Hm=function(e,t,n,i){var r,o,s={};e.nodes.forEach((function(e){s[e.id]=e}));var a=0;return!(null===(r=null==t?void 0:t.edges)||void 0===r?void 0:r.length)||(null===(o=null==t?void 0:t.nodes)||void 0===o?void 0:o.length)<2?0:(e.edges.forEach((function(e){var r=s[e.source][n],o=s[e.target][n],l=null==t?void 0:t.nodes[0][n],c=null==t?void 0:t.nodes[1][n],u=null==t?void 0:t.edges[0][i];e[i]===u&&(r===l&&o===c||r===c&&o===l)&&a++})),a)},jm=function(e,t){var n={},i={};return e.forEach((function(e,r){n[e.id]={idx:r,node:e,degree:0,inDegree:0,outDegree:0};var o=e[t];i[o]||(i[o]=[]),i[o].push(e)})),{nodeMap:n,nodeLabelMap:i}},Gm=function(e,t,n){var i={},r={};return e.forEach((function(e,o){i["".concat(Bm.uniqueId)]={idx:o,edge:e};var s=e[t];r[s]||(r[s]=[]),r[s].push(e);var a=n[e.source];a&&(a.degree++,a.outDegree++);var l=n[e.target];l&&(l.degree++,l.inDegree++)})),{edgeMap:i,edgeLabelMap:r}},Km=function(e,t,n){var i=t.length,r={};return t.forEach((function(t,o){for(var s=n?0:o+1,a=e[o].id,l=s;l<i;l++)if(o!==l){var c=e[l].id,u=t[l];r["".concat(a,"-").concat(c)]=u,n||(r["".concat(c,"-").concat(a)]=u)}})),r},qm=function(e,t,n,i,r,o,s,a,l,c,u){var h,d="".concat(t.id,"-").concat(n.id);if(c&&c[d])return c[d];var f=u?u[d]:void 0;if(!f){var g=((h={})[d]={start:i[t.id].idx,end:i[n.id].idx,distance:r},h);f=(u=Um(g,o,e,u))[d]}return Hm(f,s,a,l)},$m=function(e,t,n,i){var r,o,s,a=null===(r=e[t])||void 0===r?void 0:r.degree,l=null===(o=e[t])||void 0===o?void 0:o.inDegree,c=null===(s=e[t])||void 0===s?void 0:s.outDegree;return void 0===e[t]&&(a=1/0,l=1/0,c=1/0,i[t].forEach((function(e){var t=n[e.id].degree;a>t&&(a=t);var i=n[e.id].inDegree;l>i&&(l=i);var r=n[e.id].outDegree;c>r&&(c=r)})),e[t]={degree:a,inDegree:l,outDegree:c}),{minPatternNodeLabelDegree:a,minPatternNodeLabelInDegree:l,minPatternNodeLabelOutDegree:c}},Ym=function(e,t,n,i,r,o,s){var a;if(void 0===n&&(n=!1),void 0===o&&(o="cluster"),void 0===s&&(s="cluster"),e&&e.nodes){var l=e.nodes.length;if(l){var c=(0,Rm.default)(e,n),u=(0,Rm.default)(t,n),h=Km(e.nodes,c,n),d=Km(t.nodes,u,n),f=jm(e.nodes,o),g=f.nodeMap,p=f.nodeLabelMap,m=jm(t.nodes,o),v=m.nodeMap,y=m.nodeLabelMap;Gm(e.edges,s,g);var _=Gm(t.edges,s,v).edgeLabelMap,b=[];null==u||u.forEach((function(e){b=b.concat(e)})),r||(r=Math.max.apply(Math,(0,Om.__spreadArray)((0,Om.__spreadArray)([],b,!1),[2],!1))),i||(i=r);var w=zm(e,c,o,i),C=zm(t,u,o,i),S=function(e,t,n,i,r){var o=Math.ceil(n/t),s={},a=0;return i.forEach((function(e,i){for(var l=0,c=0,u=e.nodeIdxs,h=e.neighborNum-1;l<o;){for(var d=u[1+Math.floor(Math.random()*h)],f=0;(s["".concat(i,"-").concat(d)]||s["".concat(d,"-").concat(i)])&&(d=Math.floor(Math.random()*t),!(++f>2*t)););if(f<2*t&&(s["".concat(i,"-").concat(d)]={start:i,end:d,distance:r[i][d]},l++,++a>=n))return s;if(++c>2*t)break}l<o&&(o=(o+(o-l))/(t-i-1))})),s}(0,l,Math.min(100,l*(l-1)/2),w,c),x=Um(S,w,e),E={graphs:x,nodeLabelProp:o,edgeLabelProp:s,minSupport:1,minNodeNum:1,maxNodeNum:4,directed:n},k=(0,Pm.default)(E).slice(0,10),L=k.length,D=[];k.forEach((function(e,t){D[t]={},Object.keys(x).forEach((function(n){var i=x[n],r=Hm(i,e,o,s);D[t][n]=r}))}));var N=function(e,t,n){for(var i=1/0,r=0,o=function(t){var n=e[t],o=Object.keys(n).sort((function(e,t){return n[e]-n[t]})),s=[];o.forEach((function(e,t){s[t%10]||(s[t%10]={graphs:[],totalCount:0,aveCount:0}),s[t%10].graphs.push(e),s[t%10].totalCount+=n[e]}));var a=0,l=[];s.forEach((function(e){var t=e.totalCount/e.graphs.length;e.aveCount=t,l.push(t);var i=0,r=e.length;e.graphs.forEach((function(t,r){var o=n[t];e.graphs.forEach((function(e,t){r!==t&&(i+=Math.abs(o-n[e]))}))})),a+=i/=r*(r-1)/2})),a/=s.length;var c=0;l.forEach((function(e,t){l.forEach((function(n,i){t!==i&&(c+=Math.abs(e-n))})),c/=l.length*(l.length-1)/2}));var u=c-a;i<u&&(i=u,r=t)},s=0;s<t;s++)o(s);return{structure:n[r],structureCountMap:e[r]}}(D,L,k),I=N.structure,T=N.structureCountMap,M=t.nodes[0],A=[],O=null===(a=t.nodes[0])||void 0===a?void 0:a[o],R=-1/0;t.nodes.forEach((function(e){var t=e[o],n=p[t];(null==n?void 0:n.length)>R&&(R=n.length,A=n,O=t,M=e)}));var P={},F={},B={},W={},z={},V={};Object.keys(y).forEach((function(i,r){z[i]=[],n&&(V[i]=[]);var a=y[i],l={};a.forEach((function(e){var t=d["".concat(M.id,"-").concat(e.id)];if(t&&z[i].push(t),l["".concat(M.id,"-").concat(e.id)]={start:0,end:v[e.id].idx,distance:t},n){var r=d["".concat(e.id,"-").concat(M.id)];r&&V[i].push(r)}})),z[i]=z[i].sort((function(e,t){return e-t})),n&&(V[i]=V[i].sort((function(e,t){return e-t}))),F=Um(l,C,t,F);var c=[];if(Object.keys(l).forEach((function(e){if(B[e])c.push(B[e]);else{var t=F[e];B[e]=Hm(t,I,o,s),c.push(B[e])}})),c=c.sort((function(e,t){return t-e})),W["".concat(M.id,"-").concat(i)]=c,i!==O)for(var u=function(t){var n=A[t],r=w[g[n.id].idx],a=r.nodeLabelCountMap[i],l=y[i].length;if(!a||a.count<l)return A.splice(t,1),"continue";for(var u=!1,d=0;d<l;d++)if(a.dists[d]>z[i][d]){u=!0;break}if(u)return A.splice(t,1),"continue";var f={};r.neighbors.forEach((function(e){var t=h["".concat(n.id,"-").concat(e.id)];f["".concat(n.id,"-").concat(e.id)]={start:g[n.id].idx,end:g[e.id].idx,distance:t}})),x=Um(f,w,e,x);var p=[];Object.keys(f).forEach((function(e){if(T[e])p.push(T[e]);else{var t=x[e];T[e]=Hm(t,I,o,s),p.push(T[e])}})),p=p.sort((function(e,t){return t-e}));var m=!1;for(d=0;d<l;d++)if(p[d]<c[d]){m=!0;break}return m?(A.splice(t,1),"continue"):void 0},f=((null==A?void 0:A.length)||0)-1;f>=0;f--)u(f)}));var U=[];null==A||A.forEach((function(i){for(var a=g[i.id].idx,l=Vm(e.nodes,c[a],a,o,r).neighbors,u=!1,d=l.length-1;d>=0;d--){if(l.length+1<t.nodes.length)return void(u=!0);var f=l[d],p=f[o];if(y[p]&&y[p].length)if(z[p]&&z[p].length){var m="".concat(i.id,"-").concat(f.id),_=h[m],b=z[p].length-1;if(_>z[p][b])l.splice(d,1);else{if(n){var C="".concat(f.id,"-").concat(i.id),S=h[C];if(b=V[p].length-1,S>V[p][b]){l.splice(d,1);continue}}var E=T[m]?T[m]:qm(e,i,f,g,_,w,I,o,s,T,x),k="".concat(M.id,"-").concat(p);if(E<W[k][W[k].length-1])l.splice(d,1);else{var L=$m(P,p,v,y),D=L.minPatternNodeLabelDegree;L.minPatternNodeLabelInDegree,L.minPatternNodeLabelOutDegree,g[f.id].degree<D&&l.splice(d,1)}}}else l.splice(d,1);else l.splice(d,1)}u||U.push({nodes:[i].concat(l)})}));var H=(0,Fm.default)(t,M.id,!1).length,j={};n?(Object.keys(H).forEach((function(e){var t=v[e].node[o];j[t]?j[t].push(H[e]):j[t]=[H[e]]})),Object.keys(j).forEach((function(e){j[e].sort((function(e,t){return e-t}))}))):j=z;for(var G=function(i){var r=U[i],a=r.nodes[0],l={},c={};r.nodes.forEach((function(e,t){c[e.id]={idx:t,node:e,degree:0,inDegree:0,outDegree:0};var n=e[o];l[n]?l[n]++:l[n]=1}));var u=[],h={};e.edges.forEach((function(e){c[e.source]&&c[e.target]&&(u.push(e),h[e[s]]?h[e[s]]++:h[e[s]]=1,c[e.source].degree++,c[e.target].degree++,c[e.source].outDegree++,c[e.target].inDegree++)}));for(var d=Object.keys(_).length,f=!1,p=0;p<d;p++){var m=Object.keys(_)[p];if(!h[m]||h[m]<_[m].length){f=!0;break}}if(f)return U.splice(i,1),"continue";var b=u.length;if(b<t.edges.length)return U.splice(i,1),"break";var w=!1,C=function(e){var t=u[e],i=t[s],r=_[i];if(!r||!r.length)return h[i]--,r&&h[i]<r.length?(w=!0,"break"):(u.splice(e,1),c[t.source].degree--,c[t.target].degree--,c[t.source].outDegree--,c[t.target].inDegree--,"continue");var a=c[t.source].node[o],l=c[t.target].node[o],d=!1;return r.forEach((function(e){var t=v[e.source].node,i=v[e.target].node;t[o]===a&&i[o]===l&&(d=!0),n||t[o]!==l||i[o]!==a||(d=!0)})),d?void 0:(h[i]--,r&&h[i]<r.length?(w=!0,"break"):(u.splice(e,1),c[t.source].degree--,c[t.target].degree--,c[t.source].outDegree--,c[t.target].inDegree--,"continue"))};for(p=b-1;p>=0;p--){if("break"===C(p))break}if(w)return U.splice(i,1),"continue";r.edges=u;var S=(0,Fm.default)(r,r.nodes[0].id,!1).length;if(Object.keys(S).reverse().forEach((function(e){if(e!==r.nodes[0].id&&!w){if(S[e]===1/0){var t=c[e].node[o];if(l[t]--,l[t]<y[t].length)return void(w=!0);var n=r.nodes.indexOf(c[e].node);return r.nodes.splice(n,1),void(c[e]=void 0)}var i=g[e].node[o];if(!j[i]||!j[i].length||S[e]>j[i][j[i].length-1]){t=c[e].node[o];if(l[t]--,l[t]<y[t].length)return void(w=!0);n=r.nodes.indexOf(c[e].node);r.nodes.splice(n,1),c[e]=void 0}}})),w)return U.splice(i,1),"continue";for(var x=!0,E=0;x&&!w;){if(x=!1,n?c[a.id].degree<v[M.id].degree||c[a.id].inDegree<v[M.id].inDegree||c[a.id].outDegree<v[M.id].outDegree:c[a.id].degree<v[M.id].degree){w=!0;break}if(l[a[o]]<y[a[o]].length){w=!0;break}for(var k=r.nodes.length-1;k>=0;k--){var L=r.nodes[k],D=c[L.id].degree,N=c[L.id].inDegree,I=c[L.id].outDegree,T=L[o],A=$m(P,T,v,y),O=A.minPatternNodeLabelDegree,R=A.minPatternNodeLabelInDegree,F=A.minPatternNodeLabelOutDegree;if(n?D<O||N<R||I<F:D<O){if(l[L[o]]--,l[L[o]]<y[L[o]].length){w=!0;break}r.nodes.splice(k,1),c[L.id]=void 0,x=!0}}if(w||!x&&0!==E)break;for(var B=(b=u.length)-1;B>=0;B--){var W=u[B];if(!c[W.source]||!c[W.target]){u.splice(B,1);var z=W[s];if(h[z]--,c[W.source]&&(c[W.source].degree--,c[W.source].outDegree--),c[W.target]&&(c[W.target].degree--,c[W.target].inDegree--),_[z]&&h[z]<_[z].length){w=!0;break}x=!0}}E++}return w||w||r.nodes.length<t.nodes.length||u.length<t.edges.length?(U.splice(i,1),"continue"):void 0},K=U.length-1;K>=0;K--){if("break"===G(K))break}var q=U.length,$=function(e){var t=U[e],n={};t.edges.forEach((function(e){var t="".concat(e.source,"-").concat(e.target,"-").concat(e.label);n[t]?n[t]++:n[t]=1}));for(var i=function(e){var t=U[e],i={};t.edges.forEach((function(e){var t="".concat(e.source,"-").concat(e.target,"-").concat(e.label);i[t]?i[t]++:i[t]=1}));var r=!0;Object.keys(i).length!==Object.keys(n).length?r=!1:Object.keys(n).forEach((function(e){i[e]!==n[e]&&(r=!1)})),r&&U.splice(e,1)},r=q-1;r>e;r--)i(r);q=U.length};for(K=0;K<=q-1;K++)$(K);return U}}};function Xm(e){return(Xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}wm.default=Ym,function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"GADDI",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"breadthFirstSearch",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"connectedComponent",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"depthFirstSearch",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"detectCycle",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"dijkstra",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"findAllPath",{enumerable:!0,get:function(){return c.findAllPath}}),Object.defineProperty(e,"findShortestPath",{enumerable:!0,get:function(){return c.findShortestPath}}),Object.defineProperty(e,"floydWarshall",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"getAdjMatrix",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"getDegree",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"getInDegree",{enumerable:!0,get:function(){return o.getInDegree}}),Object.defineProperty(e,"getNeighbors",{enumerable:!0,get:function(){return m.getNeighbors}}),Object.defineProperty(e,"getOutDegree",{enumerable:!0,get:function(){return o.getOutDegree}}),Object.defineProperty(e,"labelPropagation",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"louvain",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"minimumSpanningTree",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"pageRank",{enumerable:!0,get:function(){return g.default}});var n=y(Ng),i=y(Tg),r=y(jg),o=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==t(e)&&"function"!=typeof e)return{default:e};var i=v(n);if(i&&i.has(e))return i.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}r.default=e,i&&i.set(e,r);return r}($g),s=y(Zg),a=y(Qg),l=y(cp),c=vp,u=y(bp),h=y(Sp),d=y(Lp),f=y(rm),g=y(vm),p=y(wm),m=zg;function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(v=function(e){return e?n:t})(e)}function y(e){return e&&e.__esModule?e:{default:e}}}(Dg),Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.default=void 0;var Zm=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==Xm(e)&&"function"!=typeof e)return{default:e};var n=Jm(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}i.default=e,n&&n.set(e,i);return i}(Dg),Qm=kg;function Jm(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Jm=function(e){return e?n:t})(e)}var ev="undefined"!=typeof self?self:{};ev.onmessage=function(e){var t=e.data,n=t._algorithmType,i=t.data;if(n)if("function"!=typeof Zm[n])ev.postMessage({_algorithmType:Qm.MESSAGE.FAILURE});else{var r=Zm[n].apply(Zm,i);ev.postMessage({_algorithmType:Qm.MESSAGE.SUCCESS,data:r})}};Lg.default=null,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.default=void 0;var tv=kg,nv=function(e){return e&&e.__esModule?e:{default:e}}(Lg);var iv=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new Promise((function(n,i){var r=new nv.default;r.postMessage({_algorithmType:e,data:t}),r.onmessage=function(e){var t=e.data,o=t.data,s=t._algorithmType;tv.MESSAGE.SUCCESS===s?n(o):i(),r.terminate()}}))}};Eg.default=iv,Object.defineProperty(xg,"__esModule",{value:!0}),xg.pageRankAsync=xg.minimumSpanningTreeAsync=xg.louvainAsync=xg.labelPropagationAsync=xg.getOutDegreeAsync=xg.getNeighborsAsync=xg.getInDegreeAsync=xg.getDegreeAsync=xg.getAdjMatrixAsync=xg.floydWarshallAsync=xg.findShortestPathAsync=xg.findAllPathAsync=xg.dijkstraAsync=xg.detectCycleAsync=xg.detectAllUndirectedCycleAsync=xg.detectAllDirectedCycleAsync=xg.detectAllCyclesAsync=xg.connectedComponentAsync=xg.GADDIAsync=void 0;var rv=function(e){return e&&e.__esModule?e:{default:e}}(Eg),ov=kg;xg.getAdjMatrixAsync=function(e,t){return(0,rv.default)(ov.ALGORITHM.getAdjMatrix).apply(void 0,[e,t])};xg.connectedComponentAsync=function(e,t){return(0,rv.default)(ov.ALGORITHM.connectedComponent).apply(void 0,[e,t])};xg.getDegreeAsync=function(e){return(0,rv.default)(ov.ALGORITHM.getDegree)(e)};xg.getInDegreeAsync=function(e,t){return(0,rv.default)(ov.ALGORITHM.getInDegree)(e,t)};xg.getOutDegreeAsync=function(e,t){return(0,rv.default)(ov.ALGORITHM.getOutDegree)(e,t)};xg.detectCycleAsync=function(e){return(0,rv.default)(ov.ALGORITHM.detectCycle)(e)};xg.detectAllCyclesAsync=function(e){return(0,rv.default)(ov.ALGORITHM.detectAllCycles)(e)};xg.detectAllDirectedCycleAsync=function(e){return(0,rv.default)(ov.ALGORITHM.detectAllDirectedCycle)(e)};xg.detectAllUndirectedCycleAsync=function(e){return(0,rv.default)(ov.ALGORITHM.detectAllUndirectedCycle)(e)};xg.dijkstraAsync=function(e,t,n,i){return(0,rv.default)(ov.ALGORITHM.dijkstra).apply(void 0,[e,t,n,i])};xg.findAllPathAsync=function(e,t,n,i){return(0,rv.default)(ov.ALGORITHM.findAllPath).apply(void 0,[e,t,n,i])};xg.findShortestPathAsync=function(e,t,n,i,r){return(0,rv.default)(ov.ALGORITHM.findShortestPath).apply(void 0,[e,t,n,i,r])};xg.floydWarshallAsync=function(e,t){return(0,rv.default)(ov.ALGORITHM.floydWarshall).apply(void 0,[e,t])};xg.labelPropagationAsync=function(e,t,n,i){return void 0===i&&(i=1e3),(0,rv.default)(ov.ALGORITHM.labelPropagation)(e,t,n,i)};xg.louvainAsync=function(e,t,n,i){return(0,rv.default)(ov.ALGORITHM.louvain)(e,t,n,i)};xg.minimumSpanningTreeAsync=function(e,t,n){return(0,rv.default)(ov.ALGORITHM.minimumSpanningTree).apply(void 0,[e,t,n])};xg.pageRankAsync=function(e,t,n){return(0,rv.default)(ov.ALGORITHM.pageRank).apply(void 0,[e,t,n])};xg.getNeighborsAsync=function(e,t,n){return(0,rv.default)(ov.ALGORITHM.getNeighbors).apply(void 0,[e,t,n])};xg.GADDIAsync=function(e,t,n,i,r,o,s){return void 0===n&&(n=!1),void 0===o&&(o="cluster"),void 0===s&&(s="cluster"),(0,rv.default)(ov.ALGORITHM.GADDI).apply(void 0,[e,t,n,i,r,o,s])},function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"GADDIAsync",{enumerable:!0,get:function(){return t.GADDIAsync}}),Object.defineProperty(e,"connectedComponentAsync",{enumerable:!0,get:function(){return t.connectedComponentAsync}}),e.default=void 0,Object.defineProperty(e,"detectAllCyclesAsync",{enumerable:!0,get:function(){return t.detectAllCyclesAsync}}),Object.defineProperty(e,"detectAllDirectedCycleAsync",{enumerable:!0,get:function(){return t.detectAllDirectedCycleAsync}}),Object.defineProperty(e,"detectAllUndirectedCycleAsync",{enumerable:!0,get:function(){return t.detectAllUndirectedCycleAsync}}),Object.defineProperty(e,"detectCycleAsync",{enumerable:!0,get:function(){return t.detectCycleAsync}}),e.detectDirectedCycleAsync=void 0,Object.defineProperty(e,"dijkstraAsync",{enumerable:!0,get:function(){return t.dijkstraAsync}}),Object.defineProperty(e,"findAllPathAsync",{enumerable:!0,get:function(){return t.findAllPathAsync}}),Object.defineProperty(e,"findShortestPathAsync",{enumerable:!0,get:function(){return t.findShortestPathAsync}}),Object.defineProperty(e,"floydWarshallAsync",{enumerable:!0,get:function(){return t.floydWarshallAsync}}),Object.defineProperty(e,"getAdjMatrixAsync",{enumerable:!0,get:function(){return t.getAdjMatrixAsync}}),Object.defineProperty(e,"getDegreeAsync",{enumerable:!0,get:function(){return t.getDegreeAsync}}),Object.defineProperty(e,"getInDegreeAsync",{enumerable:!0,get:function(){return t.getInDegreeAsync}}),Object.defineProperty(e,"getNeighborsAsync",{enumerable:!0,get:function(){return t.getNeighborsAsync}}),Object.defineProperty(e,"getOutDegreeAsync",{enumerable:!0,get:function(){return t.getOutDegreeAsync}}),Object.defineProperty(e,"labelPropagationAsync",{enumerable:!0,get:function(){return t.labelPropagationAsync}}),Object.defineProperty(e,"louvainAsync",{enumerable:!0,get:function(){return t.louvainAsync}}),Object.defineProperty(e,"minimumSpanningTreeAsync",{enumerable:!0,get:function(){return t.minimumSpanningTreeAsync}}),Object.defineProperty(e,"pageRankAsync",{enumerable:!0,get:function(){return t.pageRankAsync}});var t=xg,n=t.detectCycleAsync;e.detectDirectedCycleAsync=n;var i={getAdjMatrixAsync:t.getAdjMatrixAsync,connectedComponentAsync:t.connectedComponentAsync,getDegreeAsync:t.getDegreeAsync,getInDegreeAsync:t.getInDegreeAsync,getOutDegreeAsync:t.getOutDegreeAsync,detectCycleAsync:t.detectCycleAsync,detectDirectedCycleAsync:n,detectAllCyclesAsync:t.detectAllCyclesAsync,detectAllDirectedCycleAsync:t.detectAllDirectedCycleAsync,detectAllUndirectedCycleAsync:t.detectAllUndirectedCycleAsync,dijkstraAsync:t.dijkstraAsync,findAllPathAsync:t.findAllPathAsync,findShortestPathAsync:t.findShortestPathAsync,floydWarshallAsync:t.floydWarshallAsync,labelPropagationAsync:t.labelPropagationAsync,louvainAsync:t.louvainAsync,minimumSpanningTreeAsync:t.minimumSpanningTreeAsync,pageRankAsync:t.pageRankAsync,getNeighborsAsync:t.getNeighborsAsync,GADDIAsync:t.GADDIAsync};e.default=i}(Sg);var sv=pe({__proto__:null,default:L(Sg)},[Sg]);function av(e,t,n,i){var r=e-n,o=t-i;return Math.sqrt(r*r+o*o)}function lv(e,t,n,i,r,o){return r>=e&&r<=e+n&&o>=t&&o<=t+i}function cv(e,t){return!(t.minX>e.maxX||t.maxX<e.minX||t.minY>e.maxY||t.maxY<e.minY)}function uv(e,t){return e[0]===t[0]&&e[1]===t[1]}var hv=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,dv=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,fv=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,gv=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function pv(e,t){cr(e.match(gv),(function(e){var n=e.split(":");t.addColorStop(n[0],n[1])}))}function mv(e,t,n){var i=t.getBBox();if(isNaN(i.x)||isNaN(i.y)||isNaN(i.width)||isNaN(i.height))return n;if(xr(n)){if("("===n[1]||"("===n[2]){if("l"===n[0])return function(e,t,n){var i,r,o=hv.exec(n),s=parseFloat(o[1])%360*(Math.PI/180),a=o[2],l=t.getBBox();s>=0&&s<.5*Math.PI?(i={x:l.minX,y:l.minY},r={x:l.maxX,y:l.maxY}):.5*Math.PI<=s&&s<Math.PI?(i={x:l.maxX,y:l.minY},r={x:l.minX,y:l.maxY}):Math.PI<=s&&s<1.5*Math.PI?(i={x:l.maxX,y:l.maxY},r={x:l.minX,y:l.minY}):(i={x:l.minX,y:l.maxY},r={x:l.maxX,y:l.minY});var c=Math.tan(s),u=c*c,h=(r.x-i.x+c*(r.y-i.y))/(u+1)+i.x,d=c*(r.x-i.x+c*(r.y-i.y))/(u+1)+i.y,f=e.createLinearGradient(i.x,i.y,h,d);return pv(a,f),f}(e,t,n);if("r"===n[0])return function(e,t,n){var i=dv.exec(n),r=parseFloat(i[1]),o=parseFloat(i[2]),s=parseFloat(i[3]),a=i[4];if(0===s){var l=a.match(gv);return l[l.length-1].split(":")[1]}var c=t.getBBox(),u=c.maxX-c.minX,h=c.maxY-c.minY,d=Math.sqrt(u*u+h*h)/2,f=e.createRadialGradient(c.minX+u*r,c.minY+h*o,0,c.minX+u/2,c.minY+h/2,s*d);return pv(a,f),f}(e,t,n);if("p"===n[0])return function(e,t,n){if(t.get("patternSource")&&t.get("patternSource")===n)return t.get("pattern");var i,r,o=fv.exec(n),s=o[1],a=o[2];function l(){i=e.createPattern(r,s),t.set("pattern",i),t.set("patternSource",n)}switch(s){case"a":s="repeat";break;case"x":s="repeat-x";break;case"y":s="repeat-y";break;case"n":s="no-repeat";break;default:s="no-repeat"}return r=new Image,a.match(/^data:/i)||(r.crossOrigin="Anonymous"),r.src=a,r.complete?l():(r.onload=l,r.src=r.src),i}(e,t,n)}return n}return n instanceof CanvasPattern?n:void 0}function vv(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function yv(e,t){return vv(e)*vv(t)?(e[0]*t[0]+e[1]*t[1])/(vv(e)*vv(t)):1}function _v(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(yv(e,t))}function bv(e,t){var n=t[1],i=t[2],r=Fr(Vr(t[3]),2*Math.PI),o=t[4],s=t[5],a=e[0],l=e[1],c=t[6],u=t[7],h=Math.cos(r)*(a-c)/2+Math.sin(r)*(l-u)/2,d=-1*Math.sin(r)*(a-c)/2+Math.cos(r)*(l-u)/2,f=h*h/(n*n)+d*d/(i*i);f>1&&(n*=Math.sqrt(f),i*=Math.sqrt(f));var g=n*n*(d*d)+i*i*(h*h),p=g?Math.sqrt((n*n*(i*i)-g)/g):1;o===s&&(p*=-1),isNaN(p)&&(p=0);var m=i?p*n*d/i:0,v=n?p*-i*h/n:0,y=(a+c)/2+Math.cos(r)*m-Math.sin(r)*v,_=(l+u)/2+Math.sin(r)*m+Math.cos(r)*v,b=[(h-m)/n,(d-v)/i],w=[(-1*h-m)/n,(-1*d-v)/i],C=_v([1,0],b),S=_v(b,w);return yv(b,w)<=-1&&(S=Math.PI),yv(b,w)>=1&&(S=0),0===s&&S>0&&(S-=2*Math.PI),1===s&&S<0&&(S+=2*Math.PI),{cx:y,cy:_,rx:uv(e,[c,u])?0:n,ry:uv(e,[c,u])?0:i,startAngle:C,endAngle:C+S,xRotation:r,arcFlag:o,sweepFlag:s}}var wv=Math.sin,Cv=Math.cos,Sv=Math.atan2,xv=Math.PI;function Ev(e,t,n,i,r,o,s){var a=t.stroke,l=t.lineWidth,c=Sv(i-o,n-r),u=new sy({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*Cv(xv/6)+","+10*wv(xv/6)+" L0,0 L"+10*Cv(xv/6)+",-"+10*wv(xv/6),stroke:a,lineWidth:l}});u.translate(r,o),u.rotateAtPoint(r,o,c),e.set(s?"startArrowShape":"endArrowShape",u)}function kv(e,t,n,i,r,o,s){var a=t.startArrow,l=t.endArrow,c=t.stroke,u=t.lineWidth,h=s?a:l,d=h.d,f=h.fill,g=h.stroke,p=h.lineWidth,m=Yi(h,["d","fill","stroke","lineWidth"]),v=Sv(i-o,n-r);d&&(r-=Cv(v)*d,o-=wv(v)*d);var y=new sy({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:$i($i({},m),{stroke:g||c,lineWidth:p||u,fill:f})});y.translate(r,o),y.rotateAtPoint(r,o,v),e.set(s?"startArrowShape":"endArrowShape",y)}function Lv(e,t,n,i,r){var o=Sv(i-t,n-e);return{dx:Cv(o)*r,dy:wv(o)*r}}function Dv(e,t,n,i,r,o){"object"==typeof t.startArrow?kv(e,t,n,i,r,o,!0):t.startArrow?Ev(e,t,n,i,r,o,!0):e.set("startArrowShape",null)}function Nv(e,t,n,i,r,o){"object"==typeof t.endArrow?kv(e,t,n,i,r,o,!1):t.endArrow?Ev(e,t,n,i,r,o,!1):e.set("startArrowShape",null)}var Iv={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function Tv(e,t){var n=t.attr();for(var i in n){var r=n[i],o=Iv[i]?Iv[i]:i;"matrix"===o&&r?e.transform(r[0],r[1],r[3],r[4],r[6],r[7]):"lineDash"===o&&e.setLineDash?ar(r)&&e.setLineDash(r):("strokeStyle"===o||"fillStyle"===o?r=mv(e,t,r):"globalAlpha"===o&&(r*=e.globalAlpha),e[o]=r)}}function Mv(e,t,n){for(var i=0;i<t.length;i++){var r=t[i];r.cfg.visible?r.draw(e,n):r.skipDraw()}}function Av(e,t,n){var i=e.get("refreshElements");cr(i,(function(t){if(t!==e)for(var n=t.cfg.parent;n&&n!==e&&!n.cfg.refresh;)n.cfg.refresh=!0,n=n.cfg.parent})),i[0]===e?Pv(t):Ov(t,n)}function Ov(e,t){for(var n=0;n<e.length;n++){var i=e[n];if(i.cfg.visible)if(i.cfg.hasChanged)i.cfg.refresh=!0,i.isGroup()&&Pv(i.cfg.children);else if(i.cfg.refresh)i.isGroup()&&Ov(i.cfg.children,t);else{var r=Fv(i,t);i.cfg.refresh=r,r&&i.isGroup()&&Ov(i.cfg.children,t)}}}function Rv(e){for(var t=0;t<e.length;t++){var n=e[t];n.cfg.hasChanged=!1,n.isGroup()&&!n.destroyed&&Rv(n.cfg.children)}}function Pv(e,t){for(var n=0;n<e.length;n++){var i=e[n];i.cfg.refresh=!0,i.isGroup()&&Pv(i.get("children"))}}function Fv(e,t){var n=e.cfg.cacheCanvasBBox;return e.cfg.isInView&&n&&cv(n,t)}function Bv(e,t,n,i){var r=n.path,o=n.startArrow,s=n.endArrow;if(r){var a=[0,0],l=[0,0],c={dx:0,dy:0};t.beginPath();for(var u=0;u<r.length;u++){var h=r[u],d=h[0];if(0===u&&o&&o.d)c=Lv((f=e.getStartTangent())[0][0],f[0][1],f[1][0],f[1][1],o.d);else if(u===r.length-2&&"Z"===r[u+1][0]&&s&&s.d){if("Z"===r[u+1][0])c=Lv((f=e.getEndTangent())[0][0],f[0][1],f[1][0],f[1][1],s.d)}else if(u===r.length-1&&s&&s.d){var f;if("Z"!==r[0])c=Lv((f=e.getEndTangent())[0][0],f[0][1],f[1][0],f[1][1],s.d)}var g=c.dx,p=c.dy;switch(d){case"M":t.moveTo(h[1]-g,h[2]-p),l=[h[1],h[2]];break;case"L":t.lineTo(h[1]-g,h[2]-p);break;case"Q":t.quadraticCurveTo(h[1],h[2],h[3]-g,h[4]-p);break;case"C":t.bezierCurveTo(h[1],h[2],h[3],h[4],h[5]-g,h[6]-p);break;case"A":var m=void 0;i?(m=i[u])||(m=bv(a,h),i[u]=m):m=bv(a,h);var v=m.cx,y=m.cy,_=m.rx,b=m.ry,w=m.startAngle,C=m.endAngle,S=m.xRotation,x=m.sweepFlag;if(t.ellipse)t.ellipse(v,y,_,b,S,w,C,1-x);else{var E=_>b?_:b,k=_>b?1:_/b,L=_>b?b/_:1;t.translate(v,y),t.rotate(S),t.scale(k,L),t.arc(0,0,E,w,C,1-x),t.scale(1/k,1/L),t.rotate(-S),t.translate(-v,-y)}break;case"Z":t.closePath()}if("Z"===d)a=l;else{var D=h.length;a=[h[D-2],h[D-1]]}}}}function Wv(e,t){var n=e.get("canvas");n&&("remove"===t&&(e._cacheCanvasBBox=e.get("cacheCanvasBBox")),e.get("hasChanged")||(e.set("hasChanged",!0),e.cfg.parent&&e.cfg.parent.get("hasChanged")||(n.refreshElement(e,t,n),n.get("autoDraw")&&n.draw())))}function zv(e){var t,n,i;if(e.destroyed)t=e._cacheCanvasBBox;else{var r=e.get("cacheCanvasBBox"),o=r&&!(!r.width||!r.height),s=e.getCanvasBBox(),a=s&&!(!s.width||!s.height);o&&a?(i=s,t=(n=r)&&i?{minX:Math.min(n.minX,i.minX),minY:Math.min(n.minY,i.minY),maxX:Math.max(n.maxX,i.maxX),maxY:Math.max(n.maxY,i.maxY)}:n||i):o?t=r:a&&(t=s)}return t}var Vv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.onCanvasChange=function(e){Wv(this,e)},t.prototype.getShapeBase=function(){return me},t.prototype.getGroupBase=function(){return t},t.prototype._applyClip=function(e,t){t&&(e.save(),Tv(e,t),t.createPath(e),e.restore(),e.clip(),t._afterDraw())},t.prototype.cacheCanvasBBox=function(){var e=this.cfg.children,t=[],n=[];cr(e,(function(e){var i=e.cfg.cacheCanvasBBox;i&&e.cfg.isInView&&(t.push(i.minX,i.maxX),n.push(i.minY,i.maxY))}));var i=null;if(t.length){var r=mr(t),o=pr(t),s=mr(n),a=pr(n);i={minX:r,minY:s,x:r,y:s,maxX:o,maxY:a,width:o-r,height:a-s};var l=this.cfg.canvas;if(l){var c=l.getViewRange();this.set("isInView",cv(i,c))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",i)},t.prototype.draw=function(e,t){var n=this.cfg.children,i=!t||this.cfg.refresh;n.length&&i&&(e.save(),Tv(e,this),this._applyClip(e,this.getClip()),Mv(e,n,t),e.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},t.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},t}(td),Uv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},t.prototype.getShapeBase=function(){return me},t.prototype.getGroupBase=function(){return Vv},t.prototype.onCanvasChange=function(e){Wv(this,e)},t.prototype.calculateBBox=function(){var e=this.get("type"),t=this.getHitLineWidth(),n=od(e)(this),i=t/2,r=n.x-i,o=n.y-i,s=n.x+n.width+i,a=n.y+n.height+i;return{x:r,minX:r,y:o,minY:o,width:n.width+t,height:n.height+t,maxX:s,maxY:a}},t.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},t.prototype.isStroke=function(){return!!this.attrs.stroke},t.prototype._applyClip=function(e,t){t&&(e.save(),Tv(e,t),t.createPath(e),e.restore(),e.clip(),t._afterDraw())},t.prototype.draw=function(e,t){var n=this.cfg.clipShape;if(t){if(!1===this.cfg.refresh)return void this.set("hasChanged",!1);if(!cv(t,this.getCanvasBBox()))return this.set("hasChanged",!1),void(this.cfg.isInView&&this._afterDraw())}e.save(),Tv(e,this),this._applyClip(e,n),this.drawPath(e),e.restore(),this._afterDraw()},t.prototype.getCanvasViewBox=function(){var e=this.cfg.canvas;return e?e.getViewRange():null},t.prototype.cacheCanvasBBox=function(){var e=this.getCanvasViewBox();if(e){var t=this.getCanvasBBox(),n=cv(t,e);this.set("isInView",n),n?this.set("cacheCanvasBBox",t):this.set("cacheCanvasBBox",null)}},t.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},t.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},t.prototype.drawPath=function(e){this.createPath(e),this.strokeAndFill(e),this.afterDrawPath(e)},t.prototype.fill=function(e){e.fill()},t.prototype.stroke=function(e){e.stroke()},t.prototype.strokeAndFill=function(e){var t=this.attrs,n=t.lineWidth,i=t.opacity,r=t.strokeOpacity,o=t.fillOpacity;this.isFill()&&(sr(o)||1===o?this.fill(e):(e.globalAlpha=o,this.fill(e),e.globalAlpha=i)),this.isStroke()&&n>0&&(sr(r)||1===r||(e.globalAlpha=r),this.stroke(e)),this.afterDrawPath(e)},t.prototype.createPath=function(e){},t.prototype.afterDrawPath=function(e){},t.prototype.isInShape=function(e,t){var n=this.isStroke(),i=this.isFill(),r=this.getHitLineWidth();return this.isInStrokeOrPath(e,t,n,i,r)},t.prototype.isInStrokeOrPath=function(e,t,n,i,r){return!1},t.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var e=this.attrs;return e.lineWidth+e.lineAppendWidth},t}(nd),Hv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,r:0})},t.prototype.isInStrokeOrPath=function(e,t,n,i,r){var o=this.attr(),s=o.x,a=o.y,l=o.r,c=r/2,u=av(s,a,e,t);return i&&n?u<=l+c:i?u<=l:!!n&&(u>=l-c&&u<=l+c)},t.prototype.createPath=function(e){var t=this.attr(),n=t.x,i=t.y,r=t.r;e.beginPath(),e.arc(n,i,r,0,2*Math.PI,!1),e.closePath()},t}(Uv);function jv(e,t,n,i){return e/(n*n)+t/(i*i)}var Gv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,rx:0,ry:0})},t.prototype.isInStrokeOrPath=function(e,t,n,i,r){var o=this.attr(),s=r/2,a=o.x,l=o.y,c=o.rx,u=o.ry,h=(e-a)*(e-a),d=(t-l)*(t-l);return i&&n?jv(h,d,c+s,u+s)<=1:i?jv(h,d,c,u)<=1:!!n&&(jv(h,d,c-s,u-s)>=1&&jv(h,d,c+s,u+s)<=1)},t.prototype.createPath=function(e){var t=this.attr(),n=t.x,i=t.y,r=t.rx,o=t.ry;if(e.beginPath(),e.ellipse)e.ellipse(n,i,r,o,0,0,2*Math.PI,!1);else{var s=r>o?r:o,a=r>o?1:r/o,l=r>o?o/r:1;e.save(),e.translate(n,i),e.scale(a,l),e.arc(0,0,s,0,2*Math.PI),e.restore(),e.closePath()}},t}(Uv);function Kv(e){return e instanceof HTMLElement&&xr(e.nodeName)&&"CANVAS"===e.nodeName.toUpperCase()}var qv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,width:0,height:0})},t.prototype.initAttrs=function(e){this._setImage(e.img)},t.prototype.isStroke=function(){return!1},t.prototype.isOnlyHitBox=function(){return!0},t.prototype._afterLoading=function(){if(!0===this.get("toDraw")){var e=this.get("canvas");e?e.draw():this.createPath(this.get("context"))}},t.prototype._setImage=function(e){var t=this,n=this.attrs;if(xr(e)){var i=new Image;i.onload=function(){if(t.destroyed)return!1;t.attr("img",i),t.set("loading",!1),t._afterLoading();var e=t.get("callback");e&&e.call(t)},i.crossOrigin="Anonymous",i.src=e,this.set("loading",!0)}else e instanceof Image?(n.width||(n.width=e.width),n.height||(n.height=e.height)):Kv(e)&&(n.width||(n.width=Number(e.getAttribute("width"))),n.height||(n.height,Number(e.getAttribute("height"))))},t.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),"img"===t&&this._setImage(n)},t.prototype.createPath=function(e){if(this.get("loading"))return this.set("toDraw",!0),void this.set("context",e);var t=this.attr(),n=t.x,i=t.y,r=t.width,o=t.height,s=t.sx,a=t.sy,l=t.swidth,c=t.sheight,u=t.img;(u instanceof Image||Kv(u))&&(sr(s)||sr(a)||sr(l)||sr(c)?e.drawImage(u,n,i,r,o):e.drawImage(u,s,a,l,c,n,i,r,o))},t}(Uv);function $v(e,t,n,i,r,o,s){var a=Math.min(e,n),l=Math.max(e,n),c=Math.min(t,i),u=Math.max(t,i),h=r/2;return o>=a-h&&o<=l+h&&s>=c-h&&s<=u+h&&gd.pointToLine(e,t,n,i,o,s)<=r/2}var Yv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(e){this.setArrow()},t.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),this.setArrow()},t.prototype.setArrow=function(){var e=this.attr(),t=e.x1,n=e.y1,i=e.x2,r=e.y2,o=e.startArrow,s=e.endArrow;o&&Dv(this,e,i,r,t,n),s&&Nv(this,e,t,n,i,r)},t.prototype.isInStrokeOrPath=function(e,t,n,i,r){if(!n||!r)return!1;var o=this.attr();return $v(o.x1,o.y1,o.x2,o.y2,r,e,t)},t.prototype.createPath=function(e){var t=this.attr(),n=t.x1,i=t.y1,r=t.x2,o=t.y2,s=t.startArrow,a=t.endArrow,l={dx:0,dy:0},c={dx:0,dy:0};s&&s.d&&(l=Lv(n,i,r,o,t.startArrow.d)),a&&a.d&&(c=Lv(n,i,r,o,t.endArrow.d)),e.beginPath(),e.moveTo(n+l.dx,i+l.dy),e.lineTo(r-c.dx,o-c.dy)},t.prototype.afterDrawPath=function(e){var t=this.get("startArrowShape"),n=this.get("endArrowShape");t&&t.draw(e),n&&n.draw(e)},t.prototype.getTotalLength=function(){var e=this.attr(),t=e.x1,n=e.y1,i=e.x2,r=e.y2;return gd.length(t,n,i,r)},t.prototype.getPoint=function(e){var t=this.attr(),n=t.x1,i=t.y1,r=t.x2,o=t.y2;return gd.pointAt(n,i,r,o,e)},t}(Uv),Xv={circle:function(e,t,n){return[["M",e-n,t],["A",n,n,0,1,0,e+n,t],["A",n,n,0,1,0,e-n,t]]},square:function(e,t,n){return[["M",e-n,t-n],["L",e+n,t-n],["L",e+n,t+n],["L",e-n,t+n],["Z"]]},diamond:function(e,t,n){return[["M",e-n,t],["L",e,t-n],["L",e+n,t],["L",e,t+n],["Z"]]},triangle:function(e,t,n){var i=n*Math.sin(1/3*Math.PI);return[["M",e-n,t+i],["L",e,t-i],["L",e+n,t+i],["Z"]]},"triangle-down":function(e,t,n){var i=n*Math.sin(1/3*Math.PI);return[["M",e-n,t-i],["L",e+n,t-i],["L",e,t+i],["Z"]]}},Zv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.initAttrs=function(e){this._resetParamsCache()},t.prototype._resetParamsCache=function(){this.set("paramsCache",{})},t.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),-1!==["symbol","x","y","r","radius"].indexOf(t)&&this._resetParamsCache()},t.prototype.isOnlyHitBox=function(){return!0},t.prototype._getR=function(e){return sr(e.r)?e.radius:e.r},t.prototype._getPath=function(){var e,n,i=this.attr(),r=i.x,o=i.y,s=i.symbol||"circle",a=this._getR(i);if(or(s))n=qd(n=(e=s)(r,o,a));else{if(!(e=t.Symbols[s]))return console.warn(s+" marker is not supported."),null;n=e(r,o,a)}return n},t.prototype.createPath=function(e){Bv(this,e,{path:this._getPath()},this.get("paramsCache"))},t.Symbols=Xv,t}(Uv);function Qv(e,t,n){var i=Rd();return e.createPath(i),i.isPointInPath(t,n)}function Jv(e){return Math.abs(e)<1e-6?0:e<0?-1:1}function ey(e,t,n){return(n[0]-e[0])*(t[1]-e[1])==(t[0]-e[0])*(n[1]-e[1])&&Math.min(e[0],t[0])<=n[0]&&n[0]<=Math.max(e[0],t[0])&&Math.min(e[1],t[1])<=n[1]&&n[1]<=Math.max(e[1],t[1])}function ty(e,t,n){var i=!1,r=e.length;if(r<=2)return!1;for(var o=0;o<r;o++){var s=e[o],a=e[(o+1)%r];if(ey(s,a,[t,n]))return!0;Jv(s[1]-n)>0!=Jv(a[1]-n)>0&&Jv(t-(n-s[1])*(s[0]-a[0])/(s[1]-a[1])-s[0])<0&&(i=!i)}return i}function ny(e,t,n,i,r,o,s,a){var l=(Math.atan2(a-t,s-e)+2*Math.PI)%(2*Math.PI);if(l<i||l>r)return!1;var c={x:e+n*Math.cos(l),y:t+n*Math.sin(l)};return av(c.x,c.y,s,a)<=o/2}var iy=Us;var ry=$i({hasArc:function(e){for(var t=!1,n=e.length,i=0;i<n;i++){var r=e[i][0];if("C"===r||"A"===r||"Q"===r){t=!0;break}}return t},extractPolygons:function(e){for(var t=e.length,n=[],i=[],r=[],o=0;o<t;o++){var s=e[o],a=s[0];"M"===a?(r.length&&(i.push(r),r=[]),r.push([s[1],s[2]])):"Z"===a?r.length&&(n.push(r),r=[]):r.push([s[1],s[2]])}return r.length>0&&i.push(r),{polygons:n,polylines:i}},isPointInStroke:function(e,t,n,i,r){for(var o=!1,s=t/2,a=0;a<e.length;a++){var l=e[a],c=l.currentPoint,u=l.params,h=l.prePoint,d=l.box;if(!d||lv(d.x-s,d.y-s,d.width+t,d.height+t,n,i)){switch(l.command){case"L":case"Z":o=$v(h[0],h[1],c[0],c[1],t,n,i);break;case"Q":o=wd.pointDistance(h[0],h[1],u[1],u[2],u[3],u[4],n,i)<=t/2;break;case"C":o=Ld.pointDistance(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],n,i,r)<=t/2;break;case"A":var f=l.arcParams,g=f.cx,p=f.cy,m=f.rx,v=f.ry,y=f.startAngle,_=f.endAngle,b=f.xRotation,w=[n,i,1],C=m>v?m:v;fs(w,w,iy(null,[["t",-g,-p],["r",-b],["s",1/(m>v?1:m/v),1/(m>v?v/m:1)]])),o=ny(0,0,C,y,_,t,w[0],w[1])}if(o)break}}return o}},Fc);function oy(e,t,n){for(var i=!1,r=0;r<e.length;r++){if(i=ty(e[r],t,n))break}return i}var sy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(e){this._setPathArr(e.path),this.setArrow()},t.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),"path"===t&&this._setPathArr(n),this.setArrow()},t.prototype._setPathArr=function(e){this.attrs.path=qd(e);var t=ry.hasArc(e);this.set("hasArc",t),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},t.prototype.getSegments=function(){var e=this.get("segements");return e||(e=ef(this.attr("path")),this.set("segments",e)),e},t.prototype.setArrow=function(){var e,t=this.attr(),n=t.startArrow,i=t.endArrow;n&&Dv(this,t,(e=this.getStartTangent())[0][0],e[0][1],e[1][0],e[1][1]);i&&Nv(this,t,(e=this.getEndTangent())[0][0],e[0][1],e[1][0],e[1][1])},t.prototype.isInStrokeOrPath=function(e,t,n,i,r){var o=this.getSegments(),s=this.get("hasArc"),a=!1;if(n){var l=this.getTotalLength();a=ry.isPointInStroke(o,r,e,t,l)}if(!a&&i)if(s)a=Qv(this,e,t);else{var c=this.attr("path"),u=ry.extractPolygons(c);a=oy(u.polygons,e,t)||oy(u.polylines,e,t)}return a},t.prototype.createPath=function(e){Bv(this,e,this.attr(),this.get("paramsCache"))},t.prototype.afterDrawPath=function(e){var t=this.get("startArrowShape"),n=this.get("endArrowShape");t&&t.draw(e),n&&n.draw(e)},t.prototype.getTotalLength=function(){var e=this.get("totalLength");return sr(e)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):e},t.prototype.getPoint=function(e){var t,n,i=this.get("tCache");i||(this._calculateCurve(),this._setTcache(),i=this.get("tCache"));var r=this.get("curve");if(!i||0===i.length)return r?{x:r[0][1],y:r[0][2]}:null;cr(i,(function(i,r){e>=i[0]&&e<=i[1]&&(t=(e-i[0])/(i[1]-i[0]),n=r)}));var o=r[n];if(sr(o)||sr(n))return null;var s=o.length,a=r[n+1];return Ld.pointAt(o[s-2],o[s-1],a[1],a[2],a[3],a[4],a[5],a[6],t)},t.prototype._calculateCurve=function(){var e=this.attr().path;this.set("curve",ry.pathToCurve(e))},t.prototype._setTcache=function(){var e,t,n,i,r=0,o=0,s=[],a=this.get("curve");a&&(cr(a,(function(e,t){n=a[t+1],i=e.length,n&&(r+=Ld.length(e[i-2],e[i-1],n[1],n[2],n[3],n[4],n[5],n[6])||0)})),this.set("totalLength",r),0!==r?(cr(a,(function(l,c){n=a[c+1],i=l.length,n&&((e=[])[0]=o/r,t=Ld.length(l[i-2],l[i-1],n[1],n[2],n[3],n[4],n[5],n[6]),o+=t||0,e[1]=o/r,s.push(e))})),this.set("tCache",s)):this.set("tCache",[]))},t.prototype.getStartTangent=function(){var e,t=this.getSegments();if(t.length>1){var n=t[0].currentPoint,i=t[1].currentPoint,r=t[1].startTangent;e=[],r?(e.push([n[0]-r[0],n[1]-r[1]]),e.push([n[0],n[1]])):(e.push([i[0],i[1]]),e.push([n[0],n[1]]))}return e},t.prototype.getEndTangent=function(){var e,t=this.getSegments(),n=t.length;if(n>1){var i=t[n-2].currentPoint,r=t[n-1].currentPoint,o=t[n-1].endTangent;e=[],o?(e.push([r[0]-o[0],r[1]-o[1]]),e.push([r[0],r[1]])):(e.push([i[0],i[1]]),e.push([r[0],r[1]]))}return e},t}(Uv);function ay(e,t,n,i,r){var o=e.length;if(o<2)return!1;for(var s=0;s<o-1;s++){if($v(e[s][0],e[s][1],e[s+1][0],e[s+1][1],t,n,i))return!0}if(r){var a=e[0],l=e[o-1];if($v(a[0],a[1],l[0],l[1],t,n,i))return!0}return!1}var ly=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.isInStrokeOrPath=function(e,t,n,i,r){var o=this.attr().points,s=!1;return n&&(s=ay(o,r,e,t,!0)),!s&&i&&(s=ty(o,e,t)),s},t.prototype.createPath=function(e){var t=this.attr().points;if(!(t.length<2)){e.beginPath();for(var n=0;n<t.length;n++){var i=t[n];0===n?e.moveTo(i[0],i[1]):e.lineTo(i[0],i[1])}e.closePath()}},t}(Uv),cy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{startArrow:!1,endArrow:!1})},t.prototype.initAttrs=function(e){this.setArrow()},t.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),this.setArrow(),-1!==["points"].indexOf(t)&&this._resetCache()},t.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},t.prototype.setArrow=function(){var e=this.attr(),t=this.attrs,n=t.points,i=t.startArrow,r=t.endArrow,o=n.length,s=n[0][0],a=n[0][1],l=n[o-1][0],c=n[o-1][1];i&&Dv(this,e,n[1][0],n[1][1],s,a),r&&Nv(this,e,n[o-2][0],n[o-2][1],l,c)},t.prototype.isFill=function(){return!1},t.prototype.isInStrokeOrPath=function(e,t,n,i,r){return!(!n||!r)&&ay(this.attr().points,r,e,t,!1)},t.prototype.isStroke=function(){return!0},t.prototype.createPath=function(e){var t=this.attr(),n=t.points,i=t.startArrow,r=t.endArrow,o=n.length;if(!(n.length<2)){var s,a=n[0][0],l=n[0][1],c=n[o-1][0],u=n[o-1][1];if(i&&i.d)a+=(s=Lv(a,l,n[1][0],n[1][1],i.d)).dx,l+=s.dy;if(r&&r.d)c-=(s=Lv(n[o-2][0],n[o-2][1],c,u,r.d)).dx,u-=s.dy;e.beginPath(),e.moveTo(a,l);for(var h=0;h<o-1;h++){var d=n[h];e.lineTo(d[0],d[1])}e.lineTo(c,u)}},t.prototype.afterDrawPath=function(e){var t=this.get("startArrowShape"),n=this.get("endArrowShape");t&&t.draw(e),n&&n.draw(e)},t.prototype.getTotalLength=function(){var e=this.attr().points,t=this.get("totalLength");return sr(t)?(this.set("totalLength",Td(e)),this.get("totalLength")):t},t.prototype.getPoint=function(e){var t,n,i=this.attr().points,r=this.get("tCache");return r||(this._setTcache(),r=this.get("tCache")),cr(r,(function(i,r){e>=i[0]&&e<=i[1]&&(t=(e-i[0])/(i[1]-i[0]),n=r)})),gd.pointAt(i[n][0],i[n][1],i[n+1][0],i[n+1][1],t)},t.prototype._setTcache=function(){var e=this.attr().points;if(e&&0!==e.length){var t=this.getTotalLength();if(!(t<=0)){var n,i,r=0,o=[];cr(e,(function(s,a){e[a+1]&&((n=[])[0]=r/t,i=gd.length(s[0],s[1],e[a+1][0],e[a+1][1]),r+=i,n[1]=r/t,o.push(n))})),this.set("tCache",o)}}},t.prototype.getStartTangent=function(){var e=this.attr().points,t=[];return t.push([e[1][0],e[1][1]]),t.push([e[0][0],e[0][1]]),t},t.prototype.getEndTangent=function(){var e=this.attr().points,t=e.length-1,n=[];return n.push([e[t-1][0],e[t-1][1]]),n.push([e[t][0],e[t][1]]),n},t}(Uv);var uy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,width:0,height:0,radius:0})},t.prototype.isInStrokeOrPath=function(e,t,n,i,r){var o=this.attr(),s=o.x,a=o.y,l=o.width,c=o.height,u=o.radius;if(u){var h=!1;return n&&(h=function(e,t,n,i,r,o,s,a){return $v(e+r,t,e+n-r,t,o,s,a)||$v(e+n,t+r,e+n,t+i-r,o,s,a)||$v(e+n-r,t+i,e+r,t+i,o,s,a)||$v(e,t+i-r,e,t+r,o,s,a)||ny(e+n-r,t+r,r,1.5*Math.PI,2*Math.PI,o,s,a)||ny(e+n-r,t+i-r,r,0,.5*Math.PI,o,s,a)||ny(e+r,t+i-r,r,.5*Math.PI,Math.PI,o,s,a)||ny(e+r,t+r,r,Math.PI,1.5*Math.PI,o,s,a)}(s,a,l,c,u,r,e,t)),!h&&i&&(h=Qv(this,e,t)),h}var d=r/2;return i&&n?lv(s-d,a-d,l+d,c+d,e,t):i?lv(s,a,l,c,e,t):n?function(e,t,n,i,r,o,s){var a=r/2;return lv(e-a,t-a,n,r,o,s)||lv(e+n-a,t-a,r,i,o,s)||lv(e+a,t+i-a,n,r,o,s)||lv(e-a,t+a,r,i,o,s)}(s,a,l,c,r,e,t):void 0},t.prototype.createPath=function(e){var t=this.attr(),n=t.x,i=t.y,r=t.width,o=t.height,s=t.radius;if(e.beginPath(),0===s)e.rect(n,i,r,o);else{var a=function(e){var t=0,n=0,i=0,r=0;return ar(e)?1===e.length?t=n=i=r=e[0]:2===e.length?(t=i=e[0],n=r=e[1]):3===e.length?(t=e[0],n=r=e[1],i=e[2]):(t=e[0],n=e[1],i=e[2],r=e[3]):t=n=i=r=e,[t,n,i,r]}(s),l=a[0],c=a[1],u=a[2],h=a[3];e.moveTo(n+l,i),e.lineTo(n+r-c,i),0!==c&&e.arc(n+r-c,i+c,c,-Math.PI/2,0),e.lineTo(n+r,i+o-u),0!==u&&e.arc(n+r-u,i+o-u,u,0,Math.PI/2),e.lineTo(n+h,i+o),0!==h&&e.arc(n+h,i+o-h,h,Math.PI/2,Math.PI),e.lineTo(n,i+l),0!==l&&e.arc(n+l,i+l,l,Math.PI,1.5*Math.PI),e.closePath()}},t}(Uv),hy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},t.prototype.isOnlyHitBox=function(){return!0},t.prototype.initAttrs=function(e){this._assembleFont(),e.text&&this._setText(e.text)},t.prototype._assembleFont=function(){var e=this.attrs;e.font=Fd(e)},t.prototype._setText=function(e){var t=null;xr(e)&&-1!==e.indexOf("\n")&&(t=e.split("\n")),this.set("textArr",t)},t.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),t.startsWith("font")&&this._assembleFont(),"text"===t&&this._setText(n)},t.prototype._getSpaceingY=function(){var e=this.attrs,t=e.lineHeight,n=1*e.fontSize;return t?t-n:.14*n},t.prototype._drawTextArr=function(e,t,n){var i,r=this.attrs,o=r.textBaseline,s=r.x,a=r.y,l=1*r.fontSize,c=this._getSpaceingY(),u=Pd(r.text,r.fontSize,r.lineHeight);cr(t,(function(t,r){i=a+r*(c+l)-u+l,"middle"===o&&(i+=u-l-(u-l)/2),"top"===o&&(i+=u-l),sr(t)||(n?e.fillText(t,s,i):e.strokeText(t,s,i))}))},t.prototype._drawText=function(e,t){var n=this.attr(),i=n.x,r=n.y,o=this.get("textArr");if(o)this._drawTextArr(e,o,t);else{var s=n.text;sr(s)||(t?e.fillText(s,i,r):e.strokeText(s,i,r))}},t.prototype.strokeAndFill=function(e){var t=this.attrs,n=t.lineWidth,i=t.opacity,r=t.strokeOpacity,o=t.fillOpacity;this.isStroke()&&n>0&&(sr(r)||1===r||(e.globalAlpha=i),this.stroke(e)),this.isFill()&&(sr(o)||1===o?this.fill(e):(e.globalAlpha=o,this.fill(e),e.globalAlpha=i)),this.afterDrawPath(e)},t.prototype.fill=function(e){this._drawText(e,!0)},t.prototype.stroke=function(e){this._drawText(e,!1)},t}(Uv);function dy(e,t,n){var i,r,o=e.getTotalMatrix();if(o){var s=(i=[t,n,1],(r=o)?nu(iu(r),i):i);return[s[0],s[1]]}return[t,n]}function fy(e,t,n){if(e.isCanvas&&e.isCanvas())return!0;if(!Uc(e)||!1===e.cfg.isInView)return!1;if(e.cfg.clipShape){var i=dy(e,t,n),r=i[0],o=i[1];if(e.isClipped(r,o))return!1}var s=e.cfg.cacheCanvasBBox||e.getCanvasBBox();return t>=s.minX&&t<=s.maxX&&n>=s.minY&&n<=s.maxY}function gy(e,t,n){if(!fy(e,t,n))return null;for(var i=null,r=e.getChildren(),o=r.length-1;o>=0;o--){var s=r[o];if(s.isGroup())i=gy(s,t,n);else if(fy(s,t,n)){var a=s,l=dy(s,t,n),c=l[0],u=l[1];a.isInShape(c,u)&&(i=s)}if(i)break}return i}var py=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.renderer="canvas",t.autoDraw=!0,t.localRefresh=!0,t.refreshElements=[],t.clipView=!0,t.quickHit=!1,t},t.prototype.onCanvasChange=function(e){"attr"!==e&&"sort"!==e&&"changeSize"!==e||(this.set("refreshElements",[this]),this.draw())},t.prototype.getShapeBase=function(){return me},t.prototype.getGroupBase=function(){return Vv},t.prototype.getPixelRatio=function(){var e=this.get("pixelRatio")||(window?window.devicePixelRatio:1);return e>=1?Math.ceil(e):1},t.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},t.prototype.createDom=function(){var e=document.createElement("canvas"),t=e.getContext("2d");return this.set("context",t),e},t.prototype.setDOMSize=function(t,n){e.prototype.setDOMSize.call(this,t,n);var i=this.get("context"),r=this.get("el"),o=this.getPixelRatio();r.width=o*t,r.height=o*n,o>1&&i.scale(o,o)},t.prototype.clear=function(){e.prototype.clear.call(this),this._clearFrame();var t=this.get("context"),n=this.get("el");t.clearRect(0,0,n.width,n.height)},t.prototype.getShape=function(t,n){return this.get("quickHit")?gy(this,t,n):e.prototype.getShape.call(this,t,n,null)},t.prototype._getRefreshRegion=function(){var e,t=this.get("refreshElements"),n=this.getViewRange();t.length&&t[0]===this?e=n:(e=function(e){if(!e.length)return null;var t=[],n=[],i=[],r=[];return cr(e,(function(e){var o=zv(e);o&&(t.push(o.minX),n.push(o.minY),i.push(o.maxX),r.push(o.maxY))})),{minX:mr(t),minY:mr(n),maxX:pr(i),maxY:pr(r)}}(t))&&(e.minX=Math.floor(e.minX),e.minY=Math.floor(e.minY),e.maxX=Math.ceil(e.maxX),e.maxY=Math.ceil(e.maxY),e.maxY+=1,this.get("clipView")&&(e=function(e,t){return e&&t&&cv(e,t)?{minX:Math.max(e.minX,t.minX),minY:Math.max(e.minY,t.minY),maxX:Math.min(e.maxX,t.maxX),maxY:Math.min(e.maxY,t.maxY)}:null}(e,n)));return e},t.prototype.refreshElement=function(e){this.get("refreshElements").push(e)},t.prototype._clearFrame=function(){var e=this.get("drawFrame");e&&(Jr(e),this.set("drawFrame",null),this.set("refreshElements",[]))},t.prototype.draw=function(){var e=this.get("drawFrame");this.get("autoDraw")&&e||this._startDraw()},t.prototype._drawAll=function(){var e=this.get("context"),t=this.get("el"),n=this.getChildren();e.clearRect(0,0,t.width,t.height),Tv(e,this),Mv(e,n),this.set("refreshElements",[])},t.prototype._drawRegion=function(){var e=this.get("context"),t=this.get("refreshElements"),n=this.getChildren(),i=this._getRefreshRegion();i?(e.clearRect(i.minX,i.minY,i.maxX-i.minX,i.maxY-i.minY),e.save(),e.beginPath(),e.rect(i.minX,i.minY,i.maxX-i.minX,i.maxY-i.minY),e.clip(),Tv(e,this),Av(this,n,i),Mv(e,n,i),e.restore()):t.length&&Rv(t),cr(t,(function(e){e.get("hasChanged")&&e.set("hasChanged",!1)})),this.set("refreshElements",[])},t.prototype._startDraw=function(){var e=this,t=this.get("drawFrame");t||(t=Qr((function(){e.get("localRefresh")?e._drawRegion():e._drawAll(),e.set("drawFrame",null)})),this.set("drawFrame",t))},t.prototype.skipDraw=function(){},t.prototype.removeDom=function(){var e=this.get("el");e.width=0,e.height=0,e.parentNode.removeChild(e)},t}(ed),my={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},vy={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"};function yy(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function _y(e){var t=my[e.type],n=e.getParent();if(!t)throw new Error("the type "+e.type+" is not supported by svg");var i=yy(t);if(e.get("id")&&(i.id=e.get("id")),e.set("el",i),e.set("attrs",{}),n){var r=n.get("el");r||(r=n.createDom(),n.set("el",r)),r.appendChild(i)}return i}function by(e,t){var n=e.get("el"),i=yo(n.children).sort(t),r=document.createDocumentFragment();i.forEach((function(e){r.appendChild(e)})),n.appendChild(r)}function wy(e){var t=e.attr().matrix;if(t){for(var n=e.cfg.el,i=[],r=0;r<9;r+=3)i.push(t[r]+","+t[r+1]);-1===(i=i.join(",")).indexOf("NaN")?n.setAttribute("transform","matrix("+i+")"):console.warn("invalid matrix:",t)}}function Cy(e,t){var n=e.getClip(),i=e.get("el");if(n){if(n&&!i.hasAttribute("clip-path")){_y(n),n.createPath(t);var r=t.addClip(n);i.setAttribute("clip-path","url(#"+r+")")}}else i.removeAttribute("clip-path")}function Sy(e,t){t.forEach((function(t){t.draw(e)}))}function xy(e,t){var n=e.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context"),r=e.getParent(),o=r?r.getChildren():[n],s=e.get("el");if("remove"===t)if(e.get("isClipShape")){var a=s&&s.parentNode,l=a&&a.parentNode;a&&l&&l.removeChild(a)}else s&&s.parentNode&&s.parentNode.removeChild(s);else if("show"===t)s.setAttribute("visibility","visible");else if("hide"===t)s.setAttribute("visibility","hidden");else if("zIndex"===t)!function(e,t){var n=e.parentNode,i=Array.from(n.childNodes).filter((function(e){return 1===e.nodeType&&"defs"!==e.nodeName.toLowerCase()})),r=i[t],o=i.indexOf(e);if(r){if(o>t)n.insertBefore(e,r);else if(o<t){var s=i[t+1];s?n.insertBefore(e,s):n.appendChild(e)}}else n.appendChild(e)}(s,o.indexOf(e));else if("sort"===t){var c=e.get("children");c&&c.length&&by(e,(function(e,t){return c.indexOf(e)-c.indexOf(t)?1:0}))}else"clear"===t?s&&(s.innerHTML=""):"matrix"===t?wy(e):"clip"===t?Cy(e,i):"attr"===t||"add"===t&&e.draw(i)}}var Ey=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.isEntityGroup=function(){return!0},t.prototype.createDom=function(){var e=yy("g");this.set("el",e);var t=this.getParent();if(t){var n=t.get("el");n||(n=t.createDom(),t.set("el",n)),n.appendChild(e)}return e},t.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t);var n=this.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context");this.createPath(i,t)}},t.prototype.onCanvasChange=function(e){xy(this,e)},t.prototype.getShapeBase=function(){return ve},t.prototype.getGroupBase=function(){return t},t.prototype.draw=function(e){var t=this.getChildren(),n=this.get("el");this.get("destroyed")?n&&n.parentNode.removeChild(n):(n||this.createDom(),Cy(this,e),this.createPath(e),t.length&&Sy(e,t))},t.prototype.createPath=function(e,t){var n=this.attr(),i=this.get("el");cr(t||n,(function(e,t){vy[t]&&i.setAttribute(vy[t],e)})),wy(this)},t}(td),ky=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="svg",t.canFill=!1,t.canStroke=!1,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},t.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t);var n=this.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context");this.draw(i,t)}},t.prototype.getShapeBase=function(){return ve},t.prototype.getGroupBase=function(){return Ey},t.prototype.onCanvasChange=function(e){xy(this,e)},t.prototype.calculateBBox=function(){var e=this.get("el"),t=null;if(e)t=e.getBBox();else{var n=od(this.get("type"));n&&(t=n(this))}if(t){var i=t.x,r=t.y,o=t.width,s=t.height,a=this.getHitLineWidth(),l=a/2,c=i-l,u=r-l;return{x:c,y:u,minX:c,minY:u,maxX:i+o+l,maxY:r+s+l,width:o+a,height:s+a}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},t.prototype.isFill=function(){var e=this.attr(),t=e.fill,n=e.fillStyle;return(t||n||this.isClipShape())&&this.canFill},t.prototype.isStroke=function(){var e=this.attr(),t=e.stroke,n=e.strokeStyle;return(t||n)&&this.canStroke},t.prototype.draw=function(e,t){var n=this.get("el");this.get("destroyed")?n&&n.parentNode.removeChild(n):(n||_y(this),Cy(this,e),this.createPath(e,t),this.shadow(e,t),this.strokeAndFill(e,t),this.transform(t))},t.prototype.createPath=function(e,t){},t.prototype.strokeAndFill=function(e,t){var n=t||this.attr(),i=n.fill,r=n.fillStyle,o=n.stroke,s=n.strokeStyle,a=n.fillOpacity,l=n.strokeOpacity,c=n.lineWidth,u=this.get("el");this.canFill&&(t?"fill"in n?this._setColor(e,"fill",i):"fillStyle"in n&&this._setColor(e,"fill",r):this._setColor(e,"fill",i||r),a&&u.setAttribute(vy.fillOpacity,a)),this.canStroke&&c>0&&(t?"stroke"in n?this._setColor(e,"stroke",o):"strokeStyle"in n&&this._setColor(e,"stroke",s):this._setColor(e,"stroke",o||s),l&&u.setAttribute(vy.strokeOpacity,l),c&&u.setAttribute(vy.lineWidth,c))},t.prototype._setColor=function(e,t,n){var i=this.get("el");if(n)if(n=n.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(n))(r=e.find("gradient",n))||(r=e.addGradient(n)),i.setAttribute(vy[t],"url(#"+r+")");else if(/^[p,P]{1}[\s]*\(/.test(n)){var r;(r=e.find("pattern",n))||(r=e.addPattern(n)),i.setAttribute(vy[t],"url(#"+r+")")}else i.setAttribute(vy[t],n);else i.setAttribute(vy[t],"none")},t.prototype.shadow=function(e,t){var n=this.attr(),i=t||n,r=i.shadowOffsetX,o=i.shadowOffsetY,s=i.shadowBlur,a=i.shadowColor;(r||o||s||a)&&function(e,t){var n=e.cfg.el,i=e.attr(),r={dx:i.shadowOffsetX,dy:i.shadowOffsetY,blur:i.shadowBlur,color:i.shadowColor};if(r.dx||r.dy||r.blur||r.color){var o=t.find("filter",r);o||(o=t.addShadow(r)),n.setAttribute("filter","url(#"+o+")")}else n.removeAttribute("filter")}(this,e)},t.prototype.transform=function(e){var t=this.attr();(e||t).matrix&&wy(this)},t.prototype.isInShape=function(e,t){return this.isPointInPath(e,t)},t.prototype.isPointInPath=function(e,t){var n=this.get("el"),i=this.get("canvas").get("el").getBoundingClientRect(),r=e+i.left,o=t+i.top,s=document.elementFromPoint(r,o);return!(!s||!s.isEqualNode(n))},t.prototype.getHitLineWidth=function(){var e=this.attrs,t=e.lineWidth,n=e.lineAppendWidth;return this.isStroke()?t+n:0},t}(nd),Ly=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="circle",t.canFill=!0,t.canStroke=!0,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,r:0})},t.prototype.createPath=function(e,t){var n=this.attr(),i=this.get("el");cr(t||n,(function(e,t){"x"===t||"y"===t?i.setAttribute("c"+t,e):vy[t]&&i.setAttribute(vy[t],e)}))},t}(ky),Dy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="dom",t.canFill=!1,t.canStroke=!1,t}return qi(t,e),t.prototype.createPath=function(e,t){var n=this.attr(),i=this.get("el");if(cr(t||n,(function(e,t){vy[t]&&i.setAttribute(vy[t],e)})),"function"==typeof n.html){var r=n.html.call(this,n);if(r instanceof Element||r instanceof HTMLDocument){for(var o=i.childNodes,s=o.length-1;s>=0;s--)i.removeChild(o[s]);i.appendChild(r)}else i.innerHTML=r}else i.innerHTML=n.html},t}(ky),Ny=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="ellipse",t.canFill=!0,t.canStroke=!0,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,rx:0,ry:0})},t.prototype.createPath=function(e,t){var n=this.attr(),i=this.get("el");cr(t||n,(function(e,t){"x"===t||"y"===t?i.setAttribute("c"+t,e):vy[t]&&i.setAttribute(vy[t],e)}))},t}(ky),Iy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="image",t.canFill=!1,t.canStroke=!1,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,width:0,height:0})},t.prototype.createPath=function(e,t){var n=this,i=this.attr(),r=this.get("el");cr(t||i,(function(e,t){"img"===t?n._setImage(i.img):vy[t]&&r.setAttribute(vy[t],e)}))},t.prototype.setAttr=function(e,t){this.attrs[e]=t,"img"===e&&this._setImage(t)},t.prototype._setImage=function(e){var t=this.attr(),n=this.get("el");if(xr(e))n.setAttribute("href",e);else if(e instanceof window.Image)t.width||(n.setAttribute("width",e.width),this.attr("width",e.width)),t.height||(n.setAttribute("height",e.height),this.attr("height",e.height)),n.setAttribute("href",e.src);else if(e instanceof HTMLElement&&xr(e.nodeName)&&"CANVAS"===e.nodeName.toUpperCase())n.setAttribute("href",e.toDataURL());else if(e instanceof ImageData){var i=document.createElement("canvas");i.setAttribute("width",""+e.width),i.setAttribute("height",""+e.height),i.getContext("2d").putImageData(e,0,0),t.width||(n.setAttribute("width",""+e.width),this.attr("width",e.width)),t.height||(n.setAttribute("height",""+e.height),this.attr("height",e.height)),n.setAttribute("href",i.toDataURL())}},t}(ky),Ty=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="line",t.canFill=!1,t.canStroke=!0,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},t.prototype.createPath=function(e,t){var n=this.attr(),i=this.get("el");cr(t||n,(function(t,r){if("startArrow"===r||"endArrow"===r)if(t){var o=lr(t)?e.addArrow(n,vy[r]):e.getDefaultArrow(n,vy[r]);i.setAttribute(vy[r],"url(#"+o+")")}else i.removeAttribute(vy[r]);else vy[r]&&i.setAttribute(vy[r],t)}))},t.prototype.getTotalLength=function(){var e=this.attr(),t=e.x1,n=e.y1,i=e.x2,r=e.y2;return gd.length(t,n,i,r)},t.prototype.getPoint=function(e){var t=this.attr(),n=t.x1,i=t.y1,r=t.x2,o=t.y2;return gd.pointAt(n,i,r,o,e)},t}(ky),My={circle:function(e,t,n){return[["M",e,t],["m",-n,0],["a",n,n,0,1,0,2*n,0],["a",n,n,0,1,0,2*-n,0]]},square:function(e,t,n){return[["M",e-n,t-n],["L",e+n,t-n],["L",e+n,t+n],["L",e-n,t+n],["Z"]]},diamond:function(e,t,n){return[["M",e-n,t],["L",e,t-n],["L",e+n,t],["L",e,t+n],["Z"]]},triangle:function(e,t,n){var i=n*Math.sin(1/3*Math.PI);return[["M",e-n,t+i],["L",e,t-i],["L",e+n,t+i],["z"]]},triangleDown:function(e,t,n){var i=n*Math.sin(1/3*Math.PI);return[["M",e-n,t-i],["L",e+n,t-i],["L",e,t+i],["Z"]]}},Ay={get:function(e){return My[e]},register:function(e,t){My[e]=t},remove:function(e){delete My[e]},getAll:function(){return My}},Oy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="marker",t.canFill=!0,t.canStroke=!0,t}return qi(t,e),t.prototype.createPath=function(e){this.get("el").setAttribute("d",this._assembleMarker())},t.prototype._assembleMarker=function(){var e=this._getPath();return ar(e)?e.map((function(e){return e.join(" ")})).join(""):e},t.prototype._getPath=function(){var e,t=this.attr(),n=t.x,i=t.y,r=t.r||t.radius,o=t.symbol||"circle";return(e=or(o)?o:Ay.get(o))?e(n,i,r):(console.warn(e+" symbol is not exist."),null)},t.symbolsFactory=Ay,t}(ky),Ry=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="path",t.canFill=!0,t.canStroke=!0,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{startArrow:!1,endArrow:!1})},t.prototype.createPath=function(e,t){var n=this,i=this.attr(),r=this.get("el");cr(t||i,(function(t,o){if("path"===o&&ar(t))r.setAttribute("d",n._formatPath(t));else if("startArrow"===o||"endArrow"===o)if(t){var s=lr(t)?e.addArrow(i,vy[o]):e.getDefaultArrow(i,vy[o]);r.setAttribute(vy[o],"url(#"+s+")")}else r.removeAttribute(vy[o]);else vy[o]&&r.setAttribute(vy[o],t)}))},t.prototype._formatPath=function(e){var t=e.map((function(e){return e.join(" ")})).join("");return~t.indexOf("NaN")?"":t},t.prototype.getTotalLength=function(){var e=this.get("el");return e?e.getTotalLength():null},t.prototype.getPoint=function(e){var t=this.get("el"),n=this.getTotalLength();if(0===n)return null;var i=t?t.getPointAtLength(e*n):null;return i?{x:i.x,y:i.y}:null},t}(ky),Py=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="polygon",t.canFill=!0,t.canStroke=!0,t}return qi(t,e),t.prototype.createPath=function(e,t){var n=this.attr(),i=this.get("el");cr(t||n,(function(e,t){"points"===t&&ar(e)&&e.length>=2?i.setAttribute("points",e.map((function(e){return e[0]+","+e[1]})).join(" ")):vy[t]&&i.setAttribute(vy[t],e)}))},t}(ky),Fy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="polyline",t.canFill=!0,t.canStroke=!0,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{startArrow:!1,endArrow:!1})},t.prototype.onAttrChange=function(t,n,i){e.prototype.onAttrChange.call(this,t,n,i),-1!==["points"].indexOf(t)&&this._resetCache()},t.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},t.prototype.createPath=function(e,t){var n=this.attr(),i=this.get("el");cr(t||n,(function(e,t){"points"===t&&ar(e)&&e.length>=2?i.setAttribute("points",e.map((function(e){return e[0]+","+e[1]})).join(" ")):vy[t]&&i.setAttribute(vy[t],e)}))},t.prototype.getTotalLength=function(){var e=this.attr().points,t=this.get("totalLength");return sr(t)?(this.set("totalLength",Td(e)),this.get("totalLength")):t},t.prototype.getPoint=function(e){var t,n,i=this.attr().points,r=this.get("tCache");return r||(this._setTcache(),r=this.get("tCache")),cr(r,(function(i,r){e>=i[0]&&e<=i[1]&&(t=(e-i[0])/(i[1]-i[0]),n=r)})),gd.pointAt(i[n][0],i[n][1],i[n+1][0],i[n+1][1],t)},t.prototype._setTcache=function(){var e=this.attr().points;if(e&&0!==e.length){var t=this.getTotalLength();if(!(t<=0)){var n,i,r=0,o=[];cr(e,(function(s,a){e[a+1]&&((n=[])[0]=r/t,i=gd.length(s[0],s[1],e[a+1][0],e[a+1][1]),r+=i,n[1]=r/t,o.push(n))})),this.set("tCache",o)}}},t.prototype.getStartTangent=function(){var e=this.attr().points,t=[];return t.push([e[1][0],e[1][1]]),t.push([e[0][0],e[0][1]]),t},t.prototype.getEndTangent=function(){var e=this.attr().points,t=e.length-1,n=[];return n.push([e[t-1][0],e[t-1][1]]),n.push([e[t][0],e[t][1]]),n},t}(ky);var By=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="rect",t.canFill=!0,t.canStroke=!0,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,width:0,height:0,radius:0})},t.prototype.createPath=function(e,t){var n=this,i=this.attr(),r=this.get("el"),o=!1,s=["x","y","width","height","radius"];cr(t||i,(function(e,t){-1===s.indexOf(t)||o?-1===s.indexOf(t)&&vy[t]&&r.setAttribute(vy[t],e):(r.setAttribute("d",n._assembleRect(i)),o=!0)}))},t.prototype._assembleRect=function(e){var t=e.x,n=e.y,i=e.width,r=e.height,o=e.radius;if(!o)return"M "+t+","+n+" l "+i+",0 l 0,"+r+" l"+-i+" 0 z";var s=function(e){var t=0,n=0,i=0,r=0;return ar(e)?1===e.length?t=n=i=r=e[0]:2===e.length?(t=i=e[0],n=r=e[1]):3===e.length?(t=e[0],n=r=e[1],i=e[2]):(t=e[0],n=e[1],i=e[2],r=e[3]):t=n=i=r=e,{r1:t,r2:n,r3:i,r4:r}}(o);return ar(o)?1===o.length?s.r1=s.r2=s.r3=s.r4=o[0]:2===o.length?(s.r1=s.r3=o[0],s.r2=s.r4=o[1]):3===o.length?(s.r1=o[0],s.r2=s.r4=o[1],s.r3=o[2]):(s.r1=o[0],s.r2=o[1],s.r3=o[2],s.r4=o[3]):s.r1=s.r2=s.r3=s.r4=o,[["M "+(t+s.r1)+","+n],["l "+(i-s.r1-s.r2)+",0"],["a "+s.r2+","+s.r2+",0,0,1,"+s.r2+","+s.r2],["l 0,"+(r-s.r2-s.r3)],["a "+s.r3+","+s.r3+",0,0,1,"+-s.r3+","+s.r3],["l "+(s.r3+s.r4-i)+",0"],["a "+s.r4+","+s.r4+",0,0,1,"+-s.r4+","+-s.r4],["l 0,"+(s.r4+s.r1-r)],["a "+s.r1+","+s.r1+",0,0,1,"+s.r1+","+-s.r1],["z"]].join(" ")},t}(ky),Wy={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},zy={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},Vy={left:"left",start:"left",center:"middle",right:"end",end:"end"},Uy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="text",t.canFill=!0,t.canStroke=!0,t}return qi(t,e),t.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return $i($i({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},t.prototype.createPath=function(e,t){var n=this,i=this.attr(),r=this.get("el");this._setFont(),cr(t||i,(function(e,t){"text"===t?n._setText(""+e):"matrix"===t&&e?wy(n):vy[t]&&r.setAttribute(vy[t],e)})),r.setAttribute("paint-order","stroke"),r.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},t.prototype._setFont=function(){var e=this.get("el"),t=this.attr(),n=t.textBaseline,i=t.textAlign,r=Jc();r&&"firefox"===r.name?e.setAttribute("dominant-baseline",zy[n]||"alphabetic"):e.setAttribute("alignment-baseline",Wy[n]||"baseline"),e.setAttribute("text-anchor",Vy[i]||"left")},t.prototype._setText=function(e){var t=this.get("el"),n=this.attr(),i=n.x,r=n.textBaseline,o=void 0===r?"bottom":r;if(e)if(~e.indexOf("\n")){var s=e.split("\n"),a=s.length-1,l="";cr(s,(function(e,t){0===t?"alphabetic"===o?l+='<tspan x="'+i+'" dy="'+-a+'em">'+e+"</tspan>":"top"===o?l+='<tspan x="'+i+'" dy="0.9em">'+e+"</tspan>":"middle"===o?l+='<tspan x="'+i+'" dy="'+-(a-1)/2+'em">'+e+"</tspan>":"bottom"===o?l+='<tspan x="'+i+'" dy="-'+(a+.3)+'em">'+e+"</tspan>":"hanging"===o&&(l+='<tspan x="'+i+'" dy="'+(-(a-1)-.3)+'em">'+e+"</tspan>"):l+='<tspan x="'+i+'" dy="1em">'+e+"</tspan>"})),t.innerHTML=l}else t.innerHTML=e;else t.innerHTML=""},t}(ky),Hy=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,jy=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Gy=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function Ky(e){var t=e.match(Gy);if(!t)return"";var n="";return t.sort((function(e,t){return e=e.split(":"),t=t.split(":"),Number(e[0])-Number(t[0])})),cr(t,(function(e){e=e.split(":"),n+='<stop offset="'+e[0]+'" stop-color="'+e[1]+'"></stop>'})),n}var qy=function(){function e(e){this.cfg={};var t,n,i,r,o,s,a,l=null,c=bo("gradient_");return"l"===e.toLowerCase()[0]?function(e,t){var n,i,r=Hy.exec(e),o=Fr(Vr(parseFloat(r[1])),2*Math.PI),s=r[2];o>=0&&o<.5*Math.PI?(n={x:0,y:0},i={x:1,y:1}):.5*Math.PI<=o&&o<Math.PI?(n={x:1,y:0},i={x:0,y:1}):Math.PI<=o&&o<1.5*Math.PI?(n={x:1,y:1},i={x:0,y:0}):(n={x:0,y:1},i={x:1,y:0});var a=Math.tan(o),l=a*a,c=(i.x-n.x+a*(i.y-n.y))/(l+1)+n.x,u=a*(i.x-n.x+a*(i.y-n.y))/(l+1)+n.y;t.setAttribute("x1",n.x),t.setAttribute("y1",n.y),t.setAttribute("x2",c),t.setAttribute("y2",u),t.innerHTML=Ky(s)}(e,l=yy("linearGradient")):(l=yy("radialGradient"),t=e,n=l,i=jy.exec(t),r=parseFloat(i[1]),o=parseFloat(i[2]),s=parseFloat(i[3]),a=i[4],n.setAttribute("cx",r),n.setAttribute("cy",o),n.setAttribute("r",s),n.innerHTML=Ky(a)),l.setAttribute("id",c),this.el=l,this.id=c,this.cfg=e,this}return e.prototype.match=function(e,t){return this.cfg===t},e}(),$y={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},Yy={x:"-40%",y:"-40%",width:"200%",height:"200%"},Xy=function(){function e(e){this.type="filter",this.cfg={},this.type="filter";var t=yy("filter");return cr(Yy,(function(e,n){t.setAttribute(n,e)})),this.el=t,this.id=bo("filter_"),this.el.id=this.id,this.cfg=e,this._parseShadow(e,t),this}return e.prototype.match=function(e,t){if(this.type!==e)return!1;var n=!0,i=this.cfg;return cr(Object.keys(i),(function(e){if(i[e]!==t[e])return n=!1,!1})),n},e.prototype.update=function(e,t){var n=this.cfg;return n[$y[e]]=t,this._parseShadow(n,this.el),this},e.prototype._parseShadow=function(e,t){var n='<feDropShadow\n      dx="'+(e.dx||0)+'"\n      dy="'+(e.dy||0)+'"\n      stdDeviation="'+(e.blur?e.blur/10:0)+'"\n      flood-color="'+(e.color?e.color:"#000")+'"\n      flood-opacity="'+(e.opacity?e.opacity:1)+'"\n      />';t.innerHTML=n},e}(),Zy=function(){function e(e,t){this.cfg={};var n=yy("marker"),i=bo("marker_");n.setAttribute("id",i);var r=yy("path");r.setAttribute("stroke",e.stroke||"none"),r.setAttribute("fill",e.fill||"none"),n.appendChild(r),n.setAttribute("overflow","visible"),n.setAttribute("orient","auto-start-reverse"),this.el=n,this.child=r,this.id=i;var o=e["marker-start"===t?"startArrow":"endArrow"];return this.stroke=e.stroke||"#000",!0===o?this._setDefaultPath(t,r):(this.cfg=o,this._setMarker(e.lineWidth,r)),this}return e.prototype.match=function(){return!1},e.prototype._setDefaultPath=function(e,t){var n=this.el;t.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),n.setAttribute("refX",""+10*Math.cos(Math.PI/6)),n.setAttribute("refY","5")},e.prototype._setMarker=function(e,t){var n=this.el,i=this.cfg.path,r=this.cfg.d;ar(i)&&(i=i.map((function(e){return e.join(" ")})).join("")),t.setAttribute("d",i),n.appendChild(t),r&&n.setAttribute("refX",""+r/e)},e.prototype.update=function(e){var t=this.child;t.attr?t.attr("fill",e):t.setAttribute("fill",e)},e}(),Qy=function(){function e(e){this.type="clip",this.cfg={};var t=yy("clipPath");this.el=t,this.id=bo("clip_"),t.id=this.id;var n=e.cfg.el;return t.appendChild(n),this.cfg=e,this}return e.prototype.match=function(){return!1},e.prototype.remove=function(){var e=this.el;e.parentNode.removeChild(e)},e}(),Jy=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,e_=function(){function e(e){this.cfg={};var t=yy("pattern");t.setAttribute("patternUnits","userSpaceOnUse");var n=yy("image");t.appendChild(n);var i=bo("pattern_");t.id=i,this.el=t,this.id=i,this.cfg=e;var r=Jy.exec(e)[2];n.setAttribute("href",r);var o=new Image;function s(){t.setAttribute("width",""+o.width),t.setAttribute("height",""+o.height)}return r.match(/^data:/i)||(o.crossOrigin="Anonymous"),o.src=r,o.complete?s():(o.onload=s,o.src=o.src),this}return e.prototype.match=function(e,t){return this.cfg===t},e}(),t_=function(){function e(e){var t=yy("defs"),n=bo("defs_");t.id=n,e.appendChild(t),this.children=[],this.defaultArrow={},this.el=t,this.canvas=e}return e.prototype.find=function(e,t){for(var n=this.children,i=null,r=0;r<n.length;r++)if(n[r].match(e,t)){i=n[r].id;break}return i},e.prototype.findById=function(e){for(var t=this.children,n=null,i=0;i<t.length;i++)if(t[i].id===e){n=t[i];break}return n},e.prototype.add=function(e){this.children.push(e),e.canvas=this.canvas,e.parent=this},e.prototype.getDefaultArrow=function(e,t){var n=e.stroke||e.strokeStyle;if(this.defaultArrow[n])return this.defaultArrow[n].id;var i=new Zy(e,t);return this.defaultArrow[n]=i,this.el.appendChild(i.el),this.add(i),i.id},e.prototype.addGradient=function(e){var t=new qy(e);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addArrow=function(e,t){var n=new Zy(e,t);return this.el.appendChild(n.el),this.add(n),n.id},e.prototype.addShadow=function(e){var t=new Xy(e);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addPattern=function(e){var t=new e_(e);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addClip=function(e){var t=new Qy(e);return this.el.appendChild(t.el),this.add(t),t.id},e}(),n_=function(e){function t(t){return e.call(this,$i($i({},t),{autoDraw:!0,renderer:"svg"}))||this}return qi(t,e),t.prototype.getShapeBase=function(){return ve},t.prototype.getGroupBase=function(){return Ey},t.prototype.getShape=function(e,t,n){var i=n.target||n.srcElement;if(!my[i.tagName]){for(var r=i.parentNode;r&&!my[r.tagName];)r=r.parentNode;i=r}return this.find((function(e){return e.get("el")===i}))},t.prototype.createDom=function(){var e=yy("svg"),t=new t_(e);return e.setAttribute("width",""+this.get("width")),e.setAttribute("height",""+this.get("height")),this.set("context",t),e},t.prototype.onCanvasChange=function(e){var t=this.get("context"),n=this.get("el");if("sort"===e){var i=this.get("children");i&&i.length&&by(this,(function(e,t){return i.indexOf(e)-i.indexOf(t)?1:0}))}else if("clear"===e){if(n){n.innerHTML="";var r=t.el;r.innerHTML="",n.appendChild(r)}}else"matrix"===e?wy(this):"clip"===e?Cy(this,t):"changeSize"===e&&(n.setAttribute("width",""+this.get("width")),n.setAttribute("height",""+this.get("height")))},t.prototype.draw=function(){var e=this.get("context"),t=this.getChildren();Cy(this,e),t.length&&Sy(e,t)},t}(ed),i_={exports:{}},r_={exports:{}},o_=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))},s_=Array.prototype.concat,a_=Array.prototype.slice,l_=r_.exports=function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];o_(r)?t=s_.call(t,a_.call(r)):t.push(r)}return t};l_.wrap=function(e){return function(){return e(l_(arguments))}};var c_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},u_=r_.exports,h_=Object.hasOwnProperty,d_={};for(var f_ in c_)h_.call(c_,f_)&&(d_[c_[f_]]=f_);var g_=i_.exports={to:{},get:{}};function p_(e,t,n){return Math.min(Math.max(t,e),n)}function m_(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}g_.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=g_.get.hsl(e),n="hsl";break;case"hwb":t=g_.get.hwb(e),n="hwb";break;default:t=g_.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},g_.get.rgb=function(e){if(!e)return null;var t,n,i,r=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=t[2],t=t[1],n=0;n<3;n++){var o=2*n;r[n]=parseInt(t.slice(o,o+2),16)}i&&(r[3]=parseInt(i,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(i=(t=t[1])[3],n=0;n<3;n++)r[n]=parseInt(t[n]+t[n],16);i&&(r[3]=parseInt(i+i,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)r[n]=parseInt(t[n+1],0);t[4]&&(t[5]?r[3]=.01*parseFloat(t[4]):r[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:h_.call(c_,t[1])?((r=c_[t[1]])[3]=1,r):null:null;for(n=0;n<3;n++)r[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(t[5]?r[3]=.01*parseFloat(t[4]):r[3]=parseFloat(t[4]))}for(n=0;n<3;n++)r[n]=p_(r[n],0,255);return r[3]=p_(r[3],0,1),r},g_.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,p_(parseFloat(t[2]),0,100),p_(parseFloat(t[3]),0,100),p_(isNaN(n)?1:n,0,1)]}return null},g_.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,p_(parseFloat(t[2]),0,100),p_(parseFloat(t[3]),0,100),p_(isNaN(n)?1:n,0,1)]}return null},g_.to.hex=function(){var e=u_(arguments);return"#"+m_(e[0])+m_(e[1])+m_(e[2])+(e[3]<1?m_(Math.round(255*e[3])):"")},g_.to.rgb=function(){var e=u_(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},g_.to.rgb.percent=function(){var e=u_(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+i+"%)":"rgba("+t+"%, "+n+"%, "+i+"%, "+e[3]+")"},g_.to.hsl=function(){var e=u_(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},g_.to.hwb=function(){var e=u_(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},g_.to.keyword=function(e){return d_[e.slice(0,3)]};var v_={exports:{}},y_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},__={};for(var b_ in y_)y_.hasOwnProperty(b_)&&(__[y_[b_]]=b_);var w_=v_.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var C_ in w_)if(w_.hasOwnProperty(C_)){if(!("channels"in w_[C_]))throw new Error("missing channels property: "+C_);if(!("labels"in w_[C_]))throw new Error("missing channel labels property: "+C_);if(w_[C_].labels.length!==w_[C_].channels)throw new Error("channel and label counts mismatch: "+C_);var S_=w_[C_].channels,x_=w_[C_].labels;delete w_[C_].channels,delete w_[C_].labels,Object.defineProperty(w_[C_],"channels",{value:S_}),Object.defineProperty(w_[C_],"labels",{value:x_})}w_.rgb.hsl=function(e){var t,n,i=e[0]/255,r=e[1]/255,o=e[2]/255,s=Math.min(i,r,o),a=Math.max(i,r,o),l=a-s;return a===s?t=0:i===a?t=(r-o)/l:r===a?t=2+(o-i)/l:o===a&&(t=4+(i-r)/l),(t=Math.min(60*t,360))<0&&(t+=360),n=(s+a)/2,[t,100*(a===s?0:n<=.5?l/(a+s):l/(2-a-s)),100*n]},w_.rgb.hsv=function(e){var t,n,i,r,o,s=e[0]/255,a=e[1]/255,l=e[2]/255,c=Math.max(s,a,l),u=c-Math.min(s,a,l),h=function(e){return(c-e)/6/u+.5};return 0===u?r=o=0:(o=u/c,t=h(s),n=h(a),i=h(l),s===c?r=i-n:a===c?r=1/3+t-i:l===c&&(r=2/3+n-t),r<0?r+=1:r>1&&(r-=1)),[360*r,100*o,100*c]},w_.rgb.hwb=function(e){var t=e[0],n=e[1],i=e[2];return[w_.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,i))),100*(i=1-1/255*Math.max(t,Math.max(n,i)))]},w_.rgb.cmyk=function(e){var t,n=e[0]/255,i=e[1]/255,r=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-i,1-r)))/(1-t)||0),100*((1-i-t)/(1-t)||0),100*((1-r-t)/(1-t)||0),100*t]},w_.rgb.keyword=function(e){var t=__[e];if(t)return t;var n,i,r,o=1/0;for(var s in y_)if(y_.hasOwnProperty(s)){var a=y_[s],l=(i=e,r=a,Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2)+Math.pow(i[2]-r[2],2));l<o&&(o=l,n=s)}return n},w_.keyword.rgb=function(e){return y_[e]},w_.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,i=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)),100*(.2126*t+.7152*n+.0722*i),100*(.0193*t+.1192*n+.9505*i)]},w_.rgb.lab=function(e){var t=w_.rgb.xyz(e),n=t[0],i=t[1],r=t[2];return i/=100,r/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(n-i),200*(i-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},w_.hsl.rgb=function(e){var t,n,i,r,o,s=e[0]/360,a=e[1]/100,l=e[2]/100;if(0===a)return[o=255*l,o,o];t=2*l-(n=l<.5?l*(1+a):l+a-l*a),r=[0,0,0];for(var c=0;c<3;c++)(i=s+1/3*-(c-1))<0&&i++,i>1&&i--,o=6*i<1?t+6*(n-t)*i:2*i<1?n:3*i<2?t+(n-t)*(2/3-i)*6:t,r[c]=255*o;return r},w_.hsl.hsv=function(e){var t=e[0],n=e[1]/100,i=e[2]/100,r=n,o=Math.max(i,.01);return n*=(i*=2)<=1?i:2-i,r*=o<=1?o:2-o,[t,100*(0===i?2*r/(o+r):2*n/(i+n)),100*((i+n)/2)]},w_.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,i=e[2]/100,r=Math.floor(t)%6,o=t-Math.floor(t),s=255*i*(1-n),a=255*i*(1-n*o),l=255*i*(1-n*(1-o));switch(i*=255,r){case 0:return[i,l,s];case 1:return[a,i,s];case 2:return[s,i,l];case 3:return[s,a,i];case 4:return[l,s,i];case 5:return[i,s,a]}},w_.hsv.hsl=function(e){var t,n,i,r=e[0],o=e[1]/100,s=e[2]/100,a=Math.max(s,.01);return i=(2-o)*s,n=o*a,[r,100*(n=(n/=(t=(2-o)*a)<=1?t:2-t)||0),100*(i/=2)]},w_.hwb.rgb=function(e){var t,n,i,r,o,s,a,l=e[0]/360,c=e[1]/100,u=e[2]/100,h=c+u;switch(h>1&&(c/=h,u/=h),i=6*l-(t=Math.floor(6*l)),0!=(1&t)&&(i=1-i),r=c+i*((n=1-u)-c),t){default:case 6:case 0:o=n,s=r,a=c;break;case 1:o=r,s=n,a=c;break;case 2:o=c,s=n,a=r;break;case 3:o=c,s=r,a=n;break;case 4:o=r,s=c,a=n;break;case 5:o=n,s=c,a=r}return[255*o,255*s,255*a]},w_.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,i=e[2]/100,r=e[3]/100;return[255*(1-Math.min(1,t*(1-r)+r)),255*(1-Math.min(1,n*(1-r)+r)),255*(1-Math.min(1,i*(1-r)+r))]},w_.xyz.rgb=function(e){var t,n,i,r=e[0]/100,o=e[1]/100,s=e[2]/100;return n=-.9689*r+1.8758*o+.0415*s,i=.0557*r+-.204*o+1.057*s,t=(t=3.2406*r+-1.5372*o+-.4986*s)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(i=Math.min(Math.max(0,i),1))]},w_.xyz.lab=function(e){var t=e[0],n=e[1],i=e[2];return n/=100,i/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},w_.lab.xyz=function(e){var t,n,i,r=e[0];t=e[1]/500+(n=(r+16)/116),i=n-e[2]/200;var o=Math.pow(n,3),s=Math.pow(t,3),a=Math.pow(i,3);return n=o>.008856?o:(n-16/116)/7.787,t=s>.008856?s:(t-16/116)/7.787,i=a>.008856?a:(i-16/116)/7.787,[t*=95.047,n*=100,i*=108.883]},w_.lab.lch=function(e){var t,n=e[0],i=e[1],r=e[2];return(t=360*Math.atan2(r,i)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(i*i+r*r),t]},w_.lch.lab=function(e){var t,n=e[0],i=e[1];return t=e[2]/360*2*Math.PI,[n,i*Math.cos(t),i*Math.sin(t)]},w_.rgb.ansi16=function(e){var t=e[0],n=e[1],i=e[2],r=1 in arguments?arguments[1]:w_.rgb.hsv(e)[2];if(0===(r=Math.round(r/50)))return 30;var o=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===r&&(o+=60),o},w_.hsv.ansi16=function(e){return w_.rgb.ansi16(w_.hsv.rgb(e),e[2])},w_.rgb.ansi256=function(e){var t=e[0],n=e[1],i=e[2];return t===n&&n===i?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(i/255*5)},w_.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},w_.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},w_.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},w_.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map((function(e){return e+e})).join(""));var i=parseInt(n,16);return[i>>16&255,i>>8&255,255&i]},w_.rgb.hcg=function(e){var t,n=e[0]/255,i=e[1]/255,r=e[2]/255,o=Math.max(Math.max(n,i),r),s=Math.min(Math.min(n,i),r),a=o-s;return t=a<=0?0:o===n?(i-r)/a%6:o===i?2+(r-n)/a:4+(n-i)/a+4,t/=6,[360*(t%=1),100*a,100*(a<1?s/(1-a):0)]},w_.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,i=1,r=0;return(i=n<.5?2*t*n:2*t*(1-n))<1&&(r=(n-.5*i)/(1-i)),[e[0],100*i,100*r]},w_.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,i=t*n,r=0;return i<1&&(r=(n-i)/(1-i)),[e[0],100*i,100*r]},w_.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,i=e[2]/100;if(0===n)return[255*i,255*i,255*i];var r,o=[0,0,0],s=t%1*6,a=s%1,l=1-a;switch(Math.floor(s)){case 0:o[0]=1,o[1]=a,o[2]=0;break;case 1:o[0]=l,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=a;break;case 3:o[0]=0,o[1]=l,o[2]=1;break;case 4:o[0]=a,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=l}return r=(1-n)*i,[255*(n*o[0]+r),255*(n*o[1]+r),255*(n*o[2]+r)]},w_.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),i=0;return n>0&&(i=t/n),[e[0],100*i,100*n]},w_.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,i=0;return n>0&&n<.5?i=t/(2*n):n>=.5&&n<1&&(i=t/(2*(1-n))),[e[0],100*i,100*n]},w_.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},w_.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,i=n-t,r=0;return i<1&&(r=(n-i)/(1-i)),[e[0],100*i,100*r]},w_.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},w_.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},w_.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},w_.gray.hsl=w_.gray.hsv=function(e){return[0,0,e[0]]},w_.gray.hwb=function(e){return[0,100,e[0]]},w_.gray.cmyk=function(e){return[0,0,0,e[0]]},w_.gray.lab=function(e){return[e[0],0,0]},w_.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},w_.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};var E_=v_.exports;function k_(e){var t=function(){for(var e={},t=Object.keys(E_),n=t.length,i=0;i<n;i++)e[t[i]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var i=n.pop(),r=Object.keys(E_[i]),o=r.length,s=0;s<o;s++){var a=r[s],l=t[a];-1===l.distance&&(l.distance=t[i].distance+1,l.parent=i,n.unshift(a))}return t}function L_(e,t){return function(n){return t(e(n))}}function D_(e,t){for(var n=[t[e].parent,e],i=E_[t[e].parent][e],r=t[e].parent;t[r].parent;)n.unshift(t[r].parent),i=L_(E_[t[r].parent][r],i),r=t[r].parent;return i.conversion=n,i}var N_=v_.exports,I_=function(e){for(var t=k_(e),n={},i=Object.keys(t),r=i.length,o=0;o<r;o++){var s=i[o];null!==t[s].parent&&(n[s]=D_(s,t))}return n},T_={};Object.keys(N_).forEach((function(e){T_[e]={},Object.defineProperty(T_[e],"channels",{value:N_[e].channels}),Object.defineProperty(T_[e],"labels",{value:N_[e].labels});var t=I_(e);Object.keys(t).forEach((function(n){var i=t[n];T_[e][n]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var i=n.length,r=0;r<i;r++)n[r]=Math.round(n[r]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(i),T_[e][n].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(i)}))}));var M_=T_,A_=i_.exports,O_=M_,R_=[].slice,P_=["keyword","gray","hex"],F_={};Object.keys(O_).forEach((function(e){F_[R_.call(O_[e].labels).sort().join("")]=e}));var B_={};function W_(e,t){if(!(this instanceof W_))return new W_(e,t);if(t&&t in P_&&(t=null),t&&!(t in O_))throw new Error("Unknown model: "+t);var n,i;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof W_)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var r=A_.get(e);if(null===r)throw new Error("Unable to parse color from string: "+e);this.model=r.model,i=O_[this.model].channels,this.color=r.value.slice(0,i),this.valpha="number"==typeof r.value[i]?r.value[i]:1}else if(e.length){this.model=t||"rgb",i=O_[this.model].channels;var o=R_.call(e,0,i);this.color=H_(o,i),this.valpha="number"==typeof e[i]?e[i]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var s=Object.keys(e);"alpha"in e&&(s.splice(s.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var a=s.sort().join("");if(!(a in F_))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=F_[a];var l=O_[this.model].labels,c=[];for(n=0;n<l.length;n++)c.push(e[l[n]]);this.color=H_(c)}if(B_[this.model])for(i=O_[this.model].channels,n=0;n<i;n++){var u=B_[this.model][n];u&&(this.color[n]=u(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function z_(e,t,n){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(B_[e]||(B_[e]=[]))[t]=n})),e=e[0],function(i){var r;return arguments.length?(n&&(i=n(i)),(r=this[e]()).color[t]=i,r):(r=this[e]().color[t],n&&(r=n(r)),r)}}function V_(e){return function(t){return Math.max(0,Math.min(e,t))}}function U_(e){return Array.isArray(e)?e:[e]}function H_(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}W_.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in A_.to?this:this.rgb(),n=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return A_.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return A_.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=O_[this.model].channels,n=O_[this.model].labels,i=0;i<t;i++)e[n[i]]=this.color[i];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new W_(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new W_(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:z_("rgb",0,V_(255)),green:z_("rgb",1,V_(255)),blue:z_("rgb",2,V_(255)),hue:z_(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:z_("hsl",1,V_(100)),lightness:z_("hsl",2,V_(100)),saturationv:z_("hsv",1,V_(100)),value:z_("hsv",2,V_(100)),chroma:z_("hcg",1,V_(100)),gray:z_("hcg",2,V_(100)),white:z_("hwb",1,V_(100)),wblack:z_("hwb",2,V_(100)),cyan:z_("cmyk",0,V_(100)),magenta:z_("cmyk",1,V_(100)),yellow:z_("cmyk",2,V_(100)),black:z_("cmyk",3,V_(100)),x:z_("xyz",0,V_(100)),y:z_("xyz",1,V_(100)),z:z_("xyz",2,V_(100)),l:z_("lab",0,V_(100)),a:z_("lab",1),b:z_("lab",2),keyword:function(e){return arguments.length?new W_(e):O_[this.model].keyword(this.color)},hex:function(e){return arguments.length?new W_(e):A_.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var i=e[n]/255;t[n]=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return W_.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),i=this.rgb(),r=void 0===t?.5:t,o=2*r-1,s=n.alpha()-i.alpha(),a=((o*s==-1?o:(o+s)/(1+o*s))+1)/2,l=1-a;return W_.rgb(a*n.red()+l*i.red(),a*n.green()+l*i.green(),a*n.blue()+l*i.blue(),n.alpha()*r+i.alpha()*(1-r))}},Object.keys(O_).forEach((function(e){if(-1===P_.indexOf(e)){var t=O_[e].channels;W_.prototype[e]=function(){if(this.model===e)return new W_(this);if(arguments.length)return new W_(arguments,e);var n="number"==typeof arguments[t]?t:this.valpha;return new W_(U_(O_[this.model][e].raw(this.color)).concat(n),e)},W_[e]=function(n){return"number"==typeof n&&(n=H_(R_.call(arguments),t)),new W_(n,e)}}}));var j_=W_,G_={exports:{}};!function(e){!function(t){var n=/^\s+/,i=/\s+$/,r=0,o=t.round,s=t.min,a=t.max,l=t.random;function c(e,l){if(l=l||{},(e=e||"")instanceof c)return e;if(!(this instanceof c))return new c(e,l);var u=function(e){var r={r:0,g:0,b:0},o=1,l=null,c=null,u=null,h=!1,d=!1;"string"==typeof e&&(e=function(e){e=e.replace(n,"").replace(i,"").toLowerCase();var t,r=!1;if(L[e])e=L[e],r=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=z.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=z.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=z.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=z.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=z.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=z.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=z.hex8.exec(e))return{r:M(t[1]),g:M(t[2]),b:M(t[3]),a:P(t[4]),format:r?"name":"hex8"};if(t=z.hex6.exec(e))return{r:M(t[1]),g:M(t[2]),b:M(t[3]),format:r?"name":"hex"};if(t=z.hex4.exec(e))return{r:M(t[1]+""+t[1]),g:M(t[2]+""+t[2]),b:M(t[3]+""+t[3]),a:P(t[4]+""+t[4]),format:r?"name":"hex8"};if(t=z.hex3.exec(e))return{r:M(t[1]+""+t[1]),g:M(t[2]+""+t[2]),b:M(t[3]+""+t[3]),format:r?"name":"hex"};return!1}(e));"object"==typeof e&&(V(e.r)&&V(e.g)&&V(e.b)?(f=e.r,g=e.g,p=e.b,r={r:255*I(f,255),g:255*I(g,255),b:255*I(p,255)},h=!0,d="%"===String(e.r).substr(-1)?"prgb":"rgb"):V(e.h)&&V(e.s)&&V(e.v)?(l=O(e.s),c=O(e.v),r=function(e,n,i){e=6*I(e,360),n=I(n,100),i=I(i,100);var r=t.floor(e),o=e-r,s=i*(1-n),a=i*(1-o*n),l=i*(1-(1-o)*n),c=r%6;return{r:255*[i,a,s,s,l,i][c],g:255*[l,i,i,a,s,s][c],b:255*[s,s,l,i,i,a][c]}}(e.h,l,c),h=!0,d="hsv"):V(e.h)&&V(e.s)&&V(e.l)&&(l=O(e.s),u=O(e.l),r=function(e,t,n){var i,r,o;function s(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=I(e,360),t=I(t,100),n=I(n,100),0===t)i=r=o=n;else{var a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;i=s(l,a,e+1/3),r=s(l,a,e),o=s(l,a,e-1/3)}return{r:255*i,g:255*r,b:255*o}}(e.h,l,u),h=!0,d="hsl"),e.hasOwnProperty("a")&&(o=e.a));var f,g,p;return o=N(o),{ok:h,format:e.format||d,r:s(255,a(r.r,0)),g:s(255,a(r.g,0)),b:s(255,a(r.b,0)),a:o}}(e);this._originalInput=e,this._r=u.r,this._g=u.g,this._b=u.b,this._a=u.a,this._roundA=o(100*this._a)/100,this._format=l.format||u.format,this._gradientType=l.gradientType,this._r<1&&(this._r=o(this._r)),this._g<1&&(this._g=o(this._g)),this._b<1&&(this._b=o(this._b)),this._ok=u.ok,this._tc_id=r++}function u(e,t,n){e=I(e,255),t=I(t,255),n=I(n,255);var i,r,o=a(e,t,n),l=s(e,t,n),c=(o+l)/2;if(o==l)i=r=0;else{var u=o-l;switch(r=c>.5?u/(2-o-l):u/(o+l),o){case e:i=(t-n)/u+(t<n?6:0);break;case t:i=(n-e)/u+2;break;case n:i=(e-t)/u+4}i/=6}return{h:i,s:r,l:c}}function h(e,t,n){e=I(e,255),t=I(t,255),n=I(n,255);var i,r,o=a(e,t,n),l=s(e,t,n),c=o,u=o-l;if(r=0===o?0:u/o,o==l)i=0;else{switch(o){case e:i=(t-n)/u+(t<n?6:0);break;case t:i=(n-e)/u+2;break;case n:i=(e-t)/u+4}i/=6}return{h:i,s:r,v:c}}function d(e,t,n,i){var r=[A(o(e).toString(16)),A(o(t).toString(16)),A(o(n).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function f(e,t,n,i){return[A(R(i)),A(o(e).toString(16)),A(o(t).toString(16)),A(o(n).toString(16))].join("")}function g(e,t){t=0===t?0:t||10;var n=c(e).toHsl();return n.s-=t/100,n.s=T(n.s),c(n)}function p(e,t){t=0===t?0:t||10;var n=c(e).toHsl();return n.s+=t/100,n.s=T(n.s),c(n)}function m(e){return c(e).desaturate(100)}function v(e,t){t=0===t?0:t||10;var n=c(e).toHsl();return n.l+=t/100,n.l=T(n.l),c(n)}function y(e,t){t=0===t?0:t||10;var n=c(e).toRgb();return n.r=a(0,s(255,n.r-o(-t/100*255))),n.g=a(0,s(255,n.g-o(-t/100*255))),n.b=a(0,s(255,n.b-o(-t/100*255))),c(n)}function _(e,t){t=0===t?0:t||10;var n=c(e).toHsl();return n.l-=t/100,n.l=T(n.l),c(n)}function b(e,t){var n=c(e).toHsl(),i=(n.h+t)%360;return n.h=i<0?360+i:i,c(n)}function w(e){var t=c(e).toHsl();return t.h=(t.h+180)%360,c(t)}function C(e){var t=c(e).toHsl(),n=t.h;return[c(e),c({h:(n+120)%360,s:t.s,l:t.l}),c({h:(n+240)%360,s:t.s,l:t.l})]}function S(e){var t=c(e).toHsl(),n=t.h;return[c(e),c({h:(n+90)%360,s:t.s,l:t.l}),c({h:(n+180)%360,s:t.s,l:t.l}),c({h:(n+270)%360,s:t.s,l:t.l})]}function x(e){var t=c(e).toHsl(),n=t.h;return[c(e),c({h:(n+72)%360,s:t.s,l:t.l}),c({h:(n+216)%360,s:t.s,l:t.l})]}function E(e,t,n){t=t||6,n=n||30;var i=c(e).toHsl(),r=360/n,o=[c(e)];for(i.h=(i.h-(r*t>>1)+720)%360;--t;)i.h=(i.h+r)%360,o.push(c(i));return o}function k(e,t){t=t||6;for(var n=c(e).toHsv(),i=n.h,r=n.s,o=n.v,s=[],a=1/t;t--;)s.push(c({h:i,s:r,v:o})),o=(o+a)%1;return s}c.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,n,i,r=this.toRgb();return e=r.r/255,n=r.g/255,i=r.b/255,.2126*(e<=.03928?e/12.92:t.pow((e+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:t.pow((n+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:t.pow((i+.055)/1.055,2.4))},setAlpha:function(e){return this._a=N(e),this._roundA=o(100*this._a)/100,this},toHsv:function(){var e=h(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=h(this._r,this._g,this._b),t=o(360*e.h),n=o(100*e.s),i=o(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+i+"%)":"hsva("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=u(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=u(this._r,this._g,this._b),t=o(360*e.h),n=o(100*e.s),i=o(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+i+"%)":"hsla("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return d(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,i,r){var s=[A(o(e).toString(16)),A(o(t).toString(16)),A(o(n).toString(16)),A(R(i))];if(r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1))return s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0);return s.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(100*I(this._r,255))+"%",g:o(100*I(this._g,255))+"%",b:o(100*I(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+o(100*I(this._r,255))+"%, "+o(100*I(this._g,255))+"%, "+o(100*I(this._b,255))+"%)":"rgba("+o(100*I(this._r,255))+"%, "+o(100*I(this._g,255))+"%, "+o(100*I(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(D[d(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+f(this._r,this._g,this._b,this._a),n=t,i=this._gradientType?"GradientType = 1, ":"";if(e){var r=c(e);n="#"+f(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0;return t||!i||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return c(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(v,arguments)},brighten:function(){return this._applyModification(y,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(g,arguments)},saturate:function(){return this._applyModification(p,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(b,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(E,arguments)},complement:function(){return this._applyCombination(w,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(x,arguments)},triad:function(){return this._applyCombination(C,arguments)},tetrad:function(){return this._applyCombination(S,arguments)}},c.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]="a"===i?e[i]:O(e[i]));e=n}return c(e,t)},c.equals=function(e,t){return!(!e||!t)&&c(e).toRgbString()==c(t).toRgbString()},c.random=function(){return c.fromRatio({r:l(),g:l(),b:l()})},c.mix=function(e,t,n){n=0===n?0:n||50;var i=c(e).toRgb(),r=c(t).toRgb(),o=n/100;return c({r:(r.r-i.r)*o+i.r,g:(r.g-i.g)*o+i.g,b:(r.b-i.b)*o+i.b,a:(r.a-i.a)*o+i.a})},c.readability=function(e,n){var i=c(e),r=c(n);return(t.max(i.getLuminance(),r.getLuminance())+.05)/(t.min(i.getLuminance(),r.getLuminance())+.05)},c.isReadable=function(e,t,n){var i,r,o=c.readability(e,t);switch(r=!1,(i=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n)).level+i.size){case"AAsmall":case"AAAlarge":r=o>=4.5;break;case"AAlarge":r=o>=3;break;case"AAAsmall":r=o>=7}return r},c.mostReadable=function(e,t,n){var i,r,o,s,a=null,l=0;r=(n=n||{}).includeFallbackColors,o=n.level,s=n.size;for(var u=0;u<t.length;u++)(i=c.readability(e,t[u]))>l&&(l=i,a=c(t[u]));return c.isReadable(e,a,{level:o,size:s})||!r?a:(n.includeFallbackColors=!1,c.mostReadable(e,["#fff","#000"],n))};var L=c.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},D=c.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(L);function N(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function I(e,n){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var i=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=s(n,a(0,parseFloat(e))),i&&(e=parseInt(e*n,10)/100),t.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function T(e){return s(1,a(0,e))}function M(e){return parseInt(e,16)}function A(e){return 1==e.length?"0"+e:""+e}function O(e){return e<=1&&(e=100*e+"%"),e}function R(e){return t.round(255*parseFloat(e)).toString(16)}function P(e){return M(e)/255}var F,B,W,z=(B="[\\s|\\(]+("+(F="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+F+")[,|\\s]+("+F+")\\s*\\)?",W="[\\s|\\(]+("+F+")[,|\\s]+("+F+")[,|\\s]+("+F+")[,|\\s]+("+F+")\\s*\\)?",{CSS_UNIT:new RegExp(F),rgb:new RegExp("rgb"+B),rgba:new RegExp("rgba"+W),hsl:new RegExp("hsl"+B),hsla:new RegExp("hsla"+W),hsv:new RegExp("hsv"+B),hsva:new RegExp("hsva"+W),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function V(e){return!!z.CSS_UNIT.exec(e)}e.exports?e.exports=c:window.tinycolor=c}(Math)}(G_);var K_=G_.exports,q_=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function $_(e,t,n){var i;return(i=Math.round(e.h)>=60&&Math.round(e.h)<=240?n?Math.round(e.h)-2*t:Math.round(e.h)+2*t:n?Math.round(e.h)+2*t:Math.round(e.h)-2*t)<0?i+=360:i>=360&&(i-=360),i}function Y_(e,t,n){return 0===e.h&&0===e.s?e.s:((i=n?e.s-.16*t:4===t?e.s+.16:e.s+.05*t)>1&&(i=1),n&&5===t&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2)));var i}function X_(e,t,n){var i;return(i=n?e.v+.05*t:e.v-.15*t)>1&&(i=1),Number(i.toFixed(2))}function Z_(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],i=K_(e),r=5;r>0;r-=1){var o=i.toHsv(),s=K_({h:$_(o,r,!0),s:Y_(o,r,!0),v:X_(o,r,!0)}).toHexString();n.push(s)}n.push(i.toHexString());for(var a=1;a<=4;a+=1){var l=i.toHsv(),c=K_({h:$_(l,a),s:Y_(l,a),v:X_(l,a)}).toHexString();n.push(c)}return"dark"===t.theme?q_.map((function(e){var i=e.index,r=e.opacity;return K_.mix(t.backgroundColor||"#141414",n[i],100*r).toHexString()})):n}var Q_={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},J_={},eb={};Object.keys(Q_).forEach((function(e){J_[e]=Z_(Q_[e]),J_[e].primary=J_[e][5],eb[e]=Z_(Q_[e],{theme:"dark",backgroundColor:"#141414"}),eb[e].primary=eb[e][5]})),J_.red,J_.volcano,J_.gold,J_.orange,J_.yellow,J_.lime,J_.green,J_.cyan,J_.blue,J_.geekblue,J_.purple,J_.magenta,J_.grey;var tb,nb,ib,rb,ob=function(e,t,n){var i=j_(e),r=j_(t);return j_([(1-n)*i.red()+n*r.red(),(1-n)*i.green()+n*r.green(),(1-n)*i.blue()+n*r.blue()]).rgb()},sb=function(e,t,n,i){return void 0===t&&(t="#fff"),void 0===n&&(n="default"),"default"===n?function(e,t,n){void 0===t&&(t="#fff"),void 0===n&&(n="rgb(150, 150, 150)");var i=ob(t,e,.05).rgb().toString(),r=ob(t,e,.1).rgb().toString(),o=ob(t,e,.2).rgb().toString(),s=ob(t,e,.4).rgb().toString(),a=ob(t,n,.02).rgb().toString(),l=ob(t,n,.05).rgb().toString(),c=ob(t,n,.1).rgb().toString(),u=ob(t,n,.2).rgb().toString(),h=ob(t,n,.3).rgb().toString(),d=Z_(e,{theme:"default",backgroundColor:t}),f=j_(e).hex().toLowerCase(),g=d.indexOf(f),p=e;return-1!==g&&(p=d[g+1]),{mainStroke:e,mainFill:r,activeStroke:e,activeFill:i,inactiveStroke:s,inactiveFill:i,selectedStroke:e,selectedFill:t,highlightStroke:p,highlightFill:o,disableStroke:h,disableFill:l,edgeMainStroke:h,edgeActiveStroke:e,edgeInactiveStroke:u,edgeSelectedStroke:e,edgeHighlightStroke:e,edgeDisableStroke:c,comboMainStroke:h,comboMainFill:a,comboActiveStroke:e,comboActiveFill:i,comboInactiveStroke:h,comboInactiveFill:a,comboSelectedStroke:e,comboSelectedFill:a,comboHighlightStroke:p,comboHighlightFill:a,comboDisableStroke:u,comboDisableFill:l}}(e,t,"rgb(150, 150, 150)"):function(e,t,n){void 0===t&&(t="#fff"),void 0===n&&(n="#777");var i=ob(t,e,.2).rgb().toString(),r=ob(t,e,.3).rgb().toString(),o=ob(t,e,.6).rgb().toString(),s=ob(t,e,.8).rgb().toString(),a=ob(t,n,.2).rgb().toString(),l=ob(t,n,.25).rgb().toString(),c=ob(t,n,.3).rgb().toString(),u=ob(t,n,.4).rgb().toString(),h=ob(t,n,.5).rgb().toString(),d=Z_(e,{theme:"dark",backgroundColor:t}),f=j_(e).hex().toLowerCase(),g=d.indexOf(f),p=e;return-1!==g&&(p=d[g+1]),{mainStroke:s,mainFill:i,activeStroke:e,activeFill:r,inactiveStroke:s,inactiveFill:i,selectedStroke:e,selectedFill:i,highlightStroke:e,highlightFill:o,disableStroke:h,disableFill:l,edgeMainStroke:n,edgeActiveStroke:e,edgeInactiveStroke:n,edgeSelectedStroke:e,edgeHighlightStroke:e,edgeDisableStroke:c,comboMainStroke:u,comboMainFill:l,comboActiveStroke:e,comboActiveFill:a,comboInactiveStroke:u,comboInactiveFill:l,comboSelectedStroke:e,comboSelectedFill:a,comboHighlightStroke:p,comboHighlightFill:l,comboDisableStroke:u,comboDisableFill:a}}(e,t,"#777")},ab=Object.freeze(Object.defineProperty({__proto__:null,mixColor:ob,getColorsWithSubjectColor:sb,getColorSetsBySubjectColors:function(e,t,n,i){void 0===t&&(t="#fff"),void 0===n&&(n="default");var r=[];return e.forEach((function(e){r.push(sb(e,t,n))})),r}},Symbol.toStringTag,{value:"Module"})),lb=sb("rgb(95, 149, 255)","rgb(255, 255, 255)"),cb={version:"0.5.5",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:lb.mainStroke,fill:lb.mainFill},size:20,color:lb.mainStroke,linkPoints:{size:8,lineWidth:1,fill:lb.activeFill,stroke:lb.activeStroke}},nodeStateStyles:{active:{fill:lb.activeFill,stroke:lb.activeStroke,lineWidth:2,shadowColor:lb.mainStroke,shadowBlur:10},selected:{fill:lb.selectedFill,stroke:lb.selectedStroke,lineWidth:4,shadowColor:lb.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:lb.highlightFill,stroke:lb.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:lb.inactiveFill,stroke:lb.inactiveStroke,lineWidth:1},disable:{fill:lb.disableFill,stroke:lb.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:"rgb(0, 0, 0)",textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:lb.edgeMainStroke,lineAppendWidth:2},color:lb.edgeMainStroke},edgeStateStyles:{active:{stroke:lb.edgeActiveStroke,lineWidth:1},selected:{stroke:lb.edgeSelectedStroke,lineWidth:2,shadowColor:lb.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:lb.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:lb.edgeInactiveStroke,lineWidth:1},disable:{stroke:lb.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:"rgb(0, 0, 0)",textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:lb.comboMainFill,lineWidth:1,stroke:lb.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:lb.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:lb.comboActiveStroke,lineWidth:1,fill:lb.comboActiveFill},selected:{stroke:lb.comboSelectedStroke,lineWidth:2,fill:lb.comboSelectedFill,shadowColor:lb.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:lb.comboHighlightStroke,lineWidth:2,fill:lb.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:lb.comboInactiveStroke,fill:lb.comboInactiveFill,lineWidth:1},disable:{stroke:lb.comboDisableStroke,fill:lb.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},textWaterMarkerConfig:{width:150,height:100,compatible:!1,text:{x:0,y:60,lineHeight:20,rotate:20,fontSize:14,fontFamily:"Microsoft YaHei",fill:"rgba(0, 0, 0, 0.1)",baseline:"Middle"}},imageWaterMarkerConfig:{width:150,height:130,compatible:!1,image:{x:0,y:0,width:30,height:20,rotate:0}},waterMarkerImage:"https://gw.alipayobjects.com/os/s/prod/antv/assets/image/logo-with-text-73b8a.svg"};function ub(e,t,n){if(e){if("function"==typeof e.addEventListener)return e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}};if("function"==typeof e.attachEvent)return e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}}}function hb(e){tb||(tb=document.createElement("table"),nb=document.createElement("tr"),ib=/^\s*<(\w+|!)[^>]*>/,rb={tr:document.createElement("tbody"),tbody:tb,thead:tb,tfoot:tb,td:nb,th:nb,"*":document.createElement("div")});var t=ib.test(e)&&RegExp.$1;t&&t in rb||(t="*");var n=rb[t];e="string"==typeof e?e.replace(/(^\s*)|(\s*$)/g,""):e,n.innerHTML=""+e;var i=n.childNodes[0];return i&&n.contains(i)&&n.removeChild(i),i}function db(e,t){if(e)for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n]);return e}var fb=pg.cloneEvent,gb=pg.isViewportChanged,pb=function(e){function t(t){var n=e.call(this,t)||this;return n.extendEvents=[],n.dragging=!1,n.preItem=null,n.graph=t,n.destroyed=!1,n.initEvents(),n}return qi(t,e),t.prototype.initEvents=function(){var e=this.graph,t=this.extendEvents,n=void 0===t?[]:t,i=e.get("canvas"),r=i.get("el"),o=Tr(this,"onCanvasEvents"),s=Tr(this,"onExtendEvents"),a=Tr(this,"onWheelEvent");i.off("*").on("*",o),this.canvasHandler=o,n.push(ub(r,"DOMMouseScroll",a)),n.push(ub(r,"mousewheel",a)),"undefined"!=typeof window&&(n.push(ub(window,"keydown",s)),n.push(ub(window,"keyup",s)),n.push(ub(window,"focus",s)))},t.getItemRoot=function(e){for(;e&&!e.get("item");)e=e.get("parent");return e},t.prototype.onCanvasEvents=function(e){var n=this.graph,i=n.get("canvas"),r=e.target,o=e.type;e.canvasX=e.x,e.canvasY=e.y;var s={x:e.canvasX,y:e.canvasY},a=n.get("group").getMatrix();if(a||(a=[1,0,0,0,1,0,0,0,1]),gb(a)&&(s=n.getPointByClient(e.clientX,e.clientY)),e.x=s.x,e.y=s.y,e.currentTarget=n,r===i)return"mousemove"!==o&&"mouseleave"!==o||this.handleMouseMove(e,"canvas"),e.target=i,e.item=null,n.emit(o,e),void n.emit("canvas:".concat(o),e);var l=t.getItemRoot(r);if(l){var c=l.get("item");if(!c.destroyed){var u=c.getType();if(e.target=r,e.item=c,e.canvasX===e.x&&e.canvasY===e.y){var h=n.getCanvasByPoint(e.x,e.y);e.canvasX=h.x,e.canvasY=h.y}n.emit(o,e),e.name&&!e.name.includes(":")?n.emit("".concat(u,":").concat(o),e):n.emit(e.name,e),"dragstart"===o&&(this.dragging=!0),"dragend"===o&&(this.dragging=!1),"mousemove"===o&&this.handleMouseMove(e,u)}}else n.emit(o,e)},t.prototype.onExtendEvents=function(e){this.graph.emit(e.type,e)},t.prototype.onWheelEvent=function(e){sr(e.wheelDelta)&&(e.wheelDelta=-e.detail),this.graph.emit("wheel",e)},t.prototype.handleMouseMove=function(e,t){var n=this.graph,i=this.preItem,r=n.get("canvas"),o=e.target===r?null:e.item;e=fb(e),i&&i!==o&&!i.destroyed&&(e.item=i,this.emitCustomEvent(i.getType(),"mouseleave",e),this.dragging&&this.emitCustomEvent(i.getType(),"dragleave",e)),o&&i!==o&&(e.item=o,this.emitCustomEvent(t,"mouseenter",e),this.dragging&&this.emitCustomEvent(t,"dragenter",e)),this.preItem=o},t.prototype.emitCustomEvent=function(e,t,n){n.type=t,this.graph.emit("".concat(e,":").concat(t),n)},t.prototype.destroy=function(){var e=this,t=e.graph,n=e.canvasHandler,i=e.extendEvents;t.get("canvas").off("*",n),cr(i,(function(e){e.remove()})),this.dragging=!1,this.preItem=null,this.extendEvents.length=0,this.canvasHandler=null,this.destroyed=!0},t}(vg);class mb{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(e){return this.init(e),this.execute(!0)}init(e){this.nodes=e.nodes||[],this.edges=e.edges||[],this.combos=e.combos||[]}execute(e){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(e){e&&Object.assign(this,e)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}const vb=e=>"string"==typeof e,yb=Array.isArray,_b=e=>"number"==typeof e,bb=e=>Number.isNaN(Number(e)),wb=e=>null!==e&&"object"==typeof e,Cb=e=>{if(null===e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const t=[];return e.forEach((e=>{t.push(e)})),t.map((e=>Cb(e)))}if("object"==typeof e&&e!=={}){const t=Object.assign({},e);return Object.keys(t).forEach((e=>{t[e]=Cb(t[e])})),t}return e},Sb=(e,t)=>{const n=e[t];return wb(n)?n.cell:n},xb=(e,t,n)=>{const i=[];for(let r=0;r<e;r++)i[r]=0;return n?(n.forEach((e=>{const n=Sb(e,"source"),r=Sb(e,"target");n&&(i[t[n]]+=1),r&&(i[t[r]]+=1)})),i):i},Eb=e=>{const t=[],n=e.length;for(let i=0;i<n;i+=1){t[i]=[];for(let r=0;r<n;r+=1)i===r?t[i][r]=0:0!==e[i][r]&&e[i][r]?t[i][r]=e[i][r]:t[i][r]=1/0}for(let i=0;i<n;i+=1)for(let e=0;e<n;e+=1)for(let r=0;r<n;r+=1)t[e][r]>t[e][i]+t[i][r]&&(t[e][r]=t[e][i]+t[i][r]);return t},kb=(e,t)=>{const{nodes:n,edges:i}=e,r=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach(((e,t)=>{o[e.id]=t;r.push([])})),i&&i.forEach((e=>{const n=Sb(e,"source"),i=Sb(e,"target"),s=o[n],a=o[i];r[s][a]=1,t||(r[a][s]=1)})),r},Lb=(e,t)=>{if(e&&e.children)for(let n=e.children.length-1;n>=0;n--)if(!Lb(e.children[n],t))return;return!!t(e)},Db=(e,t)=>{"function"==typeof t&&Lb(e,t)},Nb=e=>"function"==typeof e,Ib=new Map,Tb=(e,t)=>{if(Ib.get(e)&&console.warn(`The layout with the name ${e} exists already, it will be overridden`),wb(t)){class n extends mb{constructor(e){super();const n=this,i={},r=n.getDefaultCfg();Object.assign(i,r,t,e),Object.keys(i).forEach((e=>{const t=i[e];n[e]=t}))}}Ib.set(e,n)}else Ib.set(e,t);return Ib.get(e)};class Mb extends mb{constructor(e){super(),this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodeSize=30,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length,r=e.begin;if(0===i)return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};if(1===i)return t[0].x=r[0],t[0].y=r[1],e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};const o=[];t.forEach((e=>{o.push(e)}));const s={};if(o.forEach(((e,t)=>{s[e.id]=t})),("degree"===e.sortBy||!vb(e.sortBy)||void 0===o[0][e.sortBy])&&(e.sortBy="degree",bb(t[0].degree))){const e=xb(o.length,s,n);o.forEach(((t,n)=>{t.degree=e[n]}))}o.sort(((t,n)=>n[e.sortBy]-t[e.sortBy])),e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight);const a=e.rows,l=null!=e.cols?e.cols:e.columns;if(e.cells=i,null!=a&&null!=l?(e.rows=a,e.cols=l):null!=a&&null==l?(e.rows=a,e.cols=Math.ceil(e.cells/e.rows)):null==a&&null!=l?(e.cols=l,e.rows=Math.ceil(e.cells/e.cols)):(e.splits=Math.sqrt(e.cells*e.height/e.width),e.rows=Math.round(e.splits),e.cols=Math.round(e.width/e.height*e.splits)),e.cols*e.rows>e.cells){const t=e.small(),n=e.large();(t-1)*n>=e.cells?e.small(t-1):(n-1)*t>=e.cells&&e.large(n-1)}else for(;e.cols*e.rows<e.cells;){const t=e.small(),n=e.large();(n+1)*t>=e.cells?e.large(n+1):e.small(t+1)}e.cellWidth=e.width/e.cols,e.cellHeight=e.height/e.rows,e.condense&&(e.cellWidth=0,e.cellHeight=0),e.preventOverlap&&o.forEach((t=>{let n,i;t.x&&t.y||(t.x=0,t.y=0),yb(t.size)?(n=t.size[0],i=t.size[1]):_b(t.size)?(n=t.size,i=t.size):wb(t.size)&&(n=t.size.width,i=t.size.height),void 0!==n&&void 0!==i||(yb(e.nodeSize)?(n=e.nodeSize[0],i=e.nodeSize[1]):_b(e.nodeSize)?(n=e.nodeSize,i=e.nodeSize):(n=30,i=30));const r=e.preventOverlapPadding,o=n+r,s=i+r;e.cellWidth=Math.max(e.cellWidth,o),e.cellHeight=Math.max(e.cellHeight,s)})),e.cellUsed={},e.row=0,e.col=0,e.id2manPos={};for(let c=0;c<o.length;c++){const t=o[c];let n;if(e.position&&(n=e.position(t)),n&&(void 0!==n.row||void 0!==n.col)){const i={row:n.row,col:n.col};if(void 0===i.col)for(i.col=0;e.used(i.row,i.col);)i.col++;else if(void 0===i.row)for(i.row=0;e.used(i.row,i.col);)i.row++;e.id2manPos[t.id]=i,e.use(i.row,i.col)}e.getPos(t)}return e.onLayoutEnd&&e.onLayoutEnd(),{edges:n,nodes:o}}small(e){const t=this;let n;const i=t.rows||5,r=t.cols||5;if(null==e)n=Math.min(i,r);else{Math.min(i,r)===t.rows?t.rows=e:t.cols=e}return n}large(e){const t=this;let n;const i=t.rows||5,r=t.cols||5;if(null==e)n=Math.max(i,r);else{Math.max(i,r)===t.rows?t.rows=e:t.cols=e}return n}used(e,t){return this.cellUsed[`c-${e}-${t}`]||!1}use(e,t){this.cellUsed[`c-${e}-${t}`]=!0}moveToNextCell(){const e=this,t=e.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)}getPos(e){const t=this,n=t.begin,i=t.cellWidth,r=t.cellHeight;let o,s;const a=t.id2manPos[e.id];if(a)o=a.col*i+i/2+n[0],s=a.row*r+r/2+n[1];else{for(;t.used(t.row,t.col);)t.moveToNextCell();o=t.col*i+i/2+n[0],s=t.row*r+r/2+n[1],t.use(t.row,t.col),t.moveToNextCell()}e.x=o,e.y=s}getType(){return"grid"}}class Ab extends mb{constructor(e){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const e=this,t=e.nodes,n=e.center;return e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),t&&t.forEach((t=>{t.x=.9*(Math.random()-.5)*e.width+n[0],t.y=.9*(Math.random()-.5)*e.height+n[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:this.edges}}getType(){return"random"}}const Ob=(e,t)=>{let n;return n=e?_b(e)?t=>e:e:e=>t||1,n};class Rb extends mb{constructor(e){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0}}execute(){var e,t;const n=this,i=n.nodes;if(void 0!==n.timeInterval&&"undefined"!=typeof window&&window.clearInterval(n.timeInterval),!i||0===i.length)return void(null===(e=n.onLayoutEnd)||void 0===e||e.call(n));n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const r=n.center;if(1===i.length)return i[0].x=r[0],i[0].y=r[1],void(null===(t=n.onLayoutEnd)||void 0===t||t.call(n));const o={},s={};i.forEach(((e,t)=>{_b(e.x)||(e.x=Math.random()*n.width),_b(e.y)||(e.y=Math.random()*n.height),o[e.id]=e,s[e.id]=t})),n.nodeMap=o,n.nodeIdxMap=s,n.linkDistance=Ob(n.linkDistance,1),n.nodeStrength=Ob(n.nodeStrength,1),n.edgeStrength=Ob(n.edgeStrength,1);const a=n.nodeSize;let l;if(n.preventOverlap){const e=n.nodeSpacing;let t;t=_b(e)?()=>e:Nb(e)?e:()=>0,l=a?yb(a)?e=>(a[0]>a[1]?a[0]:a[1])+t(e):e=>a+t(e):e=>{if(e.size){if(yb(e.size)){return(e.size[0]>e.size[1]?e.size[0]:e.size[1])+t(e)}if(wb(e.size)){return(e.size.width>e.size.height?e.size.width:e.size.height)+t(e)}return e.size+t(e)}return 10+t(e)}}n.nodeSize=l;const c=n.edges;n.degrees=xb(i.length,n.nodeIdxMap,c),n.getMass||(n.getMass=e=>n.degrees[n.nodeIdxMap[e.id]]||1),n.run()}run(){var e;const t=this,{maxIteration:n,nodes:i,workerEnabled:r,minMovement:o}=t;if(i)if(r){for(let e=0;e<n;e++){const n=t.runOneStep(e);if(t.reachMoveThreshold(i,n,o))break}null===(e=t.onLayoutEnd)||void 0===e||e.call(t)}else{if("undefined"==typeof window)return;let e=0;this.timeInterval=window.setInterval((()=>{var r,s;if(!i)return;const a=t.runOneStep(e)||[];t.reachMoveThreshold(i,a,o)&&(null===(r=t.onLayoutEnd)||void 0===r||r.call(t),window.clearInterval(t.timeInterval)),e++,e>=n&&(null===(s=t.onLayoutEnd)||void 0===s||s.call(t),window.clearInterval(t.timeInterval))}),0)}}reachMoveThreshold(e,t,n){let i=0;return e.forEach(((e,n)=>{const r=e.x-t[n].x,o=e.y-t[n].y;i+=Math.sqrt(r*r+o*o)})),i/=e.length,i<n}runOneStep(e){var t;const n=this,{nodes:i,edges:r}=n,o=[],s=[];if(!i)return;i.forEach(((e,t)=>{o[2*t]=0,o[2*t+1]=0,s[2*t]=0,s[2*t+1]=0})),n.calRepulsive(o,i),r&&n.calAttractive(o,r),n.calGravity(o,i);const a=Math.max(.02,n.interval-.002*e);n.updateVelocity(o,s,a,i);const l=[];return i.forEach((e=>{l.push({x:e.x,y:e.y})})),n.updatePosition(s,a,i),null===(t=n.tick)||void 0===t||t.call(n),l}calRepulsive(e,t){const n=this,i=n.getMass,r=n.nodeStrength,o=n.factor,s=n.coulombDisScale,a=n.preventOverlap,l=n.nodeSize;t.forEach(((n,c)=>{const u=i?i(n):1;t.forEach(((t,h)=>{if(c>=h)return;const d=n.x-t.x,f=n.y-t.y,g=Math.sqrt(d*d+f*f)+.01,p=(g+.1)*s,m=d/g,v=f/g,y=(r(n)+r(t))/2*o/(p*p),_=i?i(t):1;if(e[2*c]+=m*y,e[2*c+1]+=v*y,e[2*h]-=m*y,e[2*h+1]-=v*y,a&&g<(l(n)+l(t))/2){const i=(r(n)+r(t))/2/(g*g);e[2*c]+=m*i/u,e[2*c+1]+=v*i/u,e[2*h]-=m*i/_,e[2*h+1]-=v*i/_}}))}))}calAttractive(e,t){const n=this,i=n.nodeMap,r=n.nodeIdxMap,o=n.linkDistance,s=n.edgeStrength,a=n.getMass;t.forEach(((t,n)=>{const l=Sb(t,"source"),c=Sb(t,"target"),u=i[l],h=i[c],d=h.x-u.x,f=h.y-u.y,g=Math.sqrt(d*d+f*f)+.01,p=d/g,m=f/g,v=((o(t)||1)-g)*s(t),y=r[l],_=r[c],b=a?a(u):1,w=a?a(h):1;e[2*y]-=p*v/b,e[2*y+1]-=m*v/b,e[2*_]+=p*v/w,e[2*_+1]+=m*v/w}))}calGravity(e,t){const n=this,i=n.center,r=n.gravity,o=n.degrees,s=t.length;for(let a=0;a<s;a++){const s=t[a];let l=s.x-i[0],c=s.y-i[1],u=r;if(n.getCenter){const e=n.getCenter(s,o[a]);e&&_b(e[0])&&_b(e[1])&&_b(e[2])&&(l=s.x-e[0],c=s.y-e[1],u=e[2])}u&&(e[2*a]-=u*l,e[2*a+1]-=u*c)}}updateVelocity(e,t,n,i){const r=this,o=n*r.damping;i.forEach(((n,i)=>{let s=e[2*i]*o||.01,a=e[2*i+1]*o||.01;const l=Math.sqrt(s*s+a*a);if(l>r.maxSpeed){const e=r.maxSpeed/l;s*=e,a*=e}t[2*i]=s,t[2*i+1]=a}))}updatePosition(e,t,n){n.forEach(((n,i)=>{if(_b(n.fx)&&_b(n.fy))return n.x=n.fx,void(n.y=n.fy);const r=e[2*i]*t,o=e[2*i+1]*t;n.x+=r,n.y+=o}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"gForce"}}function Pb(e,t){var n,i=1;function r(){var r,o,s=n.length,a=0,l=0;for(r=0;r<s;++r)a+=(o=n[r]).x,l+=o.y;for(a=(a/s-e)*i,l=(l/s-t)*i,r=0;r<s;++r)(o=n[r]).x-=a,o.y-=l}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(e){n=e},r.x=function(t){return arguments.length?(e=+t,r):e},r.y=function(e){return arguments.length?(t=+e,r):t},r.strength=function(e){return arguments.length?(i=+e,r):i},r}function Fb(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o,s,a,l,c,u,h,d,f=e._root,g={data:i},p=e._x0,m=e._y0,v=e._x1,y=e._y1;if(!f)return e._root=g,e;for(;f.length;)if((c=t>=(o=(p+v)/2))?p=o:v=o,(u=n>=(s=(m+y)/2))?m=s:y=s,r=f,!(f=f[h=u<<1|c]))return r[h]=g,e;if(a=+e._x.call(null,f.data),l=+e._y.call(null,f.data),t===a&&n===l)return g.next=f,r?r[h]=g:e._root=g,e;do{r=r?r[h]=new Array(4):e._root=new Array(4),(c=t>=(o=(p+v)/2))?p=o:v=o,(u=n>=(s=(m+y)/2))?m=s:y=s}while((h=u<<1|c)==(d=(l>=s)<<1|a>=o));return r[d]=f,r[h]=g,e}function Bb(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function Wb(e){return e[0]}function zb(e){return e[1]}function Vb(e,t,n){var i=new Ub(null==t?Wb:t,null==n?zb:n,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function Ub(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function Hb(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var jb=Vb.prototype=Ub.prototype;function Gb(e){return function(){return e}}function Kb(e){return 1e-6*(e()-.5)}function qb(e){return e.x+e.vx}function $b(e){return e.y+e.vy}function Yb(e){var t,n,i,r=1,o=1;function s(){for(var e,s,l,c,u,h,d,f=t.length,g=0;g<o;++g)for(s=Vb(t,qb,$b).visitAfter(a),e=0;e<f;++e)l=t[e],h=n[l.index],d=h*h,c=l.x+l.vx,u=l.y+l.vy,s.visit(p);function p(e,t,n,o,s){var a=e.data,f=e.r,g=h+f;if(!a)return t>c+g||o<c-g||n>u+g||s<u-g;if(a.index>l.index){var p=c-a.x-a.vx,m=u-a.y-a.vy,v=p*p+m*m;v<g*g&&(0===p&&(v+=(p=Kb(i))*p),0===m&&(v+=(m=Kb(i))*m),v=(g-(v=Math.sqrt(v)))/v*r,l.vx+=(p*=v)*(g=(f*=f)/(d+f)),l.vy+=(m*=v)*g,a.vx-=p*(g=1-g),a.vy-=m*g)}}}function a(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function l(){if(t){var i,r,o=t.length;for(n=new Array(o),i=0;i<o;++i)r=t[i],n[r.index]=+e(r,i,t)}}return"function"!=typeof e&&(e=Gb(null==e?1:+e)),s.initialize=function(e,n){t=e,i=n,l()},s.iterations=function(e){return arguments.length?(o=+e,s):o},s.strength=function(e){return arguments.length?(r=+e,s):r},s.radius=function(t){return arguments.length?(e="function"==typeof t?t:Gb(+t),l(),s):e},s}function Xb(e){return e.index}function Zb(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Qb(e){var t,n,i,r,o,s,a=Xb,l=function(e){return 1/Math.min(r[e.source.index],r[e.target.index])},c=Gb(30),u=1;function h(i){for(var r=0,a=e.length;r<u;++r)for(var l,c,h,d,f,g,p,m=0;m<a;++m)c=(l=e[m]).source,d=(h=l.target).x+h.vx-c.x-c.vx||Kb(s),f=h.y+h.vy-c.y-c.vy||Kb(s),d*=g=((g=Math.sqrt(d*d+f*f))-n[m])/g*i*t[m],f*=g,h.vx-=d*(p=o[m]),h.vy-=f*p,c.vx+=d*(p=1-p),c.vy+=f*p}function d(){if(i){var s,l,c=i.length,u=e.length,h=new Map(i.map(((e,t)=>[a(e,t,i),e])));for(s=0,r=new Array(c);s<u;++s)(l=e[s]).index=s,"object"!=typeof l.source&&(l.source=Zb(h,l.source)),"object"!=typeof l.target&&(l.target=Zb(h,l.target)),r[l.source.index]=(r[l.source.index]||0)+1,r[l.target.index]=(r[l.target.index]||0)+1;for(s=0,o=new Array(u);s<u;++s)l=e[s],o[s]=r[l.source.index]/(r[l.source.index]+r[l.target.index]);t=new Array(u),f(),n=new Array(u),g()}}function f(){if(i)for(var n=0,r=e.length;n<r;++n)t[n]=+l(e[n],n,e)}function g(){if(i)for(var t=0,r=e.length;t<r;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),h.initialize=function(e,t){i=e,s=t,d()},h.links=function(t){return arguments.length?(e=t,d(),h):e},h.id=function(e){return arguments.length?(a=e,h):a},h.iterations=function(e){return arguments.length?(u=+e,h):u},h.strength=function(e){return arguments.length?(l="function"==typeof e?e:Gb(+e),f(),h):l},h.distance=function(e){return arguments.length?(c="function"==typeof e?e:Gb(+e),g(),h):c},h}jb.copy=function(){var e,t,n=new Ub(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=Hb(i),n;for(e=[{source:i,target:n._root=new Array(4)}];i=e.pop();)for(var r=0;r<4;++r)(t=i.source[r])&&(t.length?e.push({source:t,target:i.target[r]=new Array(4)}):i.target[r]=Hb(t));return n},jb.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Fb(this.cover(t,n),t,n,e)},jb.addAll=function(e){var t,n,i,r,o=e.length,s=new Array(o),a=new Array(o),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(r=+this._y.call(null,t))||(s[n]=i,a[n]=r,i<l&&(l=i),i>u&&(u=i),r<c&&(c=r),r>h&&(h=r));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<o;++n)Fb(this,s[n],a[n],e[n]);return this},jb.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var s,a,l=r-n||1,c=this._root;n>e||e>=r||i>t||t>=o;)switch(a=(t<i)<<1|e<n,(s=new Array(4))[a]=c,c=s,l*=2,a){case 0:r=n+l,o=i+l;break;case 1:n=r-l,o=i+l;break;case 2:r=n+l,i=o-l;break;case 3:n=r-l,i=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this},jb.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},jb.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},jb.find=function(e,t,n){var i,r,o,s,a,l,c,u=this._x0,h=this._y0,d=this._x1,f=this._y1,g=[],p=this._root;for(p&&g.push(new Bb(p,u,h,d,f)),null==n?n=1/0:(u=e-n,h=t-n,d=e+n,f=t+n,n*=n);l=g.pop();)if(!(!(p=l.node)||(r=l.x0)>d||(o=l.y0)>f||(s=l.x1)<u||(a=l.y1)<h))if(p.length){var m=(r+s)/2,v=(o+a)/2;g.push(new Bb(p[3],m,v,s,a),new Bb(p[2],r,v,m,a),new Bb(p[1],m,o,s,v),new Bb(p[0],r,o,m,v)),(c=(t>=v)<<1|e>=m)&&(l=g[g.length-1],g[g.length-1]=g[g.length-1-c],g[g.length-1-c]=l)}else{var y=e-+this._x.call(null,p.data),_=t-+this._y.call(null,p.data),b=y*y+_*_;if(b<n){var w=Math.sqrt(n=b);u=e-w,h=t-w,d=e+w,f=t+w,i=p.data}}return i},jb.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(s=+this._y.call(null,e)))return this;var t,n,i,r,o,s,a,l,c,u,h,d,f=this._root,g=this._x0,p=this._y0,m=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(a=(g+m)/2))?g=a:m=a,(u=s>=(l=(p+v)/2))?p=l:v=l,t=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(t[h+1&3]||t[h+2&3]||t[h+3&3])&&(n=t,d=h)}for(;f.data!==e;)if(i=f,!(f=f.next))return this;return(r=f.next)&&delete f.next,i?(r?i.next=r:delete i.next,this):t?(r?t[h]=r:delete t[h],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=r,this)},jb.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},jb.root=function(){return this._root},jb.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},jb.visit=function(e){var t,n,i,r,o,s,a=[],l=this._root;for(l&&a.push(new Bb(l,this._x0,this._y0,this._x1,this._y1));t=a.pop();)if(!e(l=t.node,i=t.x0,r=t.y0,o=t.x1,s=t.y1)&&l.length){var c=(i+o)/2,u=(r+s)/2;(n=l[3])&&a.push(new Bb(n,c,u,o,s)),(n=l[2])&&a.push(new Bb(n,i,u,c,s)),(n=l[1])&&a.push(new Bb(n,c,r,o,u)),(n=l[0])&&a.push(new Bb(n,i,r,c,u))}return this},jb.visitAfter=function(e){var t,n=[],i=[];for(this._root&&n.push(new Bb(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var r=t.node;if(r.length){var o,s=t.x0,a=t.y0,l=t.x1,c=t.y1,u=(s+l)/2,h=(a+c)/2;(o=r[0])&&n.push(new Bb(o,s,a,u,h)),(o=r[1])&&n.push(new Bb(o,u,a,l,h)),(o=r[2])&&n.push(new Bb(o,s,h,u,c)),(o=r[3])&&n.push(new Bb(o,u,h,l,c))}i.push(t)}for(;t=i.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},jb.x=function(e){return arguments.length?(this._x=e,this):this._x},jb.y=function(e){return arguments.length?(this._y=e,this):this._y};var Jb={value:()=>{}};function ew(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i||/[\s.]/.test(e))throw new Error("illegal type: "+e);i[e]=[]}return new tw(i)}function tw(e){this._=e}function nw(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",i=e.indexOf(".");if(i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function iw(e,t){for(var n,i=0,r=e.length;i<r;++i)if((n=e[i]).name===t)return n.value}function rw(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=Jb,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}tw.prototype=ew.prototype={constructor:tw,on:function(e,t){var n,i=this._,r=nw(e+"",i),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=r[o]).type)i[n]=rw(i[n],e.name,t);else if(null==t)for(n in i)i[n]=rw(i[n],e.name,null);return this}for(;++o<s;)if((n=(e=r[o]).type)&&(n=iw(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new tw(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(i=this._[e]).length;o<n;++o)i[o].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};var ow,sw,aw=0,lw=0,cw=0,uw=0,hw=0,dw=0,fw="object"==typeof performance&&performance.now?performance:Date,gw="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function pw(){return hw||(gw(mw),hw=fw.now()+dw)}function mw(){hw=0}function vw(){this._call=this._time=this._next=null}function yw(e,t,n){var i=new vw;return i.restart(e,t,n),i}function _w(){hw=(uw=fw.now())+dw,aw=lw=0;try{!function(){pw(),++aw;for(var e,t=ow;t;)(e=hw-t._time)>=0&&t._call.call(null,e),t=t._next;--aw}()}finally{aw=0,function(){var e,t,n=ow,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:ow=t);sw=e,ww(i)}(),hw=0}}function bw(){var e=fw.now(),t=e-uw;t>1e3&&(dw-=t,uw=e)}function ww(e){aw||(lw&&(lw=clearTimeout(lw)),e-hw>24?(e<1/0&&(lw=setTimeout(_w,e-fw.now()-dw)),cw&&(cw=clearInterval(cw))):(cw||(uw=fw.now(),cw=setInterval(bw,1e3)),aw=1,gw(_w)))}vw.prototype=yw.prototype={constructor:vw,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?pw():+n)+(null==t?0:+t),this._next||sw===this||(sw?sw._next=this:ow=this,sw=this),this._call=e,this._time=n,ww()},stop:function(){this._call&&(this._call=null,this._time=1/0,ww())}};function Cw(e){return e.x}function Sw(e){return e.y}var xw=Math.PI*(3-Math.sqrt(5));function Ew(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,l=yw(h),c=ew("tick","end"),u=function(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}();function h(){d(),c.call("tick",t),n<i&&(l.stop(),c.call("end",t))}function d(i){var l,c,u=e.length;void 0===i&&(i=1);for(var h=0;h<i;++h)for(n+=(o-n)*r,a.forEach((function(e){e(n)})),l=0;l<u;++l)null==(c=e[l]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return t}function f(){for(var t,n=0,i=e.length;n<i;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var r=10*Math.sqrt(.5+n),o=n*xw;t.x=r*Math.cos(o),t.y=r*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function g(t){return t.initialize&&t.initialize(e,u),t}return null==e&&(e=[]),f(),t={tick:d,restart:function(){return l.restart(h),t},stop:function(){return l.stop(),t},nodes:function(n){return arguments.length?(e=n,f(),a.forEach(g),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(i=+e,t):i},alphaDecay:function(e){return arguments.length?(r=+e,t):+r},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(s=1-e,t):1-s},randomSource:function(e){return arguments.length?(u=e,a.forEach(g),t):u},force:function(e,n){return arguments.length>1?(null==n?a.delete(e):a.set(e,g(n)),t):a.get(e)},find:function(t,n,i){var r,o,s,a,l,c=0,u=e.length;for(null==i?i=1/0:i*=i,c=0;c<u;++c)(s=(r=t-(a=e[c]).x)*r+(o=n-a.y)*o)<i&&(l=a,i=s);return l},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}function kw(){var e,t,n,i,r,o=Gb(-30),s=1,a=1/0,l=.81;function c(n){var r,o=e.length,s=Vb(e,Cw,Sw).visitAfter(h);for(i=n,r=0;r<o;++r)t=e[r],s.visit(d)}function u(){if(e){var t,n,i=e.length;for(r=new Array(i),t=0;t<i;++t)n=e[t],r[n.index]=+o(n,t,e)}}function h(e){var t,n,i,o,s,a=0,l=0;if(e.length){for(i=o=s=0;s<4;++s)(t=e[s])&&(n=Math.abs(t.value))&&(a+=t.value,l+=n,i+=n*t.x,o+=n*t.y);e.x=i/l,e.y=o/l}else{(t=e).x=t.data.x,t.y=t.data.y;do{a+=r[t.data.index]}while(t=t.next)}e.value=a}function d(e,o,c,u){if(!e.value)return!0;var h=e.x-t.x,d=e.y-t.y,f=u-o,g=h*h+d*d;if(f*f/l<g)return g<a&&(0===h&&(g+=(h=Kb(n))*h),0===d&&(g+=(d=Kb(n))*d),g<s&&(g=Math.sqrt(s*g)),t.vx+=h*e.value*i/g,t.vy+=d*e.value*i/g),!0;if(!(e.length||g>=a)){(e.data!==t||e.next)&&(0===h&&(g+=(h=Kb(n))*h),0===d&&(g+=(d=Kb(n))*d),g<s&&(g=Math.sqrt(s*g)));do{e.data!==t&&(f=r[e.data.index]*i/g,t.vx+=h*f,t.vy+=d*f)}while(e=e.next)}}return c.initialize=function(t,i){e=t,n=i,u()},c.strength=function(e){return arguments.length?(o="function"==typeof e?e:Gb(+e),u(),c):o},c.distanceMin=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c.distanceMax=function(e){return arguments.length?(a=e*e,c):Math.sqrt(a)},c.theta=function(e){return arguments.length?(l=e*e,c):Math.sqrt(l)},c}function Lw(e){var t,n,i,r=Gb(.1);function o(e){for(var r,o=0,s=t.length;o<s;++o)(r=t[o]).vx+=(i[o]-r.x)*n[o]*e}function s(){if(t){var o,s=t.length;for(n=new Array(s),i=new Array(s),o=0;o<s;++o)n[o]=isNaN(i[o]=+e(t[o],o,t))?0:+r(t[o],o,t)}}return"function"!=typeof e&&(e=Gb(null==e?0:+e)),o.initialize=function(e){t=e,s()},o.strength=function(e){return arguments.length?(r="function"==typeof e?e:Gb(+e),s(),o):r},o.x=function(t){return arguments.length?(e="function"==typeof t?t:Gb(+t),s(),o):e},o}function Dw(e){var t,n,i,r=Gb(.1);function o(e){for(var r,o=0,s=t.length;o<s;++o)(r=t[o]).vy+=(i[o]-r.y)*n[o]*e}function s(){if(t){var o,s=t.length;for(n=new Array(s),i=new Array(s),o=0;o<s;++o)n[o]=isNaN(i[o]=+e(t[o],o,t))?0:+r(t[o],o,t)}}return"function"!=typeof e&&(e=Gb(null==e?0:+e)),o.initialize=function(e){t=e,s()},o.strength=function(e){return arguments.length?(r="function"==typeof e?e:Gb(+e),s(),o):r},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Gb(+t),s(),o):e},o}function Nw(){function e(e){return()=>e}let t,n=e=>e.cluster,i=e(1),r=e(-1),o=e(100),s=e(.1),a=[0,0],l=[],c={},u=[],h=100,d=100,f={none:{x:0,y:0}},g=[],p="force",m=!0,v=.1;function y(e){if(!m)return y;t.tick(),b();for(let t,i=0,r=l.length,o=e*v;i<r;++i)t=l[i],t.vx+=(f[n(t)].x-t.x)*o,t.vy+=(f[n(t)].y-t.y)*o}function _(){l&&function(){if(!l||!l.length)return;if(void 0===n(l[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const e=function(){const e=[],t=[],r={};let o=[],s={},a=[];return s=function(e){const t={};return e.forEach((e=>{const i=n(e);t[i]||(t[i]={count:0,sumforceNodeSize:0})})),e.forEach((e=>{const r=n(e),o=i(e),s=t[r];s.count=s.count+1,s.sumforceNodeSize=s.sumforceNodeSize+Math.PI*(o*o)*1.3,t[r]=s})),t}(l),a=function(e){const t={},i=[];e.forEach((e=>{const i=function(e){const t=Sb(e,"source"),i=Sb(e,"target"),r=n(c[t]),o=n(c[i]);return r<=o?`${r}~${o}`:`${o}~${r}`}(e);let r=0;void 0!==t[i]&&(r=t[i]),r+=1,t[i]=r}));return Object.entries(t).forEach((([e,t])=>{const n=e.split("~")[0],r=e.split("~")[1];void 0!==n&&void 0!==r&&i.push({source:n,target:r,count:t})})),i}(u),o=Object.keys(s),o.forEach(((t,n)=>{const i=s[t];e.push({id:t,size:i.count,r:Math.sqrt(i.sumforceNodeSize/Math.PI)}),r[t]=n})),a.forEach((e=>{const n=Sb(e,"source"),i=Sb(e,"target"),o=r[n],s=r[i];void 0!==o&&void 0!==s&&t.push({source:o,target:s,count:e.count})})),{nodes:e,links:t}}();t=Ew(e.nodes).force("x",Lw(h).strength(.1)).force("y",Dw(d).strength(.1)).force("collide",Yb((e=>e.r)).iterations(4)).force("charge",kw().strength(r)).force("links",Qb(e.nodes.length?e.links:[]).distance(o).strength(s)),g=t.nodes(),b()}()}function b(){return f={none:{x:0,y:0}},g.forEach((e=>{f[e.id]={x:e.x-a[0],y:e.y-a[1]}})),f}function w(e){c={},e.forEach((e=>{c[e.id]=e}))}return y.initialize=e=>{l=e,_()},y.template=function(e){return arguments.length?(p=e,_(),y):p},y.groupBy=function(e){return arguments.length?"string"==typeof e?(n=t=>t[e],y):(n=e,y):n},y.enableGrouping=function(e){return arguments.length?(m=e,y):m},y.strength=function(e){return arguments.length?(v=e,y):v},y.centerX=function(e){return arguments.length?(h=e,y):h},y.centerY=function(e){return arguments.length?(d=e,y):d},y.nodes=function(e){return arguments.length?(w(e||[]),l=e||[],y):l},y.links=function(e){return arguments.length?(u=e||[],_(),y):u},y.forceNodeSize=function(t){return arguments.length?(i="function"==typeof t?t:e(+t),_(),y):i},y.nodeSize=y.forceNodeSize,y.forceCharge=function(t){return arguments.length?(r="function"==typeof t?t:e(+t),_(),y):r},y.forceLinkDistance=function(t){return arguments.length?(o="function"==typeof t?t:e(+t),_(),y):o},y.forceLinkStrength=function(t){return arguments.length?(s="function"==typeof t?t:e(+t),_(),y):s},y.offset=function(e){return arguments.length?(a=e,y):a},y.getFocis=b,y}const Iw="LAYOUT_TICK",Tw="GPU_LAYOUT_END";class Mw extends mb{constructor(e){super(),this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,e&&this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(e){const t=this;t.nodes=e.nodes||[];const n=e.edges||[];t.edges=n.map((e=>{const t={},n=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(e).forEach((i=>{n.indexOf(i)>-1||(t[i]=e[i])})),t})),t.ticking=!1}execute(e){const t=this,n=t.nodes,i=t.edges;if(t.ticking)return;let r=t.forceSimulation;const o=t.alphaMin,s=t.alphaDecay,a=t.alpha;if(r){if(e)if(t.clustering&&t.clusterForce&&(t.clusterForce.nodes(n),t.clusterForce.links(i)),r.nodes(n),i&&t.edgeForce)t.edgeForce.links(i);else if(i&&!t.edgeForce){const e=Qb().id((e=>e.id)).links(i);t.edgeStrength&&e.strength(t.edgeStrength),t.linkDistance&&e.distance(t.linkDistance),t.edgeForce=e,r.force("link",e)}t.preventOverlap&&t.overlapProcess(r),r.alpha(a).restart(),this.ticking=!0}else try{const e=kw();if(t.nodeStrength&&e.strength(t.nodeStrength),r=Ew().nodes(n),t.clustering){const e=Nw();e.centerX(t.center[0]).centerY(t.center[1]).template("force").strength(t.clusterFociStrength),i&&e.links(i),n&&e.nodes(n),e.forceLinkDistance(t.clusterEdgeDistance).forceLinkStrength(t.clusterEdgeStrength).forceCharge(t.clusterNodeStrength).forceNodeSize(t.clusterNodeSize),t.clusterForce=e,r.force("group",e)}if(r.force("center",Pb(t.center[0],t.center[1])).force("charge",e).alpha(a).alphaDecay(s).alphaMin(o),t.preventOverlap&&t.overlapProcess(r),i){const e=Qb().id((e=>e.id)).links(i);t.edgeStrength&&e.strength(t.edgeStrength),t.linkDistance&&e.distance(t.linkDistance),t.edgeForce=e,r.force("link",e)}if(!t.workerEnabled||"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope||(t.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),t.workerEnabled){r.stop();const e=function(e){const t=e.alphaMin(),n=e.alphaTarget(),i=e.alpha(),r=Math.log((t-n)/(i-n))/Math.log(1-e.alphaDecay());return Math.ceil(r)}(r);for(let t=1;t<=e;t++)r.tick(),postMessage({nodes:n,currentTick:t,totalTicks:e,type:Iw},void 0);t.ticking=!1}else r.on("tick",(()=>{t.tick()})).on("end",(()=>{t.ticking=!1,t.onLayoutEnd&&t.onLayoutEnd()})),t.ticking=!0;t.forceSimulation=r,t.ticking=!0}catch(l){t.ticking=!1,console.warn(l)}}overlapProcess(e){const t=this,n=t.nodeSize,i=t.nodeSpacing;let r,o;const s=t.collideStrength;if(o=_b(i)?()=>i:Nb(i)?i:()=>0,n)if(Nb(n))r=e=>n(e)+o(e);else if(yb(n)){const e=(n[0]>n[1]?n[0]:n[1])/2;r=t=>e+o(t)}else if(_b(n)){const e=n/2;r=t=>e+o(t)}else r=()=>10;else r=e=>{if(e.size){if(yb(e.size)){return(e.size[0]>e.size[1]?e.size[0]:e.size[1])/2+o(e)}if(wb(e.size)){return(e.size.width>e.size.height?e.size.width:e.size.height)/2+o(e)}return e.size/2+o(e)}return 10+o(e)};e.force("collisionForce",Yb(r).strength(s))}updateCfg(e){const t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.forceSimulation=null,Object.assign(t,e)}destroy(){const e=this;e.ticking&&(e.forceSimulation.stop(),e.ticking=!1),e.nodes=null,e.edges=null,e.destroyed=!0}}function Aw(e,t){const n=e.degree,i=t.degree;return n<i?-1:n>i?1:0}class Ow extends mb{constructor(e){super(),this.radius=null,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(e)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length;if(0===i)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const r=e.center;if(1===i)return t[0].x=r[0],t[0].y=r[1],void(e.onLayoutEnd&&e.onLayoutEnd());let o=e.radius,s=e.startRadius,a=e.endRadius;const l=e.divisions,c=e.startAngle,u=e.endAngle,h=(u-c)/i,d={};t.forEach(((e,t)=>{d[e.id]=t})),e.nodeMap=d;const f=xb(t.length,d,n);e.degrees=f,o||s||a?!s&&a?s=a:s&&!a&&(a=s):o=e.height>e.width?e.width/2:e.height/2;const g=h*e.angleRatio,p=e.ordering;let m=[];m="topology"===p?e.topologyOrdering():"topology-directed"===p?e.topologyOrdering(!0):"degree"===p?e.degreeOrdering():t;const v=e.clockwise,y=Math.ceil(i/l);for(let _=0;_<i;++_){let e=o;e||null===s||null===a||(e=s+_*(a-s)/(i-1)),e||(e=10+100*_/(i-1));let t=c+_%y*g+2*Math.PI/l*Math.floor(_/y);v||(t=u-_%y*g-2*Math.PI/l*Math.floor(_/y)),m[_].x=r[0]+Math.cos(t)*e,m[_].y=r[1]+Math.sin(t)*e,m[_].weight=f[_]}return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:m,edges:this.edges}}topologyOrdering(e=!1){const t=this,n=t.degrees,i=t.edges,r=t.nodes,o=Cb(r),s=t.nodeMap,a=[o[0]],l=[r[0]],c=[],u=r.length;c[0]=!0,function(e,t,n,i){e.forEach(((t,n)=>{e[n].children=[],e[n].parent=[]})),i?t.forEach((t=>{const i=Sb(t,"source"),r=Sb(t,"target");let o=0;i&&(o=n[i]);let s=0;r&&(s=n[r]);const a=e[o].children,l=e[s].parent;a.push(e[s].id),l.push(e[o].id)})):t.forEach((t=>{const i=Sb(t,"source"),r=Sb(t,"target");let o=0;i&&(o=n[i]);let s=0;r&&(s=n[r]);const a=e[o].children,l=e[s].children;a.push(e[s].id),l.push(e[o].id)}))}(o,i,s,e);let h=0;return o.forEach(((e,t)=>{if(0!==t)if(t!==u-1&&n[t]===n[t+1]&&!function(e,t,n){const i=n.length;for(let r=0;r<i;r++){const i=Sb(n[r],"source"),o=Sb(n[r],"target");if(e.id===i&&t.id===o||t.id===i&&e.id===o)return!0}return!1}(a[h],e,i)||c[t]){const e=a[h].children;let i=!1;for(let u=0;u<e.length;u++){const h=s[e[u]];if(n[h]===n[t]&&!c[h]){a.push(o[h]),l.push(r[s[o[h].id]]),c[h]=!0,i=!0;break}}let d=0;for(;!i&&(c[d]||(a.push(o[d]),l.push(r[s[o[d].id]]),c[d]=!0,i=!0),d++,d!==u););}else a.push(e),l.push(r[s[e.id]]),c[t]=!0,h++})),l}degreeOrdering(){const e=this.nodes,t=[],n=this.degrees;return e.forEach(((e,i)=>{e.degree=n[i],t.push(e)})),t.sort(Aw),t}getType(){return"circular"}}var Rw,Pw={exports:{}};
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */if(function(e,t){(function(){var n,i="Expected a function",r="__lodash_hash_undefined__",o="__lodash_placeholder__",s=16,a=32,l=64,c=128,u=256,h=1/0,d=9007199254740991,f=NaN,g=4294967295,p=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",s],["flip",512],["partial",a],["partialRight",l],["rearg",u]],m="[object Arguments]",v="[object Array]",_="[object Boolean]",b="[object Date]",w="[object Error]",C="[object Function]",S="[object GeneratorFunction]",x="[object Map]",E="[object Number]",k="[object Object]",L="[object Promise]",D="[object RegExp]",N="[object Set]",I="[object String]",T="[object Symbol]",M="[object WeakMap]",A="[object ArrayBuffer]",O="[object DataView]",R="[object Float32Array]",P="[object Float64Array]",F="[object Int8Array]",B="[object Int16Array]",W="[object Int32Array]",z="[object Uint8Array]",V="[object Uint8ClampedArray]",U="[object Uint16Array]",H="[object Uint32Array]",j=/\b__p \+= '';/g,G=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,q=/&(?:amp|lt|gt|quot|#39);/g,$=/[&<>"']/g,Y=RegExp(q.source),X=RegExp($.source),Z=/<%-([\s\S]+?)%>/g,Q=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,ee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,te=/^\w*$/,ne=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ie=/[\\^$.*+?()[\]{}|]/g,re=RegExp(ie.source),oe=/^\s+/,se=/\s/,ae=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,le=/\{\n\/\* \[wrapped with (.+)\] \*/,ce=/,? & /,ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,he=/[()=,{}\[\]\/\s]/,de=/\\(\\)?/g,fe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ge=/\w*$/,pe=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ve=/^\[object .+?Constructor\]$/,ye=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,we=/($^)/,Ce=/['\n\r\u2028\u2029\\]/g,Se="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",xe="\\u2700-\\u27bf",Ee="a-z\\xdf-\\xf6\\xf8-\\xff",ke="A-Z\\xc0-\\xd6\\xd8-\\xde",Le="\\ufe0e\\ufe0f",De="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ne="['’]",Ie="[\\ud800-\\udfff]",Te="["+De+"]",Me="["+Se+"]",Ae="\\d+",Oe="[\\u2700-\\u27bf]",Re="["+Ee+"]",Pe="[^\\ud800-\\udfff"+De+Ae+xe+Ee+ke+"]",Fe="\\ud83c[\\udffb-\\udfff]",Be="[^\\ud800-\\udfff]",We="(?:\\ud83c[\\udde6-\\uddff]){2}",ze="[\\ud800-\\udbff][\\udc00-\\udfff]",Ve="["+ke+"]",Ue="(?:"+Re+"|"+Pe+")",He="(?:"+Ve+"|"+Pe+")",je="(?:['’](?:d|ll|m|re|s|t|ve))?",Ge="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ke="(?:"+Me+"|"+Fe+")"+"?",qe="[\\ufe0e\\ufe0f]?",$e=qe+Ke+("(?:\\u200d(?:"+[Be,We,ze].join("|")+")"+qe+Ke+")*"),Ye="(?:"+[Oe,We,ze].join("|")+")"+$e,Xe="(?:"+[Be+Me+"?",Me,We,ze,Ie].join("|")+")",Ze=RegExp(Ne,"g"),Qe=RegExp(Me,"g"),Je=RegExp(Fe+"(?="+Fe+")|"+Xe+$e,"g"),et=RegExp([Ve+"?"+Re+"+"+je+"(?="+[Te,Ve,"$"].join("|")+")",He+"+"+Ge+"(?="+[Te,Ve+Ue,"$"].join("|")+")",Ve+"?"+Ue+"+"+je,Ve+"+"+Ge,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ae,Ye].join("|"),"g"),tt=RegExp("[\\u200d\\ud800-\\udfff"+Se+Le+"]"),nt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,it=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rt=-1,ot={};ot[R]=ot[P]=ot[F]=ot[B]=ot[W]=ot[z]=ot[V]=ot[U]=ot[H]=!0,ot[m]=ot[v]=ot[A]=ot[_]=ot[O]=ot[b]=ot[w]=ot[C]=ot[x]=ot[E]=ot[k]=ot[D]=ot[N]=ot[I]=ot[M]=!1;var st={};st[m]=st[v]=st[A]=st[O]=st[_]=st[b]=st[R]=st[P]=st[F]=st[B]=st[W]=st[x]=st[E]=st[k]=st[D]=st[N]=st[I]=st[T]=st[z]=st[V]=st[U]=st[H]=!0,st[w]=st[C]=st[M]=!1;var at={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},lt=parseFloat,ct=parseInt,ut="object"==typeof y&&y&&y.Object===Object&&y,ht="object"==typeof self&&self&&self.Object===Object&&self,dt=ut||ht||Function("return this")(),ft=t&&!t.nodeType&&t,gt=ft&&e&&!e.nodeType&&e,pt=gt&&gt.exports===ft,mt=pt&&ut.process,vt=function(){try{var e=gt&&gt.require&&gt.require("util").types;return e||mt&&mt.binding&&mt.binding("util")}catch(t){}}(),yt=vt&&vt.isArrayBuffer,_t=vt&&vt.isDate,bt=vt&&vt.isMap,wt=vt&&vt.isRegExp,Ct=vt&&vt.isSet,St=vt&&vt.isTypedArray;function xt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Et(e,t,n,i){for(var r=-1,o=null==e?0:e.length;++r<o;){var s=e[r];t(i,s,n(s),e)}return i}function kt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function Lt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Dt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function Nt(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var s=e[n];t(s,n,e)&&(o[r++]=s)}return o}function It(e,t){return!!(null==e?0:e.length)&&zt(e,t,0)>-1}function Tt(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}function Mt(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function At(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function Ot(e,t,n,i){var r=-1,o=null==e?0:e.length;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function Rt(e,t,n,i){var r=null==e?0:e.length;for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function Pt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var Ft=jt("length");function Bt(e,t,n){var i;return n(e,(function(e,n,r){if(t(e,n,r))return i=n,!1})),i}function Wt(e,t,n,i){for(var r=e.length,o=n+(i?1:-1);i?o--:++o<r;)if(t(e[o],o,e))return o;return-1}function zt(e,t,n){return t==t?function(e,t,n){var i=n-1,r=e.length;for(;++i<r;)if(e[i]===t)return i;return-1}(e,t,n):Wt(e,Ut,n)}function Vt(e,t,n,i){for(var r=n-1,o=e.length;++r<o;)if(i(e[r],t))return r;return-1}function Ut(e){return e!=e}function Ht(e,t){var n=null==e?0:e.length;return n?qt(e,t)/n:f}function jt(e){return function(t){return null==t?n:t[e]}}function Gt(e){return function(t){return null==e?n:e[t]}}function Kt(e,t,n,i,r){return r(e,(function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)})),n}function qt(e,t){for(var i,r=-1,o=e.length;++r<o;){var s=t(e[r]);s!==n&&(i=i===n?s:i+s)}return i}function $t(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function Yt(e){return e?e.slice(0,fn(e)+1).replace(oe,""):e}function Xt(e){return function(t){return e(t)}}function Zt(e,t){return Mt(t,(function(t){return e[t]}))}function Qt(e,t){return e.has(t)}function Jt(e,t){for(var n=-1,i=e.length;++n<i&&zt(t,e[n],0)>-1;);return n}function en(e,t){for(var n=e.length;n--&&zt(t,e[n],0)>-1;);return n}function tn(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}var nn=Gt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),rn=Gt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function on(e){return"\\"+at[e]}function sn(e){return tt.test(e)}function an(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function cn(e,t){for(var n=-1,i=e.length,r=0,s=[];++n<i;){var a=e[n];a!==t&&a!==o||(e[n]=o,s[r++]=n)}return s}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function hn(e){return sn(e)?function(e){var t=Je.lastIndex=0;for(;Je.test(e);)++t;return t}(e):Ft(e)}function dn(e){return sn(e)?function(e){return e.match(Je)||[]}(e):function(e){return e.split("")}(e)}function fn(e){for(var t=e.length;t--&&se.test(e.charAt(t)););return t}var gn=Gt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var pn=function e(t){var y,se=(t=null==t?dt:pn.defaults(dt.Object(),t,pn.pick(dt,it))).Array,Se=t.Date,xe=t.Error,Ee=t.Function,ke=t.Math,Le=t.Object,De=t.RegExp,Ne=t.String,Ie=t.TypeError,Te=se.prototype,Me=Ee.prototype,Ae=Le.prototype,Oe=t["__core-js_shared__"],Re=Me.toString,Pe=Ae.hasOwnProperty,Fe=0,Be=(y=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||""))?"Symbol(src)_1."+y:"",We=Ae.toString,ze=Re.call(Le),Ve=dt._,Ue=De("^"+Re.call(Pe).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),He=pt?t.Buffer:n,je=t.Symbol,Ge=t.Uint8Array,Ke=He?He.allocUnsafe:n,qe=ln(Le.getPrototypeOf,Le),$e=Le.create,Ye=Ae.propertyIsEnumerable,Xe=Te.splice,Je=je?je.isConcatSpreadable:n,tt=je?je.iterator:n,at=je?je.toStringTag:n,ut=function(){try{var e=fo(Le,"defineProperty");return e({},"",{}),e}catch(t){}}(),ht=t.clearTimeout!==dt.clearTimeout&&t.clearTimeout,ft=Se&&Se.now!==dt.Date.now&&Se.now,gt=t.setTimeout!==dt.setTimeout&&t.setTimeout,mt=ke.ceil,vt=ke.floor,Ft=Le.getOwnPropertySymbols,Gt=He?He.isBuffer:n,mn=t.isFinite,vn=Te.join,yn=ln(Le.keys,Le),_n=ke.max,bn=ke.min,wn=Se.now,Cn=t.parseInt,Sn=ke.random,xn=Te.reverse,En=fo(t,"DataView"),kn=fo(t,"Map"),Ln=fo(t,"Promise"),Dn=fo(t,"Set"),Nn=fo(t,"WeakMap"),In=fo(Le,"create"),Tn=Nn&&new Nn,Mn={},An=Ho(En),On=Ho(kn),Rn=Ho(Ln),Pn=Ho(Dn),Fn=Ho(Nn),Bn=je?je.prototype:n,Wn=Bn?Bn.valueOf:n,zn=Bn?Bn.toString:n;function Vn(e){if(sa(e)&&!Ys(e)&&!(e instanceof Gn)){if(e instanceof jn)return e;if(Pe.call(e,"__wrapped__"))return jo(e)}return new jn(e)}var Un=function(){function e(){}return function(t){if(!oa(t))return{};if($e)return $e(t);e.prototype=t;var i=new e;return e.prototype=n,i}}();function Hn(){}function jn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=n}function Gn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=g,this.__views__=[]}function Kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function $n(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new $n;++t<n;)this.add(e[t])}function Xn(e){var t=this.__data__=new qn(e);this.size=t.size}function Zn(e,t){var n=Ys(e),i=!n&&$s(e),r=!n&&!i&&Js(e),o=!n&&!i&&!r&&ga(e),s=n||i||r||o,a=s?$t(e.length,Ne):[],l=a.length;for(var c in e)!t&&!Pe.call(e,c)||s&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||bo(c,l))||a.push(c);return a}function Qn(e){var t=e.length;return t?e[Yi(0,t-1)]:n}function Jn(e,t){return Fo(Ir(e),li(t,0,e.length))}function ei(e){return Fo(Ir(e))}function ti(e,t,i){(i!==n&&!Gs(e[t],i)||i===n&&!(t in e))&&si(e,t,i)}function ni(e,t,i){var r=e[t];Pe.call(e,t)&&Gs(r,i)&&(i!==n||t in e)||si(e,t,i)}function ii(e,t){for(var n=e.length;n--;)if(Gs(e[n][0],t))return n;return-1}function ri(e,t,n,i){return fi(e,(function(e,r,o){t(i,e,n(e),o)})),i}function oi(e,t){return e&&Tr(t,Pa(t),e)}function si(e,t,n){"__proto__"==t&&ut?ut(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ai(e,t){for(var i=-1,r=t.length,o=se(r),s=null==e;++i<r;)o[i]=s?n:Ta(e,t[i]);return o}function li(e,t,i){return e==e&&(i!==n&&(e=e<=i?e:i),t!==n&&(e=e>=t?e:t)),e}function ci(e,t,i,r,o,s){var a,l=1&t,c=2&t,u=4&t;if(i&&(a=o?i(e,r,o,s):i(e)),a!==n)return a;if(!oa(e))return e;var h=Ys(e);if(h){if(a=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Pe.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!l)return Ir(e,a)}else{var d=mo(e),f=d==C||d==S;if(Js(e))return xr(e,l);if(d==k||d==m||f&&!o){if(a=c||f?{}:yo(e),!l)return c?function(e,t){return Tr(e,po(e),t)}(e,function(e,t){return e&&Tr(t,Fa(t),e)}(a,e)):function(e,t){return Tr(e,go(e),t)}(e,oi(a,e))}else{if(!st[d])return o?e:{};a=function(e,t,n){var i=e.constructor;switch(t){case A:return Er(e);case _:case b:return new i(+e);case O:return function(e,t){var n=t?Er(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case R:case P:case F:case B:case W:case z:case V:case U:case H:return kr(e,n);case x:return new i;case E:case I:return new i(e);case D:return function(e){var t=new e.constructor(e.source,ge.exec(e));return t.lastIndex=e.lastIndex,t}(e);case N:return new i;case T:return r=e,Wn?Le(Wn.call(r)):{}}var r}(e,d,l)}}s||(s=new Xn);var g=s.get(e);if(g)return g;s.set(e,a),ha(e)?e.forEach((function(n){a.add(ci(n,t,i,n,e,s))})):aa(e)&&e.forEach((function(n,r){a.set(r,ci(n,t,i,r,e,s))}));var p=h?n:(u?c?oo:ro:c?Fa:Pa)(e);return kt(p||e,(function(n,r){p&&(n=e[r=n]),ni(a,r,ci(n,t,i,r,e,s))})),a}function ui(e,t,i){var r=i.length;if(null==e)return!r;for(e=Le(e);r--;){var o=i[r],s=t[o],a=e[o];if(a===n&&!(o in e)||!s(a))return!1}return!0}function hi(e,t,r){if("function"!=typeof e)throw new Ie(i);return Ao((function(){e.apply(n,r)}),t)}function di(e,t,n,i){var r=-1,o=It,s=!0,a=e.length,l=[],c=t.length;if(!a)return l;n&&(t=Mt(t,Xt(n))),i?(o=Tt,s=!1):t.length>=200&&(o=Qt,s=!1,t=new Yn(t));e:for(;++r<a;){var u=e[r],h=null==n?u:n(u);if(u=i||0!==u?u:0,s&&h==h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else o(t,h,i)||l.push(u)}return l}Vn.templateSettings={escape:Z,evaluate:Q,interpolate:J,variable:"",imports:{_:Vn}},Vn.prototype=Hn.prototype,Vn.prototype.constructor=Vn,jn.prototype=Un(Hn.prototype),jn.prototype.constructor=jn,Gn.prototype=Un(Hn.prototype),Gn.prototype.constructor=Gn,Kn.prototype.clear=function(){this.__data__=In?In(null):{},this.size=0},Kn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Kn.prototype.get=function(e){var t=this.__data__;if(In){var i=t[e];return i===r?n:i}return Pe.call(t,e)?t[e]:n},Kn.prototype.has=function(e){var t=this.__data__;return In?t[e]!==n:Pe.call(t,e)},Kn.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=In&&t===n?r:t,this},qn.prototype.clear=function(){this.__data__=[],this.size=0},qn.prototype.delete=function(e){var t=this.__data__,n=ii(t,e);return!(n<0)&&(n==t.length-1?t.pop():Xe.call(t,n,1),--this.size,!0)},qn.prototype.get=function(e){var t=this.__data__,i=ii(t,e);return i<0?n:t[i][1]},qn.prototype.has=function(e){return ii(this.__data__,e)>-1},qn.prototype.set=function(e,t){var n=this.__data__,i=ii(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new Kn,map:new(kn||qn),string:new Kn}},$n.prototype.delete=function(e){var t=uo(this,e).delete(e);return this.size-=t?1:0,t},$n.prototype.get=function(e){return uo(this,e).get(e)},$n.prototype.has=function(e){return uo(this,e).has(e)},$n.prototype.set=function(e,t){var n=uo(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},Yn.prototype.add=Yn.prototype.push=function(e){return this.__data__.set(e,r),this},Yn.prototype.has=function(e){return this.__data__.has(e)},Xn.prototype.clear=function(){this.__data__=new qn,this.size=0},Xn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Xn.prototype.get=function(e){return this.__data__.get(e)},Xn.prototype.has=function(e){return this.__data__.has(e)},Xn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof qn){var i=n.__data__;if(!kn||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new $n(i)}return n.set(e,t),this.size=n.size,this};var fi=Or(wi),gi=Or(Ci,!0);function pi(e,t){var n=!0;return fi(e,(function(e,i,r){return n=!!t(e,i,r)})),n}function mi(e,t,i){for(var r=-1,o=e.length;++r<o;){var s=e[r],a=t(s);if(null!=a&&(l===n?a==a&&!fa(a):i(a,l)))var l=a,c=s}return c}function vi(e,t){var n=[];return fi(e,(function(e,i,r){t(e,i,r)&&n.push(e)})),n}function yi(e,t,n,i,r){var o=-1,s=e.length;for(n||(n=_o),r||(r=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?yi(a,t-1,n,i,r):At(r,a):i||(r[r.length]=a)}return r}var _i=Rr(),bi=Rr(!0);function wi(e,t){return e&&_i(e,t,Pa)}function Ci(e,t){return e&&bi(e,t,Pa)}function Si(e,t){return Nt(t,(function(t){return na(e[t])}))}function xi(e,t){for(var i=0,r=(t=br(t,e)).length;null!=e&&i<r;)e=e[Uo(t[i++])];return i&&i==r?e:n}function Ei(e,t,n){var i=t(e);return Ys(e)?i:At(i,n(e))}function ki(e){return null==e?e===n?"[object Undefined]":"[object Null]":at&&at in Le(e)?function(e){var t=Pe.call(e,at),i=e[at];try{e[at]=n;var r=!0}catch(s){}var o=We.call(e);r&&(t?e[at]=i:delete e[at]);return o}(e):function(e){return We.call(e)}(e)}function Li(e,t){return e>t}function Di(e,t){return null!=e&&Pe.call(e,t)}function Ni(e,t){return null!=e&&t in Le(e)}function Ii(e,t,i){for(var r=i?Tt:It,o=e[0].length,s=e.length,a=s,l=se(s),c=1/0,u=[];a--;){var h=e[a];a&&t&&(h=Mt(h,Xt(t))),c=bn(h.length,c),l[a]=!i&&(t||o>=120&&h.length>=120)?new Yn(a&&h):n}h=e[0];var d=-1,f=l[0];e:for(;++d<o&&u.length<c;){var g=h[d],p=t?t(g):g;if(g=i||0!==g?g:0,!(f?Qt(f,p):r(u,p,i))){for(a=s;--a;){var m=l[a];if(!(m?Qt(m,p):r(e[a],p,i)))continue e}f&&f.push(p),u.push(g)}}return u}function Ti(e,t,i){var r=null==(e=No(e,t=br(t,e)))?e:e[Uo(ts(t))];return null==r?n:xt(r,e,i)}function Mi(e){return sa(e)&&ki(e)==m}function Ai(e,t,i,r,o){return e===t||(null==e||null==t||!sa(e)&&!sa(t)?e!=e&&t!=t:function(e,t,i,r,o,s){var a=Ys(e),l=Ys(t),c=a?v:mo(e),u=l?v:mo(t),h=(c=c==m?k:c)==k,d=(u=u==m?k:u)==k,f=c==u;if(f&&Js(e)){if(!Js(t))return!1;a=!0,h=!1}if(f&&!h)return s||(s=new Xn),a||ga(e)?no(e,t,i,r,o,s):function(e,t,n,i,r,o,s){switch(n){case O:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case A:return!(e.byteLength!=t.byteLength||!o(new Ge(e),new Ge(t)));case _:case b:case E:return Gs(+e,+t);case w:return e.name==t.name&&e.message==t.message;case D:case I:return e==t+"";case x:var a=an;case N:var l=1&i;if(a||(a=un),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;i|=2,s.set(e,t);var u=no(a(e),a(t),i,r,o,s);return s.delete(e),u;case T:if(Wn)return Wn.call(e)==Wn.call(t)}return!1}(e,t,c,i,r,o,s);if(!(1&i)){var g=h&&Pe.call(e,"__wrapped__"),p=d&&Pe.call(t,"__wrapped__");if(g||p){var y=g?e.value():e,C=p?t.value():t;return s||(s=new Xn),o(y,C,i,r,s)}}if(!f)return!1;return s||(s=new Xn),function(e,t,i,r,o,s){var a=1&i,l=ro(e),c=l.length,u=ro(t).length;if(c!=u&&!a)return!1;var h=c;for(;h--;){var d=l[h];if(!(a?d in t:Pe.call(t,d)))return!1}var f=s.get(e),g=s.get(t);if(f&&g)return f==t&&g==e;var p=!0;s.set(e,t),s.set(t,e);var m=a;for(;++h<c;){var v=e[d=l[h]],y=t[d];if(r)var _=a?r(y,v,d,t,e,s):r(v,y,d,e,t,s);if(!(_===n?v===y||o(v,y,i,r,s):_)){p=!1;break}m||(m="constructor"==d)}if(p&&!m){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(p=!1)}return s.delete(e),s.delete(t),p}(e,t,i,r,o,s)}(e,t,i,r,Ai,o))}function Oi(e,t,i,r){var o=i.length,s=o,a=!r;if(null==e)return!s;for(e=Le(e);o--;){var l=i[o];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<s;){var c=(l=i[o])[0],u=e[c],h=l[1];if(a&&l[2]){if(u===n&&!(c in e))return!1}else{var d=new Xn;if(r)var f=r(u,h,c,e,t,d);if(!(f===n?Ai(h,u,3,r,d):f))return!1}}return!0}function Ri(e){return!(!oa(e)||(t=e,Be&&Be in t))&&(na(e)?Ue:ve).test(Ho(e));var t}function Pi(e){return"function"==typeof e?e:null==e?ll:"object"==typeof e?Ys(e)?Ui(e[0],e[1]):Vi(e):vl(e)}function Fi(e){if(!Eo(e))return yn(e);var t=[];for(var n in Le(e))Pe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Bi(e){if(!oa(e))return function(e){var t=[];if(null!=e)for(var n in Le(e))t.push(n);return t}(e);var t=Eo(e),n=[];for(var i in e)("constructor"!=i||!t&&Pe.call(e,i))&&n.push(i);return n}function Wi(e,t){return e<t}function zi(e,t){var n=-1,i=Zs(e)?se(e.length):[];return fi(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Vi(e){var t=ho(e);return 1==t.length&&t[0][2]?Lo(t[0][0],t[0][1]):function(n){return n===e||Oi(n,e,t)}}function Ui(e,t){return Co(e)&&ko(t)?Lo(Uo(e),t):function(i){var r=Ta(i,e);return r===n&&r===t?Ma(i,e):Ai(t,r,3)}}function Hi(e,t,i,r,o){e!==t&&_i(t,(function(s,a){if(o||(o=new Xn),oa(s))!function(e,t,i,r,o,s,a){var l=To(e,i),c=To(t,i),u=a.get(c);if(u)return void ti(e,i,u);var h=s?s(l,c,i+"",e,t,a):n,d=h===n;if(d){var f=Ys(c),g=!f&&Js(c),p=!f&&!g&&ga(c);h=c,f||g||p?Ys(l)?h=l:Qs(l)?h=Ir(l):g?(d=!1,h=xr(c,!0)):p?(d=!1,h=kr(c,!0)):h=[]:ca(c)||$s(c)?(h=l,$s(l)?h=Ca(l):oa(l)&&!na(l)||(h=yo(c))):d=!1}d&&(a.set(c,h),o(h,c,r,s,a),a.delete(c));ti(e,i,h)}(e,t,a,i,Hi,r,o);else{var l=r?r(To(e,a),s,a+"",e,t,o):n;l===n&&(l=s),ti(e,a,l)}}),Fa)}function ji(e,t){var i=e.length;if(i)return bo(t+=t<0?i:0,i)?e[t]:n}function Gi(e,t,n){t=t.length?Mt(t,(function(e){return Ys(e)?function(t){return xi(t,1===e.length?e[0]:e)}:e})):[ll];var i=-1;return t=Mt(t,Xt(co())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(zi(e,(function(e,n,r){return{criteria:Mt(t,(function(t){return t(e)})),index:++i,value:e}})),(function(e,t){return function(e,t,n){var i=-1,r=e.criteria,o=t.criteria,s=r.length,a=n.length;for(;++i<s;){var l=Lr(r[i],o[i]);if(l)return i>=a?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function Ki(e,t,n){for(var i=-1,r=t.length,o={};++i<r;){var s=t[i],a=xi(e,s);n(a,s)&&er(o,br(s,e),a)}return o}function qi(e,t,n,i){var r=i?Vt:zt,o=-1,s=t.length,a=e;for(e===t&&(t=Ir(t)),n&&(a=Mt(e,Xt(n)));++o<s;)for(var l=0,c=t[o],u=n?n(c):c;(l=r(a,u,l,i))>-1;)a!==e&&Xe.call(a,l,1),Xe.call(e,l,1);return e}function $i(e,t){for(var n=e?t.length:0,i=n-1;n--;){var r=t[n];if(n==i||r!==o){var o=r;bo(r)?Xe.call(e,r,1):dr(e,r)}}return e}function Yi(e,t){return e+vt(Sn()*(t-e+1))}function Xi(e,t){var n="";if(!e||t<1||t>d)return n;do{t%2&&(n+=e),(t=vt(t/2))&&(e+=e)}while(t);return n}function Zi(e,t){return Oo(Do(e,t,ll),e+"")}function Qi(e){return Qn(Ga(e))}function Ji(e,t){var n=Ga(e);return Fo(n,li(t,0,n.length))}function er(e,t,i,r){if(!oa(e))return e;for(var o=-1,s=(t=br(t,e)).length,a=s-1,l=e;null!=l&&++o<s;){var c=Uo(t[o]),u=i;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var h=l[c];(u=r?r(h,c,l):n)===n&&(u=oa(h)?h:bo(t[o+1])?[]:{})}ni(l,c,u),l=l[c]}return e}var tr=Tn?function(e,t){return Tn.set(e,t),e}:ll,nr=ut?function(e,t){return ut(e,"toString",{configurable:!0,enumerable:!1,value:ol(t),writable:!0})}:ll;function ir(e){return Fo(Ga(e))}function rr(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=se(r);++i<r;)o[i]=e[i+t];return o}function or(e,t){var n;return fi(e,(function(e,i,r){return!(n=t(e,i,r))})),!!n}function sr(e,t,n){var i=0,r=null==e?i:e.length;if("number"==typeof t&&t==t&&r<=2147483647){for(;i<r;){var o=i+r>>>1,s=e[o];null!==s&&!fa(s)&&(n?s<=t:s<t)?i=o+1:r=o}return r}return ar(e,t,ll,n)}function ar(e,t,i,r){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=i(t))!=t,l=null===t,c=fa(t),u=t===n;o<s;){var h=vt((o+s)/2),d=i(e[h]),f=d!==n,g=null===d,p=d==d,m=fa(d);if(a)var v=r||p;else v=u?p&&(r||f):l?p&&f&&(r||!g):c?p&&f&&!g&&(r||!m):!g&&!m&&(r?d<=t:d<t);v?o=h+1:s=h}return bn(s,4294967294)}function lr(e,t){for(var n=-1,i=e.length,r=0,o=[];++n<i;){var s=e[n],a=t?t(s):s;if(!n||!Gs(a,l)){var l=a;o[r++]=0===s?0:s}}return o}function cr(e){return"number"==typeof e?e:fa(e)?f:+e}function ur(e){if("string"==typeof e)return e;if(Ys(e))return Mt(e,ur)+"";if(fa(e))return zn?zn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function hr(e,t,n){var i=-1,r=It,o=e.length,s=!0,a=[],l=a;if(n)s=!1,r=Tt;else if(o>=200){var c=t?null:Xr(e);if(c)return un(c);s=!1,r=Qt,l=new Yn}else l=t?[]:a;e:for(;++i<o;){var u=e[i],h=t?t(u):u;if(u=n||0!==u?u:0,s&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),a.push(u)}else r(l,h,n)||(l!==a&&l.push(h),a.push(u))}return a}function dr(e,t){return null==(e=No(e,t=br(t,e)))||delete e[Uo(ts(t))]}function fr(e,t,n,i){return er(e,t,n(xi(e,t)),i)}function gr(e,t,n,i){for(var r=e.length,o=i?r:-1;(i?o--:++o<r)&&t(e[o],o,e););return n?rr(e,i?0:o,i?o+1:r):rr(e,i?o+1:0,i?r:o)}function pr(e,t){var n=e;return n instanceof Gn&&(n=n.value()),Ot(t,(function(e,t){return t.func.apply(t.thisArg,At([e],t.args))}),n)}function mr(e,t,n){var i=e.length;if(i<2)return i?hr(e[0]):[];for(var r=-1,o=se(i);++r<i;)for(var s=e[r],a=-1;++a<i;)a!=r&&(o[r]=di(o[r]||s,e[a],t,n));return hr(yi(o,1),t,n)}function vr(e,t,i){for(var r=-1,o=e.length,s=t.length,a={};++r<o;){var l=r<s?t[r]:n;i(a,e[r],l)}return a}function yr(e){return Qs(e)?e:[]}function _r(e){return"function"==typeof e?e:ll}function br(e,t){return Ys(e)?e:Co(e,t)?[e]:Vo(Sa(e))}var wr=Zi;function Cr(e,t,i){var r=e.length;return i=i===n?r:i,!t&&i>=r?e:rr(e,t,i)}var Sr=ht||function(e){return dt.clearTimeout(e)};function xr(e,t){if(t)return e.slice();var n=e.length,i=Ke?Ke(n):new e.constructor(n);return e.copy(i),i}function Er(e){var t=new e.constructor(e.byteLength);return new Ge(t).set(new Ge(e)),t}function kr(e,t){var n=t?Er(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Lr(e,t){if(e!==t){var i=e!==n,r=null===e,o=e==e,s=fa(e),a=t!==n,l=null===t,c=t==t,u=fa(t);if(!l&&!u&&!s&&e>t||s&&a&&c&&!l&&!u||r&&a&&c||!i&&c||!o)return 1;if(!r&&!s&&!u&&e<t||u&&i&&o&&!r&&!s||l&&i&&o||!a&&o||!c)return-1}return 0}function Dr(e,t,n,i){for(var r=-1,o=e.length,s=n.length,a=-1,l=t.length,c=_n(o-s,0),u=se(l+c),h=!i;++a<l;)u[a]=t[a];for(;++r<s;)(h||r<o)&&(u[n[r]]=e[r]);for(;c--;)u[a++]=e[r++];return u}function Nr(e,t,n,i){for(var r=-1,o=e.length,s=-1,a=n.length,l=-1,c=t.length,u=_n(o-a,0),h=se(u+c),d=!i;++r<u;)h[r]=e[r];for(var f=r;++l<c;)h[f+l]=t[l];for(;++s<a;)(d||r<o)&&(h[f+n[s]]=e[r++]);return h}function Ir(e,t){var n=-1,i=e.length;for(t||(t=se(i));++n<i;)t[n]=e[n];return t}function Tr(e,t,i,r){var o=!i;i||(i={});for(var s=-1,a=t.length;++s<a;){var l=t[s],c=r?r(i[l],e[l],l,i,e):n;c===n&&(c=e[l]),o?si(i,l,c):ni(i,l,c)}return i}function Mr(e,t){return function(n,i){var r=Ys(n)?Et:ri,o=t?t():{};return r(n,e,co(i,2),o)}}function Ar(e){return Zi((function(t,i){var r=-1,o=i.length,s=o>1?i[o-1]:n,a=o>2?i[2]:n;for(s=e.length>3&&"function"==typeof s?(o--,s):n,a&&wo(i[0],i[1],a)&&(s=o<3?n:s,o=1),t=Le(t);++r<o;){var l=i[r];l&&e(t,l,r,s)}return t}))}function Or(e,t){return function(n,i){if(null==n)return n;if(!Zs(n))return e(n,i);for(var r=n.length,o=t?r:-1,s=Le(n);(t?o--:++o<r)&&!1!==i(s[o],o,s););return n}}function Rr(e){return function(t,n,i){for(var r=-1,o=Le(t),s=i(t),a=s.length;a--;){var l=s[e?a:++r];if(!1===n(o[l],l,o))break}return t}}function Pr(e){return function(t){var i=sn(t=Sa(t))?dn(t):n,r=i?i[0]:t.charAt(0),o=i?Cr(i,1).join(""):t.slice(1);return r[e]()+o}}function Fr(e){return function(t){return Ot(nl($a(t).replace(Ze,"")),e,"")}}function Br(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Un(e.prototype),i=e.apply(n,t);return oa(i)?i:n}}function Wr(e){return function(t,i,r){var o=Le(t);if(!Zs(t)){var s=co(i,3);t=Pa(t),i=function(e){return s(o[e],e,o)}}var a=e(t,i,r);return a>-1?o[s?t[a]:a]:n}}function zr(e){return io((function(t){var r=t.length,o=r,s=jn.prototype.thru;for(e&&t.reverse();o--;){var a=t[o];if("function"!=typeof a)throw new Ie(i);if(s&&!l&&"wrapper"==ao(a))var l=new jn([],!0)}for(o=l?o:r;++o<r;){var c=ao(a=t[o]),u="wrapper"==c?so(a):n;l=u&&So(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[ao(u[0])].apply(l,u[3]):1==a.length&&So(a)?l[c]():l.thru(a)}return function(){var e=arguments,n=e[0];if(l&&1==e.length&&Ys(n))return l.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}}))}function Vr(e,t,i,r,o,s,a,l,u,h){var d=t&c,f=1&t,g=2&t,p=24&t,m=512&t,v=g?n:Br(e);return function n(){for(var c=arguments.length,y=se(c),_=c;_--;)y[_]=arguments[_];if(p)var b=lo(n),w=tn(y,b);if(r&&(y=Dr(y,r,o,p)),s&&(y=Nr(y,s,a,p)),c-=w,p&&c<h){var C=cn(y,b);return $r(e,t,Vr,n.placeholder,i,y,C,l,u,h-c)}var S=f?i:this,x=g?S[e]:e;return c=y.length,l?y=Io(y,l):m&&c>1&&y.reverse(),d&&u<c&&(y.length=u),this&&this!==dt&&this instanceof n&&(x=v||Br(x)),x.apply(S,y)}}function Ur(e,t){return function(n,i){return function(e,t,n,i){return wi(e,(function(e,r,o){t(i,n(e),r,o)})),i}(n,e,t(i),{})}}function Hr(e,t){return function(i,r){var o;if(i===n&&r===n)return t;if(i!==n&&(o=i),r!==n){if(o===n)return r;"string"==typeof i||"string"==typeof r?(i=ur(i),r=ur(r)):(i=cr(i),r=cr(r)),o=e(i,r)}return o}}function jr(e){return io((function(t){return t=Mt(t,Xt(co())),Zi((function(n){var i=this;return e(t,(function(e){return xt(e,i,n)}))}))}))}function Gr(e,t){var i=(t=t===n?" ":ur(t)).length;if(i<2)return i?Xi(t,e):t;var r=Xi(t,mt(e/hn(t)));return sn(t)?Cr(dn(r),0,e).join(""):r.slice(0,e)}function Kr(e){return function(t,i,r){return r&&"number"!=typeof r&&wo(t,i,r)&&(i=r=n),t=ya(t),i===n?(i=t,t=0):i=ya(i),function(e,t,n,i){for(var r=-1,o=_n(mt((t-e)/(n||1)),0),s=se(o);o--;)s[i?o:++r]=e,e+=n;return s}(t,i,r=r===n?t<i?1:-1:ya(r),e)}}function qr(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=wa(t),n=wa(n)),e(t,n)}}function $r(e,t,i,r,o,s,c,u,h,d){var f=8&t;t|=f?a:l,4&(t&=~(f?l:a))||(t&=-4);var g=[e,t,o,f?s:n,f?c:n,f?n:s,f?n:c,u,h,d],p=i.apply(n,g);return So(e)&&Mo(p,g),p.placeholder=r,Ro(p,e,t)}function Yr(e){var t=ke[e];return function(e,n){if(e=wa(e),(n=null==n?0:bn(_a(n),292))&&mn(e)){var i=(Sa(e)+"e").split("e");return+((i=(Sa(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var Xr=Dn&&1/un(new Dn([,-0]))[1]==h?function(e){return new Dn(e)}:fl;function Zr(e){return function(t){var n=mo(t);return n==x?an(t):n==N?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return Mt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Qr(e,t,r,h,d,f,g,p){var m=2&t;if(!m&&"function"!=typeof e)throw new Ie(i);var v=h?h.length:0;if(v||(t&=-97,h=d=n),g=g===n?g:_n(_a(g),0),p=p===n?p:_a(p),v-=d?d.length:0,t&l){var y=h,_=d;h=d=n}var b=m?n:so(e),w=[e,t,r,h,d,y,_,f,g,p];if(b&&function(e,t){var n=e[1],i=t[1],r=n|i,s=r<131,a=i==c&&8==n||i==c&&n==u&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==n;if(!s&&!a)return e;1&i&&(e[2]=t[2],r|=1&n?0:4);var l=t[3];if(l){var h=e[3];e[3]=h?Dr(h,l,t[4]):l,e[4]=h?cn(e[3],o):t[4]}(l=t[5])&&(h=e[5],e[5]=h?Nr(h,l,t[6]):l,e[6]=h?cn(e[5],o):t[6]);(l=t[7])&&(e[7]=l);i&c&&(e[8]=null==e[8]?t[8]:bn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=r}(w,b),e=w[0],t=w[1],r=w[2],h=w[3],d=w[4],!(p=w[9]=w[9]===n?m?0:e.length:_n(w[9]-v,0))&&24&t&&(t&=-25),t&&1!=t)C=8==t||t==s?function(e,t,i){var r=Br(e);return function o(){for(var s=arguments.length,a=se(s),l=s,c=lo(o);l--;)a[l]=arguments[l];var u=s<3&&a[0]!==c&&a[s-1]!==c?[]:cn(a,c);return(s-=u.length)<i?$r(e,t,Vr,o.placeholder,n,a,u,n,n,i-s):xt(this&&this!==dt&&this instanceof o?r:e,this,a)}}(e,t,p):t!=a&&33!=t||d.length?Vr.apply(n,w):function(e,t,n,i){var r=1&t,o=Br(e);return function t(){for(var s=-1,a=arguments.length,l=-1,c=i.length,u=se(c+a),h=this&&this!==dt&&this instanceof t?o:e;++l<c;)u[l]=i[l];for(;a--;)u[l++]=arguments[++s];return xt(h,r?n:this,u)}}(e,t,r,h);else var C=function(e,t,n){var i=1&t,r=Br(e);return function t(){return(this&&this!==dt&&this instanceof t?r:e).apply(i?n:this,arguments)}}(e,t,r);return Ro((b?tr:Mo)(C,w),e,t)}function Jr(e,t,i,r){return e===n||Gs(e,Ae[i])&&!Pe.call(r,i)?t:e}function eo(e,t,i,r,o,s){return oa(e)&&oa(t)&&(s.set(t,e),Hi(e,t,n,eo,s),s.delete(t)),e}function to(e){return ca(e)?n:e}function no(e,t,i,r,o,s){var a=1&i,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var u=s.get(e),h=s.get(t);if(u&&h)return u==t&&h==e;var d=-1,f=!0,g=2&i?new Yn:n;for(s.set(e,t),s.set(t,e);++d<l;){var p=e[d],m=t[d];if(r)var v=a?r(m,p,d,t,e,s):r(p,m,d,e,t,s);if(v!==n){if(v)continue;f=!1;break}if(g){if(!Pt(t,(function(e,t){if(!Qt(g,t)&&(p===e||o(p,e,i,r,s)))return g.push(t)}))){f=!1;break}}else if(p!==m&&!o(p,m,i,r,s)){f=!1;break}}return s.delete(e),s.delete(t),f}function io(e){return Oo(Do(e,n,Xo),e+"")}function ro(e){return Ei(e,Pa,go)}function oo(e){return Ei(e,Fa,po)}var so=Tn?function(e){return Tn.get(e)}:fl;function ao(e){for(var t=e.name+"",n=Mn[t],i=Pe.call(Mn,t)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==e)return r.name}return t}function lo(e){return(Pe.call(Vn,"placeholder")?Vn:e).placeholder}function co(){var e=Vn.iteratee||cl;return e=e===cl?Pi:e,arguments.length?e(arguments[0],arguments[1]):e}function uo(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function ho(e){for(var t=Pa(e),n=t.length;n--;){var i=t[n],r=e[i];t[n]=[i,r,ko(r)]}return t}function fo(e,t){var i=function(e,t){return null==e?n:e[t]}(e,t);return Ri(i)?i:n}var go=Ft?function(e){return null==e?[]:(e=Le(e),Nt(Ft(e),(function(t){return Ye.call(e,t)})))}:bl,po=Ft?function(e){for(var t=[];e;)At(t,go(e)),e=qe(e);return t}:bl,mo=ki;function vo(e,t,n){for(var i=-1,r=(t=br(t,e)).length,o=!1;++i<r;){var s=Uo(t[i]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++i!=r?o:!!(r=null==e?0:e.length)&&ra(r)&&bo(s,r)&&(Ys(e)||$s(e))}function yo(e){return"function"!=typeof e.constructor||Eo(e)?{}:Un(qe(e))}function _o(e){return Ys(e)||$s(e)||!!(Je&&e&&e[Je])}function bo(e,t){var n=typeof e;return!!(t=null==t?d:t)&&("number"==n||"symbol"!=n&&_e.test(e))&&e>-1&&e%1==0&&e<t}function wo(e,t,n){if(!oa(n))return!1;var i=typeof t;return!!("number"==i?Zs(n)&&bo(t,n.length):"string"==i&&t in n)&&Gs(n[t],e)}function Co(e,t){if(Ys(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!fa(e))||(te.test(e)||!ee.test(e)||null!=t&&e in Le(t))}function So(e){var t=ao(e),n=Vn[t];if("function"!=typeof n||!(t in Gn.prototype))return!1;if(e===n)return!0;var i=so(n);return!!i&&e===i[0]}(En&&mo(new En(new ArrayBuffer(1)))!=O||kn&&mo(new kn)!=x||Ln&&mo(Ln.resolve())!=L||Dn&&mo(new Dn)!=N||Nn&&mo(new Nn)!=M)&&(mo=function(e){var t=ki(e),i=t==k?e.constructor:n,r=i?Ho(i):"";if(r)switch(r){case An:return O;case On:return x;case Rn:return L;case Pn:return N;case Fn:return M}return t});var xo=Oe?na:wl;function Eo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ae)}function ko(e){return e==e&&!oa(e)}function Lo(e,t){return function(i){return null!=i&&(i[e]===t&&(t!==n||e in Le(i)))}}function Do(e,t,i){return t=_n(t===n?e.length-1:t,0),function(){for(var n=arguments,r=-1,o=_n(n.length-t,0),s=se(o);++r<o;)s[r]=n[t+r];r=-1;for(var a=se(t+1);++r<t;)a[r]=n[r];return a[t]=i(s),xt(e,this,a)}}function No(e,t){return t.length<2?e:xi(e,rr(t,0,-1))}function Io(e,t){for(var i=e.length,r=bn(t.length,i),o=Ir(e);r--;){var s=t[r];e[r]=bo(s,i)?o[s]:n}return e}function To(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Mo=Po(tr),Ao=gt||function(e,t){return dt.setTimeout(e,t)},Oo=Po(nr);function Ro(e,t,n){var i=t+"";return Oo(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(ae,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return kt(p,(function(n){var i="_."+n[0];t&n[1]&&!It(e,i)&&e.push(i)})),e.sort()}(function(e){var t=e.match(le);return t?t[1].split(ce):[]}(i),n)))}function Po(e){var t=0,i=0;return function(){var r=wn(),o=16-(r-i);if(i=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(n,arguments)}}function Fo(e,t){var i=-1,r=e.length,o=r-1;for(t=t===n?r:t;++i<t;){var s=Yi(i,o),a=e[s];e[s]=e[i],e[i]=a}return e.length=t,e}var Bo,Wo,zo,Vo=(Bo=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ne,(function(e,n,i,r){t.push(i?r.replace(de,"$1"):n||e)})),t},Wo=Ws(Bo,(function(e){return 500===zo.size&&zo.clear(),e})),zo=Wo.cache,Wo);function Uo(e){if("string"==typeof e||fa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ho(e){if(null!=e){try{return Re.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function jo(e){if(e instanceof Gn)return e.clone();var t=new jn(e.__wrapped__,e.__chain__);return t.__actions__=Ir(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Go=Zi((function(e,t){return Qs(e)?di(e,yi(t,1,Qs,!0)):[]})),Ko=Zi((function(e,t){var i=ts(t);return Qs(i)&&(i=n),Qs(e)?di(e,yi(t,1,Qs,!0),co(i,2)):[]})),qo=Zi((function(e,t){var i=ts(t);return Qs(i)&&(i=n),Qs(e)?di(e,yi(t,1,Qs,!0),n,i):[]}));function $o(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:_a(n);return r<0&&(r=_n(i+r,0)),Wt(e,co(t,3),r)}function Yo(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return i!==n&&(o=_a(i),o=i<0?_n(r+o,0):bn(o,r-1)),Wt(e,co(t,3),o,!0)}function Xo(e){return(null==e?0:e.length)?yi(e,1):[]}function Zo(e){return e&&e.length?e[0]:n}var Qo=Zi((function(e){var t=Mt(e,yr);return t.length&&t[0]===e[0]?Ii(t):[]})),Jo=Zi((function(e){var t=ts(e),i=Mt(e,yr);return t===ts(i)?t=n:i.pop(),i.length&&i[0]===e[0]?Ii(i,co(t,2)):[]})),es=Zi((function(e){var t=ts(e),i=Mt(e,yr);return(t="function"==typeof t?t:n)&&i.pop(),i.length&&i[0]===e[0]?Ii(i,n,t):[]}));function ts(e){var t=null==e?0:e.length;return t?e[t-1]:n}var ns=Zi(is);function is(e,t){return e&&e.length&&t&&t.length?qi(e,t):e}var rs=io((function(e,t){var n=null==e?0:e.length,i=ai(e,t);return $i(e,Mt(t,(function(e){return bo(e,n)?+e:e})).sort(Lr)),i}));function os(e){return null==e?e:xn.call(e)}var ss=Zi((function(e){return hr(yi(e,1,Qs,!0))})),as=Zi((function(e){var t=ts(e);return Qs(t)&&(t=n),hr(yi(e,1,Qs,!0),co(t,2))})),ls=Zi((function(e){var t=ts(e);return t="function"==typeof t?t:n,hr(yi(e,1,Qs,!0),n,t)}));function cs(e){if(!e||!e.length)return[];var t=0;return e=Nt(e,(function(e){if(Qs(e))return t=_n(e.length,t),!0})),$t(t,(function(t){return Mt(e,jt(t))}))}function us(e,t){if(!e||!e.length)return[];var i=cs(e);return null==t?i:Mt(i,(function(e){return xt(t,n,e)}))}var hs=Zi((function(e,t){return Qs(e)?di(e,t):[]})),ds=Zi((function(e){return mr(Nt(e,Qs))})),fs=Zi((function(e){var t=ts(e);return Qs(t)&&(t=n),mr(Nt(e,Qs),co(t,2))})),gs=Zi((function(e){var t=ts(e);return t="function"==typeof t?t:n,mr(Nt(e,Qs),n,t)})),ps=Zi(cs);var ms=Zi((function(e){var t=e.length,i=t>1?e[t-1]:n;return i="function"==typeof i?(e.pop(),i):n,us(e,i)}));function vs(e){var t=Vn(e);return t.__chain__=!0,t}function ys(e,t){return t(e)}var _s=io((function(e){var t=e.length,i=t?e[0]:0,r=this.__wrapped__,o=function(t){return ai(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Gn&&bo(i)?((r=r.slice(i,+i+(t?1:0))).__actions__.push({func:ys,args:[o],thisArg:n}),new jn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(n),e}))):this.thru(o)}));var bs=Mr((function(e,t,n){Pe.call(e,n)?++e[n]:si(e,n,1)}));var ws=Wr($o),Cs=Wr(Yo);function Ss(e,t){return(Ys(e)?kt:fi)(e,co(t,3))}function xs(e,t){return(Ys(e)?Lt:gi)(e,co(t,3))}var Es=Mr((function(e,t,n){Pe.call(e,n)?e[n].push(t):si(e,n,[t])}));var ks=Zi((function(e,t,n){var i=-1,r="function"==typeof t,o=Zs(e)?se(e.length):[];return fi(e,(function(e){o[++i]=r?xt(t,e,n):Ti(e,t,n)})),o})),Ls=Mr((function(e,t,n){si(e,n,t)}));function Ds(e,t){return(Ys(e)?Mt:zi)(e,co(t,3))}var Ns=Mr((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var Is=Zi((function(e,t){if(null==e)return[];var n=t.length;return n>1&&wo(e,t[0],t[1])?t=[]:n>2&&wo(t[0],t[1],t[2])&&(t=[t[0]]),Gi(e,yi(t,1),[])})),Ts=ft||function(){return dt.Date.now()};function Ms(e,t,i){return t=i?n:t,t=e&&null==t?e.length:t,Qr(e,c,n,n,n,n,t)}function As(e,t){var r;if("function"!=typeof t)throw new Ie(i);return e=_a(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=n),r}}var Os=Zi((function(e,t,n){var i=1;if(n.length){var r=cn(n,lo(Os));i|=a}return Qr(e,i,t,n,r)})),Rs=Zi((function(e,t,n){var i=3;if(n.length){var r=cn(n,lo(Rs));i|=a}return Qr(t,i,e,n,r)}));function Ps(e,t,r){var o,s,a,l,c,u,h=0,d=!1,f=!1,g=!0;if("function"!=typeof e)throw new Ie(i);function p(t){var i=o,r=s;return o=s=n,h=t,l=e.apply(r,i)}function m(e){return h=e,c=Ao(y,t),d?p(e):l}function v(e){var i=e-u;return u===n||i>=t||i<0||f&&e-h>=a}function y(){var e=Ts();if(v(e))return _(e);c=Ao(y,function(e){var n=t-(e-u);return f?bn(n,a-(e-h)):n}(e))}function _(e){return c=n,g&&o?p(e):(o=s=n,l)}function b(){var e=Ts(),i=v(e);if(o=arguments,s=this,u=e,i){if(c===n)return m(u);if(f)return Sr(c),c=Ao(y,t),p(u)}return c===n&&(c=Ao(y,t)),l}return t=wa(t)||0,oa(r)&&(d=!!r.leading,a=(f="maxWait"in r)?_n(wa(r.maxWait)||0,t):a,g="trailing"in r?!!r.trailing:g),b.cancel=function(){c!==n&&Sr(c),h=0,o=u=s=c=n},b.flush=function(){return c===n?l:_(Ts())},b}var Fs=Zi((function(e,t){return hi(e,1,t)})),Bs=Zi((function(e,t,n){return hi(e,wa(t)||0,n)}));function Ws(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ie(i);var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var s=e.apply(this,i);return n.cache=o.set(r,s)||o,s};return n.cache=new(Ws.Cache||$n),n}function zs(e){if("function"!=typeof e)throw new Ie(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ws.Cache=$n;var Vs=wr((function(e,t){var n=(t=1==t.length&&Ys(t[0])?Mt(t[0],Xt(co())):Mt(yi(t,1),Xt(co()))).length;return Zi((function(i){for(var r=-1,o=bn(i.length,n);++r<o;)i[r]=t[r].call(this,i[r]);return xt(e,this,i)}))})),Us=Zi((function(e,t){var i=cn(t,lo(Us));return Qr(e,a,n,t,i)})),Hs=Zi((function(e,t){var i=cn(t,lo(Hs));return Qr(e,l,n,t,i)})),js=io((function(e,t){return Qr(e,u,n,n,n,t)}));function Gs(e,t){return e===t||e!=e&&t!=t}var Ks=qr(Li),qs=qr((function(e,t){return e>=t})),$s=Mi(function(){return arguments}())?Mi:function(e){return sa(e)&&Pe.call(e,"callee")&&!Ye.call(e,"callee")},Ys=se.isArray,Xs=yt?Xt(yt):function(e){return sa(e)&&ki(e)==A};function Zs(e){return null!=e&&ra(e.length)&&!na(e)}function Qs(e){return sa(e)&&Zs(e)}var Js=Gt||wl,ea=_t?Xt(_t):function(e){return sa(e)&&ki(e)==b};function ta(e){if(!sa(e))return!1;var t=ki(e);return t==w||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ca(e)}function na(e){if(!oa(e))return!1;var t=ki(e);return t==C||t==S||"[object AsyncFunction]"==t||"[object Proxy]"==t}function ia(e){return"number"==typeof e&&e==_a(e)}function ra(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function oa(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function sa(e){return null!=e&&"object"==typeof e}var aa=bt?Xt(bt):function(e){return sa(e)&&mo(e)==x};function la(e){return"number"==typeof e||sa(e)&&ki(e)==E}function ca(e){if(!sa(e)||ki(e)!=k)return!1;var t=qe(e);if(null===t)return!0;var n=Pe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Re.call(n)==ze}var ua=wt?Xt(wt):function(e){return sa(e)&&ki(e)==D};var ha=Ct?Xt(Ct):function(e){return sa(e)&&mo(e)==N};function da(e){return"string"==typeof e||!Ys(e)&&sa(e)&&ki(e)==I}function fa(e){return"symbol"==typeof e||sa(e)&&ki(e)==T}var ga=St?Xt(St):function(e){return sa(e)&&ra(e.length)&&!!ot[ki(e)]};var pa=qr(Wi),ma=qr((function(e,t){return e<=t}));function va(e){if(!e)return[];if(Zs(e))return da(e)?dn(e):Ir(e);if(tt&&e[tt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[tt]());var t=mo(e);return(t==x?an:t==N?un:Ga)(e)}function ya(e){return e?(e=wa(e))===h||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function _a(e){var t=ya(e),n=t%1;return t==t?n?t-n:t:0}function ba(e){return e?li(_a(e),0,g):0}function wa(e){if("number"==typeof e)return e;if(fa(e))return f;if(oa(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=oa(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Yt(e);var n=me.test(e);return n||ye.test(e)?ct(e.slice(2),n?2:8):pe.test(e)?f:+e}function Ca(e){return Tr(e,Fa(e))}function Sa(e){return null==e?"":ur(e)}var xa=Ar((function(e,t){if(Eo(t)||Zs(t))Tr(t,Pa(t),e);else for(var n in t)Pe.call(t,n)&&ni(e,n,t[n])})),Ea=Ar((function(e,t){Tr(t,Fa(t),e)})),ka=Ar((function(e,t,n,i){Tr(t,Fa(t),e,i)})),La=Ar((function(e,t,n,i){Tr(t,Pa(t),e,i)})),Da=io(ai);var Na=Zi((function(e,t){e=Le(e);var i=-1,r=t.length,o=r>2?t[2]:n;for(o&&wo(t[0],t[1],o)&&(r=1);++i<r;)for(var s=t[i],a=Fa(s),l=-1,c=a.length;++l<c;){var u=a[l],h=e[u];(h===n||Gs(h,Ae[u])&&!Pe.call(e,u))&&(e[u]=s[u])}return e})),Ia=Zi((function(e){return e.push(n,eo),xt(Wa,n,e)}));function Ta(e,t,i){var r=null==e?n:xi(e,t);return r===n?i:r}function Ma(e,t){return null!=e&&vo(e,t,Ni)}var Aa=Ur((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=We.call(t)),e[t]=n}),ol(ll)),Oa=Ur((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=We.call(t)),Pe.call(e,t)?e[t].push(n):e[t]=[n]}),co),Ra=Zi(Ti);function Pa(e){return Zs(e)?Zn(e):Fi(e)}function Fa(e){return Zs(e)?Zn(e,!0):Bi(e)}var Ba=Ar((function(e,t,n){Hi(e,t,n)})),Wa=Ar((function(e,t,n,i){Hi(e,t,n,i)})),za=io((function(e,t){var n={};if(null==e)return n;var i=!1;t=Mt(t,(function(t){return t=br(t,e),i||(i=t.length>1),t})),Tr(e,oo(e),n),i&&(n=ci(n,7,to));for(var r=t.length;r--;)dr(n,t[r]);return n}));var Va=io((function(e,t){return null==e?{}:function(e,t){return Ki(e,t,(function(t,n){return Ma(e,n)}))}(e,t)}));function Ua(e,t){if(null==e)return{};var n=Mt(oo(e),(function(e){return[e]}));return t=co(t),Ki(e,n,(function(e,n){return t(e,n[0])}))}var Ha=Zr(Pa),ja=Zr(Fa);function Ga(e){return null==e?[]:Zt(e,Pa(e))}var Ka=Fr((function(e,t,n){return t=t.toLowerCase(),e+(n?qa(t):t)}));function qa(e){return tl(Sa(e).toLowerCase())}function $a(e){return(e=Sa(e))&&e.replace(be,nn).replace(Qe,"")}var Ya=Fr((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Xa=Fr((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Za=Pr("toLowerCase");var Qa=Fr((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Ja=Fr((function(e,t,n){return e+(n?" ":"")+tl(t)}));var el=Fr((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),tl=Pr("toUpperCase");function nl(e,t,i){return e=Sa(e),(t=i?n:t)===n?function(e){return nt.test(e)}(e)?function(e){return e.match(et)||[]}(e):function(e){return e.match(ue)||[]}(e):e.match(t)||[]}var il=Zi((function(e,t){try{return xt(e,n,t)}catch(i){return ta(i)?i:new xe(i)}})),rl=io((function(e,t){return kt(t,(function(t){t=Uo(t),si(e,t,Os(e[t],e))})),e}));function ol(e){return function(){return e}}var sl=zr(),al=zr(!0);function ll(e){return e}function cl(e){return Pi("function"==typeof e?e:ci(e,1))}var ul=Zi((function(e,t){return function(n){return Ti(n,e,t)}})),hl=Zi((function(e,t){return function(n){return Ti(e,n,t)}}));function dl(e,t,n){var i=Pa(t),r=Si(t,i);null!=n||oa(t)&&(r.length||!i.length)||(n=t,t=e,e=this,r=Si(t,Pa(t)));var o=!(oa(n)&&"chain"in n&&!n.chain),s=na(e);return kt(r,(function(n){var i=t[n];e[n]=i,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),r=n.__actions__=Ir(this.__actions__);return r.push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,At([this.value()],arguments))})})),e}function fl(){}var gl=jr(Mt),pl=jr(Dt),ml=jr(Pt);function vl(e){return Co(e)?jt(Uo(e)):function(e){return function(t){return xi(t,e)}}(e)}var yl=Kr(),_l=Kr(!0);function bl(){return[]}function wl(){return!1}var Cl=Hr((function(e,t){return e+t}),0),Sl=Yr("ceil"),xl=Hr((function(e,t){return e/t}),1),El=Yr("floor");var kl,Ll=Hr((function(e,t){return e*t}),1),Dl=Yr("round"),Nl=Hr((function(e,t){return e-t}),0);return Vn.after=function(e,t){if("function"!=typeof t)throw new Ie(i);return e=_a(e),function(){if(--e<1)return t.apply(this,arguments)}},Vn.ary=Ms,Vn.assign=xa,Vn.assignIn=Ea,Vn.assignInWith=ka,Vn.assignWith=La,Vn.at=Da,Vn.before=As,Vn.bind=Os,Vn.bindAll=rl,Vn.bindKey=Rs,Vn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ys(e)?e:[e]},Vn.chain=vs,Vn.chunk=function(e,t,i){t=(i?wo(e,t,i):t===n)?1:_n(_a(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var o=0,s=0,a=se(mt(r/t));o<r;)a[s++]=rr(e,o,o+=t);return a},Vn.compact=function(e){for(var t=-1,n=null==e?0:e.length,i=0,r=[];++t<n;){var o=e[t];o&&(r[i++]=o)}return r},Vn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=se(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return At(Ys(n)?Ir(n):[n],yi(t,1))},Vn.cond=function(e){var t=null==e?0:e.length,n=co();return e=t?Mt(e,(function(e){if("function"!=typeof e[1])throw new Ie(i);return[n(e[0]),e[1]]})):[],Zi((function(n){for(var i=-1;++i<t;){var r=e[i];if(xt(r[0],this,n))return xt(r[1],this,n)}}))},Vn.conforms=function(e){return function(e){var t=Pa(e);return function(n){return ui(n,e,t)}}(ci(e,1))},Vn.constant=ol,Vn.countBy=bs,Vn.create=function(e,t){var n=Un(e);return null==t?n:oi(n,t)},Vn.curry=function e(t,i,r){var o=Qr(t,8,n,n,n,n,n,i=r?n:i);return o.placeholder=e.placeholder,o},Vn.curryRight=function e(t,i,r){var o=Qr(t,s,n,n,n,n,n,i=r?n:i);return o.placeholder=e.placeholder,o},Vn.debounce=Ps,Vn.defaults=Na,Vn.defaultsDeep=Ia,Vn.defer=Fs,Vn.delay=Bs,Vn.difference=Go,Vn.differenceBy=Ko,Vn.differenceWith=qo,Vn.drop=function(e,t,i){var r=null==e?0:e.length;return r?rr(e,(t=i||t===n?1:_a(t))<0?0:t,r):[]},Vn.dropRight=function(e,t,i){var r=null==e?0:e.length;return r?rr(e,0,(t=r-(t=i||t===n?1:_a(t)))<0?0:t):[]},Vn.dropRightWhile=function(e,t){return e&&e.length?gr(e,co(t,3),!0,!0):[]},Vn.dropWhile=function(e,t){return e&&e.length?gr(e,co(t,3),!0):[]},Vn.fill=function(e,t,i,r){var o=null==e?0:e.length;return o?(i&&"number"!=typeof i&&wo(e,t,i)&&(i=0,r=o),function(e,t,i,r){var o=e.length;for((i=_a(i))<0&&(i=-i>o?0:o+i),(r=r===n||r>o?o:_a(r))<0&&(r+=o),r=i>r?0:ba(r);i<r;)e[i++]=t;return e}(e,t,i,r)):[]},Vn.filter=function(e,t){return(Ys(e)?Nt:vi)(e,co(t,3))},Vn.flatMap=function(e,t){return yi(Ds(e,t),1)},Vn.flatMapDeep=function(e,t){return yi(Ds(e,t),h)},Vn.flatMapDepth=function(e,t,i){return i=i===n?1:_a(i),yi(Ds(e,t),i)},Vn.flatten=Xo,Vn.flattenDeep=function(e){return(null==e?0:e.length)?yi(e,h):[]},Vn.flattenDepth=function(e,t){return(null==e?0:e.length)?yi(e,t=t===n?1:_a(t)):[]},Vn.flip=function(e){return Qr(e,512)},Vn.flow=sl,Vn.flowRight=al,Vn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var r=e[t];i[r[0]]=r[1]}return i},Vn.functions=function(e){return null==e?[]:Si(e,Pa(e))},Vn.functionsIn=function(e){return null==e?[]:Si(e,Fa(e))},Vn.groupBy=Es,Vn.initial=function(e){return(null==e?0:e.length)?rr(e,0,-1):[]},Vn.intersection=Qo,Vn.intersectionBy=Jo,Vn.intersectionWith=es,Vn.invert=Aa,Vn.invertBy=Oa,Vn.invokeMap=ks,Vn.iteratee=cl,Vn.keyBy=Ls,Vn.keys=Pa,Vn.keysIn=Fa,Vn.map=Ds,Vn.mapKeys=function(e,t){var n={};return t=co(t,3),wi(e,(function(e,i,r){si(n,t(e,i,r),e)})),n},Vn.mapValues=function(e,t){var n={};return t=co(t,3),wi(e,(function(e,i,r){si(n,i,t(e,i,r))})),n},Vn.matches=function(e){return Vi(ci(e,1))},Vn.matchesProperty=function(e,t){return Ui(e,ci(t,1))},Vn.memoize=Ws,Vn.merge=Ba,Vn.mergeWith=Wa,Vn.method=ul,Vn.methodOf=hl,Vn.mixin=dl,Vn.negate=zs,Vn.nthArg=function(e){return e=_a(e),Zi((function(t){return ji(t,e)}))},Vn.omit=za,Vn.omitBy=function(e,t){return Ua(e,zs(co(t)))},Vn.once=function(e){return As(2,e)},Vn.orderBy=function(e,t,i,r){return null==e?[]:(Ys(t)||(t=null==t?[]:[t]),Ys(i=r?n:i)||(i=null==i?[]:[i]),Gi(e,t,i))},Vn.over=gl,Vn.overArgs=Vs,Vn.overEvery=pl,Vn.overSome=ml,Vn.partial=Us,Vn.partialRight=Hs,Vn.partition=Ns,Vn.pick=Va,Vn.pickBy=Ua,Vn.property=vl,Vn.propertyOf=function(e){return function(t){return null==e?n:xi(e,t)}},Vn.pull=ns,Vn.pullAll=is,Vn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?qi(e,t,co(n,2)):e},Vn.pullAllWith=function(e,t,i){return e&&e.length&&t&&t.length?qi(e,t,n,i):e},Vn.pullAt=rs,Vn.range=yl,Vn.rangeRight=_l,Vn.rearg=js,Vn.reject=function(e,t){return(Ys(e)?Nt:vi)(e,zs(co(t,3)))},Vn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],o=e.length;for(t=co(t,3);++i<o;){var s=e[i];t(s,i,e)&&(n.push(s),r.push(i))}return $i(e,r),n},Vn.rest=function(e,t){if("function"!=typeof e)throw new Ie(i);return Zi(e,t=t===n?t:_a(t))},Vn.reverse=os,Vn.sampleSize=function(e,t,i){return t=(i?wo(e,t,i):t===n)?1:_a(t),(Ys(e)?Jn:Ji)(e,t)},Vn.set=function(e,t,n){return null==e?e:er(e,t,n)},Vn.setWith=function(e,t,i,r){return r="function"==typeof r?r:n,null==e?e:er(e,t,i,r)},Vn.shuffle=function(e){return(Ys(e)?ei:ir)(e)},Vn.slice=function(e,t,i){var r=null==e?0:e.length;return r?(i&&"number"!=typeof i&&wo(e,t,i)?(t=0,i=r):(t=null==t?0:_a(t),i=i===n?r:_a(i)),rr(e,t,i)):[]},Vn.sortBy=Is,Vn.sortedUniq=function(e){return e&&e.length?lr(e):[]},Vn.sortedUniqBy=function(e,t){return e&&e.length?lr(e,co(t,2)):[]},Vn.split=function(e,t,i){return i&&"number"!=typeof i&&wo(e,t,i)&&(t=i=n),(i=i===n?g:i>>>0)?(e=Sa(e))&&("string"==typeof t||null!=t&&!ua(t))&&!(t=ur(t))&&sn(e)?Cr(dn(e),0,i):e.split(t,i):[]},Vn.spread=function(e,t){if("function"!=typeof e)throw new Ie(i);return t=null==t?0:_n(_a(t),0),Zi((function(n){var i=n[t],r=Cr(n,0,t);return i&&At(r,i),xt(e,this,r)}))},Vn.tail=function(e){var t=null==e?0:e.length;return t?rr(e,1,t):[]},Vn.take=function(e,t,i){return e&&e.length?rr(e,0,(t=i||t===n?1:_a(t))<0?0:t):[]},Vn.takeRight=function(e,t,i){var r=null==e?0:e.length;return r?rr(e,(t=r-(t=i||t===n?1:_a(t)))<0?0:t,r):[]},Vn.takeRightWhile=function(e,t){return e&&e.length?gr(e,co(t,3),!1,!0):[]},Vn.takeWhile=function(e,t){return e&&e.length?gr(e,co(t,3)):[]},Vn.tap=function(e,t){return t(e),e},Vn.throttle=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new Ie(i);return oa(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Ps(e,t,{leading:r,maxWait:t,trailing:o})},Vn.thru=ys,Vn.toArray=va,Vn.toPairs=Ha,Vn.toPairsIn=ja,Vn.toPath=function(e){return Ys(e)?Mt(e,Uo):fa(e)?[e]:Ir(Vo(Sa(e)))},Vn.toPlainObject=Ca,Vn.transform=function(e,t,n){var i=Ys(e),r=i||Js(e)||ga(e);if(t=co(t,4),null==n){var o=e&&e.constructor;n=r?i?new o:[]:oa(e)&&na(o)?Un(qe(e)):{}}return(r?kt:wi)(e,(function(e,i,r){return t(n,e,i,r)})),n},Vn.unary=function(e){return Ms(e,1)},Vn.union=ss,Vn.unionBy=as,Vn.unionWith=ls,Vn.uniq=function(e){return e&&e.length?hr(e):[]},Vn.uniqBy=function(e,t){return e&&e.length?hr(e,co(t,2)):[]},Vn.uniqWith=function(e,t){return t="function"==typeof t?t:n,e&&e.length?hr(e,n,t):[]},Vn.unset=function(e,t){return null==e||dr(e,t)},Vn.unzip=cs,Vn.unzipWith=us,Vn.update=function(e,t,n){return null==e?e:fr(e,t,_r(n))},Vn.updateWith=function(e,t,i,r){return r="function"==typeof r?r:n,null==e?e:fr(e,t,_r(i),r)},Vn.values=Ga,Vn.valuesIn=function(e){return null==e?[]:Zt(e,Fa(e))},Vn.without=hs,Vn.words=nl,Vn.wrap=function(e,t){return Us(_r(t),e)},Vn.xor=ds,Vn.xorBy=fs,Vn.xorWith=gs,Vn.zip=ps,Vn.zipObject=function(e,t){return vr(e||[],t||[],ni)},Vn.zipObjectDeep=function(e,t){return vr(e||[],t||[],er)},Vn.zipWith=ms,Vn.entries=Ha,Vn.entriesIn=ja,Vn.extend=Ea,Vn.extendWith=ka,dl(Vn,Vn),Vn.add=Cl,Vn.attempt=il,Vn.camelCase=Ka,Vn.capitalize=qa,Vn.ceil=Sl,Vn.clamp=function(e,t,i){return i===n&&(i=t,t=n),i!==n&&(i=(i=wa(i))==i?i:0),t!==n&&(t=(t=wa(t))==t?t:0),li(wa(e),t,i)},Vn.clone=function(e){return ci(e,4)},Vn.cloneDeep=function(e){return ci(e,5)},Vn.cloneDeepWith=function(e,t){return ci(e,5,t="function"==typeof t?t:n)},Vn.cloneWith=function(e,t){return ci(e,4,t="function"==typeof t?t:n)},Vn.conformsTo=function(e,t){return null==t||ui(e,t,Pa(t))},Vn.deburr=$a,Vn.defaultTo=function(e,t){return null==e||e!=e?t:e},Vn.divide=xl,Vn.endsWith=function(e,t,i){e=Sa(e),t=ur(t);var r=e.length,o=i=i===n?r:li(_a(i),0,r);return(i-=t.length)>=0&&e.slice(i,o)==t},Vn.eq=Gs,Vn.escape=function(e){return(e=Sa(e))&&X.test(e)?e.replace($,rn):e},Vn.escapeRegExp=function(e){return(e=Sa(e))&&re.test(e)?e.replace(ie,"\\$&"):e},Vn.every=function(e,t,i){var r=Ys(e)?Dt:pi;return i&&wo(e,t,i)&&(t=n),r(e,co(t,3))},Vn.find=ws,Vn.findIndex=$o,Vn.findKey=function(e,t){return Bt(e,co(t,3),wi)},Vn.findLast=Cs,Vn.findLastIndex=Yo,Vn.findLastKey=function(e,t){return Bt(e,co(t,3),Ci)},Vn.floor=El,Vn.forEach=Ss,Vn.forEachRight=xs,Vn.forIn=function(e,t){return null==e?e:_i(e,co(t,3),Fa)},Vn.forInRight=function(e,t){return null==e?e:bi(e,co(t,3),Fa)},Vn.forOwn=function(e,t){return e&&wi(e,co(t,3))},Vn.forOwnRight=function(e,t){return e&&Ci(e,co(t,3))},Vn.get=Ta,Vn.gt=Ks,Vn.gte=qs,Vn.has=function(e,t){return null!=e&&vo(e,t,Di)},Vn.hasIn=Ma,Vn.head=Zo,Vn.identity=ll,Vn.includes=function(e,t,n,i){e=Zs(e)?e:Ga(e),n=n&&!i?_a(n):0;var r=e.length;return n<0&&(n=_n(r+n,0)),da(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&zt(e,t,n)>-1},Vn.indexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:_a(n);return r<0&&(r=_n(i+r,0)),zt(e,t,r)},Vn.inRange=function(e,t,i){return t=ya(t),i===n?(i=t,t=0):i=ya(i),function(e,t,n){return e>=bn(t,n)&&e<_n(t,n)}(e=wa(e),t,i)},Vn.invoke=Ra,Vn.isArguments=$s,Vn.isArray=Ys,Vn.isArrayBuffer=Xs,Vn.isArrayLike=Zs,Vn.isArrayLikeObject=Qs,Vn.isBoolean=function(e){return!0===e||!1===e||sa(e)&&ki(e)==_},Vn.isBuffer=Js,Vn.isDate=ea,Vn.isElement=function(e){return sa(e)&&1===e.nodeType&&!ca(e)},Vn.isEmpty=function(e){if(null==e)return!0;if(Zs(e)&&(Ys(e)||"string"==typeof e||"function"==typeof e.splice||Js(e)||ga(e)||$s(e)))return!e.length;var t=mo(e);if(t==x||t==N)return!e.size;if(Eo(e))return!Fi(e).length;for(var n in e)if(Pe.call(e,n))return!1;return!0},Vn.isEqual=function(e,t){return Ai(e,t)},Vn.isEqualWith=function(e,t,i){var r=(i="function"==typeof i?i:n)?i(e,t):n;return r===n?Ai(e,t,n,i):!!r},Vn.isError=ta,Vn.isFinite=function(e){return"number"==typeof e&&mn(e)},Vn.isFunction=na,Vn.isInteger=ia,Vn.isLength=ra,Vn.isMap=aa,Vn.isMatch=function(e,t){return e===t||Oi(e,t,ho(t))},Vn.isMatchWith=function(e,t,i){return i="function"==typeof i?i:n,Oi(e,t,ho(t),i)},Vn.isNaN=function(e){return la(e)&&e!=+e},Vn.isNative=function(e){if(xo(e))throw new xe("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ri(e)},Vn.isNil=function(e){return null==e},Vn.isNull=function(e){return null===e},Vn.isNumber=la,Vn.isObject=oa,Vn.isObjectLike=sa,Vn.isPlainObject=ca,Vn.isRegExp=ua,Vn.isSafeInteger=function(e){return ia(e)&&e>=-9007199254740991&&e<=d},Vn.isSet=ha,Vn.isString=da,Vn.isSymbol=fa,Vn.isTypedArray=ga,Vn.isUndefined=function(e){return e===n},Vn.isWeakMap=function(e){return sa(e)&&mo(e)==M},Vn.isWeakSet=function(e){return sa(e)&&"[object WeakSet]"==ki(e)},Vn.join=function(e,t){return null==e?"":vn.call(e,t)},Vn.kebabCase=Ya,Vn.last=ts,Vn.lastIndexOf=function(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var o=r;return i!==n&&(o=(o=_a(i))<0?_n(r+o,0):bn(o,r-1)),t==t?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(e,t,o):Wt(e,Ut,o,!0)},Vn.lowerCase=Xa,Vn.lowerFirst=Za,Vn.lt=pa,Vn.lte=ma,Vn.max=function(e){return e&&e.length?mi(e,ll,Li):n},Vn.maxBy=function(e,t){return e&&e.length?mi(e,co(t,2),Li):n},Vn.mean=function(e){return Ht(e,ll)},Vn.meanBy=function(e,t){return Ht(e,co(t,2))},Vn.min=function(e){return e&&e.length?mi(e,ll,Wi):n},Vn.minBy=function(e,t){return e&&e.length?mi(e,co(t,2),Wi):n},Vn.stubArray=bl,Vn.stubFalse=wl,Vn.stubObject=function(){return{}},Vn.stubString=function(){return""},Vn.stubTrue=function(){return!0},Vn.multiply=Ll,Vn.nth=function(e,t){return e&&e.length?ji(e,_a(t)):n},Vn.noConflict=function(){return dt._===this&&(dt._=Ve),this},Vn.noop=fl,Vn.now=Ts,Vn.pad=function(e,t,n){e=Sa(e);var i=(t=_a(t))?hn(e):0;if(!t||i>=t)return e;var r=(t-i)/2;return Gr(vt(r),n)+e+Gr(mt(r),n)},Vn.padEnd=function(e,t,n){e=Sa(e);var i=(t=_a(t))?hn(e):0;return t&&i<t?e+Gr(t-i,n):e},Vn.padStart=function(e,t,n){e=Sa(e);var i=(t=_a(t))?hn(e):0;return t&&i<t?Gr(t-i,n)+e:e},Vn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Cn(Sa(e).replace(oe,""),t||0)},Vn.random=function(e,t,i){if(i&&"boolean"!=typeof i&&wo(e,t,i)&&(t=i=n),i===n&&("boolean"==typeof t?(i=t,t=n):"boolean"==typeof e&&(i=e,e=n)),e===n&&t===n?(e=0,t=1):(e=ya(e),t===n?(t=e,e=0):t=ya(t)),e>t){var r=e;e=t,t=r}if(i||e%1||t%1){var o=Sn();return bn(e+o*(t-e+lt("1e-"+((o+"").length-1))),t)}return Yi(e,t)},Vn.reduce=function(e,t,n){var i=Ys(e)?Ot:Kt,r=arguments.length<3;return i(e,co(t,4),n,r,fi)},Vn.reduceRight=function(e,t,n){var i=Ys(e)?Rt:Kt,r=arguments.length<3;return i(e,co(t,4),n,r,gi)},Vn.repeat=function(e,t,i){return t=(i?wo(e,t,i):t===n)?1:_a(t),Xi(Sa(e),t)},Vn.replace=function(){var e=arguments,t=Sa(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Vn.result=function(e,t,i){var r=-1,o=(t=br(t,e)).length;for(o||(o=1,e=n);++r<o;){var s=null==e?n:e[Uo(t[r])];s===n&&(r=o,s=i),e=na(s)?s.call(e):s}return e},Vn.round=Dl,Vn.runInContext=e,Vn.sample=function(e){return(Ys(e)?Qn:Qi)(e)},Vn.size=function(e){if(null==e)return 0;if(Zs(e))return da(e)?hn(e):e.length;var t=mo(e);return t==x||t==N?e.size:Fi(e).length},Vn.snakeCase=Qa,Vn.some=function(e,t,i){var r=Ys(e)?Pt:or;return i&&wo(e,t,i)&&(t=n),r(e,co(t,3))},Vn.sortedIndex=function(e,t){return sr(e,t)},Vn.sortedIndexBy=function(e,t,n){return ar(e,t,co(n,2))},Vn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var i=sr(e,t);if(i<n&&Gs(e[i],t))return i}return-1},Vn.sortedLastIndex=function(e,t){return sr(e,t,!0)},Vn.sortedLastIndexBy=function(e,t,n){return ar(e,t,co(n,2),!0)},Vn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=sr(e,t,!0)-1;if(Gs(e[n],t))return n}return-1},Vn.startCase=Ja,Vn.startsWith=function(e,t,n){return e=Sa(e),n=null==n?0:li(_a(n),0,e.length),t=ur(t),e.slice(n,n+t.length)==t},Vn.subtract=Nl,Vn.sum=function(e){return e&&e.length?qt(e,ll):0},Vn.sumBy=function(e,t){return e&&e.length?qt(e,co(t,2)):0},Vn.template=function(e,t,i){var r=Vn.templateSettings;i&&wo(e,t,i)&&(t=n),e=Sa(e),t=ka({},t,r,Jr);var o,s,a=ka({},t.imports,r.imports,Jr),l=Pa(a),c=Zt(a,l),u=0,h=t.interpolate||we,d="__p += '",f=De((t.escape||we).source+"|"+h.source+"|"+(h===J?fe:we).source+"|"+(t.evaluate||we).source+"|$","g"),g="//# sourceURL="+(Pe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++rt+"]")+"\n";e.replace(f,(function(t,n,i,r,a,l){return i||(i=r),d+=e.slice(u,l).replace(Ce,on),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),d+="';\n";var p=Pe.call(t,"variable")&&t.variable;if(p){if(he.test(p))throw new xe("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(s?d.replace(j,""):d).replace(G,"$1").replace(K,"$1;"),d="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=il((function(){return Ee(l,g+"return "+d).apply(n,c)}));if(m.source=d,ta(m))throw m;return m},Vn.times=function(e,t){if((e=_a(e))<1||e>d)return[];var n=g,i=bn(e,g);t=co(t),e-=g;for(var r=$t(i,t);++n<e;)t(n);return r},Vn.toFinite=ya,Vn.toInteger=_a,Vn.toLength=ba,Vn.toLower=function(e){return Sa(e).toLowerCase()},Vn.toNumber=wa,Vn.toSafeInteger=function(e){return e?li(_a(e),-9007199254740991,d):0===e?e:0},Vn.toString=Sa,Vn.toUpper=function(e){return Sa(e).toUpperCase()},Vn.trim=function(e,t,i){if((e=Sa(e))&&(i||t===n))return Yt(e);if(!e||!(t=ur(t)))return e;var r=dn(e),o=dn(t);return Cr(r,Jt(r,o),en(r,o)+1).join("")},Vn.trimEnd=function(e,t,i){if((e=Sa(e))&&(i||t===n))return e.slice(0,fn(e)+1);if(!e||!(t=ur(t)))return e;var r=dn(e);return Cr(r,0,en(r,dn(t))+1).join("")},Vn.trimStart=function(e,t,i){if((e=Sa(e))&&(i||t===n))return e.replace(oe,"");if(!e||!(t=ur(t)))return e;var r=dn(e);return Cr(r,Jt(r,dn(t))).join("")},Vn.truncate=function(e,t){var i=30,r="...";if(oa(t)){var o="separator"in t?t.separator:o;i="length"in t?_a(t.length):i,r="omission"in t?ur(t.omission):r}var s=(e=Sa(e)).length;if(sn(e)){var a=dn(e);s=a.length}if(i>=s)return e;var l=i-hn(r);if(l<1)return r;var c=a?Cr(a,0,l).join(""):e.slice(0,l);if(o===n)return c+r;if(a&&(l+=c.length-l),ua(o)){if(e.slice(l).search(o)){var u,h=c;for(o.global||(o=De(o.source,Sa(ge.exec(o))+"g")),o.lastIndex=0;u=o.exec(h);)var d=u.index;c=c.slice(0,d===n?l:d)}}else if(e.indexOf(ur(o),l)!=l){var f=c.lastIndexOf(o);f>-1&&(c=c.slice(0,f))}return c+r},Vn.unescape=function(e){return(e=Sa(e))&&Y.test(e)?e.replace(q,gn):e},Vn.uniqueId=function(e){var t=++Fe;return Sa(e)+t},Vn.upperCase=el,Vn.upperFirst=tl,Vn.each=Ss,Vn.eachRight=xs,Vn.first=Zo,dl(Vn,(kl={},wi(Vn,(function(e,t){Pe.call(Vn.prototype,t)||(kl[t]=e)})),kl),{chain:!1}),Vn.VERSION="4.17.21",kt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Vn[e].placeholder=Vn})),kt(["drop","take"],(function(e,t){Gn.prototype[e]=function(i){i=i===n?1:_n(_a(i),0);var r=this.__filtered__&&!t?new Gn(this):this.clone();return r.__filtered__?r.__takeCount__=bn(i,r.__takeCount__):r.__views__.push({size:bn(i,g),type:e+(r.__dir__<0?"Right":"")}),r},Gn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),kt(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=1==n||3==n;Gn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:co(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}})),kt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Gn.prototype[e]=function(){return this[n](1).value()[0]}})),kt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Gn.prototype[e]=function(){return this.__filtered__?new Gn(this):this[n](1)}})),Gn.prototype.compact=function(){return this.filter(ll)},Gn.prototype.find=function(e){return this.filter(e).head()},Gn.prototype.findLast=function(e){return this.reverse().find(e)},Gn.prototype.invokeMap=Zi((function(e,t){return"function"==typeof e?new Gn(this):this.map((function(n){return Ti(n,e,t)}))})),Gn.prototype.reject=function(e){return this.filter(zs(co(e)))},Gn.prototype.slice=function(e,t){e=_a(e);var i=this;return i.__filtered__&&(e>0||t<0)?new Gn(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==n&&(i=(t=_a(t))<0?i.dropRight(-t):i.take(t-e)),i)},Gn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Gn.prototype.toArray=function(){return this.take(g)},wi(Gn.prototype,(function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Vn[r?"take"+("last"==t?"Right":""):t],s=r||/^find/.test(t);o&&(Vn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,l=t instanceof Gn,c=a[0],u=l||Ys(t),h=function(e){var t=o.apply(Vn,At([e],a));return r&&d?t[0]:t};u&&i&&"function"==typeof c&&1!=c.length&&(l=u=!1);var d=this.__chain__,f=!!this.__actions__.length,g=s&&!d,p=l&&!f;if(!s&&u){t=p?t:new Gn(this);var m=e.apply(t,a);return m.__actions__.push({func:ys,args:[h],thisArg:n}),new jn(m,d)}return g&&p?e.apply(this,a):(m=this.thru(h),g?r?m.value()[0]:m.value():m)})})),kt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Te[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);Vn.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var r=this.value();return t.apply(Ys(r)?r:[],e)}return this[n]((function(n){return t.apply(Ys(n)?n:[],e)}))}})),wi(Gn.prototype,(function(e,t){var n=Vn[t];if(n){var i=n.name+"";Pe.call(Mn,i)||(Mn[i]=[]),Mn[i].push({name:t,func:n})}})),Mn[Vr(n,2).name]=[{name:"wrapper",func:n}],Gn.prototype.clone=function(){var e=new Gn(this.__wrapped__);return e.__actions__=Ir(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ir(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ir(this.__views__),e},Gn.prototype.reverse=function(){if(this.__filtered__){var e=new Gn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Gn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ys(e),i=t<0,r=n?e.length:0,o=function(e,t,n){var i=-1,r=n.length;for(;++i<r;){var o=n[i],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=bn(t,e+s);break;case"takeRight":e=_n(e,t-s)}}return{start:e,end:t}}(0,r,this.__views__),s=o.start,a=o.end,l=a-s,c=i?a:s-1,u=this.__iteratees__,h=u.length,d=0,f=bn(l,this.__takeCount__);if(!n||!i&&r==l&&f==l)return pr(e,this.__actions__);var g=[];e:for(;l--&&d<f;){for(var p=-1,m=e[c+=t];++p<h;){var v=u[p],y=v.iteratee,_=v.type,b=y(m);if(2==_)m=b;else if(!b){if(1==_)continue e;break e}}g[d++]=m}return g},Vn.prototype.at=_s,Vn.prototype.chain=function(){return vs(this)},Vn.prototype.commit=function(){return new jn(this.value(),this.__chain__)},Vn.prototype.next=function(){this.__values__===n&&(this.__values__=va(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?n:this.__values__[this.__index__++]}},Vn.prototype.plant=function(e){for(var t,i=this;i instanceof Hn;){var r=jo(i);r.__index__=0,r.__values__=n,t?o.__wrapped__=r:t=r;var o=r;i=i.__wrapped__}return o.__wrapped__=e,t},Vn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Gn){var t=e;return this.__actions__.length&&(t=new Gn(this)),(t=t.reverse()).__actions__.push({func:ys,args:[os],thisArg:n}),new jn(t,this.__chain__)}return this.thru(os)},Vn.prototype.toJSON=Vn.prototype.valueOf=Vn.prototype.value=function(){return pr(this.__wrapped__,this.__actions__)},Vn.prototype.first=Vn.prototype.head,tt&&(Vn.prototype[tt]=function(){return this}),Vn}();gt?((gt.exports=pn)._=pn,ft._=pn):dt._=pn}).call(y)}(Pw,Pw.exports),"function"==typeof R)try{Rw=Pw.exports}catch(zWe){}Rw||(Rw=window._);var Fw=Rw,Bw=Fw,Ww=zw;function zw(e){this._isDirected=!Bw.has(e,"directed")||e.directed,this._isMultigraph=!!Bw.has(e,"multigraph")&&e.multigraph,this._isCompound=!!Bw.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=Bw.constant(void 0),this._defaultEdgeLabelFn=Bw.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function Vw(e,t){e[t]?e[t]++:e[t]=1}function Uw(e,t){--e[t]||delete e[t]}function Hw(e,t,n,i){var r=""+t,o=""+n;if(!e&&r>o){var s=r;r=o,o=s}return r+""+o+""+(Bw.isUndefined(i)?"\0":i)}function jw(e,t,n,i){var r=""+t,o=""+n;if(!e&&r>o){var s=r;r=o,o=s}var a={v:r,w:o};return i&&(a.name=i),a}function Gw(e,t){return Hw(e,t.v,t.w,t.name)}zw.prototype._nodeCount=0,zw.prototype._edgeCount=0,zw.prototype.isDirected=function(){return this._isDirected},zw.prototype.isMultigraph=function(){return this._isMultigraph},zw.prototype.isCompound=function(){return this._isCompound},zw.prototype.setGraph=function(e){return this._label=e,this},zw.prototype.graph=function(){return this._label},zw.prototype.setDefaultNodeLabel=function(e){return Bw.isFunction(e)||(e=Bw.constant(e)),this._defaultNodeLabelFn=e,this},zw.prototype.nodeCount=function(){return this._nodeCount},zw.prototype.nodes=function(){return Bw.keys(this._nodes)},zw.prototype.sources=function(){return Bw.filter(this.nodes(),Bw.bind((function(e){return Bw.isEmpty(this._in[e])}),this))},zw.prototype.sinks=function(){return Bw.filter(this.nodes(),Bw.bind((function(e){return Bw.isEmpty(this._out[e])}),this))},zw.prototype.setNodes=function(e,t){var n=arguments;return Bw.each(e,Bw.bind((function(e){n.length>1?this.setNode(e,t):this.setNode(e)}),this)),this},zw.prototype.setNode=function(e,t){return Bw.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},zw.prototype.node=function(e){return this._nodes[e]},zw.prototype.hasNode=function(e){return Bw.has(this._nodes,e)},zw.prototype.removeNode=function(e){var t=this;if(Bw.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],Bw.each(this.children(e),Bw.bind((function(e){this.setParent(e)}),this)),delete this._children[e]),Bw.each(Bw.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],Bw.each(Bw.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},zw.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Bw.isUndefined(t))t="\0";else{for(var n=t+="";!Bw.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},zw.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},zw.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if("\0"!==t)return t}},zw.prototype.children=function(e){if(Bw.isUndefined(e)&&(e="\0"),this._isCompound){var t=this._children[e];if(t)return Bw.keys(t)}else{if("\0"===e)return this.nodes();if(this.hasNode(e))return[]}},zw.prototype.predecessors=function(e){var t=this._preds[e];if(t)return Bw.keys(t)},zw.prototype.successors=function(e){var t=this._sucs[e];if(t)return Bw.keys(t)},zw.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return Bw.union(t,this.successors(e))},zw.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},zw.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph()),Bw.each(this._nodes,Bw.bind((function(n,i){e(i)&&t.setNode(i,n)}),this)),Bw.each(this._edgeObjs,Bw.bind((function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,this.edge(e))}),this));var n=this,i={};function r(e){var o=n.parent(e);return void 0===o||t.hasNode(o)?(i[e]=o,o):o in i?i[o]:r(o)}return this._isCompound&&Bw.each(t.nodes(),(function(e){t.setParent(e,r(e))})),t},zw.prototype.setDefaultEdgeLabel=function(e){return Bw.isFunction(e)||(e=Bw.constant(e)),this._defaultEdgeLabelFn=e,this},zw.prototype.edgeCount=function(){return this._edgeCount},zw.prototype.edges=function(){return Bw.values(this._edgeObjs)},zw.prototype.setPath=function(e,t){var n=this,i=arguments;return Bw.reduce(e,(function(e,r){return i.length>1?n.setEdge(e,r,t):n.setEdge(e,r),r})),this},zw.prototype.setEdge=function(){var e,t,n,i,r=!1,o=arguments[0];"object"==typeof o&&null!==o&&"v"in o?(e=o.v,t=o.w,n=o.name,2===arguments.length&&(i=arguments[1],r=!0)):(e=o,t=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],r=!0)),e=""+e,t=""+t,Bw.isUndefined(n)||(n=""+n);var s=Hw(this._isDirected,e,t,n);if(Bw.has(this._edgeLabels,s))return r&&(this._edgeLabels[s]=i),this;if(!Bw.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[s]=r?i:this._defaultEdgeLabelFn(e,t,n);var a=jw(this._isDirected,e,t,n);return e=a.v,t=a.w,Object.freeze(a),this._edgeObjs[s]=a,Vw(this._preds[t],e),Vw(this._sucs[e],t),this._in[t][s]=a,this._out[e][s]=a,this._edgeCount++,this},zw.prototype.edge=function(e,t,n){var i=1===arguments.length?Gw(this._isDirected,arguments[0]):Hw(this._isDirected,e,t,n);return this._edgeLabels[i]},zw.prototype.hasEdge=function(e,t,n){var i=1===arguments.length?Gw(this._isDirected,arguments[0]):Hw(this._isDirected,e,t,n);return Bw.has(this._edgeLabels,i)},zw.prototype.removeEdge=function(e,t,n){var i=1===arguments.length?Gw(this._isDirected,arguments[0]):Hw(this._isDirected,e,t,n),r=this._edgeObjs[i];return r&&(e=r.v,t=r.w,delete this._edgeLabels[i],delete this._edgeObjs[i],Uw(this._preds[t],e),Uw(this._sucs[e],t),delete this._in[t][i],delete this._out[e][i],this._edgeCount--),this},zw.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var i=Bw.values(n);return t?Bw.filter(i,(function(e){return e.v===t})):i}},zw.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var i=Bw.values(n);return t?Bw.filter(i,(function(e){return e.w===t})):i}},zw.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))};var Kw={Graph:Ww,version:"2.1.4"},qw=Fw,$w=Ww,Yw={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:Xw(e),edges:Zw(e)};qw.isUndefined(e.graph())||(t.value=qw.clone(e.graph()));return t},read:function(e){var t=new $w(e.options).setGraph(e.value);return qw.each(e.nodes,(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),qw.each(e.edges,(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}};function Xw(e){return qw.map(e.nodes(),(function(t){var n=e.node(t),i=e.parent(t),r={v:t};return qw.isUndefined(n)||(r.value=n),qw.isUndefined(i)||(r.parent=i),r}))}function Zw(e){return qw.map(e.edges(),(function(t){var n=e.edge(t),i={v:t.v,w:t.w};return qw.isUndefined(t.name)||(i.name=t.name),qw.isUndefined(n)||(i.value=n),i}))}var Qw=Fw,Jw=function(e){var t,n={},i=[];function r(i){Qw.has(n,i)||(n[i]=!0,t.push(i),Qw.each(e.successors(i),r),Qw.each(e.predecessors(i),r))}return Qw.each(e.nodes(),(function(e){t=[],r(e),t.length&&i.push(t)})),i};var eC=Fw,tC=nC;function nC(){this._arr=[],this._keyIndices={}}nC.prototype.size=function(){return this._arr.length},nC.prototype.keys=function(){return this._arr.map((function(e){return e.key}))},nC.prototype.has=function(e){return eC.has(this._keyIndices,e)},nC.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},nC.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},nC.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!eC.has(n,e)){var i=this._arr,r=i.length;return n[e]=r,i.push({key:e,priority:t}),this._decrease(r),!0}return!1},nC.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},nC.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},nC.prototype._heapify=function(e){var t=this._arr,n=2*e,i=n+1,r=e;n<t.length&&(r=t[n].priority<t[r].priority?n:r,i<t.length&&(r=t[i].priority<t[r].priority?i:r),r!==e&&(this._swap(e,r),this._heapify(r)))},nC.prototype._decrease=function(e){for(var t,n=this._arr,i=n[e].priority;0!==e&&!(n[t=e>>1].priority<i);)this._swap(e,t),e=t},nC.prototype._swap=function(e,t){var n=this._arr,i=this._keyIndices,r=n[e],o=n[t];n[e]=o,n[t]=r,i[o.key]=e,i[r.key]=t};var iC=tC,rC=function(e,t,n,i){return function(e,t,n,i){var r,o,s={},a=new iC,l=function(e){var t=e.v!==r?e.v:e.w,i=s[t],l=n(e),c=o.distance+l;if(l<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+l);c<i.distance&&(i.distance=c,i.predecessor=r,a.decrease(t,c))};e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;s[e]={distance:n},a.add(e,n)}));for(;a.size()>0&&(r=a.removeMin(),(o=s[r]).distance!==Number.POSITIVE_INFINITY);)i(r).forEach(l);return s}(e,String(t),n||oC,i||function(t){return e.outEdges(t)})},oC=Fw.constant(1);var sC=rC,aC=Fw,lC=function(e,t,n){return aC.transform(e.nodes(),(function(i,r){i[r]=sC(e,r,t,n)}),{})};var cC=Fw,uC=function(e){var t=0,n=[],i={},r=[];function o(s){var a=i[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach((function(e){cC.has(i,e)?i[e].onStack&&(a.lowlink=Math.min(a.lowlink,i[e].index)):(o(e),a.lowlink=Math.min(a.lowlink,i[e].lowlink))})),a.lowlink===a.index){var l,c=[];do{l=n.pop(),i[l].onStack=!1,c.push(l)}while(s!==l);r.push(c)}}return e.nodes().forEach((function(e){cC.has(i,e)||o(e)})),r};var hC=Fw,dC=uC,fC=function(e){return hC.filter(dC(e),(function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))};var gC=function(e,t,n){return function(e,t,n){var i={},r=e.nodes();return r.forEach((function(e){i[e]={},i[e][e]={distance:0},r.forEach((function(t){e!==t&&(i[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var r=n.v===e?n.w:n.v,o=t(n);i[e][r]={distance:o,predecessor:e}}))})),r.forEach((function(e){var t=i[e];r.forEach((function(n){var o=i[n];r.forEach((function(n){var i=o[e],r=t[n],s=o[n],a=i.distance+r.distance;a<s.distance&&(s.distance=a,s.predecessor=r.predecessor)}))}))})),i}(e,t||pC,n||function(t){return e.outEdges(t)})},pC=Fw.constant(1);var mC=Fw,vC=yC;function yC(e){var t={},n={},i=[];if(mC.each(e.sinks(),(function r(o){if(mC.has(n,o))throw new _C;mC.has(t,o)||(n[o]=!0,t[o]=!0,mC.each(e.predecessors(o),r),delete n[o],i.push(o))})),mC.size(t)!==e.nodeCount())throw new _C;return i}function _C(){}yC.CycleException=_C;var bC=vC;var wC=Fw,CC=function(e,t,n){wC.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),r=[],o={};return wC.each(t,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);SC(e,t,"post"===n,o,i,r)})),r};function SC(e,t,n,i,r,o){wC.has(i,t)||(i[t]=!0,n||o.push(t),wC.each(r(t),(function(t){SC(e,t,n,i,r,o)})),n&&o.push(t))}var xC=CC;var EC=CC;var kC=Fw,LC=Ww,DC=tC;let NC={Graph:Kw.Graph,json:Yw,alg:{components:Jw,dijkstra:rC,dijkstraAll:lC,findCycles:fC,floydWarshall:gC,isAcyclic:function(e){try{bC(e)}catch(zWe){if(zWe instanceof bC.CycleException)return!1;throw zWe}return!0},postorder:function(e,t){return xC(e,t,"post")},preorder:function(e,t){return EC(e,t,"pre")},prim:function(e,t){var n,i=new LC,r={},o=new DC;function s(e){var i=e.v===n?e.w:e.v,s=o.priority(i);if(void 0!==s){var a=t(e);a<s&&(r[i]=n,o.decrease(i,a))}}if(0===e.nodeCount())return i;kC.each(e.nodes(),(function(e){o.add(e,Number.POSITIVE_INFINITY),i.setNode(e)})),o.decrease(e.nodes()[0],0);var a=!1;for(;o.size()>0;){if(n=o.removeMin(),kC.has(r,n))i.setEdge(n,r[n]);else{if(a)throw new Error("Input graph is not connected: "+e);a=!0}e.nodeEdges(n).forEach(s)}return i},tarjan:uC,topsort:vC},version:Kw.version};NC||"undefined"==typeof window||(NC=window.graphlib),Array.prototype.flat||(Array.prototype.flat=function(e){let t=e||1;if(!isFinite(t))return;const n=this.length;let i=[];if(0===this.length)return this;for(;t--;){const e=[];let r=!1;if(0===i.length){r=!0;for(let e=0;e<n;e++)this[e]instanceof Array?i.push(...this[e]):i.push(this[e])}else{for(let t=0;t<i.length;t++)i[t]instanceof Array?(r=!0,e.push(...i[t])):e.push(i[t]);i=e}if(!r&&t===1/0)break}return i});var IC=NC;const TC=e=>{e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev},MC=(e,t)=>{if("_next"!==e&&"_prev"!==e)return t};class AC{constructor(){const e={};e._next=e._prev=e,this.isentinel=e}dequeue(){const e=this.isentinel,t=e._prev;if(t!==e)return TC(t),t}enqueue(){const e=this.isentinel,t=e._prev;if(t!==e)return TC(t),t}toString(){const e=[],t=this.isentinel;let n=t._prev;for(;n!==t;)e.push(JSON.stringify(n,MC)),n=n._prev;return`[${e.join(", ")}]`}}const OC=IC.Graph,RC=()=>1,PC=(e,t,n)=>{let i=[];const r=t[t.length-1],o=t[0];let s;for(;e.nodeCount();){for(;s=o.dequeue();)FC(e,t,n,s);for(;s=r.dequeue();)FC(e,t,n,s);if(e.nodeCount())for(let r=t.length-2;r>0;--r)if(s=t[r].dequeue(),s){i=i.concat(FC(e,t,n,s,!0));break}}return i},FC=(e,t,n,i,r)=>{var o,s;const a=r?[]:void 0;return null===(o=e.inEdges(i.v))||void 0===o||o.forEach((i=>{const o=e.edge(i),s=e.node(i.v);r&&a.push({v:i.v,w:i.w}),void 0===s.out&&(s.out=0),s.out-=o,WC(t,n,s)})),null===(s=e.outEdges(i.v))||void 0===s||s.forEach((i=>{const r=e.edge(i),o=i.w,s=e.node(o);void 0===s.in&&(s.in=0),s.in-=r,WC(t,n,s)})),e.removeNode(i.v),a},BC=(e,t)=>{const n=new OC;let i=0,r=0;e.nodes().forEach((e=>{n.setNode(e,{v:e,in:0,out:0})})),e.edges().forEach((e=>{const o=n.edge(e.v,e.w)||0,s=null==t?void 0:t(e),a=o+s;n.setEdge(e.v,e.w,a),r=Math.max(r,n.node(e.v).out+=s),i=Math.max(i,n.node(e.w).in+=s)}));const o=[],s=r+i+3;for(let l=0;l<s;l++)o.push(new AC);const a=i+1;return n.nodes().forEach((e=>{WC(o,a,n.node(e))})),{buckets:o,zeroIdx:a,graph:n}},WC=(e,t,n)=>{n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)},zC=e=>{const t=[],n={},i={},r=o=>{var s;i.hasOwnProperty(o)||(i[o]=!0,n[o]=!0,null===(s=e.outEdges(o))||void 0===s||s.forEach((e=>{n.hasOwnProperty(e.w)?t.push(e):r(e.w)})),delete n[o])};return e.nodes().forEach(r),t};var VC=e=>{const t="greedy"===e.graph().acyclicer?((e,t)=>{var n;if(e.nodeCount()<=1)return[];const i=BC(e,t||RC);return null===(n=PC(i.graph,i.buckets,i.zeroIdx).map((t=>e.outEdges(t.v,t.w))))||void 0===n?void 0:n.flat()})(e,(n=e,e=>n.edge(e).weight)):zC(e);var n;null==t||t.forEach((t=>{const n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,`rev-${Math.random()}`)}))},UC=e=>{e.edges().forEach((t=>{const n=e.edge(t);if(n.reversed){e.removeEdge(t);const i=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,i)}}))};const HC=IC.Graph,jC=(e,t,n,i)=>{let r;do{r=`${i}${Math.random()}`}while(e.hasNode(r));return n.dummy=t,e.setNode(r,n),r},GC=e=>{const t=(new HC).setGraph(e.graph());return e.nodes().forEach((n=>{t.setNode(n,e.node(n))})),e.edges().forEach((n=>{const i=t.edge(n.v,n.w)||{weight:0,minlen:1},r=e.edge(n);t.setEdge(n.v,n.w,{weight:i.weight+r.weight,minlen:Math.max(i.minlen,r.minlen)})})),t},KC=(e,t)=>{const n={};return null==e||e.forEach(((e,i)=>{n[e]=t[i]})),n},qC=e=>{const t=e.nodes().filter((t=>void 0!==e.node(t).rank)).map((t=>e.node(t).rank)),n=Math.min(...t);e.nodes().forEach((t=>{const i=e.node(t);i.hasOwnProperty("rank")&&(i.rank||(i.rank=0),i.rank-=n)}))},$C=e=>{const t=e.nodes().filter((t=>void 0!==e.node(t).rank)).map((t=>e.node(t).rank)),n=Math.min(...t),i=[];e.nodes().forEach((t=>{var r;const o=((null===(r=e.node(t))||void 0===r?void 0:r.rank)||0)-n;i[o]||(i[o]=[]),i[o].push(t)}));let r=0;const o=e.graph().nodeRankFactor||0;for(let s=0;s<i.length;s++){const t=i[s];void 0===t&&s%o!=0?--r:r&&(null==t||t.forEach((t=>{e.node(t).rank||(e.node(t).rank=0),e.node(t).rank+=r})))}},YC=e=>{const t=e.nodes().map((t=>{const n=e.node(t).rank;return void 0!==n?n:-1/0}));return Math.max(...t)},XC=(e,t)=>{const n=Date.now();try{return t()}finally{console.log(`${e} time: ${Date.now()-n}ms`)}},ZC=(e,t)=>t(),QC=(e,t)=>{let n,i=1/0;return null==e||e.forEach((e=>{const r=t(e);i>r&&(i=r,n=e)})),n};var JC={addDummyNode:jC,simplify:GC,asNonCompoundGraph:e=>{const t=new HC({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach((n=>{var i;(null===(i=e.children(n))||void 0===i?void 0:i.length)||t.setNode(n,e.node(n))})),e.edges().forEach((n=>t.setEdge(n,e.edge(n)))),t},successorWeights:e=>{const t=e.nodes().map((t=>{var n;const i={};return null===(n=e.outEdges(t))||void 0===n||n.forEach((t=>{i[t.w]=(i[t.w]||0)+e.edge(t).weight})),i}));return KC(e.nodes(),t)},predecessorWeights:e=>{const t=e.nodes().map((t=>{var n;const i={};return null===(n=e.inEdges(t))||void 0===n||n.forEach((t=>{i[t.v]=(i[t.v]||0)+e.edge(t).weight})),i}));return KC(e.nodes(),t)},intersectRect:(e,t)=>{const n=e.x,i=e.y,r=t.x-n,o=t.y-i;let s,a,l=e.width/2,c=e.height/2;return r||o?(Math.abs(o)*l>Math.abs(r)*c?(o<0&&(c=-c),s=c*r/o,a=c):(r<0&&(l=-l),s=l,a=l*o/r),{x:n+s,y:i+a}):{x:0,y:0}},buildLayerMatrix:e=>{const t=[],n=[],i=YC(e)+1;for(let r=0;r<i;r++)t.push([]),n.push([]);return e.nodes().forEach((i=>{const r=e.node(i).rank;void 0!==r&&t[r]&&n[r].push(i)})),null==n||n.forEach(((n,i)=>{null==n||n.sort(((t,n)=>{var i,r;return(null===(i=e.node(t))||void 0===i?void 0:i.order)-(null===(r=e.node(n))||void 0===r?void 0:r.order)})),n.forEach((e=>{t[i].push(e)}))})),t},normalizeRanks:qC,removeEmptyRanks:$C,addBorderNode:(e,t,n,i)=>{const r={width:0,height:0};return _b(n)&&_b(i)&&(r.rank=n,r.order=i),jC(e,"border",r,t)},maxRank:YC,partition:(e,t)=>{const n={lhs:[],rhs:[]};return null==e||e.forEach((e=>{t(e)?n.lhs.push(e):n.rhs.push(e)})),n},time:XC,notime:ZC,zipObject:KC,minBy:QC};const eS=(e,t)=>{var n,i;let r=t.v,o=e.node(r).rank;const s=t.w,a=e.node(s).rank,l=t.name,c=e.edge(t),u=c.labelRank;if(a===o+1)return;let h,d,f;for(e.removeEdge(t),f=0,++o;o<a;++f,++o)c.points=[],d={edgeLabel:c,width:0,height:0,edgeObj:t,rank:o},h=JC.addDummyNode(e,"edge",d,"_d"),o===u&&(d.width=c.width,d.height=c.height,d.dummy="edge-label",d.labelpos=c.labelpos),e.setEdge(r,h,{weight:c.weight},l),0===f&&(e.graph().dummyChains||(e.graph().dummyChains=[]),null===(i=null===(n=e.graph())||void 0===n?void 0:n.dummyChains)||void 0===i||i.push(h)),r=h;e.setEdge(r,s,{weight:c.weight},l)};var tS=e=>{e.graph().dummyChains=[],e.edges().forEach((t=>eS(e,t)))},nS=e=>{var t;null===(t=e.graph().dummyChains)||void 0===t||t.forEach((t=>{var n;let i=e.node(t);const r=i.edgeLabel;let o;i.edgeObj&&e.setEdge(i.edgeObj,r);let s=t;for(;i.dummy;)o=null===(n=e.successors(s))||void 0===n?void 0:n[0],e.removeNode(s),r.points.push({x:i.x,y:i.y}),"edge-label"===i.dummy&&(r.x=i.x,r.y=i.y,r.width=i.width,r.height=i.height),s=o,i=e.node(s)}))};const iS=e=>{var t;const n={},i=t=>{var r;const o=e.node(t);if(n.hasOwnProperty(t))return o.rank;n[t]=!0;const s=null===(r=e.outEdges(t))||void 0===r?void 0:r.map((t=>i(t.w)-e.edge(t).minlen||1/0));let a=Math.min(...s);return a!==Number.POSITIVE_INFINITY&&null!=a||(a=0),o.rank=a,a};null===(t=e.sources())||void 0===t||t.forEach((e=>i(e)))},rS=(e,t)=>e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen,oS=IC.Graph,sS=(e,t)=>{const n=i=>{t.nodeEdges(i).forEach((r=>{const o=r.v,s=i===o?r.w:o;e.hasNode(s)||rS(t,r)||(e.setNode(s,{}),e.setEdge(i,s,{}),n(s))}))};return e.nodes().forEach(n),e.nodeCount()},aS=(e,t)=>{const n=i=>{var r;null===(r=t.nodeEdges(i))||void 0===r||r.forEach((r=>{const o=r.v,s=i===o?r.w:o;e.hasNode(s)||void 0===t.node(s).layer&&rS(t,r)||(e.setNode(s,{}),e.setEdge(i,s,{}),n(s))}))};return e.nodes().forEach(n),e.nodeCount()},lS=(e,t)=>QC(t.edges(),(n=>e.hasNode(n.v)!==e.hasNode(n.w)?rS(t,n):1/0)),cS=(e,t,n)=>{e.nodes().forEach((e=>{t.node(e).rank||(t.node(e).rank=0),t.node(e).rank+=n}))},uS=IC.alg,{preorder:hS,postorder:dS}=uS,fS=e=>{e=GC(e),iS(e);const t=(e=>{const t=new oS({directed:!1}),n=e.nodes()[0],i=e.nodeCount();let r,o;for(t.setNode(n,{});sS(t,e)<i;)r=lS(t,e),o=t.hasNode(r.v)?rS(e,r):-rS(e,r),cS(t,e,o);return t})(e);let n,i;for(vS(t),gS(t,e);n=_S(t);)i=bS(t,e,n),wS(t,e,n,i)},gS=(e,t)=>{let n=dS(e,e.nodes());n=null==n?void 0:n.slice(0,(null==n?void 0:n.length)-1),null==n||n.forEach((n=>{pS(e,t,n)}))},pS=(e,t,n)=>{const i=e.node(n).parent;e.edge(n,i).cutvalue=mS(e,t,n)},mS=(e,t,n)=>{var i;const r=e.node(n).parent;let o=!0,s=t.edge(n,r),a=0;return s||(o=!1,s=t.edge(r,n)),a=s.weight,null===(i=t.nodeEdges(n))||void 0===i||i.forEach((i=>{const s=i.v===n,l=s?i.w:i.v;if(l!==r){const r=s===o,c=t.edge(i).weight;if(a+=r?c:-c,SS(e,n,l)){const t=e.edge(n,l).cutvalue;a+=r?-t:t}}})),a},vS=(e,t)=>{void 0!==t&&(t=e.nodes()[0]),yS(e,{},1,t)},yS=(e,t,n,i,r)=>{var o;const s=n;let a=n;const l=e.node(i);return t[i]=!0,null===(o=e.neighbors(i))||void 0===o||o.forEach((n=>{t.hasOwnProperty(n)||(a=yS(e,t,a,n,i))})),l.low=s,l.lim=a++,r?l.parent=r:delete l.parent,a},_S=e=>e.edges().find((t=>e.edge(t).cutvalue<0)),bS=(e,t,n)=>{let i=n.v,r=n.w;t.hasEdge(i,r)||(i=n.w,r=n.v);const o=e.node(i),s=e.node(r);let a=o,l=!1;o.lim>s.lim&&(a=s,l=!0);const c=t.edges().filter((t=>l===xS(e,e.node(t.v),a)&&l!==xS(e,e.node(t.w),a)));return QC(c,(e=>rS(t,e)))},wS=(e,t,n,i)=>{const r=n.v,o=n.w;e.removeEdge(r,o),e.setEdge(i.v,i.w,{}),vS(e),gS(e,t),CS(e,t)},CS=(e,t)=>{const n=e.nodes().find((e=>!t.node(e).parent));let i=hS(e,n);i=null==i?void 0:i.slice(1),null==i||i.forEach((n=>{const i=e.node(n).parent;let r=t.edge(n,i),o=!1;r||(r=t.edge(i,n),o=!0),t.node(n).rank=t.node(i).rank+(o?r.minlen:-r.minlen)}))},SS=(e,t,n)=>e.hasEdge(t,n),xS=(e,t,n)=>n.low<=t.lim&&t.lim<=n.lim;fS.initLowLimValues=vS,fS.initCutValues=gS,fS.calcCutValue=mS,fS.leaveEdge=_S,fS.enterEdge=bS,fS.exchangeEdges=wS;const ES=iS,kS=e=>{(e=>{var t;const n={};let i=0;const r=t=>{var o;const s=e.node(t);if(n.hasOwnProperty(t))return s.rank;n[t]=!0;const a=null===(o=e.outEdges(t))||void 0===o?void 0:o.map((t=>r(t.w)-e.edge(t).minlen||1/0));let l=Math.min(...a);return l!==Number.POSITIVE_INFINITY&&null!=l||(l=0),s.rank=l,i=Math.min(s.rank,i),s.rank};null===(t=e.sources())||void 0===t||t.forEach((e=>r(e))),i+=1;const o=(t,n)=>{var i;const r=e.node(t),s=isNaN(r.layer)?n:r.layer;(void 0===r.rank||r.rank<s)&&(r.rank=s),null===(i=e.outEdges(t))||void 0===i||i.map((t=>{o(t.w,s+e.edge(t).minlen)}))};e.nodes().forEach((t=>{const n=e.node(t);isNaN(n.layer)?n.rank-=i:o(t,n.layer)}))})(e),(e=>{const t=new oS({directed:!1}),n=e.nodes()[0],i=e.nodeCount();let r,o;for(t.setNode(n,{});aS(t,e)<i;)r=lS(t,e),o=t.hasNode(r.v)?rS(e,r):-rS(e,r),cS(t,e,o)})(e)},LS=e=>{fS(e)},DS=(e,t,n,i)=>{const r=[],o=[],s=Math.min(t[n].low,t[i].low),a=Math.max(t[n].lim,t[i].lim);let l,c;l=n;do{l=e.parent(l),r.push(l)}while(l&&(t[l].low>s||a>t[l].lim));for(c=l,l=i;(l=e.parent(l))!==c;)o.push(l);return{lca:c,path:r.concat(o.reverse())}},NS=e=>{var t;const n={};let i=0;const r=t=>{var o;const s=i;null===(o=e.children(t))||void 0===o||o.forEach(r),n[t]={low:s,lim:i++}};return null===(t=e.children())||void 0===t||t.forEach(r),n},IS=(e,t,n,i,r,o,s)=>{const a=e.children(s);if(!(null==a?void 0:a.length))return void(s!==t&&e.setEdge(t,s,{weight:0,minlen:n}));const l=JC.addBorderNode(e,"_bt"),c=JC.addBorderNode(e,"_bb"),u=e.node(s);e.setParent(l,s),u.borderTop=l,e.setParent(c,s),u.borderBottom=c,null==a||a.forEach((a=>{IS(e,t,n,i,r,o,a);const u=e.node(a),h=u.borderTop?u.borderTop:a,d=u.borderBottom?u.borderBottom:a,f=u.borderTop?i:2*i,g=h!==d?1:r-o[s]+1;e.setEdge(l,h,{minlen:g,weight:f,nestingEdge:!0}),e.setEdge(d,c,{minlen:g,weight:f,nestingEdge:!0})})),e.parent(s)||e.setEdge(t,l,{weight:0,minlen:r+o[s]})},TS=e=>{var t;const n={},i=(t,r)=>{const o=e.children(t);null==o||o.forEach((e=>i(e,r+1))),n[t]=r};return null===(t=e.children())||void 0===t||t.forEach((e=>i(e,1))),n},MS=e=>{let t=0;return e.edges().forEach((n=>{t+=e.edge(n).weight})),t};var AS=e=>{var t;const n=JC.addDummyNode(e,"root",{},"_root"),i=TS(e),r=Math.max(...Object.values(i))-1,o=2*r+1;e.graph().nestingRoot=n,e.edges().forEach((t=>{e.edge(t).minlen*=o}));const s=MS(e)+1;null===(t=e.children())||void 0===t||t.forEach((t=>{IS(e,n,o,s,r,i,t)})),e.graph().nodeRankFactor=o},OS=e=>{const t=e.graph();t.nestingRoot&&e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach((t=>{e.edge(t).nestingEdge&&e.removeEdge(t)}))};const RS=(e,t,n,i,r,o)=>{const s={rank:o,width:0,height:0,borderType:t},a=r[t][o-1],l=JC.addDummyNode(e,"border",s,n);r[t][o]=l,e.setParent(l,i),a&&e.setEdge(a,l,{weight:1})},PS=e=>{e.nodes().forEach((t=>{FS(e.node(t))})),e.edges().forEach((t=>{FS(e.edge(t))}))},FS=e=>{const t=e.width;e.width=e.height,e.height=t},BS=e=>{e.nodes().forEach((t=>{WS(e.node(t))})),e.edges().forEach((t=>{var n;const i=e.edge(t);null===(n=i.points)||void 0===n||n.forEach((e=>WS(e))),i.hasOwnProperty("y")&&WS(i)}))},WS=e=>{e.y=-e.y},zS=e=>{e.nodes().forEach((t=>{VS(e.node(t))})),e.edges().forEach((t=>{var n;const i=e.edge(t);null===(n=i.points)||void 0===n||n.forEach((e=>VS(e))),i.hasOwnProperty("x")&&VS(i)}))},VS=e=>{const t=e.x;e.x=e.y,e.y=t};var US=e=>{var t;const n=null===(t=e.graph().rankdir)||void 0===t?void 0:t.toLowerCase();"lr"!==n&&"rl"!==n||PS(e)},HS=e=>{var t;const n=null===(t=e.graph().rankdir)||void 0===t?void 0:t.toLowerCase();"bt"!==n&&"rl"!==n||BS(e),"lr"!==n&&"rl"!==n||(zS(e),PS(e))};const jS=e=>{const t={},n=e.nodes().filter((t=>{var n;return!(null===(n=e.children(t))||void 0===n?void 0:n.length)})),i=n.map((t=>e.node(t).rank)),r=Math.max(...i),o=[];for(let c=0;c<r+1;c++)o.push([]);const s=n=>{var i;if(t.hasOwnProperty(n))return;t[n]=!0;const r=e.node(n);isNaN(r.rank)||o[r.rank].push(n),null===(i=e.successors(n))||void 0===i||i.forEach((e=>s(e)))},a=n.sort(((t,n)=>e.node(t).rank-e.node(n).rank)),l=a.filter((t=>void 0!==e.node(t).fixorder)).sort(((t,n)=>e.node(t).fixorder-e.node(n).fixorder));return null==l||l.forEach((n=>{isNaN(e.node(n).rank)||o[e.node(n).rank].push(n),t[n]=!0})),null==a||a.forEach(s),o},GS=(e,t,n)=>{const i=KC(n,n.map(((e,t)=>t))),r=t.map((t=>{var n;const r=null===(n=e.outEdges(t))||void 0===n?void 0:n.map((t=>({pos:i[t.w]||0,weight:e.edge(t).weight})));return null==r?void 0:r.sort(((e,t)=>e.pos-t.pos))})).flat().filter((e=>void 0!==e));let o=1;for(;o<n.length;)o<<=1;const s=2*o-1;o-=1;const a=Array(s).fill(0,0,s);let l=0;return null==r||r.forEach((e=>{let t=e.pos+o;a[t]+=e.weight;let n=0;for(;t>0;)t%2&&(n+=a[t+1]),t=t-1>>1,a[t]+=e.weight;l+=e.weight*n})),l},KS=(e,t)=>{let n=0;for(let i=1;i<(null==t?void 0:t.length);++i)n+=GS(e,t[i-1],t[i]);return n},qS=IC.Graph,$S=e=>{let t;for(;e.hasNode(t=`_root${Math.random()}`););return t},YS=e=>{var t,n;const i=[];for(;null==e?void 0:e.length;){const r=e.pop();i.push(r),null===(t=r.in.reverse())||void 0===t||t.forEach((e=>{return(t=r,e=>{e.merged||(void 0===e.barycenter||void 0===t.barycenter||e.barycenter>=t.barycenter)&&XS(t,e)})(e);var t})),null===(n=r.out)||void 0===n||n.forEach((t=>{return(n=r,t=>{t.in.push(n),0==--t.indegree&&e.push(t)})(t);var n}))}const r=i.filter((e=>!e.merged)),o=["vs","i","barycenter","weight"];return r.map((e=>{const t={};return null==o||o.forEach((n=>{void 0!==e[n]&&(t[n]=e[n])})),t}))},XS=(e,t)=>{var n;let i=0,r=0;e.weight&&(i+=e.barycenter*e.weight,r+=e.weight),t.weight&&(i+=t.barycenter*t.weight,r+=t.weight),e.vs=null===(n=t.vs)||void 0===n?void 0:n.concat(e.vs),e.barycenter=i/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0},ZS=(e,t,n)=>{let i,r=n;for(;t.length&&(i=t[t.length-1]).i<=r;)t.pop(),null==e||e.push(i.vs),r++;return r},QS=(e,t)=>(n,i)=>{if(void 0!==n.fixorder&&void 0!==i.fixorder)return n.fixorder-i.fixorder;if(n.barycenter<i.barycenter)return-1;if(n.barycenter>i.barycenter)return 1;if(t&&void 0!==n.order&&void 0!==i.order){if(n.order<i.order)return-1;if(n.order>i.order)return 1}return e?i.i-n.i:n.i-i.i},JS=(e,t,n,i,r)=>{var o,s,a,l;let c=e.children(t);const u=e.node(t),h=u?u.borderLeft:void 0,d=u?u.borderRight:void 0,f={};h&&(c=null==c?void 0:c.filter((e=>e!==h&&e!==d)));const g=((e,t)=>t.map((t=>{const n=e.inEdges(t);if(!(null==n?void 0:n.length))return{v:t};{const i={sum:0,weight:0};return null==n||n.forEach((t=>{const n=e.edge(t),r=e.node(t.v);i.sum+=n.weight*r.order,i.weight+=n.weight})),{v:t,barycenter:i.sum/i.weight,weight:i.weight}}})))(e,c||[]);null==g||g.forEach((t=>{var r;if(null===(r=e.children(t.v))||void 0===r?void 0:r.length){const r=JS(e,t.v,n,i);f[t.v]=r,r.hasOwnProperty("barycenter")&&tx(t,r)}}));const p=((e,t)=>{var n,i,r;const o={};null==e||e.forEach(((e,t)=>{const n=o[e.v]={i:t,indegree:0,in:[],out:[],vs:[e.v]};void 0!==e.barycenter&&(n.barycenter=e.barycenter,n.weight=e.weight)})),null===(n=t.edges())||void 0===n||n.forEach((e=>{const t=o[e.v],n=o[e.w];void 0!==t&&void 0!==n&&(n.indegree++,t.out.push(o[e.w]))}));const s=null===(r=(i=Object.values(o)).filter)||void 0===r?void 0:r.call(i,(e=>!e.indegree));return YS(s)})(g,n);ex(p,f),null===(o=p.filter((e=>{var t;return!!e.vs||(null===(t=e.vs)||void 0===t?void 0:t.length)>0})))||void 0===o||o.forEach((t=>{const n=e.node(t.vs[0]);t.fixorder=n.fixorder,t.order=n.order}));const m=((e,t,n)=>{const i=JC.partition(e,(e=>e.hasOwnProperty("fixorder")&&!isNaN(e.fixorder)||e.hasOwnProperty("barycenter"))),r=i.lhs,o=i.rhs.sort(((e,t)=>-e.i- -t.i)),s=[];let a=0,l=0,c=0;null==r||r.sort(QS(!!t,!!n)),c=ZS(s,o,c),null==r||r.forEach((e=>{var t;c+=null===(t=e.vs)||void 0===t?void 0:t.length,s.push(e.vs),a+=e.barycenter*e.weight,l+=e.weight,c=ZS(s,o,c)}));const u={vs:s.flat()};return l&&(u.barycenter=a/l,u.weight=l),u})(p,i,r);if(h&&(m.vs=[h,m.vs,d].flat(),null===(s=e.predecessors(h))||void 0===s?void 0:s.length)){const t=e.node((null===(a=e.predecessors(h))||void 0===a?void 0:a[0])||{}),n=e.node((null===(l=e.predecessors(d))||void 0===l?void 0:l[0])||{});m.hasOwnProperty("barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+t.order+n.order)/(m.weight+2),m.weight+=2}return m},ex=(e,t)=>{null==e||e.forEach((e=>{var n;const i=null===(n=e.vs)||void 0===n?void 0:n.map((e=>t[e]?t[e].vs:e));e.vs=i.flat()}))},tx=(e,t)=>{void 0!==e.barycenter?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)},nx=IC.Graph,ix=(e,t,n)=>t.map((t=>((e,t,n)=>{const i=$S(e),r=new qS({compound:!0}).setGraph({root:i}).setDefaultNodeLabel((t=>e.node(t)));return e.nodes().forEach((o=>{const s=e.node(o),a=e.parent(o);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(r.setNode(o),r.setParent(o,a||i),e[n](o).forEach((t=>{const n=t.v===o?t.w:t.v,i=r.edge(n,o),s=void 0!==i?i.weight:0;r.setEdge(n,o,{weight:e.edge(t).weight+s})})),s.hasOwnProperty("minRank")&&r.setNode(o,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))})),r})(e,t,n))),rx=(e,t,n)=>{const i=new nx;null==e||e.forEach((e=>{var r;const o=e.graph().root,s=JS(e,o,i,t,n);for(let t=0;t<(null===(r=s.vs)||void 0===r?void 0:r.length);t++)e.node(s.vs[t]).order=t;((e,t,n)=>{const i={};let r;null==n||n.forEach((n=>{let o,s,a=e.parent(n);for(;a;){if(o=e.parent(a),o?(s=i[o],i[o]=a):(s=r,r=a),s&&s!==a)return void t.setEdge(s,a);a=o}}))})(e,i,s.vs)}))},ox=(e,t)=>{null==t||t.forEach((t=>{null==t||t.forEach(((t,n)=>{e.node(t).order=n}))}))},sx=IC.Graph,ax=(e,t)=>{var n;if(e.node(t).dummy)return null===(n=e.predecessors(t))||void 0===n?void 0:n.find((t=>e.node(t).dummy))},lx=(e,t,n)=>{let i=t,r=n;if(i>r){const e=i;i=r,r=e}let o=e[i];o||(e[i]=o={}),o[r]=!0},cx=(e,t,n)=>{let i=t,r=n;if(i>r){i=r,r=t}return e[i]&&e[i].hasOwnProperty(r)},ux=(e,t,n,i)=>{const r=new sx,o=e.graph(),s=hx(o.nodesep,o.edgesep,i);return null==t||t.forEach((t=>{let i;null==t||t.forEach((t=>{const o=n[t];if(r.setNode(o),i){const a=n[i],l=r.edge(a,o);r.setEdge(a,o,Math.max(s(e,t,i),l||0))}i=t}))})),r};const hx=(e,t,n)=>(i,r,o)=>{const s=i.node(r),a=i.node(o);let l,c=0;if(c+=s.width/2,s.hasOwnProperty("labelpos"))switch((s.labelpos||"").toLowerCase()){case"l":l=-s.width/2;break;case"r":l=s.width/2}if(l&&(c+=n?l:-l),l=0,c+=(s.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,a.hasOwnProperty("labelpos"))switch((a.labelpos||"").toLowerCase()){case"l":l=a.width/2;break;case"r":l=-a.width/2}return l&&(c+=n?l:-l),l=0,c},dx=(e,t)=>{var n;return(null===(n=e.node(t))||void 0===n?void 0:n.width)||0},fx=e=>{const t=JC.buildLayerMatrix(e),n=Object.assign(((e,t)=>{const n={},i=(t,i)=>{let r=0,o=0;const s=t.length,a=null==i?void 0:i[(null==i?void 0:i.length)-1];return null==i||i.forEach(((t,l)=>{var c;const u=ax(e,t),h=u?e.node(u).order:s;(u||t===a)&&(null===(c=i.slice(o,l+1))||void 0===c||c.forEach((t=>{var i;null===(i=e.predecessors(t))||void 0===i||i.forEach((i=>{const o=e.node(i),s=o.order;!(s<r||h<s)||o.dummy&&e.node(t).dummy||lx(n,i,t)}))})),o=l+1,r=h)})),i};return(null==t?void 0:t.length)&&t.reduce(i),n})(e,t),((e,t)=>{const n={},i=(t,i,r,o,s)=>{let a;const l=[];for(let e=i;e<r;e++)l.push(e);l.forEach((i=>{var r;a=t[i],e.node(a).dummy&&(null===(r=e.predecessors(a))||void 0===r||r.forEach((t=>{const i=e.node(t);i.dummy&&(i.order<o||i.order>s)&&lx(n,t,a)})))}))},r=(t,n)=>{let r,o=-1,s=0;return null==n||n.forEach(((a,l)=>{if("border"===e.node(a).dummy){const t=e.predecessors(a)||[];t.length&&(r=e.node(t[0]).order,i(n,s,l,o,r),s=l,o=r)}i(n,s,n.length,r,t.length)})),n};return(null==t?void 0:t.length)&&t.reduce(r),n})(e,t)),i={};let r;["u","d"].forEach((o=>{r="u"===o?t:Object.values(t).reverse(),["l","r"].forEach((t=>{"r"===t&&(r=r.map((e=>Object.values(e).reverse())));const s=("u"===o?e.predecessors:e.successors).bind(e),a=((e,t,n,i)=>{const r={},o={},s={};return null==t||t.forEach((e=>{null==e||e.forEach(((e,t)=>{r[e]=e,o[e]=e,s[e]=t}))})),null==t||t.forEach((e=>{let t=-1;null==e||e.forEach((e=>{let a=i(e);if(a.length){a=a.sort(((e,t)=>s[e]-s[t]));const i=(a.length-1)/2;for(let l=Math.floor(i),c=Math.ceil(i);l<=c;++l){const i=a[l];o[e]===e&&t<s[i]&&!cx(n,e,i)&&(o[i]=e,o[e]=r[e]=r[i],t=s[i])}}}))})),{root:r,align:o}})(0,r,n,s),l=((e,t,n,i,r)=>{var o;const s={},a=ux(e,t,n,r),l=r?"borderLeft":"borderRight",c=(e,t)=>{let n=a.nodes(),i=n.pop();const r={};for(;i;)r[i]?e(i):(r[i]=!0,n.push(i),n=n.concat(t(i))),i=n.pop()};return c((e=>{s[e]=(a.inEdges(e)||[]).reduce(((e,t)=>Math.max(e,(s[t.v]||0)+a.edge(t))),0)}),a.predecessors.bind(a)),c((t=>{const n=(a.outEdges(t)||[]).reduce(((e,t)=>Math.min(e,(s[t.w]||0)-a.edge(t))),Number.POSITIVE_INFINITY),i=e.node(t);n!==Number.POSITIVE_INFINITY&&i.borderType!==l&&(s[t]=Math.max(s[t],n))}),a.successors.bind(a)),null===(o=Object.values(i))||void 0===o||o.forEach((e=>{s[e]=s[n[e]]})),s})(e,r,a.root,a.align,"r"===t);"r"===t&&Object.keys(l).forEach((e=>l[e]=-l[e])),i[o+t]=l}))}));const o=((e,t)=>JC.minBy(Object.values(t),(t=>{var n;let i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return null===(n=Object.keys(t))||void 0===n||n.forEach((n=>{const o=t[n],s=dx(e,n)/2;i=Math.max(o+s,i),r=Math.min(o-s,r)})),i-r})))(e,i);return o&&function(e,t){const n=Object.values(t),i=Math.min(...n),r=Math.max(...n);["u","d"].forEach((n=>{["l","r"].forEach((o=>{const s=n+o,a=e[s];let l;if(a===t)return;const c=Object.values(a);l="l"===o?i-Math.min(...c):r-Math.max(...c),l&&(e[s]={},Object.keys(a).forEach((t=>{e[s][t]=a[t]+l})))}))}))}(i,o),((e,t)=>{const n={};return Object.keys(e.ul).forEach((i=>{if(t)n[i]=e[t.toLowerCase()][i];else{const t=Object.values(e).map((e=>e[i])).sort(((e,t)=>e-t));n[i]=(t[1]+t[2])/2}})),n})(i,e.graph().align)},gx=e=>{var t;(e=>{const t=JC.buildLayerMatrix(e),n=e.graph().ranksep;let i=0;null==t||t.forEach((t=>{const r=t.map((t=>e.node(t).height)),o=Math.max(...r);null==t||t.forEach((t=>{e.node(t).y=i+o/2})),i+=o+n}))})(e=JC.asNonCompoundGraph(e));const n=fx(e);null===(t=Object.keys(n))||void 0===t||t.forEach((t=>{e.node(t).x=n[t]}))},px=IC.Graph,mx=(e,t,n)=>{t("    removeSelfEdges",(()=>{Fx(e)})),t("    acyclic",(()=>{VC(e)})),t("    nestingGraph.run",(()=>{AS(e)})),t("    rank",(()=>{(e=>{switch(e.graph().ranker){case"network-simplex":LS(e);break;case"tight-tree":kS(e);break;case"longest-path":ES(e);break;default:kS(e)}})(JC.asNonCompoundGraph(e))})),t("    injectEdgeLabelProxies",(()=>{Nx(e)})),t("    removeEmptyRanks",(()=>{$C(e)})),t("    nestingGraph.cleanup",(()=>{OS(e)})),t("    normalizeRanks",(()=>{qC(e)})),t("    assignRankMinMax",(()=>{Ix(e)})),t("    removeEdgeLabelProxies",(()=>{Tx(e)})),t("    normalize.run",(()=>{tS(e)})),t("    parentDummyChains",(()=>{(e=>{var t;const n=NS(e);null===(t=e.graph().dummyChains)||void 0===t||t.forEach((t=>{var i,r;let o=e.node(t);const s=o.edgeObj;if(!s)return;const a=DS(e,n,s.v,s.w),l=a.path,c=a.lca;let u=0,h=l[u],d=!0;for(;t!==s.w;){if(o=e.node(t),d){for(;(h=l[u])!==c&&e.node(h).maxRank<o.rank;)u++;h===c&&(d=!1)}if(!d){for(;u<l.length-1&&(null===(i=e.node(h=l[u+1]))||void 0===i?void 0:i.minRank)<=o.rank;)u++;h=l[u]}e.setParent(t,h),t=null===(r=e.successors(t))||void 0===r?void 0:r[0]}}))})(e)})),t("    addBorderSegments",(()=>{(e=>{var t;const n=t=>{const i=e.children(t),r=e.node(t);if((null==i?void 0:i.length)&&i.forEach((e=>n(e))),r.hasOwnProperty("minRank")){r.borderLeft=[],r.borderRight=[];for(let n=r.minRank,i=r.maxRank+1;n<i;++n)RS(e,"borderLeft","_bl",t,r,n),RS(e,"borderRight","_br",t,r,n)}};null===(t=e.children())||void 0===t||t.forEach((e=>n(e)))})(e)})),n&&n.keepNodeOrder&&t("    initDataOrder",(()=>{((e,t)=>{const n=e.nodes().filter((t=>{var n;return!(null===(n=e.children(t))||void 0===n?void 0:n.length)})).map((t=>e.node(t).rank)),i=Math.max(...n),r=[];for(let o=0;o<i+1;o++)r.push([]);null==t||t.forEach((t=>{const n=e.node(t);n&&!n.dummy&&(isNaN(n.rank)||(n.fixorder=r[n.rank].length,r[n.rank].push(t)))}))})(e,n.nodeOrder)})),t("    order",(()=>{(e=>{const t=JC.maxRank(e),n=[],i=[];for(let c=1;c<t+1;c++)n.push(c);for(let c=t-1;c>-1;c--)i.push(c);const r=ix(e,n,"inEdges"),o=ix(e,i,"outEdges");let s=jS(e);ox(e,s);let a,l=Number.POSITIVE_INFINITY;for(let c=0,u=0;u<4;++c,++u){rx(c%2?r:o,c%4>=2),s=JC.buildLayerMatrix(e);const t=KS(e,s);t<l&&(u=0,a=Cb(s),l=t)}s=jS(e),ox(e,s);for(let c=0,u=0;u<4;++c,++u){rx(c%2?r:o,c%4>=2,!0),s=JC.buildLayerMatrix(e);const t=KS(e,s);t<l&&(u=0,a=Cb(s),l=t)}ox(e,a)})(e)})),t("    insertSelfEdges",(()=>{Bx(e)})),t("    adjustCoordinateSystem",(()=>{US(e)})),t("    position",(()=>{gx(e)})),t("    positionSelfEdges",(()=>{Wx(e)})),t("    removeBorderNodes",(()=>{Px(e)})),t("    normalize.undo",(()=>{nS(e)})),t("    fixupEdgeLabelCoords",(()=>{Ox(e)})),t("    undoCoordinateSystem",(()=>{HS(e)})),t("    translateGraph",(()=>{Mx(e)})),t("    assignNodeIntersects",(()=>{Ax(e)})),t("    reversePoints",(()=>{Rx(e)})),t("    acyclic.undo",(()=>{UC(e)}))},vx=(e,t)=>{const n=t._nodes||{};e.nodes().forEach((t=>{const i=e.node(t);void 0!==n[t]?(i.fixorder=n[t]._order,delete n[t]._order):delete i.fixorder}))},yx=(e,t)=>{e.nodes().forEach((n=>{var i;const r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,r._order=o.order,r._rank=o.rank,(null===(i=t.children(n))||void 0===i?void 0:i.length)&&(r.width=o.width,r.height=o.height))})),e.edges().forEach((n=>{const i=e.edge(n),r=t.edge(n);i.points=r.points,r.hasOwnProperty("x")&&(i.x=r.x,i.y=r.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height},_x=["nodesep","edgesep","ranksep","marginx","marginy"],bx={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},wx=["acyclicer","ranker","rankdir","align"],Cx=["width","height","layer","fixorder"],Sx={width:0,height:0},xx=["minlen","weight","width","height","labeloffset"],Ex={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},kx=["labelpos"],Lx=e=>{const t=new px({multigraph:!0,compound:!0}),n=Vx(e.graph()),i={};return null==wx||wx.forEach((e=>{void 0!==n[e]&&(i[e]=n[e])})),t.setGraph(Object.assign({},bx,zx(n,_x),i)),e.nodes().forEach((n=>{const i=Vx(e.node(n)),r=zx(i,Cx);Object.keys(Sx).forEach((e=>{void 0===r[e]&&(r[e]=Sx[e])})),t.setNode(n,r),t.setParent(n,e.parent(n))})),e.edges().forEach((n=>{const i=Vx(e.edge(n)),r={};null==kx||kx.forEach((e=>{void 0!==i[e]&&(r[e]=i[e])})),t.setEdge(n,Object.assign({},Ex,zx(i,xx),r))})),t},Dx=e=>{const t=e.graph();t.ranksep||(t.ranksep=0),t.ranksep/=2,e.nodes().forEach((t=>{const n=e.node(t);isNaN(n.layer)||(n.layer?n.layer*=2:n.layer=0)})),e.edges().forEach((n=>{var i;const r=e.edge(n);r.minlen*=2,"c"!==(null===(i=r.labelpos)||void 0===i?void 0:i.toLowerCase())&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))},Nx=e=>{e.edges().forEach((t=>{const n=e.edge(t);if(n.width&&n.height){const n=e.node(t.v),i={e:t,rank:(e.node(t.w).rank-n.rank)/2+n.rank};JC.addDummyNode(e,"edge-proxy",i,"_ep")}}))},Ix=e=>{let t=0;e.nodes().forEach((n=>{const i=e.node(n);i.borderTop&&(i.minRank=e.node(i.borderTop).rank,i.maxRank=e.node(i.borderBottom).rank,t=Math.max(t,i.maxRank||-1/0))})),e.graph().maxRank=t},Tx=e=>{e.nodes().forEach((t=>{const n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))},Mx=e=>{let t=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,r=0;const o=e.graph(),s=o.marginx||0,a=o.marginy||0,l=e=>{if(!e)return;const o=e.x,s=e.y,a=e.width,l=e.height;isNaN(o)||isNaN(a)||(t=Math.min(t,o-a/2),n=Math.max(n,o+a/2)),isNaN(s)||isNaN(l)||(i=Math.min(i,s-l/2),r=Math.max(r,s+l/2))};e.nodes().forEach((t=>{l(e.node(t))})),e.edges().forEach((t=>{const n=e.edge(t);n.hasOwnProperty("x")&&l(n)})),t-=s,i-=a,e.nodes().forEach((n=>{const r=e.node(n);r.x-=t,r.y-=i})),e.edges().forEach((n=>{var r;const o=e.edge(n);null===(r=o.points)||void 0===r||r.forEach((e=>{e.x-=t,e.y-=i})),o.hasOwnProperty("x")&&(o.x-=t),o.hasOwnProperty("y")&&(o.y-=i)})),o.width=n-t+s,o.height=r-i+a},Ax=e=>{e.edges().forEach((t=>{const n=e.edge(t),i=e.node(t.v),r=e.node(t.w);let o,s;n.points?(o=n.points[0],s=n.points[n.points.length-1]):(n.points=[],o=r,s=i),n.points.unshift(JC.intersectRect(i,o)),n.points.push(JC.intersectRect(r,s))}))},Ox=e=>{e.edges().forEach((t=>{const n=e.edge(t);if(n.hasOwnProperty("x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))},Rx=e=>{e.edges().forEach((t=>{const n=e.edge(t);n.reversed&&n.points.reverse()}))},Px=e=>{e.nodes().forEach((t=>{var n,i,r;if(null===(n=e.children(t))||void 0===n?void 0:n.length){const n=e.node(t),o=e.node(n.borderTop),s=e.node(n.borderBottom),a=e.node(n.borderLeft[(null===(i=n.borderLeft)||void 0===i?void 0:i.length)-1]),l=e.node(n.borderRight[(null===(r=n.borderRight)||void 0===r?void 0:r.length)-1]);n.width=Math.abs((null==l?void 0:l.x)-(null==a?void 0:a.x))||10,n.height=Math.abs((null==s?void 0:s.y)-(null==o?void 0:o.y))||10,n.x=((null==a?void 0:a.x)||0)+n.width/2,n.y=((null==o?void 0:o.y)||0)+n.height/2}})),e.nodes().forEach((t=>{"border"===e.node(t).dummy&&e.removeNode(t)}))},Fx=e=>{e.edges().forEach((t=>{if(t.v===t.w){const n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))},Bx=e=>{const t=JC.buildLayerMatrix(e);null==t||t.forEach((t=>{let n=0;null==t||t.forEach(((t,i)=>{var r;const o=e.node(t);o.order=i+n,null===(r=o.selfEdges)||void 0===r||r.forEach((t=>{JC.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:o.rank,order:i+ ++n,e:t.e,label:t.label},"_se")})),delete o.selfEdges}))}))},Wx=e=>{e.nodes().forEach((t=>{const n=e.node(t);if("selfedge"===n.dummy){const i=e.node(n.e.v),r=i.x+i.width/2,o=i.y,s=n.x-r,a=i.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:r+2*s/3,y:o-a},{x:r+5*s/6,y:o-a},{y:o,x:r+s},{x:r+5*s/6,y:o+a},{x:r+2*s/3,y:o+a}],n.label.x=n.x,n.label.y=n.y}}))},zx=(e,t)=>{const n={};return null==t||t.forEach((t=>{void 0!==e[t]&&(n[t]=+e[t])})),n},Vx=e=>{const t={};return Object.keys(e).forEach((n=>{const i=e[n];t[n.toLowerCase()]=i})),t};var Ux={graphlib:IC,layout:(e,t)=>{const n=t&&t.debugTiming?JC.time:JC.notime;n("layout",(()=>{t&&!t.keepNodeOrder&&t.prevGraph&&n("  inheritOrder",(()=>{vx(e,t.prevGraph)}));const i=n("  buildLayoutGraph",(()=>Lx(e)));t&&!1===t.edgeLabelSpace||n("  makeSpaceForEdgeLabels",(()=>{Dx(i)}));try{n("  runLayout",(()=>{mx(i,n,t)}))}catch(zWe){if("Not possible to find intersection inside of the rectangle"===zWe.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",zWe);throw zWe}n("  updateInputGraph",(()=>{yx(e,i)}))}))},util:{time:XC,notime:ZC}};class Hx extends mb{constructor(e){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=e=>{const{nodes:t}=this,n=t.find((t=>t.id===e));if(n){return!1!==n.layout}return!0},this.updateCfg(e)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1}}execute(){const e=this,{nodes:t,nodeSize:n,rankdir:i,combos:r,begin:o}=e;if(!t)return;const s=e.edges||[],a=new Ux.graphlib.Graph({multigraph:!0,compound:!0});let l;l=n?yb(n)?()=>n:()=>[n,n]:e=>e.size?yb(e.size)?e.size:wb(e.size)?[e.size.width||40,e.size.height||40]:[e.size,e.size]:[40,40];let c=jx(e.nodesepFunc,e.nodesep,50),u=jx(e.ranksepFunc,e.ranksep,50);"LR"!==i&&"RL"!==i||(c=jx(e.ranksepFunc,e.ranksep,50),u=jx(e.nodesepFunc,e.nodesep,50)),a.setDefaultEdgeLabel((()=>({}))),a.setGraph(e);const h={};let d;t.filter((e=>!1!==e.layout)).forEach((e=>{const t=l(e),n=u(e),i=c(e),r=t[0]+2*i,o=t[1]+2*n,s=e.layer;_b(s)?a.setNode(e.id,{width:r,height:o,layer:s}):a.setNode(e.id,{width:r,height:o}),this.sortByCombo&&e.comboId&&(h[e.comboId]||(h[e.comboId]=!0,a.setNode(e.comboId,{})),a.setParent(e.id,e.comboId))})),this.sortByCombo&&r&&r.forEach((e=>{e.parentId&&(h[e.parentId]||(h[e.parentId]=!0,a.setNode(e.parentId,{})),a.setParent(e.id,e.parentId))})),s.forEach((e=>{const t=Sb(e,"source"),n=Sb(e,"target");this.layoutNode(t)&&this.layoutNode(n)&&a.setEdge(t,n,{weight:e.weight||1})})),e.preset&&(d=new Ux.graphlib.Graph({multigraph:!0,compound:!0}),e.preset.nodes.forEach((e=>{null==d||d.setNode(e.id,e)}))),Ux.layout(a,{prevGraph:d,edgeLabelSpace:e.edgeLabelSpace,keepNodeOrder:Boolean(!!e.nodeOrder),nodeOrder:e.nodeOrder});const f=[0,0];if(o){let e=1/0,t=1/0;a.nodes().forEach((n=>{const i=a.node(n);e>i.x&&(e=i.x),t>i.y&&(t=i.y)})),a.edges().forEach((n=>{a.edge(n).points.forEach((n=>{e>n.x&&(e=n.x),t>n.y&&(t=n.y)}))})),f[0]=o[0]-e,f[1]=o[1]-t}return a.nodes().forEach((e=>{const n=a.node(e),i=t.findIndex((t=>t.id===e));t[i]&&(t[i].x=n.x+f[0],t[i].y=n.y+f[1],t[i]._order=n._order)})),a.edges().forEach((t=>{const n=a.edge(t),i=s.findIndex((e=>{const n=Sb(e,"source"),i=Sb(e,"target");return n===t.v&&i===t.w}));e.edgeLabelSpace&&e.controlPoints&&"loop"!==s[i].type&&(s[i].controlPoints=n.points.slice(1,n.points.length-1),s[i].controlPoints.forEach((e=>{e.x+=f[0],e.y+=f[1]})))})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:s}}getType(){return"dagre"}}function jx(e,t,n){let i;return i=e||(_b(t)?()=>t:()=>n),i}const Gx=Object.prototype.toString;function Kx(e){return Gx.call(e).endsWith("Array]")}function qx(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Kx(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");var n=t.fromIndex,i=void 0===n?0:n,r=t.toIndex,o=void 0===r?e.length:r;if(i<0||i>=e.length||!Number.isInteger(i))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=i||o>e.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=e[i],a=i+1;a<o;a++)e[a]>s&&(s=e[a]);return s}function $x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Kx(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");var n=t.fromIndex,i=void 0===n?0:n,r=t.toIndex,o=void 0===r?e.length:r;if(i<0||i>=e.length||!Number.isInteger(i))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=i||o>e.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=e[i],a=i+1;a<o;a++)e[a]<s&&(s=e[a]);return s}function Yx(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Kx(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!Kx(n.output))throw new TypeError("output option must be an array if specified");t=n.output}else t=new Array(e.length);var i=$x(e),r=qx(e);if(i===r)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,s=void 0===o?n.autoMinMax?i:0:o,a=n.max,l=void 0===a?n.autoMinMax?r:1:a;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-s)/(r-i),u=0;u<e.length;u++)t[u]=(e[u]-i)*c+s;return t}const Xx=" ".repeat(2),Zx=" ".repeat(4);function Qx(e,t={}){const{maxRows:n=15,maxColumns:i=10,maxNumSize:r=8}=t;return`${e.constructor.name} {\n${Xx}[\n${Zx}${function(e,t,n,i){const{rows:r,columns:o}=e,s=Math.min(r,t),a=Math.min(o,n),l=[];for(let c=0;c<s;c++){let t=[];for(let n=0;n<a;n++)t.push(Jx(e.get(c,n),i));l.push(`${t.join(" ")}`)}a!==o&&(l[l.length-1]+=` ... ${o-n} more columns`);s!==r&&l.push(`... ${r-t} more rows`);return l.join(`\n${Zx}`)}(e,n,i,r)}\n${Xx}]\n${Xx}rows: ${e.rows}\n${Xx}columns: ${e.columns}\n}`}function Jx(e,t){const n=String(e);if(n.length<=t)return n.padEnd(t," ");const i=e.toPrecision(t-2);if(i.length<=t)return i;const r=e.toExponential(t-2),o=r.indexOf("e"),s=r.slice(o);return r.slice(0,t-s.length)+s}function eE(e,t,n){let i=n?e.rows:e.rows-1;if(t<0||t>i)throw new RangeError("Row index out of range")}function tE(e,t,n){let i=n?e.columns:e.columns-1;if(t<0||t>i)throw new RangeError("Column index out of range")}function nE(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function iE(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function rE(e,t,n,i,r){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(sE("startRow",t),sE("endRow",n),sE("startColumn",i),sE("endColumn",r),t>n||i>r||t<0||t>=e.rows||n<0||n>=e.rows||i<0||i>=e.columns||r<0||r>=e.columns)throw new RangeError("Submatrix indices are out of range")}function oE(e,t=0){let n=[];for(let i=0;i<e;i++)n.push(t);return n}function sE(e,t){if("number"!=typeof t)throw new TypeError(`${e} must be a number`)}function aE(e){if(e.isEmpty())throw new Error("Empty matrix has no elements to index")}class lE{static from1DArray(e,t,n){if(e*t!==n.length)throw new RangeError("data length does not match given dimensions");let i=new uE(e,t);for(let r=0;r<e;r++)for(let e=0;e<t;e++)i.set(r,e,n[r*t+e]);return i}static rowVector(e){let t=new uE(1,e.length);for(let n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){let t=new uE(e.length,1);for(let n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static zeros(e,t){return new uE(e,t)}static ones(e,t){return new uE(e,t).fill(1)}static rand(e,t,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{random:i=Math.random}=n;let r=new uE(e,t);for(let o=0;o<e;o++)for(let e=0;e<t;e++)r.set(o,e,i());return r}static randInt(e,t,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{min:i=0,max:r=1e3,random:o=Math.random}=n;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(r))throw new TypeError("max must be an integer");if(i>=r)throw new RangeError("min must be smaller than max");let s=r-i,a=new uE(e,t);for(let l=0;l<e;l++)for(let e=0;e<t;e++){let t=i+Math.round(o()*s);a.set(l,e,t)}return a}static eye(e,t,n){void 0===t&&(t=e),void 0===n&&(n=1);let i=Math.min(e,t),r=this.zeros(e,t);for(let o=0;o<i;o++)r.set(o,o,n);return r}static diag(e,t,n){let i=e.length;void 0===t&&(t=i),void 0===n&&(n=t);let r=Math.min(i,t,n),o=this.zeros(t,n);for(let s=0;s<r;s++)o.set(s,s,e[s]);return o}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,i=e.columns,r=new uE(n,i);for(let o=0;o<n;o++)for(let n=0;n<i;n++)r.set(o,n,Math.min(e.get(o,n),t.get(o,n)));return r}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,i=e.columns,r=new this(n,i);for(let o=0;o<n;o++)for(let n=0;n<i;n++)r.set(o,n,Math.max(e.get(o,n),t.get(o,n)));return r}static checkMatrix(e){return lE.isMatrix(e)?e:new uE(e)}static isMatrix(e){return null!=e&&"Matrix"===e.klass}get size(){return this.rows*this.columns}apply(e){if("function"!=typeof e)throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.call(this,t,n);return this}to1DArray(){let e=[];for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}to2DArray(){let e=[];for(let t=0;t<this.rows;t++){e.push([]);for(let n=0;n<this.columns;n++)e[t].push(this.get(t,n))}return e}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let e=0;e<this.rows;e++)for(let t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}isEchelonForm(){let e=0,t=0,n=-1,i=!0,r=!1;for(;e<this.rows&&i;){for(t=0,r=!1;t<this.columns&&!1===r;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(r=!0,n=t):(i=!1,r=!0);e++}return i}isReducedEchelonForm(){let e=0,t=0,n=-1,i=!0,r=!1;for(;e<this.rows&&i;){for(t=0,r=!1;t<this.columns&&!1===r;)0===this.get(e,t)?t++:1===this.get(e,t)&&t>n?(r=!0,n=t):(i=!1,r=!0);for(let n=t+1;n<this.rows;n++)0!==this.get(e,n)&&(i=!1);e++}return i}echelonForm(){let e=this.clone(),t=0,n=0;for(;t<e.rows&&n<e.columns;){let i=t;for(let r=t;r<e.rows;r++)e.get(r,n)>e.get(i,n)&&(i=r);if(0===e.get(i,n))n++;else{e.swapRows(t,i);let r=e.get(t,n);for(let i=n;i<e.columns;i++)e.set(t,i,e.get(t,i)/r);for(let i=t+1;i<e.rows;i++){let r=e.get(i,n)/e.get(t,n);e.set(i,n,0);for(let o=n+1;o<e.columns;o++)e.set(i,o,e.get(i,o)-e.get(t,o)*r)}t++,n++}}return e}reducedEchelonForm(){let e=this.echelonForm(),t=e.columns,n=e.rows,i=n-1;for(;i>=0;)if(0===e.maxRow(i))i--;else{let r=0,o=!1;for(;r<n&&!1===o;)1===e.get(i,r)?o=!0:r++;for(let n=0;n<i;n++){let o=e.get(n,r);for(let s=r;s<t;s++){let t=e.get(n,s)-o*e.get(i,s);e.set(n,s,t)}}i--}return e}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{rows:t=1,columns:n=1}=e;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let i=new uE(this.rows*t,this.columns*n);for(let r=0;r<t;r++)for(let e=0;e<n;e++)i.setSubMatrix(this,this.rows*r,this.columns*e);return i}fill(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,e);return this}neg(){return this.mulS(-1)}getRow(e){eE(this,e);let t=[];for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}getRowVector(e){return uE.rowVector(this.getRow(e))}setRow(e,t){eE(this,e),t=nE(this,t);for(let n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){eE(this,e),eE(this,t);for(let n=0;n<this.columns;n++){let i=this.get(e,n);this.set(e,n,this.get(t,n)),this.set(t,n,i)}return this}getColumn(e){tE(this,e);let t=[];for(let n=0;n<this.rows;n++)t.push(this.get(n,e));return t}getColumnVector(e){return uE.columnVector(this.getColumn(e))}setColumn(e,t){tE(this,e),t=iE(this,t);for(let n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){tE(this,e),tE(this,t);for(let n=0;n<this.rows;n++){let i=this.get(n,e);this.set(n,e,this.get(n,t)),this.set(n,t,i)}return this}addRowVector(e){e=nE(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this}subRowVector(e){e=nE(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this}mulRowVector(e){e=nE(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this}divRowVector(e){e=nE(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this}addColumnVector(e){e=iE(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this}subColumnVector(e){e=iE(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this}mulColumnVector(e){e=iE(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this}divColumnVector(e){e=iE(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this}mulRow(e,t){eE(this,e);for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){tE(this,e);for(let n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){if(this.isEmpty())return NaN;let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxIndex(){aE(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){if(this.isEmpty())return NaN;let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minIndex(){aE(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){if(eE(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){eE(this,e),aE(this);let t=this.get(e,0),n=[e,0];for(let i=1;i<this.columns;i++)this.get(e,i)>t&&(t=this.get(e,i),n[1]=i);return n}minRow(e){if(eE(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){eE(this,e),aE(this);let t=this.get(e,0),n=[e,0];for(let i=1;i<this.columns;i++)this.get(e,i)<t&&(t=this.get(e,i),n[1]=i);return n}maxColumn(e){if(tE(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){tE(this,e),aE(this);let t=this.get(0,e),n=[0,e];for(let i=1;i<this.rows;i++)this.get(i,e)>t&&(t=this.get(i,e),n[0]=i);return n}minColumn(e){if(tE(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){tE(this,e),aE(this);let t=this.get(0,e),n=[0,e];for(let i=1;i<this.rows;i++)this.get(i,e)<t&&(t=this.get(i,e),n[0]=i);return n}diag(){let e=Math.min(this.rows,this.columns),t=[];for(let n=0;n<e;n++)t.push(this.get(n,n));return t}norm(e="frobenius"){let t=0;if("max"===e)return this.max();if("frobenius"===e){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n)*this.get(e,n);return Math.sqrt(t)}throw new RangeError(`unknown norm type: ${e}`)}cumulativeSum(){let e=0;for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this}dot(e){lE.isMatrix(e)&&(e=e.to1DArray());let t=this.to1DArray();if(t.length!==e.length)throw new RangeError("vectors do not have the same size");let n=0;for(let i=0;i<t.length;i++)n+=t[i]*e[i];return n}mmul(e){e=uE.checkMatrix(e);let t=this.rows,n=this.columns,i=e.columns,r=new uE(t,i),o=new Float64Array(n);for(let s=0;s<i;s++){for(let t=0;t<n;t++)o[t]=e.get(t,s);for(let e=0;e<t;e++){let t=0;for(let i=0;i<n;i++)t+=this.get(e,i)*o[i];r.set(e,s,t)}}return r}strassen2x2(e){e=uE.checkMatrix(e);let t=new uE(2,2);const n=this.get(0,0),i=e.get(0,0),r=this.get(0,1),o=e.get(0,1),s=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(n+l)*(i+c),h=(s+l)*i,d=n*(o-c),f=l*(a-i),g=(n+r)*c,p=u+f-g+(r-l)*(a+c),m=d+g,v=h+f,y=u-h+d+(s-n)*(i+o);return t.set(0,0,p),t.set(0,1,m),t.set(1,0,v),t.set(1,1,y),t}strassen3x3(e){e=uE.checkMatrix(e);let t=new uE(3,3);const n=this.get(0,0),i=this.get(0,1),r=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),h=e.get(0,0),d=e.get(0,1),f=e.get(0,2),g=e.get(1,0),p=e.get(1,1),m=e.get(1,2),v=e.get(2,0),y=e.get(2,1),_=e.get(2,2),b=(n-o)*(-d+p),w=(-n+o+s)*(h-d+p),C=(o+s)*(-h+d),S=n*h,x=(-n+l+c)*(h-f+m),E=(-n+l)*(f-m),k=(l+c)*(-h+f),L=(-r+c+u)*(p+v-y),D=(r-u)*(p-y),N=r*v,I=(c+u)*(-v+y),T=(-r+s+a)*(m+v-_),M=(r-a)*(m-_),A=(s+a)*(-v+_),O=S+N+i*g,R=(n+i+r-o-s-c-u)*p+w+C+S+L+N+I,P=S+x+k+(n+i+r-s-a-l-c)*m+N+T+A,F=b+s*(-h+d+g-p-m-v+_)+w+S+N+T+M,B=b+w+C+S+a*y,W=N+T+M+A+o*f,z=S+x+E+c*(-h+f+g-p-m-v+y)+L+D+N,V=L+D+N+I+l*d,U=S+x+E+k+u*_;return t.set(0,0,O),t.set(0,1,R),t.set(0,2,P),t.set(1,0,F),t.set(1,1,B),t.set(1,2,W),t.set(2,0,z),t.set(2,1,V),t.set(2,2,U),t}mmulStrassen(e){e=uE.checkMatrix(e);let t=this.clone(),n=t.rows,i=t.columns,r=e.rows,o=e.columns;function s(e,t,n){let i=e.rows,r=e.columns;if(i===t&&r===n)return e;{let i=lE.zeros(t,n);return i=i.setSubMatrix(e,0,0),i}}i!==r&&console.warn(`Multiplying ${n} x ${i} and ${r} x ${o} matrix: dimensions do not match.`);let a=Math.max(n,r),l=Math.max(i,o);return t=s(t,a,l),function e(t,n,i,r){if(i<=512||r<=512)return t.mmul(n);i%2==1&&r%2==1?(t=s(t,i+1,r+1),n=s(n,i+1,r+1)):i%2==1?(t=s(t,i+1,r),n=s(n,i+1,r)):r%2==1&&(t=s(t,i,r+1),n=s(n,i,r+1));let o=parseInt(t.rows/2,10),a=parseInt(t.columns/2,10),l=t.subMatrix(0,o-1,0,a-1),c=n.subMatrix(0,o-1,0,a-1),u=t.subMatrix(0,o-1,a,t.columns-1),h=n.subMatrix(0,o-1,a,n.columns-1),d=t.subMatrix(o,t.rows-1,0,a-1),f=n.subMatrix(o,n.rows-1,0,a-1),g=t.subMatrix(o,t.rows-1,a,t.columns-1),p=n.subMatrix(o,n.rows-1,a,n.columns-1),m=e(lE.add(l,g),lE.add(c,p),o,a),v=e(lE.add(d,g),c,o,a),y=e(l,lE.sub(h,p),o,a),_=e(g,lE.sub(f,c),o,a),b=e(lE.add(l,u),p,o,a),w=e(lE.sub(d,l),lE.add(c,h),o,a),C=e(lE.sub(u,g),lE.add(f,p),o,a),S=lE.add(m,_);S.sub(b),S.add(C);let x=lE.add(y,b),E=lE.add(v,_),k=lE.sub(m,v);k.add(y),k.add(w);let L=lE.zeros(2*S.rows,2*S.columns);return L=L.setSubMatrix(S,0,0),L=L.setSubMatrix(x,S.rows,0),L=L.setSubMatrix(E,0,S.columns),L=L.setSubMatrix(k,S.rows,S.columns),L.subMatrix(0,i-1,0,r-1)}(t,e=s(e,a,l),a,l)}scaleRows(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(t>=n)throw new RangeError("min must be smaller than max");let i=new uE(this.rows,this.columns);for(let r=0;r<this.rows;r++){const e=this.getRow(r);e.length>0&&Yx(e,{min:t,max:n,output:e}),i.setRow(r,e)}return i}scaleColumns(e={}){if("object"!=typeof e)throw new TypeError("options must be an object");const{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(t>=n)throw new RangeError("min must be smaller than max");let i=new uE(this.rows,this.columns);for(let r=0;r<this.columns;r++){const e=this.getColumn(r);e.length&&Yx(e,{min:t,max:n,output:e}),i.setColumn(r,e)}return i}flipRows(){const e=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let n=0;n<e;n++){let e=this.get(t,n),i=this.get(t,this.columns-1-n);this.set(t,n,i),this.set(t,this.columns-1-n,e)}return this}flipColumns(){const e=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let n=0;n<e;n++){let e=this.get(n,t),i=this.get(this.rows-1-n,t);this.set(n,t,i),this.set(this.rows-1-n,t,e)}return this}kroneckerProduct(e){e=uE.checkMatrix(e);let t=this.rows,n=this.columns,i=e.rows,r=e.columns,o=new uE(t*i,n*r);for(let s=0;s<t;s++)for(let t=0;t<n;t++)for(let n=0;n<i;n++)for(let a=0;a<r;a++)o.set(i*s+n,r*t+a,this.get(s,t)*e.get(n,a));return o}kroneckerSum(e){if(e=uE.checkMatrix(e),!this.isSquare()||!e.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,n=e.rows,i=this.kroneckerProduct(uE.eye(n,n)),r=uE.eye(t,t).kroneckerProduct(e);return i.add(r)}transpose(){let e=new uE(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e}sortRows(e=cE){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e=cE){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,i){rE(this,e,t,n,i);let r=new uE(t-e+1,i-n+1);for(let o=e;o<=t;o++)for(let t=n;t<=i;t++)r.set(o-e,t-n,this.get(o,t));return r}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let i=new uE(e.length,n-t+1);for(let r=0;r<e.length;r++)for(let o=t;o<=n;o++){if(e[r]<0||e[r]>=this.rows)throw new RangeError(`Row index out of range: ${e[r]}`);i.set(r,o-t,this.get(e[r],o))}return i}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let i=new uE(n-t+1,e.length);for(let r=0;r<e.length;r++)for(let o=t;o<=n;o++){if(e[r]<0||e[r]>=this.columns)throw new RangeError(`Column index out of range: ${e[r]}`);i.set(o-t,r,this.get(o,e[r]))}return i}setSubMatrix(e,t,n){if((e=uE.checkMatrix(e)).isEmpty())return this;rE(this,t,t+e.rows-1,n,n+e.columns-1);for(let i=0;i<e.rows;i++)for(let r=0;r<e.columns;r++)this.set(t+i,n+r,e.get(i,r));return this}selection(e,t){!function(e,t){if(!Kx(t))throw new TypeError("row indices must be an array");for(let n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.rows)throw new RangeError("row indices are out of range")}(this,e),function(e,t){if(!Kx(t))throw new TypeError("column indices must be an array");for(let n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.columns)throw new RangeError("column indices are out of range")}(this,t);let n=new uE(e.length,t.length);for(let i=0;i<e.length;i++){let r=e[i];for(let e=0;e<t.length;e++){let o=t[e];n.set(i,e,this.get(r,o))}}return n}trace(){let e=Math.min(this.rows,this.columns),t=0;for(let n=0;n<e;n++)t+=this.get(n,n);return t}clone(){let e=new uE(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(t,n,this.get(t,n));return e}sum(e){switch(e){case"row":return function(e){let t=oE(e.rows);for(let n=0;n<e.rows;++n)for(let i=0;i<e.columns;++i)t[n]+=e.get(n,i);return t}(this);case"column":return function(e){let t=oE(e.columns);for(let n=0;n<e.rows;++n)for(let i=0;i<e.columns;++i)t[i]+=e.get(n,i);return t}(this);case void 0:return function(e){let t=0;for(let n=0;n<e.rows;n++)for(let i=0;i<e.columns;i++)t+=e.get(n,i);return t}(this);default:throw new Error(`invalid option: ${e}`)}}product(e){switch(e){case"row":return function(e){let t=oE(e.rows,1);for(let n=0;n<e.rows;++n)for(let i=0;i<e.columns;++i)t[n]*=e.get(n,i);return t}(this);case"column":return function(e){let t=oE(e.columns,1);for(let n=0;n<e.rows;++n)for(let i=0;i<e.columns;++i)t[i]*=e.get(n,i);return t}(this);case void 0:return function(e){let t=1;for(let n=0;n<e.rows;n++)for(let i=0;i<e.columns;i++)t*=e.get(n,i);return t}(this);default:throw new Error(`invalid option: ${e}`)}}mean(e){const t=this.sum(e);switch(e){case"row":for(let e=0;e<this.rows;e++)t[e]/=this.columns;return t;case"column":for(let e=0;e<this.columns;e++)t[e]/=this.rows;return t;case void 0:return t/this.size;default:throw new Error(`invalid option: ${e}`)}}variance(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:i=this.mean(e)}=t;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!Kx(i))throw new TypeError("mean must be an array");return function(e,t,n){const i=e.rows,r=e.columns,o=[];for(let s=0;s<i;s++){let i=0,a=0,l=0;for(let t=0;t<r;t++)l=e.get(s,t)-n[s],i+=l,a+=l*l;t?o.push((a-i*i/r)/(r-1)):o.push((a-i*i/r)/r)}return o}(this,n,i);case"column":if(!Kx(i))throw new TypeError("mean must be an array");return function(e,t,n){const i=e.rows,r=e.columns,o=[];for(let s=0;s<r;s++){let r=0,a=0,l=0;for(let t=0;t<i;t++)l=e.get(t,s)-n[s],r+=l,a+=l*l;t?o.push((a-r*r/i)/(i-1)):o.push((a-r*r/i)/i)}return o}(this,n,i);case void 0:if("number"!=typeof i)throw new TypeError("mean must be a number");return function(e,t,n){const i=e.rows,r=e.columns,o=i*r;let s=0,a=0,l=0;for(let c=0;c<i;c++)for(let t=0;t<r;t++)l=e.get(c,t)-n,s+=l,a+=l*l;return t?(a-s*s/o)/(o-1):(a-s*s/o)/o}(this,n,i);default:throw new Error(`invalid option: ${e}`)}}standardDeviation(e,t){"object"==typeof e&&(t=e,e=void 0);const n=this.variance(e,t);if(void 0===e)return Math.sqrt(n);for(let i=0;i<n.length;i++)n[i]=Math.sqrt(n[i]);return n}center(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");const{center:n=this.mean(e)}=t;switch(e){case"row":if(!Kx(n))throw new TypeError("center must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let i=0;i<e.columns;i++)e.set(n,i,e.get(n,i)-t[n])}(this,n),this;case"column":if(!Kx(n))throw new TypeError("center must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let i=0;i<e.columns;i++)e.set(n,i,e.get(n,i)-t[i])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(e,t){for(let n=0;n<e.rows;n++)for(let i=0;i<e.columns;i++)e.set(n,i,e.get(n,i)-t)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}scale(e,t={}){if("object"==typeof e&&(t=e,e=void 0),"object"!=typeof t)throw new TypeError("options must be an object");let n=t.scale;switch(e){case"row":if(void 0===n)n=function(e){const t=[];for(let n=0;n<e.rows;n++){let i=0;for(let t=0;t<e.columns;t++)i+=Math.pow(e.get(n,t),2)/(e.columns-1);t.push(Math.sqrt(i))}return t}(this);else if(!Kx(n))throw new TypeError("scale must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let i=0;i<e.columns;i++)e.set(n,i,e.get(n,i)/t[n])}(this,n),this;case"column":if(void 0===n)n=function(e){const t=[];for(let n=0;n<e.columns;n++){let i=0;for(let t=0;t<e.rows;t++)i+=Math.pow(e.get(t,n),2)/(e.rows-1);t.push(Math.sqrt(i))}return t}(this);else if(!Kx(n))throw new TypeError("scale must be an array");return function(e,t){for(let n=0;n<e.rows;n++)for(let i=0;i<e.columns;i++)e.set(n,i,e.get(n,i)/t[i])}(this,n),this;case void 0:if(void 0===n)n=function(e){const t=e.size-1;let n=0;for(let i=0;i<e.columns;i++)for(let r=0;r<e.rows;r++)n+=Math.pow(e.get(r,i),2)/t;return Math.sqrt(n)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(e,t){for(let n=0;n<e.rows;n++)for(let i=0;i<e.columns;i++)e.set(n,i,e.get(n,i)/t)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}toString(e){return Qx(this,e)}}function cE(e,t){return e-t}lE.prototype.klass="Matrix","undefined"!=typeof Symbol&&(lE.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return Qx(this)}),lE.random=lE.rand,lE.randomInt=lE.randInt,lE.diagonal=lE.diag,lE.prototype.diagonal=lE.prototype.diag,lE.identity=lE.eye,lE.prototype.negate=lE.prototype.neg,lE.prototype.tensorProduct=lE.prototype.kroneckerProduct;class uE extends lE{constructor(e,t){if(super(),uE.isMatrix(e))return e.clone();if(Number.isInteger(e)&&e>=0){if(this.data=[],!(Number.isInteger(t)&&t>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<e;n++)this.data.push(new Float64Array(t))}else{if(!Kx(e))throw new TypeError("First argument must be a positive number or an array");{const n=e;if("number"!=typeof(t=(e=n.length)?n[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<e;i++){if(n[i].length!==t)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(n[i]))}}}this.rows=e,this.columns=t}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}removeRow(e){return eE(this,e),this.data.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),eE(this,e,!0),t=Float64Array.from(nE(this,t)),this.data.splice(e,0,t),this.rows+=1,this}removeColumn(e){tE(this,e);for(let t=0;t<this.rows;t++){const n=new Float64Array(this.columns-1);for(let i=0;i<e;i++)n[i]=this.data[t][i];for(let i=e+1;i<this.columns;i++)n[i-1]=this.data[t][i];this.data[t]=n}return this.columns-=1,this}addColumn(e,t){void 0===t&&(t=e,e=this.columns),tE(this,e,!0),t=iE(this,t);for(let n=0;n<this.rows;n++){const i=new Float64Array(this.columns+1);let r=0;for(;r<e;r++)i[r]=this.data[n][r];for(i[r++]=t[n];r<this.columns+1;r++)i[r]=this.data[n][r-1];this.data[n]=i}return this.columns+=1,this}}var hE,dE;dE=uE,(hE=lE).prototype.add=function(e){return"number"==typeof e?this.addS(e):this.addM(e)},hE.prototype.addS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e);return this},hE.prototype.addM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e.get(t,n));return this},hE.add=function(e,t){return new dE(e).add(t)},hE.prototype.sub=function(e){return"number"==typeof e?this.subS(e):this.subM(e)},hE.prototype.subS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e);return this},hE.prototype.subM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e.get(t,n));return this},hE.sub=function(e,t){return new dE(e).sub(t)},hE.prototype.subtract=hE.prototype.sub,hE.prototype.subtractS=hE.prototype.subS,hE.prototype.subtractM=hE.prototype.subM,hE.subtract=hE.sub,hE.prototype.mul=function(e){return"number"==typeof e?this.mulS(e):this.mulM(e)},hE.prototype.mulS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this},hE.prototype.mulM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e.get(t,n));return this},hE.mul=function(e,t){return new dE(e).mul(t)},hE.prototype.multiply=hE.prototype.mul,hE.prototype.multiplyS=hE.prototype.mulS,hE.prototype.multiplyM=hE.prototype.mulM,hE.multiply=hE.mul,hE.prototype.div=function(e){return"number"==typeof e?this.divS(e):this.divM(e)},hE.prototype.divS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e);return this},hE.prototype.divM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e.get(t,n));return this},hE.div=function(e,t){return new dE(e).div(t)},hE.prototype.divide=hE.prototype.div,hE.prototype.divideS=hE.prototype.divS,hE.prototype.divideM=hE.prototype.divM,hE.divide=hE.div,hE.prototype.mod=function(e){return"number"==typeof e?this.modS(e):this.modM(e)},hE.prototype.modS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e);return this},hE.prototype.modM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e.get(t,n));return this},hE.mod=function(e,t){return new dE(e).mod(t)},hE.prototype.modulus=hE.prototype.mod,hE.prototype.modulusS=hE.prototype.modS,hE.prototype.modulusM=hE.prototype.modM,hE.modulus=hE.mod,hE.prototype.and=function(e){return"number"==typeof e?this.andS(e):this.andM(e)},hE.prototype.andS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e);return this},hE.prototype.andM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e.get(t,n));return this},hE.and=function(e,t){return new dE(e).and(t)},hE.prototype.or=function(e){return"number"==typeof e?this.orS(e):this.orM(e)},hE.prototype.orS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e);return this},hE.prototype.orM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e.get(t,n));return this},hE.or=function(e,t){return new dE(e).or(t)},hE.prototype.xor=function(e){return"number"==typeof e?this.xorS(e):this.xorM(e)},hE.prototype.xorS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e);return this},hE.prototype.xorM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e.get(t,n));return this},hE.xor=function(e,t){return new dE(e).xor(t)},hE.prototype.leftShift=function(e){return"number"==typeof e?this.leftShiftS(e):this.leftShiftM(e)},hE.prototype.leftShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e);return this},hE.prototype.leftShiftM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e.get(t,n));return this},hE.leftShift=function(e,t){return new dE(e).leftShift(t)},hE.prototype.signPropagatingRightShift=function(e){return"number"==typeof e?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e)},hE.prototype.signPropagatingRightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e);return this},hE.prototype.signPropagatingRightShiftM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e.get(t,n));return this},hE.signPropagatingRightShift=function(e,t){return new dE(e).signPropagatingRightShift(t)},hE.prototype.rightShift=function(e){return"number"==typeof e?this.rightShiftS(e):this.rightShiftM(e)},hE.prototype.rightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e);return this},hE.prototype.rightShiftM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e.get(t,n));return this},hE.rightShift=function(e,t){return new dE(e).rightShift(t)},hE.prototype.zeroFillRightShift=hE.prototype.rightShift,hE.prototype.zeroFillRightShiftS=hE.prototype.rightShiftS,hE.prototype.zeroFillRightShiftM=hE.prototype.rightShiftM,hE.zeroFillRightShift=hE.rightShift,hE.prototype.not=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,~this.get(e,t));return this},hE.not=function(e){return new dE(e).not()},hE.prototype.abs=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.abs(this.get(e,t)));return this},hE.abs=function(e){return new dE(e).abs()},hE.prototype.acos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acos(this.get(e,t)));return this},hE.acos=function(e){return new dE(e).acos()},hE.prototype.acosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acosh(this.get(e,t)));return this},hE.acosh=function(e){return new dE(e).acosh()},hE.prototype.asin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asin(this.get(e,t)));return this},hE.asin=function(e){return new dE(e).asin()},hE.prototype.asinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asinh(this.get(e,t)));return this},hE.asinh=function(e){return new dE(e).asinh()},hE.prototype.atan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atan(this.get(e,t)));return this},hE.atan=function(e){return new dE(e).atan()},hE.prototype.atanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atanh(this.get(e,t)));return this},hE.atanh=function(e){return new dE(e).atanh()},hE.prototype.cbrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cbrt(this.get(e,t)));return this},hE.cbrt=function(e){return new dE(e).cbrt()},hE.prototype.ceil=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.ceil(this.get(e,t)));return this},hE.ceil=function(e){return new dE(e).ceil()},hE.prototype.clz32=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.clz32(this.get(e,t)));return this},hE.clz32=function(e){return new dE(e).clz32()},hE.prototype.cos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cos(this.get(e,t)));return this},hE.cos=function(e){return new dE(e).cos()},hE.prototype.cosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cosh(this.get(e,t)));return this},hE.cosh=function(e){return new dE(e).cosh()},hE.prototype.exp=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.exp(this.get(e,t)));return this},hE.exp=function(e){return new dE(e).exp()},hE.prototype.expm1=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.expm1(this.get(e,t)));return this},hE.expm1=function(e){return new dE(e).expm1()},hE.prototype.floor=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.floor(this.get(e,t)));return this},hE.floor=function(e){return new dE(e).floor()},hE.prototype.fround=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.fround(this.get(e,t)));return this},hE.fround=function(e){return new dE(e).fround()},hE.prototype.log=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log(this.get(e,t)));return this},hE.log=function(e){return new dE(e).log()},hE.prototype.log1p=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log1p(this.get(e,t)));return this},hE.log1p=function(e){return new dE(e).log1p()},hE.prototype.log10=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log10(this.get(e,t)));return this},hE.log10=function(e){return new dE(e).log10()},hE.prototype.log2=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log2(this.get(e,t)));return this},hE.log2=function(e){return new dE(e).log2()},hE.prototype.round=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.round(this.get(e,t)));return this},hE.round=function(e){return new dE(e).round()},hE.prototype.sign=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sign(this.get(e,t)));return this},hE.sign=function(e){return new dE(e).sign()},hE.prototype.sin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sin(this.get(e,t)));return this},hE.sin=function(e){return new dE(e).sin()},hE.prototype.sinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sinh(this.get(e,t)));return this},hE.sinh=function(e){return new dE(e).sinh()},hE.prototype.sqrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sqrt(this.get(e,t)));return this},hE.sqrt=function(e){return new dE(e).sqrt()},hE.prototype.tan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tan(this.get(e,t)));return this},hE.tan=function(e){return new dE(e).tan()},hE.prototype.tanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tanh(this.get(e,t)));return this},hE.tanh=function(e){return new dE(e).tanh()},hE.prototype.trunc=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.trunc(this.get(e,t)));return this},hE.trunc=function(e){return new dE(e).trunc()},hE.pow=function(e,t){return new dE(e).pow(t)},hE.prototype.pow=function(e){return"number"==typeof e?this.powS(e):this.powM(e)},hE.prototype.powS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,Math.pow(this.get(t,n),e));return this},hE.prototype.powM=function(e){if(e=dE.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,Math.pow(this.get(t,n),e.get(t,n)));return this};class fE extends lE{constructor(e){super(),this.data=e,this.rows=e.length,this.columns=e[0].length}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}}function gE(e,t){let n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0!==t?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0}class pE{constructor(e,t={}){if((e=fE.checkMatrix(e)).isEmpty())throw new Error("Matrix must be non-empty");let n=e.rows,i=e.columns;const{computeLeftSingularVectors:r=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=t;let a,l=Boolean(r),c=Boolean(o),u=!1;if(n<i)if(s){a=e.transpose(),n=a.rows,i=a.columns,u=!0;let t=l;l=c,c=t}else a=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=e.clone();let h=Math.min(n,i),d=Math.min(n+1,i),f=new Float64Array(d),g=new uE(n,h),p=new uE(i,i),m=new Float64Array(i),v=new Float64Array(n),y=new Float64Array(d);for(let E=0;E<d;E++)y[E]=E;let _=Math.min(n-1,i),b=Math.max(0,Math.min(i-2,n)),w=Math.max(_,b);for(let E=0;E<w;E++){if(E<_){f[E]=0;for(let e=E;e<n;e++)f[E]=gE(f[E],a.get(e,E));if(0!==f[E]){a.get(E,E)<0&&(f[E]=-f[E]);for(let e=E;e<n;e++)a.set(e,E,a.get(e,E)/f[E]);a.set(E,E,a.get(E,E)+1)}f[E]=-f[E]}for(let e=E+1;e<i;e++){if(E<_&&0!==f[E]){let t=0;for(let i=E;i<n;i++)t+=a.get(i,E)*a.get(i,e);t=-t/a.get(E,E);for(let i=E;i<n;i++)a.set(i,e,a.get(i,e)+t*a.get(i,E))}m[e]=a.get(E,e)}if(l&&E<_)for(let e=E;e<n;e++)g.set(e,E,a.get(e,E));if(E<b){m[E]=0;for(let e=E+1;e<i;e++)m[E]=gE(m[E],m[e]);if(0!==m[E]){m[E+1]<0&&(m[E]=0-m[E]);for(let e=E+1;e<i;e++)m[e]/=m[E];m[E+1]+=1}if(m[E]=-m[E],E+1<n&&0!==m[E]){for(let e=E+1;e<n;e++)v[e]=0;for(let e=E+1;e<n;e++)for(let t=E+1;t<i;t++)v[e]+=m[t]*a.get(e,t);for(let e=E+1;e<i;e++){let t=-m[e]/m[E+1];for(let i=E+1;i<n;i++)a.set(i,e,a.get(i,e)+t*v[i])}}if(c)for(let e=E+1;e<i;e++)p.set(e,E,m[e])}}let C=Math.min(i,n+1);if(_<i&&(f[_]=a.get(_,_)),n<C&&(f[C-1]=0),b+1<C&&(m[b]=a.get(b,C-1)),m[C-1]=0,l){for(let e=_;e<h;e++){for(let t=0;t<n;t++)g.set(t,e,0);g.set(e,e,1)}for(let e=_-1;e>=0;e--)if(0!==f[e]){for(let t=e+1;t<h;t++){let i=0;for(let r=e;r<n;r++)i+=g.get(r,e)*g.get(r,t);i=-i/g.get(e,e);for(let r=e;r<n;r++)g.set(r,t,g.get(r,t)+i*g.get(r,e))}for(let t=e;t<n;t++)g.set(t,e,-g.get(t,e));g.set(e,e,1+g.get(e,e));for(let t=0;t<e-1;t++)g.set(t,e,0)}else{for(let t=0;t<n;t++)g.set(t,e,0);g.set(e,e,1)}}if(c)for(let E=i-1;E>=0;E--){if(E<b&&0!==m[E])for(let e=E+1;e<i;e++){let t=0;for(let n=E+1;n<i;n++)t+=p.get(n,E)*p.get(n,e);t=-t/p.get(E+1,E);for(let n=E+1;n<i;n++)p.set(n,e,p.get(n,e)+t*p.get(n,E))}for(let e=0;e<i;e++)p.set(e,E,0);p.set(E,E,1)}let S=C-1,x=Number.EPSILON;for(;C>0;){let e,t;for(e=C-2;e>=-1&&-1!==e;e--){const t=Number.MIN_VALUE+x*Math.abs(f[e]+Math.abs(f[e+1]));if(Math.abs(m[e])<=t||Number.isNaN(m[e])){m[e]=0;break}}if(e===C-2)t=4;else{let n;for(n=C-1;n>=e&&n!==e;n--){let t=(n!==C?Math.abs(m[n]):0)+(n!==e+1?Math.abs(m[n-1]):0);if(Math.abs(f[n])<=x*t){f[n]=0;break}}n===e?t=3:n===C-1?t=1:(t=2,e=n)}switch(e++,t){case 1:{let t=m[C-2];m[C-2]=0;for(let n=C-2;n>=e;n--){let r=gE(f[n],t),o=f[n]/r,s=t/r;if(f[n]=r,n!==e&&(t=-s*m[n-1],m[n-1]=o*m[n-1]),c)for(let e=0;e<i;e++)r=o*p.get(e,n)+s*p.get(e,C-1),p.set(e,C-1,-s*p.get(e,n)+o*p.get(e,C-1)),p.set(e,n,r)}break}case 2:{let t=m[e-1];m[e-1]=0;for(let i=e;i<C;i++){let r=gE(f[i],t),o=f[i]/r,s=t/r;if(f[i]=r,t=-s*m[i],m[i]=o*m[i],l)for(let t=0;t<n;t++)r=o*g.get(t,i)+s*g.get(t,e-1),g.set(t,e-1,-s*g.get(t,i)+o*g.get(t,e-1)),g.set(t,i,r)}break}case 3:{const t=Math.max(Math.abs(f[C-1]),Math.abs(f[C-2]),Math.abs(m[C-2]),Math.abs(f[e]),Math.abs(m[e])),r=f[C-1]/t,o=f[C-2]/t,s=m[C-2]/t,a=f[e]/t,u=m[e]/t,h=((o+r)*(o-r)+s*s)/2,d=r*s*(r*s);let v=0;0===h&&0===d||(v=h<0?0-Math.sqrt(h*h+d):Math.sqrt(h*h+d),v=d/(h+v));let y=(a+r)*(a-r)+v,_=a*u;for(let b=e;b<C-1;b++){let t=gE(y,_);0===t&&(t=Number.MIN_VALUE);let r=y/t,o=_/t;if(b!==e&&(m[b-1]=t),y=r*f[b]+o*m[b],m[b]=r*m[b]-o*f[b],_=o*f[b+1],f[b+1]=r*f[b+1],c)for(let e=0;e<i;e++)t=r*p.get(e,b)+o*p.get(e,b+1),p.set(e,b+1,-o*p.get(e,b)+r*p.get(e,b+1)),p.set(e,b,t);if(t=gE(y,_),0===t&&(t=Number.MIN_VALUE),r=y/t,o=_/t,f[b]=t,y=r*m[b]+o*f[b+1],f[b+1]=-o*m[b]+r*f[b+1],_=o*m[b+1],m[b+1]=r*m[b+1],l&&b<n-1)for(let e=0;e<n;e++)t=r*g.get(e,b)+o*g.get(e,b+1),g.set(e,b+1,-o*g.get(e,b)+r*g.get(e,b+1)),g.set(e,b,t)}m[C-2]=y;break}case 4:if(f[e]<=0&&(f[e]=f[e]<0?-f[e]:0,c))for(let t=0;t<=S;t++)p.set(t,e,-p.get(t,e));for(;e<S&&!(f[e]>=f[e+1]);){let t=f[e];if(f[e]=f[e+1],f[e+1]=t,c&&e<i-1)for(let n=0;n<i;n++)t=p.get(n,e+1),p.set(n,e+1,p.get(n,e)),p.set(n,e,t);if(l&&e<n-1)for(let i=0;i<n;i++)t=g.get(i,e+1),g.set(i,e+1,g.get(i,e)),g.set(i,e,t);e++}C--}}if(u){let e=p;p=g,g=e}this.m=n,this.n=i,this.s=f,this.U=g,this.V=p}solve(e){let t=e,n=this.threshold,i=this.s.length,r=uE.zeros(i,i);for(let h=0;h<i;h++)Math.abs(this.s[h])<=n?r.set(h,h,0):r.set(h,h,1/this.s[h]);let o=this.U,s=this.rightSingularVectors,a=s.mmul(r),l=s.rows,c=o.rows,u=uE.zeros(l,c);for(let h=0;h<l;h++)for(let e=0;e<c;e++){let t=0;for(let n=0;n<i;n++)t+=a.get(h,n)*o.get(e,n);u.set(h,e,t)}return u.mmul(t)}solveForDiagonal(e){return this.solve(uE.diag(e))}inverse(){let e=this.V,t=this.threshold,n=e.rows,i=e.columns,r=new uE(n,this.s.length);for(let c=0;c<n;c++)for(let n=0;n<i;n++)Math.abs(this.s[n])>t&&r.set(c,n,e.get(c,n)/this.s[n]);let o=this.U,s=o.rows,a=o.columns,l=new uE(n,s);for(let c=0;c<n;c++)for(let e=0;e<s;e++){let t=0;for(let n=0;n<a;n++)t+=r.get(c,n)*o.get(e,n);l.set(c,e,t)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,n=this.s;for(let i=0,r=n.length;i<r;i++)n[i]>e&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return uE.diag(this.s)}}class mE{constructor(e){this.distances=e.distances,this.dimension=e.dimension||2,this.linkDistance=e.linkDistance}layout(){const{dimension:e,distances:t,linkDistance:n}=this;try{const n=uE.mul(uE.pow(t,2),-.5),i=n.mean("row"),r=n.mean("column"),o=n.mean();n.add(o).subRowVector(i).subColumnVector(r);const s=new pE(n),a=uE.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map((t=>uE.mul([t],[a]).toJSON()[0].splice(0,e)))}catch(i){const e=[];for(let r=0;r<t.length;r++){const t=Math.random()*n,i=Math.random()*n;e.push([t,i])}return e}}}class vE{constructor(e){this.disp=[],this.positions=e.positions,this.adjMatrix=e.adjMatrix,this.focusID=e.focusID,this.radii=e.radii,this.iterations=e.iterations||10,this.height=e.height||10,this.width=e.width||10,this.speed=e.speed||100,this.gravity=e.gravity||10,this.nodeSizeFunc=e.nodeSizeFunc,this.k=e.k||5,this.strictRadial=e.strictRadial,this.nodes=e.nodes}layout(){const e=this,t=e.positions,n=[],i=e.iterations,r=e.width/10;e.maxDisplace=r,e.disp=n;for(let o=0;o<i;o++)t.forEach(((e,t)=>{n[t]={x:0,y:0}})),e.getRepulsion(),e.updatePositions();return t}getRepulsion(){const e=this,t=e.positions,n=e.nodes,i=e.disp,r=e.k,o=e.radii||[];t.forEach(((s,a)=>{i[a]={x:0,y:0},t.forEach(((t,l)=>{if(a===l)return;if(o[a]!==o[l])return;let c=s[0]-t[0],u=s[1]-t[1],h=Math.sqrt(c*c+u*u);if(0===h){h=1;const e=a>l?1:-1;c=.01*e,u=.01*e}if(h<e.nodeSizeFunc(n[a])/2+e.nodeSizeFunc(n[l])/2){const e=r*r/h;i[a].x+=c/h*e,i[a].y+=u/h*e}}))}))}updatePositions(){const e=this,t=e.positions,n=e.disp,i=e.speed,r=e.strictRadial,o=e.focusID,s=e.maxDisplace||e.width/10;r&&n.forEach(((e,n)=>{const i=t[n][0]-t[o][0],r=t[n][1]-t[o][1],s=Math.sqrt(i*i+r*r);let a=r/s,l=-i/s;const c=Math.sqrt(e.x*e.x+e.y*e.y);let u=Math.acos((a*e.x+l*e.y)/c);u>Math.PI/2&&(u-=Math.PI/2,a*=-1,l*=-1);const h=Math.cos(u)*c;e.x=a*h,e.y=l*h}));const a=e.radii;t.forEach(((e,l)=>{if(l===o)return;const c=Math.sqrt(n[l].x*n[l].x+n[l].y*n[l].y);if(c>0&&l!==o){const u=Math.min(s*(i/800),c);if(e[0]+=n[l].x/c*u,e[1]+=n[l].y/c*u,r){let n=e[0]-t[o][0],i=e[1]-t[o][1];const r=Math.sqrt(n*n+i*i);n=n/r*a[l],i=i/r*a[l],e[0]=t[o][0]+n,e[1]=t[o][1]+i}}}))}}function yE(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}class _E extends mb{constructor(e){super(),this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const e=this,t=e.nodes,n=e.edges||[];if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const i=e.center;if(1===t.length)return t[0].x=i[0],t[0].y=i[1],void(e.onLayoutEnd&&e.onLayoutEnd());const r=e.linkDistance;let o=null;if(vb(e.focusNode)){let n=!1;for(let i=0;i<t.length;i++)t[i].id===e.focusNode&&(o=t[i],e.focusNode=o,n=!0,i=t.length);n||(o=null)}else o=e.focusNode;o||(o=t[0],e.focusNode=o);const s=function(e,t){let n=-1;return e.forEach(((e,i)=>{e.id===t&&(n=i)})),n}(t,o.id);e.focusIndex=s;const a=kb({nodes:t,edges:n},!1),l=Eb(a),c=e.maxToFocus(l,s);e.handleInfinity(l,s,c+1),e.distances=l;const u=l[s],h=e.width||500,d=e.height||500;let f=h-i[0]>i[0]?i[0]:h-i[0],g=d-i[1]>i[1]?i[1]:d-i[1];0===f&&(f=h/2),0===g&&(g=d/2);const p=g>f?f:g,m=Math.max(...u),v=[];u.forEach(((t,n)=>{e.unitRadius||(e.unitRadius=p/m),v[n]=t*e.unitRadius})),e.radii=v;const y=e.eIdealDisMatrix();e.eIdealDistances=y;const _=function(e){const t=e.length,n=e[0].length,i=[];for(let r=0;r<t;r++){const t=[];for(let i=0;i<n;i++)0!==e[r][i]?t.push(1/(e[r][i]*e[r][i])):t.push(0);i.push(t)}return i}(y);e.weights=_;let b=new mE({linkDistance:r,distances:y}).layout();b.forEach((e=>{bb(e[0])&&(e[0]=Math.random()*r),bb(e[1])&&(e[1]=Math.random()*r)})),e.positions=b,b.forEach(((e,n)=>{t[n].x=e[0]+i[0],t[n].y=e[1]+i[1]})),b.forEach((e=>{e[0]-=b[s][0],e[1]-=b[s][1]})),e.run();const w=e.preventOverlap,C=e.nodeSize;let S;const x=e.strictRadial;if(w){const n=e.nodeSpacing;let i;i=_b(n)?()=>n:Nb(n)?n:()=>0,S=C?yb(C)?e=>(C[0]>C[1]?C[0]:C[1])+i(e):e=>C+i(e):e=>{if(e.size){if(yb(e.size)){return(e.size[0]>e.size[1]?e.size[0]:e.size[1])+i(e)}if(wb(e.size)){return(e.size.width>e.size.height?e.size.width:e.size.height)+i(e)}return e.size+i(e)}return 10+i(e)};const r={nodes:t,nodeSizeFunc:S,adjMatrix:a,positions:b,radii:v,height:d,width:h,strictRadial:x,focusID:s,iterations:e.maxPreventOverlapIteration||200,k:b.length/4.5},o=new vE(r);b=o.layout()}return b.forEach(((e,n)=>{t[n].x=e[0]+i[0],t[n].y=e[1]+i[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}run(){const e=this,t=e.maxIteration,n=e.positions||[],i=e.weights||[],r=e.eIdealDistances||[],o=e.radii||[];for(let s=0;s<=t;s++){const a=s/t;e.oneIteration(a,n,o,r,i)}}oneIteration(e,t,n,i,r){const o=1-e,s=this.focusIndex;t.forEach(((a,l)=>{const c=yE(a,[0,0]),u=0===c?0:1/c;if(l===s)return;let h=0,d=0,f=0;t.forEach(((e,t)=>{if(l===t)return;const n=yE(a,e),o=0===n?0:1/n,s=i[t][l];f+=r[l][t],h+=r[l][t]*(e[0]+s*(a[0]-e[0])*o),d+=r[l][t]*(e[1]+s*(a[1]-e[1])*o)}));const g=0===n[l]?0:1/n[l];f*=o,f+=e*g*g,h*=o,h+=e*g*a[0]*u,a[0]=h/f,d*=o,d+=e*g*a[1]*u,a[1]=d/f}))}eIdealDisMatrix(){const e=this,t=e.nodes;if(!t)return[];const n=e.distances,i=e.linkDistance,r=e.radii||[],o=e.unitRadius||50,s=[];return n&&n.forEach(((n,a)=>{const l=[];n.forEach(((n,s)=>{if(a===s)l.push(0);else if(r[a]===r[s])if("data"===e.sortBy)l.push(n*(Math.abs(a-s)*e.sortStrength)/(r[a]/o));else if(e.sortBy){let i=t[a][e.sortBy]||0,c=t[s][e.sortBy]||0;vb(i)&&(i=i.charCodeAt(0)),vb(c)&&(c=c.charCodeAt(0)),l.push(n*(Math.abs(i-c)*e.sortStrength)/(r[a]/o))}else l.push(n*i/(r[a]/o));else{const e=(i+o)/2;l.push(n*e)}})),s.push(l)})),s}handleInfinity(e,t,n){const i=e.length;for(let r=0;r<i;r++)if(e[t][r]===1/0){e[t][r]=n,e[r][t]=n;for(let o=0;o<i;o++)e[r][o]!==1/0&&e[t][o]===1/0&&(e[t][o]=n+e[r][o],e[o][t]=n+e[r][o])}for(let r=0;r<i;r++)if(r!==t)for(let n=0;n<i;n++)if(e[r][n]===1/0){let i=Math.abs(e[t][r]-e[t][n]);i=0===i?1:i,e[r][n]=i}}maxToFocus(e,t){let n=0;for(let i=0;i<e[t].length;i++)e[t][i]!==1/0&&(n=e[t][i]>n?e[t][i]:n);return n}getType(){return"radial"}}class bE extends mb{constructor(e){super(),this.nodeSize=30,this.minNodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=1.5*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length;if(0===i)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const r=e.center;if(1===i)return t[0].x=r[0],t[0].y=r[1],void(e.onLayoutEnd&&e.onLayoutEnd());const o=[];let s;s=yb(e.nodeSize)?Math.max(e.nodeSize[0],e.nodeSize[1]):e.nodeSize,t.forEach((e=>{o.push(e);let t=s;yb(e.size)?t=Math.max(e.size[0],e.size[1]):_b(e.size)?t=e.size:wb(e.size)&&(t=Math.max(e.size.width,e.size.height)),s=Math.max(s,t)})),e.clockwise=void 0!==e.counterclockwise?!e.counterclockwise:e.clockwise;const a={},l={};if(o.forEach(((e,t)=>{a[e.id]=e,l[e.id]=t})),!("degree"!==e.sortBy&&vb(e.sortBy)&&void 0!==o[0][e.sortBy]||(e.sortBy="degree",_b(t[0].degree)))){const e=xb(t.length,l,n);o.forEach(((t,n)=>{t.degree=e[n]}))}o.sort(((t,n)=>n[e.sortBy]-t[e.sortBy])),e.maxValueNode=o[0],e.maxLevelDiff=e.maxLevelDiff||e.maxValueNode[e.sortBy]/4;const c=[[]];let u=c[0];o.forEach((t=>{if(u.length>0){const n=Math.abs(u[0][e.sortBy]-t[e.sortBy]);e.maxLevelDiff&&n>=e.maxLevelDiff&&(u=[],c.push(u))}u.push(t)}));let h=s+e.minNodeSpacing;if(!e.preventOverlap){const t=c.length>0&&c[0].length>1,n=(Math.min(e.width,e.height)/2-h)/(c.length+(t?1:0));h=Math.min(h,n)}let d=0;if(c.forEach((t=>{let n=e.sweep;void 0===n&&(n=2*Math.PI-2*Math.PI/t.length);const i=t.dTheta=n/Math.max(1,t.length-1);if(t.length>1&&e.preventOverlap){const e=Math.cos(i)-Math.cos(0),t=Math.sin(i)-Math.sin(0),n=Math.sqrt(h*h/(e*e+t*t));d=Math.max(n,d)}t.r=d,d+=h})),e.equidistant){let e=0,t=0;for(let n=0;n<c.length;n++){const i=c[n].r-t;e=Math.max(e,i)}t=0,c.forEach(((n,i)=>{0===i&&(t=n.r),n.r=t,t+=e}))}return c.forEach((t=>{const n=t.dTheta,i=t.r;t.forEach(((t,o)=>{const s=e.startAngle+(e.clockwise?1:-1)*n*o;t.x=r[0]+i*Math.cos(s),t.y=r[1]+i*Math.sin(s)}))})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}getType(){return"concentric"}}class wE extends mb{constructor(e){super(),this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const e=this,{nodes:t,edges:n=[]}=e,i=e.center;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());if(1===t.length)return t[0].x=i[0],t[0].y=i[1],void(e.onLayoutEnd&&e.onLayoutEnd());const r=e.linkDistance,o=kb({nodes:t,edges:n},!1),s=Eb(o);e.handleInfinity(s);const a=((e,t)=>{const n=[];return e.forEach((e=>{const i=[];e.forEach((e=>{i.push(e*t)})),n.push(i)})),n})(s,r);e.scaledDistances=a;const l=e.runMDS();return e.positions=l,l.forEach(((e,n)=>{t[n].x=e[0]+i[0],t[n].y=e[1]+i[1]})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}runMDS(){const e=this.scaledDistances,t=uE.mul(uE.pow(e,2),-.5),n=t.mean("row"),i=t.mean("column"),r=t.mean();t.add(r).subRowVector(n).subColumnVector(i);const o=new pE(t),s=uE.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map((e=>uE.mul([e],[s]).toJSON()[0].splice(0,2)))}handleInfinity(e){let t=-999999;e.forEach((e=>{e.forEach((e=>{e!==1/0&&t<e&&(t=e)}))})),e.forEach(((n,i)=>{n.forEach(((n,r)=>{n===1/0&&(e[i][r]=t)}))}))}getType(){return"mds"}}class CE extends mb{constructor(e){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){var e,t;const n=this,i=n.nodes;if(void 0!==n.timeInterval&&"undefined"!=typeof window&&window.clearInterval(n.timeInterval),!i||0===i.length)return void(null===(e=n.onLayoutEnd)||void 0===e||e.call(n));n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const r=n.center;if(1===i.length)return i[0].x=r[0],i[0].y=r[1],void(null===(t=n.onLayoutEnd)||void 0===t||t.call(n));const o={},s={};return i.forEach(((e,t)=>{_b(e.x)||(e.x=Math.random()*this.width),_b(e.y)||(e.y=Math.random()*this.height),o[e.id]=e,s[e.id]=t})),n.nodeMap=o,n.nodeIdxMap=s,n.run()}run(){var e;const t=this,n=t.nodes;if(!n)return;const{edges:i,maxIteration:r,workerEnabled:o,clustering:s}=t,a={};if(s&&n.forEach((e=>{void 0===a[e.cluster]&&(a[e.cluster]={name:e.cluster,cx:0,cy:0,count:0})})),o){for(let e=0;e<r;e++)t.runOneStep(a);null===(e=t.onLayoutEnd)||void 0===e||e.call(t)}else{if("undefined"==typeof window)return;let e=0;this.timeInterval=window.setInterval((()=>{var n;t.runOneStep(a),e++,e>=r&&(null===(n=t.onLayoutEnd)||void 0===n||n.call(t),window.clearInterval(t.timeInterval))}),0)}return{nodes:n,edges:i}}runOneStep(e){var t;const n=this,i=n.nodes;if(!i)return;const{edges:r,center:o,gravity:s,speed:a,clustering:l}=n,c=n.height*n.width,u=Math.sqrt(c)/10,h=c/(i.length+1),d=Math.sqrt(h),f=[];if(i.forEach(((e,t)=>{f[t]={x:0,y:0}})),n.applyCalculate(i,r,f,d,h),l){for(const n in e)e[n].cx=0,e[n].cy=0,e[n].count=0;i.forEach((t=>{const n=e[t.cluster];_b(t.x)&&(n.cx+=t.x),_b(t.y)&&(n.cy+=t.y),n.count++}));for(const n in e)e[n].cx/=e[n].count,e[n].cy/=e[n].count;const t=n.clusterGravity||s;i.forEach(((n,i)=>{if(!_b(n.x)||!_b(n.y))return;const r=e[n.cluster],o=Math.sqrt((n.x-r.cx)*(n.x-r.cx)+(n.y-r.cy)*(n.y-r.cy)),s=d*t;f[i].x-=s*(n.x-r.cx)/o,f[i].y-=s*(n.y-r.cy)/o}))}i.forEach(((e,t)=>{if(!_b(e.x)||!_b(e.y))return;const n=.01*d*s;f[t].x-=n*(e.x-o[0]),f[t].y-=n*(e.y-o[1])})),i.forEach(((e,t)=>{if(_b(e.fx)&&_b(e.fy))return e.x=e.fx,void(e.y=e.fy);if(!_b(e.x)||!_b(e.y))return;const n=Math.sqrt(f[t].x*f[t].x+f[t].y*f[t].y);if(n>0){const i=Math.min(u*(a/800),n);e.x+=f[t].x/n*i,e.y+=f[t].y/n*i}})),null===(t=n.tick)||void 0===t||t.call(n)}applyCalculate(e,t,n,i,r){this.calRepulsive(e,n,r),t&&this.calAttractive(t,n,i)}calRepulsive(e,t,n){e.forEach(((i,r)=>{t[r]={x:0,y:0},e.forEach(((e,o)=>{if(r===o)return;if(!(_b(i.x)&&_b(e.x)&&_b(i.y)&&_b(e.y)))return;let s=i.x-e.x,a=i.y-e.y,l=s*s+a*a;if(0===l){l=1;const e=r>o?1:-1;s=.01*e,a=.01*e}const c=n/l;t[r].x+=s*c,t[r].y+=a*c}))}))}calAttractive(e,t,n){e.forEach((e=>{const i=Sb(e,"source"),r=Sb(e,"target");if(!i||!r)return;const o=this.nodeIdxMap[i],s=this.nodeIdxMap[r];if(o===s)return;const a=this.nodeMap[i],l=this.nodeMap[r];if(!(_b(l.x)&&_b(a.x)&&_b(l.y)&&_b(a.y)))return;const c=l.x-a.x,u=l.y-a.y,h=Math.sqrt(c*c+u*u),d=h*h/n;t[s].x-=c/h*d,t[s].y-=u/h*d,t[o].x+=c/h*d,t[o].y+=u/h*d}))}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"fruchterman"}}function SE(e,t,n,i){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function xE(e,t,n,i,r){var o={};return Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var EE,kE;kE=EE||(EE={}),function(e){var t="object"==typeof y?y:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=i(kE);function i(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===t.Reflect?t.Reflect=kE:n=i(t.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!o&&!s,l={create:o?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:a?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,d=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(u||"function"!=typeof WeakMap?ne():WeakMap);function g(e,t,n,i){if(R(n)){if(!j(e))throw new TypeError;if(!K(t))throw new TypeError;return x(e,t)}if(!j(e))throw new TypeError;if(!B(t))throw new TypeError;if(!B(i)&&!R(i)&&!P(i))throw new TypeError;return P(i)&&(i=void 0),E(e,t,n=H(n),i)}function p(e,t){function n(n,i){if(!B(n))throw new TypeError;if(!R(i)&&!q(i))throw new TypeError;T(e,t,n,i)}return n}function m(e,t,n,i){if(!B(n))throw new TypeError;return R(i)||(i=H(i)),T(e,t,n,i)}function v(e,t,n){if(!B(t))throw new TypeError;return R(n)||(n=H(n)),L(e,t,n)}function y(e,t,n){if(!B(t))throw new TypeError;return R(n)||(n=H(n)),D(e,t,n)}function _(e,t,n){if(!B(t))throw new TypeError;return R(n)||(n=H(n)),N(e,t,n)}function b(e,t,n){if(!B(t))throw new TypeError;return R(n)||(n=H(n)),I(e,t,n)}function w(e,t){if(!B(e))throw new TypeError;return R(t)||(t=H(t)),M(e,t)}function C(e,t){if(!B(e))throw new TypeError;return R(t)||(t=H(t)),A(e,t)}function S(e,t,n){if(!B(t))throw new TypeError;R(n)||(n=H(n));var i=k(t,n,!1);if(R(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var r=f.get(t);return r.delete(n),r.size>0||f.delete(t),!0}function x(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!R(i)&&!P(i)){if(!K(i))throw new TypeError;t=i}}return t}function E(e,t,n,i){for(var r=e.length-1;r>=0;--r){var o=(0,e[r])(t,n,i);if(!R(o)&&!P(o)){if(!B(o))throw new TypeError;i=o}}return i}function k(e,t,n){var i=f.get(e);if(R(i)){if(!n)return;i=new h,f.set(e,i)}var r=i.get(t);if(R(r)){if(!n)return;r=new h,i.set(t,r)}return r}function L(e,t,n){if(D(e,t,n))return!0;var i=J(t);return!P(i)&&L(e,i,n)}function D(e,t,n){var i=k(t,n,!1);return!R(i)&&V(i.has(e))}function N(e,t,n){if(D(e,t,n))return I(e,t,n);var i=J(t);return P(i)?void 0:N(e,i,n)}function I(e,t,n){var i=k(t,n,!1);if(!R(i))return i.get(e)}function T(e,t,n,i){k(n,i,!0).set(e,t)}function M(e,t){var n=A(e,t),i=J(e);if(null===i)return n;var r=M(i,t);if(r.length<=0)return n;if(n.length<=0)return r;for(var o=new d,s=[],a=0,l=n;a<l.length;a++){var c=l[a];o.has(c)||(o.add(c),s.push(c))}for(var u=0,h=r;u<h.length;u++)c=h[u],o.has(c)||(o.add(c),s.push(c));return s}function A(e,t){var n=[],i=k(e,t,!1);if(R(i))return n;for(var r=Y(i.keys()),o=0;;){var s=Z(r);if(!s)return n.length=o,n;var a=X(s);try{n[o]=a}catch(zWe){try{Q(r)}finally{throw zWe}}o++}}function O(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function R(e){return void 0===e}function P(e){return null===e}function F(e){return"symbol"==typeof e}function B(e){return"object"==typeof e?null!==e:"function"==typeof e}function W(e,t){switch(O(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=$(e,i);if(void 0!==r){var o=r.call(e,n);if(B(o))throw new TypeError;return o}return z(e,"default"===n?"number":n)}function z(e,t){if("string"===t){var n=e.toString;if(G(n)&&!B(r=n.call(e)))return r;if(G(i=e.valueOf)&&!B(r=i.call(e)))return r}else{var i;if(G(i=e.valueOf)&&!B(r=i.call(e)))return r;var r,o=e.toString;if(G(o)&&!B(r=o.call(e)))return r}throw new TypeError}function V(e){return!!e}function U(e){return""+e}function H(e){var t=W(e,3);return F(t)?t:U(t)}function j(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function G(e){return"function"==typeof e}function K(e){return"function"==typeof e}function q(e){switch(O(e)){case 3:case 4:return!0;default:return!1}}function $(e,t){var n=e[t];if(null!=n){if(!G(n))throw new TypeError;return n}}function Y(e){var t=$(e,r);if(!G(t))throw new TypeError;var n=t.call(e);if(!B(n))throw new TypeError;return n}function X(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function Q(e){var t=e.return;t&&t.call(e)}function J(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c)return t;if(t!==c)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var r=i.constructor;return"function"!=typeof r||r===e?t:r}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[r]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,r=n+1;r<i;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[r]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function o(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[r]=function(){return this.keys()},e}()}function ne(){var e=16,n=l.create(),i=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var e;do{e="@@WeakMap@@"+c()}while(l.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:l.create()})}return e[i]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function c(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<e;++i){var r=t[i];4!==i&&6!==i&&8!==i||(n+="-"),r<16&&(n+="0"),n+=r.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",g),e("metadata",p),e("defineMetadata",m),e("hasMetadata",v),e("hasOwnMetadata",y),e("getMetadata",_),e("getOwnMetadata",b),e("getMetadataKeys",w),e("getOwnMetadataKeys",C),e("deleteMetadata",S)}(n)}();var LE=1;function DE(){return LE++}var NE=function e(t){F(this,e)},IE=function(){function e(t){F(this,e),this.clazz=void 0,this.components=[],this.entities=[],this.lookup={},this.clazz=t}var t;return P(e,[{key:"clear",value:function(){this.components=[],this.entities=[],this.lookup={}}},{key:"contains",value:function(e){return this.lookup[e]>-1}},{key:"create",value:function(e,t){this.lookup[e]=this.components.length;var n=new this.clazz(t||{});return this.components.push(n),this.entities.push(e),n}},{key:"remove",value:function(e){var t=this.lookup[e];t>-1&&t<this.components.length-1&&(this.components[t]=this.components[this.components.length-1],this.entities[t]=this.entities[this.entities.length-1],this.lookup[this.entities[t]]=t),this.components.pop(),this.entities.pop(),delete this.lookup[e]}},{key:"removeKeepSorted",value:function(e){var t=this.lookup[e];if(t>-1){var n=this.entities[t];if(t<this.components.length-1){for(var i=t+1;i<this.components.length;++i)this.components[i-1]=this.components[i];for(var r=t+1;r<this.entities.length;++r)this.entities[r-1]=this.entities[r],this.lookup[this.entities[r-1]]=r-1}this.components.pop(),this.entities.pop(),delete this.lookup[n]}}},{key:"moveItem",value:function(e,t){if(e!==t){for(var n=this.components[e],i=this.entities[e],r=e<t?1:-1,o=e;o!==t;o+=r){var s=o+r;this.components[o]=this.components[s],this.entities[o]=this.entities[s],this.lookup[this.entities[o]]=o}this.components[t]=n,this.entities[t]=i,this.lookup[i]=t}}},{key:"getEntity",value:function(e){return this.entities[e]}},{key:"getComponent",value:function(e){return this.components[e]}},{key:"getComponentByEntity",value:function(e){var t=this.lookup[e];return t>-1?this.components[t]:null}},{key:"getCount",value:function(){return this.components.length}},{key:"getEntityByComponentIndex",value:function(e){for(var t=0,n=Object.keys(this.lookup);t<n.length;t++){var i=n[t],r=Number(i);if(this.lookup[r]===e)return r}return-1}},{key:"find",value:function(e){for(var t=0;t<this.getCount();t++){var n=this.getComponent(t);if(e(n,t))return n}return null}},{key:"findIndex",value:function(e){for(var t=0;t<this.getCount();t++){if(e(this.getComponent(t),t))return t}return-1}},{key:"forEach",value:function(e){for(var t=0,n=Object.keys(this.lookup);t<n.length;t++){var i=n[t],r=Number(i),o=this.lookup[r];e(r,this.getComponent(o))}}},{key:"forEachAsync",value:(t=B(W.mark((function e(t){var n,i,r,o,s;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,i=Object.keys(this.lookup);case 1:if(!(n<i.length)){e.next=10;break}return r=i[n],o=Number(r),s=this.lookup[o],e.next=7,t(o,this.getComponent(s));case 7:n++,e.next=1;break;case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"map",value:function(e){for(var t=[],n=0,i=Object.keys(this.lookup);n<i.length;n++){var r=i[n],o=Number(r),s=this.lookup[o];t.push(e(o,this.getComponent(s)))}return t}}]),e}();var TE=["inject","multi_inject","name","unmanaged","named","optional"],ME="Request",AE="Singleton",OE="Transient",RE="ConstantValue",PE="Constructor",FE="DynamicValue",BE="Factory",WE="Function",zE="Instance",VE="Invalid",UE="Provider",HE="ClassProperty",jE="ConstructorArgument",GE="Variable",KE=0;function qE(){return KE++}var $E=function(){function e(e,t){this.id=qE(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=VE,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===AE&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}(),YE="No matching bindings found for serviceIdentifier:",XE=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata("inversify:paramtypes",e),userGeneratedMetadata:Reflect.getMetadata("inversify:tagged",e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata("inversify:tagged_props",e)||[]},e}(),ZE=2,QE=0,JE=1;function ek(e){return e instanceof RangeError||"Maximum call stack size exceeded"===e.message}function tk(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function nk(e,t,n){var i="",r=n(e,t);return 0!==r.length&&(i="\nRegistered bindings:",r.forEach((function(e){var t="Object";null!==e.implementationType&&(t=ok(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i}function ik(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||ik(e.parentRequest,t))}function rk(e){e.childRequests.forEach((function(e){if(ik(e,e.serviceIdentifier)){var t=function(e){return function e(t,n){void 0===n&&(n=[]);var i=tk(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(e);throw new Error("Circular dependency found: "+t)}rk(e)}))}function ok(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}var sk=function(){function e(e){this.id=qE(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),ak=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return"named"===this.key?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}(),lk=function(e,t){this.parentContext=e,this.rootRequest=t};function ck(e,t,n,i){hk("inversify:tagged",e,t,i,n)}function uk(e,t,n){hk("inversify:tagged_props",e.constructor,t,n)}function hk(e,t,n,i,r){var o={},s="number"==typeof r,a=void 0!==r&&s?r.toString():n;if(s&&void 0!==n)throw new Error("The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.");Reflect.hasOwnMetadata(e,t)&&(o=Reflect.getMetadata(e,t));var l=o[a];if(Array.isArray(l))for(var c=0,u=l;c<u.length;c++){var h=u[c];if(h.key===i.key)throw new Error("Metadata key was used more than once in a parameter: "+h.key.toString())}else l=[];l.push(i),o[a]=l,Reflect.defineMetadata(e,o,t)}var dk=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();function fk(e){return function(t,n,i){if(void 0===e)throw new Error(function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."}(t.name));var r=new ak("inject",e);"number"==typeof i?ck(t,n,i,r):uk(t,n,r)}}var gk=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),pk=function(){function e(e,t,n,i){this.id=qE(),this.type=e,this.serviceIdentifier=n,this.name=new gk(t||""),this.metadata=new Array;var r=null;"string"==typeof i?r=new ak("named",i):i instanceof ak&&(r=i),null!==r&&this.metadata.push(r)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag("multi_inject")},e.prototype.matchesArray=function(e){return this.matchesTag("multi_inject")(e)},e.prototype.isNamed=function(){return this.hasTag("named")},e.prototype.isTagged=function(){return this.metadata.some((function(e){return TE.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag("optional")(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return"named"===e.key}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return TE.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag("named")(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,r=t.metadata;i<r.length;i++){var o=r[i];if(o.key===e&&o.value===n)return!0}return!1}},e}(),mk=function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e};function vk(e,t,n,i){var r=e.getConstructorMetadata(n),o=r.compilerGeneratedMetadata;if(void 0===o)throw new Error("Missing required @injectable annotation in: "+t+".");var s=r.userGeneratedMetadata,a=Object.keys(s),l=0===n.length&&a.length>0,c=a.length>n.length,u=function(e,t,n,i,r){for(var o=[],s=0;s<r;s++){var a=yk(s,e,t,n,i);null!==a&&o.push(a)}return o}(i,t,o,s,l||c?a.length:n.length),h=_k(e,n);return mk(mk([],u),h)}function yk(e,t,n,i,r){var o=r[e.toString()]||[],s=wk(o),a=!0!==s.unmanaged,l=i[e],c=s.inject||s.multiInject;if((l=c||l)instanceof dk&&(l=l.unwrap()),a){if(!t&&(l===Object||l===Function||void 0===l))throw new Error("Missing required @inject or @multiInject annotation in: argument "+e+" in class "+n+".");var u=new pk(jE,s.targetName,l);return u.metadata=o,u}return null}function _k(e,t){for(var n=e.getPropertiesMetadata(t),i=[],r=0,o=Object.keys(n);r<o.length;r++){var s=o[r],a=n[s],l=wk(n[s]),c=l.targetName||s,u=l.inject||l.multiInject,h=new pk(HE,c,u);h.metadata=a,i.push(h)}var d=Object.getPrototypeOf(t.prototype).constructor;if(d!==Object){var f=_k(e,d);i=mk(mk([],i),f)}return i}function bk(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var i=vk(e,ok(n),n,!0),r=i.map((function(e){return e.metadata.filter((function(e){return"unmanaged"===e.key}))})),o=[].concat.apply([],r).length,s=i.length-o;return s>0?s:bk(e,n)}return 0}function wk(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t.inject,multiInject:t.multi_inject,targetName:t.name,unmanaged:t.unmanaged}}var Ck=function(){function e(e,t,n,i,r){this.id=qE(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=r,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var r=new e(t,this.parentContext,this,n,i);return this.childRequests.push(r),r},e}();function Sk(e){return e._bindingDictionary}function xk(e,t,n,i,r){var o=kk(n.container,r.serviceIdentifier),s=[];return o.length===QE&&n.container.options.autoBindInjectable&&"function"==typeof r.serviceIdentifier&&e.getConstructorMetadata(r.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(r.serviceIdentifier).toSelf(),o=kk(n.container,r.serviceIdentifier)),s=t?o:o.filter((function(e){var t=new Ck(e.serviceIdentifier,n,i,e,r);return e.constraint(t)})),function(e,t,n,i){switch(t.length){case QE:if(n.isOptional())return t;var r=tk(e),o=YE;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),r=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==r&&r.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}(r,n),o+=nk(i,r,kk),new Error(o);case JE:if(!n.isArray())return t;case ZE:default:if(n.isArray())return t;o="Ambiguous match found for serviceIdentifier: "+(r=tk(e));throw o+=nk(i,r,kk),new Error(o)}}(r.serviceIdentifier,s,r,n.container),s}function Ek(e,t,n,i,r,o){var s,a;if(null===r){s=xk(e,t,i,null,o),a=new Ck(n,i,null,s,o);var l=new lk(i,a);i.addPlan(l)}else s=xk(e,t,i,r,o),a=r.addChildRequest(o.serviceIdentifier,s,o);s.forEach((function(t){var n=null;if(o.isArray())n=a.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;n=a}if(t.type===zE&&null!==t.implementationType){var r=function(e,t){return vk(e,ok(t),t,!1)}(e,t.implementationType);if(!i.container.options.skipBaseClassChecks){var s=bk(e,t.implementationType);if(r.length<s){var l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."}(ok(t.implementationType));throw new Error(l)}}r.forEach((function(t){Ek(e,!1,t.serviceIdentifier,i,n,t)}))}}))}function kk(e,t){var n=[],i=Sk(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=kk(e.parent,t)),n}function Lk(e,t,n,i,r,o,s,a){void 0===a&&(a=!1);var l=new sk(t),c=function(e,t,n,i,r,o){var s=new ak(e?"multi_inject":"inject",n),a=new pk(t,i,n,s);if(void 0!==r){var l=new ak(r,o);a.metadata.push(l)}return a}(n,i,r,"",o,s);try{return Ek(e,a,r,l,null,c),l}catch(u){throw ek(u)&&l.plan&&rk(l.plan.rootRequest),u}}function Dk(e,t,n){var i,r,o=null;if(t.length>0){var s=t.filter((function(e){return null!==e.target&&e.target.type===jE})).map(n);r=s,o=function(e,t,n){var i=t.filter((function(e){return null!==e.target&&e.target.type===HE})),r=i.map(n);return i.forEach((function(t,n){var i;i=t.target.name.value();var o=r[n];e[i]=o})),e}(o=new((i=e).bind.apply(i,function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e}([void 0],r))),t,n)}else o=new e;return function(e,t){if(Reflect.hasMetadata("post_construct",e)){var n=Reflect.getMetadata("post_construct",e);try{t[n.value]()}catch(zWe){throw new Error(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]}(e.name,zWe.message))}}}(e,o),o}var Nk=function(e,t,n){try{return n()}catch(i){throw ek(i)?new Error(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."}(e,t.toString())):i}},Ik=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,i=t.childRequests,r=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(r&&o)return i.map((function(t){return Ik(e)(t)}));var s=null;if(!t.target.isOptional()||0!==n.length){var a=n[0],l=a.scope===AE,c=a.scope===ME;if(l&&a.activated)return a.cache;if(c&&null!==e&&e.has(a.id))return e.get(a.id);if(a.type===RE)s=a.cache,a.activated=!0;else if(a.type===WE)s=a.cache,a.activated=!0;else if(a.type===PE)s=a.implementationType;else if(a.type===FE&&null!==a.dynamicValue)s=Nk("toDynamicValue",a.serviceIdentifier,(function(){return a.dynamicValue(t.parentContext)}));else if(a.type===BE&&null!==a.factory)s=Nk("toFactory",a.serviceIdentifier,(function(){return a.factory(t.parentContext)}));else if(a.type===UE&&null!==a.provider)s=Nk("toProvider",a.serviceIdentifier,(function(){return a.provider(t.parentContext)}));else{if(a.type!==zE||null===a.implementationType){var u=tk(t.serviceIdentifier);throw new Error("Invalid binding type: "+u)}s=Dk(a.implementationType,i,Ik(e))}return"function"==typeof a.onActivation&&(s=a.onActivation(t.parentContext,s)),l&&(a.cache=s,a.activated=!0),c&&null!==e&&!e.has(a.id)&&e.set(a.id,s),s}}};var Tk=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||Tk(n,t))},Mk=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new ak(e,t),n}},Ak=Mk("named"),Ok=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}},Rk=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new Pk(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=Ak(e),new Pk(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new Pk(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=Mk(e)(t),new Pk(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return Ok(e)(t.parentRequest)},new Pk(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return Ak(e)(t.parentRequest)},new Pk(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return Mk(e)(t)(n.parentRequest)},new Pk(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return Tk(t,Ok(e))},new Pk(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!Tk(t,Ok(e))},new Pk(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return Tk(t,Ak(e))},new Pk(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!Tk(t,Ak(e))},new Pk(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return Tk(n,Mk(e)(t))},new Pk(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!Tk(n,Mk(e)(t))},new Pk(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return Tk(t,e)},new Pk(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!Tk(t,e)},new Pk(this._binding)},e}(),Pk=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new Rk(this._binding)},e}(),Fk=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new Rk(this._binding),this._bindingOnSyntax=new Pk(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}(),Bk=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=ME,new Fk(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=AE,new Fk(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=OE,new Fk(this._binding)},e}(),Wk=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new Rk(this._binding),this._bindingOnSyntax=new Pk(this._binding),this._bindingInSyntax=new Bk(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}(),zk=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=zE,this._binding.implementationType=e,new Wk(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=RE,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=AE,new Fk(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=FE,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new Wk(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=PE,this._binding.implementationType=e,this._binding.scope=AE,new Fk(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=BE,this._binding.factory=e,this._binding.scope=AE,new Fk(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error("Value provided to function binding must be a function!");var t=this.toConstantValue(e);return this._binding.type=WE,this._binding.scope=AE,t},e.prototype.toAutoFactory=function(e){return this._binding.type=BE,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=AE,new Fk(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=UE,this._binding.provider=e,this._binding.scope=AE,new Fk(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),Vk=function(){function e(){}return e.of=function(t,n){var i=new e;return i.bindings=t,i.middleware=n,i},e}(),Uk=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error("NULL argument");if(null==t)throw new Error("NULL argument");var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error("NULL argument");var t=this._map.get(e);if(void 0!==t)return t;throw new Error("Key Not Found")},e.prototype.remove=function(e){if(null==e)throw new Error("NULL argument");if(!this._map.delete(e))throw new Error("Key Not Found")},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,i){var r=n.filter((function(t){return!e(t)}));r.length>0?t._map.set(i,r):t._map.delete(i)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error("NULL argument");return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}(),Hk=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},jk=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(zWe){o=[6,zWe],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Gk=function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e},Kk=function(){function e(e){this._appliedMiddleware=[];var t=e||{};if("object"!=typeof t)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===t.defaultScope)t.defaultScope=OE;else if(t.defaultScope!==AE&&t.defaultScope!==OE&&t.defaultScope!==ME)throw new Error("Invalid Container option. Default scope must be a string ('singleton' or 'transient').");if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=qE(),this._bindingDictionary=new Uk,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new XE}return e.merge=function(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=new e,s=Gk([t,n],i).map((function(e){return Sk(e)})),a=Sk(o);function l(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s.forEach((function(e){l(e,a)})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=e;i<r.length;i++){var o=r[i],s=n(o.id);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Hk(this,void 0,void 0,(function(){var t,n,i,r,o;return jk(this,(function(s){switch(s.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,s.label=1;case 1:return n<i.length?(r=i[n],o=t(r.id),[4,r.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:s.sent(),s.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=i(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||OE,n=new $E(e,t);return this._bindingDictionary.add(e,n),new zk(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(zWe){throw new Error("Could not unbind serviceIdentifier: "+tk(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new Uk},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,"named",t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),o=function(e,t,n,i){var r=new pk(GE,"",t,new ak(n,i)),o=new sk(e);return new Ck(t,o,null,[],r)}(this,e,t,n);i=r.some((function(e){return e.constraint(o)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(Vk.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,GE,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,GE,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,"named",t)},e.prototype.getAll=function(e){return this._get(!0,!0,GE,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,GE,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,"named",t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach((function(e){t.applyMiddleware(e)})),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var r=e.rebind.bind(e)(i);return t(r,n),r}};return function(i){return{bindFunction:(r=i,function(n){var i=e.bind.bind(e)(n);return t(i,r),i}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(i),unbindFunction:function(t){e.unbind.bind(e)(t)}};var r}},e.prototype._get=function(e,t,n,i,r,o){var s=null,a={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:r,serviceIdentifier:i,targetType:n,value:o};if(this._middleware){if(null==(s=this._middleware(a)))throw new Error("Invalid return type in middleware. Middleware must return!")}else s=this._planAndResolve()(a);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=Lk(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return Ik(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},e}();function qk(){return function(e){if(Reflect.hasOwnMetadata("inversify:paramtypes",e))throw new Error("Cannot apply @injectable decorator multiple times.");var t=Reflect.getMetadata("design:paramtypes",e)||[];return Reflect.defineMetadata("inversify:paramtypes",t,e),e}}function $k(e){return function(t,n,i){var r=new ak("named",e);"number"==typeof i?ck(t,n,i,r):uk(t,n,r)}}var Yk={HierarchyComponentManager:Symbol("HierarchyComponentManager"),TransformComponentManager:Symbol("TransformComponentManager"),NameComponentManager:Symbol("NameComponentManager"),SceneGraphSystem:Symbol("SceneGraphSystem"),FrameGraphSystem:Symbol("FrameGraphSystem"),ResourcePool:Symbol("ResourcePool"),ResourceHandleComponentManager:Symbol("ResourceHandleComponentManager"),PassNodeComponentManager:Symbol("PassNodeComponentManager"),RendererSystem:Symbol("RendererSystem"),RenderPass:Symbol("RenderPass"),RenderPassFactory:Symbol("Factory<IRenderPass>"),Renderable:Symbol("Factory<IRenderPass>"),MeshSystem:Symbol("MeshSystem"),MeshComponentManager:Symbol("MeshComponentManager"),CullableComponentManager:Symbol("CullableComponentManager"),Geometry:Symbol("Geometry"),GeometrySystem:Symbol("GeometrySystem"),GeometryComponentManager:Symbol("GeometryComponentManager"),Material:Symbol("Material"),MaterialSystem:Symbol("MaterialSystem"),MaterialComponentManager:Symbol("MaterialComponentManager"),ForwardRenderPath:Symbol("ForwardRenderPath"),ComputeSystem:Symbol("ComputeSystem"),ComputeComponentManager:Symbol("ComputeComponentManager"),ComputeStrategy:Symbol("ComputeStrategy"),Systems:Symbol("Systems"),World:Symbol("World"),RenderEngine:Symbol("RenderEngine"),WebGPUEngine:Symbol("WebGPUEngine"),WebGLEngine:Symbol("WebGLEngine"),ShaderModuleService:Symbol("ShaderModuleService"),ConfigService:Symbol("ConfigService"),InteractorService:Symbol("InteractorService"),IEventEmitter:Symbol("IEventEmitter"),Light:Symbol("Light")},Xk=function e(){F(this,e),this.index=void 0},Zk=function e(){F(this,e),this.name=void 0,this.data=void 0,this.execute=void 0,this.tearDown=void 0},Qk=function(){function e(){F(this,e),this.name=void 0,this.refCount=0,this.hasSideEffect=!1,this.devirtualize=[],this.destroy=[],this.reads=[],this.writes=[]}return P(e,[{key:"read",value:function(e){return this.reads.find((function(t){return t.index===e.index}))||this.reads.push(e),e}},{key:"sample",value:function(e){return this.read(e),e}},{key:"write",value:function(e,t){if(this.writes.find((function(e){return e.index===t.index})))return t;var n=e.getResourceNode(t);n.resource.version++,n.resource.imported&&(this.hasSideEffect=!0);var i=e.createResourceNode(n.resource);return e.getResourceNode(i).writer=this,this.writes.push(i),i}}]),e}(),Jk=function e(){F(this,e),this.first=void 0,this.last=void 0};function eL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var tL,nL,iL,rL,oL,sL=function(e){z(n,Jk);var t=eL(n);function n(){var e;F(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).version=0,e.refs=0,e.name=void 0,e.imported=void 0,e.priority=void 0,e.discardStart=!0,e.discardEnd=!1,e.descriptor=void 0,e.resource=void 0,e}return P(n,[{key:"preExecuteDestroy",value:function(){this.discardEnd=!0}},{key:"postExecuteDestroy",value:function(){this.imported}},{key:"postExecuteDevirtualize",value:function(){this.discardStart=!1}},{key:"preExecuteDevirtualize",value:function(){this.imported}}]),n}(),aL=function e(){F(this,e),this.resource=void 0,this.writer=void 0,this.readerCount=0,this.version=void 0};function lL(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return cL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cL(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function cL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var uL=(tL=qk(),nL=fk(Yk.RenderEngine),tL((oL=xE((rL=function(){function e(){F(this,e),this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[],SE(this,"engine",oL,this)}var t,n;return P(e,[{key:"execute",value:(n=B(W.mark((function e(t){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.compile(),e.next=3,this.executePassNodes(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"tearDown",value:function(){this.frameGraphPasses.forEach((function(e){e.tearDown&&e.tearDown()})),this.reset()}},{key:"addPass",value:function(e,t,n,i){var r=new Zk;r.execute=n,i&&(r.tearDown=i),r.name=e;var o=new Qk;return o.name=e,this.passNodes.push(o),this.frameGraphPasses.push(r),t(this,o,r),r}},{key:"getPass",value:function(e){return this.frameGraphPasses.find((function(t){return t.name===e}))}},{key:"compile",value:function(){var e,t=this,n=lL(this.passNodes);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.refCount=i.writes.length+(i.hasSideEffect?1:0),i.reads.forEach((function(e){t.resourceNodes[e.index].readerCount++}))}}catch(T){n.e(T)}finally{n.f()}var r,o=[],s=lL(this.resourceNodes);try{for(s.s();!(r=s.n()).done;){var a=r.value;0===a.readerCount&&o.push(a)}}catch(T){s.e(T)}finally{s.f()}for(;o.length;){var l=o.pop(),c=l&&l.writer;if(c&&0==--c.refCount){var u,h=lL(c.reads);try{for(h.s();!(u=h.n()).done;){var d=u.value,f=this.resourceNodes[d.index];0==--f.readerCount&&o.push(f)}}catch(T){h.e(T)}finally{h.f()}}}this.resourceNodes.forEach((function(e){e.resource.refs+=e.readerCount}));var g,p=lL(this.passNodes);try{for(p.s();!(g=p.n()).done;){var m=g.value;if(m.refCount){var v,y=lL(m.reads);try{for(y.s();!(v=y.n()).done;){var _=v.value,b=this.resourceNodes[_.index].resource;b.first=b.first?b.first:m,b.last=m}}catch(T){y.e(T)}finally{y.f()}var w,C=lL(m.writes);try{for(C.s();!(w=C.n()).done;){var S=w.value,x=this.resourceNodes[S.index].resource;x.first=x.first?x.first:m,x.last=m}}catch(T){C.e(T)}finally{C.f()}}}}catch(T){p.e(T)}finally{p.f()}for(var E=0;E<2;E++){var k,L=lL(this.resourceNodes);try{for(L.s();!(k=L.n()).done;){var D=k.value.resource;if(D.priority===E&&D.refs){var N=D.first,I=D.last;N&&I&&(N.devirtualize.push(D),I.destroy.push(D))}}}catch(T){L.e(T)}finally{L.f()}}}},{key:"executePassNodes",value:(t=B(W.mark((function e(t){var n,i,r,o,s,a,l,c,u,h,d,f,g;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=lL(this.passNodes.entries()),e.prev=1,n.s();case 3:if((i=n.n()).done){e.next=18;break}if(r=H(i.value,2),o=r[0],!(s=r[1]).refCount){e.next=16;break}a=lL(s.devirtualize);try{for(a.s();!(l=a.n()).done;)l.value.preExecuteDevirtualize(this.engine)}catch(p){a.e(p)}finally{a.f()}c=lL(s.destroy);try{for(c.s();!(u=c.n()).done;)u.value.preExecuteDestroy(this.engine)}catch(p){c.e(p)}finally{c.f()}return e.next=12,this.frameGraphPasses[o].execute(this,this.frameGraphPasses[o],t);case 12:h=lL(s.devirtualize);try{for(h.s();!(d=h.n()).done;)d.value.postExecuteDevirtualize(this.engine)}catch(p){h.e(p)}finally{h.f()}f=lL(s.destroy);try{for(f.s();!(g=f.n()).done;)g.value.postExecuteDestroy(this.engine)}catch(p){f.e(p)}finally{f.f()}case 16:e.next=3;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),n.e(e.t0);case 23:return e.prev=23,n.f(),e.finish(23);case 26:this.reset();case 27:case"end":return e.stop()}}),e,this,[[1,20,23,26]])}))),function(e){return t.apply(this,arguments)})},{key:"reset",value:function(){this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[]}},{key:"getResourceNode",value:function(e){return this.resourceNodes[e.index]}},{key:"createResourceNode",value:function(e){var t=new aL;t.resource=e,t.version=e.version,this.resourceNodes.push(t);var n=new Xk;return n.index=this.resourceNodes.length-1,n}},{key:"createTexture",value:function(e,t,n){var i=new sL;return i.name=t,i.descriptor=n,this.createResourceNode(i)}},{key:"createRenderTarget",value:function(e,t,n){var i=new sL;return i.name=t,i.descriptor=n,this.createResourceNode(i)}},{key:"present",value:function(e){this.addPass("Present",(function(t,n){n.read(e),n.hasSideEffect=!0}),B(W.mark((function e(){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))))}}]),e}()).prototype,"engine",[nL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iL=rL))||iL),hL={};hL["[object Float32Array]"]=hL["[object Float64Array]"]=hL["[object Int8Array]"]=hL["[object Int16Array]"]=hL["[object Int32Array]"]=hL["[object Uint8Array]"]=hL["[object Uint8ClampedArray]"]=hL["[object Uint16Array]"]=hL["[object Uint32Array]"]=!0,hL["[object Arguments]"]=hL["[object Array]"]=hL["[object ArrayBuffer]"]=hL["[object Boolean]"]=hL["[object DataView]"]=hL["[object Date]"]=hL["[object Error]"]=hL["[object Function]"]=hL["[object Map]"]=hL["[object Number]"]=hL["[object Object]"]=hL["[object RegExp]"]=hL["[object Set]"]=hL["[object String]"]=hL["[object WeakMap]"]=!1;var dL=Object.prototype.toString;var fL=function(e){return function(e){return!!e&&"object"===j(e)}(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!!hL[dL.call(e)]};function gL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function pL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gL(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var vL,yL,_L,bL,wL,CL,SL,xL,EL,kL=function(e){z(n,NE);var t=mL(n);function n(e){var i;return F(this,n),(i=t.call(this,e)).dirty=!0,i.attributes=[],i.indices=void 0,i.indicesBuffer=void 0,i.vertexCount=0,i.maxInstancedCount=void 0,i.aabb=void 0,i.entity=void 0,Object.assign(G(i),e),i}return P(n,[{key:"setAttribute",value:function(e,t,n,i){var r=this.attributes.find((function(t){return t.name===e}));return r?(r.data=t,r.dirty=!0):this.attributes.push(pL(pL({dirty:!0,name:e,data:t},n),{},{bufferGetter:i})),this.dirty=!0,this}},{key:"setIndex",value:function(e){return this.indices=new Uint32Array(e.buffer?e.buffer:e),this.dirty=!0,this}},{key:"applyMatrix",value:function(e){var t=this.attributes.find((function(e){return"position"===e.name})),n=this.attributes.find((function(e){return"normal"===e.name}));if(t&&(t.dirty=!0,t.data&&t.data.length))for(var i=0;i<t.data.length;i+=3){var r=ys(t.data[i],t.data[i+1],t.data[i+2],1);_s(r,r,e),fL(t.data)?t.data.set([r[0],r[1],r[2]],i):(t.data[i]=r[0],t.data[i+1]=r[1],t.data[i+2]=r[2])}if(n){var o=Fo(Io(),e);if(n.data&&n.data.length)for(var s=0;s<n.data.length;s+=3){var a=is(n.data[s],n.data[s+1],n.data[s+2]);fs(a,a,o),cs(a,a),fL(n.data)?n.data.set([a[0],a[1],a[2]],s):(n.data[s]=a[0],n.data[s+1]=a[1],n.data[s+2]=a[2])}}}}]),n}();(yL=vL||(vL={}))[yL.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",yL[yL.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",yL[yL.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",yL[yL.POINTS=0]="POINTS",yL[yL.LINES=1]="LINES",yL[yL.LINE_LOOP=2]="LINE_LOOP",yL[yL.LINE_STRIP=3]="LINE_STRIP",yL[yL.TRIANGLES=4]="TRIANGLES",yL[yL.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",yL[yL.TRIANGLE_FAN=6]="TRIANGLE_FAN",yL[yL.ZERO=0]="ZERO",yL[yL.ONE=1]="ONE",yL[yL.SRC_COLOR=768]="SRC_COLOR",yL[yL.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",yL[yL.SRC_ALPHA=770]="SRC_ALPHA",yL[yL.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",yL[yL.DST_ALPHA=772]="DST_ALPHA",yL[yL.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",yL[yL.DST_COLOR=774]="DST_COLOR",yL[yL.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",yL[yL.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",yL[yL.FUNC_ADD=32774]="FUNC_ADD",yL[yL.BLEND_EQUATION=32777]="BLEND_EQUATION",yL[yL.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",yL[yL.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",yL[yL.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",yL[yL.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",yL[yL.MAX_EXT=32776]="MAX_EXT",yL[yL.MIN_EXT=32775]="MIN_EXT",yL[yL.BLEND_DST_RGB=32968]="BLEND_DST_RGB",yL[yL.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",yL[yL.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",yL[yL.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",yL[yL.CONSTANT_COLOR=32769]="CONSTANT_COLOR",yL[yL.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",yL[yL.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",yL[yL.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",yL[yL.BLEND_COLOR=32773]="BLEND_COLOR",yL[yL.ARRAY_BUFFER=34962]="ARRAY_BUFFER",yL[yL.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",yL[yL.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",yL[yL.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",yL[yL.STREAM_DRAW=35040]="STREAM_DRAW",yL[yL.STATIC_DRAW=35044]="STATIC_DRAW",yL[yL.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",yL[yL.BUFFER_SIZE=34660]="BUFFER_SIZE",yL[yL.BUFFER_USAGE=34661]="BUFFER_USAGE",yL[yL.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",yL[yL.FRONT=1028]="FRONT",yL[yL.BACK=1029]="BACK",yL[yL.FRONT_AND_BACK=1032]="FRONT_AND_BACK",yL[yL.CULL_FACE=2884]="CULL_FACE",yL[yL.BLEND=3042]="BLEND",yL[yL.DITHER=3024]="DITHER",yL[yL.STENCIL_TEST=2960]="STENCIL_TEST",yL[yL.DEPTH_TEST=2929]="DEPTH_TEST",yL[yL.SCISSOR_TEST=3089]="SCISSOR_TEST",yL[yL.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",yL[yL.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",yL[yL.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",yL[yL.NO_ERROR=0]="NO_ERROR",yL[yL.INVALID_ENUM=1280]="INVALID_ENUM",yL[yL.INVALID_VALUE=1281]="INVALID_VALUE",yL[yL.INVALID_OPERATION=1282]="INVALID_OPERATION",yL[yL.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",yL[yL.CW=2304]="CW",yL[yL.CCW=2305]="CCW",yL[yL.LINE_WIDTH=2849]="LINE_WIDTH",yL[yL.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",yL[yL.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",yL[yL.CULL_FACE_MODE=2885]="CULL_FACE_MODE",yL[yL.FRONT_FACE=2886]="FRONT_FACE",yL[yL.DEPTH_RANGE=2928]="DEPTH_RANGE",yL[yL.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",yL[yL.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",yL[yL.DEPTH_FUNC=2932]="DEPTH_FUNC",yL[yL.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",yL[yL.STENCIL_FUNC=2962]="STENCIL_FUNC",yL[yL.STENCIL_FAIL=2964]="STENCIL_FAIL",yL[yL.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",yL[yL.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",yL[yL.STENCIL_REF=2967]="STENCIL_REF",yL[yL.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",yL[yL.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",yL[yL.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",yL[yL.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",yL[yL.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",yL[yL.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",yL[yL.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",yL[yL.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",yL[yL.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",yL[yL.VIEWPORT=2978]="VIEWPORT",yL[yL.SCISSOR_BOX=3088]="SCISSOR_BOX",yL[yL.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",yL[yL.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",yL[yL.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",yL[yL.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",yL[yL.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",yL[yL.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",yL[yL.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",yL[yL.RED_BITS=3410]="RED_BITS",yL[yL.GREEN_BITS=3411]="GREEN_BITS",yL[yL.BLUE_BITS=3412]="BLUE_BITS",yL[yL.ALPHA_BITS=3413]="ALPHA_BITS",yL[yL.DEPTH_BITS=3414]="DEPTH_BITS",yL[yL.STENCIL_BITS=3415]="STENCIL_BITS",yL[yL.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",yL[yL.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",yL[yL.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",yL[yL.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",yL[yL.SAMPLES=32937]="SAMPLES",yL[yL.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",yL[yL.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",yL[yL.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",yL[yL.DONT_CARE=4352]="DONT_CARE",yL[yL.FASTEST=4353]="FASTEST",yL[yL.NICEST=4354]="NICEST",yL[yL.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",yL[yL.BYTE=5120]="BYTE",yL[yL.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",yL[yL.SHORT=5122]="SHORT",yL[yL.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",yL[yL.INT=5124]="INT",yL[yL.UNSIGNED_INT=5125]="UNSIGNED_INT",yL[yL.FLOAT=5126]="FLOAT",yL[yL.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",yL[yL.ALPHA=6406]="ALPHA",yL[yL.RGB=6407]="RGB",yL[yL.RGBA=6408]="RGBA",yL[yL.LUMINANCE=6409]="LUMINANCE",yL[yL.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",yL[yL.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",yL[yL.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",yL[yL.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",yL[yL.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",yL[yL.VERTEX_SHADER=35633]="VERTEX_SHADER",yL[yL.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",yL[yL.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",yL[yL.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",yL[yL.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",yL[yL.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",yL[yL.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",yL[yL.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",yL[yL.SHADER_TYPE=35663]="SHADER_TYPE",yL[yL.DELETE_STATUS=35712]="DELETE_STATUS",yL[yL.LINK_STATUS=35714]="LINK_STATUS",yL[yL.VALIDATE_STATUS=35715]="VALIDATE_STATUS",yL[yL.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",yL[yL.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",yL[yL.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",yL[yL.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",yL[yL.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",yL[yL.NEVER=512]="NEVER",yL[yL.LESS=513]="LESS",yL[yL.EQUAL=514]="EQUAL",yL[yL.LEQUAL=515]="LEQUAL",yL[yL.GREATER=516]="GREATER",yL[yL.NOTEQUAL=517]="NOTEQUAL",yL[yL.GEQUAL=518]="GEQUAL",yL[yL.ALWAYS=519]="ALWAYS",yL[yL.KEEP=7680]="KEEP",yL[yL.REPLACE=7681]="REPLACE",yL[yL.INCR=7682]="INCR",yL[yL.DECR=7683]="DECR",yL[yL.INVERT=5386]="INVERT",yL[yL.INCR_WRAP=34055]="INCR_WRAP",yL[yL.DECR_WRAP=34056]="DECR_WRAP",yL[yL.VENDOR=7936]="VENDOR",yL[yL.RENDERER=7937]="RENDERER",yL[yL.VERSION=7938]="VERSION",yL[yL.NEAREST=9728]="NEAREST",yL[yL.LINEAR=9729]="LINEAR",yL[yL.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",yL[yL.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",yL[yL.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",yL[yL.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",yL[yL.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",yL[yL.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",yL[yL.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",yL[yL.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",yL[yL.TEXTURE_2D=3553]="TEXTURE_2D",yL[yL.TEXTURE=5890]="TEXTURE",yL[yL.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",yL[yL.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",yL[yL.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",yL[yL.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",yL[yL.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",yL[yL.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",yL[yL.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",yL[yL.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",yL[yL.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",yL[yL.TEXTURE0=33984]="TEXTURE0",yL[yL.TEXTURE1=33985]="TEXTURE1",yL[yL.TEXTURE2=33986]="TEXTURE2",yL[yL.TEXTURE3=33987]="TEXTURE3",yL[yL.TEXTURE4=33988]="TEXTURE4",yL[yL.TEXTURE5=33989]="TEXTURE5",yL[yL.TEXTURE6=33990]="TEXTURE6",yL[yL.TEXTURE7=33991]="TEXTURE7",yL[yL.TEXTURE8=33992]="TEXTURE8",yL[yL.TEXTURE9=33993]="TEXTURE9",yL[yL.TEXTURE10=33994]="TEXTURE10",yL[yL.TEXTURE11=33995]="TEXTURE11",yL[yL.TEXTURE12=33996]="TEXTURE12",yL[yL.TEXTURE13=33997]="TEXTURE13",yL[yL.TEXTURE14=33998]="TEXTURE14",yL[yL.TEXTURE15=33999]="TEXTURE15",yL[yL.TEXTURE16=34e3]="TEXTURE16",yL[yL.TEXTURE17=34001]="TEXTURE17",yL[yL.TEXTURE18=34002]="TEXTURE18",yL[yL.TEXTURE19=34003]="TEXTURE19",yL[yL.TEXTURE20=34004]="TEXTURE20",yL[yL.TEXTURE21=34005]="TEXTURE21",yL[yL.TEXTURE22=34006]="TEXTURE22",yL[yL.TEXTURE23=34007]="TEXTURE23",yL[yL.TEXTURE24=34008]="TEXTURE24",yL[yL.TEXTURE25=34009]="TEXTURE25",yL[yL.TEXTURE26=34010]="TEXTURE26",yL[yL.TEXTURE27=34011]="TEXTURE27",yL[yL.TEXTURE28=34012]="TEXTURE28",yL[yL.TEXTURE29=34013]="TEXTURE29",yL[yL.TEXTURE30=34014]="TEXTURE30",yL[yL.TEXTURE31=34015]="TEXTURE31",yL[yL.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",yL[yL.REPEAT=10497]="REPEAT",yL[yL.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",yL[yL.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",yL[yL.FLOAT_VEC2=35664]="FLOAT_VEC2",yL[yL.FLOAT_VEC3=35665]="FLOAT_VEC3",yL[yL.FLOAT_VEC4=35666]="FLOAT_VEC4",yL[yL.INT_VEC2=35667]="INT_VEC2",yL[yL.INT_VEC3=35668]="INT_VEC3",yL[yL.INT_VEC4=35669]="INT_VEC4",yL[yL.BOOL=35670]="BOOL",yL[yL.BOOL_VEC2=35671]="BOOL_VEC2",yL[yL.BOOL_VEC3=35672]="BOOL_VEC3",yL[yL.BOOL_VEC4=35673]="BOOL_VEC4",yL[yL.FLOAT_MAT2=35674]="FLOAT_MAT2",yL[yL.FLOAT_MAT3=35675]="FLOAT_MAT3",yL[yL.FLOAT_MAT4=35676]="FLOAT_MAT4",yL[yL.SAMPLER_2D=35678]="SAMPLER_2D",yL[yL.SAMPLER_CUBE=35680]="SAMPLER_CUBE",yL[yL.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",yL[yL.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",yL[yL.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",yL[yL.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",yL[yL.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",yL[yL.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",yL[yL.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",yL[yL.COMPILE_STATUS=35713]="COMPILE_STATUS",yL[yL.LOW_FLOAT=36336]="LOW_FLOAT",yL[yL.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",yL[yL.HIGH_FLOAT=36338]="HIGH_FLOAT",yL[yL.LOW_INT=36339]="LOW_INT",yL[yL.MEDIUM_INT=36340]="MEDIUM_INT",yL[yL.HIGH_INT=36341]="HIGH_INT",yL[yL.FRAMEBUFFER=36160]="FRAMEBUFFER",yL[yL.RENDERBUFFER=36161]="RENDERBUFFER",yL[yL.RGBA4=32854]="RGBA4",yL[yL.RGB5_A1=32855]="RGB5_A1",yL[yL.RGB565=36194]="RGB565",yL[yL.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",yL[yL.STENCIL_INDEX=6401]="STENCIL_INDEX",yL[yL.STENCIL_INDEX8=36168]="STENCIL_INDEX8",yL[yL.DEPTH_STENCIL=34041]="DEPTH_STENCIL",yL[yL.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",yL[yL.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",yL[yL.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",yL[yL.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",yL[yL.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",yL[yL.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",yL[yL.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",yL[yL.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",yL[yL.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",yL[yL.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",yL[yL.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",yL[yL.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",yL[yL.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",yL[yL.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",yL[yL.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",yL[yL.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",yL[yL.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",yL[yL.NONE=0]="NONE",yL[yL.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",yL[yL.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",yL[yL.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",yL[yL.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",yL[yL.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",yL[yL.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",yL[yL.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",yL[yL.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",yL[yL.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",yL[yL.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",yL[yL.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",yL[yL.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",yL[yL.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",yL[yL.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",yL[yL.COPY_SRC=1]="COPY_SRC",yL[yL.COPY_DST=2]="COPY_DST",yL[yL.SAMPLED=4]="SAMPLED",yL[yL.STORAGE=8]="STORAGE",yL[yL.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT";var LL=(_L=qk(),bL=fk(Yk.GeometryComponentManager),wL=fk(Yk.RenderEngine),_L((xL=xE((SL=function(){function e(){F(this,e),SE(this,"geometry",xL,this),SE(this,"engine",EL,this)}var t;return P(e,[{key:"execute",value:(t=B(W.mark((function e(){var t=this;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.geometry.forEach((function(e,n){n.dirty&&(n.attributes.forEach((function(e){var n;e.dirty&&e.data&&(e.buffer?null===(n=e.buffer)||void 0===n||n.subData({data:e.data,offset:0}):e.buffer=t.engine.createBuffer({data:e.data,type:vL.FLOAT}),e.dirty=!1)})),n.indices&&(n.indicesBuffer?n.indicesBuffer.subData({data:n.indices,offset:0}):n.indicesBuffer=t.engine.createElements({data:n.indices,count:n.indices.length,type:vL.UNSIGNED_INT,usage:vL.STATIC_DRAW})),n.dirty=!1)}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.geometry.forEach((function(e,t){t.indicesBuffer&&t.indicesBuffer.destroy(),t.attributes.forEach((function(e){e.buffer&&e.buffer.destroy()}))})),this.geometry.clear()}},{key:"createBufferGeometry",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{vertexCount:3},t=e.vertexCount,n=DE();return this.geometry.create(n,{vertexCount:t})}},{key:"createInstancedBufferGeometry",value:function(e){var t=e.maxInstancedCount,n=e.vertexCount,i=DE();return this.geometry.create(i,{maxInstancedCount:t,vertexCount:n})}}]),e}()).prototype,"geometry",[bL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EL=xE(SL.prototype,"engine",[wL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CL=SL))||CL);function DL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function NL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?DL(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function IL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var TL,ML,AL,OL,RL,PL,FL,BL,WL,zL=function(e){z(n,NE);var t=IL(n);function n(e){var i;return F(this,n),(i=t.call(this,e)).vertexShaderGLSL=void 0,i.fragmentShaderGLSL=void 0,i.defines={},i.dirty=!0,i.uniforms=[],i.cull={enable:!0,face:vL.BACK},i.depth={enable:!0},i.blend=void 0,i.entity=void 0,i.type=void 0,Object.assign(G(i),e),i}return P(n,[{key:"setDefines",value:function(e){return this.defines=NL(NL({},this.defines),e),this}},{key:"setCull",value:function(e){return this.cull=e,this}},{key:"setDepth",value:function(e){return this.depth=e,this}},{key:"setBlend",value:function(e){return this.blend=e,this}},{key:"setUniform",value:function(e,t){var n=this;if("string"!=typeof e)return Object.keys(e).forEach((function(t){return n.setUniform(t,e[t])})),this;var i=this.uniforms.find((function(t){return t.name===e}));return i?(i.dirty=!0,i.data=t):this.uniforms.push({name:e,dirty:!0,data:t}),this.dirty=!0,this}}]),n}();function VL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function UL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VL(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var HL,jL,GL=(TL=qk(),ML=fk(Yk.MaterialComponentManager),AL=fk(Yk.RenderEngine),OL=fk(Yk.ShaderModuleService),TL((FL=xE((PL=function(){function e(){F(this,e),SE(this,"material",FL,this),SE(this,"engine",BL,this),SE(this,"shaderModule",WL,this)}var t;return P(e,[{key:"execute",value:(t=B(W.mark((function e(){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.material.clear()}},{key:"createShaderMaterial",value:function(e){var t=DE(),n=e.vertexShader,i=e.fragmentShader,r=[];if(!this.engine.supportWebGPU){var o="material-".concat(t);this.shaderModule.registerModule(o,{vs:e.vertexShader,fs:e.fragmentShader});var s=this.shaderModule.getModule(o);n=s.vs,i=s.fs,s.uniforms&&(r=Object.keys(s.uniforms).map((function(e){return{dirty:!0,name:e,data:s.uniforms[e]}})))}return this.material.create(t,UL(UL({vertexShaderGLSL:n,fragmentShaderGLSL:i},e),{},{uniforms:r}))}}]),e}()).prototype,"material",[ML],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BL=xE(PL.prototype,"engine",[AL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WL=xE(PL.prototype,"shaderModule",[OL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RL=PL))||RL);function KL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}(jL=HL||(HL={}))[jL.Standard=0]="Standard";var qL=function(e){z(n,NE);var t=KL(n);function n(e){var i;return F(this,n),(i=t.call(this,e)).strategy=HL.Standard,i.visibilityPlaneMask=0,i.visible=!1,Object.assign(G(i),e),i}return n}(),$L=function(){function e(t,n){F(this,e),this.center=void 0,this.halfExtents=void 0,this.min=es(),this.max=es(),this.update(t,n)}return P(e,[{key:"update",value:function(e,t){this.center=e||es(),this.halfExtents=t||is(.5,.5,.5),this.min=gs(this.min,this.center,this.halfExtents),this.max=ss(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(e,t){ss(this.center,t,e),ls(this.center,this.center,.5),gs(this.halfExtents,t,e),ls(this.halfExtents,this.halfExtents,.5),rs(this.min,e),rs(this.max,t)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){var t=this.center,n=t[0],i=t[1],r=t[2],o=this.halfExtents,s=o[0],a=o[1],l=o[2],c=n-s,u=n+s,h=i-a,d=i+a,f=r-l,g=r+l,p=e.center,m=p[0],v=p[1],y=p[2],_=e.halfExtents,b=_[0],w=_[1],C=_[2],S=m-b,x=m+b,E=v-w,k=v+w,L=y-C,D=y+C;S<c&&(c=S),x>u&&(u=x),E<h&&(h=E),k>d&&(d=k),L<f&&(f=L),D>g&&(g=D),t[0]=.5*(c+u),t[1]=.5*(h+d),t[2]=.5*(f+g),o[0]=.5*(u-c),o[1]=.5*(d-h),o[2]=.5*(g-f),this.min[0]=c,this.min[1]=h,this.min[2]=f,this.max[0]=u,this.max[1]=d,this.max[2]=g}},{key:"intersects",value:function(e){var t=this.getMax(),n=this.getMin(),i=e.getMax(),r=e.getMin();return n[0]<=i[0]&&t[0]>=r[0]&&n[1]<=i[1]&&t[1]>=r[1]&&n[2]<=i[2]&&t[2]>=r[2]}},{key:"containsPoint",value:function(e){var t=this.getMin(),n=this.getMax();return!(e[0]<t[0]||e[0]>n[0]||e[1]<t[1]||e[1]>n[1]||e[2]<t[2]||e[2]>n[2])}},{key:"getNegativeFarPoint",value:function(e){return 273===e.pnVertexFlag?rs(es(),this.min):272===e.pnVertexFlag?is(this.min[0],this.min[1],this.max[2]):257===e.pnVertexFlag?is(this.min[0],this.max[1],this.min[2]):256===e.pnVertexFlag?is(this.min[0],this.max[1],this.max[2]):17===e.pnVertexFlag?is(this.max[0],this.min[1],this.min[2]):16===e.pnVertexFlag?is(this.max[0],this.min[1],this.max[2]):1===e.pnVertexFlag?is(this.max[0],this.max[1],this.min[2]):is(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(e){return 273===e.pnVertexFlag?rs(es(),this.max):272===e.pnVertexFlag?is(this.max[0],this.max[1],this.min[2]):257===e.pnVertexFlag?is(this.max[0],this.min[1],this.max[2]):256===e.pnVertexFlag?is(this.max[0],this.min[1],this.min[2]):17===e.pnVertexFlag?is(this.min[0],this.max[1],this.max[2]):16===e.pnVertexFlag?is(this.min[0],this.max[1],this.min[2]):1===e.pnVertexFlag?is(this.min[0],this.min[1],this.max[2]):is(this.min[0],this.min[1],this.min[2])}}]),e}();function YL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var XL,ZL,QL=function(e){z(n,NE);var t=YL(n);function n(e){var i;return F(this,n),(i=t.call(this,e)).material=void 0,i.geometry=void 0,i.aabb=new $L,i.aabbDirty=!0,i.model=void 0,i.visible=!0,i.children=[],Object.assign(G(i),e),i}return n}(),JL=function(){function e(t,n){F(this,e),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=t||0,this.normal=n||is(0,1,0),this.updatePNVertexFlag()}return P(e,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(e){return us(e,this.normal)-this.distance}},{key:"normalize",value:function(){var e=1/ms(this.normal);ls(this.normal,this.normal,e),this.distance*=e}},{key:"intersectsLine",value:function(e,t,n){var i=this.distanceToPoint(e),r=i/(i-this.distanceToPoint(t)),o=r>=0&&r<=1;return o&&n&&hs(n,e,t,r),o}}]),e}();(ZL=XL||(XL={}))[ZL.OUTSIDE=4294967295]="OUTSIDE",ZL[ZL.INSIDE=0]="INSIDE",ZL[ZL.INDETERMINATE=2147483647]="INDETERMINATE";var eD,tD,nD,iD,rD,oD,sD,aD,lD,cD,uD,hD,dD,fD=function(){function e(t){if(F(this,e),this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new JL)}return P(e,[{key:"extractFromVPMatrix",value:function(e){var t=H(e,16),n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],g=t[12],p=t[13],m=t[14],v=t[15];os(this.planes[0].normal,o-n,c-s,f-u),this.planes[0].distance=-(v-g),os(this.planes[1].normal,o+n,c+s,f+u),this.planes[1].distance=-(v+g),os(this.planes[2].normal,o+i,c+a,f+h),this.planes[2].distance=-(v+p),os(this.planes[3].normal,o-i,c-a,f-h),this.planes[3].distance=-(v-p),os(this.planes[4].normal,o-r,c-l,f-d),this.planes[4].distance=-(v-m),os(this.planes[5].normal,o+r,c+l,f+d),this.planes[5].distance=-(v+m),this.planes.forEach((function(e){e.normalize(),e.updatePNVertexFlag()}))}}]),e}();function gD(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pD(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function pD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var mD,vD,yD,_D,bD,wD,CD,SD,xD,ED,kD,LD,DD,ND,ID,TD,MD,AD,OD,RD,PD,FD,BD,WD,zD=(eD=qk(),tD=fk(Yk.MeshComponentManager),nD=fk(Yk.CullableComponentManager),iD=fk(Yk.GeometryComponentManager),rD=fk(Yk.HierarchyComponentManager),oD=fk(Yk.TransformComponentManager),eD((lD=xE((aD=function(){function e(){F(this,e),SE(this,"mesh",lD,this),SE(this,"cullable",cD,this),SE(this,"geometry",uD,this),SE(this,"hierarchy",hD,this),SE(this,"transform",dD,this),this.planes=void 0}var t;return P(e,[{key:"setFrustumPlanes",value:function(e){this.planes=e}},{key:"execute",value:(t=B(W.mark((function e(t){var n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v,y,_,b,w,C;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=gD(t);try{for(n.s();!(i=n.n()).done;){r=i.value,o=r.getScene(),s=r.getCamera(),a=gD(o.getEntities());try{for(a.s();!(l=a.n()).done;)c=l.value,(u=this.mesh.getComponentByEntity(c))&&(h=this.hierarchy.getComponentByEntity(c),d=this.cullable.getComponentByEntity(c),f=u.geometry,g=this.transform.getComponentByEntity(c),f&&f.aabb&&g&&u.aabbDirty&&(p=g.worldTransform,m=f.aabb,v=m.center,y=m.halfExtents,_=ds(es(),v,p),S=p,(x=Io())[0]=S[0],x[1]=S[1],x[2]=S[2],x[3]=S[4],x[4]=S[5],x[5]=S[6],x[6]=S[8],x[7]=S[9],x[8]=S[10],b=x,w=fs(es(),y,b),u.aabb.update(_,w),u.aabbDirty=!1),d&&f&&(C=this.cullable.getComponentByEntity((null==h?void 0:h.parentID)||-1),d.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(u.aabb,(null==C?void 0:C.visibilityPlaneMask)||XL.INDETERMINATE,this.planes||s.getFrustum().planes),d.visible=d.visibilityPlaneMask!==XL.OUTSIDE))}catch(E){a.e(E)}finally{a.f()}}}catch(E){n.e(E)}finally{n.f()}case 2:case"end":return e.stop()}var S,x}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.cullable.clear(),this.mesh.clear()}},{key:"computeVisibilityWithPlaneMask",value:function(e,t,n){if(t===XL.OUTSIDE||t===XL.INSIDE)return t;for(var i=XL.INSIDE,r=0,o=n.length;r<o;++r){var s=r<31?1<<r:0;if(!(r<31&&0==(t&s))){var a=n[r],l=a.normal,c=a.distance;if(us(l,e.getNegativeFarPoint(n[r]))+c>0)return XL.OUTSIDE;us(l,e.getPositiveFarPoint(n[r]))+c>0&&(i|=s)}}return i}}]),e}()).prototype,"mesh",[tD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cD=xE(aD.prototype,"cullable",[nD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uD=xE(aD.prototype,"geometry",[iD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hD=xE(aD.prototype,"hierarchy",[rD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dD=xE(aD.prototype,"transform",[oD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sD=aD))||sD);function VD(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return UD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UD(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function UD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var HD,jD,GD,KD,qD,$D,YD,XD,ZD,QD,JD,eN,tN,nN=(mD=qk(),vD=fk(Yk.MeshComponentManager),yD=fk(Yk.GeometryComponentManager),_D=fk(Yk.MaterialComponentManager),bD=fk(Yk.CullableComponentManager),wD=fk(Yk.TransformComponentManager),CD=fk(Yk.HierarchyComponentManager),SD=fk(Yk.Systems),xD=$k(Yk.FrameGraphSystem),ED=fk(Yk.RenderEngine),kD=fk(Yk.ResourcePool),mD((WD=BD=function(){function e(){var t=this;F(this,e),SE(this,"mesh",ND,this),SE(this,"geometry",ID,this),SE(this,"material",TD,this),SE(this,"cullable",MD,this),SE(this,"transform",AD,this),SE(this,"hierarchy",OD,this),SE(this,"frameGraphSystem",RD,this),SE(this,"engine",PD,this),SE(this,"resourcePool",FD,this),this.modelCache={},this.setup=function(e,t,n){var i=e.createRenderTarget(t,"color buffer",{width:1,height:1,usage:vL.RENDER_ATTACHMENT|vL.SAMPLED|vL.COPY_SRC});n.data={output:t.write(e,i)}},this.execute=function(){var e=B(W.mark((function e(n,i,r){var o,s,a,l,c,u;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=n.getResourceNode(i.data.output),s=t.resourcePool.getOrCreateResource(o.resource),a=VD(r),e.prev=3,a.s();case 5:if((l=a.n()).done){e.next=11;break}return c=l.value,e.next=9,t.initView(c);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:u=t.engine.getCanvas(),s.resize({width:u.width,height:u.height}),t.engine.setScissor({enable:!1}),t.engine.clear({framebuffer:s,color:r[0].getClearColor(),depth:1}),t.engine.useFramebuffer(s,(function(){var e,n=VD(r);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.renderView(i)}}catch(o){n.e(o)}finally{n.f()}}));case 24:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t,n,i){return e.apply(this,arguments)}}()}var t,n;return P(e,[{key:"renderView",value:function(e){var t=e.getScene(),n=e.getCamera(),i=n.getViewTransform(),r=Ko(Uo(),n.getPerspective(),i);n.getFrustum().extractFromVPMatrix(r);var o=e.getViewport(),s=o.x,a=o.y,l=o.width,c=o.height;this.engine.viewport({x:s,y:a,width:l,height:c});var u,h=VD(t.getEntities());try{for(h.s();!(u=h.n()).done;){var d=u.value;this.renderMesh(d,{camera:n,view:e,viewMatrix:i})}}catch(f){h.e(f)}finally{h.f()}}},{key:"renderMesh",value:function(e,t){var n=t.camera,i=t.view,r=t.viewMatrix,o=this.mesh.getComponentByEntity(e);if(o&&o.visible){var s=o.material,a=o.geometry;if(a&&!a.dirty&&s){var l=this.transform.getComponentByEntity(e),c=Ko(Uo(),r,l.worldTransform),u=i.getViewport(),h=u.width,d=u.height;s.setUniform({projectionMatrix:n.getPerspective(),modelViewMatrix:c,modelMatrix:l.worldTransform,viewMatrix:r,cameraPosition:n.getPosition(),u_viewport:[h,d]}),o.model&&(o.model.draw({uniforms:s.uniforms.reduce((function(e,t){return e[t.name]=t.data,e}),{})}),s.uniforms.forEach((function(e){e.dirty=!1})),s.dirty=!1)}}}},{key:"initMesh",value:(n=B(W.mark((function e(t,n){var i,r,o,s,a,l,c,u;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.mesh.getComponentByEntity(t)){e.next=3;break}return e.abrupt("return");case 3:if(r=i.material,(o=i.geometry)&&!o.dirty&&r){e.next=7;break}return e.abrupt("return");case 7:if(i.model){e.next=24;break}if(s="m-".concat(r.entity,"-g-").concat(o.entity),!this.modelCache[s]){e.next=12;break}return i.model=this.modelCache[s],e.abrupt("return");case 12:return r.setUniform({projectionMatrix:1,modelViewMatrix:1,modelMatrix:1,viewMatrix:1,cameraPosition:1,u_viewport:1}),a=this.engine,l=a.createModel,c=a.createAttribute,u={vs:r.vertexShaderGLSL,fs:r.fragmentShaderGLSL,defines:r.defines,attributes:o.attributes.reduce((function(e,t){return t.data&&t.buffer&&(e[t.name]=c({buffer:t.buffer,attributes:t.attributes,arrayStride:t.arrayStride,stepMode:t.stepMode,divisor:"vertex"===t.stepMode?0:1})),e}),{}),uniforms:r.uniforms.reduce((function(e,t){return e[t.name]=t.data,e}),{}),scissor:{enable:!0,box:function(){return n.getViewport()}}},r.cull&&(u.cull=r.cull),r.depth&&(u.depth=r.depth),r.blend&&(u.blend=r.blend),o.indicesBuffer&&(u.elements=o.indicesBuffer),o.maxInstancedCount&&(u.instances=o.maxInstancedCount,u.count=o.vertexCount||3),e.next=22,l(u);case 22:i.model=e.sent,this.modelCache[s]=i.model;case 24:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"initView",value:(t=B(W.mark((function e(t){var n,i,r,o;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.getScene(),i=VD(n.getEntities()),e.prev=2,i.s();case 4:if((r=i.n()).done){e.next=10;break}return o=r.value,e.next=8,this.initMesh(o,t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),i.e(e.t0);case 15:return e.prev=15,i.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e){return t.apply(this,arguments)})}]),e}(),BD.IDENTIFIER="Render Pass",ND=xE((DD=WD).prototype,"mesh",[vD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ID=xE(DD.prototype,"geometry",[yD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TD=xE(DD.prototype,"material",[_D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MD=xE(DD.prototype,"cullable",[bD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AD=xE(DD.prototype,"transform",[wD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OD=xE(DD.prototype,"hierarchy",[CD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RD=xE(DD.prototype,"frameGraphSystem",[SD,xD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PD=xE(DD.prototype,"engine",[ED],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FD=xE(DD.prototype,"resourcePool",[kD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LD=DD))||LD);function iN(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return rN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rN(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function rN(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var oN,sN,aN,lN,cN,uN,hN,dN,fN,gN,pN,mN,vN,yN,_N,bN,wN,CN,SN,xN,EN,kN=1,LN=2,DN=(HD=qk(),jD=fk(Yk.RenderEngine),GD=fk(Yk.ResourcePool),KD=fk(Yk.RenderPassFactory),qD=fk(Yk.MeshComponentManager),HD((tN=eN=function(){function e(){var t=this;F(this,e),SE(this,"engine",XD,this),SE(this,"resourcePool",ZD,this),SE(this,"renderPassFactory",QD,this),SE(this,"mesh",JD,this),this.pickingFBO=void 0,this.views=void 0,this.highlightEnabled=!0,this.highlightColor=[255,0,0,255],this.alreadyInRendering=!1,this.setup=function(e,t,n){var i=e.createRenderTarget(t,"picking fbo",{width:1,height:1});n.data={output:t.write(e,i)},t.hasSideEffect=!0},this.execute=function(){var e=B(W.mark((function e(n,i,r){var o,s,a;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.views=r,!t.alreadyInRendering){e.next=3;break}return e.abrupt("return");case 3:o=iN(r);try{for(a=function(){var e=s.value,r=e.getViewport(),o=r.width,a=r.height;t.alreadyInRendering=!0;var l=n.getResourceNode(i.data.output);t.pickingFBO=t.resourcePool.getOrCreateResource(l.resource),t.pickingFBO.resize({width:o,height:a}),t.engine.useFramebuffer(t.pickingFBO,(function(){t.engine.clear({framebuffer:t.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var n,i=t.renderPassFactory(nN.IDENTIFIER),r=[],o=iN(e.getScene().getEntities());try{for(o.s();!(n=o.n()).done;){var s=n.value,a=t.mesh.getComponentByEntity(s);a.material.setUniform("u_PickingStage",kN),r.push(a)}}catch(l){o.e(l)}finally{o.f()}i.renderView(e),r.forEach((function(e){e.material.setUniform("u_PickingStage",LN)})),t.alreadyInRendering=!1}))},o.s();!(s=o.n()).done;)a()}catch(l){o.e(l)}finally{o.f()}case 5:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),this.pick=function(e,n){var i,r,o=e.x,s=e.y,a=t.engine,l=a.readPixels,c=a.useFramebuffer,u=n.getViewport(),h=u.width,d=u.height,f=o*window.devicePixelRatio,g=s*window.devicePixelRatio;if(!(f>h||f<0||g>d||g<0))return c(t.pickingFBO,(function(){var e;0===(i=l({x:Math.round(f),y:Math.round(d-(s+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}))[0]&&0===i[1]&&0===i[2]||(e=H(i,3),r=e[0]+256*e[1]+65536*e[2]-1,t.highlightEnabled&&t.highlightPickedFeature(i,n))})),r}}return P(e,[{key:"enableHighlight",value:function(e){this.highlightEnabled=e}},{key:"setHighlightColor",value:function(e){this.highlightColor=e}},{key:"highlightPickedFeature",value:function(e,t){if(e){var n,i=iN(t.getScene().getEntities());try{for(i.s();!(n=i.n()).done;){var r=n.value,o=this.mesh.getComponentByEntity(r).material;o.setUniform("u_PickingStage",LN),o.setUniform("u_PickingColor",[e[0],e[1],e[2]]),o.setUniform("u_HighlightColor",this.highlightColor)}}catch(s){i.e(s)}finally{i.f()}}}}]),e}(),eN.IDENTIFIER="PixelPicking Pass",XD=xE((YD=tN).prototype,"engine",[jD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZD=xE(YD.prototype,"resourcePool",[GD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QD=xE(YD.prototype,"renderPassFactory",[KD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JD=xE(YD.prototype,"mesh",[qD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$D=YD))||$D),NN=(oN=qk(),sN=fk(Yk.RenderEngine),aN=fk(Yk.ResourcePool),oN((fN=dN=function e(){var t=this;F(this,e),SE(this,"engine",uN,this),SE(this,"resourcePool",hN,this),this.model=void 0,this.setup=function(e,t,n){var i=e.getPass(nN.IDENTIFIER);if(i){var r=e.createRenderTarget(t,"render to screen",{width:1,height:1});n.data={input:t.read(i.data.output),output:t.write(e,r)}}},this.execute=function(){var e=B(W.mark((function e(n,i){var r,o,s,a,l,c,u;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.engine,o=r.createModel,s=r.createAttribute,a=r.createBuffer,t.model){e.next=6;break}return e.next=4,o({vs:t.engine.supportWebGPU?"layout(location = 0) in vec2 a_Position;\nlayout(location = 0) out vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}":"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:t.engine.supportWebGPU?"layout(set = 0, binding = 0) uniform sampler u_TextureSampler;\nlayout(set = 0, binding = 1) uniform texture2D u_Texture;\n\nlayout(location = 0) in vec2 v_UV;\nlayout(location = 0) out vec4 outColor;\n\nvoid main() {\n  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);\n}":"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}",attributes:{a_Position:s({buffer:a({data:[-4,-4,4,-4,0,4],type:vL.FLOAT}),size:2,arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})},uniforms:{u_Texture:null},depth:{enable:!1},count:3,blend:{enable:!0}});case 4:l=e.sent,t.model=l;case 6:c=n.getResourceNode(i.data.input),u=t.resourcePool.getOrCreateResource(c.resource),t.engine.useFramebuffer(null,(function(){t.engine.clear({framebuffer:null,color:[0,0,0,0],depth:1,stencil:0}),t.model.draw({uniforms:{u_Texture:u}})}));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.tearDown=function(){t.model=void 0}},dN.IDENTIFIER="Copy Pass",uN=xE((cN=fN).prototype,"engine",[sN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hN=xE(cN.prototype,"resourcePool",[aN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lN=cN))||lN),IN=(gN=qk(),pN=fk(Yk.Systems),mN=$k(Yk.FrameGraphSystem),vN=fk(Yk.RenderPassFactory),yN=fk(Yk.ConfigService),_N=fk(Yk.ResourcePool),gN((CN=xE((wN=function(){function e(){F(this,e),SE(this,"frameGraphSystem",CN,this),SE(this,"renderPassFactory",SN,this),SE(this,"configService",xN,this),SE(this,"resourcePool",EN,this)}var t;return P(e,[{key:"execute",value:(t=B(W.mark((function e(t){var n,i,r,o,s,a,l,c;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.renderPassFactory(nN.IDENTIFIER),i=n.setup,r=n.execute,this.frameGraphSystem.addPass(nN.IDENTIFIER,i,r),o=this.renderPassFactory(NN.IDENTIFIER),s=o.setup,a=o.execute,l=o.tearDown,c=this.frameGraphSystem.addPass(NN.IDENTIFIER,s,a,l),this.frameGraphSystem.present(c.data.output);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.resourcePool.clean()}},{key:"pick",value:function(e,t){return this.renderPassFactory(DN.IDENTIFIER).pick(e,t)}}]),e}()).prototype,"frameGraphSystem",[pN,mN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SN=xE(wN.prototype,"renderPassFactory",[vN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xN=xE(wN.prototype,"configService",[yN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EN=xE(wN.prototype,"resourcePool",[_N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bN=wN))||bN);function TN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var MN,AN,ON,RN,PN,FN,BN,WN,zN,VN=function(e){z(n,NE);var t=TN(n);function n(e){var i;return F(this,n),(i=t.call(this,e)).parentID=void 0,Object.assign(G(i),e),i}return n}(),UN=(MN=qk(),AN=fk(Yk.HierarchyComponentManager),ON=fk(Yk.TransformComponentManager),RN=fk(Yk.MeshComponentManager),MN((BN=xE((FN=function(){function e(){F(this,e),SE(this,"hierarchy",BN,this),SE(this,"transform",WN,this),SE(this,"mesh",zN,this)}var t;return P(e,[{key:"execute",value:(t=B(W.mark((function e(){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.runTransformUpdateSystem(),this.runHierarchyUpdateSystem();case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"tearDown",value:function(){this.hierarchy.clear(),this.transform.clear()}},{key:"getHierarchyComponentManager",value:function(){return this.hierarchy}},{key:"getTransformComponentManager",value:function(){return this.transform}},{key:"runTransformUpdateSystem",value:function(){var e=this;this.transform.forEach((function(t,n){(n.isDirty()||n.isLocalDirty())&&(e.setMeshAABBDirty(e.mesh.getComponentByEntity(t)),n.updateTransform())}))}},{key:"runHierarchyUpdateSystem",value:function(){var e=this;this.hierarchy.forEach((function(t,n){var i=e.transform.getComponentByEntity(t),r=e.transform.getComponentByEntity(n.parentID);null!==i&&null!==r&&i.updateTransformWithParent(r)}))}},{key:"attach",value:function(e,t,n){this.hierarchy.contains(e)&&this.detach(e),this.hierarchy.create(e,{parentID:t});var i=this.mesh.getComponentByEntity(t);if(this.setMeshAABBDirty(i),i&&-1===i.children.indexOf(e)&&i.children.push(e),this.hierarchy.getCount()>1)for(var r=this.hierarchy.getCount()-1;r>0;--r)for(var o=this.hierarchy.getEntity(r),s=0;s<r;++s){if(this.hierarchy.getComponent(s).parentID===o){this.hierarchy.moveItem(r,s),++r;break}}this.hierarchy.getComponentByEntity(e);var a=this.transform.getComponentByEntity(t);null===a&&(a=this.transform.create(t));var l=this.transform.getComponentByEntity(e);null===l&&(l=this.transform.create(e),a=this.transform.getComponentByEntity(t)),l.parent=a,!n&&a&&(l.matrixTransform(Go(Uo(),a.worldTransform)),l.updateTransform()),a&&l.updateTransformWithParent(a)}},{key:"detach",value:function(e){var t=this.hierarchy.getComponentByEntity(e);if(null!==t){var n=this.transform.getComponentByEntity(e);null!==n&&(n.parent=null,n.applyTransform()),this.hierarchy.removeKeepSorted(e);var i=this.mesh.getComponentByEntity(t.parentID);if(i){var r=i.children.indexOf(e);i.children.splice(r,1)}this.setMeshAABBDirty(i)}}},{key:"detachChildren",value:function(e){var t=this.mesh.getComponentByEntity(e);t&&(t.children=[]);for(var n=0;n<this.hierarchy.getCount();){var i;if((null===(i=this.hierarchy.getComponent(n))||void 0===i?void 0:i.parentID)===e){var r=this.hierarchy.getEntity(n);this.detach(r)}else++n}}},{key:"setMeshAABBDirty",value:function(e){e&&(e.aabbDirty=!0)}}]),e}()).prototype,"hierarchy",[AN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WN=xE(FN.prototype,"transform",[ON],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zN=xE(FN.prototype,"mesh",[RN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PN=FN))||PN);function HN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var jN,GN,KN,qN,$N,YN=function(e){z(n,NE);var t=HN(n);function n(e){var i,r,o,s,a,l,c,u,h,d,f,g,p,m,v;return F(this,n),(i=t.call(this,e)).dirtyFlag=void 0,i.localDirtyFlag=void 0,i.parent=null,i.localPosition=is(0,0,0),i.localRotation=ks(0,0,0,1),i.localScale=is(1,1,1),i.localTransform=Uo(),i.position=is(0,0,0),i.rotation=ks(0,0,0,1),i.scaling=is(1,1,1),i.worldTransform=Uo(),i.matrixTransform=(r=Uo(),function(e){Ko(r,i.getLocalTransform(),e),Yo(i.localScale,r),$o(i.localPosition,r),Xo(i.localRotation,r)}),i.rotateRollPitchYaw=(o=bs(),s=bs(),a=bs(),function(e,t,n){i.setDirty(),Es(o,e,0,0),Es(s,0,t,0),Es(a,0,0,n),Cs(i.localRotation,o,i.localRotation),Cs(i.localRotation,i.localRotation,s),Cs(i.localRotation,a,i.localRotation),Ns(i.localRotation,i.localRotation)}),i.lerp=(l=es(),c=bs(),u=es(),h=es(),d=bs(),f=es(),function(e,t,n){i.setDirty(),Yo(l,e.worldTransform),$o(u,e.worldTransform),Xo(c,e.worldTransform),Yo(h,t.worldTransform),$o(f,t.worldTransform),Xo(d,t.worldTransform),hs(i.localScale,l,h,n),Ss(i.localRotation,c,d,n),hs(i.localPosition,u,f,n)}),i.translate=(g=es(),function(e){return ss(g,i.getPosition(),e),i.setPosition(g),i.setDirty(!0),G(i)}),i.translateLocal=function(e){var t,n,r,o,s,a,l,c,u,h,d,f,g,p,m,v,y;return t=e,n=e,r=i.localRotation,o=r[0],s=r[1],a=r[2],l=r[3],c=n[0],u=n[1],h=n[2],p=s*(g=o*u-s*c)-a*(f=a*c-o*h),m=a*(d=s*h-a*u)-o*g,v=o*f-s*d,d*=y=2*l,f*=y,g*=y,p*=2,m*=2,v*=2,t[0]=c+d+p,t[1]=u+f+m,t[2]=h+g+v,ss(i.localPosition,i.localPosition,e),i.setLocalDirty(!0),G(i)},i.setPosition=(p=Uo(),function(e){return i.position=e,i.setLocalDirty(!0),null===i.parent?rs(i.localPosition,e):(Ho(p,i.parent.worldTransform),Go(p,p),ds(i.localPosition,e,p)),G(i)}),i.rotate=(m=bs(),function(e){if(null===i.parent)Cs(i.localRotation,i.localRotation,e),Ns(i.localRotation,i.localRotation);else{var t=i.getRotation(),n=i.parent.getRotation();Ls(m,n),xs(m,m),Cs(m,m,e),Cs(i.localRotation,e,t),Ns(i.localRotation,i.localRotation)}return i.setLocalDirty(),G(i)}),i.rotateLocal=function(e){return Cs(i.localRotation,i.localRotation,e),Ns(i.localRotation,i.localRotation),i.setLocalDirty(!0),G(i)},i.setRotation=(v=bs(),function(e){return null===i.parent?Ls(i.localRotation,e):(Ls(v,i.parent.getRotation()),xs(v,v),Ls(i.localRotation,v),Ds(i.localRotation,i.localRotation,e)),i.setLocalDirty(!0),G(i)}),i}return P(n,[{key:"setLocalPosition",value:function(e){rs(this.localPosition,e),this.setLocalDirty(!0)}},{key:"setLocalScale",value:function(e){rs(this.localScale,e),this.setLocalDirty(!0)}},{key:"setLocalRotation",value:function(e){return Ls(this.localRotation,e),this.setLocalDirty(!0),this}},{key:"isDirty",value:function(){return this.dirtyFlag}},{key:"setDirty",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?this.dirtyFlag|=n.DIRTY:this.dirtyFlag&=~n.DIRTY}},{key:"isLocalDirty",value:function(){return this.localDirtyFlag}},{key:"setLocalDirty",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?(this.localDirtyFlag|=n.DIRTY,this.setDirty(!0)):this.localDirtyFlag&=~n.DIRTY}},{key:"updateTransform",value:function(){this.isLocalDirty()&&this.getLocalTransform(),this.isDirty()&&null===this.parent&&(Ho(this.worldTransform,this.getLocalTransform()),this.setDirty(!1))}},{key:"updateTransformWithParent",value:function(e){Ko(this.worldTransform,e.worldTransform,this.getLocalTransform())}},{key:"applyTransform",value:function(){this.setDirty(),Yo(this.localScale,this.worldTransform),$o(this.localPosition,this.worldTransform),Xo(this.localRotation,this.worldTransform)}},{key:"clearTransform",value:function(){this.setDirty(),this.localPosition=is(0,0,0),this.localRotation=ks(0,0,0,1),this.localScale=is(1,1,1)}},{key:"scaleLocal",value:function(e){var t,n,i;return this.setLocalDirty(),t=this.localScale,n=this.localScale,i=e,t[0]=n[0]*i[0],t[1]=n[1]*i[1],t[2]=n[2]*i[2],this}},{key:"getLocalPosition",value:function(){return this.localPosition}},{key:"getLocalRotation",value:function(){return this.localRotation}},{key:"getLocalScale",value:function(){return this.localScale}},{key:"getLocalTransform",value:function(){var e,t,n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v,y,_,b,w,C;return this.localDirtyFlag&&(e=this.localTransform,t=this.localRotation,n=this.localPosition,i=this.localScale,r=t[0],o=t[1],s=t[2],a=t[3],h=r*(l=r+r),d=r*(c=o+o),f=r*(u=s+s),g=o*c,p=o*u,m=s*u,v=a*l,y=a*c,_=a*u,b=i[0],w=i[1],C=i[2],e[0]=(1-(g+m))*b,e[1]=(d+_)*b,e[2]=(f-y)*b,e[3]=0,e[4]=(d-_)*w,e[5]=(1-(h+m))*w,e[6]=(p+v)*w,e[7]=0,e[8]=(f+y)*C,e[9]=(p-v)*C,e[10]=(1-(h+g))*C,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,this.setLocalDirty(!1)),this.localTransform}},{key:"getWorldTransform",value:function(){return this.isLocalDirty()||this.isDirty()?(this.parent&&this.parent.getWorldTransform(),this.updateTransform(),this.worldTransform):this.worldTransform}},{key:"getPosition",value:function(){return $o(this.position,this.worldTransform),this.position}},{key:"getRotation",value:function(){return Xo(this.rotation,this.worldTransform),this.rotation}},{key:"getScale",value:function(){return Yo(this.scaling,this.worldTransform),this.scaling}}]),n}();YN.DIRTY=1;var XN=(jN=qk(),GN=fk(Yk.RenderEngine),jN(($N=xE((qN=function(){function e(){F(this,e),SE(this,"engine",$N,this),this.resourcePool={}}return P(e,[{key:"getOrCreateResource",value:function(e){if(!this.resourcePool[e.name]){var t=e.descriptor,n=t.width,i=t.height,r=t.usage;this.resourcePool[e.name]=this.engine.createFramebuffer({color:this.engine.createTexture2D({width:n,height:i,wrapS:vL.CLAMP_TO_EDGE,wrapT:vL.CLAMP_TO_EDGE,usage:r})})}return this.resourcePool[e.name]}},{key:"clean",value:function(){this.resourcePool={}}}]),e}()).prototype,"engine",[GN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KN=qN))||KN);function ZN(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var QN,JN,eI,tI,nI=function(e){z(n,NE);var t=ZN(n);function n(e){var i;return F(this,n),(i=t.call(this,e)).name=void 0,i.name=e.name||"",i}return n}(),iI=qk()(QN=function(){function e(){F(this,e),this.config=void 0}return P(e,[{key:"get",value:function(){return this.config}},{key:"set",value:function(e){this.config=e}}]),e}())||QN;(tI=eI||(eI={})).PANSTART="PANSTART",tI.PANEND="PANEND",tI.PANMOVE="PANMOVE",tI.PINCH="PINCH",tI.KEYDOWN="KEYDOWN",tI.KEYUP="KEYUP",tI.HOVER="HOVER";var rI=qk()(JN=function(){function e(){F(this,e)}return P(e,[{key:"listen",value:function(e){}},{key:"on",value:function(e,t){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"destroy",value:function(){}}]),e}())||JN;var oI,sI=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function aI(e){var t={};return{content:e=e.replace(sI,(function(e,n,i){var r=i.split(":"),o=r[0].trim(),s="";switch(r.length>1&&(s=r[1].trim()),n){case"bool":s="true"===s;break;case"float":case"int":s=Number(s);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":s=s?s.replace("[","").replace("]","").split(",").reduce((function(e,t){return e.push(Number(t.trim())),e}),[]):new Array(function(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16}return t}(n)).fill(0)}return t[o]=s,"uniform ".concat(n," ").concat(o,";\n")})),uniforms:t}}function lI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function cI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lI(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var uI=/precision\s+(high|low|medium)p\s+float/,hI=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,dI=qk()(oI=function(){function e(){F(this,e),this.moduleCache={},this.rawContentCache={}}return P(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n"}),this.registerModule("sdf2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}"})}},{key:"registerModule",value:function(e,t){if(!this.rawContentCache[e]){var n=t.vs,i=void 0===n?"":n,r=t.fs,o=void 0===r?"":r,s=t.uniforms,a=aI(i),l=a.content,c=a.uniforms,u=aI(o),h=u.content,d=u.uniforms;this.rawContentCache[e]={fs:h,uniforms:cI(cI(cI({},c),d),s),vs:l}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(e){var t=this;if(this.moduleCache[e])return this.moduleCache[e];var n,i=this.rawContentCache[e].vs||"",r=this.rawContentCache[e].fs||"",o=this.processModule(i,[],"vs"),s=o.content,a=o.includeList,l=this.processModule(r,[],"fs"),c=l.content,u=l.includeList,h=c,d=(n=a.concat(u).concat(e),n.filter((function(e,t,n){return n.indexOf(e)===t}))).reduce((function(e,n){return cI(cI({},e),t.rawContentCache[n].uniforms)}),{});return uI.test(c)||(h="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+c),this.moduleCache[e]={fs:h.trim(),uniforms:d,vs:s.trim()},this.moduleCache[e]}},{key:"processModule",value:function(e,t,n){var i=this;return{content:e.replace(hI,(function(e,r){var o=r.split(" ")[0].replace(/"/g,"");if(t.indexOf(o)>-1)return"";var s=i.rawContentCache[o][n];return t.push(o),i.processModule(s||"",t,n).content})),includeList:t}}}]),e}())||oI,fI=new Kk;function gI(){var e=new Kk;return e.parent=fI,e.bind(Yk.Systems).to(UN).inSingletonScope().whenTargetNamed(Yk.SceneGraphSystem),e.bind(Yk.Systems).to(uL).inSingletonScope().whenTargetNamed(Yk.FrameGraphSystem),e.bind(Yk.Systems).to(zD).inSingletonScope().whenTargetNamed(Yk.MeshSystem),e.bind(Yk.Systems).to(LL).inSingletonScope().whenTargetNamed(Yk.GeometrySystem),e.bind(Yk.Systems).to(GL).inSingletonScope().whenTargetNamed(Yk.MaterialSystem),e.bind(Yk.Systems).to(IN).inSingletonScope().whenTargetNamed(Yk.RendererSystem),e.bind(Yk.ResourcePool).to(XN).inSingletonScope(),e.bind(Yk.ConfigService).to(iI).inSingletonScope(),e.bind(Yk.InteractorService).to(rI).inSingletonScope(),e.bind(Yk.RenderPass).to(nN).inSingletonScope().whenTargetNamed(nN.IDENTIFIER),e.bind(Yk.RenderPass).to(NN).inSingletonScope().whenTargetNamed(NN.IDENTIFIER),e.bind(Yk.RenderPass).to(DN).inSingletonScope().whenTargetNamed(DN.IDENTIFIER),e.bind(Yk.RenderPassFactory).toFactory((function(e){return function(t){return e.container.getNamed(Yk.RenderPass,t)}})),e}function pI(e){for(var t=new $L,n=is(e[0],e[1],e[2]),i=is(e[0],e[1],e[2]),r=3;r<e.length;){var o=e[r++],s=e[r++],a=e[r++];o<n[0]&&(n[0]=o),s<n[1]&&(n[1]=s),a<n[2]&&(n[2]=a),o>i[0]&&(i[0]=o),s>i[1]&&(i[1]=s),a>i[2]&&(i[2]=a)}return t.setMinMax(n,i),t}fI.bind(Yk.ShaderModuleService).to(dI).inSingletonScope(),fI.bind(Yk.NameComponentManager).toConstantValue(new IE(nI)),fI.bind(Yk.HierarchyComponentManager).toConstantValue(new IE(VN)),fI.bind(Yk.TransformComponentManager).toConstantValue(new IE(YN)),fI.bind(Yk.MeshComponentManager).toConstantValue(new IE(QL)),fI.bind(Yk.CullableComponentManager).toConstantValue(new IE(qL)),fI.bind(Yk.GeometryComponentManager).toConstantValue(new IE(kL)),fI.bind(Yk.MaterialComponentManager).toConstantValue(new IE(zL));var mI,vI,yI,_I,bI,wI,CI,SI,xI,EI,kI="undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);es(),es(),es(),es(),es(),es(),(vI=mI||(mI={})).Normal="normal",vI.PostProcessing="post-processing",(_I=yI||(yI={})).Void="Void",_I.Boolean="Boolean",_I.Float="Float",_I.Uint32="Uint32",_I.Int32="Int32",_I.Vector="Vector",_I.Vector2Float="vec2<f32>",_I.Vector3Float="vec3<f32>",_I.Vector4Float="vec4<f32>",_I.Vector2Boolean="vec2<bool>",_I.Vector3Boolean="vec3<bool>",_I.Vector4Boolean="vec4<bool>",_I.Vector2Uint="vec2<u32>",_I.Vector3Uint="vec3<u32>",_I.Vector4Uint="vec4<u32>",_I.Vector2Int="vec2<i32>",_I.Vector3Int="vec3<i32>",_I.Vector4Int="vec4<i32>",_I.Matrix="Matrix",_I.Matrix3x3Float="mat3x3<f32>",_I.Matrix4x4Float="mat4x4<i32>",_I.Struct="Struct",_I.FloatArray="Float[]",_I.Vector4FloatArray="vec4<f32>[]",(wI=bI||(bI={})).Program="Program",wI.Identifier="Identifier",wI.VariableDeclaration="VariableDeclaration",wI.BlockStatement="BlockStatement",wI.ReturnStatement="ReturnStatement",wI.FunctionDeclaration="FunctionDeclaration",wI.VariableDeclarator="VariableDeclarator",wI.AssignmentExpression="AssignmentExpression",wI.LogicalExpression="LogicalExpression",wI.BinaryExpression="BinaryExpression",wI.ArrayExpression="ArrayExpression",wI.UnaryExpression="UnaryExpression",wI.UpdateExpression="UpdateExpression",wI.FunctionExpression="FunctionExpression",wI.MemberExpression="MemberExpression",wI.ConditionalExpression="ConditionalExpression",wI.ExpressionStatement="ExpressionStatement",wI.CallExpression="CallExpression",wI.NumThreadStatement="NumThreadStatement",wI.StorageStatement="StorageStatement",wI.DoWhileStatement="DoWhileStatement",wI.WhileStatement="WhileStatement",wI.ForStatement="ForStatement",wI.BreakStatement="BreakStatement",wI.ContinueStatement="ContinueStatement",wI.IfStatement="IfStatement",wI.ImportedFunctionStatement="ImportedFunctionStatement",(SI=CI||(CI={})).Input="Input",SI.Output="Output",SI.Uniform="Uniform",SI.Workgroup="Workgroup",SI.UniformConstant="UniformConstant",SI.Image="Image",SI.StorageBuffer="StorageBuffer",SI.Private="Private",SI.Function="Function",(EI=xI||(xI={})).GLSL100="GLSL100",EI.GLSL450="GLSL450",EI.WGSL="WGSL";function LI(e){return"number"==typeof e}function DI(e){return void 0===e?0:e>360||e<-360?e%360:e}function NI(e,t,n){return LI(e)?is(e,t,n):3===e.length?ts(e):is(e[0],e[1],e[2])}var II,TI,MI,AI,OI,RI,PI,FI,BI,WI,zI,VI,UI,HI=function(){function e(t,n){var i,r;F(this,e),this.name=void 0,this.matrix=void 0,this.right=void 0,this.up=void 0,this.forward=void 0,this.position=void 0,this.focalPoint=void 0,this.distanceVector=void 0,this.distance=void 0,this.dollyingStep=void 0,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=t,this.matrix=(i=n.matrix,(r=new No(16))[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r),this.right=ts(n.right),this.up=ts(n.up),this.forward=ts(n.forward),this.position=ts(n.position),this.focalPoint=ts(n.focalPoint),this.distanceVector=ts(n.distanceVector),this.azimuth=n.azimuth,this.elevation=n.elevation,this.roll=n.roll,this.relAzimuth=n.relAzimuth,this.relElevation=n.relElevation,this.relRoll=n.relRoll,this.dollyingStep=n.dollyingStep,this.distance=n.distance}return P(e,[{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getRoll",value:function(){return this.roll}},{key:"retrieve",value:function(e){e.matrix=Ho(e.matrix,this.matrix),e.right=rs(e.right,this.right),e.up=rs(e.up,this.up),e.forward=rs(e.forward,this.forward),e.position=rs(e.position,this.position),e.focalPoint=rs(e.focalPoint,this.focalPoint),e.distanceVector=rs(e.distanceVector,this.distanceVector),e.azimuth=this.azimuth,e.elevation=this.elevation,e.roll=this.roll,e.relAzimuth=this.relAzimuth,e.relElevation=this.relElevation,e.relRoll=this.relRoll,e.dollyingStep=this.dollyingStep,e.distance=this.distance}}]),e}();(BI=FI||(FI={})).ORBITING="ORBITING",BI.EXPLORING="EXPLORING",BI.TRACKING="TRACKING",(zI=WI||(WI={})).DEFAULT="DEFAULT",zI.ROTATIONAL="ROTATIONAL",zI.TRANSLATIONAL="TRANSLATIONAL",zI.CINEMATIC="CINEMATIC",(UI=VI||(VI={})).ORTHOGRAPHIC="ORTHOGRAPHIC",UI.PERSPECTIVE="PERSPECTIVE";var jI,GI,KI,qI,$I,YI,XI,ZI,QI,JI,eT,tT,nT,iT,rT,oT,sT,aT,lT,cT,uT,hT,dT,fT,gT,pT,mT,vT,yT,_T,bT,wT,CT,ST=Math.PI/180,xT=180/Math.PI,ET=(II=qk(),TI=fk(Yk.InteractorService),II((PI=RI=function(){function e(){F(this,e),this.matrix=Uo(),this.right=is(1,0,0),this.up=is(0,1,0),this.forward=is(0,0,1),this.position=is(0,0,1),this.focalPoint=is(0,0,0),this.distanceVector=is(0,0,0),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.rotateWorld=!1,SE(this,"interactor",OI,this),this.fov=30,this.near=.1,this.far=1e4,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.zoom=1,this.perspective=Uo(),this.view=void 0,this.following=void 0,this.type=FI.EXPLORING,this.trackingMode=WI.DEFAULT,this.projectionMode=VI.PERSPECTIVE,this.frustum=new fD,this.landmarks=[],this.landmarkAnimationID=void 0}return P(e,[{key:"clone",value:function(){var t=new e;return t.setType(this.type,void 0),t.interactor=this.interactor,t}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.perspective}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"setType",value:function(e,t){return this.type=e,this.type===FI.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===FI.TRACKING&&void 0!==t&&this.setTrackingMode(t),this}},{key:"setProjectionMode",value:function(e){return this.projectionMode=e,this}},{key:"setTrackingMode",value:function(e){if(this.type!==FI.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this}},{key:"setWorldRotation",value:function(e){this.rotateWorld=e,this._getAngles()}},{key:"getViewTransform",value:function(){return Go(Uo(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"setMatrix",value:function(e){return this.matrix=e,this._update(),this}},{key:"setAspect",value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this}},{key:"setViewOffset",value:function(e,t,n,i,r,o){return this.aspect=e/t,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.projectionMode===VI.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===VI.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setPerspective",value:function(e,t,n,i){return this.projectionMode=VI.PERSPECTIVE,this.fov=n,this.near=e,this.far=t,this.aspect=i,Qo(this.perspective,this.fov*ST,this.aspect,this.near,this.far),this}},{key:"setOrthographic",value:function(e,t,n,i,r,o){this.projectionMode=VI.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=n,this.bottom=i,this.near=r,this.far=o;var s=(this.rright-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),l=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,u=l-s,h=l+s,d=c+a,f=c-a;if(void 0!==this.view&&this.view.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h=(u+=g*this.view.offsetX)+g*this.view.width,f=(d-=p*this.view.offsetY)-p*this.view.height}return Jo(this.perspective,u,h,d,f,r,o),this}},{key:"setPosition",value:function(e,t,n){return this._setPosition(e,t,n),this.setFocalPoint(this.focalPoint),this}},{key:"setFocalPoint",value:function(e,t,n){var i,r,o,s,a,l,c,u,h,d,f,g,p,m=is(0,1,0);if(this.focalPoint=NI(e,t,n),this.trackingMode===WI.CINEMATIC){var v=as(es(),this.focalPoint,this.position);e=v[0],t=v[1],n=v[2];var y=ns(v),_=Math.asin(t/y)*xT,b=90+Math.atan2(n,e)*xT,w=Uo();i=w,r=w,o=b*ST,s=Math.sin(o),a=Math.cos(o),l=r[0],c=r[1],u=r[2],h=r[3],d=r[8],f=r[9],g=r[10],p=r[11],r!==i&&(i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=l*a-d*s,i[1]=c*a-f*s,i[2]=u*a-g*s,i[3]=h*a-p*s,i[8]=l*s+d*a,i[9]=c*s+f*a,i[10]=u*s+g*a,i[11]=h*s+p*a,function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+c*i,e[5]=s*r+u*i,e[6]=a*r+h*i,e[7]=l*r+d*i,e[8]=c*r-o*i,e[9]=u*r-s*i,e[10]=h*r-a*i,e[11]=d*r-l*i}(w,w,_*ST),m=ds(es(),[0,1,0],w)}return Go(this.matrix,function(e,t,n,i){var r,o,s,a,l,c,u,h,d,f,g=t[0],p=t[1],m=t[2],v=i[0],y=i[1],_=i[2],b=n[0],w=n[1],C=n[2];return Math.abs(g-b)<1e-6&&Math.abs(p-w)<1e-6&&Math.abs(m-C)<1e-6?jo(e):(u=g-b,h=p-w,d=m-C,r=y*(d*=f=1/Math.hypot(u,h,d))-_*(h*=f),o=_*(u*=f)-v*d,s=v*h-y*u,(f=Math.hypot(r,o,s))?(r*=f=1/f,o*=f,s*=f):(r=0,o=0,s=0),a=h*s-d*o,l=d*r-u*s,c=u*o-h*r,(f=Math.hypot(a,l,c))?(a*=f=1/f,l*=f,c*=f):(a=0,l=0,c=0),e[0]=r,e[1]=a,e[2]=u,e[3]=0,e[4]=o,e[5]=l,e[6]=h,e[7]=0,e[8]=s,e[9]=c,e[10]=d,e[11]=0,e[12]=-(r*g+o*p+s*m),e[13]=-(a*g+l*p+c*m),e[14]=-(u*g+h*p+d*m),e[15]=1,e)}(Uo(),this.position,this.focalPoint,m)),this._getAxes(),this._getDistance(),this._getAngles(),this}},{key:"setDistance",value:function(e){if(!(this.distance===e||e<0)){this.distance=e,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var t=es();e=this.distance;var n=this.forward,i=this.focalPoint;return t[0]=e*n[0]+i[0],t[1]=e*n[1]+i[1],t[2]=e*n[2]+i[2],this._setPosition(t),this}}},{key:"setMaxDistance",value:function(e){return this.maxDistance=e,this}},{key:"setMinDistance",value:function(e){return this.minDistance=e,this}},{key:"changeAzimuth",value:function(e){return this.setAzimuth(this.azimuth+e),this}},{key:"changeElevation",value:function(e){return this.setElevation(this.elevation+e),this}},{key:"changeRoll",value:function(e){return this.setRoll(this.roll+e),this}},{key:"setAzimuth",value:function(e){return this.azimuth=DI(e),this.computeMatrix(),this._getAxes(),this.type===FI.ORBITING||this.type===FI.EXPLORING?this._getPosition():this.type===FI.TRACKING&&this._getFocalPoint(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(e){return this.elevation=DI(e),this.computeMatrix(),this._getAxes(),this.type===FI.ORBITING||this.type===FI.EXPLORING?this._getPosition():this.type===FI.TRACKING&&this._getFocalPoint(),this}},{key:"setRoll",value:function(e){return this.roll=DI(e),this.computeMatrix(),this._getAxes(),this.type===FI.ORBITING||this.type===FI.EXPLORING?this._getPosition():this.type===FI.TRACKING&&this._getFocalPoint(),this}},{key:"rotate",value:function(e,t,n){if(this.type===FI.EXPLORING){e=DI(e),t=DI(t),n=DI(n);var i=ws(bs(),[1,0,0],(this.rotateWorld?1:-1)*t*ST),r=ws(bs(),[0,1,0],(this.rotateWorld?1:-1)*e*ST),o=ws(bs(),[0,0,1],n*ST),s=Cs(bs(),r,i);s=Cs(bs(),s,o);var a=Zo(Uo(),s);qo(this.matrix,this.matrix,[0,0,-this.distance]),Ko(this.matrix,this.matrix,a),qo(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation+t)>90)return;this.relElevation=DI(t),this.relAzimuth=DI(e),this.relRoll=DI(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.computeMatrix()}return this._getAxes(),this.type===FI.ORBITING||this.type===FI.EXPLORING?this._getPosition():this.type===FI.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(e,t){var n=NI(e,t,0),i=ts(this.position);return ss(i,i,ls(es(),this.right,n[0])),ss(i,i,ls(es(),this.up,n[1])),this._setPosition(i),this}},{key:"dolly",value:function(e){var t=this.forward,n=ts(this.position),i=this.dollyingStep,r=this.distance+e*this.dollyingStep;return i=Math.max(Math.min(r,this.maxDistance),this.minDistance)-this.distance,n[0]+=i*t[0],n[1]+=i*t[1],n[2]+=i*t[2],this._setPosition(n),this.type===FI.ORBITING||this.type===FI.EXPLORING?this._getDistance():this.type===FI.TRACKING&&ss(this.focalPoint,n,this.distanceVector),this}},{key:"createLandmark",value:function(e,t){var n=this.clone();n.setPosition(t.position),n.setFocalPoint(t.focalPoint),void 0!==t.roll&&n.setRoll(t.roll);var i=new HI(e,n);return this.landmarks.push(i),i}},{key:"setLandmark",value:function(e){var t=new HI(e,this);return this.landmarks.push(t),this}},{key:"gotoLandmark",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,i=this.landmarks.find((function(t){return t.name===e}));if(i){if(0===n)return void i.retrieve(this);void 0!==this.landmarkAnimationID&&window.cancelAnimationFrame(this.landmarkAnimationID),this.interactor.disconnect();var r,o=i.getPosition(),s=i.getFocalPoint(),a=i.getRoll(),l=function e(i){void 0===r&&(r=i);var l,c=i-r,u=(1-Math.cos(c/n*Math.PI))/2,h=es(),d=es();if(hs(h,t.focalPoint,s,u),hs(d,t.position,o,u),l=t.roll*(1-u)+a*u,t.setFocalPoint(h),t.setPosition(d),t.setRoll(l),t.computeMatrix(),!(ps(h,s)+ps(d,o)>.01))return t.setFocalPoint(h),t.setPosition(d),t.setRoll(l),t.computeMatrix(),void t.interactor.connect();c<n&&(t.landmarkAnimationID=window.requestAnimationFrame(e))};window.requestAnimationFrame(l)}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles()}},{key:"computeMatrix",value:function(){var e,t,n=ws(bs(),[0,0,1],this.roll*ST);jo(this.matrix),e=ws(bs(),[1,0,0],(this.rotateWorld&&this.type!==FI.TRACKING||this.type===FI.TRACKING?1:-1)*this.elevation*ST),t=ws(bs(),[0,1,0],(this.rotateWorld&&this.type!==FI.TRACKING||this.type===FI.TRACKING?1:-1)*this.azimuth*ST);var i=Cs(bs(),t,e);i=Cs(bs(),i,n);var r=Zo(Uo(),i);this.type===FI.ORBITING||this.type===FI.EXPLORING?(qo(this.matrix,this.matrix,this.focalPoint),Ko(this.matrix,this.matrix,r),qo(this.matrix,this.matrix,[0,0,this.distance])):this.type===FI.TRACKING&&(qo(this.matrix,this.matrix,this.position),Ko(this.matrix,this.matrix,r))}},{key:"_setPosition",value:function(e,t,n){this.position=NI(e,t,n);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1}},{key:"_getAxes",value:function(){rs(this.right,NI(_s(vs(),[1,0,0,0],this.matrix))),rs(this.up,NI(_s(vs(),[0,1,0,0],this.matrix))),rs(this.forward,NI(_s(vs(),[0,0,1,0],this.matrix))),cs(this.right,this.right),cs(this.up,this.up),cs(this.forward,this.forward)}},{key:"_getAngles",value:function(){var e=this.distanceVector[0],t=this.distanceVector[1],n=this.distanceVector[2],i=ns(this.distanceVector);if(0===i)return this.elevation=0,void(this.azimuth=0);this.type===FI.TRACKING||this.rotateWorld?(this.elevation=Math.asin(t/i)*xT,this.azimuth=Math.atan2(-e,-n)*xT):(this.elevation=-Math.asin(t/i)*xT,this.azimuth=-Math.atan2(-e,-n)*xT)}},{key:"_getPosition",value:function(){rs(this.position,NI(_s(vs(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){fs(this.distanceVector,[0,0,-this.distance],To(Io(),this.matrix)),ss(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=as(es(),this.focalPoint,this.position),this.distance=ns(this.distanceVector),this.dollyingStep=this.distance/100}}]),e}(),RI.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},OI=xE((AI=PI).prototype,"interactor",[TI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MI=AI))||MI),kT=(jI=qk(),GI=fk(Yk.GeometryComponentManager),jI((XI=YI=function(){function e(){F(this,e),this.config=void 0,SE(this,"geometry",$I,this),this.entity=void 0,this.component=void 0}return P(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(e){this.config=e}},{key:"setEntity",value:function(e){this.entity=e,this.component=this.geometry.create(e),this.component.entity=e,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),e}(),YI.BOX="box",YI.SPHERE="sphere",YI.PLANE="plane",YI.MERGED="merged",$I=xE((qI=XI).prototype,"geometry",[GI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KI=qI))||KI),LT={};function DT(){if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}ZI=LT,Object.defineProperty(ZI,"__esModule",{value:!0}),(ZI.ExtensionName||(ZI.ExtensionName={})).TextureCompressionBC="texture-compression-bc",(QI=ZI.AddressMode||(ZI.AddressMode={})).ClampToEdge="clamp-to-edge",QI.Repeat="repeat",QI.MirrorRepeat="mirror-repeat",(JI=ZI.BindingType||(ZI.BindingType={})).UniformBuffer="uniform-buffer",JI.StorageBuffer="storage-buffer",JI.ReadonlyStorageBuffer="readonly-storage-buffer",JI.Sampler="sampler",JI.ComparisonSampler="comparison-sampler",JI.SampledTexture="sampled-texture",JI.ReadonlyStorageTexture="readonly-storage-texture",JI.WriteonlyStorageTexture="writeonly-storage-texture",(eT=ZI.BlendFactor||(ZI.BlendFactor={})).Zero="zero",eT.One="one",eT.SrcColor="src-color",eT.OneMinusSrcColor="one-minus-src-color",eT.SrcAlpha="src-alpha",eT.OneMinusSrcAlpha="one-minus-src-alpha",eT.DstColor="dst-color",eT.OneMinusDstColor="one-minus-dst-color",eT.DstAlpha="dst-alpha",eT.OneMinusDstAlpha="one-minus-dst-alpha",eT.SrcAlphaSaturated="src-alpha-saturated",eT.BlendColor="blend-color",eT.OneMinusBlendColor="one-minus-blend-color",(tT=ZI.BlendOperation||(ZI.BlendOperation={})).Add="add",tT.Subtract="subtract",tT.ReverseSubtract="reverse-subtract",tT.Min="min",tT.Max="max",(nT=ZI.CompareFunction||(ZI.CompareFunction={})).Never="never",nT.Less="less",nT.Equal="equal",nT.LessEqual="less-equal",nT.Greater="greater",nT.NotEqual="not-equal",nT.GreaterEqual="greater-equal",nT.Always="always",(iT=ZI.CullMode||(ZI.CullMode={})).None="none",iT.Front="front",iT.Back="back",(rT=ZI.FilterMode||(ZI.FilterMode={})).Nearest="nearest",rT.Linear="linear",(oT=ZI.FrontFace||(ZI.FrontFace={})).CCW="ccw",oT.CW="cw",(sT=ZI.IndexFormat||(ZI.IndexFormat={})).Uint16="uint16",sT.Uint32="uint32",(aT=ZI.InputStepMode||(ZI.InputStepMode={})).Vertex="vertex",aT.Instance="instance",(ZI.LoadOp||(ZI.LoadOp={})).Load="load",(lT=ZI.PrimitiveTopology||(ZI.PrimitiveTopology={})).PointList="point-list",lT.LineList="line-list",lT.LineStrip="line-strip",lT.TriangleList="triangle-list",lT.TriangleStrip="triangle-strip",(cT=ZI.StencilOperation||(ZI.StencilOperation={})).Keep="keep",cT.Zero="zero",cT.Replace="replace",cT.Invert="invert",cT.IncrementClamp="increment-clamp",cT.DecrementClamp="decrement-clamp",cT.IncrementWrap="increment-wrap",cT.DecrementWrap="decrement-wrap",(uT=ZI.StoreOp||(ZI.StoreOp={})).Store="store",uT.Clear="clear",(hT=ZI.TextureDimension||(ZI.TextureDimension={})).E1d="1d",hT.E2d="2d",hT.E3d="3d",(dT=ZI.TextureFormat||(ZI.TextureFormat={})).R8Unorm="r8unorm",dT.R8Snorm="r8snorm",dT.R8Uint="r8uint",dT.R8Sint="r8sint",dT.R16Uint="r16uint",dT.R16Sint="r16sint",dT.R16Float="r16float",dT.RG8Unorm="rg8unorm",dT.RG8Snorm="rg8snorm",dT.RG8Uint="rg8uint",dT.RG8Sint="rg8sint",dT.R32Uint="r32uint",dT.R32Sint="r32sint",dT.R32Float="r32float",dT.RG16Uint="rg16uint",dT.RG16Sint="rg16sint",dT.RG16Float="rg16float",dT.RGBA8Unorm="rgba8unorm",dT.RGBA8UnormSRGB="rgba8unorm-srgb",dT.RGBA8Snorm="rgba8snorm",dT.RGBA8Uint="rgba8uint",dT.RGBA8Sint="rgba8sint",dT.BGRA8Unorm="bgra8unorm",dT.BGRA8UnormSRGB="bgra8unorm-srgb",dT.RGB10A2Unorm="rgb10a2unorm",dT.RG11B10Float="rg11b10float",dT.RG32Uint="rg32uint",dT.RG32Sint="rg32sint",dT.RG32Float="rg32float",dT.RGBA16Uint="rgba16uint",dT.RGBA16Sint="rgba16sint",dT.RGBA16Float="rgba16float",dT.RGBA32Uint="rgba32uint",dT.RGBA32Sint="rgba32sint",dT.RGBA32Float="rgba32float",dT.Depth32Float="depth32float",dT.Depth24Plus="depth24plus",dT.Depth24PlusStencil8="depth24plus-stencil8",(fT=ZI.TextureComponentType||(ZI.TextureComponentType={})).Float="float",fT.Sint="sint",fT.Uint="uint",(gT=ZI.TextureViewDimension||(ZI.TextureViewDimension={})).E1d="1d",gT.E2d="2d",gT.E2dArray="2d-array",gT.Cube="cube",gT.CubeArray="cube-array",gT.E3d="3d",(pT=ZI.VertexFormat||(ZI.VertexFormat={})).Uchar2="uchar2",pT.Uchar4="uchar4",pT.Char2="char2",pT.Char4="char4",pT.Uchar2Norm="uchar2norm",pT.Uchar4Norm="uchar4norm",pT.Char2Norm="char2norm",pT.Char4Norm="char4norm",pT.Ushort2="ushort2",pT.Ushort4="ushort4",pT.Short2="short2",pT.Short4="short4",pT.Ushort2Norm="ushort2norm",pT.Ushort4Norm="ushort4norm",pT.Short2Norm="short2norm",pT.Short4Norm="short4norm",pT.Half2="half2",pT.Half4="half4",pT.Float="float",pT.Float2="float2",pT.Float3="float3",pT.Float4="float4",pT.Uint="uint",pT.Uint2="uint2",pT.Uint3="uint3",pT.Uint4="uint4",pT.Int="int",pT.Int2="int2",pT.Int3="int3",pT.Int4="int4",(mT=ZI.TextureAspect||(ZI.TextureAspect={})).All="all",mT.StencilOnly="stencil-only",mT.DepthOnly="depth-only",(vT=ZI.CompilationMessageType||(ZI.CompilationMessageType={})).Error="error",vT.Warning="warning",vT.Info="info",(ZI.QueryType||(ZI.QueryType={})).Occlusion="occlusion",(yT=ZI.BufferUsage||(ZI.BufferUsage={}))[yT.MapRead=1]="MapRead",yT[yT.MapWrite=2]="MapWrite",yT[yT.CopySrc=4]="CopySrc",yT[yT.CopyDst=8]="CopyDst",yT[yT.Index=16]="Index",yT[yT.Vertex=32]="Vertex",yT[yT.Uniform=64]="Uniform",yT[yT.Storage=128]="Storage",yT[yT.Indirect=256]="Indirect",yT[yT.QueryResolve=512]="QueryResolve",(_T=ZI.ColorWrite||(ZI.ColorWrite={}))[_T.Red=1]="Red",_T[_T.Green=2]="Green",_T[_T.Blue=4]="Blue",_T[_T.Alpha=8]="Alpha",_T[_T.All=15]="All",(bT=ZI.ShaderStage||(ZI.ShaderStage={}))[bT.Vertex=1]="Vertex",bT[bT.Fragment=2]="Fragment",bT[bT.Compute=4]="Compute",(wT=ZI.TextureUsage||(ZI.TextureUsage={}))[wT.CopySrc=1]="CopySrc",wT[wT.CopyDst=2]="CopyDst",wT[wT.Sampled=4]="Sampled",wT[wT.Storage=8]="Storage",wT[wT.OutputAttachment=16]="OutputAttachment",(CT=ZI.MapMode||(ZI.MapMode={}))[CT.Read=1]="Read",CT[CT.Write=2]="Write";var NT={}.toString,IT=function(e){return Array.isArray?Array.isArray(e):function(e,t){return NT.call(e)==="[object "+t+"]"}(e,"Array")},TT={};TT["[object Float32Array]"]=TT["[object Float64Array]"]=TT["[object Int8Array]"]=TT["[object Int16Array]"]=TT["[object Int32Array]"]=TT["[object Uint8Array]"]=TT["[object Uint8ClampedArray]"]=TT["[object Uint16Array]"]=TT["[object Uint32Array]"]=!0,TT["[object Arguments]"]=TT["[object Array]"]=TT["[object ArrayBuffer]"]=TT["[object Boolean]"]=TT["[object DataView]"]=TT["[object Date]"]=TT["[object Error]"]=TT["[object Function]"]=TT["[object Map]"]=TT["[object Number]"]=TT["[object Object]"]=TT["[object RegExp]"]=TT["[object Set]"]=TT["[object String]"]=TT["[object WeakMap]"]=!1;var MT=Object.prototype.toString;var AT,OT,RT,PT,FT,BT,WT,zT=function(e){return function(e){return!!e&&"object"===j(e)}(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!!TT[MT.call(e)]};function VT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function UT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VT(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var HT,jT,GT,KT,qT,$T,YT,XT,ZT,QT,JT,eM,tM,nM,iM,rM,oM,sM,aM,lM,cM,uM,hM,dM,fM,gM,pM,mM,vM,yM,_M,bM,wM,CM,SM,xM=(AT=qk(),OT=fk(Yk.RenderEngine),RT=fk(Yk.ConfigService),AT((BT=xE((FT=function(){function e(){F(this,e),SE(this,"engine",BT,this),SE(this,"configService",WT,this),this.entity=DE(),this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}var t,n,i;return P(e,[{key:"init",value:function(){var e=this.configService.get(),t=e.canvas,n=e.engineOptions;this.initPromise=this.engine.init(UT({canvas:t||DT(),swapChainFormat:LT.TextureFormat.BGRA8Unorm,antialiasing:!1},n))}},{key:"setBundle",value:function(e){this.compiledBundle=JSON.parse(JSON.stringify(e))}},{key:"setDispatch",value:function(e){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=e),this}},{key:"setMaxIteration",value:function(e){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=e),this}},{key:"setBinding",value:function(e,t){var n=this;if("string"==typeof e){var i=LI(t)||zT(t)||IT(t);if(this.compiledBundle&&this.compiledBundle.context){var r=this.compiledBundle.context.defines.find((function(t){return t.name===e}));if(r)return r.value=t,this;var o=this.compiledBundle.context.uniforms.find((function(t){return t.name===e}));o&&(i?(o.data=t,o.isReferer=!1,o.storageClass===CI.Uniform?this.model&&this.model.updateUniform(e,t):this.model&&this.model.updateBuffer(e,t)):(o.isReferer=!0,o.data=t))}}else Object.keys(e).forEach((function(t){n.setBinding(t,e[t])}));return this}},{key:"execute",value:(i=B(W.mark((function e(){var t,n,i=this,r=arguments;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:1,!this.dirty){e.next=6;break}return this.compiledBundle.context&&(t>1?this.compiledBundle.context.maxIteration=t:this.compiledBundle.context.maxIteration++),e.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter((function(e){return e.isReferer})).forEach((function(e){var t=e.data,n=e.name;i.model.confirmInput(t.model,n)})),n=0;n<t;n++)this.model.run();return this.engine.endFrame(),e.abrupt("return",this);case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getOutput",value:(n=B(W.mark((function e(){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.readData());case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"compile",value:(t=B(W.mark((function e(){var t,n,i;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:return t=UT({},this.compiledBundle.context),n=this.engine.supportWebGPU?this.engine.useWGSL?xI.WGSL:xI.GLSL450:xI.GLSL100,i=this.compiledBundle.shaders[n],t.defines.filter((function(e){return e.runtime})).forEach((function(e){var t="".concat("__DefineValuePlaceholder__").concat(e.name);i=i.replace(t,"".concat(e.value))})),t.shader=i,t.uniforms.forEach((function(e){if(!e.data&&e.storageClass===CI.StorageBuffer){var n=1;e.type===yI.FloatArray?n=1:e.type===yI.Vector4FloatArray&&(n=4),e.data=new Float32Array(t.output.length*n).fill(0)}})),this.compiledBundle.context=t,e.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=e.sent;case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()).prototype,"engine",[OT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WT=xE(FT.prototype,"configService",[RT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PT=FT))||PT),EM=(HT=qk(),jT=fk(Yk.MaterialComponentManager),HT((YT=$T=function(){function e(){F(this,e),this.config=void 0,SE(this,"material",qT,this),this.entity=void 0,this.component=void 0}return P(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(e){this.config=e}},{key:"setEntity",value:function(e,t){this.entity=e,this.component=this.material.create(e),this.component.entity=e,this.component.type=t,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),e}(),$T.BASIC="basic",qT=xE((KT=YT).prototype,"material",[jT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GT=KT))||GT),kM=(XT=qk(),ZT=fk(Yk.MeshComponentManager),QT=fk(Yk.CullableComponentManager),JT=fk(Yk.TransformComponentManager),eM=fk(Yk.Systems),tM=$k(Yk.SceneGraphSystem),XT((cM=lM=function(){function e(){F(this,e),this.attributes={},this.config=void 0,SE(this,"mesh",rM,this),SE(this,"cullable",oM,this),SE(this,"transform",sM,this),SE(this,"sceneGraphSystem",aM,this),this.meshComponent=void 0,this.transformComponent=void 0,this.entity=void 0}return P(e,[{key:"getEntity",value:function(){return this.entity}},{key:"getTransformComponent",value:function(){return this.transformComponent}},{key:"getMeshComponent",value:function(){return this.meshComponent}},{key:"setConfig",value:function(e){this.config=e}},{key:"setEntity",value:function(e){this.entity=e,this.cullable.create(e),this.meshComponent=this.mesh.create(e),this.transformComponent=this.transform.create(e),this.onEntityCreated()}},{key:"setMaterial",value:function(e){return this.meshComponent.material=e,this}},{key:"setGeometry",value:function(e){return this.meshComponent.geometry=e,this}},{key:"setAttributes",value:function(e){var t=this;Object.keys(e).forEach((function(n){void 0!==e[n]&&e[n]!==t.attributes[n]&&(t.onAttributeChanged({name:n,data:e[n]}),t.attributes[n]=e[n])}))}},{key:"setVisible",value:function(e){var t=this;return this.meshComponent.visible=e,this.meshComponent.children.forEach((function(n){var i=t.mesh.getComponentByEntity(n);i&&(i.visible=e)})),this}},{key:"isVisible",value:function(){return this.meshComponent.visible}},{key:"attach",value:function(e){return this.sceneGraphSystem.attach(this.entity,e.entity),this}},{key:"detach",value:function(){return this.sceneGraphSystem.detach(this.entity),this}},{key:"detachChildren",value:function(){return this.sceneGraphSystem.detachChildren(this.entity),this}},{key:"onEntityCreated",value:function(){}},{key:"onAttributeChanged",value:function(e){var t=e.name,n=e.data;this.meshComponent&&this.meshComponent.material&&this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(t),n)}},{key:"convertAttributeName2UniformName",value:function(e){return e}}]),e}(),lM.POINT="point",lM.LINE="line",lM.GRID="grid",rM=xE((iM=cM).prototype,"mesh",[ZT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oM=xE(iM.prototype,"cullable",[QT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sM=xE(iM.prototype,"transform",[JT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aM=xE(iM.prototype,"sceneGraphSystem",[eM,tM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nM=iM))||nM),LM={exports:{}},DM=LM.exports=function(){var e=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},t=function(e,t){for(var n=Object.keys(t),i=0;i<n.length;++i)e[n[i]]=t[n[i]];return e},n="\n";function i(e){return"undefined"!=typeof atob?atob(e):"base64:"+e}function r(e){var t=new Error("(regl) "+e);throw console.error(t),t}function o(e,t){e||r(t)}function s(e){return e?": "+e:""}function a(e,t,n){e in t||r("unknown parameter ("+e+")"+s(n)+". possible values: "+Object.keys(t).join())}function l(t,n){e(t)||r("invalid parameter type"+s(n)+". must be a typed array")}function c(e,t){switch(t){case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"string":return"string"==typeof e;case"boolean":return"boolean"==typeof e;case"function":return"function"==typeof e;case"undefined":return void 0===e;case"symbol":return"symbol"==typeof e}}function u(e,t,n){c(e,t)||r("invalid parameter type"+s(n)+". expected "+t+", got "+typeof e)}function h(e,t){e>=0&&(0|e)===e||r("invalid parameter type, ("+e+")"+s(t)+". must be a nonnegative integer")}function d(e,t,n){t.indexOf(e)<0&&r("invalid value"+s(n)+". must be one of: "+t)}var f=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function g(e){Object.keys(e).forEach((function(e){f.indexOf(e)<0&&r('invalid regl constructor argument "'+e+'". must be one of '+f)}))}function p(e,t){for(e+="";e.length<t;)e=" "+e;return e}function m(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function v(e,t){this.number=e,this.line=t,this.errors=[]}function y(e,t,n){this.file=e,this.line=t,this.message=n}function _(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var i=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return i?i[1]:"unknown"}function b(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var i=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return i?i[1]:"unknown"}function w(e,t){var n=e.split("\n"),r=1,o=0,s={unknown:new m,0:new m};s.unknown.name=s[0].name=t||_(),s.unknown.lines.push(new v(0,""));for(var a=0;a<n.length;++a){var l=n[a],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(l);if(c)switch(c[1]){case"line":var u=/(\d+)(\s+\d+)?/.exec(c[2]);u&&(r=0|u[1],u[2]&&((o=0|u[2])in s||(s[o]=new m)));break;case"define":var h=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);h&&(s[o].name=h[1]?i(h[2]):h[2])}s[o].lines.push(new v(r++,l))}return Object.keys(s).forEach((function(e){var t=s[e];t.lines.forEach((function(e){t.index[e.number]=e}))})),s}function C(e){var t=[];return e.split("\n").forEach((function(e){if(!(e.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);n?t.push(new y(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new y("unknown",0,e))}})),t}function S(e,t){t.forEach((function(t){var n=e[t.file];if(n){var i=n.index[t.line];if(i)return i.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)}))}function x(e,t,i,r,s){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(t),l=r===e.FRAGMENT_SHADER?"fragment":"vertex";T(i,"string",l+" shader source must be a string",s);var c=w(i,s),u=C(a);S(c,u),Object.keys(c).forEach((function(e){var t=c[e];if(t.hasErrors){var i=[""],r=[""];o("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach((function(e){if(e.errors.length>0){o(p(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(e.line+n,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach((function(i){var r=i.message,s=/^\s*'(.*)'\s*:\s*(.*)$/.exec(r);if(s){var a=s[1];switch(r=s[2],a){case"assign":a="="}t=Math.max(e.line.indexOf(a,t),0)}else t=0;o(p("| ",6)),o(p("^^^",t+3)+n,"font-weight:bold"),o(p("| ",6)),o(r+n,"font-weight:bold")})),o(p("| ",6)+n)}else o(p(e.number,4)+"|  "),o(e.line+n,"color:red")})),"undefined"==typeof document||window.chrome?console.log(i.join("")):(r[0]=i.join("%c"),console.log.apply(console,r))}function o(e,t){i.push(e),r.push(t||"")}})),o.raise("Error compiling "+l+" shader, "+c[0].name)}}function E(e,t,i,r,s){if(!e.getProgramParameter(t,e.LINK_STATUS)){var a=e.getProgramInfoLog(t),l=w(i,s),c='Error linking program with vertex shader, "'+w(r,s)[0].name+'", and fragment shader "'+l[0].name+'"';"undefined"!=typeof document?console.log("%c"+c+n+"%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(c+n+a),o.raise(c)}}function k(e){e._commandRef=_()}function L(e,t,n,i){function r(e){return e?i.id(e):0}function o(e,t){Object.keys(t).forEach((function(t){e[i.id(t)]=!0}))}k(e),e._fragId=r(e.static.frag),e._vertId=r(e.static.vert);var s=e._uniformSet={};o(s,t.static),o(s,t.dynamic);var a=e._attributeSet={};o(a,n.static),o(a,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic}function D(e,t){var n=b();r(e+" in command "+(t||_())+("unknown"===n?"":" called from "+n))}function N(e,t,n){e||D(t,n||_())}function I(e,t,n,i){e in t||D("unknown parameter ("+e+")"+s(n)+". possible values: "+Object.keys(t).join(),i||_())}function T(e,t,n,i){c(e,t)||D("invalid parameter type"+s(n)+". expected "+t+", got "+typeof e,i||_())}function M(e){e()}function A(e,t,n){e.texture?d(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):d(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var O=33071,R=9728,P=9984,F=9985,B=9986,W=9987,z=5121,V=5122,U=5123,H=5124,j=5125,G=5126,K=32819,q=32820,$=33635,Y=34042,X=36193,Z={};function Q(e,t){return e===q||e===K||e===$?2:e===Y?4:Z[e]*t}function J(e){return!(e&e-1||!e)}function ee(e,t,n){var i,r=t.width,s=t.height,a=t.channels;o(r>0&&r<=n.maxTextureSize&&s>0&&s<=n.maxTextureSize,"invalid texture shape"),e.wrapS===O&&e.wrapT===O||o(J(r)&&J(s),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==r&&1!==s&&o(e.minFilter!==P&&e.minFilter!==B&&e.minFilter!==F&&e.minFilter!==W,"min filter requires mipmap"):(o(J(r)&&J(s),"texture must be a square power of 2 to support mipmapping"),o(t.mipmask===(r<<1)-1,"missing or incomplete mipmap data")),t.type===G&&(n.extensions.indexOf("oes_texture_float_linear")<0&&o(e.minFilter===R&&e.magFilter===R,"filter not supported, must enable oes_texture_float_linear"),o(!e.genMipmaps,"mipmap generation not supported with float textures"));var l=t.images;for(i=0;i<16;++i)if(l[i]){var c=r>>i,u=s>>i;o(t.mipmask&1<<i,"missing mipmap data");var h=l[i];if(o(h.width===c&&h.height===u,"invalid shape for mip images"),o(h.format===t.format&&h.internalformat===t.internalformat&&h.type===t.type,"incompatible type for mip image"),h.compressed);else if(h.data){var d=Math.ceil(Q(h.type,a)*c/h.unpackAlignment)*h.unpackAlignment;o(h.data.byteLength===d*u,"invalid data for image, buffer size is inconsistent with image format")}else h.element||h.copy}else e.genMipmaps||o(0==(t.mipmask&1<<i),"extra mipmap data");t.compressed&&o(!e.genMipmaps,"mipmap generation for compressed images not supported")}function te(e,t,n,i){var r=e.width,s=e.height,a=e.channels;o(r>0&&r<=i.maxTextureSize&&s>0&&s<=i.maxTextureSize,"invalid texture shape"),o(r===s,"cube map must be square"),o(t.wrapS===O&&t.wrapT===O,"wrap mode not supported by cube map");for(var l=0;l<n.length;++l){var c=n[l];o(c.width===r&&c.height===s,"inconsistent cube map face shape"),t.genMipmaps&&(o(!c.compressed,"can not generate mipmap for compressed textures"),o(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var u=c.images,h=0;h<16;++h){var d=u[h];if(d){var f=r>>h,g=s>>h;o(c.mipmask&1<<h,"missing mipmap data"),o(d.width===f&&d.height===g,"invalid shape for mip images"),o(d.format===e.format&&d.internalformat===e.internalformat&&d.type===e.type,"incompatible type for mip image"),d.compressed||(d.data?o(d.data.byteLength===f*g*Math.max(Q(d.type,a),d.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):d.element||d.copy)}}}}Z[5120]=Z[z]=1,Z[V]=Z[U]=Z[X]=Z[$]=Z[K]=Z[q]=2,Z[H]=Z[j]=Z[G]=Z[Y]=4;var ne=t(o,{optional:M,raise:r,commandRaise:D,command:N,parameter:a,commandParameter:I,constructor:g,type:u,commandType:T,isTypedArray:l,nni:h,oneOf:d,shaderError:x,linkError:E,callSite:b,saveCommandRef:k,saveDrawInfo:L,framebufferFormat:A,guessCommand:_,texture2D:ee,textureCube:te}),ie=0,re=0,oe=5,se=6;function ae(e,t){this.id=ie++,this.type=e,this.data=t}function le(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ce(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+le(e.substr(1,e.length-2))+'"'];var i=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(i)return ce(e.substr(0,i.index)).concat(ce(i[1])).concat(ce(e.substr(i.index+i[0].length)));var r=e.split(".");if(1===r.length)return['"'+le(e)+'"'];for(var o=[],s=0;s<r.length;++s)o=o.concat(ce(r[s]));return o}function ue(e){return"["+ce(e).join("][")+"]"}function he(e,t){return new ae(e,ue(t+""))}function de(e){return"function"==typeof e&&!e._reglType||e instanceof ae}function fe(e,t){return"function"==typeof e?new ae(re,e):"number"==typeof e||"boolean"==typeof e?new ae(oe,e):Array.isArray(e)?new ae(se,e.map(((e,n)=>fe(e,t+"["+n+"]")))):e instanceof ae?e:void ne(!1,"invalid option type in uniform "+t)}var ge={DynamicVariable:ae,define:he,isDynamic:de,unbox:fe,accessor:ue},pe={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},me="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function ve(){var e={"":0},t=[""];return{id:function(n){var i=e[n];return i||(i=e[n]=t.length,t.push(n),i)},str:function(e){return t[e]}}}function ye(e,n,i){var r,o=document.createElement("canvas");function s(){var n=window.innerWidth,r=window.innerHeight;if(e!==document.body){var s=e.getBoundingClientRect();n=s.right-s.left,r=s.bottom-s.top}o.width=i*n,o.height=i*r,t(o.style,{width:n+"px",height:r+"px"})}function a(){r?r.disconnect():window.removeEventListener("resize",s),e.removeChild(o)}return t(o.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(o),e===document.body&&(o.style.position="absolute",t(e.style,{margin:0,padding:0})),e!==document.body&&"function"==typeof ResizeObserver?(r=new ResizeObserver((function(){setTimeout(s)}))).observe(e):window.addEventListener("resize",s,!1),s(),{canvas:o,onDestroy:a}}function _e(e,t){function n(n){try{return e.getContext(n,t)}catch(zWe){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function be(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}function we(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}function Ce(e){return"string"==typeof e?e.split():(ne(Array.isArray(e),"invalid extension array"),e)}function Se(e){return"string"==typeof e?(ne("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function xe(e){var t,n,i,r,o=e||{},s={},a=[],l=[],c="undefined"==typeof window?1:window.devicePixelRatio,u=!1,h=function(e){e&&ne.raise(e)},d=function(){};if("string"==typeof o?(ne("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),t=document.querySelector(o),ne(t,"invalid query string for element")):"object"==typeof o?be(o)?t=o:we(o)?i=(r=o).canvas:(ne.constructor(o),"gl"in o?r=o.gl:"canvas"in o?i=Se(o.canvas):"container"in o&&(n=Se(o.container)),"attributes"in o&&(s=o.attributes,ne.type(s,"object","invalid context attributes")),"extensions"in o&&(a=Ce(o.extensions)),"optionalExtensions"in o&&(l=Ce(o.optionalExtensions)),"onDone"in o&&(ne.type(o.onDone,"function","invalid or missing onDone callback"),h=o.onDone),"profile"in o&&(u=!!o.profile),"pixelRatio"in o&&(c=+o.pixelRatio,ne(c>0,"invalid pixel ratio"))):ne.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?i=t:n=t),!r){if(!i){ne("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var f=ye(n||document.body,h,c);if(!f)return null;i=f.canvas,d=f.onDestroy}void 0===s.premultipliedAlpha&&(s.premultipliedAlpha=!0),r=_e(i,s)}return r?{gl:r,canvas:i,container:n,extensions:a,optionalExtensions:l,pixelRatio:c,profile:u,onDone:h,onDestroy:d}:(d(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Ee(e,t){var n={};function i(t){ne.type(t,"string","extension name must be string");var i,r=t.toLowerCase();try{i=n[r]=e.getExtension(r)}catch(zWe){}return!!i}for(var r=0;r<t.extensions.length;++r){var o=t.extensions[r];if(!i(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(i),{extensions:n,restore:function(){Object.keys(n).forEach((function(e){if(n[e]&&!i(e))throw new Error("(regl): error restoring extension "+e)}))}}}function ke(e,t){for(var n=Array(e),i=0;i<e;++i)n[i]=t(i);return n}var Le=5120,De=5121,Ne=5122,Ie=5123,Te=5124,Me=5125,Ae=5126;function Oe(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function Re(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1}function Pe(){var e=ke(8,(function(){return[]}));function t(t){var n=Oe(t),i=e[Re(n)>>2];return i.length>0?i.pop():new ArrayBuffer(n)}function n(t){e[Re(t.byteLength)>>2].push(t)}function i(e,n){var i=null;switch(e){case Le:i=new Int8Array(t(n),0,n);break;case De:i=new Uint8Array(t(n),0,n);break;case Ne:i=new Int16Array(t(2*n),0,n);break;case Ie:i=new Uint16Array(t(2*n),0,n);break;case Te:i=new Int32Array(t(4*n),0,n);break;case Me:i=new Uint32Array(t(4*n),0,n);break;case Ae:i=new Float32Array(t(4*n),0,n);break;default:return null}return i.length!==n?i.subarray(0,n):i}function r(e){n(e.buffer)}return{alloc:t,free:n,allocType:i,freeType:r}}var Fe=Pe();Fe.zero=Pe();var Be=3408,We=3410,ze=3411,Ve=3412,Ue=3413,He=3414,je=3415,Ge=33901,Ke=33902,qe=3379,$e=3386,Ye=34921,Xe=36347,Ze=36348,Qe=35661,Je=35660,et=34930,tt=36349,nt=34076,it=34024,rt=7936,ot=7937,st=7938,at=35724,lt=34047,ct=36063,ut=34852,ht=3553,dt=34067,ft=34069,gt=33984,pt=6408,mt=5126,vt=5121,yt=36160,_t=36053,bt=36064,wt=16384,Ct=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(lt));var i=1,r=1;t.webgl_draw_buffers&&(i=e.getParameter(ut),r=e.getParameter(ct));var o=!!t.oes_texture_float;if(o){var s=e.createTexture();e.bindTexture(ht,s),e.texImage2D(ht,0,pt,1,1,0,pt,mt,null);var a=e.createFramebuffer();if(e.bindFramebuffer(yt,a),e.framebufferTexture2D(yt,bt,ht,s,0),e.bindTexture(ht,null),e.checkFramebufferStatus(yt)!==_t)o=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(wt);var l=Fe.allocType(mt,4);e.readPixels(0,0,1,1,pt,mt,l),e.getError()?o=!1:(e.deleteFramebuffer(a),e.deleteTexture(s),o=1===l[0]),Fe.freeType(l)}}var c=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var u=e.createTexture(),h=Fe.allocType(vt,36);e.activeTexture(gt),e.bindTexture(dt,u),e.texImage2D(ft,0,pt,3,3,0,pt,vt,h),Fe.freeType(h),e.bindTexture(dt,null),e.deleteTexture(u),c=!e.getError()}return{colorBits:[e.getParameter(We),e.getParameter(ze),e.getParameter(Ve),e.getParameter(Ue)],depthBits:e.getParameter(He),stencilBits:e.getParameter(je),subpixelBits:e.getParameter(Be),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:n,maxDrawbuffers:i,maxColorAttachments:r,pointSizeDims:e.getParameter(Ge),lineWidthDims:e.getParameter(Ke),maxViewportDims:e.getParameter($e),maxCombinedTextureUnits:e.getParameter(Qe),maxCubeMapSize:e.getParameter(nt),maxRenderbufferSize:e.getParameter(it),maxTextureUnits:e.getParameter(et),maxTextureSize:e.getParameter(qe),maxAttributes:e.getParameter(Ye),maxVertexUniforms:e.getParameter(Xe),maxVertexTextureUnits:e.getParameter(Je),maxVaryingVectors:e.getParameter(Ze),maxFragmentUniforms:e.getParameter(tt),glsl:e.getParameter(at),renderer:e.getParameter(ot),vendor:e.getParameter(rt),version:e.getParameter(st),readFloat:o,npotTextureCube:c}};function St(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var xt=function(e){return Object.keys(e).map((function(t){return e[t]}))},Et={shape:Tt,flatten:It};function kt(e,t,n){for(var i=0;i<t;++i)n[i]=e[i]}function Lt(e,t,n,i){for(var r=0,o=0;o<t;++o)for(var s=e[o],a=0;a<n;++a)i[r++]=s[a]}function Dt(e,t,n,i,r,o){for(var s=o,a=0;a<t;++a)for(var l=e[a],c=0;c<n;++c)for(var u=l[c],h=0;h<i;++h)r[s++]=u[h]}function Nt(e,t,n,i,r){for(var o=1,s=n+1;s<t.length;++s)o*=t[s];var a=t[n];if(t.length-n==4){var l=t[n+1],c=t[n+2],u=t[n+3];for(s=0;s<a;++s)Dt(e[s],l,c,u,i,r),r+=o}else for(s=0;s<a;++s)Nt(e[s],t,n+1,i,r),r+=o}function It(e,t,n,i){var r=1;if(t.length)for(var o=0;o<t.length;++o)r*=t[o];else r=0;var s=i||Fe.allocType(n,r);switch(t.length){case 0:break;case 1:kt(e,t[0],s);break;case 2:Lt(e,t[0],t[1],s);break;case 3:Dt(e,t[0],t[1],t[2],s,0);break;default:Nt(e,t,0,s,0)}return s}function Tt(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t}var Mt={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},At={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Ot={dynamic:35048,stream:35040,static:35044},Rt=Et.flatten,Pt=Et.shape,Ft=35044,Bt=35040,Wt=5121,zt=5126,Vt=[];function Ut(e){return 0|Mt[Object.prototype.toString.call(e)]}function Ht(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function jt(e,t,n,i,r,o,s){for(var a=0,l=0;l<n;++l)for(var c=0;c<i;++c)e[a++]=t[r*l+o*c+s]}function Gt(t,n,i,r){var o=0,s={};function a(e){this.id=o++,this.buffer=t.createBuffer(),this.type=e,this.usage=Ft,this.byteLength=0,this.dimension=1,this.dtype=Wt,this.persistentData=null,i.profile&&(this.stats={size:0})}a.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},a.prototype.destroy=function(){f(this)};var l=[];function c(e,t){var n=l.pop();return n||(n=new a(e)),n.bind(),d(n,t,Bt,0,1,!1),n}function u(e){l.push(e)}function h(e,n,i){e.byteLength=n.byteLength,t.bufferData(e.type,n,i)}function d(t,n,i,r,o,s){var a,l;if(t.usage=i,Array.isArray(n)){if(t.dtype=r||zt,n.length>0)if(Array.isArray(n[0])){a=Pt(n);for(var c=1,u=1;u<a.length;++u)c*=a[u];t.dimension=c,h(t,l=Rt(n,a,t.dtype),i),s?t.persistentData=l:Fe.freeType(l)}else if("number"==typeof n[0]){t.dimension=o;var d=Fe.allocType(t.dtype,n.length);Ht(d,n),h(t,d,i),s?t.persistentData=d:Fe.freeType(d)}else e(n[0])?(t.dimension=n[0].length,t.dtype=r||Ut(n[0])||zt,h(t,l=Rt(n,[n.length,n[0].length],t.dtype),i),s?t.persistentData=l:Fe.freeType(l)):ne.raise("invalid buffer data")}else if(e(n))t.dtype=r||Ut(n),t.dimension=o,h(t,n,i),s&&(t.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(St(n)){a=n.shape;var f=n.stride,g=n.offset,p=0,m=0,v=0,y=0;1===a.length?(p=a[0],m=1,v=f[0],y=0):2===a.length?(p=a[0],m=a[1],v=f[0],y=f[1]):ne.raise("invalid shape"),t.dtype=r||Ut(n.data)||zt,t.dimension=m;var _=Fe.allocType(t.dtype,p*m);jt(_,n.data,p,m,v,y,g),h(t,_,i),s?t.persistentData=_:Fe.freeType(_)}else n instanceof ArrayBuffer?(t.dtype=Wt,t.dimension=o,h(t,n,i),s&&(t.persistentData=new Uint8Array(new Uint8Array(n)))):ne.raise("invalid buffer data")}function f(e){n.bufferCount--,r(e);var i=e.buffer;ne(i,"buffer must not be deleted already"),t.deleteBuffer(i),e.buffer=null,delete s[e.id]}function g(r,o,l,c){n.bufferCount++;var u=new a(o);function h(n){var r=Ft,o=null,s=0,a=0,l=1;return Array.isArray(n)||e(n)||St(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?s=0|n:n&&(ne.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(ne(null===o||Array.isArray(o)||e(o)||St(o),"invalid data for buffer"),o=n.data),"usage"in n&&(ne.parameter(n.usage,Ot,"invalid buffer usage"),r=Ot[n.usage]),"type"in n&&(ne.parameter(n.type,At,"invalid buffer type"),a=At[n.type]),"dimension"in n&&(ne.type(n.dimension,"number","invalid dimension"),l=0|n.dimension),"length"in n&&(ne.nni(s,"buffer length must be a nonnegative integer"),s=0|n.length)),u.bind(),o?d(u,o,r,a,l,c):(s&&t.bufferData(u.type,s,r),u.dtype=a||Wt,u.usage=r,u.dimension=l,u.byteLength=s),i.profile&&(u.stats.size=u.byteLength*Vt[u.dtype]),h}function g(e,n){ne(n+e.byteLength<=u.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+u.byteLength),t.bufferSubData(u.type,n,e)}function p(t,n){var i,r=0|(n||0);if(u.bind(),e(t)||t instanceof ArrayBuffer)g(t,r);else if(Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var o=Fe.allocType(u.dtype,t.length);Ht(o,t),g(o,r),Fe.freeType(o)}else if(Array.isArray(t[0])||e(t[0])){i=Pt(t);var s=Rt(t,i,u.dtype);g(s,r),Fe.freeType(s)}else ne.raise("invalid buffer data")}else if(St(t)){i=t.shape;var a=t.stride,l=0,c=0,d=0,f=0;1===i.length?(l=i[0],c=1,d=a[0],f=0):2===i.length?(l=i[0],c=i[1],d=a[0],f=a[1]):ne.raise("invalid shape");var p=Array.isArray(t.data)?u.dtype:Ut(t.data),m=Fe.allocType(p,l*c);jt(m,t.data,l,c,d,f,t.offset),g(m,r),Fe.freeType(m)}else ne.raise("invalid data for buffer subdata");return h}return s[u.id]=u,l||h(r),h._reglType="buffer",h._buffer=u,h.subdata=p,i.profile&&(h.stats=u.stats),h.destroy=function(){f(u)},h}function p(){xt(s).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))}return i.profile&&(n.getTotalBufferSize=function(){var e=0;return Object.keys(s).forEach((function(t){e+=s[t].stats.size})),e}),{create:g,createStream:c,destroyStream:u,clear:function(){xt(s).forEach(f),l.forEach(f)},getBuffer:function(e){return e&&e._buffer instanceof a?e._buffer:null},restore:p,_initBuffer:d}}Vt[5120]=1,Vt[5122]=2,Vt[5124]=4,Vt[5121]=1,Vt[5123]=2,Vt[5125]=4,Vt[5126]=4;var Kt={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},qt=0,$t=1,Yt=4,Xt=5120,Zt=5121,Qt=5122,Jt=5123,en=5124,tn=5125,nn=34963,rn=35040,on=35044;function sn(t,n,i,r){var o={},s=0,a={uint8:Zt,uint16:Jt};function l(e){this.id=s++,o[this.id]=this,this.buffer=e,this.primType=Yt,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(a.uint32=tn),l.prototype.bind=function(){this.buffer.bind()};var c=[];function u(e){var t=c.pop();return t||(t=new l(i.create(null,nn,!0,!1)._buffer)),d(t,e,rn,-1,-1,0,0),t}function h(e){c.push(e)}function d(r,o,s,a,l,c,u){var h;if(r.buffer.bind(),o){var d=u;u||e(o)&&(!St(o)||e(o.data))||(d=n.oes_element_index_uint?tn:Jt),i._initBuffer(r.buffer,o,s,d,3)}else t.bufferData(nn,c,s),r.buffer.dtype=h||Zt,r.buffer.usage=s,r.buffer.dimension=3,r.buffer.byteLength=c;if(h=u,!u){switch(r.buffer.dtype){case Zt:case Xt:h=Zt;break;case Jt:case Qt:h=Jt;break;case tn:case en:h=tn;break;default:ne.raise("unsupported type for element array")}r.buffer.dtype=h}r.type=h,ne(h!==tn||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var f=l;f<0&&(f=r.buffer.byteLength,h===Jt?f>>=1:h===tn&&(f>>=2)),r.vertCount=f;var g=a;if(a<0){g=Yt;var p=r.buffer.dimension;1===p&&(g=qt),2===p&&(g=$t),3===p&&(g=Yt)}r.primType=g}function f(e){r.elementsCount--,ne(null!==e.buffer,"must not double destroy elements"),delete o[e.id],e.buffer.destroy(),e.buffer=null}function g(t,n){var o=i.create(null,nn,!0),s=new l(o._buffer);function c(t){if(t)if("number"==typeof t)o(t),s.primType=Yt,s.vertCount=0|t,s.type=Zt;else{var n=null,i=on,r=-1,l=-1,u=0,h=0;Array.isArray(t)||e(t)||St(t)?n=t:(ne.type(t,"object","invalid arguments for elements"),"data"in t&&(n=t.data,ne(Array.isArray(n)||e(n)||St(n),"invalid data for element buffer")),"usage"in t&&(ne.parameter(t.usage,Ot,"invalid element buffer usage"),i=Ot[t.usage]),"primitive"in t&&(ne.parameter(t.primitive,Kt,"invalid element buffer primitive"),r=Kt[t.primitive]),"count"in t&&(ne("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),l=0|t.count),"type"in t&&(ne.parameter(t.type,a,"invalid buffer type"),h=a[t.type]),"length"in t?u=0|t.length:(u=l,h===Jt||h===Qt?u*=2:h!==tn&&h!==en||(u*=4))),d(s,n,i,r,l,u,h)}else o(),s.primType=Yt,s.vertCount=0,s.type=Zt;return c}return r.elementsCount++,c(t),c._reglType="elements",c._elements=s,c.subdata=function(e,t){return o.subdata(e,t),c},c.destroy=function(){f(s)},c}return{create:g,createStream:u,destroyStream:h,getElements:function(e){return"function"==typeof e&&e._elements instanceof l?e._elements:null},clear:function(){xt(o).forEach(f)}}}var an=new Float32Array(1),ln=new Uint32Array(an.buffer),cn=5123;function un(e){for(var t=Fe.allocType(cn,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{an[0]=e[n];var i=ln[0],r=i>>>31<<15,o=(i<<1>>>24)-127,s=i>>13&1023;if(o<-24)t[n]=r;else if(o<-14){var a=-14-o;t[n]=r+(s+1024>>a)}else t[n]=o>15?r+31744:r+(o+15<<10)+s}return t}function hn(t){return Array.isArray(t)||e(t)}var dn=function(e){return!(e&e-1||!e)},fn=34467,gn=3553,pn=34067,mn=34069,vn=6408,yn=6406,_n=6407,bn=6409,wn=6410,Cn=32854,Sn=32855,xn=36194,En=32819,kn=32820,Ln=33635,Dn=34042,Nn=6402,In=34041,Tn=35904,Mn=35906,An=36193,On=33776,Rn=33777,Pn=33778,Fn=33779,Bn=35986,Wn=35987,zn=34798,Vn=35840,Un=35841,Hn=35842,jn=35843,Gn=36196,Kn=5121,qn=5123,$n=5125,Yn=5126,Xn=10242,Zn=10243,Qn=10497,Jn=33071,ei=33648,ti=10240,ni=10241,ii=9728,ri=9729,oi=9984,si=9985,ai=9986,li=9987,ci=33170,ui=4352,hi=4353,di=4354,fi=34046,gi=3317,pi=37440,mi=37441,vi=37443,yi=37444,_i=33984,bi=[oi,ai,si,li],wi=[0,bn,wn,_n,vn],Ci={};function Si(e){return"[object "+e+"]"}Ci[bn]=Ci[yn]=Ci[Nn]=1,Ci[In]=Ci[wn]=2,Ci[_n]=Ci[Tn]=3,Ci[vn]=Ci[Mn]=4;var xi=Si("HTMLCanvasElement"),Ei=Si("OffscreenCanvas"),ki=Si("CanvasRenderingContext2D"),Li=Si("ImageBitmap"),Di=Si("HTMLImageElement"),Ni=Si("HTMLVideoElement"),Ii=Object.keys(Mt).concat([xi,Ei,ki,Li,Di,Ni]),Ti=[];Ti[Kn]=1,Ti[Yn]=4,Ti[An]=2,Ti[qn]=2,Ti[$n]=4;var Mi=[];function Ai(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function Oi(e){return!!Array.isArray(e)&&!(0===e.length||!hn(e[0]))}function Ri(e){return Object.prototype.toString.call(e)}function Pi(e){return Ri(e)===xi}function Fi(e){return Ri(e)===Ei}function Bi(e){return Ri(e)===ki}function Wi(e){return Ri(e)===Li}function zi(e){return Ri(e)===Di}function Vi(e){return Ri(e)===Ni}function Ui(e){if(!e)return!1;var t=Ri(e);return Ii.indexOf(t)>=0||Ai(e)||Oi(e)||St(e)}function Hi(e){return 0|Mt[Object.prototype.toString.call(e)]}function ji(e,t){var n=t.length;switch(e.type){case Kn:case qn:case $n:case Yn:var i=Fe.allocType(e.type,n);i.set(t),e.data=i;break;case An:e.data=un(t);break;default:ne.raise("unsupported texture type, must specify a typed array")}}function Gi(e,t){return Fe.allocType(e.type===An?Yn:e.type,t)}function Ki(e,t){e.type===An?(e.data=un(t),Fe.freeType(t)):e.data=t}function qi(e,t,n,i,r,o){for(var s=e.width,a=e.height,l=e.channels,c=Gi(e,s*a*l),u=0,h=0;h<a;++h)for(var d=0;d<s;++d)for(var f=0;f<l;++f)c[u++]=t[n*d+i*h+r*f+o];Ki(e,c)}function $i(e,t,n,i,r,o){var s;if(s=void 0!==Mi[e]?Mi[e]:Ci[e]*Ti[t],o&&(s*=6),r){for(var a=0,l=n;l>=1;)a+=s*l*l,l/=2;return a}return s*n*i}function Yi(n,i,r,o,s,a,l){var c={"don't care":ui,"dont care":ui,nice:di,fast:hi},u={repeat:Qn,clamp:Jn,mirror:ei},h={nearest:ii,linear:ri},d=t({mipmap:li,"nearest mipmap nearest":oi,"linear mipmap nearest":si,"nearest mipmap linear":ai,"linear mipmap linear":li},h),f={none:0,browser:yi},g={uint8:Kn,rgba4:En,rgb565:Ln,"rgb5 a1":kn},p={alpha:yn,luminance:bn,"luminance alpha":wn,rgb:_n,rgba:vn,rgba4:Cn,"rgb5 a1":Sn,rgb565:xn},m={};i.ext_srgb&&(p.srgb=Tn,p.srgba=Mn),i.oes_texture_float&&(g.float32=g.float=Yn),i.oes_texture_half_float&&(g.float16=g["half float"]=An),i.webgl_depth_texture&&(t(p,{depth:Nn,"depth stencil":In}),t(g,{uint16:qn,uint32:$n,"depth stencil":Dn})),i.webgl_compressed_texture_s3tc&&t(m,{"rgb s3tc dxt1":On,"rgba s3tc dxt1":Rn,"rgba s3tc dxt3":Pn,"rgba s3tc dxt5":Fn}),i.webgl_compressed_texture_atc&&t(m,{"rgb atc":Bn,"rgba atc explicit alpha":Wn,"rgba atc interpolated alpha":zn}),i.webgl_compressed_texture_pvrtc&&t(m,{"rgb pvrtc 4bppv1":Vn,"rgb pvrtc 2bppv1":Un,"rgba pvrtc 4bppv1":Hn,"rgba pvrtc 2bppv1":jn}),i.webgl_compressed_texture_etc1&&(m["rgb etc1"]=Gn);var v=Array.prototype.slice.call(n.getParameter(fn));Object.keys(m).forEach((function(e){var t=m[e];v.indexOf(t)>=0&&(p[e]=t)}));var y=Object.keys(p);r.textureFormats=y;var _=[];Object.keys(p).forEach((function(e){var t=p[e];_[t]=e}));var b=[];Object.keys(g).forEach((function(e){var t=g[e];b[t]=e}));var w=[];Object.keys(h).forEach((function(e){var t=h[e];w[t]=e}));var C=[];Object.keys(d).forEach((function(e){var t=d[e];C[t]=e}));var S=[];Object.keys(u).forEach((function(e){var t=u[e];S[t]=e}));var x=y.reduce((function(e,t){var n=p[t];return n===bn||n===yn||n===bn||n===wn||n===Nn||n===In||i.ext_srgb&&(n===Tn||n===Mn)?e[n]=n:n===Sn||t.indexOf("rgba")>=0?e[n]=vn:e[n]=_n,e}),{});function E(){this.internalformat=vn,this.format=vn,this.type=Kn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=yi,this.width=0,this.height=0,this.channels=0}function k(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function L(e,t){if("object"==typeof t&&t){if("premultiplyAlpha"in t&&(ne.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(ne.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(ne.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(ne.parameter(t.colorSpace,f,"invalid colorSpace"),e.colorSpace=f[t.colorSpace]),"type"in t){var n=t.type;ne(i.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),ne(i.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),ne(i.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ne.parameter(n,g,"invalid texture type"),e.type=g[n]}var o=e.width,s=e.height,a=e.channels,l=!1;"shape"in t?(ne(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),o=t.shape[0],s=t.shape[1],3===t.shape.length&&(a=t.shape[2],ne(a>0&&a<=4,"invalid number of channels"),l=!0),ne(o>=0&&o<=r.maxTextureSize,"invalid width"),ne(s>=0&&s<=r.maxTextureSize,"invalid height")):("radius"in t&&(o=s=t.radius,ne(o>=0&&o<=r.maxTextureSize,"invalid radius")),"width"in t&&(o=t.width,ne(o>=0&&o<=r.maxTextureSize,"invalid width")),"height"in t&&(s=t.height,ne(s>=0&&s<=r.maxTextureSize,"invalid height")),"channels"in t&&(a=t.channels,ne(a>0&&a<=4,"invalid number of channels"),l=!0)),e.width=0|o,e.height=0|s,e.channels=0|a;var c=!1;if("format"in t){var u=t.format;ne(i.webgl_depth_texture||!("depth"===u||"depth stencil"===u),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ne.parameter(u,p,"invalid texture format");var h=e.internalformat=p[u];e.format=x[h],u in g&&("type"in t||(e.type=g[u])),u in m&&(e.compressed=!0),c=!0}!l&&c?e.channels=Ci[e.format]:l&&!c?e.channels!==wi[e.format]&&(e.format=e.internalformat=wi[e.channels]):c&&l&&ne(e.channels===Ci[e.format],"number of channels inconsistent with specified format")}}function D(e){n.pixelStorei(pi,e.flipY),n.pixelStorei(mi,e.premultiplyAlpha),n.pixelStorei(vi,e.colorSpace),n.pixelStorei(gi,e.unpackAlignment)}function N(){E.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function I(t,n){var i=null;if(Ui(n)?i=n:n&&(ne.type(n,"object","invalid pixel data type"),L(t,n),"x"in n&&(t.xOffset=0|n.x),"y"in n&&(t.yOffset=0|n.y),Ui(n.data)&&(i=n.data)),ne(!t.compressed||i instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){ne(!i,"can not specify copy and data field for the same texture");var o=s.viewportWidth,a=s.viewportHeight;t.width=t.width||o-t.xOffset,t.height=t.height||a-t.yOffset,t.needsCopy=!0,ne(t.xOffset>=0&&t.xOffset<o&&t.yOffset>=0&&t.yOffset<a&&t.width>0&&t.width<=o&&t.height>0&&t.height<=a,"copy texture read out of bounds")}else if(i){if(e(i))t.channels=t.channels||4,t.data=i,"type"in n||t.type!==Kn||(t.type=Hi(i));else if(Ai(i))t.channels=t.channels||4,ji(t,i),t.alignment=1,t.needsFree=!0;else if(St(i)){var l=i.data;Array.isArray(l)||t.type!==Kn||(t.type=Hi(l));var c,u,h,d,f,g,p=i.shape,m=i.stride;3===p.length?(h=p[2],g=m[2]):(ne(2===p.length,"invalid ndarray pixel data, must be 2 or 3D"),h=1,g=1),c=p[0],u=p[1],d=m[0],f=m[1],t.alignment=1,t.width=c,t.height=u,t.channels=h,t.format=t.internalformat=wi[h],t.needsFree=!0,qi(t,l,d,f,g,i.offset)}else if(Pi(i)||Fi(i)||Bi(i))Pi(i)||Fi(i)?t.element=i:t.element=i.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(Wi(i))t.element=i,t.width=i.width,t.height=i.height,t.channels=4;else if(zi(i))t.element=i,t.width=i.naturalWidth,t.height=i.naturalHeight,t.channels=4;else if(Vi(i))t.element=i,t.width=i.videoWidth,t.height=i.videoHeight,t.channels=4;else if(Oi(i)){var v=t.width||i[0].length,y=t.height||i.length,_=t.channels;_=hn(i[0][0])?_||i[0][0].length:_||1;for(var b=Et.shape(i),w=1,C=0;C<b.length;++C)w*=b[C];var S=Gi(t,w);Et.flatten(i,b,"",S),Ki(t,S),t.alignment=1,t.width=v,t.height=y,t.channels=_,t.format=t.internalformat=wi[_],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===Yn?ne(r.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===An&&ne(r.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function T(e,t,i){var r=e.element,s=e.data,a=e.internalformat,l=e.format,c=e.type,u=e.width,h=e.height;D(e),r?n.texImage2D(t,i,l,l,c,r):e.compressed?n.compressedTexImage2D(t,i,a,u,h,0,s):e.needsCopy?(o(),n.copyTexImage2D(t,i,l,e.xOffset,e.yOffset,u,h,0)):n.texImage2D(t,i,l,u,h,0,l,c,s||null)}function M(e,t,i,r,s){var a=e.element,l=e.data,c=e.internalformat,u=e.format,h=e.type,d=e.width,f=e.height;D(e),a?n.texSubImage2D(t,s,i,r,u,h,a):e.compressed?n.compressedTexSubImage2D(t,s,i,r,c,d,f,l):e.needsCopy?(o(),n.copyTexSubImage2D(t,s,i,r,e.xOffset,e.yOffset,d,f)):n.texSubImage2D(t,s,i,r,d,f,u,h,l)}var A=[];function O(){return A.pop()||new N}function R(e){e.needsFree&&Fe.freeType(e.data),N.call(e),A.push(e)}function P(){E.call(this),this.genMipmaps=!1,this.mipmapHint=ui,this.mipmask=0,this.images=Array(16)}function F(e,t,n){var i=e.images[0]=O();e.mipmask=1,i.width=e.width=t,i.height=e.height=n,i.channels=e.channels=4}function B(e,t){var n=null;if(Ui(t))k(n=e.images[0]=O(),e),I(n,t),e.mipmask=1;else if(L(e,t),Array.isArray(t.mipmap))for(var i=t.mipmap,r=0;r<i.length;++r)k(n=e.images[r]=O(),e),n.width>>=r,n.height>>=r,I(n,i[r]),e.mipmask|=1<<r;else k(n=e.images[0]=O(),e),I(n,t),e.mipmask=1;k(e,e.images[0]),!e.compressed||e.internalformat!==On&&e.internalformat!==Rn&&e.internalformat!==Pn&&e.internalformat!==Fn||ne(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function W(e,t){for(var n=e.images,i=0;i<n.length;++i){if(!n[i])return;T(n[i],t,i)}}var z=[];function V(){var e=z.pop()||new P;E.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function U(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&R(t[n]),t[n]=null;z.push(e)}function H(){this.minFilter=ii,this.magFilter=ii,this.wrapS=Jn,this.wrapT=Jn,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ui}function j(e,t){if("min"in t){var n=t.min;ne.parameter(n,d),e.minFilter=d[n],bi.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var i=t.mag;ne.parameter(i,h),e.magFilter=h[i]}var o=e.wrapS,s=e.wrapT;if("wrap"in t){var a=t.wrap;"string"==typeof a?(ne.parameter(a,u),o=s=u[a]):Array.isArray(a)&&(ne.parameter(a[0],u),ne.parameter(a[1],u),o=u[a[0]],s=u[a[1]])}else{if("wrapS"in t){var l=t.wrapS;ne.parameter(l,u),o=u[l]}if("wrapT"in t){var f=t.wrapT;ne.parameter(f,u),s=u[f]}}if(e.wrapS=o,e.wrapT=s,"anisotropic"in t){var g=t.anisotropic;ne("number"==typeof g&&g>=1&&g<=r.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var p=!1;switch(typeof t.mipmap){case"string":ne.parameter(t.mipmap,c,"invalid mipmap hint"),e.mipmapHint=c[t.mipmap],e.genMipmaps=!0,p=!0;break;case"boolean":p=e.genMipmaps=t.mipmap;break;case"object":ne(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,p=!0;break;default:ne.raise("invalid mipmap type")}p&&!("min"in t)&&(e.minFilter=oi)}}function G(e,t){n.texParameteri(t,ni,e.minFilter),n.texParameteri(t,ti,e.magFilter),n.texParameteri(t,Xn,e.wrapS),n.texParameteri(t,Zn,e.wrapT),i.ext_texture_filter_anisotropic&&n.texParameteri(t,fi,e.anisotropic),e.genMipmaps&&(n.hint(ci,e.mipmapHint),n.generateMipmap(t))}var K=0,q={},$=r.maxTextureUnits,Y=Array($).map((function(){return null}));function X(e){E.call(this),this.mipmask=0,this.internalformat=vn,this.id=K++,this.refCount=1,this.target=e,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new H,l.profile&&(this.stats={size:0})}function Z(e){n.activeTexture(_i),n.bindTexture(e.target,e.texture)}function Q(){var e=Y[0];e?n.bindTexture(e.target,e.texture):n.bindTexture(gn,null)}function J(e){var t=e.texture;ne(t,"must not double destroy texture");var i=e.unit,r=e.target;i>=0&&(n.activeTexture(_i+i),n.bindTexture(r,null),Y[i]=null),n.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete q[e.id],a.textureCount--}function ee(e,t){var i=new X(gn);function o(e,t){var n=i.texInfo;H.call(n);var s=V();return"number"==typeof e?F(s,0|e,"number"==typeof t?0|t:0|e):e?(ne.type(e,"object","invalid arguments to regl.texture"),j(n,e),B(s,e)):F(s,1,1),n.genMipmaps&&(s.mipmask=(s.width<<1)-1),i.mipmask=s.mipmask,k(i,s),ne.texture2D(n,s,r),i.internalformat=s.internalformat,o.width=s.width,o.height=s.height,Z(i),W(s,gn),G(n,gn),Q(),U(s),l.profile&&(i.stats.size=$i(i.internalformat,i.type,s.width,s.height,n.genMipmaps,!1)),o.format=_[i.internalformat],o.type=b[i.type],o.mag=w[n.magFilter],o.min=C[n.minFilter],o.wrapS=S[n.wrapS],o.wrapT=S[n.wrapT],o}function s(e,t,n,r){ne(!!e,"must specify image data");var s=0|t,a=0|n,l=0|r,c=O();return k(c,i),c.width=0,c.height=0,I(c,e),c.width=c.width||(i.width>>l)-s,c.height=c.height||(i.height>>l)-a,ne(i.type===c.type&&i.format===c.format&&i.internalformat===c.internalformat,"incompatible format for texture.subimage"),ne(s>=0&&a>=0&&s+c.width<=i.width&&a+c.height<=i.height,"texture.subimage write out of bounds"),ne(i.mipmask&1<<l,"missing mipmap data"),ne(c.data||c.element||c.needsCopy,"missing image data"),Z(i),M(c,gn,s,a,l),Q(),R(c),o}function c(e,t){var r=0|e,s=0|t||r;if(r===i.width&&s===i.height)return o;o.width=i.width=r,o.height=i.height=s,Z(i);for(var a=0;i.mipmask>>a;++a){var c=r>>a,u=s>>a;if(!c||!u)break;n.texImage2D(gn,a,i.format,c,u,0,i.format,i.type,null)}return Q(),l.profile&&(i.stats.size=$i(i.internalformat,i.type,r,s,!1,!1)),o}return q[i.id]=i,a.textureCount++,o(e,t),o.subimage=s,o.resize=c,o._reglType="texture2d",o._texture=i,l.profile&&(o.stats=i.stats),o.destroy=function(){i.decRef()},o}function te(e,t,i,o,s,c){var u=new X(pn);q[u.id]=u,a.cubeCount++;var h=new Array(6);function d(e,t,n,i,o,s){var a,c=u.texInfo;for(H.call(c),a=0;a<6;++a)h[a]=V();if("number"!=typeof e&&e)if("object"==typeof e)if(t)B(h[0],e),B(h[1],t),B(h[2],n),B(h[3],i),B(h[4],o),B(h[5],s);else if(j(c,e),L(u,e),"faces"in e){var f=e.faces;for(ne(Array.isArray(f)&&6===f.length,"cube faces must be a length 6 array"),a=0;a<6;++a)ne("object"==typeof f[a]&&!!f[a],"invalid input for cube map face"),k(h[a],u),B(h[a],f[a])}else for(a=0;a<6;++a)B(h[a],e);else ne.raise("invalid arguments to cube map");else{var g=0|e||1;for(a=0;a<6;++a)F(h[a],g,g)}for(k(u,h[0]),r.npotTextureCube||ne(dn(u.width)&&dn(u.height),"your browser does not support non power or two texture dimensions"),c.genMipmaps?u.mipmask=(h[0].width<<1)-1:u.mipmask=h[0].mipmask,ne.textureCube(u,c,h,r),u.internalformat=h[0].internalformat,d.width=h[0].width,d.height=h[0].height,Z(u),a=0;a<6;++a)W(h[a],mn+a);for(G(c,pn),Q(),l.profile&&(u.stats.size=$i(u.internalformat,u.type,d.width,d.height,c.genMipmaps,!0)),d.format=_[u.internalformat],d.type=b[u.type],d.mag=w[c.magFilter],d.min=C[c.minFilter],d.wrapS=S[c.wrapS],d.wrapT=S[c.wrapT],a=0;a<6;++a)U(h[a]);return d}function f(e,t,n,i,r){ne(!!t,"must specify image data"),ne("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,s=0|i,a=0|r,l=O();return k(l,u),l.width=0,l.height=0,I(l,t),l.width=l.width||(u.width>>a)-o,l.height=l.height||(u.height>>a)-s,ne(u.type===l.type&&u.format===l.format&&u.internalformat===l.internalformat,"incompatible format for texture.subimage"),ne(o>=0&&s>=0&&o+l.width<=u.width&&s+l.height<=u.height,"texture.subimage write out of bounds"),ne(u.mipmask&1<<a,"missing mipmap data"),ne(l.data||l.element||l.needsCopy,"missing image data"),Z(u),M(l,mn+e,o,s,a),Q(),R(l),d}function g(e){var t=0|e;if(t!==u.width){d.width=u.width=t,d.height=u.height=t,Z(u);for(var i=0;i<6;++i)for(var r=0;u.mipmask>>r;++r)n.texImage2D(mn+i,r,u.format,t>>r,t>>r,0,u.format,u.type,null);return Q(),l.profile&&(u.stats.size=$i(u.internalformat,u.type,d.width,d.height,!1,!0)),d}}return d(e,t,i,o,s,c),d.subimage=f,d.resize=g,d._reglType="textureCube",d._texture=u,l.profile&&(d.stats=u.stats),d.destroy=function(){u.decRef()},d}function ie(){for(var e=0;e<$;++e)n.activeTexture(_i+e),n.bindTexture(gn,null),Y[e]=null;xt(q).forEach(J),a.cubeCount=0,a.textureCount=0}function re(){for(var e=0;e<$;++e){var t=Y[e];t&&(t.bindCount=0,t.unit=-1,Y[e]=null)}xt(q).forEach((function(e){e.texture=n.createTexture(),n.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!=(e.mipmask&1<<t))if(e.target===gn)n.texImage2D(gn,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var i=0;i<6;++i)n.texImage2D(mn+i,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);G(e.texInfo,e.target)}))}function oe(){for(var e=0;e<$;++e){var t=Y[e];t&&(t.bindCount=0,t.unit=-1,Y[e]=null),n.activeTexture(_i+e),n.bindTexture(gn,null),n.bindTexture(pn,null)}}return t(X.prototype,{bind:function(){var e=this;e.bindCount+=1;var t=e.unit;if(t<0){for(var i=0;i<$;++i){var r=Y[i];if(r){if(r.bindCount>0)continue;r.unit=-1}Y[i]=e,t=i;break}t>=$&&ne.raise("insufficient number of texture units"),l.profile&&a.maxTextureUnits<t+1&&(a.maxTextureUnits=t+1),e.unit=t,n.activeTexture(_i+t),n.bindTexture(e.target,e.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&J(this)}}),l.profile&&(a.getTotalTextureSize=function(){var e=0;return Object.keys(q).forEach((function(t){e+=q[t].stats.size})),e}),{create2D:ee,createCube:te,clear:ie,getTexture:function(e){return null},restore:re,refresh:oe}}Mi[Cn]=2,Mi[Sn]=2,Mi[xn]=2,Mi[In]=4,Mi[On]=.5,Mi[Rn]=.5,Mi[Pn]=1,Mi[Fn]=1,Mi[Bn]=.5,Mi[Wn]=1,Mi[zn]=1,Mi[Vn]=.5,Mi[Un]=.25,Mi[Hn]=.5,Mi[jn]=.25,Mi[Gn]=.5;var Xi=36161,Zi=32854,Qi=32855,Ji=36194,er=33189,tr=36168,nr=34041,ir=35907,rr=34836,or=34842,sr=34843,ar=[];function lr(e,t,n){return ar[e]*t*n}ar[Zi]=2,ar[Qi]=2,ar[Ji]=2,ar[er]=2,ar[tr]=1,ar[nr]=4,ar[ir]=4,ar[rr]=16,ar[or]=8,ar[sr]=6;var cr=function(e,t,n,i,r){var o={rgba4:Zi,rgb565:Ji,"rgb5 a1":Qi,depth:er,stencil:tr,"depth stencil":nr};t.ext_srgb&&(o.srgba=ir),t.ext_color_buffer_half_float&&(o.rgba16f=or,o.rgb16f=sr),t.webgl_color_buffer_float&&(o.rgba32f=rr);var s=[];Object.keys(o).forEach((function(e){var t=o[e];s[t]=e}));var a=0,l={};function c(e){this.id=a++,this.refCount=1,this.renderbuffer=e,this.format=Zi,this.width=0,this.height=0,r.profile&&(this.stats={size:0})}function u(t){var n=t.renderbuffer;ne(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(Xi,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete l[t.id],i.renderbufferCount--}function h(t,a){var u=new c(e.createRenderbuffer());function h(t,i){var a=0,l=0,c=Zi;if("object"==typeof t&&t){var d=t;if("shape"in d){var f=d.shape;ne(Array.isArray(f)&&f.length>=2,"invalid renderbuffer shape"),a=0|f[0],l=0|f[1]}else"radius"in d&&(a=l=0|d.radius),"width"in d&&(a=0|d.width),"height"in d&&(l=0|d.height);"format"in d&&(ne.parameter(d.format,o,"invalid renderbuffer format"),c=o[d.format])}else"number"==typeof t?(a=0|t,l="number"==typeof i?0|i:a):t?ne.raise("invalid arguments to renderbuffer constructor"):a=l=1;if(ne(a>0&&l>0&&a<=n.maxRenderbufferSize&&l<=n.maxRenderbufferSize,"invalid renderbuffer size"),a!==u.width||l!==u.height||c!==u.format)return h.width=u.width=a,h.height=u.height=l,u.format=c,e.bindRenderbuffer(Xi,u.renderbuffer),e.renderbufferStorage(Xi,c,a,l),ne(0===e.getError(),"invalid render buffer format"),r.profile&&(u.stats.size=lr(u.format,u.width,u.height)),h.format=s[u.format],h}function d(t,i){var o=0|t,s=0|i||o;return o===u.width&&s===u.height||(ne(o>0&&s>0&&o<=n.maxRenderbufferSize&&s<=n.maxRenderbufferSize,"invalid renderbuffer size"),h.width=u.width=o,h.height=u.height=s,e.bindRenderbuffer(Xi,u.renderbuffer),e.renderbufferStorage(Xi,u.format,o,s),ne(0===e.getError(),"invalid render buffer format"),r.profile&&(u.stats.size=lr(u.format,u.width,u.height))),h}return l[u.id]=u,i.renderbufferCount++,h(t,a),h.resize=d,h._reglType="renderbuffer",h._renderbuffer=u,r.profile&&(h.stats=u.stats),h.destroy=function(){u.decRef()},h}function d(){xt(l).forEach((function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(Xi,t.renderbuffer),e.renderbufferStorage(Xi,t.format,t.width,t.height)})),e.bindRenderbuffer(Xi,null)}return c.prototype.decRef=function(){--this.refCount<=0&&u(this)},r.profile&&(i.getTotalRenderbufferSize=function(){var e=0;return Object.keys(l).forEach((function(t){e+=l[t].stats.size})),e}),{create:h,clear:function(){xt(l).forEach(u)},restore:d}},ur=36160,hr=36161,dr=3553,fr=34069,gr=36064,pr=36096,mr=36128,vr=33306,yr=36053,_r=36054,br=36055,wr=36057,Cr=36061,Sr=36193,xr=5121,Er=5126,kr=6407,Lr=6408,Dr=6402,Nr=[kr,Lr],Ir=[];Ir[Lr]=4,Ir[kr]=3;var Tr=[];Tr[xr]=1,Tr[Er]=4,Tr[Sr]=2;var Mr=33189,Ar=36168,Or=34041,Rr=[32854,32855,36194,35907,34842,34843,34836],Pr={};function Fr(e,n,i,r,o,s){var a={cur:null,next:null,dirty:!1,setFBO:null},l=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var u=["uint8"];function h(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var i=0,r=0;t?(i=t.width,r=t.height):n&&(i=n.width,r=n.height),this.width=i,this.height=r}function d(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function f(e,t,n){if(e)if(e.texture){var i=e.texture._texture,r=Math.max(1,i.width),o=Math.max(1,i.height);ne(r===t&&o===n,"inconsistent width/height for supplied texture"),i.refCount+=1}else{var s=e.renderbuffer._renderbuffer;ne(s.width===t&&s.height===n,"inconsistent width/height for renderbuffer"),s.refCount+=1}}function g(t,n){n&&(n.texture?e.framebufferTexture2D(ur,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(ur,t,hr,n.renderbuffer._renderbuffer.renderbuffer))}function p(e){var t=dr,n=null,i=null,r=e;"object"==typeof e&&(r=e.data,"target"in e&&(t=0|e.target)),ne.type(r,"function","invalid attachment data");var o=r._reglType;return"texture2d"===o?(n=r,ne(t===dr)):"textureCube"===o?(n=r,ne(t>=fr&&t<fr+6,"invalid cube map target")):"renderbuffer"===o?(i=r,t=hr):ne.raise("invalid regl object for attachment"),new h(t,n,i)}function m(e,t,n,i,s){if(n){var a=r.create2D({width:e,height:t,format:i,type:s});return a._texture.refCount=0,new h(dr,a,null)}var l=o.create({width:e,height:t,format:i});return l._renderbuffer.refCount=0,new h(hr,null,l)}function v(e){return e&&(e.texture||e.renderbuffer)}function y(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}n.oes_texture_half_float&&u.push("half float","float16"),n.oes_texture_float&&u.push("float","float32");var _=0,b={};function w(){this.id=_++,b[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function C(e){e.colorAttachments.forEach(d),d(e.depthAttachment),d(e.stencilAttachment),d(e.depthStencilAttachment)}function S(t){var n=t.framebuffer;ne(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,s.framebufferCount--,delete b[t.id]}function x(t){var n;e.bindFramebuffer(ur,t.framebuffer);var r=t.colorAttachments;for(n=0;n<r.length;++n)g(gr+n,r[n]);for(n=r.length;n<i.maxColorAttachments;++n)e.framebufferTexture2D(ur,gr+n,dr,null,0);e.framebufferTexture2D(ur,vr,dr,null,0),e.framebufferTexture2D(ur,pr,dr,null,0),e.framebufferTexture2D(ur,mr,dr,null,0),g(pr,t.depthAttachment),g(mr,t.stencilAttachment),g(vr,t.depthStencilAttachment);var o=e.checkFramebufferStatus(ur);e.isContextLost()||o===yr||ne.raise("framebuffer configuration not supported, status = "+Pr[o]),e.bindFramebuffer(ur,a.next?a.next.framebuffer:null),a.cur=a.next,e.getError()}function E(e,r){var o=new w;function h(e,t){var r;ne(a.next!==o,"can not update framebuffer which is currently in use");var s=0,d=0,g=!0,y=!0,_=null,b=!0,w="rgba",S="uint8",E=1,k=null,L=null,D=null,N=!1;if("number"==typeof e)s=0|e,d=0|t||s;else if(e){ne.type(e,"object","invalid arguments for framebuffer");var I=e;if("shape"in I){var T=I.shape;ne(Array.isArray(T)&&T.length>=2,"invalid shape for framebuffer"),s=T[0],d=T[1]}else"radius"in I&&(s=d=I.radius),"width"in I&&(s=I.width),"height"in I&&(d=I.height);("color"in I||"colors"in I)&&(_=I.color||I.colors,Array.isArray(_)&&ne(1===_.length||n.webgl_draw_buffers,"multiple render targets not supported")),_||("colorCount"in I&&(E=0|I.colorCount,ne(E>0,"invalid color buffer count")),"colorTexture"in I&&(b=!!I.colorTexture,w="rgba4"),"colorType"in I&&(S=I.colorType,b?(ne(n.oes_texture_float||!("float"===S||"float32"===S),"you must enable OES_texture_float in order to use floating point framebuffer objects"),ne(n.oes_texture_half_float||!("half float"===S||"float16"===S),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===S||"float16"===S?(ne(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),w="rgba16f"):"float"!==S&&"float32"!==S||(ne(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),w="rgba32f"),ne.oneOf(S,u,"invalid color type")),"colorFormat"in I&&(w=I.colorFormat,l.indexOf(w)>=0?b=!0:c.indexOf(w)>=0?b=!1:b?ne.oneOf(I.colorFormat,l,"invalid color format for texture"):ne.oneOf(I.colorFormat,c,"invalid color format for renderbuffer"))),("depthTexture"in I||"depthStencilTexture"in I)&&(N=!(!I.depthTexture&&!I.depthStencilTexture),ne(!N||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in I&&("boolean"==typeof I.depth?g=I.depth:(k=I.depth,y=!1)),"stencil"in I&&("boolean"==typeof I.stencil?y=I.stencil:(L=I.stencil,g=!1)),"depthStencil"in I&&("boolean"==typeof I.depthStencil?g=y=I.depthStencil:(D=I.depthStencil,g=!1,y=!1))}else s=d=1;var M=null,A=null,O=null,R=null;if(Array.isArray(_))M=_.map(p);else if(_)M=[p(_)];else for(M=new Array(E),r=0;r<E;++r)M[r]=m(s,d,b,w,S);ne(n.webgl_draw_buffers||M.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),ne(M.length<=i.maxColorAttachments,"too many color attachments, not supported"),s=s||M[0].width,d=d||M[0].height,k?A=p(k):g&&!y&&(A=m(s,d,N,"depth","uint32")),L?O=p(L):y&&!g&&(O=m(s,d,!1,"stencil","uint8")),D?R=p(D):!k&&!L&&y&&g&&(R=m(s,d,N,"depth stencil","depth stencil")),ne(!!k+!!L+!!D<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var P=null;for(r=0;r<M.length;++r)if(f(M[r],s,d),ne(!M[r]||M[r].texture&&Nr.indexOf(M[r].texture._texture.format)>=0||M[r].renderbuffer&&Rr.indexOf(M[r].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+r+" is invalid"),M[r]&&M[r].texture){var F=Ir[M[r].texture._texture.format]*Tr[M[r].texture._texture.type];null===P?P=F:ne(P===F,"all color attachments much have the same number of bits per pixel.")}return f(A,s,d),ne(!A||A.texture&&A.texture._texture.format===Dr||A.renderbuffer&&A.renderbuffer._renderbuffer.format===Mr,"invalid depth attachment for framebuffer object"),f(O,s,d),ne(!O||O.renderbuffer&&O.renderbuffer._renderbuffer.format===Ar,"invalid stencil attachment for framebuffer object"),f(R,s,d),ne(!R||R.texture&&R.texture._texture.format===Or||R.renderbuffer&&R.renderbuffer._renderbuffer.format===Or,"invalid depth-stencil attachment for framebuffer object"),C(o),o.width=s,o.height=d,o.colorAttachments=M,o.depthAttachment=A,o.stencilAttachment=O,o.depthStencilAttachment=R,h.color=M.map(v),h.depth=v(A),h.stencil=v(O),h.depthStencil=v(R),h.width=o.width,h.height=o.height,x(o),h}function d(e,t){ne(a.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|e,1),i=Math.max(0|t||n,1);if(n===o.width&&i===o.height)return h;for(var r=o.colorAttachments,s=0;s<r.length;++s)y(r[s],n,i);return y(o.depthAttachment,n,i),y(o.stencilAttachment,n,i),y(o.depthStencilAttachment,n,i),o.width=h.width=n,o.height=h.height=i,x(o),h}return s.framebufferCount++,h(e,r),t(h,{resize:d,_reglType:"framebuffer",_framebuffer:o,destroy:function(){S(o),C(o)},use:function(e){a.setFBO({framebuffer:h},e)}})}function k(e){var o=Array(6);function s(e){var i;ne(o.indexOf(a.next)<0,"can not update framebuffer which is currently in use");var c,h={color:null},d=0,f=null,g="rgba",p="uint8",m=1;if("number"==typeof e)d=0|e;else if(e){ne.type(e,"object","invalid arguments for framebuffer");var v=e;if("shape"in v){var y=v.shape;ne(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),ne(y[0]===y[1],"cube framebuffer must be square"),d=y[0]}else"radius"in v&&(d=0|v.radius),"width"in v?(d=0|v.width,"height"in v&&ne(v.height===d,"must be square")):"height"in v&&(d=0|v.height);("color"in v||"colors"in v)&&(f=v.color||v.colors,Array.isArray(f)&&ne(1===f.length||n.webgl_draw_buffers,"multiple render targets not supported")),f||("colorCount"in v&&(m=0|v.colorCount,ne(m>0,"invalid color buffer count")),"colorType"in v&&(ne.oneOf(v.colorType,u,"invalid color type"),p=v.colorType),"colorFormat"in v&&(g=v.colorFormat,ne.oneOf(v.colorFormat,l,"invalid color format for texture"))),"depth"in v&&(h.depth=v.depth),"stencil"in v&&(h.stencil=v.stencil),"depthStencil"in v&&(h.depthStencil=v.depthStencil)}else d=1;if(f)if(Array.isArray(f))for(c=[],i=0;i<f.length;++i)c[i]=f[i];else c=[f];else{c=Array(m);var _={radius:d,format:g,type:p};for(i=0;i<m;++i)c[i]=r.createCube(_)}for(h.color=Array(c.length),i=0;i<c.length;++i){var b=c[i];ne("function"==typeof b&&"textureCube"===b._reglType,"invalid cube map"),d=d||b.width,ne(b.width===d&&b.height===d,"invalid cube map shape"),h.color[i]={target:fr,data:c[i]}}for(i=0;i<6;++i){for(var w=0;w<c.length;++w)h.color[w].target=fr+i;i>0&&(h.depth=o[0].depth,h.stencil=o[0].stencil,h.depthStencil=o[0].depthStencil),o[i]?o[i](h):o[i]=E(h)}return t(s,{width:d,height:d,color:c})}function c(e){var t,n=0|e;if(ne(n>0&&n<=i.maxCubeMapSize,"invalid radius for cube fbo"),n===s.width)return s;var r=s.color;for(t=0;t<r.length;++t)r[t].resize(n);for(t=0;t<6;++t)o[t].resize(n);return s.width=s.height=n,s}return s(e),t(s,{faces:o,resize:c,_reglType:"framebufferCube",destroy:function(){o.forEach((function(e){e.destroy()}))}})}function L(){a.cur=null,a.next=null,a.dirty=!0,xt(b).forEach((function(t){t.framebuffer=e.createFramebuffer(),x(t)}))}return t(a,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof w)return t}return null},create:E,createCube:k,clear:function(){xt(b).forEach(S)},restore:L})}Pr[yr]="complete",Pr[_r]="incomplete attachment",Pr[wr]="incomplete dimensions",Pr[br]="incomplete, missing attachment",Pr[Cr]="unsupported";var Br=5126,Wr=34962;function zr(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Br,this.offset=0,this.stride=0,this.divisor=0}function Vr(t,n,i,r,o){for(var s=i.maxAttributes,a=new Array(s),l=0;l<s;++l)a[l]=new zr;var c=0,u={},h={Record:zr,scope:{},state:a,currentVAO:null,targetVAO:null,restore:f()?b:function(){},createVAO:w,getVAO:p,destroyBuffer:d,setVAO:f()?m:v,clear:f()?y:function(){}};function d(e){for(var n=0;n<a.length;++n){var i=a[n];i.buffer===e&&(t.disableVertexAttribArray(n),i.buffer=null)}}function f(){return n.oes_vertex_array_object}function g(){return n.angle_instanced_arrays}function p(e){return"function"==typeof e&&e._vao?e._vao:null}function m(e){if(e!==h.currentVAO){var t=f();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),h.currentVAO=e}}function v(e){if(e!==h.currentVAO){if(e)e.bindAttrs();else for(var n=g(),i=0;i<a.length;++i){var r=a[i];r.buffer?(t.enableVertexAttribArray(i),t.vertexAttribPointer(i,r.size,r.type,r.normalized,r.stride,r.offfset),n&&r.divisor&&n.vertexAttribDivisorANGLE(i,r.divisor)):(t.disableVertexAttribArray(i),t.vertexAttrib4f(i,r.x,r.y,r.z,r.w))}h.currentVAO=e}}function y(){xt(u).forEach((function(e){e.destroy()}))}function _(){this.id=++c,this.attributes=[];var e=f();this.vao=e?e.createVertexArrayOES():null,u[this.id]=this,this.buffers=[]}function b(){f()&&xt(u).forEach((function(e){e.refresh()}))}function w(t){var i=new _;function a(t){ne(Array.isArray(t),"arguments to vertex array constructor must be an array"),ne(t.length<s,"too many attributes"),ne(t.length>0,"must specify at least one attribute");var r={},l=i.attributes;l.length=t.length;for(var c=0;c<t.length;++c){var u,h=t[c],d=l[c]=new zr,f=h.data||h;Array.isArray(f)||e(f)||St(f)?(i.buffers[c]&&(u=i.buffers[c],e(f)&&u._buffer.byteLength>=f.byteLength?u.subdata(f):(u.destroy(),i.buffers[c]=null)),i.buffers[c]||(u=i.buffers[c]=o.create(h,Wr,!1,!0)),d.buffer=o.getBuffer(u),d.size=0|d.buffer.dimension,d.normalized=!1,d.type=d.buffer.dtype,d.offset=0,d.stride=0,d.divisor=0,d.state=1,r[c]=1):o.getBuffer(h)?(d.buffer=o.getBuffer(h),d.size=0|d.buffer.dimension,d.normalized=!1,d.type=d.buffer.dtype,d.offset=0,d.stride=0,d.divisor=0,d.state=1):o.getBuffer(h.buffer)?(d.buffer=o.getBuffer(h.buffer),d.size=0|(+h.size||d.buffer.dimension),d.normalized=!!h.normalized||!1,"type"in h?(ne.parameter(h.type,At,"invalid buffer type"),d.type=At[h.type]):d.type=d.buffer.dtype,d.offset=0|(h.offset||0),d.stride=0|(h.stride||0),d.divisor=0|(h.divisor||0),d.state=1,ne(d.size>=1&&d.size<=4,"size must be between 1 and 4"),ne(d.offset>=0,"invalid offset"),ne(d.stride>=0&&d.stride<=255,"stride must be between 0 and 255"),ne(d.divisor>=0,"divisor must be positive"),ne(!d.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in h?(ne(c>0,"first attribute must not be a constant"),d.x=+h.x||0,d.y=+h.y||0,d.z=+h.z||0,d.w=+h.w||0,d.state=2):ne(!1,"invalid attribute spec for location "+c)}for(var g=0;g<i.buffers.length;++g)!r[g]&&i.buffers[g]&&(i.buffers[g].destroy(),i.buffers[g]=null);return i.refresh(),a}return r.vaoCount+=1,a.destroy=function(){for(var e=0;e<i.buffers.length;++e)i.buffers[e]&&i.buffers[e].destroy();i.buffers.length=0,i.destroy()},a._vao=i,a._reglType="vao",a(t)}return _.prototype.bindAttrs=function(){for(var e=g(),n=this.attributes,i=0;i<n.length;++i){var r=n[i];r.buffer?(t.enableVertexAttribArray(i),t.bindBuffer(Wr,r.buffer.buffer),t.vertexAttribPointer(i,r.size,r.type,r.normalized,r.stride,r.offset),e&&r.divisor&&e.vertexAttribDivisorANGLE(i,r.divisor)):(t.disableVertexAttribArray(i),t.vertexAttrib4f(i,r.x,r.y,r.z,r.w))}for(var o=n.length;o<s;++o)t.disableVertexAttribArray(o)},_.prototype.refresh=function(){var e=f();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),h.currentVAO=this)},_.prototype.destroy=function(){if(this.vao){var e=f();this===h.currentVAO&&(h.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}u[this.id]&&(delete u[this.id],r.vaoCount-=1)},h}var Ur=35632,Hr=35633,jr=35718,Gr=35721;function Kr(e,n,i,r){var o={},s={};function a(e,t,n,i){this.name=e,this.id=t,this.location=n,this.info=i}function l(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function c(t,i,r){var a=t===Ur?o:s,l=a[i];if(!l){var c=n.str(i);l=e.createShader(t),e.shaderSource(l,c),e.compileShader(l),ne.shaderError(e,l,c,t,r),a[i]=l}return l}var u={},h=[],d=0;function f(e,t){this.id=d++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function g(t,i,o){var s,u,h=c(Ur,t.fragId),d=c(Hr,t.vertId),f=t.program=e.createProgram();if(e.attachShader(f,h),e.attachShader(f,d),o)for(s=0;s<o.length;++s){var g=o[s];e.bindAttribLocation(f,g[0],g[1])}e.linkProgram(f),ne.linkError(e,f,n.str(t.fragId),n.str(t.vertId),i);var p=e.getProgramParameter(f,jr);r.profile&&(t.stats.uniformsCount=p);var m=t.uniforms;for(s=0;s<p;++s)if(u=e.getActiveUniform(f,s))if(u.size>1)for(var v=0;v<u.size;++v){var y=u.name.replace("[0]","["+v+"]");l(m,new a(y,n.id(y),e.getUniformLocation(f,y),u))}else l(m,new a(u.name,n.id(u.name),e.getUniformLocation(f,u.name),u));var _=e.getProgramParameter(f,Gr);r.profile&&(t.stats.attributesCount=_);var b=t.attributes;for(s=0;s<_;++s)(u=e.getActiveAttrib(f,s))&&l(b,new a(u.name,n.id(u.name),e.getAttribLocation(f,u.name),u))}function p(){o={},s={};for(var e=0;e<h.length;++e)g(h[e],null,h[e].attributes.map((function(e){return[e.location,e.name]})))}return r.profile&&(i.getMaxUniformsCount=function(){var e=0;return h.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},i.getMaxAttributesCount=function(){var e=0;return h.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var t=e.deleteShader.bind(e);xt(o).forEach(t),o={},xt(s).forEach(t),s={},h.forEach((function(t){e.deleteProgram(t.program)})),h.length=0,u={},i.shaderCount=0},program:function(n,r,a,l){ne.command(n>=0,"missing vertex shader",a),ne.command(r>=0,"missing fragment shader",a);var c=u[r];c||(c=u[r]={});var d=c[n];if(d&&(d.refCount++,!l))return d;var p=new f(r,n);return i.shaderCount++,g(p,a,l),d||(c[n]=p),h.push(p),t(p,{destroy:function(){if(p.refCount--,p.refCount<=0){e.deleteProgram(p.program);var t=h.indexOf(p);h.splice(t,1),i.shaderCount--}c[p.vertId].refCount<=0&&(e.deleteShader(s[p.vertId]),delete s[p.vertId],delete u[p.fragId][p.vertId]),Object.keys(u[p.fragId]).length||(e.deleteShader(o[p.fragId]),delete o[p.fragId],delete u[p.fragId])}})},restore:p,shader:c,frag:-1,vert:-1}}var qr=6408,$r=5121,Yr=3333,Xr=5126;function Zr(t,n,i,r,o,s,a){function l(l){var c;null===n.next?(ne(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=$r):(ne(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,s.oes_texture_float?(ne(c===$r||c===Xr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===Xr&&ne(a.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):ne(c===$r,"Reading from a framebuffer is only allowed for the type 'uint8'"));var u=0,h=0,d=r.framebufferWidth,f=r.framebufferHeight,g=null;e(l)?g=l:l&&(ne.type(l,"object","invalid arguments to regl.read()"),u=0|l.x,h=0|l.y,ne(u>=0&&u<r.framebufferWidth,"invalid x offset for regl.read"),ne(h>=0&&h<r.framebufferHeight,"invalid y offset for regl.read"),d=0|(l.width||r.framebufferWidth-u),f=0|(l.height||r.framebufferHeight-h),g=l.data||null),g&&(c===$r?ne(g instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===Xr&&ne(g instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),ne(d>0&&d+u<=r.framebufferWidth,"invalid width for read pixels"),ne(f>0&&f+h<=r.framebufferHeight,"invalid height for read pixels"),i();var p=d*f*4;return g||(c===$r?g=new Uint8Array(p):c===Xr&&(g=g||new Float32Array(p))),ne.isTypedArray(g,"data buffer for regl.read() must be a typedarray"),ne(g.byteLength>=p,"data buffer for regl.read() too small"),t.pixelStorei(Yr,4),t.readPixels(u,h,d,f,qr,c,g),g}function c(e){var t;return n.setFBO({framebuffer:e.framebuffer},(function(){t=l(e)})),t}function u(e){return e&&"framebuffer"in e?c(e):l(e)}return u}function Qr(e){return Array.prototype.slice.call(e)}function Jr(e){return Qr(e).join("")}function eo(){var e=0,n=[],i=[];function r(t){for(var r=0;r<i.length;++r)if(i[r]===t)return n[r];var o="g"+e++;return n.push(o),i.push(t),o}function o(){var n=[];function i(){n.push.apply(n,Qr(arguments))}var r=[];function o(){var t="v"+e++;return r.push(t),arguments.length>0&&(n.push(t,"="),n.push.apply(n,Qr(arguments)),n.push(";")),t}return t(i,{def:o,toString:function(){return Jr([r.length>0?"var "+r.join(",")+";":"",Jr(n)])}})}function s(){var e=o(),n=o(),i=e.toString,r=n.toString;function s(t,i){n(t,i,"=",e.def(t,i),";")}return t((function(){e.apply(e,Qr(arguments))}),{def:e.def,entry:e,exit:n,save:s,set:function(t,n,i){s(t,n),e(t,n,"=",i,";")},toString:function(){return i()+r()}})}function a(){var e=Jr(arguments),n=s(),i=s(),r=n.toString,o=i.toString;return t(n,{then:function(){return n.apply(n,Qr(arguments)),this},else:function(){return i.apply(i,Qr(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),Jr(["if(",e,"){",r(),"}",t])}})}var l=o(),c={};function u(e,n){var i=[];function r(){var e="a"+i.length;return i.push(e),e}n=n||0;for(var o=0;o<n;++o)r();var a=s(),l=a.toString;return c[e]=t(a,{arg:r,toString:function(){return Jr(["function(",i.join(),"){",l(),"}"])}})}function h(){var e=['"use strict";',l,"return {"];Object.keys(c).forEach((function(t){e.push('"',t,'":',c[t].toString(),",")})),e.push("}");var t=Jr(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(t)).apply(null,i)}return{global:l,link:r,block:o,proc:u,scope:s,cond:a,compile:h}}var to="xyzw".split(""),no=5121,io=1,ro=2,oo=0,so=1,ao=2,lo=3,co=4,uo=5,ho=6,fo="dither",go="blend.enable",po="blend.color",mo="blend.equation",vo="blend.func",yo="depth.enable",_o="depth.func",bo="depth.range",wo="depth.mask",Co="colorMask",So="cull.enable",xo="cull.face",Eo="frontFace",ko="lineWidth",Lo="polygonOffset.enable",Do="polygonOffset.offset",No="sample.alpha",Io="sample.enable",To="sample.coverage",Mo="stencil.enable",Ao="stencil.mask",Oo="stencil.func",Ro="stencil.opFront",Po="stencil.opBack",Fo="scissor.enable",Bo="scissor.box",Wo="viewport",zo="profile",Vo="framebuffer",Uo="vert",Ho="frag",jo="elements",Go="primitive",Ko="count",qo="offset",$o="instances",Yo="vao",Xo="Width",Zo="Height",Qo=Vo+Xo,Jo=Vo+Zo,es=Wo+Xo,ts=Wo+Zo,ns="drawingBuffer",is=ns+Xo,rs=ns+Zo,os=[vo,mo,Oo,Ro,Po,To,Wo,Bo,Do],ss=34962,as=34963,ls=3553,cs=34067,us=2884,hs=3042,ds=3024,fs=2960,gs=2929,ps=3089,ms=32823,vs=32926,ys=32928,_s=5126,bs=35664,ws=35665,Cs=35666,Ss=5124,xs=35667,Es=35668,ks=35669,Ls=35670,Ds=35671,Ns=35672,Is=35673,Ts=35674,Ms=35675,As=35676,Os=35678,Rs=35680,Ps=4,Fs=1028,Bs=1029,Ws=2304,zs=2305,Vs=32775,Us=32776,Hs=519,js=7680,Gs=0,Ks=1,qs=32774,$s=513,Ys=36160,Xs=36064,Zs={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Qs=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Js={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ea={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ta={frag:35632,vert:35633},na={cw:Ws,ccw:zs};function ia(t){return Array.isArray(t)||e(t)||St(t)}function ra(e){return e.sort((function(e,t){return e===Wo?-1:t===Wo?1:e<t?-1:1}))}function oa(e,t,n,i){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=i}function sa(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function aa(e){return new oa(!1,!1,!1,e)}function la(e,t){var n=e.type;if(n===oo){var i=e.data.length;return new oa(!0,i>=1,i>=2,t)}if(n===co){var r=e.data;return new oa(r.thisDep,r.contextDep,r.propDep,t)}if(n===uo)return new oa(!1,!1,!1,t);if(n===ho){for(var o=!1,s=!1,a=!1,l=0;l<e.data.length;++l){var c=e.data[l];if(c.type===so)a=!0;else if(c.type===ao)s=!0;else if(c.type===lo)o=!0;else if(c.type===oo){o=!0;var u=c.data;u>=1&&(s=!0),u>=2&&(a=!0)}else c.type===co&&(o=o||c.data.thisDep,s=s||c.data.contextDep,a=a||c.data.propDep)}return new oa(o,s,a,t)}return new oa(n===lo,n===ao,n===so,t)}var ca=new oa(!1,!1,!1,(function(){}));function ua(e,n,i,r,o,s,a,l,c,u,h,d,f,g,p){var m=u.Record,v={add:32774,subtract:32778,"reverse subtract":32779};i.ext_blend_minmax&&(v.min=Vs,v.max=Us);var y=i.angle_instanced_arrays,_=i.webgl_draw_buffers,b={dirty:!0,profile:p.profile},w={},C=[],S={},x={};function E(e){return e.replace(".","_")}function k(e,t,n){var i=E(e);C.push(e),w[i]=b[i]=!!n,S[i]=t}function L(e,t,n){var i=E(e);C.push(e),Array.isArray(n)?(b[i]=n.slice(),w[i]=n.slice()):b[i]=w[i]=n,x[i]=t}k(fo,ds),k(go,hs),L(po,"blendColor",[0,0,0,0]),L(mo,"blendEquationSeparate",[qs,qs]),L(vo,"blendFuncSeparate",[Ks,Gs,Ks,Gs]),k(yo,gs,!0),L(_o,"depthFunc",$s),L(bo,"depthRange",[0,1]),L(wo,"depthMask",!0),L(Co,Co,[!0,!0,!0,!0]),k(So,us),L(xo,"cullFace",Bs),L(Eo,Eo,zs),L(ko,ko,1),k(Lo,ms),L(Do,"polygonOffset",[0,0]),k(No,vs),k(Io,ys),L(To,"sampleCoverage",[1,!1]),k(Mo,fs),L(Ao,"stencilMask",-1),L(Oo,"stencilFunc",[Hs,0,-1]),L(Ro,"stencilOpSeparate",[Fs,js,js,js]),L(Po,"stencilOpSeparate",[Bs,js,js,js]),k(Fo,ps),L(Bo,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),L(Wo,Wo,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var D={gl:e,context:f,strings:n,next:w,current:b,draw:d,elements:s,buffer:o,shader:h,attributes:u.state,vao:u,uniforms:c,framebuffer:l,extensions:i,timer:g,isBufferArgs:ia},N={primTypes:Kt,compareFuncs:Js,blendFuncs:Zs,blendEquations:v,stencilOps:ea,glTypes:At,orientationType:na};ne.optional((function(){D.isArrayLike=hn})),_&&(N.backBuffer=[Bs],N.drawBuffer=ke(r.maxDrawbuffers,(function(e){return 0===e?[0]:ke(e,(function(e){return Xs+e}))})));var I=0;function T(){var e=eo(),t=e.link,i=e.global;e.id=I++,e.batchId="0";var r=t(D),o=e.shared={props:"a0"};Object.keys(D).forEach((function(e){o[e]=i.def(r,".",e)})),ne.optional((function(){e.CHECK=t(ne),e.commandStr=ne.guessCommand(),e.command=t(e.commandStr),e.assert=function(e,n,i){e("if(!(",n,"))",this.CHECK,".commandRaise(",t(i),",",this.command,");")},N.invalidBlendCombinations=Qs}));var s=e.next={},a=e.current={};Object.keys(x).forEach((function(e){Array.isArray(b[e])&&(s[e]=i.def(o.next,".",e),a[e]=i.def(o.current,".",e))}));var l=e.constants={};Object.keys(N).forEach((function(e){l[e]=i.def(JSON.stringify(N[e]))})),e.invoke=function(n,i){switch(i.type){case oo:var r=["this",o.context,o.props,e.batchId];return n.def(t(i.data),".call(",r.slice(0,Math.max(i.data.length+1,4)),")");case so:return n.def(o.props,i.data);case ao:return n.def(o.context,i.data);case lo:return n.def("this",i.data);case co:return i.data.append(e,n),i.data.ref;case uo:return i.data.toString();case ho:return i.data.map((function(t){return e.invoke(n,t)}))}},e.attribCache={};var c={};return e.scopeAttrib=function(e){var i=n.id(e);if(i in c)return c[i];var r=u.scope[i];return r||(r=u.scope[i]=new m),c[i]=t(r)},e}function M(e){var t,n=e.static,i=e.dynamic;if(zo in n){var r=!!n[zo];(t=aa((function(e,t){return r}))).enable=r}else if(zo in i){var o=i[zo];t=la(o,(function(e,t){return e.invoke(t,o)}))}return t}function A(e,t){var n=e.static,i=e.dynamic;if(Vo in n){var r=n[Vo];return r?(r=l.getFramebuffer(r),ne.command(r,"invalid framebuffer object"),aa((function(e,t){var n=e.link(r),i=e.shared;t.set(i.framebuffer,".next",n);var o=i.context;return t.set(o,"."+Qo,n+".width"),t.set(o,"."+Jo,n+".height"),n}))):aa((function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var i=n.context;return t.set(i,"."+Qo,i+"."+is),t.set(i,"."+Jo,i+"."+rs),"null"}))}if(Vo in i){var o=i[Vo];return la(o,(function(e,t){var n=e.invoke(t,o),i=e.shared,r=i.framebuffer,s=t.def(r,".getFramebuffer(",n,")");ne.optional((function(){e.assert(t,"!"+n+"||"+s,"invalid framebuffer object")})),t.set(r,".next",s);var a=i.context;return t.set(a,"."+Qo,s+"?"+s+".width:"+a+"."+is),t.set(a,"."+Jo,s+"?"+s+".height:"+a+"."+rs),s}))}return null}function O(e,t,n){var i=e.static,r=e.dynamic;function o(e){if(e in i){var o=i[e];ne.commandType(o,"object","invalid "+e,n.commandStr);var s,a,l=!0,c=0|o.x,u=0|o.y;return"width"in o?(s=0|o.width,ne.command(s>=0,"invalid "+e,n.commandStr)):l=!1,"height"in o?(a=0|o.height,ne.command(a>=0,"invalid "+e,n.commandStr)):l=!1,new oa(!l&&t&&t.thisDep,!l&&t&&t.contextDep,!l&&t&&t.propDep,(function(e,t){var n=e.shared.context,i=s;"width"in o||(i=t.def(n,".",Qo,"-",c));var r=a;return"height"in o||(r=t.def(n,".",Jo,"-",u)),[c,u,i,r]}))}if(e in r){var h=r[e],d=la(h,(function(t,n){var i=t.invoke(n,h);ne.optional((function(){t.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+e)}));var r=t.shared.context,o=n.def(i,".x|0"),s=n.def(i,".y|0"),a=n.def('"width" in ',i,"?",i,".width|0:","(",r,".",Qo,"-",o,")"),l=n.def('"height" in ',i,"?",i,".height|0:","(",r,".",Jo,"-",s,")");return ne.optional((function(){t.assert(n,a+">=0&&"+l+">=0","invalid "+e)})),[o,s,a,l]}));return t&&(d.thisDep=d.thisDep||t.thisDep,d.contextDep=d.contextDep||t.contextDep,d.propDep=d.propDep||t.propDep),d}return t?new oa(t.thisDep,t.contextDep,t.propDep,(function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",Qo),t.def(n,".",Jo)]})):null}var s=o(Wo);if(s){var a=s;s=new oa(s.thisDep,s.contextDep,s.propDep,(function(e,t){var n=a.append(e,t),i=e.shared.context;return t.set(i,"."+es,n[2]),t.set(i,"."+ts,n[3]),n}))}return{viewport:s,scissor_box:o(Bo)}}function R(e,t){var n=e.static;if("string"==typeof n[Ho]&&"string"==typeof n[Uo]){if(Object.keys(t.dynamic).length>0)return null;var i=t.static,r=Object.keys(i);if(r.length>0&&"number"==typeof i[r[0]]){for(var o=[],s=0;s<r.length;++s)ne("number"==typeof i[r[s]],"must specify all vertex attribute locations when using vaos"),o.push([0|i[r[s]],r[s]]);return o}}return null}function P(e,t,i){var r=e.static,o=e.dynamic;function s(e){if(e in r){var t=n.id(r[e]);ne.optional((function(){h.shader(ta[e],t,ne.guessCommand())}));var i=aa((function(){return t}));return i.id=t,i}if(e in o){var s=o[e];return la(s,(function(t,n){var i=t.invoke(n,s),r=n.def(t.shared.strings,".id(",i,")");return ne.optional((function(){n(t.shared.shader,".shader(",ta[e],",",r,",",t.command,");")})),r}))}return null}var a,l=s(Ho),c=s(Uo),u=null;return sa(l)&&sa(c)?(u=h.program(c.id,l.id,null,i),a=aa((function(e,t){return e.link(u)}))):a=new oa(l&&l.thisDep||c&&c.thisDep,l&&l.contextDep||c&&c.contextDep,l&&l.propDep||c&&c.propDep,(function(e,t){var n,i=e.shared.shader;n=l?l.append(e,t):t.def(i,".",Ho);var r=i+".program("+(c?c.append(e,t):t.def(i,".",Uo))+","+n;return ne.optional((function(){r+=","+e.command})),t.def(r+")")})),{frag:l,vert:c,progVar:a,program:u}}function F(e,t){var n=e.static,i=e.dynamic;function r(){if(jo in n){var e=n[jo];ia(e)?e=s.getElements(s.create(e,!0)):e&&(e=s.getElements(e),ne.command(e,"invalid elements",t.commandStr));var r=aa((function(t,n){if(e){var i=t.link(e);return t.ELEMENTS=i,i}return t.ELEMENTS=null,null}));return r.value=e,r}if(jo in i){var o=i[jo];return la(o,(function(e,t){var n=e.shared,i=n.isBufferArgs,r=n.elements,s=e.invoke(t,o),a=t.def("null"),l=t.def(i,"(",s,")"),c=e.cond(l).then(a,"=",r,".createStream(",s,");").else(a,"=",r,".getElements(",s,");");return ne.optional((function(){e.assert(c.else,"!"+s+"||"+a,"invalid elements")})),t.entry(c),t.exit(e.cond(l).then(r,".destroyStream(",a,");")),e.ELEMENTS=a,a}))}return null}var o=r();function a(){if(Go in n){var e=n[Go];return ne.commandParameter(e,Kt,"invalid primitve",t.commandStr),aa((function(t,n){return Kt[e]}))}if(Go in i){var r=i[Go];return la(r,(function(e,t){var n=e.constants.primTypes,i=e.invoke(t,r);return ne.optional((function(){e.assert(t,i+" in "+n,"invalid primitive, must be one of "+Object.keys(Kt))})),t.def(n,"[",i,"]")}))}return o?sa(o)?o.value?aa((function(e,t){return t.def(e.ELEMENTS,".primType")})):aa((function(){return Ps})):new oa(o.thisDep,o.contextDep,o.propDep,(function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",Ps)})):null}function l(e,r){if(e in n){var s=0|n[e];return ne.command(!r||s>=0,"invalid "+e,t.commandStr),aa((function(e,t){return r&&(e.OFFSET=s),s}))}if(e in i){var a=i[e];return la(a,(function(t,n){var i=t.invoke(n,a);return r&&(t.OFFSET=i,ne.optional((function(){t.assert(n,i+">=0","invalid "+e)}))),i}))}return r&&o?aa((function(e,t){return e.OFFSET="0",0})):null}var c=l(qo,!0);function u(){if(Ko in n){var e=0|n[Ko];return ne.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),aa((function(){return e}))}if(Ko in i){var r=i[Ko];return la(r,(function(e,t){var n=e.invoke(t,r);return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(o){if(sa(o)){if(o)return c?new oa(c.thisDep,c.contextDep,c.propDep,(function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return ne.optional((function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")})),n})):aa((function(e,t){return t.def(e.ELEMENTS,".vertCount")}));var s=aa((function(){return-1}));return ne.optional((function(){s.MISSING=!0})),s}var a=new oa(o.thisDep||c.thisDep,o.contextDep||c.contextDep,o.propDep||c.propDep,(function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}));return ne.optional((function(){a.DYNAMIC=!0})),a}return null}return{elements:o,primitive:a(),count:u(),instances:l($o,!1),offset:c}}function B(e,t){var n=e.static,i=e.dynamic,o={};return C.forEach((function(e){var s=E(e);function a(t,r){if(e in n){var a=t(n[e]);o[s]=aa((function(){return a}))}else if(e in i){var l=i[e];o[s]=la(l,(function(e,t){return r(e,t,e.invoke(t,l))}))}}switch(e){case So:case go:case fo:case Mo:case yo:case Fo:case Lo:case No:case Io:case wo:return a((function(n){return ne.commandType(n,"boolean",e,t.commandStr),n}),(function(t,n,i){return ne.optional((function(){t.assert(n,"typeof "+i+'==="boolean"',"invalid flag "+e,t.commandStr)})),i}));case _o:return a((function(n){return ne.commandParameter(n,Js,"invalid "+e,t.commandStr),Js[n]}),(function(t,n,i){var r=t.constants.compareFuncs;return ne.optional((function(){t.assert(n,i+" in "+r,"invalid "+e+", must be one of "+Object.keys(Js))})),n.def(r,"[",i,"]")}));case bo:return a((function(e){return ne.command(hn(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e}),(function(e,t,n){return ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]}));case vo:return a((function(e){ne.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,i="srcAlpha"in e?e.srcAlpha:e.src,r="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return ne.commandParameter(n,Zs,s+".srcRGB",t.commandStr),ne.commandParameter(i,Zs,s+".srcAlpha",t.commandStr),ne.commandParameter(r,Zs,s+".dstRGB",t.commandStr),ne.commandParameter(o,Zs,s+".dstAlpha",t.commandStr),ne.command(-1===Qs.indexOf(n+", "+r),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+r+")",t.commandStr),[Zs[n],Zs[r],Zs[i],Zs[o]]}),(function(t,n,i){var r=t.constants.blendFuncs;function o(o,s){var a=n.def('"',o,s,'" in ',i,"?",i,".",o,s,":",i,".",o);return ne.optional((function(){t.assert(n,a+" in "+r,"invalid "+e+"."+o+s+", must be one of "+Object.keys(Zs))})),a}ne.optional((function(){t.assert(n,i+"&&typeof "+i+'==="object"',"invalid blend func, must be an object")}));var s=o("src","RGB"),a=o("dst","RGB");ne.optional((function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+s+'+", "+'+a+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var l=n.def(r,"[",s,"]"),c=n.def(r,"[",o("src","Alpha"),"]");return[l,n.def(r,"[",a,"]"),c,n.def(r,"[",o("dst","Alpha"),"]")]}));case mo:return a((function(n){return"string"==typeof n?(ne.commandParameter(n,v,"invalid "+e,t.commandStr),[v[n],v[n]]):"object"==typeof n?(ne.commandParameter(n.rgb,v,e+".rgb",t.commandStr),ne.commandParameter(n.alpha,v,e+".alpha",t.commandStr),[v[n.rgb],v[n.alpha]]):void ne.commandRaise("invalid blend.equation",t.commandStr)}),(function(t,n,i){var r=t.constants.blendEquations,o=n.def(),s=n.def(),a=t.cond("typeof ",i,'==="string"');return ne.optional((function(){function n(e,n,i){t.assert(e,i+" in "+r,"invalid "+n+", must be one of "+Object.keys(v))}n(a.then,e,i),t.assert(a.else,i+"&&typeof "+i+'==="object"',"invalid "+e),n(a.else,e+".rgb",i+".rgb"),n(a.else,e+".alpha",i+".alpha")})),a.then(o,"=",s,"=",r,"[",i,"];"),a.else(o,"=",r,"[",i,".rgb];",s,"=",r,"[",i,".alpha];"),n(a),[o,s]}));case po:return a((function(e){return ne.command(hn(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),ke(4,(function(t){return+e[t]}))}),(function(e,t,n){return ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),ke(4,(function(e){return t.def("+",n,"[",e,"]")}))}));case Ao:return a((function(e){return ne.commandType(e,"number",s,t.commandStr),0|e}),(function(e,t,n){return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")})),t.def(n,"|0")}));case Oo:return a((function(n){ne.commandType(n,"object",s,t.commandStr);var i=n.cmp||"keep",r=n.ref||0,o="mask"in n?n.mask:-1;return ne.commandParameter(i,Js,e+".cmp",t.commandStr),ne.commandType(r,"number",e+".ref",t.commandStr),ne.commandType(o,"number",e+".mask",t.commandStr),[Js[i],r,o]}),(function(e,t,n){var i=e.constants.compareFuncs;return ne.optional((function(){function r(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}r(n+"&&typeof ",n,'==="object"'),r('!("cmp" in ',n,")||(",n,".cmp in ",i,")")})),[t.def('"cmp" in ',n,"?",i,"[",n,".cmp]",":",js),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case Ro:case Po:return a((function(n){ne.commandType(n,"object",s,t.commandStr);var i=n.fail||"keep",r=n.zfail||"keep",o=n.zpass||"keep";return ne.commandParameter(i,ea,e+".fail",t.commandStr),ne.commandParameter(r,ea,e+".zfail",t.commandStr),ne.commandParameter(o,ea,e+".zpass",t.commandStr),[e===Po?Bs:Fs,ea[i],ea[r],ea[o]]}),(function(t,n,i){var r=t.constants.stencilOps;function o(o){return ne.optional((function(){t.assert(n,'!("'+o+'" in '+i+")||("+i+"."+o+" in "+r+")","invalid "+e+"."+o+", must be one of "+Object.keys(ea))})),n.def('"',o,'" in ',i,"?",r,"[",i,".",o,"]:",js)}return ne.optional((function(){t.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+e)})),[e===Po?Bs:Fs,o("fail"),o("zfail"),o("zpass")]}));case Do:return a((function(e){ne.commandType(e,"object",s,t.commandStr);var n=0|e.factor,i=0|e.units;return ne.commandType(n,"number",s+".factor",t.commandStr),ne.commandType(i,"number",s+".units",t.commandStr),[n,i]}),(function(t,n,i){return ne.optional((function(){t.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+e)})),[n.def(i,".factor|0"),n.def(i,".units|0")]}));case xo:return a((function(e){var n=0;return"front"===e?n=Fs:"back"===e&&(n=Bs),ne.command(!!n,s,t.commandStr),n}),(function(e,t,n){return ne.optional((function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),t.def(n,'==="front"?',Fs,":",Bs)}));case ko:return a((function(e){return ne.command("number"==typeof e&&e>=r.lineWidthDims[0]&&e<=r.lineWidthDims[1],"invalid line width, must be a positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],t.commandStr),e}),(function(e,t,n){return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")})),n}));case Eo:return a((function(e){return ne.commandParameter(e,na,s,t.commandStr),na[e]}),(function(e,t,n){return ne.optional((function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),t.def(n+'==="cw"?'+Ws+":"+zs)}));case Co:return a((function(e){return ne.command(hn(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map((function(e){return!!e}))}),(function(e,t,n){return ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),ke(4,(function(e){return"!!"+n+"["+e+"]"}))}));case To:return a((function(e){ne.command("object"==typeof e&&e,s,t.commandStr);var n="value"in e?e.value:1,i=!!e.invert;return ne.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,i]}),(function(e,t,n){return ne.optional((function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]}))}})),o}function W(e,t){var n=e.static,i=e.dynamic,r={};return Object.keys(n).forEach((function(e){var i,o=n[e];if("number"==typeof o||"boolean"==typeof o)i=aa((function(){return o}));else if("function"==typeof o){var s=o._reglType;"texture2d"===s||"textureCube"===s?i=aa((function(e){return e.link(o)})):"framebuffer"===s||"framebufferCube"===s?(ne.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),i=aa((function(e){return e.link(o.color[0])}))):ne.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else hn(o)?i=aa((function(t){return t.global.def("[",ke(o.length,(function(n){return ne.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+e,t.commandStr),o[n]})),"]")})):ne.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);i.value=o,r[e]=i})),Object.keys(i).forEach((function(e){var t=i[e];r[e]=la(t,(function(e,n){return e.invoke(n,t)}))})),r}function z(e,t){var i=e.static,r=e.dynamic,s={};return Object.keys(i).forEach((function(e){var r=i[e],a=n.id(e),l=new m;if(ia(r))l.state=io,l.buffer=o.getBuffer(o.create(r,ss,!1,!0)),l.type=0;else{var c=o.getBuffer(r);if(c)l.state=io,l.buffer=c,l.type=0;else if(ne.command("object"==typeof r&&r,"invalid data for attribute "+e,t.commandStr),"constant"in r){var u=r.constant;l.buffer="null",l.state=ro,"number"==typeof u?l.x=u:(ne.command(hn(u)&&u.length>0&&u.length<=4,"invalid constant for attribute "+e,t.commandStr),to.forEach((function(e,t){t<u.length&&(l[e]=u[t])})))}else{c=ia(r.buffer)?o.getBuffer(o.create(r.buffer,ss,!1,!0)):o.getBuffer(r.buffer),ne.command(!!c,'missing buffer for attribute "'+e+'"',t.commandStr);var h=0|r.offset;ne.command(h>=0,'invalid offset for attribute "'+e+'"',t.commandStr);var d=0|r.stride;ne.command(d>=0&&d<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',t.commandStr);var f=0|r.size;ne.command(!("size"in r)||f>0&&f<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',t.commandStr);var g=!!r.normalized,p=0;"type"in r&&(ne.commandParameter(r.type,At,"invalid type for attribute "+e,t.commandStr),p=At[r.type]);var v=0|r.divisor;"divisor"in r&&(ne.command(0===v||y,'cannot specify divisor for attribute "'+e+'", instancing not supported',t.commandStr),ne.command(v>=0,'invalid divisor for attribute "'+e+'"',t.commandStr)),ne.optional((function(){var n=t.commandStr,i=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(r).forEach((function(t){ne.command(i.indexOf(t)>=0,'unknown parameter "'+t+'" for attribute pointer "'+e+'" (valid parameters are '+i+")",n)}))})),l.buffer=c,l.state=io,l.size=f,l.normalized=g,l.type=p||c.dtype,l.offset=h,l.stride=d,l.divisor=v}}s[e]=aa((function(e,t){var n=e.attribCache;if(a in n)return n[a];var i={isStream:!1};return Object.keys(l).forEach((function(e){i[e]=l[e]})),l.buffer&&(i.buffer=e.link(l.buffer),i.type=i.type||i.buffer+".dtype"),n[a]=i,i}))})),Object.keys(r).forEach((function(e){var t=r[e];function n(n,i){var r=n.invoke(i,t),o=n.shared,s=n.constants,a=o.isBufferArgs,l=o.buffer;ne.optional((function(){n.assert(i,r+"&&(typeof "+r+'==="object"||typeof '+r+'==="function")&&('+a+"("+r+")||"+l+".getBuffer("+r+")||"+l+".getBuffer("+r+".buffer)||"+a+"("+r+'.buffer)||("constant" in '+r+"&&(typeof "+r+'.constant==="number"||'+o.isArrayLike+"("+r+".constant))))",'invalid dynamic attribute "'+e+'"')}));var c={isStream:i.def(!1)},u=new m;u.state=io,Object.keys(u).forEach((function(e){c[e]=i.def(""+u[e])}));var h=c.buffer,d=c.type;function f(e){i(c[e],"=",r,".",e,"|0;")}return i("if(",a,"(",r,")){",c.isStream,"=true;",h,"=",l,".createStream(",ss,",",r,");",d,"=",h,".dtype;","}else{",h,"=",l,".getBuffer(",r,");","if(",h,"){",d,"=",h,".dtype;",'}else if("constant" in ',r,"){",c.state,"=",ro,";","if(typeof "+r+'.constant === "number"){',c[to[0]],"=",r,".constant;",to.slice(1).map((function(e){return c[e]})).join("="),"=0;","}else{",to.map((function(e,t){return c[e]+"="+r+".constant.length>"+t+"?"+r+".constant["+t+"]:0;"})).join(""),"}}else{","if(",a,"(",r,".buffer)){",h,"=",l,".createStream(",ss,",",r,".buffer);","}else{",h,"=",l,".getBuffer(",r,".buffer);","}",d,'="type" in ',r,"?",s.glTypes,"[",r,".type]:",h,".dtype;",c.normalized,"=!!",r,".normalized;"),f("size"),f("offset"),f("stride"),f("divisor"),i("}}"),i.exit("if(",c.isStream,"){",l,".destroyStream(",h,");","}"),c}s[e]=la(t,n)})),s}function V(e,t){var n=e.static,i=e.dynamic;if(Yo in n){var r=n[Yo];return null!==r&&null===u.getVAO(r)&&(r=u.createVAO(r)),aa((function(e){return e.link(u.getVAO(r))}))}if(Yo in i){var o=i[Yo];return la(o,(function(e,t){var n=e.invoke(t,o);return t.def(e.shared.vao+".getVAO("+n+")")}))}return null}function U(e){var t=e.static,n=e.dynamic,i={};return Object.keys(t).forEach((function(e){var n=t[e];i[e]=aa((function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)}))})),Object.keys(n).forEach((function(e){var t=n[e];i[e]=la(t,(function(e,n){return e.invoke(n,t)}))})),i}function H(e,t,n,r,o){var s=e.static,a=e.dynamic;ne.optional((function(){var e=[Vo,Uo,Ho,jo,Go,qo,Ko,$o,zo,Yo].concat(C);function t(t){Object.keys(t).forEach((function(t){ne.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',o.commandStr)}))}t(s),t(a)}));var l=R(e,t),c=A(e),h=O(e,c,o),d=F(e,o),f=B(e,o),g=P(e,o,l);function p(e){var t=h[e];t&&(f[e]=t)}p(Wo),p(E(Bo));var m=Object.keys(f).length>0,v={framebuffer:c,draw:d,shader:g,state:f,dirty:m,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(v.profile=M(e),v.uniforms=W(n,o),v.drawVAO=v.scopeVAO=V(e),!v.drawVAO&&g.program&&!l&&i.angle_instanced_arrays){var y=!0,_=g.program.attributes.map((function(e){var n=t.static[e];return y=y&&!!n,n}));if(y&&_.length>0){var b=u.getVAO(u.createVAO(_));v.drawVAO=new oa(null,null,null,(function(e,t){return e.link(b)})),v.useVAO=!0}}return l?v.useVAO=!0:v.attributes=z(t,o),v.context=U(r),v}function j(e,t,n){var i=e.shared.context,r=e.scope();Object.keys(n).forEach((function(o){t.save(i,"."+o);var s=n[o].append(e,t);Array.isArray(s)?r(i,".",o,"=[",s.join(),"];"):r(i,".",o,"=",s,";")})),t(r)}function G(e,t,n,i){var r,o=e.shared,s=o.gl,a=o.framebuffer;_&&(r=t.def(o.extensions,".webgl_draw_buffers"));var l,c=e.constants,u=c.drawBuffer,h=c.backBuffer;l=n?n.append(e,t):t.def(a,".next"),i||t("if(",l,"!==",a,".cur){"),t("if(",l,"){",s,".bindFramebuffer(",Ys,",",l,".framebuffer);"),_&&t(r,".drawBuffersWEBGL(",u,"[",l,".colorAttachments.length]);"),t("}else{",s,".bindFramebuffer(",Ys,",null);"),_&&t(r,".drawBuffersWEBGL(",h,");"),t("}",a,".cur=",l,";"),i||t("}")}function K(e,t,n){var i=e.shared,r=i.gl,o=e.current,s=e.next,a=i.current,l=i.next,c=e.cond(a,".dirty");C.forEach((function(t){var i,u,h=E(t);if(!(h in n.state))if(h in s){i=s[h],u=o[h];var d=ke(b[h].length,(function(e){return c.def(i,"[",e,"]")}));c(e.cond(d.map((function(e,t){return e+"!=="+u+"["+t+"]"})).join("||")).then(r,".",x[h],"(",d,");",d.map((function(e,t){return u+"["+t+"]="+e})).join(";"),";"))}else{i=c.def(l,".",h);var f=e.cond(i,"!==",a,".",h);c(f),h in S?f(e.cond(i).then(r,".enable(",S[h],");").else(r,".disable(",S[h],");"),a,".",h,"=",i,";"):f(r,".",x[h],"(",i,");",a,".",h,"=",i,";")}})),0===Object.keys(n.state).length&&c(a,".dirty=false;"),t(c)}function q(e,t,n,i){var r=e.shared,o=e.current,s=r.current,a=r.gl;ra(Object.keys(n)).forEach((function(r){var l=n[r];if(!i||i(l)){var c=l.append(e,t);if(S[r]){var u=S[r];sa(l)?t(a,c?".enable(":".disable(",u,");"):t(e.cond(c).then(a,".enable(",u,");").else(a,".disable(",u,");")),t(s,".",r,"=",c,";")}else if(hn(c)){var h=o[r];t(a,".",x[r],"(",c,");",c.map((function(e,t){return h+"["+t+"]="+e})).join(";"),";")}else t(a,".",x[r],"(",c,");",s,".",r,"=",c,";")}}))}function $(e,t){y&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function Y(e,t,n,i,r){var o,s,a,l=e.shared,c=e.stats,u=l.current,h=l.timer,d=n.profile;function f(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function p(e){e(o=t.def(),"=",f(),";"),"string"==typeof r?e(c,".count+=",r,";"):e(c,".count++;"),g&&(i?e(s=t.def(),"=",h,".getNumPendingQueries();"):e(h,".beginQuery(",c,");"))}function m(e){e(c,".cpuTime+=",f(),"-",o,";"),g&&(i?e(h,".pushScopeStats(",s,",",h,".getNumPendingQueries(),",c,");"):e(h,".endQuery();"))}function v(e){var n=t.def(u,".profile");t(u,".profile=",e,";"),t.exit(u,".profile=",n,";")}if(d){if(sa(d))return void(d.enable?(p(t),m(t.exit),v("true")):v("false"));v(a=d.append(e,t))}else a=t.def(u,".profile");var y=e.block();p(y),t("if(",a,"){",y,"}");var _=e.block();m(_),t.exit("if(",a,"){",_,"}")}function X(e,t,n,i,r){var o=e.shared;function s(e){switch(e){case bs:case xs:case Ds:return 2;case ws:case Es:case Ns:return 3;case Cs:case ks:case Is:return 4;default:return 1}}function a(n,i,r){var s=o.gl,a=t.def(n,".location"),l=t.def(o.attributes,"[",a,"]"),c=r.state,u=r.buffer,h=[r.x,r.y,r.z,r.w],d=["buffer","normalized","offset","stride"];function f(){t("if(!",l,".buffer){",s,".enableVertexAttribArray(",a,");}");var n,o=r.type;if(n=r.size?t.def(r.size,"||",i):i,t("if(",l,".type!==",o,"||",l,".size!==",n,"||",d.map((function(e){return l+"."+e+"!=="+r[e]})).join("||"),"){",s,".bindBuffer(",ss,",",u,".buffer);",s,".vertexAttribPointer(",[a,n,o,r.normalized,r.stride,r.offset],");",l,".type=",o,";",l,".size=",n,";",d.map((function(e){return l+"."+e+"="+r[e]+";"})).join(""),"}"),y){var c=r.divisor;t("if(",l,".divisor!==",c,"){",e.instancing,".vertexAttribDivisorANGLE(",[a,c],");",l,".divisor=",c,";}")}}function g(){t("if(",l,".buffer){",s,".disableVertexAttribArray(",a,");",l,".buffer=null;","}if(",to.map((function(e,t){return l+"."+e+"!=="+h[t]})).join("||"),"){",s,".vertexAttrib4f(",a,",",h,");",to.map((function(e,t){return l+"."+e+"="+h[t]+";"})).join(""),"}")}c===io?f():c===ro?g():(t("if(",c,"===",io,"){"),f(),t("}else{"),g(),t("}"))}i.forEach((function(i){var o,l=i.name,c=n.attributes[l];if(c){if(!r(c))return;o=c.append(e,t)}else{if(!r(ca))return;var u=e.scopeAttrib(l);ne.optional((function(){e.assert(t,u+".state","missing attribute "+l)})),o={},Object.keys(new m).forEach((function(e){o[e]=t.def(u,".",e)}))}a(e.link(i),s(i.info.type),o)}))}function Z(e,t,i,r,o){for(var s,a=e.shared,l=a.gl,c=0;c<r.length;++c){var u,h=r[c],d=h.name,f=h.info.type,g=i.uniforms[d],p=e.link(h)+".location";if(g){if(!o(g))continue;if(sa(g)){var m=g.value;if(ne.command(null!=m,'missing uniform "'+d+'"',e.commandStr),f===Os||f===Rs){ne.command("function"==typeof m&&(f===Os&&("texture2d"===m._reglType||"framebuffer"===m._reglType)||f===Rs&&("textureCube"===m._reglType||"framebufferCube"===m._reglType)),"invalid texture for uniform "+d,e.commandStr);var v=e.link(m._texture||m.color[0]._texture);t(l,".uniform1i(",p,",",v+".bind());"),t.exit(v,".unbind();")}else if(f===Ts||f===Ms||f===As){ne.optional((function(){ne.command(hn(m),"invalid matrix for uniform "+d,e.commandStr),ne.command(f===Ts&&4===m.length||f===Ms&&9===m.length||f===As&&16===m.length,"invalid length for matrix uniform "+d,e.commandStr)}));var y=e.global.def("new Float32Array(["+Array.prototype.slice.call(m)+"])"),_=2;f===Ms?_=3:f===As&&(_=4),t(l,".uniformMatrix",_,"fv(",p,",false,",y,");")}else{switch(f){case _s:ne.commandType(m,"number","uniform "+d,e.commandStr),s="1f";break;case bs:ne.command(hn(m)&&2===m.length,"uniform "+d,e.commandStr),s="2f";break;case ws:ne.command(hn(m)&&3===m.length,"uniform "+d,e.commandStr),s="3f";break;case Cs:ne.command(hn(m)&&4===m.length,"uniform "+d,e.commandStr),s="4f";break;case Ls:ne.commandType(m,"boolean","uniform "+d,e.commandStr),s="1i";break;case Ss:ne.commandType(m,"number","uniform "+d,e.commandStr),s="1i";break;case Ds:case xs:ne.command(hn(m)&&2===m.length,"uniform "+d,e.commandStr),s="2i";break;case Ns:case Es:ne.command(hn(m)&&3===m.length,"uniform "+d,e.commandStr),s="3i";break;case Is:case ks:ne.command(hn(m)&&4===m.length,"uniform "+d,e.commandStr),s="4i"}t(l,".uniform",s,"(",p,",",hn(m)?Array.prototype.slice.call(m):m,");")}continue}u=g.append(e,t)}else{if(!o(ca))continue;u=t.def(a.uniforms,"[",n.id(d),"]")}f===Os?(ne(!Array.isArray(u),"must specify a scalar prop for textures"),t("if(",u,"&&",u,'._reglType==="framebuffer"){',u,"=",u,".color[0];","}")):f===Rs&&(ne(!Array.isArray(u),"must specify a scalar prop for cube maps"),t("if(",u,"&&",u,'._reglType==="framebufferCube"){',u,"=",u,".color[0];","}")),ne.optional((function(){function n(n,i){e.assert(t,n,'bad data or missing for uniform "'+d+'".  '+i)}function i(e){ne(!Array.isArray(u),"must not specify an array type for uniform"),n("typeof "+u+'==="'+e+'"',"invalid type, expected "+e)}function r(t,i){Array.isArray(u)?ne(u.length===t,"must have length "+t):n(a.isArrayLike+"("+u+")&&"+u+".length==="+t,"invalid vector, should have length "+t,e.commandStr)}function o(t){ne(!Array.isArray(u),"must not specify a value type"),n("typeof "+u+'==="function"&&'+u+'._reglType==="texture'+(t===ls?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(f){case Ss:i("number");break;case xs:r(2);break;case Es:r(3);break;case ks:r(4);break;case _s:i("number");break;case bs:r(2);break;case ws:r(3);break;case Cs:r(4);break;case Ls:i("boolean");break;case Ds:r(2);break;case Ns:r(3);break;case Is:case Ts:r(4);break;case Ms:r(9);break;case As:r(16);break;case Os:o(ls);break;case Rs:o(cs)}}));var b=1;switch(f){case Os:case Rs:var w=t.def(u,"._texture");t(l,".uniform1i(",p,",",w,".bind());"),t.exit(w,".unbind();");continue;case Ss:case Ls:s="1i";break;case xs:case Ds:s="2i",b=2;break;case Es:case Ns:s="3i",b=3;break;case ks:case Is:s="4i",b=4;break;case _s:s="1f";break;case bs:s="2f",b=2;break;case ws:s="3f",b=3;break;case Cs:s="4f",b=4;break;case Ts:s="Matrix2fv";break;case Ms:s="Matrix3fv";break;case As:s="Matrix4fv"}if(t(l,".uniform",s,"(",p,","),"M"===s.charAt(0)){var C=Math.pow(f-Ts+2,2),S=e.global.def("new Float32Array(",C,")");Array.isArray(u)?t("false,(",ke(C,(function(e){return S+"["+e+"]="+u[e]})),",",S,")"):t("false,(Array.isArray(",u,")||",u," instanceof Float32Array)?",u,":(",ke(C,(function(e){return S+"["+e+"]="+u+"["+e+"]"})),",",S,")")}else b>1?t(ke(b,(function(e){return Array.isArray(u)?u[e]:u+"["+e+"]"}))):(ne(!Array.isArray(u),"uniform value must not be an array"),t(u));t(");")}}function Q(e,t,n,i){var r=e.shared,o=r.gl,s=r.draw,a=i.draw;function l(){var r,l=a.elements,c=t;return l?((l.contextDep&&i.contextDynamic||l.propDep)&&(c=n),r=l.append(e,c)):r=c.def(s,".",jo),r&&c("if("+r+")"+o+".bindBuffer("+as+","+r+".buffer.buffer);"),r}function c(){var r,o=a.count,l=t;return o?((o.contextDep&&i.contextDynamic||o.propDep)&&(l=n),r=o.append(e,l),ne.optional((function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(l,r+">=0","missing vertex count")}))):(r=l.def(s,".",Ko),ne.optional((function(){e.assert(l,r+">=0","missing vertex count")}))),r}var u=l();function h(r){var o=a[r];return o?o.contextDep&&i.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(s,".",r)}var d,f,g=h(Go),p=h(qo),m=c();if("number"==typeof m){if(0===m)return}else n("if(",m,"){"),n.exit("}");y&&(d=h($o),f=e.instancing);var v=u+".type",_=a.elements&&sa(a.elements);function b(){function e(){n(f,".drawElementsInstancedANGLE(",[g,m,v,p+"<<(("+v+"-"+no+")>>1)",d],");")}function t(){n(f,".drawArraysInstancedANGLE(",[g,p,m,d],");")}u?_?e():(n("if(",u,"){"),e(),n("}else{"),t(),n("}")):t()}function w(){function e(){n(o+".drawElements("+[g,m,v,p+"<<(("+v+"-"+no+")>>1)"]+");")}function t(){n(o+".drawArrays("+[g,p,m]+");")}u?_?e():(n("if(",u,"){"),e(),n("}else{"),t(),n("}")):t()}y&&("number"!=typeof d||d>=0)?"string"==typeof d?(n("if(",d,">0){"),b(),n("}else if(",d,"<0){"),w(),n("}")):b():w()}function J(e,t,n,i,r){var o=T(),s=o.proc("body",r);return ne.optional((function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)})),y&&(o.instancing=s.def(o.shared.extensions,".angle_instanced_arrays")),e(o,s,n,i),o.compile().body}function ee(e,t,n,i){$(e,t),n.useVAO?n.drawVAO?t(e.shared.vao,".setVAO(",n.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),X(e,t,n,i.attributes,(function(){return!0}))),Z(e,t,n,i.uniforms,(function(){return!0})),Q(e,t,t,n)}function te(e,t){var n=e.proc("draw",1);$(e,n),j(e,n,t.context),G(e,n,t.framebuffer),K(e,n,t),q(e,n,t.state),Y(e,n,t,!1,!0);var i=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",i,".program);"),t.shader.program)ee(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var r=e.global.def("{}"),o=n.def(i,".id"),s=n.def(r,"[",o,"]");n(e.cond(s).then(s,".call(this,a0);").else(s,"=",r,"[",o,"]=",e.link((function(n){return J(ee,e,t,n,1)})),"(",i,");",s,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function ie(e,t,n,i){function r(){return!0}e.batchId="a1",$(e,t),X(e,t,n,i.attributes,r),Z(e,t,n,i.uniforms,r),Q(e,t,t,n)}function re(e,t,n,i){$(e,t);var r=n.contextDep,o=t.def(),s="a0",a="a1",l=t.def();e.shared.props=l,e.batchId=o;var c=e.scope(),u=e.scope();function h(e){return e.contextDep&&r||e.propDep}function d(e){return!h(e)}if(t(c.entry,"for(",o,"=0;",o,"<",a,";++",o,"){",l,"=",s,"[",o,"];",u,"}",c.exit),n.needsContext&&j(e,u,n.context),n.needsFramebuffer&&G(e,u,n.framebuffer),q(e,u,n.state,h),n.profile&&h(n.profile)&&Y(e,u,n,!1,!0),i)n.useVAO?n.drawVAO?h(n.drawVAO)?u(e.shared.vao,".setVAO(",n.drawVAO.append(e,u),");"):c(e.shared.vao,".setVAO(",n.drawVAO.append(e,c),");"):c(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(c(e.shared.vao,".setVAO(null);"),X(e,c,n,i.attributes,d),X(e,u,n,i.attributes,h)),Z(e,c,n,i.uniforms,d),Z(e,u,n,i.uniforms,h),Q(e,c,u,n);else{var f=e.global.def("{}"),g=n.shader.progVar.append(e,u),p=u.def(g,".id"),m=u.def(f,"[",p,"]");u(e.shared.gl,".useProgram(",g,".program);","if(!",m,"){",m,"=",f,"[",p,"]=",e.link((function(t){return J(ie,e,n,t,2)})),"(",g,");}",m,".call(this,a0[",o,"],",o,");")}}function oe(e,t){var n=e.proc("batch",2);e.batchId="0",$(e,n);var i=!1,r=!0;Object.keys(t.context).forEach((function(e){i=i||t.context[e].propDep})),i||(j(e,n,t.context),r=!1);var o=t.framebuffer,s=!1;function a(e){return e.contextDep&&i||e.propDep}o?(o.propDep?i=s=!0:o.contextDep&&i&&(s=!0),s||G(e,n,o)):G(e,n,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),K(e,n,t),q(e,n,t.state,(function(e){return!a(e)})),t.profile&&a(t.profile)||Y(e,n,t,!1,"a1"),t.contextDep=i,t.needsContext=r,t.needsFramebuffer=s;var l=t.shader.progVar;if(l.contextDep&&i||l.propDep)re(e,n,t,null);else{var c=l.append(e,n);if(n(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)re(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var u=e.global.def("{}"),h=n.def(c,".id"),d=n.def(u,"[",h,"]");n(e.cond(d).then(d,".call(this,a0,a1);").else(d,"=",u,"[",h,"]=",e.link((function(n){return J(re,e,t,n,2)})),"(",c,");",d,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function se(e,t){var i=e.proc("scope",3);e.batchId="a2";var r=e.shared,o=r.current;function s(n){var o=t.shader[n];o&&i.set(r.shader,"."+n,o.append(e,i))}j(e,i,t.context),t.framebuffer&&t.framebuffer.append(e,i),ra(Object.keys(t.state)).forEach((function(n){var o=t.state[n].append(e,i);hn(o)?o.forEach((function(t,r){i.set(e.next[n],"["+r+"]",t)})):i.set(r.next,"."+n,o)})),Y(e,i,t,!0,!0),[jo,qo,Ko,$o,Go].forEach((function(n){var o=t.draw[n];o&&i.set(r.draw,"."+n,""+o.append(e,i))})),Object.keys(t.uniforms).forEach((function(o){var s=t.uniforms[o].append(e,i);Array.isArray(s)&&(s="["+s.join()+"]"),i.set(r.uniforms,"["+n.id(o)+"]",s)})),Object.keys(t.attributes).forEach((function(n){var r=t.attributes[n].append(e,i),o=e.scopeAttrib(n);Object.keys(new m).forEach((function(e){i.set(o,"."+e,r[e])}))})),t.scopeVAO&&i.set(r.vao,".targetVAO",t.scopeVAO.append(e,i)),s(Uo),s(Ho),Object.keys(t.state).length>0&&(i(o,".dirty=true;"),i.exit(o,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}function ae(e){if("object"==typeof e&&!hn(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(ge.isDynamic(e[t[n]]))return!0;return!1}}function le(e,t,n){var i=t.static[n];if(i&&ae(i)){var r=e.global,o=Object.keys(i),s=!1,a=!1,l=!1,c=e.global.def("{}");o.forEach((function(t){var n=i[t];if(ge.isDynamic(n)){"function"==typeof n&&(n=i[t]=ge.unbox(n));var o=la(n,null);s=s||o.thisDep,l=l||o.propDep,a=a||o.contextDep}else{switch(r(c,".",t,"="),typeof n){case"number":r(n);break;case"string":r('"',n,'"');break;case"object":Array.isArray(n)&&r("[",n.join(),"]");break;default:r(e.link(n))}r(";")}})),t.dynamic[n]=new ge.DynamicVariable(co,{thisDep:s,contextDep:a,propDep:l,ref:c,append:u}),delete t.static[n]}function u(e,t){o.forEach((function(n){var r=i[n];if(ge.isDynamic(r)){var o=e.invoke(t,r);t(c,".",n,"=",o,";")}}))}}function ce(e,n,i,r,o){var s=T();s.stats=s.link(o),Object.keys(n.static).forEach((function(e){le(s,n,e)})),os.forEach((function(t){le(s,e,t)}));var a=H(e,n,i,r,s);return te(s,a),se(s,a),oe(s,a),t(s.compile(),{destroy:function(){a.shader.program.destroy()}})}return{next:w,current:b,procs:function(){var e=T(),t=e.proc("poll"),n=e.proc("refresh"),o=e.block();t(o),n(o);var s,a=e.shared,l=a.gl,c=a.next,u=a.current;o(u,".dirty=false;"),G(e,t),G(e,n,null,!0),y&&(s=e.link(y)),i.oes_vertex_array_object&&n(e.link(i.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<r.maxAttributes;++h){var d=n.def(a.attributes,"[",h,"]"),f=e.cond(d,".buffer");f.then(l,".enableVertexAttribArray(",h,");",l,".bindBuffer(",ss,",",d,".buffer.buffer);",l,".vertexAttribPointer(",h,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(l,".disableVertexAttribArray(",h,");",l,".vertexAttrib4f(",h,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),n(f),y&&n(s,".vertexAttribDivisorANGLE(",h,",",d,".divisor);")}return n(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(S).forEach((function(i){var r=S[i],s=o.def(c,".",i),a=e.block();a("if(",s,"){",l,".enable(",r,")}else{",l,".disable(",r,")}",u,".",i,"=",s,";"),n(a),t("if(",s,"!==",u,".",i,"){",a,"}")})),Object.keys(x).forEach((function(i){var r,s,a=x[i],h=b[i],d=e.block();if(d(l,".",a,"("),hn(h)){var f=h.length;r=e.global.def(c,".",i),s=e.global.def(u,".",i),d(ke(f,(function(e){return r+"["+e+"]"})),");",ke(f,(function(e){return s+"["+e+"]="+r+"["+e+"];"})).join("")),t("if(",ke(f,(function(e){return r+"["+e+"]!=="+s+"["+e+"]"})).join("||"),"){",d,"}")}else r=o.def(c,".",i),s=o.def(u,".",i),d(r,");",u,".",i,"=",r,";"),t("if(",r,"!==",s,"){",d,"}");n(d)})),e.compile()}(),compile:ce}}function ha(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var da=34918,fa=34919,ga=35007,pa=function(e,t){if(!t.ext_disjoint_timer_query)return null;var n=[];function i(){return n.pop()||t.ext_disjoint_timer_query.createQueryEXT()}function r(e){n.push(e)}var o=[];function s(e){var n=i();t.ext_disjoint_timer_query.beginQueryEXT(ga,n),o.push(n),f(o.length-1,o.length,e)}function a(){t.ext_disjoint_timer_query.endQueryEXT(ga)}function l(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var c=[];function u(){return c.pop()||new l}function h(e){c.push(e)}var d=[];function f(e,t,n){var i=u();i.startQueryIndex=e,i.endQueryIndex=t,i.sum=0,i.stats=n,d.push(i)}var g=[],p=[];function m(){var e,n,i=o.length;if(0!==i){p.length=Math.max(p.length,i+1),g.length=Math.max(g.length,i+1),g[0]=0,p[0]=0;var s=0;for(e=0,n=0;n<o.length;++n){var a=o[n];t.ext_disjoint_timer_query.getQueryObjectEXT(a,fa)?(s+=t.ext_disjoint_timer_query.getQueryObjectEXT(a,da),r(a)):o[e++]=a,g[n+1]=s,p[n+1]=e}for(o.length=e,e=0,n=0;n<d.length;++n){var l=d[n],c=l.startQueryIndex,u=l.endQueryIndex;l.sum+=g[u]-g[c];var f=p[c],m=p[u];m===f?(l.stats.gpuTime+=l.sum/1e6,h(l)):(l.startQueryIndex=f,l.endQueryIndex=m,d[e++]=l)}d.length=e}}return{beginQuery:s,endQuery:a,pushScopeStats:f,update:m,getNumPendingQueries:function(){return o.length},clear:function(){n.push.apply(n,o);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);o.length=0,n.length=0},restore:function(){o.length=0,n.length=0}}},ma=16384,va=256,ya=1024,_a=34962,ba="webglcontextlost",wa="webglcontextrestored",Ca=1,Sa=2,xa=3;function Ea(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function ka(e){var n=xe(e);if(!n)return null;var i=n.gl,r=i.getContextAttributes(),o=i.isContextLost(),s=Ee(i,n);if(!s)return null;var a=ve(),l=ha(),c=s.extensions,u=pa(i,c),h=me(),d=i.drawingBufferWidth,f=i.drawingBufferHeight,g={tick:0,time:0,viewportWidth:d,viewportHeight:f,framebufferWidth:d,framebufferHeight:f,drawingBufferWidth:d,drawingBufferHeight:f,pixelRatio:n.pixelRatio},p={},m={elements:null,primitive:4,count:-1,offset:0,instances:-1},v=Ct(i,c),y=Gt(i,l,n,b),_=Vr(i,c,v,l,y);function b(e){return _.destroyBuffer(e)}var w=sn(i,c,y,l),C=Kr(i,a,l,n),S=Yi(i,c,v,(function(){k.procs.poll()}),g,l,n),x=cr(i,c,v,l,n),E=Fr(i,c,v,S,x,l),k=ua(i,a,c,v,y,w,S,E,p,_,C,m,g,u,n),L=Zr(i,E,k.procs.poll,g,r,c,v),D=k.next,N=i.canvas,I=[],T=[],M=[],A=[n.onDestroy],O=null;function R(){if(0===I.length)return u&&u.update(),void(O=null);O=pe.next(R),q();for(var e=I.length-1;e>=0;--e){var t=I[e];t&&t(g,null,0)}i.flush(),u&&u.update()}function P(){!O&&I.length>0&&(O=pe.next(R))}function F(){O&&(pe.cancel(R),O=null)}function B(e){e.preventDefault(),o=!0,F(),T.forEach((function(e){e()}))}function W(e){i.getError(),o=!1,s.restore(),C.restore(),y.restore(),S.restore(),x.restore(),E.restore(),_.restore(),u&&u.restore(),k.procs.refresh(),P(),M.forEach((function(e){e()}))}function z(){I.length=0,F(),N&&(N.removeEventListener(ba,B),N.removeEventListener(wa,W)),C.clear(),E.clear(),x.clear(),S.clear(),w.clear(),y.clear(),_.clear(),u&&u.clear(),A.forEach((function(e){e()}))}function V(e){function n(e){var n=t({},e);function i(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach((function(i){n[e+"."+i]=t[i]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),i("blend"),i("depth"),i("cull"),i("stencil"),i("polygonOffset"),i("scissor"),i("sample"),"vao"in e&&(n.vao=e.vao),n}function i(e,t){var n={},i={};return Object.keys(e).forEach((function(r){var o=e[r];if(ge.isDynamic(o))i[r]=ge.unbox(o,r);else{if(t&&Array.isArray(o))for(var s=0;s<o.length;++s)if(ge.isDynamic(o[s]))return void(i[r]=ge.unbox(o,r));n[r]=o}})),{dynamic:i,static:n}}ne(!!e,"invalid args to regl({...})"),ne.type(e,"object","invalid args to regl({...})");var r=i(e.context||{},!0),s=i(e.uniforms||{},!0),a=i(e.attributes||{},!1),l=i(n(e),!1),c={gpuTime:0,cpuTime:0,count:0},u=k.compile(l,a,s,r,c),h=u.draw,d=u.batch,f=u.scope,g=[];function p(e){for(;g.length<e;)g.push(null);return g}function m(e,t){var n;if(o&&ne.raise("context lost"),"function"==typeof e)return f.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)f.call(this,null,t,n);else{if(!Array.isArray(e))return f.call(this,e,t,0);for(n=0;n<e.length;++n)f.call(this,e[n],t,n)}else if("number"==typeof e){if(e>0)return d.call(this,p(0|e),0|e)}else{if(!Array.isArray(e))return h.call(this,e);if(e.length)return d.call(this,e,e.length)}}return t(m,{stats:c,destroy:function(){u.destroy()}})}N&&(N.addEventListener(ba,B,!1),N.addEventListener(wa,W,!1));var U=E.setFBO=V({framebuffer:ge.define.call(null,Ca,"framebuffer")});function H(e,t){var n=0;k.procs.poll();var r=t.color;r&&(i.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=ma),"depth"in t&&(i.clearDepth(+t.depth),n|=va),"stencil"in t&&(i.clearStencil(0|t.stencil),n|=ya),ne(!!n,"called regl.clear with no buffer specified"),i.clear(n)}function j(e){if(ne("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var n=0;n<6;++n)U(t({framebuffer:e.framebuffer.faces[n]},e),H);else U(e,H);else H(null,e)}function G(e){function t(){var t=Ea(I,e);function n(){var e=Ea(I,n);I[e]=I[I.length-1],I.length-=1,I.length<=0&&F()}ne(t>=0,"cannot cancel a frame twice"),I[t]=n}return ne.type(e,"function","regl.frame() callback must be a function"),I.push(e),P(),{cancel:t}}function K(){var e=D.viewport,t=D.scissor_box;e[0]=e[1]=t[0]=t[1]=0,g.viewportWidth=g.framebufferWidth=g.drawingBufferWidth=e[2]=t[2]=i.drawingBufferWidth,g.viewportHeight=g.framebufferHeight=g.drawingBufferHeight=e[3]=t[3]=i.drawingBufferHeight}function q(){g.tick+=1,g.time=Y(),K(),k.procs.poll()}function $(){S.refresh(),K(),k.procs.refresh(),u&&u.update()}function Y(){return(me()-h)/1e3}function X(e,t){var n;switch(ne.type(t,"function","listener callback must be a function"),e){case"frame":return G(t);case"lost":n=T;break;case"restore":n=M;break;case"destroy":n=A;break;default:ne.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}}$();var Z=t(V,{clear:j,prop:ge.define.bind(null,Ca),context:ge.define.bind(null,Sa),this:ge.define.bind(null,xa),draw:V({}),buffer:function(e){return y.create(e,_a,!1,!1)},elements:function(e){return w.create(e,!1)},texture:S.create2D,cube:S.createCube,renderbuffer:x.create,framebuffer:E.create,framebufferCube:E.createCube,vao:_.createVAO,attributes:r,frame:G,on:X,limits:v,hasExtension:function(e){return v.extensions.indexOf(e.toLowerCase())>=0},read:L,destroy:z,_gl:i,_refresh:$,poll:function(){q(),u&&u.update()},now:Y,stats:l});return n.onDone(null,Z),Z}return ka}(),NM=function(){function e(t,n){F(this,e),this.attribute=void 0,this.buffer=void 0;var i=n.buffer,r=n.offset,o=n.stride,s=n.normalized,a=n.size,l=n.divisor;this.buffer=i,this.attribute={buffer:i.get(),offset:r||0,stride:o||0,normalized:s||!1,divisor:l||0},a&&(this.attribute.size=a)}return P(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),IM=(K(uM={},vL.POINTS,"points"),K(uM,vL.LINES,"lines"),K(uM,vL.LINE_LOOP,"line loop"),K(uM,vL.LINE_STRIP,"line strip"),K(uM,vL.TRIANGLES,"triangles"),K(uM,vL.TRIANGLE_FAN,"triangle fan"),K(uM,vL.TRIANGLE_STRIP,"triangle strip"),uM),TM=(K(hM={},vL.STATIC_DRAW,"static"),K(hM,vL.DYNAMIC_DRAW,"dynamic"),K(hM,vL.STREAM_DRAW,"stream"),hM),MM=(K(dM={},vL.BYTE,"int8"),K(dM,vL.UNSIGNED_INT,"int16"),K(dM,vL.INT,"int32"),K(dM,vL.UNSIGNED_BYTE,"uint8"),K(dM,vL.UNSIGNED_SHORT,"uint16"),K(dM,vL.UNSIGNED_INT,"uint32"),K(dM,vL.FLOAT,"float"),dM),AM=(K(fM={},vL.ALPHA,"alpha"),K(fM,vL.LUMINANCE,"luminance"),K(fM,vL.LUMINANCE_ALPHA,"luminance alpha"),K(fM,vL.RGB,"rgb"),K(fM,vL.RGBA,"rgba"),K(fM,vL.RGBA4,"rgba4"),K(fM,vL.RGB5_A1,"rgb5 a1"),K(fM,vL.RGB565,"rgb565"),K(fM,vL.DEPTH_COMPONENT,"depth"),K(fM,vL.DEPTH_STENCIL,"depth stencil"),fM),OM=(K(gM={},vL.DONT_CARE,"dont care"),K(gM,vL.NICEST,"nice"),K(gM,vL.FASTEST,"fast"),gM),RM=(K(pM={},vL.NEAREST,"nearest"),K(pM,vL.LINEAR,"linear"),K(pM,vL.LINEAR_MIPMAP_LINEAR,"mipmap"),K(pM,vL.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),K(pM,vL.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),K(pM,vL.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),pM),PM=(K(mM={},vL.REPEAT,"repeat"),K(mM,vL.CLAMP_TO_EDGE,"clamp"),K(mM,vL.MIRRORED_REPEAT,"mirror"),mM),FM=(K(vM={},vL.NONE,"none"),K(vM,vL.BROWSER_DEFAULT_WEBGL,"browser"),vM),BM=(K(yM={},vL.NEVER,"never"),K(yM,vL.ALWAYS,"always"),K(yM,vL.LESS,"less"),K(yM,vL.LEQUAL,"lequal"),K(yM,vL.GREATER,"greater"),K(yM,vL.GEQUAL,"gequal"),K(yM,vL.EQUAL,"equal"),K(yM,vL.NOTEQUAL,"notequal"),yM),WM=(K(_M={},vL.FUNC_ADD,"add"),K(_M,vL.MIN_EXT,"min"),K(_M,vL.MAX_EXT,"max"),K(_M,vL.FUNC_SUBTRACT,"subtract"),K(_M,vL.FUNC_REVERSE_SUBTRACT,"reverse subtract"),_M),zM=(K(bM={},vL.ZERO,"zero"),K(bM,vL.ONE,"one"),K(bM,vL.SRC_COLOR,"src color"),K(bM,vL.ONE_MINUS_SRC_COLOR,"one minus src color"),K(bM,vL.SRC_ALPHA,"src alpha"),K(bM,vL.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),K(bM,vL.DST_COLOR,"dst color"),K(bM,vL.ONE_MINUS_DST_COLOR,"one minus dst color"),K(bM,vL.DST_ALPHA,"dst alpha"),K(bM,vL.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),K(bM,vL.CONSTANT_COLOR,"constant color"),K(bM,vL.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),K(bM,vL.CONSTANT_ALPHA,"constant alpha"),K(bM,vL.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),K(bM,vL.SRC_ALPHA_SATURATE,"src alpha saturate"),bM),VM=(K(wM={},vL.NEVER,"never"),K(wM,vL.ALWAYS,"always"),K(wM,vL.LESS,"less"),K(wM,vL.LEQUAL,"lequal"),K(wM,vL.GREATER,"greater"),K(wM,vL.GEQUAL,"gequal"),K(wM,vL.EQUAL,"equal"),K(wM,vL.NOTEQUAL,"notequal"),wM),UM=(K(CM={},vL.ZERO,"zero"),K(CM,vL.KEEP,"keep"),K(CM,vL.REPLACE,"replace"),K(CM,vL.INVERT,"invert"),K(CM,vL.INCR,"increment"),K(CM,vL.DECR,"decrement"),K(CM,vL.INCR_WRAP,"increment wrap"),K(CM,vL.DECR_WRAP,"decrement wrap"),CM),HM=(K(SM={},vL.FRONT,"front"),K(SM,vL.BACK,"back"),SM),jM=function(){function e(t,n){F(this,e),this.buffer=void 0;var i=n.data,r=n.usage,o=n.type;this.buffer=t.buffer({data:i,usage:TM[r||vL.STATIC_DRAW],type:MM[o||vL.UNSIGNED_BYTE]})}return P(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(e){var t=e.data,n=e.offset;this.buffer.subdata(t,n)}}]),e}(),GM={};GM["[object Float32Array]"]=GM["[object Float64Array]"]=GM["[object Int8Array]"]=GM["[object Int16Array]"]=GM["[object Int32Array]"]=GM["[object Uint8Array]"]=GM["[object Uint8ClampedArray]"]=GM["[object Uint16Array]"]=GM["[object Uint32Array]"]=!0,GM["[object Arguments]"]=GM["[object Array]"]=GM["[object ArrayBuffer]"]=GM["[object Boolean]"]=GM["[object DataView]"]=GM["[object Date]"]=GM["[object Error]"]=GM["[object Function]"]=GM["[object Map]"]=GM["[object Number]"]=GM["[object Object]"]=GM["[object RegExp]"]=GM["[object Set]"]=GM["[object String]"]=GM["[object WeakMap]"]=!1;var KM=Object.prototype.toString;var qM=function(e){return function(e){return!!e&&"object"===j(e)}(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!!GM[KM.call(e)]};function $M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function YM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$M(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var XM=0,ZM=function(){function e(t,n){var i=this;F(this,e),this.reGl=t,this.context=n,this.entity=DE(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var r={};this.context.uniforms.forEach((function(e){var t=e.name,n=e.type,o=e.data,s=e.isReferer,a=e.storageClass;if(a===CI.StorageBuffer){if(s)i.textureCache[t]={data:void 0},r["".concat(t,"Size")]=function(){return o.compiledBundle.context.output.textureSize};else{i.textureCache[t]=i.calcDataTexture(t,n,o);var l=i.textureCache[t],c=l.textureWidth,u=l.isOutput;r["".concat(t,"Size")]=[c,c],u&&(i.outputTextureName=t,i.context.needPingpong&&(i.outputTextureName="".concat(t,"Output"),i.textureCache[i.outputTextureName]=i.calcDataTexture(t,n,o)))}r[t]=function(){return i.textureCache[t].texture}}else if(a===CI.Uniform){if(o&&(Array.isArray(o)||qM(o))&&o.length>16)throw new Error("invalid data type ".concat(n));r[t]=function(){return e.data}}}));var o=this.getOuputDataTexture(),s=o.textureWidth,a=o.texelCount;r.u_OutputTextureSize=[s,s],r.u_OutputTexelCount=a,this.context.output.textureSize=[s,s];var l={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(this.context.shader),uniforms:r,vert:"attribute vec3 a_Position;\nattribute vec2 a_TexCoord;\n\nvarying vec2 v_TexCoord;\n\nvoid main() {\n  gl_Position = vec4(a_Position, 1.0);\n  v_TexCoord = a_TexCoord;\n}",primitive:"triangle strip",count:4};this.computeCommand=this.reGl(l)}var t;return P(e,[{key:"run",value:function(){var e=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use((function(){e.computeCommand()}))}},{key:"readData",value:(t=B(W.mark((function e(){var t,n,i,r,o,s,a,l,c=this;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reGl({framebuffer:this.texFBO})((function(){t=c.reGl.read()})),!t){e.next=6;break}if(n=this.getOuputDataTexture(),i=n.originalDataLength,r=n.elementsPerTexel,o=n.typedArrayConstructor,s=void 0===o?Float32Array:o,a=[],4!==r)for(l=0;l<t.length;l+=4)1===r?a.push(t[l]):2===r?a.push(t[l],t[l+1]):a.push(t[l],t[l+1],t[l+2]);else a=t;return e.abrupt("return",new s(a.slice(0,i)));case 6:return e.abrupt("return",new Float32Array);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"confirmInput",value:function(e,t){var n;this.entity===e.entity?(this.dynamicPingpong=!0,n=this):n=e,this.textureCache[t].id=n.getOuputDataTexture().id,this.textureCache[t].texture=n.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(e,t){var n=this.context.uniforms.find((function(t){return t.name===e}));if(n){var i=this.calcDataTexture(e,n.type,t),r=i.texture,o=i.data;this.textureCache[e].data=o,this.textureCache[e].texture=r}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var e=this.context.output.name;this.textureCache[e].id=this.getOuputDataTexture().id,this.textureCache[e].texture=this.getOuputDataTexture().texture}var t=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=t}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var e=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=e}},{key:"cloneDataTexture",value:function(e){var t=e.data,n=e.textureWidth;return YM(YM({},e),{},{id:XM++,texture:this.reGl.texture({width:n,height:n,data:t,type:"float"})})}},{key:"calcDataTexture",value:function(e,t,n){var i=1;t===yI.Vector4FloatArray&&(i=4);for(var r=[],o=0;o<n.length;o+=i)1===i?r.push(n[o],0,0,0):2===i?r.push(n[o],n[o+1],0,0):3===i?r.push(n[o],n[o+1],n[o+2],0):4===i&&r.push(n[o],n[o+1],n[o+2],n[o+3]);var s=n.length,a=Math.ceil(s/i),l=Math.ceil(Math.sqrt(a)),c=l*l;a<c&&r.push.apply(r,q(new Array(4*(c-a)).fill(0)));var u=this.reGl.texture({width:l,height:l,data:r,type:"float"});return{id:XM++,data:r,originalDataLength:s,typedArrayConstructor:qM(n)?n.constructor:void 0,textureWidth:l,texture:u,texelCount:a,elementsPerTexel:i,isOutput:e===this.context.output.name}}}]),e}(),QM=function(){function e(t,n){F(this,e),this.elements=void 0;var i=n.data,r=n.usage,o=n.type,s=n.count;this.elements=t.elements({data:i,usage:TM[r||vL.STATIC_DRAW],type:MM[o||vL.UNSIGNED_BYTE],count:s})}return P(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(e){var t=e.data;this.elements.subdata(t)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),JM=function(){function e(t,n){F(this,e),this.framebuffer=void 0;var i=n.width,r=n.height,o=n.color,s=n.colors;n.depth,n.stencil;var a={width:i,height:r};Array.isArray(s)&&(a.colors=s.map((function(e){return e.get()}))),o&&"boolean"!=typeof o&&(a.color=o.get()),this.framebuffer=t.framebuffer(a)}return P(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.framebuffer.resize(t,n)}}]),e}();function eA(e){var t={};return Object.keys(e).forEach((function(n){tA(n,e[n],t,"")})),t}function tA(e,t,n,i){var r,o;null===t||"number"==typeof t||"boolean"==typeof t||Array.isArray(t)&&"number"==typeof t[0]||qM(t)||""===t||void 0!==t.resize?n["".concat(i&&i+".").concat(e)]=t:(o=j(r=t),null==r||"object"!==o&&"function"!==o||Object.keys(t).forEach((function(r){tA(r,t[r],n,"".concat(i&&i+".").concat(e))})),Array.isArray(t)&&t.forEach((function(t,r){Object.keys(t).forEach((function(o){tA(o,t[o],n,"".concat(i&&i+".").concat(e,"[").concat(r,"]"))}))})))}function nA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function iA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nA(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rA,oA,sA=function(){function e(t,n){F(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=t;var i=n.vs,r=n.fs,o=n.defines,s=n.attributes,a=n.uniforms,l=n.primitive,c=n.count,u=n.elements,h=n.depth,d=n.blend,f=n.stencil,g=n.cull,p=n.instances,m=n.scissor,v=n.viewport,y={};a&&(this.uniforms=eA(a),Object.keys(a).forEach((function(e){y[e]=t.prop(e)})));var _={};Object.keys(s).forEach((function(e){_[e]=s[e].get()}));var b=o&&this.generateDefines(o)||"",w={attributes:_,frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(b,"\n").concat(r),uniforms:y,vert:"\n".concat(b,"\n").concat(i),primitive:IM[void 0===l?vL.TRIANGLES:l]};p&&(w.instances=p),c&&(w.count=c),u&&(w.elements=u.get()),m&&(w.scissor=m),v&&(w.viewport=v),this.initDepthDrawParams({depth:h},w),this.initBlendDrawParams({blend:d},w),this.initStencilDrawParams({stencil:f},w),this.initCullDrawParams({cull:g},w),this.drawCommand=t(w)}return P(e,[{key:"addUniforms",value:function(e){this.uniforms=iA(iA({},this.uniforms),eA(e))}},{key:"draw",value:function(e){var t=iA(iA({},this.uniforms),eA(e.uniforms||{})),n={};Object.keys(t).forEach((function(e){var i=j(t[e]);"boolean"===i||"number"===i||Array.isArray(t[e])||t[e].BYTES_PER_ELEMENT?n[e]=t[e]:"string"===i||(n[e]=t[e].get())})),this.drawCommand(n)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(e,t){var n=e.depth;n&&(t.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:BM[n.func||vL.LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(e,t){var n=e.blend;if(n){var i=n.enable,r=n.func,o=n.equation,s=n.color,a=void 0===s?[0,0,0,0]:s;t.blend={enable:!!i,func:{srcRGB:zM[r&&r.srcRGB||vL.SRC_ALPHA],srcAlpha:zM[r&&r.srcAlpha||vL.SRC_ALPHA],dstRGB:zM[r&&r.dstRGB||vL.ONE_MINUS_SRC_ALPHA],dstAlpha:zM[r&&r.dstAlpha||vL.ONE_MINUS_SRC_ALPHA]},equation:{rgb:WM[o&&o.rgb||vL.FUNC_ADD],alpha:WM[o&&o.alpha||vL.FUNC_ADD]},color:a}}}},{key:"initStencilDrawParams",value:function(e,t){var n=e.stencil;if(n){var i=n.enable,r=n.mask,o=void 0===r?-1:r,s=n.func,a=void 0===s?{cmp:vL.ALWAYS,ref:0,mask:-1}:s,l=n.opFront,c=void 0===l?{fail:vL.KEEP,zfail:vL.KEEP,zpass:vL.KEEP}:l,u=n.opBack,h=void 0===u?{fail:vL.KEEP,zfail:vL.KEEP,zpass:vL.KEEP}:u;t.stencil={enable:!!i,mask:o,func:iA(iA({},a),{},{cmp:VM[a.cmp]}),opFront:{fail:UM[c.fail],zfail:UM[c.zfail],zpass:UM[c.zpass]},opBack:{fail:UM[h.fail],zfail:UM[h.zfail],zpass:UM[h.zpass]}}}}},{key:"initCullDrawParams",value:function(e,t){var n=e.cull;if(n){var i=n.enable,r=n.face,o=void 0===r?vL.BACK:r;t.cull={enable:!!i,face:HM[o]}}}},{key:"generateDefines",value:function(e){return Object.keys(e).map((function(t){return"#define ".concat(t," ").concat(Number(e[t]))})).join("\n")}}]),e}(),aA=function(){function e(t,n){F(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var i=n.data,r=n.type,o=void 0===r?vL.UNSIGNED_BYTE:r,s=n.width,a=n.height,l=n.flipY,c=void 0!==l&&l,u=n.format,h=void 0===u?vL.RGBA:u,d=n.mipmap,f=void 0!==d&&d,g=n.wrapS,p=void 0===g?vL.CLAMP_TO_EDGE:g,m=n.wrapT,v=void 0===m?vL.CLAMP_TO_EDGE:m,y=n.aniso,_=void 0===y?0:y,b=n.alignment,w=void 0===b?1:b,C=n.premultiplyAlpha,S=void 0!==C&&C,x=n.mag,E=void 0===x?vL.NEAREST:x,k=n.min,L=void 0===k?vL.NEAREST:k,D=n.colorSpace,N=void 0===D?vL.BROWSER_DEFAULT_WEBGL:D;this.width=s,this.height=a;var I={width:s,height:a,type:MM[o],format:AM[h],wrapS:PM[p],wrapT:PM[v],mag:RM[E],min:RM[L],alignment:w,flipY:c,colorSpace:FM[N],premultiplyAlpha:S,aniso:_};i&&(I.data=i),"number"==typeof f?I.mipmap=OM[f]:"boolean"==typeof f&&(I.mipmap=f),this.texture=t.texture(I)}return P(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.texture.resize(t,n),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),lA=qk()(rA=function(){function e(){var t=this;F(this,e),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var e=B(W.mark((function e(n){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.uniforms){e.next=3;break}return e.next=3,Promise.all(Object.keys(n.uniforms).map(function(){var e=B(W.mark((function e(t){var i;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.uniforms[t]||void 0===n.uniforms[t].load){e.next=5;break}return e.next=3,n.uniforms[t].load();case 3:i=e.sent,n.uniforms[t]=i;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.abrupt("return",new sA(t.gl,n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createAttribute=function(e){return new NM(t.gl,e)},this.createBuffer=function(e){return new jM(t.gl,e)},this.createElements=function(e){return new QM(t.gl,e)},this.createTexture2D=function(e){return new aA(t.gl,e)},this.createFramebuffer=function(e){return new JM(t.gl,e)},this.useFramebuffer=function(e,n){t.gl({framebuffer:e?e.get():null})(n)},this.createComputeModel=function(){var e=B(W.mark((function e(n){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new ZM(t.gl,n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.clear=function(e){var n=e.color,i=e.depth,r=e.stencil,o=e.framebuffer,s=void 0===o?null:o,a={color:n,depth:i,stencil:r};a.framebuffer=null===s?s:s.get(),t.gl.clear(a)},this.setScissor=function(e){t.gl&&t.gl._gl&&(e.enable&&e.box?(t.gl._gl.enable(vL.SCISSOR_TEST),t.gl._gl.scissor(e.box.x,e.box.y,e.box.width,e.box.height)):t.gl._gl.disable(vL.SCISSOR_TEST),t.gl._refresh())},this.viewport=function(e){var n=e.x,i=e.y,r=e.width,o=e.height;t.gl&&t.gl._gl&&(t.gl._gl.viewport(n,i,r,o),t.gl._refresh())},this.readPixels=function(e){var n=e.framebuffer,i={x:e.x,y:e.y,width:e.width,height:e.height};return n&&(i.framebuffer=n.get()),t.gl.read(i)},this.getCanvas=function(){return t.$canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl&&(t.gl.destroy(),t.inited=!1)}}var t;return P(e,[{key:"init",value:(t=B(W.mark((function e(t){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inited){e.next=2;break}return e.abrupt("return");case 2:return this.$canvas=t.canvas,e.next=5,new Promise((function(e,n){DM({canvas:t.canvas,attributes:{alpha:!0,antialias:t.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(t,i){!t&&i||n(t),e(i)}})}));case 5:this.gl=e.sent,this.inited=!0;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}())||rA;function cA(e,t,n,i){if("undefined"!=typeof window){var r=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",e),i&&(o.id=i),o.onload=function(){t&&t()},o.onerror=function(t){n&&n("Unable to load script '".concat(e,"'"),t)},r.appendChild(o)}}function uA(e,t){return new Promise((function(t,n){cA(e,(function(){t()}),(function(e,t){n(t)}))}))}function hA(){return dA.apply(this,arguments)}function dA(){return(dA=B(W.mark((function e(){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oA){e.next=2;break}return e.abrupt("return",oA);case 2:return e.next=4,uA("https://preview.babylonjs.com/glslang/glslang.js");case 4:return oA=window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"),e.abrupt("return",oA);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fA=function(){function e(t,n){F(this,e),this.engine=t,this.options=n,this.attribute=void 0,this.buffer=void 0;var i=n,r=i.buffer,o=i.offset,s=i.stride,a=i.normalized,l=i.size,c=i.divisor,u=i.arrayStride,h=i.attributes,d=i.stepMode;this.buffer=r,this.attribute={buffer:r.get(),offset:o||0,stride:s||0,normalized:a||!1,divisor:c||0,arrayStride:u||0,attributes:h,stepMode:d||"vertex"},l&&(this.attribute.size=l)}return P(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),gA=function(){function e(t,n){F(this,e),this.engine=t,this.options=n,this.buffer=void 0;var i=n,r=i.data,o=i.usage;i.type,this.buffer=this.createBuffer(r instanceof Array?new Float32Array(r):r,o||LT.BufferUsage.Vertex|LT.BufferUsage.CopyDst)}return P(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(e){var t=e.data,n=e.offset;this.setSubData(this.buffer,n,t instanceof Array?new Float32Array(t):t)}},{key:"createBuffer",value:function(e,t){var n=e.byteLength%4,i={size:e.byteLength+n,usage:t},r=this.engine.device.createBuffer(i);return this.setSubData(r,0,e),r}},{key:"setSubData",value:function(e,t,n){(kI?this.engine.device.getQueue():this.engine.device.defaultQueue).writeBuffer(e,t,n)}}]),e}();var pA,mA,vA,yA,_A,bA,wA,CA=function(){function e(t,n){F(this,e),this.engine=t,this.context=n,this.entity=DE(),this.uniformGPUBufferLayout=[],this.uniformBuffer=void 0,this.vertexBuffers={},this.outputBuffer=void 0,this.bindGroupEntries=void 0,this.bindGroup=void 0,this.computePipeline=void 0}var t,n,i;return P(e,[{key:"init",value:(i=B(W.mark((function e(){var t,n,i,r,o,s,a,l=this;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.compileComputePipelineStageDescriptor(this.context.shader);case 2:t=e.sent,n=t.computeStage,i=this.context.uniforms.filter((function(e){return e.storageClass===CI.StorageBuffer})),r=this.context.uniforms.filter((function(e){return e.storageClass===CI.Uniform})),o=r.length?1:0,this.bindGroupEntries=[],o&&(s=0,a=[],r.forEach((function(e){if("number"==typeof e.data)l.uniformGPUBufferLayout.push({name:e.name,offset:s}),s+=4,a.push(e.data);else{var t,n=(null===(t=e.data)||void 0===t?void 0:t.length)||1;3===n&&(n=4,e.data.push(0));var i=s/4%4;if(i>0){var r=4-i;if(n>1&&n<=r)2===n&&(3===r&&(s+=4,a.push(0)),a.push.apply(a,q(e.data)),l.uniformGPUBufferLayout.push({name:e.name,offset:s}));else{for(var o=0;o<r;o++)s+=4,a.push(0);a.push.apply(a,q(e.data)),l.uniformGPUBufferLayout.push({name:e.name,offset:s})}}s+=4*n}})),this.uniformBuffer=new gA(this.engine,{data:a instanceof Array?new Float32Array(a):a,usage:LT.BufferUsage.Uniform|LT.BufferUsage.CopyDst}),this.bindGroupEntries.push({binding:0,resource:{buffer:this.uniformBuffer.get()}})),i.forEach((function(e){var t;null!==e.data&&(e.type!==yI.Vector4FloatArray&&e.type!==yI.FloatArray||(e.name===l.context.output.name?(t=new gA(l.engine,{data:isFinite(Number(e.data))?[e.data]:e.data,usage:LT.BufferUsage.Storage|LT.BufferUsage.CopyDst|LT.BufferUsage.CopySrc}),l.outputBuffer=t,l.context.output={name:e.name,length:isFinite(Number(e.data))?1:e.data.length,typedArrayConstructor:Float32Array,gpuBuffer:t.get()}):e.isReferer?e.data.model&&e.data.model.outputBuffer&&(t=e.data.model.outputBuffer):t=new gA(l.engine,{data:isFinite(Number(e.data))?[e.data]:e.data,usage:LT.BufferUsage.Storage|LT.BufferUsage.CopyDst|LT.BufferUsage.CopySrc}),l.vertexBuffers[e.name]=t,l.bindGroupEntries.push({binding:o,resource:{name:e.name,refer:t?void 0:e.data,buffer:t?t.get():void 0}}),o++))})),this.computePipeline=this.engine.device.createComputePipeline({computeStage:n}),console.log(this.bindGroupEntries),this.bindGroup=this.engine.device.createBindGroup({layout:this.computePipeline.getBindGroupLayout(0),entries:this.bindGroupEntries});case 13:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"destroy",value:function(){var e=this;this.uniformBuffer&&this.uniformBuffer.destroy(),Object.keys(this.vertexBuffers).forEach((function(t){return e.vertexBuffers[t].destroy()}))}},{key:"readData",value:(n=B(W.mark((function e(){var t,n,i,r,o,s,a,l,c;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.context.output)){e.next=16;break}if(n=t.length,i=t.typedArrayConstructor,!(r=t.gpuBuffer)){e.next=16;break}return o=n*i.BYTES_PER_ELEMENT,s=this.engine.device.createBuffer({size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),(a=this.engine.device.createCommandEncoder()).copyBufferToBuffer(r,0,s,0,o),(kI?this.engine.device.getQueue():this.engine.device.defaultQueue).submit([a.finish()]),e.next=12,s.mapAsync(LT.MapMode.Read);case 12:return l=s.getMappedRange(),c=new i(l.slice(0)),s.unmap(),e.abrupt("return",c);case 16:return e.abrupt("return",new Float32Array);case 17:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"run",value:function(){var e;this.engine.currentComputePass&&(this.engine.currentComputePass.setPipeline(this.computePipeline),this.engine.currentComputePass.setBindGroup(0,this.bindGroup),(e=this.engine.currentComputePass).dispatch.apply(e,q(this.context.dispatch)))}},{key:"updateBuffer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.vertexBuffers[e];i&&i.subData({data:t,offset:n})}},{key:"updateUniform",value:function(e,t){var n=this.uniformGPUBufferLayout.find((function(t){return t.name===e}));n&&this.uniformBuffer.subData({data:Number.isFinite(t)?new Float32Array([t]):new Float32Array(t),offset:n.offset})}},{key:"confirmInput",value:function(e,t){var n=this.vertexBuffers[t],i=e.outputBuffer;if(n&&i&&n!==i){var r=this.engine.device.createCommandEncoder(),o=e.context.output,s=o.length*o.typedArrayConstructor.BYTES_PER_ELEMENT;r.copyBufferToBuffer(i.get(),0,n.get(),0,s),(kI?this.engine.device.getQueue():this.engine.device.defaultQueue).submit([r.finish()])}}},{key:"compileShaderToSpirV",value:function(e,t,n){return this.compileRawShaderToSpirV(n+e,t)}},{key:"compileRawShaderToSpirV",value:function(e,t){return this.engine.glslang.compileGLSL(e,t)}},{key:"compileComputePipelineStageDescriptor",value:(t=B(W.mark((function e(t){var n;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,this.engine.options.useWGSL){e.next=6;break}return e.next=5,this.compileShaderToSpirV(t,"compute","#version 450\n");case 5:n=e.sent;case 6:return e.abrupt("return",{computeStage:{module:this.engine.device.createShaderModule({code:n,isWHLSL:kI}),entryPoint:"main"}});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),SA=function(){function e(t,n){F(this,e),this.engine=t,this.options=n,this.indexCount=void 0,this.buffer=void 0;var i=n,r=i.data;i.usage,i.type;var o=i.count;this.indexCount=o||0,this.buffer=new gA(t,{data:r instanceof Array?new Uint16Array(r):r,usage:LT.BufferUsage.Index|LT.BufferUsage.CopyDst})}return P(e,[{key:"get",value:function(){return this.buffer}},{key:"subData",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),xA=function(){function e(t,n){F(this,e),this.engine=t,this.options=n,this.colorTexture=void 0,this.depthTexture=void 0,this.width=0,this.height=0;var i=n;i.width,i.height;var r=i.color;i.colors;var o=i.depth;i.stencil,r&&(this.colorTexture=r),o&&(this.depthTexture=o)}return P(e,[{key:"get",value:function(){var e,t;return{color:null===(e=this.colorTexture)||void 0===e?void 0:e.get(),depth:null===(t=this.depthTexture)||void 0===t?void 0:t.get()}}},{key:"destroy",value:function(){var e,t;null===(e=this.colorTexture)||void 0===e||e.destroy(),null===(t=this.depthTexture)||void 0===t||t.destroy()}},{key:"resize",value:function(e){var t,n,i=e.width,r=e.height;i===this.width&&r===this.height||(null===(t=this.colorTexture)||void 0===t||t.resize({width:i,height:r}),null===(n=this.depthTexture)||void 0===n||n.resize({width:i,height:r}));this.width=i,this.height=r}}]),e}(),EA=(K(pA={},vL.POINTS,LT.PrimitiveTopology.PointList),K(pA,vL.LINES,LT.PrimitiveTopology.LineList),K(pA,vL.LINE_LOOP,LT.PrimitiveTopology.LineList),K(pA,vL.LINE_STRIP,LT.PrimitiveTopology.LineStrip),K(pA,vL.TRIANGLES,LT.PrimitiveTopology.TriangleList),K(pA,vL.TRIANGLE_FAN,LT.PrimitiveTopology.TriangleList),K(pA,vL.TRIANGLE_STRIP,LT.PrimitiveTopology.TriangleStrip),pA),kA=(K(mA={},vL.NEVER,LT.CompareFunction.Never),K(mA,vL.ALWAYS,LT.CompareFunction.Always),K(mA,vL.LESS,LT.CompareFunction.Less),K(mA,vL.LEQUAL,LT.CompareFunction.LessEqual),K(mA,vL.GREATER,LT.CompareFunction.Greater),K(mA,vL.GEQUAL,LT.CompareFunction.GreaterEqual),K(mA,vL.EQUAL,LT.CompareFunction.Equal),K(mA,vL.NOTEQUAL,LT.CompareFunction.NotEqual),mA),LA=(K(vA={},vL.FUNC_ADD,LT.BlendOperation.Add),K(vA,vL.MIN_EXT,LT.BlendOperation.Min),K(vA,vL.MAX_EXT,LT.BlendOperation.Max),K(vA,vL.FUNC_SUBTRACT,LT.BlendOperation.Subtract),K(vA,vL.FUNC_REVERSE_SUBTRACT,LT.BlendOperation.ReverseSubtract),vA),DA=(K(yA={},vL.ZERO,LT.BlendFactor.Zero),K(yA,vL.ONE,LT.BlendFactor.One),K(yA,vL.SRC_COLOR,LT.BlendFactor.SrcColor),K(yA,vL.ONE_MINUS_SRC_COLOR,LT.BlendFactor.OneMinusSrcColor),K(yA,vL.SRC_ALPHA,LT.BlendFactor.SrcAlpha),K(yA,vL.ONE_MINUS_SRC_ALPHA,LT.BlendFactor.OneMinusSrcAlpha),K(yA,vL.DST_COLOR,LT.BlendFactor.DstColor),K(yA,vL.ONE_MINUS_DST_COLOR,LT.BlendFactor.OneMinusDstColor),K(yA,vL.DST_ALPHA,LT.BlendFactor.DstAlpha),K(yA,vL.ONE_MINUS_DST_ALPHA,LT.BlendFactor.OneMinusDstAlpha),K(yA,vL.CONSTANT_COLOR,LT.BlendFactor.BlendColor),K(yA,vL.ONE_MINUS_CONSTANT_COLOR,LT.BlendFactor.OneMinusBlendColor),K(yA,vL.SRC_ALPHA_SATURATE,LT.BlendFactor.SrcAlphaSaturated),yA),NA=(K(_A={},vL.ALPHA,"r8unorm"),K(_A,vL.RGBA,"rgba8unorm"),K(_A,vL.DEPTH_COMPONENT,"depth32float"),K(_A,vL.DEPTH_STENCIL,"depth24plus-stencil8"),_A),IA=(K(bA={},vL.NEAREST,"nearest"),K(bA,vL.LINEAR,"linear"),bA),TA=(K(wA={},vL.REPEAT,"repeat"),K(wA,vL.CLAMP_TO_EDGE,"clamp-to-edge"),K(wA,vL.MIRRORED_REPEAT,"mirror-repeat"),wA);function MA(e){var t=e.cull;return t&&t.enable?t.face?t.face===vL.FRONT?LT.CullMode.Front:LT.CullMode.Back:void 0:LT.CullMode.None}function AA(e){var t=e.depth;e.stencil;var n={compare:LT.CompareFunction.Always,depthFailOp:LT.StencilOperation.Keep,failOp:LT.StencilOperation.Keep,passOp:LT.StencilOperation.Keep};return{depthWriteEnabled:t&&t.enable,depthCompare:kA[(null==t?void 0:t.func)||vL.ALWAYS],format:LT.TextureFormat.Depth24PlusStencil8,stencilFront:n,stencilBack:n,stencilReadMask:4294967295,stencilWriteMask:4294967295}}function OA(e,t){var n=e.blend;return[{format:t,alphaBlend:{srcFactor:DA[n&&n.func&&n.func.srcAlpha||vL.ONE],dstFactor:DA[n&&n.func&&n.func.dstAlpha||vL.ZERO],operation:LA[n&&n.equation&&n.equation.alpha||vL.FUNC_ADD]},colorBlend:{srcFactor:DA[n&&n.func&&n.func.srcRGB||vL.ONE],dstFactor:DA[n&&n.func&&n.func.dstRGB||vL.ZERO],operation:LA[n&&n.equation&&n.equation.rgb||vL.FUNC_ADD]},writeMask:LT.ColorWrite.All}]}function RA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function PA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RA(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function FA(e){for(var t=0,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var o=0,s=i;o<s.length;o++){var a=s[o];t+=a.length}for(var l=new e(t),c=0,u=0,h=i;u<h.length;u++){var d=h[u];l.set(d,c),c+=d.length}return l}var BA,WA,zA=function(){function e(t,n){F(this,e),this.engine=t,this.options=n,this.pipelineLayout=void 0,this.renderPipeline=void 0,this.uniformsBindGroupLayout=void 0,this.uniformBindGroup=void 0,this.uniformBuffer=void 0,this.uniforms={},this.uniformGPUBufferLayout=[],this.attributeCache={},this.indexBuffer=void 0,this.indexCount=void 0}var t,n;return P(e,[{key:"init",value:(n=B(W.mark((function e(){var t,n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v=this;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.options,n=t.vs,i=t.fs,r=t.attributes,o=t.uniforms,s=t.primitive,a=t.elements,l=t.depth,c=t.blend,u=t.stencil,h=t.cull,e.next=3,this.compilePipelineStageDescriptor(n,i,null);case 3:d=e.sent,f=d.vertexStage,g=d.fragmentStage,o&&this.buildUniformBindGroup(o),a&&(this.indexBuffer=a.get(),this.indexCount=a.indexCount),p={vertexBuffers:Object.keys(r).map((function(e,t){var n=r[e],i=n.get(),o=i.arrayStride,s=i.stepMode,a=i.attributes;return v.attributeCache[e]=n,{arrayStride:o,stepMode:s,attributes:a}}))},m={sampleCount:this.engine.mainPassSampleCount,primitiveTopology:EA[s||vL.TRIANGLES],rasterizationState:PA(PA({},this.getDefaultRasterizationStateDescriptor()),{},{cullMode:MA({cull:h})}),depthStencilState:AA({depth:l,stencil:u}),colorStates:OA({blend:c},this.engine.options.swapChainFormat),layout:this.pipelineLayout,vertexStage:f,fragmentStage:g,vertexState:p},this.renderPipeline=this.engine.device.createRenderPipeline(m);case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"addUniforms",value:function(e){this.uniforms=PA(PA({},this.uniforms),eA(e))}},{key:"draw",value:function(e){var t=this,n=this.engine.getCurrentRenderPass(),i=PA(PA({},this.uniforms),eA(e.uniforms||{})),r=[];Object.keys(i).forEach((function(e){var n=j(i[e]);if("boolean"===n||"number"===n||Array.isArray(i[e])||i[e].BYTES_PER_ELEMENT){var o,s=null===(o=t.uniformGPUBufferLayout.find((function(t){return t.name===e})))||void 0===o?void 0:o.offset;null!==s&&t.uniformBuffer.subData({data:i[e],offset:s})}else{var a,l=null===(a=t.uniformGPUBufferLayout.find((function(t){return t.name===e})))||void 0===a?void 0:a.offset;if(null!==l){var c=i[e].get(),u=c.color||c,h=u.texture,d=u.sampler;d&&(r.push({binding:l,resource:d}),l++),r.push({binding:l,resource:h.createView()})}}})),this.uniformBuffer&&(r[0]={binding:0,resource:{buffer:this.uniformBuffer.get()}}),this.uniformBindGroup=this.engine.device.createBindGroup({layout:this.uniformsBindGroupLayout,entries:r}),this.renderPipeline&&n.setPipeline(this.renderPipeline),n.setBindGroup(0,this.uniformBindGroup),this.indexBuffer&&n.setIndexBuffer(this.indexBuffer.get(),LT.IndexFormat.Uint32,0),Object.keys(this.attributeCache).forEach((function(e,i){n.setVertexBuffer(0+i,t.attributeCache[e].get().buffer,0)})),this.indexBuffer?n.drawIndexed(this.indexCount,this.options.instances||1,0,0,0):n.draw(this.options.count||0,this.options.instances||0,0,0)}},{key:"destroy",value:function(){throw new Error("Method not implemented.")}},{key:"compilePipelineStageDescriptor",value:(t=B(W.mark((function e(t,n,i){var r,o,s;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="#version 450\n",o=t,s=n,this.engine.options.useWGSL){e.next=10;break}return e.next=6,this.compileShaderToSpirV(t,"vertex",r);case 6:return o=e.sent,e.next=9,this.compileShaderToSpirV(n,"fragment",r);case 9:s=e.sent;case 10:return e.abrupt("return",this.createPipelineStageDescriptor(o,s));case 11:case"end":return e.stop()}}),e,this)}))),function(e,n,i){return t.apply(this,arguments)})},{key:"compileShaderToSpirV",value:function(e,t,n){return this.compileRawShaderToSpirV(n+e,t)}},{key:"compileRawShaderToSpirV",value:function(e,t){return this.engine.glslang.compileGLSL(e,t)}},{key:"createPipelineStageDescriptor",value:function(e,t){return{vertexStage:{module:this.engine.device.createShaderModule({code:e,isWHLSL:kI}),entryPoint:"main"},fragmentStage:{module:this.engine.device.createShaderModule({code:t,isWHLSL:kI}),entryPoint:"main"}}}},{key:"getDefaultRasterizationStateDescriptor",value:function(){return{frontFace:LT.FrontFace.CCW,cullMode:LT.CullMode.None,depthBias:0,depthBiasSlopeScale:0,depthBiasClamp:0}}},{key:"buildUniformBindGroup",value:function(e){var t=this,n=0,i=FA.apply(void 0,[Float32Array].concat(q(Object.keys(e).map((function(i){return e[i]?(t.uniformGPUBufferLayout.push({name:i,offset:n}),n+=4*(e[i].length||1),e[i]):[]}))))),r=[],o=!1;i.length&&(o=!0,r.push({binding:0,visibility:LT.ShaderStage.Fragment|LT.ShaderStage.Vertex,type:LT.BindingType.UniformBuffer})),Object.keys(e).filter((function(t){return null===e[t]})).forEach((function(e,n){t.uniformGPUBufferLayout.push({name:e,offset:2*n+(o?1:0)}),r.push({binding:2*n+(o?1:0),visibility:LT.ShaderStage.Fragment,type:LT.BindingType.Sampler},{binding:2*n+(o?1:0)+1,visibility:LT.ShaderStage.Fragment,type:LT.BindingType.SampledTexture})})),this.uniformsBindGroupLayout=this.engine.device.createBindGroupLayout({entries:r}),this.pipelineLayout=this.engine.device.createPipelineLayout({bindGroupLayouts:[this.uniformsBindGroupLayout]}),o&&(this.uniformBuffer=new gA(this.engine,{data:i instanceof Array?new Float32Array(i):i,usage:LT.BufferUsage.Uniform|LT.BufferUsage.CopyDst}))}}]),e}(),VA=function(){function e(t,n){F(this,e),this.engine=t,this.options=n,this.texture=void 0,this.sampler=void 0,this.width=void 0,this.height=void 0,this.createTexture()}return P(e,[{key:"get",value:function(){return{texture:this.texture,sampler:this.sampler}}},{key:"update",value:function(){}},{key:"resize",value:function(e){var t=e.width,n=e.height;t===this.width&&n===this.height||(this.destroy(),this.createTexture()),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture&&this.texture.destroy()}},{key:"createTexture",value:function(){var e=this.options;e.data;var t=e.type;void 0===t&&vL.UNSIGNED_BYTE;var n=e.width,i=e.height;e.flipY;var r=e.format,o=void 0===r?vL.RGBA:r;e.mipmap;var s=e.wrapS,a=void 0===s?vL.CLAMP_TO_EDGE:s,l=e.wrapT,c=void 0===l?vL.CLAMP_TO_EDGE:l,u=e.aniso,h=void 0===u?0:u;e.alignment,e.premultiplyAlpha;var d=e.mag,f=void 0===d?vL.NEAREST:d,g=e.min,p=void 0===g?vL.NEAREST:g,m=e.colorSpace;void 0===m&&vL.BROWSER_DEFAULT_WEBGL;var v=e.usage;this.width=n,this.height=i,this.texture=this.engine.device.createTexture({size:[n,i,1],mipLevelCount:1,sampleCount:1,dimension:LT.TextureDimension.E2d,format:NA[o],usage:v||LT.TextureUsage.Sampled|LT.TextureUsage.CopyDst}),(!v||v&LT.TextureUsage.Sampled)&&(this.sampler=this.engine.device.createSampler({addressModeU:TA[a],addressModeV:TA[c],addressModeW:TA[a],magFilter:IA[f],minFilter:IA[p],maxAnisotropy:h}))}}]),e}(),UA=qk()(BA=function(){function e(){var t=this;F(this,e),this.supportWebGPU=!0,this.useWGSL=!1,this.options=void 0,this.canvas=void 0,this.context=void 0,this.glslang=void 0,this.adapter=void 0,this.device=void 0,this.swapChain=void 0,this.mainPassSampleCount=void 0,this.mainTexture=void 0,this.depthTexture=void 0,this.mainColorAttachments=void 0,this.mainTextureExtends=void 0,this.mainDepthAttachment=void 0,this.uploadEncoder=void 0,this.renderEncoder=void 0,this.computeEncoder=void 0,this.renderTargetEncoder=void 0,this.commandBuffers=new Array(4).fill(void 0),this.currentRenderPass=null,this.mainRenderPass=null,this.currentRenderTargetViewDescriptor=void 0,this.currentComputePass=null,this.bundleEncoder=void 0,this.tempBuffers=[],this.currentRenderTarget=null,this.uploadEncoderDescriptor={label:"upload"},this.renderEncoderDescriptor={label:"render"},this.renderTargetEncoderDescriptor={label:"renderTarget"},this.computeEncoderDescriptor={label:"compute"},this.pipelines={},this.computePipelines={},this.defaultSampleCount=4,this.clearDepthValue=1,this.clearStencilValue=0,this.transientViewport={x:1/0,y:0,width:0,height:0},this.cachedViewport={x:0,y:0,width:0,height:0},this.clear=function(e){e.framebuffer;var n=e.color,i=e.depth,r=e.stencil;t.options.supportCompute&&t.startComputePass(),t.currentRenderTarget?(t.currentRenderPass&&t.endRenderTargetRenderPass(),t.startRenderTargetRenderPass(t.currentRenderTarget,n||null,!!i,!!r)):(t.mainColorAttachments[0].loadValue=n||LT.LoadOp.Load,t.mainDepthAttachment.depthLoadValue=i||LT.LoadOp.Load,t.mainDepthAttachment.stencilLoadValue=r?t.clearStencilValue:LT.LoadOp.Load,t.mainRenderPass&&t.endMainRenderPass(),t.startMainRenderPass())},this.createModel=function(){var e=B(W.mark((function e(n){var i;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new zA(t,n),e.next=3,i.init();case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createAttribute=function(e){return new fA(t,e)},this.createBuffer=function(e){return new gA(t,e)},this.createElements=function(e){return new SA(t,e)},this.createTexture2D=function(e){return new VA(t,e)},this.createFramebuffer=function(e){return new xA(t,e)},this.useFramebuffer=function(e,n){t.currentRenderTarget&&t.unbindFramebuffer(t.currentRenderTarget),t.currentRenderTarget=e,t.currentRenderTargetViewDescriptor={dimension:LT.TextureViewDimension.E2d,arrayLayerCount:1,aspect:LT.TextureAspect.All},t.currentRenderPass=null,n()},this.createComputeModel=function(){var e=B(W.mark((function e(n){var i;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new CA(t,n),e.next=3,i.init();case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getCanvas=function(){return t.canvas},this.getGLContext=function(){throw new Error("Method not implemented.")},this.viewport=function(e){var n=e.x,i=e.y,r=e.width,o=e.height;if(t.currentRenderPass){if(t.transientViewport.x!==1/0){t.getCurrentRenderPass().setViewport(t.transientViewport.x,t.transientViewport.y,t.transientViewport.width,t.transientViewport.height,0,1)}else if(n!==t.cachedViewport.x||i!==t.cachedViewport.y||r!==t.cachedViewport.width||o!==t.cachedViewport.height){t.cachedViewport={x:n,y:i,width:r,height:o},t.getCurrentRenderPass().setViewport(n,i,r,o,0,1)}}else t.transientViewport={x:n,y:i,width:r,height:o}},this.readPixels=function(e){throw new Error("Method not implemented.")}}var t,n;return P(e,[{key:"isFloatSupported",value:function(){return!0}},{key:"init",value:(n=B(W.mark((function e(t){return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.canvas=t.canvas,this.options=t,this.useWGSL=!!t.useWGSL,this.mainPassSampleCount=t.antialiasing?this.defaultSampleCount:1,e.next=6,this.initGlslang();case 6:this.initContextAndSwapChain(),this.initMainAttachments();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setScissor",value:function(e){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){this.mainTexture&&this.mainTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.tempBuffers.forEach((function(e){return e.destroy()})),this.tempBuffers=[]}},{key:"beginFrame",value:function(){this.uploadEncoder=this.device.createCommandEncoder(this.uploadEncoderDescriptor),this.renderEncoder=this.device.createCommandEncoder(this.renderEncoderDescriptor),this.renderTargetEncoder=this.device.createCommandEncoder(this.renderTargetEncoderDescriptor),this.options.supportCompute&&(this.computeEncoder=this.device.createCommandEncoder(this.computeEncoderDescriptor))}},{key:"endFrame",value:function(){this.options.supportCompute&&this.endComputePass(),this.endMainRenderPass(),this.commandBuffers[0]=this.uploadEncoder.finish(),this.commandBuffers[1]=this.renderEncoder.finish(),this.options.supportCompute&&(this.commandBuffers[2]=this.computeEncoder.finish()),this.commandBuffers[3]=this.renderTargetEncoder.finish(),kI?this.device.getQueue().submit(this.commandBuffers.filter((function(e){return e}))):this.device.defaultQueue.submit(this.commandBuffers.filter((function(e){return e})))}},{key:"getCurrentRenderPass",value:function(){return this.currentRenderTarget&&!this.currentRenderPass?this.startRenderTargetRenderPass(this.currentRenderTarget,null,!1,!1):this.currentRenderPass||this.startMainRenderPass(),this.currentRenderPass}},{key:"initGlslang",value:(t=B(W.mark((function e(){var t,n;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hA();case 2:return this.glslang=e.sent,e.next=5,null===(t=navigator)||void 0===t||null===(n=t.gpu)||void 0===n?void 0:n.requestAdapter();case 5:return this.adapter=e.sent,e.next=8,this.adapter.requestDevice();case 8:this.device=e.sent;case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"initContextAndSwapChain",value:function(){this.context=this.canvas.getContext(kI?"gpu":"gpupresent"),this.swapChain=this.context.configureSwapChain({device:this.device,format:this.options.swapChainFormat,usage:LT.TextureUsage.OutputAttachment|LT.TextureUsage.CopySrc})}},{key:"initMainAttachments",value:function(){if(this.mainTextureExtends={width:this.canvas.width,height:this.canvas.height,depth:1},this.options.antialiasing){var e={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:LT.TextureDimension.E2d,format:LT.TextureFormat.BGRA8Unorm,usage:LT.TextureUsage.OutputAttachment};this.mainTexture&&this.mainTexture.destroy(),this.mainTexture=this.device.createTexture(e),this.mainColorAttachments=[{attachment:kI?this.mainTexture.createDefaultView():this.mainTexture.createView(),loadValue:[0,0,0,1],storeOp:LT.StoreOp.Store}]}else this.mainColorAttachments=[{attachment:kI?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),loadValue:[0,0,0,1],storeOp:LT.StoreOp.Store}];var t={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:LT.TextureDimension.E2d,format:kI?"depth32float-stencil8":LT.TextureFormat.Depth24PlusStencil8,usage:LT.TextureUsage.OutputAttachment};this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture(t),this.mainDepthAttachment={attachment:kI?this.depthTexture.createDefaultView():this.depthTexture.createView(),depthLoadValue:this.clearDepthValue,depthStoreOp:LT.StoreOp.Store,stencilLoadValue:this.clearStencilValue,stencilStoreOp:LT.StoreOp.Store}}},{key:"startComputePass",value:function(){this.currentComputePass&&this.endComputePass(),this.currentComputePass=this.computeEncoder.beginComputePass()}},{key:"startMainRenderPass",value:function(){this.currentRenderPass&&!this.currentRenderTarget&&this.endMainRenderPass(),this.options.antialiasing?this.mainColorAttachments[0].resolveTarget=kI?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView():this.mainColorAttachments[0].attachment=kI?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),this.currentRenderPass=this.renderEncoder.beginRenderPass({colorAttachments:this.mainColorAttachments,depthStencilAttachment:this.mainDepthAttachment}),this.mainRenderPass=this.currentRenderPass,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"startRenderTargetRenderPass",value:function(e,t,n){var i,r,o,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=null===(i=e.get().color)||void 0===i?void 0:i.texture;a&&(o=a.createView(this.currentRenderTargetViewDescriptor));var l,c=null===(r=e.get().depth)||void 0===r?void 0:r.texture;c&&(l=c.createView());var u=this.renderTargetEncoder.beginRenderPass({colorAttachments:[{attachment:o,loadValue:null!==t?t:LT.LoadOp.Load,storeOp:LT.StoreOp.Store}],depthStencilAttachment:c&&l?{attachment:l,depthLoadValue:n?this.clearDepthValue:LT.LoadOp.Load,depthStoreOp:LT.StoreOp.Store,stencilLoadValue:s?this.clearStencilValue:LT.LoadOp.Load,stencilStoreOp:LT.StoreOp.Store}:void 0});this.currentRenderPass=u,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"endMainRenderPass",value:function(){this.currentRenderPass===this.mainRenderPass&&null!==this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport(),this.currentRenderPass=null,this.mainRenderPass=null)}},{key:"endComputePass",value:function(){this.currentComputePass&&(this.currentComputePass.endPass(),this.currentComputePass=null)}},{key:"endRenderTargetRenderPass",value:function(){this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport())}},{key:"resetCachedViewport",value:function(){this.cachedViewport={x:0,y:0,width:0,height:0}}},{key:"unbindFramebuffer",value:function(e){this.currentRenderPass&&this.currentRenderPass!==this.mainRenderPass&&this.endRenderTargetRenderPass(),this.transientViewport.x=1/0,this.currentRenderTarget=null,this.currentRenderPass=this.mainRenderPass}}]),e}())||BA;function HA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var jA,GA=qk()(WA=function(e){z(n,kT);var t=HA(n);function n(){return F(this,n),t.apply(this,arguments)}return P(n,[{key:"onEntityCreated",value:function(){var e=this.config,t=e.widthSegments,n=void 0===t?1:t,i=e.heightSegments,r=void 0===i?1:i,o=e.depthSegments,s=void 0===o?1:o,a=e.halfExtents,l=void 0===a?is(.5,.5,.5):a,c=n,u=r,h=s,d=H(l,3),f=d[0],g=d[1],p=d[2],m=[is(-f,-g,p),is(f,-g,p),is(f,g,p),is(-f,g,p),is(f,-g,-p),is(-f,-g,-p),is(-f,g,-p),is(f,g,-p)],v=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],y=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],_=1,b=2,w=3,C=4,S=5,x=[],E=[],k=[],L=[],D=0,N=function(e,t,n){var i,r,o,s;for(o=0;o<=t;o++)for(s=0;s<=n;s++){var a=es(),l=es(),c=es(),u=es();hs(a,m[v[e][0]],m[v[e][1]],o/t),hs(l,m[v[e][0]],m[v[e][2]],s/n),gs(c,l,m[v[e][0]]),ss(u,a,c),i=o/t,r=s/n,x.push(u[0],u[1],u[2]),E.push(y[e][0],y[e][1],y[e][2]),k.push(i,r),i=.875*(i/=3)+.0625,r=.875*(r/=3)+.0625,i+=e%3/3,r+=Math.floor(e/3)/3,o<t&&s<n&&(L.push(D+n+1,D+1,D),L.push(D+n+1,D+n+2,D+1)),D++}};N(0,c,u),N(_,c,u),N(b,c,h),N(w,c,h),N(C,h,u),N(S,h,u);var I=pI(x),T=this.getComponent();T.indices=Uint32Array.from(L),T.aabb=I,T.vertexCount=D,T.attributes=[{dirty:!0,name:"position",data:Float32Array.from(x),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(E),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(k),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}())||WA;function KA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var qA,$A=qk()(jA=function(e){z(n,kT);var t=KA(n);function n(){return F(this,n),t.apply(this,arguments)}return P(n,[{key:"onEntityCreated",value:function(){var e=this.config.geometries,t=void 0===e?[]:e,n=this.getComponent();n.aabb=new $L;var i=[],r=[],o=0;t.forEach((function(e){var t=e.aabb,s=e.indices,a=e.vertexCount,l=e.attributes;n.aabb.add(t),n.vertexCount+=a,s&&r.push.apply(r,q(s.map((function(e){return e+o})))),o+=a,l.forEach((function(e,t){i[t]?e.data&&(LI(e.data)?i[t].push(e.data):zT(e.data)?i[t].data=function(e,t){if(!e&&!t)throw new Error("Please specify valid arguments for parameters a and b.");if(!t||0===t.length)return e;if(!e||0===e.length)return t;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(t))throw new Error("The types of the two arguments passed for parameters a and b do not match.");var n=new e.constructor(e.length+t.length);return n.set(e),n.set(t,e.length),n}(i[t].data,e.data):i[t].data=i[t].data.concat(e.data)):(i[t]=e,i[t].dirty=!0)}))})),n.attributes=i,n.indices=Uint32Array.from(r),n.dirty=!0}}]),n}())||jA;function YA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var XA,ZA=qk()(qA=function(e){z(n,kT);var t=YA(n);function n(){return F(this,n),t.apply(this,arguments)}return P(n,[{key:"onEntityCreated",value:function(){for(var e=this.config,t=e.halfExtents,n=void 0===t?[.5,.5]:t,i=e.widthSegments,r=void 0===i?5:i,o=e.lengthSegments,s=void 0===o?5:o,a=[],l=[],c=[],u=[],h=0,d=0;d<=r;d++)for(var f=0;f<=s;f++){var g=-n[0]+2*n[0]*d/r,p=-(-n[1]+2*n[1]*f/s),m=d/r,v=f/s;a.push(g,0,p),l.push(0,1,0),c.push(m,v),d<r&&f<s&&(u.push(h+s+1,h+1,h),u.push(h+s+1,h+s+2,h+1)),h++}var y=pI(a),_=this.getComponent();_.indices=Uint32Array.from(u),_.aabb=y,_.vertexCount=h,_.attributes=[{dirty:!0,name:"position",data:Float32Array.from(a),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(l),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(c),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}())||qA;function QA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var JA,eO,tO,nO,iO,rO,oO,sO=qk()(XA=function(e){z(n,kT);var t=QA(n);function n(){return F(this,n),t.apply(this,arguments)}return P(n,[{key:"onEntityCreated",value:function(){for(var e=this.config,t=e.radius,n=void 0===t?.5:t,i=e.latitudeBands,r=void 0===i?16:i,o=e.longitudeBands,s=void 0===o?16:o,a=[],l=[],c=[],u=[],h=0;h<=r;h++)for(var d=h*Math.PI/r,f=Math.sin(d),g=Math.cos(d),p=0;p<=s;p++){var m=2*p*Math.PI/s-Math.PI/2,v=Math.sin(m),y=Math.cos(m)*f,_=g,b=v*f,w=1-p/s,C=1-h/r;a.push(y*n,_*n,b*n),l.push(y,_,b),c.push(w,C)}for(var S=0;S<r;++S)for(var x=0;x<s;++x){var E=S*(s+1)+x,k=E+s+1;u.push(E+1,k,E),u.push(E+1,k+1,k)}var L=pI(a),D=this.getComponent();D.indices=Uint32Array.from(u),D.aabb=L,D.vertexCount=a.length/3,D.attributes=[{dirty:!0,name:"position",data:Float32Array.from(a),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(l),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(c),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}())||XA;function aO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var lO,cO,uO,hO,dO,fO,gO,pO,mO,vO,yO,_O=(JA=qk(),eO=fk(Yk.RenderEngine),tO=fk(Yk.ShaderModuleService),JA((rO=xE((iO=function(e){z(n,EM);var t=aO(n);function n(){var e;F(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return SE(e=t.call.apply(t,[this].concat(r)),"engine",rO,G(e)),SE(e,"shaderModuleService",oO,G(e)),e}return P(n,[{key:"onEntityCreated",value:function(){var e=this.getComponent(),t=this.engine.supportWebGPU?"layout(set = 0, binding = 0) uniform Uniforms {\n  vec4 color;\n  mat4 projectionMatrix;\n  mat4 modelViewMatrix;\n} uniforms;\n\nlayout(location = 0) in vec3 position;\n// layout(location = 1) in vec3 barycentric;\n\nlayout(location = 0) out vec4 fragColor;\n// layout(location = 1) out vec3 v_Barycentric;\n\nvoid main() {\n  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);\n  fragColor = uniforms.color;\n  // v_Barycentric = barycentric;\n}":'attribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform vec4 color;\n\nvarying vec4 fragColor;\n\n#pragma include "uv.vert.declaration"\n\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  fragColor = color;\n\n  #pragma include "uv.vert.main"\n}',n=this.engine.supportWebGPU?"// layout(set = 0, binding = 1) uniform WireframeUniforms {\n//   float lineWidth;\n//   vec4 lineColor;\n// } wireframe;\n\nlayout(location = 0) in vec4 fragColor;\n// layout(location = 1) in vec3 v_Barycentric;\n\nlayout(location = 0) out vec4 outColor;\n\n// wireframe\n// float edgeFactor() {\n//   vec3 d = fwidth(v_Barycentric);\n//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);\n//   return min(min(a3.x, a3.y), a3.z);\n// }\n\nvoid main() {\n  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));\n  outColor = fragColor;\n}":'varying vec4 fragColor;\n\n#pragma include "uv.frag.declaration"\n#pragma include "map.frag.declaration"\n\nvoid main() {\n  vec4 diffuseColor = fragColor;\n\n  #pragma include "map.frag.main"\n\n  gl_FragColor = diffuseColor;\n}';this.shaderModuleService.registerModule("material-basic",{vs:t,fs:n});var i=this.shaderModuleService.getModule("material-basic"),r=i.vs,o=i.fs,s=i.uniforms;e.vertexShaderGLSL=r,e.fragmentShaderGLSL=o,e.setUniform(s),this.config.map&&(e.setDefines({USE_UV:1,USE_MAP:1}),e.setUniform({map:this.config.map,uvTransform:Io()}))}}]),n}()).prototype,"engine",[eO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oO=xE(iO.prototype,"shaderModuleService",[tO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nO=iO))||nO);function bO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var wO=(lO=qk(),cO=fk(Yk.Systems),uO=$k(Yk.MaterialSystem),hO=fk(Yk.Systems),dO=$k(Yk.GeometrySystem),fO=fk(Yk.ShaderModuleService),lO((mO=xE((pO=function(e){z(n,kM);var t=bO(n);function n(){var e;F(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return SE(e=t.call.apply(t,[this].concat(r)),"materialSystem",mO,G(e)),SE(e,"geometrySystem",vO,G(e)),SE(e,"shaderModuleService",yO,G(e)),e}return P(n,[{key:"onAttributeChanged",value:function(e){var t=e.name,n=e.data,i=this.getMeshComponent();i&&i.material&&("gridColor"===t?(i.material.setUniform("u_GridColor",n),i.material.setUniform("u_GridColor2",n)):"gridSize"===t&&(i.material.setUniform("u_GridSize",n),i.material.setUniform("u_GridSize2",n)))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:"attribute vec3 a_Position;\n\nvarying vec3 v_Position;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvoid main() {\n  v_Position = a_Position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);\n}",fs:"// generate grid, borrow from clay.gl viewer\n// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl\n#extension GL_OES_standard_derivatives : enable\n\nvarying vec3 v_Position;\n// varying vec3 v_Normal;\n\nuniform float u_GridSize : 5;\nuniform float u_GridSize2 : .5;\nuniform vec4 u_GridColor : [0, 0, 0, 1];\nuniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];\nuniform bool u_GridEnabled : true;\n\n// uniform vec3 u_LightDirection;\n// uniform vec3 u_LightColor;\n// uniform vec3 u_Camera;\n\nvoid main() {\n  // vec3 n = v_Normal;\n  // vec3 l = normalize(u_LightDirection);\n  // float NdotL = clamp(dot(n, l), 0.001, 1.0);\n\n  gl_FragColor = vec4(1.);\n\n  if (u_GridEnabled) {\n    float wx = v_Position.x;\n    float wz = v_Position.z;\n    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;\n    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;\n\n    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;\n    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;\n\n    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);\n    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);\n    // if (v0 > 0.1) {\n        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);\n    // }\n    // else {\n        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);\n    // }\n  }\n\n  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);\n  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;\n\n  // gl_FragColor.rgb *= diffuseColor;\n}"});var e=this.shaderModuleService.getModule("grid"),t=e.vs,n=e.fs,i=e.uniforms,r=this.materialSystem.createShaderMaterial({vertexShader:t,fragmentShader:n});this.setMaterial(r);var o=this.geometrySystem.createBufferGeometry({vertexCount:4});this.setGeometry(o),r.setCull({enable:!1,face:vL.BACK}).setDepth({enable:!0,func:vL.LESS}),r.setUniform(i),this.setAttributes({gridColor:this.config.gridColor,gridSize:this.config.gridSize}),o.setIndex([0,3,2,2,1,0]),o.setAttribute("a_Position",Float32Array.from([-4,-1,-4,4,-1,-4,4,-1,4,-4,-1,4]),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})}}]),n}()).prototype,"materialSystem",[cO,uO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vO=xE(pO.prototype,"geometrySystem",[hO,dO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yO=xE(pO.prototype,"shaderModuleService",[fO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gO=pO))||gO),CO=function(){var e=new Float32Array(2);return e[0]=0,e[1]=0,e};var SO=function(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t};var xO=function(e,t){var n=new Float32Array(2);return n[0]=e,n[1]=t,n};var EO=function(e,t){return e[0]=t[0],e[1]=t[1],e};var kO=function(e,t,n){return e[0]=t,e[1]=n,e};var LO=function(e,t){var n=e[0],i=e[1],r=t[0],o=t[1];return Math.abs(n-r)<=1e-6*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-o)<=1e-6*Math.max(1,Math.abs(i),Math.abs(o))};var DO=function(e,t){return e[0]===t[0]&&e[1]===t[1]};var NO=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e};var IO=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e};var TO=IO,MO=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e};var AO=MO,OO=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e};var RO=OO,PO=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e};var FO=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e};var BO=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e};var WO=function(e,t,n){var i=Math.cos(n),r=Math.sin(n),o=t[0],s=t[1];return e[0]=o*i-s*r,e[1]=o*r+s*i,e};var zO=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e};var VO=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e};var UO=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e};var HO=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e};var jO=function(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e};var GO=function(e,t){var n=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(n*n+i*i)};var KO=GO,qO=function(e,t){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i};var $O=qO,YO=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)};var XO=YO,ZO=function(e){var t=e[0],n=e[1];return t*t+n*n};var QO=ZO,JO=function(e,t){return e[0]=-t[0],e[1]=-t[1],e};var eR=function(e,t){var n=t[0],i=t[1],r=n*n+i*i;r>0&&(r=1/Math.sqrt(r),e[0]=t[0]*r,e[1]=t[1]*r);return e};var tR=function(e,t){return e[0]*t[0]+e[1]*t[1]};var nR=function(e,t,n){var i=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=i,e};var iR=function(e,t,n,i){var r=t[0],o=t[1];return e[0]=r+i*(n[0]-r),e[1]=o+i*(n[1]-o),e};var rR=function(e,t){t=t||1;var n=2*Math.random()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e};var oR=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[2]*r,e[1]=n[1]*i+n[3]*r,e};var sR=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[2]*r+n[4],e[1]=n[1]*i+n[3]*r+n[5],e};var aR=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[3]*r+n[6],e[1]=n[1]*i+n[4]*r+n[7],e};var lR=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[4]*r+n[12],e[1]=n[1]*i+n[5]*r+n[13],e};var cR=function(e,t,n,i,r,o){var s,a;t||(t=2);n||(n=0);a=i?Math.min(i*t+n,e.length):e.length;for(s=n;s<a;s+=t)uR[0]=e[s],uR[1]=e[s+1],r(uR,uR,o),e[s]=uR[0],e[s+1]=uR[1];return e},uR=CO();var hR,dR,fR,gR,pR,mR,vR,yR,_R,bR,wR,CR={EPSILON:1e-6,create:CO,clone:SO,fromValues:xO,copy:EO,set:kO,equals:LO,exactEquals:DO,add:NO,subtract:IO,sub:TO,multiply:MO,mul:AO,divide:OO,div:RO,inverse:PO,min:FO,max:BO,rotate:WO,floor:zO,ceil:VO,round:UO,scale:HO,scaleAndAdd:jO,distance:GO,dist:KO,squaredDistance:qO,sqrDist:$O,length:YO,len:XO,squaredLength:ZO,sqrLen:QO,negate:JO,normalize:eR,dot:tR,cross:nR,lerp:iR,random:rR,transformMat2:oR,transformMat2d:sR,transformMat3:aR,transformMat4:lR,forEach:cR,limit:function(e,t,n){var i=t[0]*t[0]+t[1]*t[1];if(i>n*n){var r=Math.sqrt(i);e[0]=t[0]/r*n,e[1]=t[1]/r*n}else e[0]=t[0],e[1]=t[1];return e}},SR=NO,xR=kO,ER=eR,kR=IO,LR=tR,DR=[0,0],NR=function(e,t,n,i,r){return SR(e,n,i),ER(e,e),xR(t,-e[1],e[0]),xR(DR,-n[1],n[0]),r/LR(t,DR)},IR=function(e,t){return xR(e,-t[1],t[0]),e},TR=function(e,t,n){return kR(e,t,n),ER(e,e),e};function MR(e,t,n,i,r){AR(t,i,-r),AR(t,i,r),e.push(n),e.push(n)}function AR(e,t,n){e.push([[t[0],t[1]],n])}function OR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var RR,PR,FR,BR,WR,zR,VR,UR,HR,jR,GR,KR=(hR=qk(),dR=fk(Yk.Systems),fR=$k(Yk.MaterialSystem),gR=fk(Yk.Systems),pR=$k(Yk.GeometrySystem),mR=fk(Yk.ShaderModuleService),hR((_R=xE((yR=function(e){z(n,kM);var t=OR(n);function n(){var e;F(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return SE(e=t.call.apply(t,[this].concat(r)),"materialSystem",_R,G(e)),SE(e,"geometrySystem",bR,G(e)),SE(e,"shaderModuleService",wR,G(e)),e.vertexCount=void 0,e}return P(n,[{key:"onAttributeChanged",value:function(e){var t=e.name,n=e.data,i=this.getMeshComponent();if(i&&i.material)switch(t){case"dashArray":i.material.setUniform("u_dash_array",n);break;case"dashOffset":i.material.setUniform("u_dash_offset",n);break;case"dashRatio":i.material.setUniform("u_dash_ratio",n);break;case"thickness":i.material.setUniform("u_thickness",n);break;case"color":var r=new Array(this.vertexCount).fill(void 0).map((function(){return n})).reduce((function(e,t){return[].concat(q(e),q(t))}),[]);i.geometry.setAttribute("a_color",Float32Array.from(r),{arrayStride:16,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]})}}},{key:"onEntityCreated",value:function(){var e=this;this.shaderModuleService.registerModule("line",{vs:"attribute vec2 a_pos;\nattribute vec4 a_color;\nattribute float a_line_miter;\nattribute vec2 a_line_normal;\nattribute float a_counters;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform float u_thickness : 0.02;\nuniform vec2 u_viewport;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_counters;\n\nvoid main() {\n  v_color = a_color;\n  v_counters = a_counters;\n\n  vec3 normal = normalize(vec3(a_line_normal, 0.0));\n\n  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);\n\n  v_normal = vec2(normal * sign(a_line_miter));\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;\n}\n",fs:"uniform float u_dash_array : 0.02;\nuniform float u_dash_offset : 0;\nuniform float u_dash_ratio : 0;\nuniform float u_thickness : 0.02;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_counters;\n\nvoid main() {\n    float blur = 1. - smoothstep(0.98, 1., length(v_normal));\n\n    gl_FragColor = v_color;\n    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));\n}"});var t=this.shaderModuleService.getModule("line"),n=t.vs,i=t.fs,r=t.uniforms,o=this.materialSystem.createShaderMaterial({vertexShader:n,fragmentShader:i}),s=function(e,t,n){var i=[0,0],r=[0,0],o=[0,0],s=[0,0],a=-1,l=!1,c=null,u=CR.create(),h=n||0,d=[],f=[],g=[],p=[0,0];t&&(e=e.slice()).push(e[0]);for(var m=e.length,v=1;v<m;v++){var y=h,_=e[v-1],b=e[v],w=v<e.length-1?e[v+1]:null;if(p.push(v/m,v/m),TR(i,b,_),c||IR(c=[0,0],i),l||(l=!0,MR(f,d,_,c,1)),g.push([y+0,y+1,y+2]),w){TR(r,w,b);var C=NR(o,s,i,r,1),S=CR.dot(o,c)<0?-1:1,x=C>3;if(!isFinite(C)){IR(c,i),MR(f,d,b,c,1),g.push(1===a?[y,y+2,y+3]:[y+2,y+1,y+3]),h+=2,a=S;continue}x?(C=3,p.push(v/m),AR(d,c,-S),f.push(b),AR(d,s,C*S),f.push(b),g.push(a!==-S?[y,y+2,y+3]:[y+2,y+1,y+3]),g.push([y+2,y+3,y+4]),IR(u,r),CR.copy(c,u),AR(d,c,-S),f.push(b),h+=3):(MR(f,d,b,s,C),g.push(1===a?[y,y+2,y+3]:[y+2,y+1,y+3]),S=-1,CR.copy(c,s),h+=2),a=S}else IR(c,i),MR(f,d,b,c,1),g.push(1===a?[y,y+2,y+3]:[y+2,y+1,y+3]),h+=2}return{normals:d,attrIndex:g,attrPos:f,attrCounters:p}}(this.config.points,!1),a=s.normals,l=s.attrIndex,c=s.attrPos,u=s.attrCounters,h=c.length;this.vertexCount=h;var d=this.geometrySystem.createBufferGeometry({vertexCount:h});this.setMaterial(o),this.setGeometry(d),o.setCull({enable:!1,face:vL.BACK}).setUniform(r),this.setAttributes({dashArray:this.config.dashArray,dashOffset:this.config.dashOffset,dashRatio:this.config.dashRatio,thickness:this.config.thickness});var f=[],g=[];a.forEach((function(e){var t=e[0],n=e[1];f.push([t[0],t[1]]),g.push(n)})),d.setIndex(l.reduce((function(e,t){return[].concat(q(e),q(t))}),[])),d.setAttribute("a_pos",Float32Array.from(c.reduce((function(e,t){return[].concat(q(e),q(t))}),[])),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]});var p=new Array(h).fill(void 0).map((function(){return q(e.config.color)})).reduce((function(e,t){return[].concat(q(e),q(t))}),[]);d.setAttribute("a_color",Float32Array.from(p),{arrayStride:16,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]}),d.setAttribute("a_line_miter",Float32Array.from(g),{arrayStride:4,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float"}]}),d.setAttribute("a_line_normal",Float32Array.from(f.reduce((function(e,t){return[].concat(q(e),q(t))}),[])),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:3,offset:0,format:"float2"}]}),d.setAttribute("a_counters",Float32Array.from(u),{arrayStride:4,stepMode:"vertex",attributes:[{shaderLocation:4,offset:0,format:"float"}]})}}]),n}()).prototype,"materialSystem",[dR,fR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bR=xE(yR.prototype,"geometrySystem",[gR,pR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wR=xE(yR.prototype,"shaderModuleService",[mR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vR=yR))||vR);function qR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=V(e);if(t){var r=V(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return U(this,n)}}var YR,XR,ZR,QR,JR,eP,tP,nP,iP,rP=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],oP=(RR=qk(),PR=fk(Yk.Systems),FR=$k(Yk.MaterialSystem),BR=fk(Yk.Systems),WR=$k(Yk.GeometrySystem),zR=fk(Yk.ShaderModuleService),RR((HR=xE((UR=function(e){z(n,kM);var t=$R(n);function n(){var e;F(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return SE(e=t.call.apply(t,[this].concat(r)),"materialSystem",HR,G(e)),SE(e,"geometrySystem",jR,G(e)),SE(e,"shaderModuleService",GR,G(e)),e}return P(n,[{key:"onAttributeChanged",value:function(e){var t=e.name,n=e.data,i=this.getMeshComponent();i&&i.material&&("strokeWidth"===t?i.material.setUniform("u_stroke_width",n):"strokeColor"===t?i.material.setUniform("u_stroke_color",n):"strokeOpacity"===t?i.material.setUniform("u_stroke_opacity",n):"opacity"===t?i.material.setUniform("u_opacity",n):"blur"===t&&i.material.setUniform("u_blur",n))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:'attribute vec2 position;\nattribute vec4 color;\nattribute float shape;\nattribute vec2 offset;\nattribute float size;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nuniform float u_stroke_width : 0.01;\nuniform float u_device_pixel_ratio;\nuniform vec2 u_viewport;\n\nvarying vec4 v_color;\nvarying vec4 v_data;\nvarying float v_radius;\n\n#pragma include "picking"\n\nvoid main() {\n  v_color = color;\n  v_radius = size;\n\n  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);\n\n  // construct point coords\n  v_data = vec4(position, antialiasblur, shape);\n\n  gl_Position = projectionMatrix * modelViewMatrix\n    * vec4(position * size + offset, 0.0, 1.0);\n\n  setPickingColor(a_PickingColor);\n}',fs:"uniform float u_blur : 0.05;\nuniform float u_opacity : 0.7;\nuniform float u_stroke_width : 0.01;\nuniform vec4 u_stroke_color : [0, 0, 0, 0];\nuniform float u_stroke_opacity : 1;\n\nvarying vec4 v_color;\nvarying vec4 v_data;\nvarying float v_radius;\n\n#pragma include \"sdf2d\"\n#pragma include \"picking\"\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  // if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  // } else if (shape == 1) {\n  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  // } else if (shape == 2) {\n  //   outer_df = sdBox(v_data.xy, vec2(1.));\n  //   inner_df = sdBox(v_data.xy, vec2(r));\n  // } else if (shape == 3) {\n  //   outer_df = sdPentagon(v_data.xy, 0.8);\n  //   inner_df = sdPentagon(v_data.xy, r * 0.8);\n  // } else if (shape == 4) {\n  //   outer_df = sdHexagon(v_data.xy, 0.8);\n  //   inner_df = sdHexagon(v_data.xy, r * 0.8);\n  // } else if (shape == 5) {\n  //   outer_df = sdOctogon(v_data.xy, 1.0);\n  //   inner_df = sdOctogon(v_data.xy, r);\n  // } else if (shape == 6) {\n  //   outer_df = sdHexagram(v_data.xy, 0.52);\n  //   inner_df = sdHexagram(v_data.xy, r * 0.52);\n  // } else if (shape == 7) {\n  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));\n  //   inner_df = sdRhombus(v_data.xy, vec2(r));\n  // } else if (shape == 8) {\n  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  // }\n\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;\n\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}"});var e=this.shaderModuleService.getModule("grid"),t=e.vs,n=e.fs,i=e.uniforms,r=this.materialSystem.createShaderMaterial({vertexShader:t,fragmentShader:n,cull:{enable:!1},depth:{enable:!1},blend:{enable:!0,func:{srcRGB:vL.SRC_ALPHA,dstRGB:vL.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}});r.setUniform(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qR(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({u_device_pixel_ratio:window.devicePixelRatio},i));var o=this.buildAttributes(),s=this.geometrySystem.createInstancedBufferGeometry({maxInstancedCount:o.instancedOffsets.length/2,vertexCount:6});s.setIndex([0,2,1,0,3,2]),s.setAttribute("position",Float32Array.from(o.positions),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]}),s.setAttribute("offset",Float32Array.from(o.instancedOffsets),{arrayStride:8,stepMode:"instance",attributes:[{shaderLocation:1,offset:0,format:"float2"}]}),s.setAttribute("color",Float32Array.from(o.instancedColors),{arrayStride:16,stepMode:"instance",attributes:[{shaderLocation:2,offset:0,format:"float4"}]}),s.setAttribute("size",Float32Array.from(o.instancedSizes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:3,offset:0,format:"float"}]}),s.setAttribute("shape",Float32Array.from(o.instancedShapes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:4,offset:0,format:"float"}]}),s.setAttribute("a_PickingColor",Float32Array.from(o.instancedPickingColors),{arrayStride:12,stepMode:"instance",attributes:[{shaderLocation:6,offset:0,format:"float3"}]}),this.setMaterial(r),this.setGeometry(s)}},{key:"buildAttribute",value:function(e,t,n){var i,r,o,s,a;(i=t.instancedPickingColors).push.apply(i,q([(a=e.id||n)+1&255,a+1>>8&255,a+1>>8>>8&255])),t.instancedShapes.push(rP.indexOf(e.shape||"circle")),(r=t.instancedColors).push.apply(r,q(e.color||[1,0,0,1])),(o=t.instancedOffsets).push.apply(o,q(e.position||[0,0])),(s=t.instancedSizes).push.apply(s,q(e.size||[.2,.2]))}},{key:"buildAttributes",value:function(){var e=this,t={positions:[1,1,1,-1,-1,-1,-1,1],instancedOffsets:[],instancedColors:[],instancedSizes:[],instancedShapes:[],instancedPickingColors:[]};return Array.isArray(this.config)?this.config.forEach((function(n,i){e.buildAttribute(n,t,i)})):this.buildAttribute(this.config,t,0),t}}]),n}()).prototype,"materialSystem",[PR,FR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jR=xE(UR.prototype,"geometrySystem",[BR,WR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GR=xE(UR.prototype,"shaderModuleService",[zR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VR=UR))||VR);function sP(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return aP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aP(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function aP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var lP,cP,uP,hP,dP,fP,gP,pP,mP,vP=(YR=qk(),XR=fk(Yk.RenderEngine),ZR=fk(Yk.ShaderModuleService),QR=fk(Yk.ConfigService),YR((tP=xE((eP=function(){function e(){F(this,e),this.container=void 0,SE(this,"engine",tP,this),SE(this,"shaderModule",nP,this),SE(this,"configService",iP,this),this.inited=!1,this.rendering=!1,this.pendings=[],this.views=[],this.size=void 0}var t,n;return P(e,[{key:"init",value:(n=B(W.mark((function e(){var t,n,i,r,o;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shaderModule.registerBuiltinModules(),this.shaderModule.registerModule("uv.vert.declaration",{vs:"#ifdef USE_UV\n  attribute vec2 uv;\n\t#ifdef UVS_VERTEX_ONLY\n    vec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif"}),this.shaderModule.registerModule("uv.vert.main",{vs:"#ifdef USE_UV\n  vUv = (uvTransform * vec3(uv, 1)).xy;\n#endif"}),this.shaderModule.registerModule("uv.frag.declaration",{fs:"#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))\n  varying vec2 vUv;\n#endif"}),this.shaderModule.registerModule("map.frag.declaration",{fs:"#ifdef USE_MAP\n  uniform sampler2D map;\n#endif"}),this.shaderModule.registerModule("map.frag.main",{fs:"#ifdef USE_MAP\n  vec4 texelColor = texture2D(map, vUv);\n  // texelColor = mapTexelToLinear(texelColor);\n  diffuseColor *= texelColor;\n#endif"}),t=this.container.getAll(Yk.Systems),!(n=this.configService.get()).canvas){e.next=30;break}return e.next=11,this.engine.init({canvas:n.canvas,swapChainFormat:LT.TextureFormat.BGRA8Unorm,antialiasing:!1});case 11:i=sP(t),e.prev=12,i.s();case 14:if((r=i.n()).done){e.next=21;break}if(!(o=r.value).initialize){e.next=19;break}return e.next=19,o.initialize();case 19:e.next=14;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(12),i.e(e.t0);case 26:return e.prev=26,i.f(),e.finish(26);case 29:this.inited=!0;case 30:case"end":return e.stop()}}),e,this,[[12,23,26,29]])}))),function(){return n.apply(this,arguments)})},{key:"render",value:(t=B(W.mark((function e(){var t,n,i,r,o,s,a,l=arguments;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inited&&!this.rendering){e.next=2;break}return e.abrupt("return");case 2:for(this.pendings.length&&this.pendings.forEach((function(e){e()})),this.rendering=!0,this.engine.beginFrame(),t=this.container.getAll(Yk.Systems),n=l.length,i=new Array(n),r=0;r<n;r++)i[r]=l[r];o=sP(t),e.prev=8,o.s();case 10:if((s=o.n()).done){e.next=17;break}if(!(a=s.value).execute){e.next=15;break}return e.next=15,a.execute(i);case 15:e.next=10;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(8),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:this.engine.endFrame(),this.rendering=!1;case 27:case"end":return e.stop()}}),e,this,[[8,19,22,25]])}))),function(){return t.apply(this,arguments)})},{key:"clear",value:function(e){var t=this;return this.inited?this.engine.clear(e):this.pendings.unshift((function(){t.engine.clear(e),t.pendings.shift()})),this}},{key:"setSize",value:function(e){var t=e.width,n=e.height,i=this.engine.getCanvas();return this.size={width:t,height:n},i.width=t,i.height=n,this}},{key:"getSize",value:function(){return this.size}}]),e}()).prototype,"engine",[XR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nP=xE(eP.prototype,"shaderModule",[ZR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iP=xE(eP.prototype,"configService",[QR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JR=eP))||JR),yP=qk()(lP=function(){function e(){F(this,e),this.entities=[]}return P(e,[{key:"getEntities",value:function(){return this.entities}},{key:"addRenderable",value:function(e){return this.addEntity(e.getEntity()),this}},{key:"removeRenderable",value:function(e){return this.removeEntity(e.getEntity()),this}},{key:"addLight",value:function(){}},{key:"addEntity",value:function(e){return-1===this.entities.indexOf(e)&&this.entities.push(e),this}},{key:"removeEntity",value:function(e){var t=this.entities.indexOf(e);return this.entities.splice(t,1),this}}]),e}())||lP,_P=qk()(cP=function(){function e(){F(this,e),this.cache={}}return P(e,[{key:"get",value:function(e){return this.cache[e]}},{key:"set",value:function(e,t){this.cache[e]=t}}]),e}())||cP;function bP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function wP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bP(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bP(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var CP,SP,xP,EP,kP,LP,DP,NP,IP,TP,MP,AP=(uP=qk(),hP=fk(_P),dP=fk(Yk.RenderEngine),uP((pP=xE((gP=function(){function e(){F(this,e),SE(this,"textureCache",pP,this),SE(this,"engine",mP,this),this.config=void 0,this.loaded=!1,this.texture=void 0}var t;return P(e,[{key:"setConfig",value:function(e){this.config=e}},{key:"isLoaded",value:function(){return this.loaded}},{key:"load",value:(t=B(W.mark((function e(){var t=this;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.config.url){e.next=4;break}return e.abrupt("return",new Promise((function(e,n){var i=t.textureCache.get(t.config.url);if(i)e(i);else{var r=new Image;r.crossOrigin="Anonymous",r.src=t.config.url,r.onload=function(){var n=t.engine.createTexture2D(wP(wP({},t.config),{},{data:r,width:r.width,height:r.height,flipY:!0}));t.textureCache.set(t.config.url,n),t.texture=n,t.loaded=!0,e(n)},r.onerror=function(){n()}}})));case 4:return this.loaded=!0,this.texture=this.engine.createTexture2D(this.config),e.abrupt("return",this.texture);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()).prototype,"textureCache",[hP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mP=xE(gP.prototype,"engine",[dP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fP=gP))||fP),OP=(CP=qk(),SP=fk(Yk.Systems),xP=$k(Yk.RendererSystem),CP((LP=xE((kP=function(){function e(){F(this,e),SE(this,"rendererSystem",LP,this),this.camera=void 0,this.scene=void 0,this.viewport={x:0,y:0,width:0,height:0},this.clearColor=[1,1,1,1]}return P(e,[{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getViewport",value:function(){return this.viewport}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setCamera",value:function(e){return this.camera=e,this}},{key:"setScene",value:function(e){return this.scene=e,this}},{key:"setViewport",value:function(e){return this.viewport=e,this}},{key:"setClearColor",value:function(e){return this.clearColor=e,this}},{key:"pick",value:function(e){return this.rendererSystem.pick(e,this)}}]),e}()).prototype,"rendererSystem",[SP,xP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EP=kP))||EP);function RP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function PP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RP(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RP(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var FP=(DP=qk(),NP=fk(Yk.ConfigService),DP((MP=xE((TP=function(){function e(){F(this,e),SE(this,"configService",MP,this),this.container=void 0}var t;return P(e,[{key:"getEngine",value:(t=B(W.mark((function e(){var t,n,i,r;return W.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.container.get(Yk.RenderEngine),n=this.configService.get(),i=n.canvas,r=n.engineOptions,e.next=4,t.init(PP({canvas:i||DT(),swapChainFormat:LT.TextureFormat.BGRA8Unorm,antialiasing:!1},r));case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getTransformComponent",value:function(e){return this.container.get(Yk.TransformComponentManager).getComponentByEntity(e)}},{key:"getMeshComponent",value:function(e){return this.container.get(Yk.MeshComponentManager).getComponentByEntity(e)}},{key:"setConfig",value:function(e){this.configService.set(e)}},{key:"setContainer",value:function(e){this.container=e}},{key:"getContainer",value:function(){return this.container}},{key:"createEntity",value:function(){return DE()}},{key:"createScene",value:function(){return this.container.get(yP)}},{key:"createCamera",value:function(){return this.container.get(ET)}},{key:"createView",value:function(){return this.container.get(OP)}},{key:"createRenderable",value:function(e,t){var n=e?this.container.getNamed(Yk.Renderable,e):this.container.get(kM),i=DE();return n.setConfig(t||{}),n.setEntity(i),n}},{key:"createGeometry",value:function(e,t){var n=this.container.getNamed(Yk.Geometry,e),i=DE();return n.setConfig(t||{}),n.setEntity(i),n.getComponent()}},{key:"createMaterial",value:function(e,t){var n=this.container.getNamed(Yk.Material,e),i=DE();return n.setConfig(t||{}),n.setEntity(i,e),n.getComponent()}},{key:"createTexture2D",value:function(e){var t=this.container.get(AP);return t.setConfig(e),t}},{key:"createBufferGeometry",value:function(e){return this.container.getNamed(Yk.Systems,Yk.GeometrySystem).createBufferGeometry(e)}},{key:"createInstancedBufferGeometry",value:function(e){return this.container.getNamed(Yk.Systems,Yk.GeometrySystem).createInstancedBufferGeometry(e)}},{key:"createShaderMaterial",value:function(e){return this.container.getNamed(Yk.Systems,Yk.MaterialSystem).createShaderMaterial(e)}},{key:"createKernel",value:function(e){var t=this.container.get(xM);return"string"==typeof e?t.setBundle(JSON.parse(e)):t.setBundle(e),t.init(),t}},{key:"createRenderer",value:function(){var e=this.container.get(vP);return e.container=this.container,e.init(),e}},{key:"destroy",value:function(){this.container.getAll(Yk.Systems).forEach((function(e){e.tearDown&&e.tearDown()})),this.container.get(Yk.RenderEngine).destroy(),this.container.get(Yk.InteractorService).destroy()}}],[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=gI(),i=navigator.gpu?UA:lA;n.isBound(Yk.RenderEngine)||n.bind(Yk.RenderEngine).to(i).inSingletonScope(),n.bind(vP).toSelf(),n.bind(xM).toSelf(),n.bind(kM).toSelf(),n.bind(OP).toSelf(),n.bind(ET).toSelf(),n.bind(yP).toSelf(),n.bind(e).toSelf(),n.bind(_P).toSelf(),n.bind(AP).toSelf(),n.bind(Yk.Geometry).to(GA).whenTargetNamed(kT.BOX),n.bind(Yk.Geometry).to(sO).whenTargetNamed(kT.SPHERE),n.bind(Yk.Geometry).to(ZA).whenTargetNamed(kT.PLANE),n.bind(Yk.Geometry).to($A).whenTargetNamed(kT.MERGED),n.bind(Yk.Material).to(_O).whenTargetNamed(EM.BASIC),n.bind(Yk.Renderable).to(oP).whenTargetNamed(kM.POINT),n.bind(Yk.Renderable).to(KR).whenTargetNamed(kM.LINE),n.bind(Yk.Renderable).to(wO).whenTargetNamed(kM.GRID);var r=n.get(e);return r.setContainer(n),r.setConfig(t),r}}]),e}()).prototype,"configService",[NP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IP=TP))||IP);const BP=(e,t)=>{let n;return n=e?_b(e)?()=>e:e:()=>t||1,n},WP=e=>{const t=[],n=e.length,i=e[0].length;for(let r=0;r<i;r++)e.forEach(((e,i)=>{if(t.push(e[r]),i===n-1)for(;t.length%4!=0;)t.push(0)}));return new Float32Array(t)};var zP=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class VP extends mb{constructor(e){super(),this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return zP(this,void 0,void 0,(function*(){const e=this,t=e.nodes;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());const i={},r={};t.forEach(((e,t)=>{_b(e.x)||(e.x=Math.random()*this.width),_b(e.y)||(e.y=Math.random()*this.height),i[e.id]=e,r[e.id]=t})),e.nodeMap=i,e.nodeIdxMap=r,yield e.run()}))}executeWithWorker(e,t){return zP(this,void 0,void 0,(function*(){const n=this,i=n.nodes,r=n.center;if(!i||0===i.length)return;if(1===i.length)return i[0].x=r[0],void(i[0].y=r[1]);const o={},s={};i.forEach(((e,t)=>{_b(e.x)||(e.x=Math.random()*this.width),_b(e.y)||(e.y=Math.random()*this.height),o[e.id]=e,s[e.id]=t})),n.nodeMap=o,n.nodeIdxMap=s,yield n.run(e,t)}))}run(e,t){return zP(this,void 0,void 0,(function*(){const n=this,i=n.nodes,r=n.edges,o=n.maxIteration,s=n.center,a=n.height*n.width;let l=Math.sqrt(a)/10;const c=a/(i.length+1),u=Math.sqrt(c),h=n.speed,d=n.clustering,{array:f,count:g}=((e,t)=>{const n=[],i=e.length,r={};return t.forEach((t=>{e.forEach(((e,o)=>{if(void 0===r[t[e]]&&(r[t[e]]=Object.keys(r).length),n.push(r[t[e]]),o===i-1)for(;n.length%4!=0;)n.push(0)}))})),{array:new Float32Array(n),count:Object.keys(r).length}})([n.clusterField],i);i.forEach(((e,t)=>{let n=0,i=0;_b(e.fx)&&_b(e.fy)&&(n=e.fx||.001,i=e.fy||.001),f[4*t+1]=n,f[4*t+2]=i}));const p=i.length,{maxEdgePerVetex:m,array:v}=((e,t)=>{const n=[],i=[],r={};let o=0;for(o=0;o<e.length;o++){const t=e[o];r[t.id]=o,n.push(t.x),n.push(t.y),n.push(0),n.push(0),i.push([])}for(o=0;o<t.length;o++){const e=t[o],n=Sb(e,"source"),s=Sb(e,"target");i[r[n]].push(r[s]),i[r[s]].push(r[n])}let s=0;for(o=0;o<e.length;o++){const e=n.length,t=i[o],r=t.length;n[4*o+2]=e,n[4*o+3]=t.length,s=Math.max(s,t.length);for(let i=0;i<r;++i){const e=t[i];n.push(+e)}}for(;n.length%4!=0;)n.push(0);return{maxEdgePerVetex:s,array:new Float32Array(n)}})(i,r);let y;y=n.workerEnabled?FP.create({canvas:e,engineOptions:{supportCompute:!0}}):FP.create({engineOptions:{supportCompute:!0}});const _=n.onLayoutEnd,b=[];for(let e=0;e<g;e++)b.push(0,0,0,0);const w=y.createKernel('{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_K : f32;\\n  [[offset 4]] u_K2 : f32;\\n  [[offset 8]] u_Center : vec2<f32>;\\n  [[offset 16]] u_Gravity : f32;\\n  [[offset 20]] u_ClusterGravity : f32;\\n  [[offset 24]] u_Speed : f32;\\n  [[offset 28]] u_MaxDisplace : f32;\\n  [[offset 32]] u_Clustering : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AttributeArray : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar param : f32 = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx = dx + param * xDist;\\ndy = dy + param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < j);\\ndx = dx + param * std::sign;\\ndy = dy + param * std::sign;}}}}\\nreturn vec2<f32>(dx, dy);}\\nfn calcGravity(currentNode : vec4<f32>, nodeAttributes : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar vx : f32 = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nvar vy : f32 = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nvar gf : f32 = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {var clusterIdx : i32 = i32(nodeAttributes.x);\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nvar cvx : f32 = currentNode.x - center.x;\\nvar cvy : f32 = currentNode.y - center.y;\\nvar dist : f32 = std::sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nvar parma : f32 = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx = dx + parma * cvx;\\ndy = dy + parma * cvy;}\\nreturn vec2<f32>(dx, dy);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar arr_offset : i32 = i32(std::floor(currentNode.z + 0.5));\\nvar length : i32 = i32(std::floor(currentNode.w + 0.5));\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + i32(p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = select(node_buffer.x, select(node_buffer.y, select(node_buffer.z, node_buffer.w, buf_offset == 2), buf_offset == 1), buf_offset == 0);\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar attractiveF : f32 = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx = dx - xDist * attractiveF;\\ndy = dy - yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < i32(float_j));\\ndx = dx - std::sign * attractiveF;\\ndy = dy - std::sign * attractiveF;}}}\\nreturn vec2<f32>(dx, dy);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nif (i >= __DefineValuePlaceholder__VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes : vec4<f32> = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\ndx = dx + repulsive.x;\\ndy = dy + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode);\\ndx = dx + attractive.x;\\ndy = dy + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(currentNode, nodeAttributes);\\ndx = dx - gravity.x;\\ndy = dy - gravity.y;\\ndx = dx * gWebGPUUniformParams.u_Speed;\\ndy = dy * gWebGPUUniformParams.u_Speed;\\nvar distLength : f32 = std::sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {var limitedDist : f32 = std::min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_K;\\n  float u_K2;\\n  vec2 u_Center;\\n  float u_Gravity;\\n  float u_ClusterGravity;\\n  float u_Speed;\\n  float u_MaxDisplace;\\n  float u_Clustering;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AttributeArray[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nvec2 calcRepulsive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {float dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nfloat vy = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nfloat gf = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= gWebGPUUniformParams.u_Speed;\\ndy *= gWebGPUUniformParams.u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([p,1,1]).setBinding({u_Data:v,u_K:u,u_K2:c,u_Gravity:n.gravity,u_ClusterGravity:n.clusterGravity||n.gravity||1,u_Speed:h,u_MaxDisplace:l,u_Clustering:d?1:0,u_Center:s,u_AttributeArray:f,u_ClusterCenters:b,MAX_EDGE_PER_VERTEX:m,VERTEX_COUNT:p});let C;d&&(C=y.createKernel('{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\n\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 0, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributes : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[i];\\nvar sumx : f32 = 0.0;\\nvar sumy : f32 = 0.0;\\nvar count : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var attributes : vec4<f32> = gWebGPUBuffer1.u_NodeAttributes[j];\\nvar clusterIdx : i32 = i32(attributes.x);\\nvar vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx = sumx + vertex.x;\\nsumy = sumy + vertex.y;\\ncount = count + 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4<f32>(sumx / count, sumy / count, count, i);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\n\\nlayout(std430, set = 0, binding = 0) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_NodeAttributes[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {int i = globalInvocationID.x;\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[i];\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = gWebGPUBuffer1.u_NodeAttributes[j];\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4(sumx / count, sumy / count, count, i);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([g,1,1]).setBinding({u_Data:v,u_NodeAttributes:f,u_ClusterCenters:b,VERTEX_COUNT:p,CLUSTER_COUNT:g}));yield(()=>zP(this,void 0,void 0,(function*(){for(let e=0;e<o;e++)yield w.execute(),d&&(C.setBinding({u_Data:w}),yield C.execute(),w.setBinding({u_ClusterCenters:C})),w.setBinding({u_MaxDisplace:l*=.99});const n=yield w.getOutput();e?t.postMessage({type:Tw,vertexEdgeData:n}):i.forEach(((e,t)=>{const i=n[4*t],r=n[4*t+1];e.x=i,e.y=r})),_&&_()})))()}))}getType(){return"fruchterman-gpu"}}var UP=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class HP extends mb{constructor(e){super(),this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return UP(this,void 0,void 0,(function*(){const e=this,t=e.nodes;if(!t||0===t.length)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());const i={},r={};t.forEach(((t,n)=>{_b(t.x)||(t.x=Math.random()*e.width),_b(t.y)||(t.y=Math.random()*e.height),i[t.id]=t,r[t.id]=n})),e.nodeMap=i,e.nodeIdxMap=r,e.nodeStrength=BP(e.nodeStrength,1),e.edgeStrength=BP(e.edgeStrength,1),yield e.run()}))}executeWithWorker(e,t){const n=this,i=n.nodes,r=n.center;if(!i||0===i.length)return;if(1===i.length)return i[0].x=r[0],void(i[0].y=r[1]);const o={},s={};i.forEach(((e,t)=>{_b(e.x)||(e.x=Math.random()*n.width),_b(e.y)||(e.y=Math.random()*n.height),o[e.id]=e,s[e.id]=t})),n.nodeMap=o,n.nodeIdxMap=s,n.nodeStrength=BP(n.nodeStrength,1),n.edgeStrength=BP(n.edgeStrength,1),n.run(e,t)}run(e,t){return UP(this,void 0,void 0,(function*(){const n=this,i=n.nodes,r=n.edges,o=n.maxIteration;n.width||"undefined"==typeof window||(n.width=window.innerWidth),n.height||"undefined"==typeof window||(n.height=window.innerHeight);const s=i.length;n.linkDistance=BP(n.linkDistance),n.edgeStrength=BP(n.edgeStrength);const{maxEdgePerVetex:a,array:l}=((e,t,n,i)=>{const r=[],o=[],s={};let a=0;for(a=0;a<e.length;a++){const t=e[a];s[t.id]=a,r.push(t.x),r.push(t.y),r.push(0),r.push(0),o.push([])}for(a=0;a<t.length;a++){const e=t[a],r=Sb(e,"source"),l=Sb(e,"target");o[s[r]].push(s[l]),o[s[r]].push(n(e)),o[s[r]].push(i(e)),o[s[r]].push(0),o[s[l]].push(s[r]),o[s[l]].push(n(e)),o[s[l]].push(i(e)),o[s[l]].push(0)}let l=0;for(a=0;a<e.length;a++){const e=r.length,t=o[a],n=t.length;r[4*a+2]=e+1048576*n/4,r[4*a+3]=0,l=Math.max(l,n/4);for(let i=0;i<n;++i){const e=t[i];r.push(+e)}}for(;r.length%4!=0;)r.push(0);return{maxEdgePerVetex:l,array:new Float32Array(r)}})(i,r,n.linkDistance,n.edgeStrength);n.degrees=xb(i.length,n.nodeIdxMap,r);const c=[],u=[],h=[],d=[],f=[],g=[],p=[];n.getMass||(n.getMass=e=>n.degrees[n.nodeIdxMap[e.id]]||1);const m=n.gravity,v=n.center;i.forEach(((e,t)=>{c.push(n.getMass(e)),u.push(n.nodeStrength(e)),n.degrees[t]||(n.degrees[t]=0);let i=[v[0],v[1],m];if(n.getCenter){const r=n.getCenter(e,n.degrees[t]);r&&_b(r[0])&&_b(r[1])&&_b(r[2])&&(i=r)}h.push(i[0]),d.push(i[1]),f.push(i[2]),_b(e.fx)&&_b(e.fy)?(g.push(e.fx||.001),p.push(e.fy||.001)):(g.push(0),p.push(0))}));const y=WP([c,n.degrees,u,g]),_=WP([h,d,f,p]);let b;b=n.workerEnabled?FP.create({canvas:e,engineOptions:{supportCompute:!0}}):FP.create({engineOptions:{supportCompute:!0}});const w=n.onLayoutEnd,C=[];l.forEach((e=>{C.push(e)}));for(let e=0;e<4;e++)C.push(0);const S=b.createKernel('{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_damping : f32;\\n  [[offset 4]] u_maxSpeed : f32;\\n  [[offset 8]] u_minMovement : f32;\\n  \\n  [[offset 12]] u_coulombDisScale : f32;\\n  [[offset 16]] u_factor : f32;\\n  \\n  \\n  [[offset 20]] u_interval : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray1 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\ntype GWebGPUBuffer3 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray2 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 4, set 0]] var<storage_buffer> gWebGPUBuffer3 : GWebGPUBuffer3;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn unpack_float(packedValue : f32) -> vec2<i32> {var packedIntValue : i32 = i32(packedValue);\\nvar v0 : i32 = packedIntValue / 1048576;\\nreturn vec2<i32>(v0, packedIntValue - (v0 * 1048576));}\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar vx : f32 = currentNode.x - nextNode.x;\\nvar vy : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar n_dist : f32 = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar attributesi : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar attributesj : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nvar massi : f32 = attributesi.x;\\nvar nodeStrengthi : f32 = attributesi.z;\\nvar nodeStrengthj : f32 = attributesj.z;\\nvar nodeStrength : f32 = (nodeStrengthi + nodeStrengthj) / 2.0;\\nvar param : f32 = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax = ax + direx * param;\\nay = ay + direy * param;}}\\nreturn vec2<f32>(ax, ay);}\\nfn calcGravity(i : i32, currentNode : vec4<f32>, attributes2 : vec4<f32>) -> vec2<f32> {var vx : f32 = currentNode.x - attributes2.x;\\nvar vy : f32 = currentNode.y - attributes2.y;\\nvar ax : f32 = vx * attributes2.z;\\nvar ay : f32 = vy * attributes2.z;\\nreturn vec2<f32>(ax, ay);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>, attributes1 : vec4<f32>) -> vec2<f32> {var mass : f32 = attributes1.x;\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nvar compressed : vec2<i32> = unpack_float(currentNode.z);\\nvar length : i32 = compressed.x;\\nvar arr_offset : i32 = compressed.y;\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + (4 * p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = node_buffer.x;\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar vx : f32 = nextNode.x - currentNode.x;\\nvar vy : f32 = nextNode.y - currentNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar edgeLength : f32 = node_buffer.y;\\nvar edgeStrength : f32 = node_buffer.z;\\nvar diff : f32 = edgeLength - dist;\\nvar param : f32 = (diff * edgeStrength) / mass;\\nax = ax - direx * param;\\nay = ay - direy * param;}\\nreturn vec2<f32>(ax, ay);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar movement : vec4<f32> = gWebGPUBuffer1.u_AveMovement[0];\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nif ((i >= __DefineValuePlaceholder__VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes1 : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar nodeAttributes2 : vec4<f32> = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\nax = ax + repulsive.x;\\nay = ay + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode, nodeAttributes1);\\nax = ax + attractive.x;\\nay = ay + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(i, currentNode, nodeAttributes2);\\nax = ax - gravity.x;\\nay = ay - gravity.y;\\nvar param : f32 = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nvar vx : f32 = ax * param;\\nvar vy : f32 = ay * param;\\nvar vlength : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {var param2 : f32 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nvar distx : f32 = vx * gWebGPUUniformParams.u_interval;\\nvar disty : f32 = vy * gWebGPUUniformParams.u_interval;\\nvar distLength : f32 = std::sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_damping;\\n  float u_maxSpeed;\\n  float u_minMovement;\\n  \\n  float u_coulombDisScale;\\n  float u_factor;\\n  \\n  \\n  float u_interval;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_NodeAttributeArray1[];\\n} gWebGPUBuffer2;\\n\\nlayout(std430, set = 0, binding = 4) buffer readonly  GWebGPUBuffer3 {\\n  vec4 u_NodeAttributeArray2[];\\n} gWebGPUBuffer3;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nivec2 unpack_float(float packedValue) {int packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {float ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 attributesj = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {float vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {float mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nvec4 movement = gWebGPUBuffer1.u_AveMovement[0];\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes1 = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 nodeAttributes2 = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {float param2 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * gWebGPUUniformParams.u_interval;\\nfloat disty = vy * gWebGPUUniformParams.u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {gl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([s,1,1]).setBinding({u_Data:l,u_damping:n.damping,u_maxSpeed:n.maxSpeed,u_minMovement:n.minMovement,u_coulombDisScale:n.coulombDisScale,u_factor:n.factor,u_NodeAttributeArray1:y,u_NodeAttributeArray2:_,MAX_EDGE_PER_VERTEX:a,VERTEX_COUNT:s,u_AveMovement:C,u_interval:n.interval}),x=b.createKernel('{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_iter : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var movement : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nmovement = movement + vertex.w;}\\nmovement = movement / f32(__DefineValuePlaceholder__VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4<f32>(movement, 0.0, 0.0, 0.0);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_iter;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {float movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = gWebGPUBuffer0.u_Data[j];\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4(movement, 0.0, 0.0, 0.0);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}').setDispatch([1,1,1]).setBinding({u_Data:l,VERTEX_COUNT:s,u_AveMovement:[0,0,0,0]});yield(()=>UP(this,void 0,void 0,(function*(){for(let e=0;e<o;e++){yield S.execute(),x.setBinding({u_Data:S}),yield x.execute();const t=Math.max(.02,n.interval-.002*e);S.setBinding({u_interval:t,u_AveMovement:x})}const r=yield S.getOutput();e?t.postMessage({type:Tw,vertexEdgeData:r}):i.forEach(((e,t)=>{const n=r[4*t],i=r[4*t+1];e.x=n,e.y=i})),w&&w()})))()}))}getType(){return"gForce-gpu"}}class jP extends mb{constructor(e){super(),this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(e)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const e=this,t=e.nodes,n=e.center;if(e.comboTree={id:"comboTreeRoot",depth:-1,children:e.comboTrees},t&&0!==t.length){if(1===t.length)return t[0].x=n[0],t[0].y=n[1],void(e.onLayoutEnd&&e.onLayoutEnd());e.initVals(),e.run(),e.onLayoutEnd&&e.onLayoutEnd()}else e.onLayoutEnd&&e.onLayoutEnd()}run(){const e=this,t=e.nodes,n=e.previousLayouted?e.maxIteration/5:e.maxIteration;e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight);const i=e.center,r=e.velocityDecay,o=e.comboMap;e.previousLayouted||e.initPos(o);for(let l=0;l<n;l++){const n=[];t.forEach(((e,t)=>{n[t]={x:0,y:0}})),e.applyCalculate(n),e.applyComboCenterForce(n),t.forEach(((e,t)=>{_b(e.x)&&_b(e.y)&&(e.x+=n[t].x*r,e.y+=n[t].y*r)})),e.alpha+=(e.alphaTarget-e.alpha)*e.alphaDecay,e.onTick()}const s=[0,0];t.forEach((e=>{_b(e.x)&&_b(e.y)&&(s[0]+=e.x,s[1]+=e.y)})),s[0]/=t.length,s[1]/=t.length;const a=[i[0]-s[0],i[1]-s[1]];t.forEach(((e,t)=>{_b(e.x)&&_b(e.y)&&(e.x+=a[0],e.y+=a[1])})),e.combos.forEach((e=>{const t=o[e.id];t&&t.empty&&(e.x=t.cx||e.x,e.y=t.cy||e.y)})),e.previousLayouted=!0}initVals(){const e=this,t=e.edges,n=e.nodes,i=e.combos,r={},o={},s={};n.forEach(((e,t)=>{o[e.id]=e,s[e.id]=t})),e.nodeMap=o,e.indexMap=s;const a={};i.forEach((e=>{a[e.id]=e})),e.oriComboMap=a,e.comboMap=e.getComboMap();const l=e.preventOverlap;e.preventComboOverlap=e.preventComboOverlap||l,e.preventNodeOverlap=e.preventNodeOverlap||l;const c=e.collideStrength;c&&(e.comboCollideStrength=c,e.nodeCollideStrength=c),e.comboCollideStrength=e.comboCollideStrength?e.comboCollideStrength:0,e.nodeCollideStrength=e.nodeCollideStrength?e.nodeCollideStrength:0;for(let E=0;E<t.length;++E){const e=Sb(t[E],"source"),n=Sb(t[E],"target");r[e]?r[e]++:r[e]=1,r[n]?r[n]++:r[n]=1}const u=[];for(let E=0;E<t.length;++E){const e=Sb(t[E],"source"),n=Sb(t[E],"target");u[E]=r[e]/(r[e]+r[n])}this.bias=u;const h=e.nodeSize,d=e.nodeSpacing;let f,g;if(g=_b(d)?()=>d:Nb(d)?d:()=>0,this.nodeSpacing=g,h)if(Nb(h))f=e=>h(e);else if(yb(h)){const e=(h[0]>h[1]?h[0]:h[1])/2;f=t=>e}else{const e=h/2;f=t=>e}else f=e=>{if(e.size){if(yb(e.size)){return(e.size[0]>e.size[1]?e.size[0]:e.size[1])/2}if(wb(e.size)){return(e.size.width>e.size.height?e.size.width:e.size.height)/2}return e.size/2}return 10};this.nodeSize=f;const p=e.comboSpacing;let m;m=_b(p)?()=>p:Nb(p)?p:()=>0,this.comboSpacing=m;const v=e.comboPadding;let y;y=_b(v)?()=>v:yb(v)?()=>Math.max.apply(null,v):Nb(v)?v:()=>0,this.comboPadding=y;let _,b=this.linkDistance;b||(b=10),_=_b(b)?e=>b:b,this.linkDistance=_;let w,C=this.edgeStrength;C||(C=1),w=_b(C)?e=>C:C,this.edgeStrength=w;let S,x=this.nodeStrength;x||(x=30),S=_b(x)?e=>x:x,this.nodeStrength=S}initPos(e){this.nodes.forEach(((t,n)=>{const i=t.comboId,r=e[i];i&&r?(t.x=r.cx+100/(n+1),t.y=r.cy+100/(n+1)):(t.x=100/(n+1),t.y=100/(n+1))}))}getComboMap(){const e=this,t=e.nodeMap,n=e.comboTrees,i=e.oriComboMap,r={};return(n||[]).forEach((n=>{const o=[];Db(n,(n=>{if("node"===n.itemType)return!0;if(!i[n.id])return!0;if(void 0===r[n.id]){const t={id:n.id,name:n.id,cx:0,cy:0,count:0,depth:e.oriComboMap[n.id].depth||0,children:[]};r[n.id]=t}const s=n.children;s&&s.forEach((e=>{if(!r[e.id]&&!t[e.id])return!0;o.push(e)}));const a=r[n.id];if(a.cx=0,a.cy=0,0===o.length){a.empty=!0;const e=i[n.id];a.cx=e.x,a.cy=e.y}return o.forEach((e=>{if(a.count++,"node"!==e.itemType){const t=r[e.id];return _b(t.cx)&&(a.cx+=t.cx),void(_b(t.cy)&&(a.cy+=t.cy))}const n=t[e.id];n&&(_b(n.x)&&(a.cx+=n.x),_b(n.y)&&(a.cy+=n.y))})),a.cx/=a.count||1,a.cy/=a.count||1,a.children=o,!0}))})),r}applyComboCenterForce(e){const t=this,n=t.gravity,i=t.comboGravity||n,r=this.alpha,o=t.comboTrees,s=t.indexMap,a=t.nodeMap,l=t.comboMap;(o||[]).forEach((t=>{Db(t,(t=>{if("node"===t.itemType)return!0;if(!l[t.id])return!0;const n=l[t.id],o=(n.depth+1)/10*.5,c=n.cx,u=n.cy;return n.cx=0,n.cy=0,n.children.forEach((t=>{if("node"!==t.itemType){const e=l[t.id];return e&&_b(e.cx)&&(n.cx+=e.cx),void(e&&_b(e.cy)&&(n.cy+=e.cy))}const h=a[t.id],d=h.x-c||.005,f=h.y-u||.005,g=Math.sqrt(d*d+f*f),p=s[h.id],m=i*r/g*o;e[p].x-=d*m,e[p].y-=f*m,_b(h.x)&&(n.cx+=h.x),_b(h.y)&&(n.cy+=h.y)})),n.cx/=n.count||1,n.cy/=n.count||1,!0}))}))}applyCalculate(e){const t=this,n=t.comboMap,i=t.nodes,r={};i.forEach(((e,t)=>{i.forEach(((n,i)=>{if(t<i)return;const o=e.x-n.x||.005,s=e.y-n.y||.005;let a=o*o+s*s;const l=Math.sqrt(a);a<1&&(a=l),r[`${e.id}-${n.id}`]={vx:o,vy:s,vl2:a,vl:l},r[`${n.id}-${e.id}`]={vl2:a,vl:l,vx:-o,vy:-s}}))})),t.updateComboSizes(n),t.calRepulsive(e,r),t.calAttractive(e,r);t.preventComboOverlap&&t.comboNonOverlapping(e,n)}updateComboSizes(e){const t=this,n=t.comboTrees,i=t.nodeMap,r=t.nodeSize,o=t.comboSpacing,s=t.comboPadding;(n||[]).forEach((n=>{const a=[];Db(n,(n=>{if("node"===n.itemType)return!0;const l=e[n.id];if(!l)return!1;const c=n.children;c&&c.forEach((t=>{(e[t.id]||i[t.id])&&a.push(t)})),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0,a.forEach((e=>{if("node"!==e.itemType)return!0;const t=i[e.id];if(!t)return!0;const n=r(t),o=t.x-n,s=t.y-n,a=t.x+n,c=t.y+n;l.minX>o&&(l.minX=o),l.minY>s&&(l.minY=s),l.maxX<a&&(l.maxX=a),l.maxY<c&&(l.maxY=c)}));let u=t.oriComboMap[n.id].size||10;yb(u)&&(u=u[0]);const h=Math.max(l.maxX-l.minX,l.maxY-l.minY,u);return l.r=h/2+o(l)/2+s(l),!0}))}))}comboNonOverlapping(e,t){const n=this,i=n.comboTree,r=n.comboCollideStrength,o=n.indexMap,s=n.nodeMap;Db(i,(n=>{if(!t[n.id]&&!s[n.id]&&"comboTreeRoot"!==n.id)return!1;const i=n.children;return i&&i.length>1&&i.forEach(((n,a)=>{if("node"===n.itemType)return!1;const l=t[n.id];l&&i.forEach(((i,c)=>{if(a<=c)return!1;if("node"===i.itemType)return!1;const u=t[i.id];if(!u)return!1;const h=l.cx-u.cx||.005,d=l.cy-u.cy||.005,f=h*h+d*d,g=l.r||1,p=u.r||1,m=g+p,v=p*p,y=g*g;if(f<m*m){const t=n.children;if(!t||0===t.length)return!1;const a=i.children;if(!a||0===a.length)return!1;const l=Math.sqrt(f),c=(m-l)/l*r,u=h*c,g=d*c,p=v/(y+v),_=1-p;t.forEach((t=>{if("node"!==t.itemType)return!1;if(!s[t.id])return;const n=o[t.id];a.forEach((t=>{if("node"!==t.itemType)return!1;if(!s[t.id])return!1;const i=o[t.id];e[n].x+=u*p,e[n].y+=g*p,e[i].x-=u*_,e[i].y-=g*_}))}))}}))})),!0}))}calRepulsive(e,t){const n=this,i=n.nodes,r=n.width*n.optimizeRangeFactor,o=n.nodeStrength,s=n.alpha,a=n.nodeCollideStrength,l=n.preventNodeOverlap,c=n.nodeSize,u=n.nodeSpacing,h=n.depthRepulsiveForceScale,d=n.center;i.forEach(((f,g)=>{if(f.x&&f.y){if(d){const t=n.gravity,i=f.x-d[0]||.005,r=f.y-d[1]||.005,o=Math.sqrt(i*i+r*r);e[g].x-=i*t*s/o,e[g].y-=r*t*s/o}i.forEach(((n,i)=>{if(g===i)return;if(!n.x||!n.y)return;const{vl2:d,vl:p}=t[`${f.id}-${n.id}`];if(p>r)return;const{vx:m,vy:v}=t[`${f.id}-${n.id}`];let y=Math.log(Math.abs(n.depth-f.depth)/10)+1||1;y=y<1?1:y,n.comboId!==f.comboId&&(y+=1);const _=y?Math.pow(h,y):1,b=o(n)*s/d*_;if(e[g].x+=m*b,e[g].y+=v*b,g<i&&l){const t=c(f)+u(f)||1,r=c(n)+u(n)||1,o=t+r;if(d<o*o){const n=(o-p)/p*a,s=r*r;let l=s/(t*t+s);const c=m*n,u=v*n;e[g].x+=c*l,e[g].y+=u*l,l=1-l,e[i].x-=c*l,e[i].y-=u*l}}}))}}))}calAttractive(e,t){const n=this,i=n.edges,r=n.linkDistance,o=n.alpha,s=n.edgeStrength,a=n.bias,l=n.depthAttractiveForceScale;i.forEach(((i,c)=>{const u=Sb(i,"source"),h=Sb(i,"target");if(!u||!h||u===h)return;const d=n.indexMap[u],f=n.indexMap[h],g=n.nodeMap[u],p=n.nodeMap[h];if(!g||!p)return;let m=g.depth===p.depth?0:Math.log(Math.abs(g.depth-p.depth)/10);g.comboId===p.comboId&&(m/=2);let v=m?Math.pow(l,m):1;if(g.comboId!==p.comboId&&1===v?v=l/2:g.comboId===p.comboId&&(v=2),!(_b(p.x)&&_b(g.x)&&_b(p.y)&&_b(g.y)))return;const{vl:y,vx:_,vy:b}=t[`${h}-${u}`],w=(y-r(i))/y*o*s(i)*v,C=_*w,S=b*w,x=a[c];e[f].x-=C*x,e[f].y-=S*x,e[d].x+=C*(1-x),e[d].y+=S*(1-x)}))}getType(){return"comboForce"}}class GP{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,n=e.ry-this.ry;let i=Math.hypot(t,n);i=i<1e-4?1e-4:i;const r=this.g*(this.degree+1)*(e.degree+1)/i;this.fx+=r*t/i,this.fy+=r*n/i}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,n=(this.rx*this.mass+e.rx*e.mass)/t,i=(this.ry*this.mass+e.ry*e.mass)/t,r=this.degree+e.degree;return new GP({rx:n,ry:i,mass:t,degree:r})}}class KP{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,n=this.length/2;return new KP({xmid:e,ymid:t,length:n})}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,n=this.length/2;return new KP({xmid:e,ymid:t,length:n})}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,n=this.length/2;return new KP({xmid:e,ymid:t,length:n})}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,n=this.length/2;return new KP({xmid:e,ymid:t,length:n})}}class qP{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=e&&(this.quad=e)}insert(e){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new qP(this.quad.NW()),this.NE=new qP(this.quad.NE()),this.SW=new qP(this.quad.SW()),this.SE=new qP(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e)):this.body=e}_putBody(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}updateForce(e){if(null!=this.body&&e!==this.body)if(this._isExternal())e.addForce(this.body);else{(this.quad?this.quad.getLength():0)/this.body.distanceTo(e)<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}}class $P extends mb{constructor(e){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(e)}getDefaultCfg(){return{}}execute(){const e=this,{nodes:t,onLayoutEnd:n,prune:i}=e;let r=e.maxIteration;e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight);const o=[],s=t.length;for(let a=0;a<s;a+=1){const n=t[a];let i=10,r=10;_b(n.size)&&(i=n.size,r=n.size),yb(n.size)?(isNaN(n.size[0])||(i=n.size[0]),isNaN(n.size[1])||(r=n.size[1])):wb(n.size)&&(i=n.size.width,r=n.size.height),e.getWidth&&!isNaN(e.getWidth(n))&&(r=e.getWidth(n)),e.getHeight&&!isNaN(e.getHeight(n))&&(i=e.getHeight(n));const s=Math.max(i,r);o.push(s)}void 0===e.barnesHut&&s>250&&(e.barnesHut=!0),void 0===e.prune&&s>100&&(e.prune=!0),0!==this.maxIteration||e.prune?0===this.maxIteration&&i&&(r=100,s<=200&&s>100?r=500:s>200&&(r=950),this.maxIteration=r):(r=250,s<=200&&s>100?r=1e3:s>200&&(r=1200),this.maxIteration=r),e.kr||(e.kr=50,s>100&&s<=500?e.kr=20:s>500&&(e.kr=1)),e.kg||(e.kg=20,s>100&&s<=500?e.kg=10:s>500&&(e.kg=1)),this.nodes=e.updateNodesByForces(o),n()}updateNodesByForces(e){const t=this,{edges:n,maxIteration:i}=t;let r=t.nodes;const o=n.filter((e=>Sb(e,"source")!==Sb(e,"target"))),s=r.length,a=o.length,l=[],c={},u={},h=[];for(let f=0;f<s;f+=1)c[r[f].id]=f,l[f]=0,(void 0===r[f].x||isNaN(r[f].x))&&(r[f].x=1e3*Math.random()),(void 0===r[f].y||isNaN(r[f].y))&&(r[f].y=1e3*Math.random()),h.push({x:r[f].x,y:r[f].y});for(let f=0;f<a;f+=1){let e,t,n=0,i=0;for(let a=0;a<s;a+=1){const s=Sb(o[f],"source"),l=Sb(o[f],"target");r[a].id===s?(e=r[a],n=a):r[a].id===l&&(t=r[a],i=a),u[f]={sourceIdx:n,targetIdx:i}}e&&(l[c[e.id]]+=1),t&&(l[c[t.id]]+=1)}let d=i;if(r=this.iterate(d,c,u,a,l,e),t.prune){for(let e=0;e<a;e+=1)l[u[e].sourceIdx]<=1?(r[u[e].sourceIdx].x=r[u[e].targetIdx].x,r[u[e].sourceIdx].y=r[u[e].targetIdx].y):l[u[e].targetIdx]<=1&&(r[u[e].targetIdx].x=r[u[e].sourceIdx].x,r[u[e].targetIdx].y=r[u[e].sourceIdx].y);t.prune=!1,t.barnesHut=!1,d=100,r=this.iterate(d,c,u,a,l,e)}return r}iterate(e,t,n,i,r,o){const s=this;let{nodes:a}=s;const{kr:l,preventOverlap:c}=s,{barnesHut:u}=s,h=a.length;let d=0;let f=e;let g=[];const p=[],m=[];for(let v=0;v<h;v+=1)if(g[2*v]=0,g[2*v+1]=0,u){const e={id:v,rx:a[v].x,ry:a[v].y,mass:1,g:l,degree:r[v]};m[v]=new GP(e)}for(;f>0;){for(let t=0;t<h;t+=1)p[2*t]=g[2*t],p[2*t+1]=g[2*t+1],g[2*t]=0,g[2*t+1]=0;g=this.getAttrForces(f,50,i,t,n,r,o,g),g=u&&(c&&f>50||!c)?this.getOptRepGraForces(g,m,r):this.getRepGraForces(f,50,g,100,o,r);const e=this.updatePos(g,p,d,r);a=e.nodes,d=e.sg,f--,s.tick&&s.tick()}return a}getAttrForces(e,t,n,i,r,o,s,a){const{nodes:l,preventOverlap:c,dissuadeHubs:u,mode:h,prune:d}=this;for(let f=0;f<n;f+=1){const n=l[r[f].sourceIdx],g=r[f].sourceIdx,p=l[r[f].targetIdx],m=r[f].targetIdx;if(d&&(o[g]<=1||o[m]<=1))continue;const v=[p.x-n.x,p.y-n.y];let y=Math.hypot(v[0],v[1]);y=y<1e-4?1e-4:y,v[0]=v[0]/y,v[1]=v[1]/y,c&&e<t&&(y=y-s[g]-s[m]);let _=y,b=_;"linlog"===h&&(_=Math.log(1+y),b=_),u&&(_=y/o[g],b=y/o[m]),c&&e<t&&y<=0?(_=0,b=0):c&&e<t&&y>0&&(_=y,b=y),a[2*i[n.id]]+=_*v[0],a[2*i[p.id]]-=b*v[0],a[2*i[n.id]+1]+=_*v[1],a[2*i[p.id]+1]-=b*v[1]}return a}getRepGraForces(e,t,n,i,r,o){const{nodes:s,preventOverlap:a,kr:l,kg:c,center:u,prune:h}=this,d=s.length;for(let f=0;f<d;f+=1){for(let c=f+1;c<d;c+=1){if(h&&(o[f]<=1||o[c]<=1))continue;const u=[s[c].x-s[f].x,s[c].y-s[f].y];let d=Math.hypot(u[0],u[1]);d=d<1e-4?1e-4:d,u[0]=u[0]/d,u[1]=u[1]/d,a&&e<t&&(d=d-r[f]-r[c]);let g=l*(o[f]+1)*(o[c]+1)/d;a&&e<t&&d<0?g=i*(o[f]+1)*(o[c]+1):a&&e<t&&0===d?g=0:a&&e<t&&d>0&&(g=l*(o[f]+1)*(o[c]+1)/d),n[2*f]-=g*u[0],n[2*c]+=g*u[0],n[2*f+1]-=g*u[1],n[2*c+1]+=g*u[1]}const g=[s[f].x-u[0],s[f].y-u[1]],p=Math.hypot(g[0],g[1]);g[0]=g[0]/p,g[1]=g[1]/p;const m=c*(o[f]+1);n[2*f]-=m*g[0],n[2*f+1]-=m*g[1]}return n}getOptRepGraForces(e,t,n){const{nodes:i,kg:r,center:o,prune:s}=this,a=i.length;let l=9e10,c=-9e10,u=9e10,h=-9e10;for(let p=0;p<a;p+=1)s&&n[p]<=1||(t[p].setPos(i[p].x,i[p].y),i[p].x>=c&&(c=i[p].x),i[p].x<=l&&(l=i[p].x),i[p].y>=h&&(h=i[p].y),i[p].y<=u&&(u=i[p].y));const d=Math.max(c-l,h-u),f=new KP({xmid:(c+l)/2,ymid:(h+u)/2,length:d,massCenter:o,mass:a}),g=new qP(f);for(let p=0;p<a;p+=1)s&&n[p]<=1||t[p].in(f)&&g.insert(t[p]);for(let p=0;p<a;p+=1){if(s&&n[p]<=1)continue;t[p].resetForce(),g.updateForce(t[p]),e[2*p]-=t[p].fx,e[2*p+1]-=t[p].fy;const a=[i[p].x-o[0],i[p].y-o[1]];let l=Math.hypot(a[0],a[1]);l=l<1e-4?1e-4:l,a[0]=a[0]/l,a[1]=a[1]/l;const c=r*(n[p]+1);e[2*p]-=c*a[0],e[2*p+1]-=c*a[1]}return e}updatePos(e,t,n,i){const{nodes:r,ks:o,tao:s,prune:a,ksmax:l}=this,c=r.length,u=[],h=[];let d=0,f=0;for(let p=0;p<c;p+=1){if(a&&i[p]<=1)continue;const n=[e[2*p]-t[2*p],e[2*p+1]-t[2*p+1]],r=Math.hypot(n[0],n[1]),o=[e[2*p]+t[2*p],e[2*p+1]+t[2*p+1]],s=Math.hypot(o[0],o[1]);u[p]=r,h[p]=s/2,d+=(i[p]+1)*u[p],f+=(i[p]+1)*h[p]}const g=n;n=s*f/d,0!==g&&(n=n>1.5*g?1.5*g:n);for(let p=0;p<c;p+=1){if(a&&i[p]<=1)continue;let t=o*n/(1+n*Math.sqrt(u[p])),s=Math.hypot(e[2*p],e[2*p+1]);s=s<1e-4?1e-4:s;const c=l/s;t=t>c?c:t;const h=t*e[2*p],d=t*e[2*p+1];r[p].x+=h,r[p].y+=d}return{nodes:r,sg:n}}}class YP{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(e,t,n){this.cells=[],this.CELL_W=n.CELL_W||YP.DEFAULT_CELL_W,this.CELL_H=n.CELL_H||YP.DEFAULT_CELL_H,this.columnNum=Math.ceil(e/this.CELL_W),this.rowNum=Math.ceil(t/this.CELL_H),YP.MIN_DIST=Math.pow(e,2)+Math.pow(t,2);for(let i=0;i<this.columnNum;i++){const e=[];for(let t=0;t<this.rowNum;t++){const n={dx:i,dy:t,x:i*this.CELL_W,y:t*this.CELL_H,occupied:!1};e.push(n)}this.cells.push(e)}}findGridByNodeId(e){var t,n;for(let i=0;i<this.columnNum;i++)for(let r=0;r<this.rowNum;r++)if(this.cells[i][r].node&&(null===(n=null===(t=this.cells[i][r])||void 0===t?void 0:t.node)||void 0===n?void 0:n.id)===e)return{column:i,row:r};return null}sqdist(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)}occupyNearest(e){let t,n=YP.MIN_DIST,i=null;for(let r=0;r<this.columnNum;r++)for(let o=0;o<this.rowNum;o++)!this.cells[r][o].occupied&&(t=this.sqdist(e,this.cells[r][o]))<n&&(n=t,i=this.cells[r][o]);return i&&(i.occupied=!0),i}insertColumn(e,t){if(!(t<=0)){for(let e=0;e<t;e++){this.cells[e+this.columnNum]=[];for(let t=0;t<this.rowNum;t++)this.cells[e+this.columnNum][t]={dx:e,dy:t,x:e*this.CELL_W,y:t*this.CELL_H,occupied:!1,node:null}}for(let n=this.columnNum-1;n>e;n--)for(let e=0;e<this.rowNum;e++)this.cells[n+t][e]=Object.assign(Object.assign({},this.cells[n][e]),{x:(n+t)*this.CELL_W,y:e*this.CELL_H}),this.cells[n][e]={x:n*this.CELL_W,y:e*this.CELL_H,occupied:!0,node:null};for(let n=0;n<this.additionColumn.length;n++)this.additionColumn[n]>=e&&(this.additionColumn[n]+=t);for(let n=0;n<t;n++)this.additionColumn.push(e+n+1);this.columnNum+=t}}insertRow(e,t){if(!(t<=0)){for(let e=0;e<t;e++)for(let t=0;t<this.columnNum;t++)this.cells[t][e+this.rowNum]={dx:t,dy:e,x:t*this.CELL_W,y:e*this.CELL_H,occupied:!1,node:null};for(let n=0;n<this.columnNum;n++)for(let i=this.rowNum-1;i>e;i--)this.cells[n][i+t]=Object.assign(Object.assign({},this.cells[n][i]),{dx:n,dy:i+t,x:n*this.CELL_W,y:(i+t)*this.CELL_H}),this.cells[n][i]={dx:n,dy:i,x:n*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null};for(let n=0;n<this.additionRow.length;n++)this.additionRow[n]>=e&&(this.additionRow[n]+=t);for(let n=0;n<t;n++)this.additionRow.push(e+n+1);this.rowNum+=t}}getNodes(){const e=[];for(let t=0;t<this.columnNum;t++)for(let n=0;n<this.rowNum;n++)this.cells[t][n].node&&e.push(this.cells[t][n]);return e}}YP.MIN_DIST=50,YP.DEFAULT_CELL_W=80,YP.DEFAULT_CELL_H=80;const XP=1.5707963267948966,ZP=new Map;let QP=.8;function JP(e,t){const n=(ZP.get(e.id)||[]).find((e=>e.source===t.id||e.target===t.id)),i=e.size[0]*e.size[1],r=t.size[0]*t.size[1],o=i>r?t:e,s=i>r?e:t,a=o.x-o.size[0]/2,l=o.y-o.size[1]/2,c=o.x+o.size[0]/2,u=o.y+o.size[1]/2,h=s.x-s.size[0]/2,d=s.y-s.size[1]/2,f=s.x+s.size[0]/2,g=s.y+s.size[1]/2,p=o.x,m=o.y,v=s.x,y=s.y;let _=0,b=0;if(c>=h&&f>=a&&u>=d&&g>=l){b=Math.sqrt(Math.pow(v-p,2)+Math.pow(y-m,2));0===b&&(b=1e-7),_=10/b*100+((c<f?c:f)-(a>h?a:h))*((u<g?u:g)-(l>d?l:d)),_*=1e7}else{let e=!1;const t=function(e,t,n){const i=e.x-e.size[0]/2,r=e.y-e.size[1]/2,o=e.x+e.size[0]/2,s=e.y+e.size[1]/2,a=t.x-t.size[0]/2,l=t.y-t.size[1]/2,c=t.x+t.size[0]/2,u=t.y+t.size[1]/2,h=e.x,d=e.y,f=t.x,g=t.y,p=f-h,m=Math.atan2(p,g-d);let v=0,y=0,_=0,b=0;m>XP?(y=r-u,v=a-o,_=parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)),b=parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):0<m&&m<=XP?(y=l-s,v=a-o,_=b=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):m<-XP?(y=r-u,v=-(c-i),_=b=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v?(v/Math.sin(m)).toFixed(2):y.toFixed(2))):(y=l-s,v=Math.abs(p)>(o-i)/2?i-c:p,_=b=y>v?parseFloat(y?(y/Math.cos(m)).toFixed(2):v.toFixed(2)):parseFloat(v&&0!==m?(v/Math.sin(m)).toFixed(2):y.toFixed(2)));const w=parseFloat(m.toFixed(2));let C=n;return n&&(C=1.1780972450961724<w&&w<1.9634954084936207),{distance:Math.abs(_<b?_:b),isHoriz:C}}(o,s,e);b=t.distance,e=t.isHoriz,b<=10?_+=0!==b?n?10+1e7/b:10+1e8/b:1e7:(_+=b,n&&(_+=b*b))}return _}function eF(e){let t=0;for(let n=0;n<e.length;n++){const i=e[n];(i.x<0||i.y<0||i.x>1200||i.y>800)&&(t+=1e12);for(let r=n+1;r<e.length;r++)t+=JP(i,e[r])}return t}function tF(e,t,n,i){const r=new Map;n.forEach(((e,t)=>{r.set(e.id,e)}));const o=i.filter((t=>t.source===e.id||t.target===e.id))||[],s=[];o.forEach((t=>{const n=t.source===e.id?t.target:t.source,i=r.get(n);i&&s.push(i)}));let a=!0;for(let l=0;l<s.length;l++){const n=s[l],i=180*Math.atan((e.y-n.y)/(n.x-e.y)),r=180*Math.atan((t.y-n.y)/(n.x-t.y)),o=r<30||r>150,c=i>70&&i<110,u=r>70&&r<110;if((i<30||i>150)&&!o||i*r<0){a=!1;break}if(c&&!u||i*r<0){a=!1;break}if((n.x-e.x)*(n.x-t.x)<0){a=!1;break}if((n.y-e.y)*(n.y-t.y)<0){a=!1;break}}return a}function nF(e,t){let n=!1;const i=[10,-10,0,0],r=[0,0,10,-10];for(let o=0;o<e.length;++o){const s=e[o];let a=iF(s,e);for(let o=0;o<i.length;o++){if(tF(s,{x:s.x+i[o],y:s.y+r[o]},e,t)){s.x+=i[o],s.y+=r[o];const t=iF(s,e),l=Math.random();t<a||l<QP&&l>.1?(a=t,n=!0):(s.x-=i[o],s.y-=r[o])}}}return QP>.1&&(QP*=.5),n?eF(e):0}function iF(e,t){let n=0;(e.x<0||e.y<0||e.x+e.size[0]+20>1200||e.y+e.size[1]+20>800)&&(n+=1e12);for(let i=0;i<t.length;++i)e.id!==t[i].id&&(n+=JP(e,t[i]));return n}function rF(e,t){const{nodes:n,edges:i}=e,r=t.width,o=t.height;if(!(null==n?void 0:n.length))return Promise.resolve();const s=[];n.forEach((e=>{if(i.filter((t=>t.source===e.id||t.target===e.id)).length>1){const t=Object.assign({},e);delete t.size,s.push(t)}}));const a=[];i.forEach((e=>{const t=s.find((t=>t.id===e.source)),n=s.find((t=>t.id===e.target));t&&n&&a.push(e)}));const l=new Hx({type:"dagre",ranksep:t.nodeMinGap,nodesep:t.nodeMinGap}),{nodes:c}=l.layout({nodes:s,edges:a});n.forEach((e=>{const t=(c||[]).find((t=>t.id===e.id));e.x=(null==t?void 0:t.x)||r/2,e.y=(null==t?void 0:t.y)||o/2}));const u=JSON.parse(JSON.stringify(n)),h=JSON.parse(JSON.stringify(i)),d=Ew().nodes(u).force("link",Qb(h).id((e=>e.id)).distance((e=>a.find((t=>t.source===e.source&&t.target===e.target))?30:20))).force("charge",kw()).force("center",Pb(r/2,o/2)).force("x",Lw(r/2)).force("y",Dw(o/2)).alpha(.3).alphaDecay(.08).alphaMin(.001);return new Promise((e=>{d.on("end",(()=>{n.forEach((e=>{const t=u.find((t=>t.id===e.id));t&&(e.x=t.x,e.y=t.y)}));const s=Math.min(...n.map((e=>e.x))),a=Math.max(...n.map((e=>e.x))),l=Math.min(...n.map((e=>e.y))),c=Math.max(...n.map((e=>e.y))),h=r/(a-s),d=o/(c-l);n.forEach((e=>{void 0!==e.x&&h<1&&(e.x=(e.x-s)*h),void 0!==e.y&&d<1&&(e.y=(e.y-l)*d)})),n.forEach((e=>{e.sizeTemp=e.size,e.size=[10,10]})),function(e,t){if(0===e.length)return{nodes:e,edges:t};e.forEach((e=>{const n=t.filter((t=>t.source===e.id||t.target===e.id));ZP.set(e,n)})),e.sort(((e,t)=>{var n,i;return(null===(n=ZP.get(e.id))||void 0===n?void 0:n.length)-(null===(i=ZP.get(t.id))||void 0===i?void 0:i.length)}));let n=eF(e),i=20,r=1,o=0,s=0;for(;i>0&&(s++,!(s>=50));){const s=nF(e,t);0!==s&&(o=s),r=o-n,n=o,0===r?--i:i=20}e.forEach((e=>{e.x=e.x-e.size[0]/2,e.y=e.y-e.size[1]/2}))}(n,i),n.forEach((e=>{e.size=e.sizeTemp||[],delete e.sizeTemp})),function(e,t){if(!e.nodes||0===e.nodes.length)return e;const n=t.width,i=t.height,r=t.nodeMinGap;let o=1e4,s=1e4;e.nodes.forEach((e=>{const t=e.size[0]||50,n=e.size[1]||50;o=Math.min(t,o),s=Math.min(n,s)}));const a=new YP;a.init(n,i,{CELL_H:s,CELL_W:o}),e.nodes.forEach((e=>{const t=a.occupyNearest(e);t&&(t.node={id:e.id,size:e.size},e.x=t.x,e.y=t.y,e.dx=t.dx,e.dy=t.dy)}));for(let l=0;l<e.nodes.length;l++){const t=e.nodes[l],n=a.findGridByNodeId(t.id);if(!n)throw new Error("can not find node cell");const{column:i,row:c}=n;if(t.size[0]+r>o){const e=Math.ceil((t.size[0]+r)/o)-1;let n=e;for(let t=0;t<e&&(a.additionColumn.indexOf(i+t+1)>-1&&!a.cells[i+t+1][c].node);t++)n--;a.insertColumn(i,n)}if(t.size[1]+r>s){const e=Math.ceil((t.size[1]+r)/s)-1;let n=e;for(let t=0;t<e&&(a.additionRow.indexOf(c+t+1)>-1&&!a.cells[i][c+t+1].node);t++)n--;a.insertRow(c,n)}}for(let l=0;l<a.columnNum;l++)for(let t=0;t<a.rowNum;t++){const n=a.cells[l][t];if(n.node){const t=e.nodes.find((e=>{var t;return e.id===(null===(t=null==n?void 0:n.node)||void 0===t?void 0:t.id)}));t&&(t.x=n.x+t.size[0]/2,t.y=n.y+t.size[1]/2)}}}({nodes:n,edges:i},t),e()}))}))}const oF={force:Mw,fruchterman:CE,forceAtlas2:$P,gForce:Rb,dagre:Hx,circular:Ow,radial:_E,concentric:bE,grid:Mb,mds:wE,comboForce:jP,random:Ab,"gForce-gpu":HP,"fruchterman-gpu":VP,er:class extends mb{constructor(e){super(),this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},e&&this.updateCfg(e)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const e=this,t=e.nodes,n=e.edges;return null==t||t.forEach((e=>{e.size||(e.size=[50,50])})),rF({nodes:t,edges:n},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then((()=>{e.onLayoutEnd&&e.onLayoutEnd()}))}getType(){return"er"}}};var sF={assign:hp.mix},aF=sF,lF={getId:function(e){return e.id||e.name},getPreH:function(e){return e.preH||0},getPreV:function(e){return e.preV||0},getHGap:function(e){return e.hgap||18},getVGap:function(e){return e.vgap||18},getChildren:function(e){return e.children},getHeight:function(e){return e.height||36},getWidth:function(e){var t=e.label||" ";return e.width||18*t.split("").length}};function cF(e,t){var n=this;if(n.vgap=n.hgap=0,e instanceof cF)return e;n.data=e;var i=t.getHGap(e),r=t.getVGap(e);return n.preH=t.getPreH(e),n.preV=t.getPreV(e),n.width=t.getWidth(e),n.height=t.getHeight(e),n.width+=n.preH,n.height+=n.preV,n.id=t.getId(e),n.x=n.y=0,n.depth=0,n.children||(n.children=[]),n.addGap(i,r),n}aF.assign(cF.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(e,t){var n=this;n.hgap+=e,n.vgap+=t,n.width+=2*e,n.height+=2*t},eachNode:function(e){for(var t,n=[this];t=n.shift();)e(t),n=t.children.concat(n)},DFTraverse:function(e){this.eachNode(e)},BFTraverse:function(e){for(var t,n=[this];t=n.shift();)e(t),n=n.concat(t.children)},getBoundingBox:function(){var e={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode((function(t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.width=Math.max(e.width,t.x+t.width),e.height=Math.max(e.height,t.y+t.height)})),e},translate:function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.eachNode((function(n){n.x+=e,n.y+=t,n.x+=n.preH,n.y+=n.preV}))},right2left:function(){var e=this,t=e.getBoundingBox();e.eachNode((function(e){e.x=e.x-2*(e.x-t.left)-e.width})),e.translate(t.width,0)},bottom2top:function(){var e=this,t=e.getBoundingBox();e.eachNode((function(e){e.y=e.y-2*(e.y-t.top)-e.height})),e.translate(0,t.height)}});var uF=function(e,t,n){void 0===t&&(t={});var i,r=new cF(e,t=aF.assign({},lF,t)),o=[r];if(!n&&!e.collapsed)for(;i=o.shift();)if(!i.data.collapsed){var s=t.getChildren(i.data),a=s?s.length:0;if(i.children=new Array(a),s&&a)for(var l=0;l<a;l++){var c=new cF(s[l],t);i.children[l]=c,o.push(c),c.parent=i,c.depth=i.depth+1}}return r},hF=uF,dF=function(){function e(e,t){void 0===t&&(t={});this.options=t,this.rootNode=hF(e,t)}return e.prototype.execute=function(){throw new Error("please override this method")},e}();function fF(e,t,n,i){void 0===i&&(i=[]);var r=this;r.w=e||0,r.h=t||0,r.y=n||0,r.x=0,r.c=i||[],r.cs=i.length,r.prelim=0,r.mod=0,r.shift=0,r.change=0,r.tl=null,r.tr=null,r.el=null,r.er=null,r.msel=0,r.mser=0}function gF(e,t,n){n?e.y+=t:e.x+=t,e.children.forEach((function(e){gF(e,t,n)}))}function pF(e,t){var n=t?e.y:e.x;return e.children.forEach((function(e){n=Math.min(pF(e,t),n)})),n}function mF(e,t){gF(e,-pF(e,t),t)}function vF(e,t,n){n?t.y=e.x:t.x=e.x,e.c.forEach((function(e,i){vF(e,t.children[i],n)}))}function yF(e,t,n){void 0===n&&(n=0),t?(e.x=n,n+=e.width):(e.y=n,n+=e.height),e.children.forEach((function(e){yF(e,t,n)}))}fF.fromNode=function(e,t){if(!e)return null;var n=[];return e.children.forEach((function(e){n.push(fF.fromNode(e,t))})),t?new fF(e.height,e.width,e.x,n):new fF(e.width,e.height,e.y,n)};var _F=uF,bF=function(e,t){for(var n=_F(e.data,t,!0),i=_F(e.data,t,!0),r=e.children.length,o=Math.round(r/2),s=t.getSide||function(e,t){return t<o?"right":"left"},a=0;a<r;a++){var l=e.children[a];"right"===s(l,a)?i.children.push(l):n.children.push(l)}return n.eachNode((function(e){e.isRoot()||(e.side="left")})),i.eachNode((function(e){e.isRoot()||(e.side="right")})),{left:n,right:i}},wF=bF,CF=["LR","RL","TB","BT","H","V"],SF=["LR","RL","H"],xF=CF[0],EF=function(e,t,n){var i=t.direction||xF;if(t.isHorizontal=function(e){return SF.indexOf(e)>-1}(i),i&&-1===CF.indexOf(i))throw new TypeError("Invalid direction: "+i);if(i===CF[0])n(e,t);else if(i===CF[1])n(e,t),e.right2left();else if(i===CF[2])n(e,t);else if(i===CF[3])n(e,t),e.bottom2top();else if(i===CF[4]||i===CF[5]){var r=wF(e,t),o=r.left,s=r.right;n(o,t),n(s,t),t.isHorizontal?o.right2left():o.bottom2top(),s.translate(o.x-s.x,o.y-s.y),e.x=o.x,e.y=s.y;var a=e.getBoundingBox();t.isHorizontal?a.top<0&&e.translate(0,-a.top):a.left<0&&e.translate(-a.left,0)}var l=t.fixedRoot;return void 0===l&&(l=!0),l&&e.translate(-(e.x+e.width/2+e.hgap),-(e.y+e.height/2+e.vgap)),e};var kF=function(e,t){void 0===t&&(t={});var n=t.isHorizontal;function i(e){0===e.cs?(e.el=e,e.er=e,e.msel=e.mser=0):(e.el=e.c[0].el,e.msel=e.c[0].msel,e.er=e.c[e.cs-1].er,e.mser=e.c[e.cs-1].mser)}function r(e,t,n){for(var i=e.c[t-1],r=i.mod,c=e.c[t],u=c.mod;null!==i&&null!==c;){l(i)>n.low&&(n=n.nxt);var h=r+i.prelim+i.w-(u+c.prelim);h>0&&(u+=h,o(e,t,n.index,h));var d=l(i),f=l(c);d<=f&&null!==(i=a(i))&&(r+=i.mod),d>=f&&null!==(c=s(c))&&(u+=c.mod)}!i&&c?function(e,t,n,i){var r=e.c[0].el;r.tl=n;var o=i-n.mod-e.c[0].msel;r.mod+=o,r.prelim-=o,e.c[0].el=e.c[t].el,e.c[0].msel=e.c[t].msel}(e,t,c,u):i&&!c&&function(e,t,n,i){var r=e.c[t].er;r.tr=n;var o=i-n.mod-e.c[t].mser;r.mod+=o,r.prelim-=o,e.c[t].er=e.c[t-1].er,e.c[t].mser=e.c[t-1].mser}(e,t,i,r)}function o(e,t,n,i){e.c[t].mod+=i,e.c[t].msel+=i,e.c[t].mser+=i,function(e,t,n,i){if(n!==t-1){var r=t-n;e.c[n+1].shift+=i/r,e.c[t].shift-=i/r,e.c[t].change-=i-i/r}}(e,t,n,i)}function s(e){return 0===e.cs?e.tl:e.c[0]}function a(e){return 0===e.cs?e.tr:e.c[e.cs-1]}function l(e){return e.y+e.h}function c(e,t,n){for(;null!==n&&e>=n.low;)n=n.nxt;return{low:e,index:t,nxt:n}}yF(e,n);var u=fF.fromNode(e,n);return function e(t){if(0!==t.cs){e(t.c[0]);for(var n=c(l(t.c[0].el),0,null),o=1;o<t.cs;++o){e(t.c[o]);var s=l(t.c[o].er);r(t,o,n),n=c(s,o,n)}!function(e){e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2}(t),i(t)}else i(t)}(u),function e(t,n){n+=t.mod,t.x=t.prelim+n,function(e){for(var t=0,n=0,i=0;i<e.cs;i++)n+=(t+=e.c[i].shift)+e.c[i].change,e.c[i].mod+=n}(t);for(var i=0;i<t.cs;i++)e(t.c[i],n)}(u,0),vF(u,e,n),mF(e,n),e},LF=EF,DF=sF,NF=function(e){var t,n;function i(){return e.apply(this,arguments)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.execute=function(){return LF(this.rootNode,this.options,kF)},i}(dF),IF={};var TF=function(e,t){return t=DF.assign({},IF,t),new NF(e,t).execute()},MF=sF;function AF(e,t){void 0===t&&(t=[]);var n=this;n.x=n.y=0,n.leftChild=n.rightChild=null,n.height=0,n.children=t}var OF={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function RF(e,t,n){n?(t.x=e.x,t.y=e.y):(t.x=e.y,t.y=e.x),e.children.forEach((function(e,i){RF(e,t.children[i],n)}))}var PF=function(e,t){void 0===t&&(t={}),t=MF.assign({},OF,t);var n,i=0;var r=function e(t){if(!t)return null;t.width=0,t.depth&&t.depth>i&&(i=t.depth);var n=t.children,r=n.length,o=new AF(t.height,[]);return n.forEach((function(t,n){var i=e(t);o.children.push(i),0===n&&(o.leftChild=i),n===r-1&&(o.rightChild=i)})),o.originNode=t,o.isLeaf=t.isLeaf(),o}(e);return function e(t){if(t.isLeaf||0===t.children.length)t.drawingDepth=i;else{var n=t.children.map((function(t){return e(t)})),r=Math.min.apply(null,n);t.drawingDepth=r-1}return t.drawingDepth}(r),function e(i){i.x=i.drawingDepth*t.rankSep,i.isLeaf?(i.y=0,n&&(i.y=n.y+n.height+t.nodeSep,i.originNode.parent!==n.originNode.parent&&(i.y+=t.subTreeSep)),n=i):(i.children.forEach((function(t){e(t)})),i.y=(i.leftChild.y+i.rightChild.y)/2)}(r),RF(r,e,t.isHorizontal),e},FF=EF,BF=sF,WF=function(e){var t,n;function i(){return e.apply(this,arguments)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.execute=function(){var e=this;return e.rootNode.width=0,FF(e.rootNode,e.options,PF)},i}(dF),zF={};var VF=function(e,t){return t=BF.assign({},zF,t),new WF(e,t).execute()};var UF=dF,HF=function(e,t,n){var i=null;e.eachNode((function(e){!function(e,t,n,i){var r="function"==typeof n?n(e):n*e.depth;if(!i)try{if(e.id===e.parent.children[0].id)return e.x+=r,void(e.y=t?t.y:0)}catch(zWe){}e.x+=r,e.y=t?t.y+t.height:0}(e,i,t,n),i=e}))},jF=bF,GF=sF,KF=["LR","RL","H"],qF=KF[0],$F=function(e){var t,n;function i(){return e.apply(this,arguments)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.execute=function(){var e=this.options,t=this.rootNode;e.isHorizontal=!0;var n=e.indent,i=void 0===n?20:n,r=e.dropCap,o=void 0===r||r,s=e.direction||qF;if(s&&-1===KF.indexOf(s))throw new TypeError("Invalid direction: "+s);if(s===KF[0])HF(t,i,o);else if(s===KF[1])HF(t,i,o),t.right2left();else if(s===KF[2]){var a=jF(t,e),l=a.left,c=a.right;HF(l,i,o),l.right2left(),HF(c,i,o);var u=l.getBoundingBox();c.translate(u.width,0),t.x=c.x-t.width/2}return t},i}(UF),YF={};var XF=function(e,t){return t=GF.assign({},YF,t),new $F(e,t).execute()},ZF=sF;function QF(e,t){var n=0;return e.children.length?e.children.forEach((function(e){n+=QF(e,t)})):n=e.height,e._subTreeSep=t.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,n)+2*e._subTreeSep,e.totalHeight}function JF(e){var t=e.children,n=t.length;if(n){t.forEach((function(e){JF(e)}));var i=t[0],r=t[n-1],o=r.y-i.y+r.height,s=0;if(t.forEach((function(e){s+=e.totalHeight})),o>e.height)e.y=i.y+o/2-e.height/2;else if(1!==t.length||e.height>s){var a=e.y+(e.height-o)/2-i.y;t.forEach((function(e){e.translate(0,a)}))}else e.y=(i.y+i.height/2+r.y+r.height/2)/2-e.height/2}}var eB={getSubTreeSep:function(){return 0}};var tB=function(e,t){void 0===t&&(t={}),t=ZF.assign({},eB,t),e.parent={x:0,width:0,height:0,y:0},e.BFTraverse((function(e){e.x=e.parent.x+e.parent.width})),e.parent=null,QF(e,t),e.startY=0,e.y=e.totalHeight/2-e.height/2,e.eachNode((function(e){var t=e.children,n=t.length;if(n){var i=t[0];if(i.startY=e.startY+e._subTreeSep,1===n)i.y=e.y+e.height/2-i.height/2;else{i.y=i.startY+i.totalHeight/2-i.height/2;for(var r=1;r<n;r++){var o=t[r];o.startY=t[r-1].startY+t[r-1].totalHeight,o.y=o.startY+o.totalHeight/2-o.height/2}}}})),JF(e)},nB=EF,iB=sF,rB=function(e){var t,n;function i(){return e.apply(this,arguments)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.execute=function(){return nB(this.rootNode,this.options,tB)},i}(dF),oB={};var sB={compactBox:TF,dendrogram:VF,indented:XF,mindmap:function(e,t){return t=iB.assign({},oB,t),new rB(e,t).execute()}},aB=pg.traverseTree,lB=Object.freeze(Object.defineProperty({__proto__:null,proccessToFunc:function(e,t){return e?Or(e)?function(t){return e}:e:function(e){return t||1}},buildTextureData:function(e,t){var n=[],i=[],r={},o=0;for(o=0;o<e.length;o++){var s=e[o];r[s.id]=o,n.push(s.x),n.push(s.y),n.push(0),n.push(0),i.push([])}for(o=0;o<t.length;o++){var a=t[o];i[r[a.source]].push(r[a.target]),i[r[a.target]].push(r[a.source])}var l=0;for(o=0;o<e.length;o++){var c=n.length,u=i[o],h=u.length;n[4*o+2]=c,n[4*o+3]=u.length,l=Math.max(l,u.length);for(var d=0;d<h;++d){var f=u[d];n.push(+f)}}for(;n.length%4!=0;)n.push(0);return{array:new Float32Array(n),maxEdgePerVetex:l}},buildTextureDataWithOneEdgeAttr:function(e,t,n){var i=[],r=[],o={},s=0;for(s=0;s<e.length;s++){var a=e[s];o[a.id]=s,i.push(a.x),i.push(a.y),i.push(0),i.push(0),r.push([])}for(s=0;s<t.length;s++){var l=t[s];r[o[l.source]].push(o[l.target]),r[o[l.source]].push(n(l)),r[o[l.target]].push(o[l.source]),r[o[l.target]].push(n(l))}var c=0;for(s=0;s<e.length;s++){var u=i.length,h=r[s],d=h.length;i[4*s+2]=u,i[4*s+3]=d/2,c=Math.max(c,d/2);for(var f=0;f<d;++f){var g=h[f];i.push(+g)}}for(;i.length%4!=0;)i.push(0);return{array:new Float32Array(i),maxEdgePerVetex:c}},buildTextureDataWithTwoEdgeAttr:function(e,t,n,i){var r=[],o=[],s={},a=0;for(a=0;a<e.length;a++){var l=e[a];s[l.id]=a,r.push(l.x),r.push(l.y),r.push(0),r.push(0),o.push([])}for(a=0;a<t.length;a++){var c=t[a];o[s[c.source]].push(s[c.target]),o[s[c.source]].push(n(c)),o[s[c.source]].push(i(c)),o[s[c.source]].push(0),o[s[c.target]].push(s[c.source]),o[s[c.target]].push(n(c)),o[s[c.target]].push(i(c)),o[s[c.target]].push(0)}var u=0;for(a=0;a<e.length;a++){var h=r.length,d=o[a],f=d.length;r[4*a+2]=h+1048576*f/4,r[4*a+3]=0,u=Math.max(u,f/4);for(var g=0;g<f;++g){var p=d[g];r.push(+p)}}for(;r.length%4!=0;)r.push(0);return{array:new Float32Array(r),maxEdgePerVetex:u}},attributesToTextureData:function(e,t){var n=[],i=e.length,r={};return t.forEach((function(t){e.forEach((function(e,o){if(void 0===r[t[e]]&&(r[t[e]]=Object.keys(r).length),n.push(r[t[e]]),o===i-1)for(;n.length%4!=0;)n.push(0)}))})),{array:new Float32Array(n),count:Object.keys(r).length}},arrayToTextureData:function(e){for(var t=[],n=e.length,i=e[0].length,r=function(i){e.forEach((function(e,r){if(t.push(e[i]),r===n-1)for(;t.length%4!=0;)t.push(0)}))},o=0;o<i;o++)r(o);return new Float32Array(t)},radialLayout:function(e,t){var n={x:1/0,y:1/0},i={x:-1/0,y:-1/0},r="x",o="y";t&&["V","TB","BT"].indexOf(t)>=0&&(o="x",r="y");var s=0;aB(e,(function(e){return s++,e.x>i.x&&(i.x=e.x),e.x<n.x&&(n.x=e.x),e.y>i.y&&(i.y=e.y),e.y<n.y&&(n.y=e.y),!0}));var a=2*Math.PI/s,l=i[o]-n[o];return 0===l||aB(e,(function(t){var i=(t[o]-n[o])/l*(2*Math.PI-a)+a,s=Math.abs("x"===r?t.x-e.x:t.y-e.y);return t.x=s*Math.cos(i),t.y=s*Math.sin(i),!0})),e}},Symbol.toStringTag,{value:"Module"})),cB=function e(){return"undefined"==typeof window||"undefined"==typeof document?{}:{canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(zWe){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(t){var n=void 0!==(t=t||{}).parent?t.parent:document.body,i=void 0!==t.id?t.id:"oldie",r=e().getWebGLErrorMessage();r.id=i,n.appendChild(r)}}},uB=Object.freeze(Object.defineProperty({__proto__:null,gpuDetector:cB},Symbol.toStringTag,{value:"Module"})),hB=$i($i($i($i({},pg),ab),lB),uB),dB=hB.radialLayout,fB=function(){function e(e){this.type=e.type,this.radial=e.radial,this.config=e}return e.prototype.init=function(e){var t=this;this.data=e,this.radial?this.layoutMethod=function(e){var n=sB[t.type](e,t.config);return dB(n),n}:this.layoutMethod=function(e){return sB[t.type](e,t.config)}},e.prototype.execute=function(){return this.layoutMethod(this.data,this.config)},e.prototype.layout=function(e){return this.init(e),this.execute()},e}();Tb("grid",Mb),Tb("random",Ab),Tb("force",Mw),Tb("circular",Ow),Tb("dagre",Hx),Tb("radial",_E),Tb("concentric",bE),Tb("mds",wE),Tb("fruchterman",CE),Tb("fruchterman-gpu",VP),Tb("gForce",Rb),Tb("gForce-gpu",HP),Tb("comboForce",jP),Tb("forceAtlas2",$P);var gB=function(e,t){var n=e.toString(),i=new Blob(["importScripts('".concat(t,"');(").concat(n,")()")],{type:"text/javascript"});return new Worker(URL.createObjectURL(i))},pB=function(e){return void 0===e&&(e="https://unpkg.com/@antv/layout@latest/dist/layout.min.js"),new gB((function(){var e="LAYOUT_RUN",t="LAYOUT_END",n="LAYOUT_ERROR",i="GPU_LAYOUT_RUN";layout.registerLayout("grid",layout.GridLayout),layout.registerLayout("random",layout.RandomLayout),layout.registerLayout("force",layout.ForceLayout),layout.registerLayout("circular",layout.CircularLayout),layout.registerLayout("dagre",layout.DagreLayout),layout.registerLayout("radial",layout.RadialLayout),layout.registerLayout("concentric",layout.ConcentricLayout),layout.registerLayout("mds",layout.MDSLayout),layout.registerLayout("fruchterman",layout.FruchtermanLayout),layout.registerLayout("fruchterman-gpu",layout.FruchtermanGPULayout),layout.registerLayout("gForce",layout.GForceLayout),layout.registerLayout("gForce-gpu",layout.GForceGPULayout),layout.registerLayout("comboForce",layout.ComboForceLayout),layout.registerLayout("forceAtlas2",layout.ForceAtlas2Layout),onmessage=function(r){(function(t){var n=t.data.type;return n===e||n===i})(r)&&function(r){var o=this;switch(r.data.type){case e:var s,a=r.data,l=a.nodes,c=a.edges,u=a.layoutCfg,h=(m=void 0===u?{}:u).type;if(!(d=layout.getLayoutByName(h))){this.postMessage({type:n,message:"layout ".concat(h," not found")});break}m.onLayoutEnd=function(){o.postMessage({type:t,nodes:l}),null==s||s.destroy()},(s=new d(m)).init({nodes:l,edges:c}),s.execute();break;case i:var d,f=r.data,g=f.nodes,p=(c=f.edges,f.layoutCfg),m=void 0===p?{}:p,v=f.canvas;if(h=m.type,!(d=layout.getLayoutByName(h))){this.postMessage({type:n,message:"layout ".concat(h," not found")});break}if("gpu"!==h.split("-")[1]){this.postMessage({type:n,message:"layout ".concat(h," does not support GPU")});break}var y=new d(m);y.init({nodes:g,edges:c}),y.executeWithWorker(v,this)}}(r)}}),e)},mB="LAYOUT_RUN",vB="LAYOUT_END",yB="LAYOUT_ERROR",_B="LAYOUT_TICK",bB="GPU_LAYOUT_RUN",wB="GPU_LAYOUT_END";function CB(e){return(CB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var SB=function(e){return setTimeout(e,16)},xB=function(e){return clearTimeout(e)},EB=function(e){return("undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame)||SB)(e)},kB=function(e){return("undefined"!=typeof window&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame)||xB)(e)},LB=["fruchterman","gForce"],DB=["force","grid","circular"],NB=function(e){function t(t){var n=e.call(this,t)||this;return n.graph=t,n.layoutCfg=t.get("layout")||{},n.layoutType=n.getLayoutType(),n.worker=null,n.workerData={},n.initLayout(),n}return qi(t,e),t.prototype.initLayout=function(){},t.prototype.getWorker=function(){return this.worker||("undefined"==typeof Worker?(console.warn("Web worker is not supported in current browser."),this.worker=null):this.worker=pB(this.layoutCfg.workerScriptURL)),this.worker},t.prototype.stopWorker=function(){var e=this.workerData;this.worker&&(this.worker.terminate(),this.worker=null,e.requestId&&(kB(e.requestId),e.requestId=null),e.requestId2&&(kB(e.requestId2),e.requestId2=null))},t.prototype.execLayoutMethod=function(e,t){var n=this;return new Promise((function(i,r){return Xi(n,void 0,void 0,(function(){var n,o,s,a,l,c,u;return Zi(this,(function(h){switch(h.label){case 0:if(!(n=this.graph)||n.get("destroyed"))return[2];o=e.type,e.onLayoutEnd=function(){n.emit("aftersublayout",{type:o}),i()},o&&this.isGPU&&(this.hasGPUVersion(o)?o="".concat(o,"-gpu"):console.warn("The '".concat(o,"' layout does not support GPU calculation for now, it will run in CPU."))),"force"===o||"g6force"===o||"gForce"===o?(s=e.onTick,c=function(){s&&s(),n.refreshPositions()},e.tick=c):"comboForce"===e.type&&(e.comboTrees=n.get("comboTrees")),!1;try{a=new oF[o](e)}catch(zWe){console.warn("The layout method: '".concat(o,"' does not exist! Please specify it first.")),r()}return a.enableTick&&(l=e.onTick,c=function(){l&&l(),n.refreshPositions()},a.tick=c),function(e,t){var n;if(!(null===(n=null==e?void 0:e.nodes)||void 0===n?void 0:n.length))return;e.nodes.forEach((function(e){e.layoutOrder=t}))}(u=this.filterLayoutData(this.data,e),t),a.init(u),n.emit("beforesublayout",{type:o}),[4,a.execute()];case 1:return h.sent(),a.isCustomLayout&&e.onLayoutEnd&&e.onLayoutEnd(),this.layoutMethods[t]=a,[2]}}))}))}))},t.prototype.updateLayoutMethod=function(e,t){var n=this;return new Promise((function(i,r){return Xi(n,void 0,void 0,(function(){var n,r,o;return Zi(this,(function(s){switch(s.label){case 0:return n=this.graph,r=null==t?void 0:t.type,t.onLayoutEnd=function(){n.emit("aftersublayout",{type:r}),i()},o=this.filterLayoutData(this.data,t),e.init(o),e.updateCfg(t),n.emit("beforesublayout",{type:r}),[4,e.execute()];case 1:return s.sent(),e.isCustomLayout&&t.onLayoutEnd&&t.onLayoutEnd(),[2]}}))}))}))},t.prototype.layout=function(e){var t=this,n=this.graph;this.data=this.setDataFromGraph();var i=this.data,r=i.nodes,o=i.hiddenNodes;if(!r)return!1;var s=n.get("width"),a=n.get("height"),l={};Object.assign(l,{width:s,height:a,center:[s/2,a/2]},this.layoutCfg),this.layoutCfg=l,this.destoryLayoutMethods(),n.emit("beforelayout"),this.initPositions(l.center,r),this.initPositions(l.center,o);var c=l.type;c&&"gpu"===c.split("-")[1]&&(c=c.split("-")[0],l.gpuEnabled=!0);var u=!1;l.gpuEnabled&&(u=!0,cB().webgl||(console.warn("Your browser does not support webGL or GPGPU. The layout will run in CPU."),u=!1)),this.isGPU=u;var h=l.onLayoutEnd,d=l.layoutEndFormatted,f=l.adjust;if(d||(l.layoutEndFormatted=!0,l.onAllLayoutEnd=function(){return Xi(t,void 0,void 0,(function(){return Zi(this,(function(e){switch(e.label){case 0:return h&&h(),this.refreshLayout(),f&&l.pipes?[4,this.adjustPipesBox(this.data,f)]:[3,2];case 1:e.sent(),this.refreshLayout(),e.label=2;case 2:return n.emit("afterlayout"),[2]}}))}))}),this.stopWorker(),l.workerEnabled&&this.layoutWithWorker(this.data))return!0;var g=Promise.resolve();return l.type?g=g.then((function(){return Xi(t,void 0,void 0,(function(){return Zi(this,(function(e){switch(e.label){case 0:return[4,this.execLayoutMethod(l,0)];case 1:return[2,e.sent()]}}))}))})):l.pipes&&l.pipes.forEach((function(e,n){g=g.then((function(){return Xi(t,void 0,void 0,(function(){return Zi(this,(function(t){switch(t.label){case 0:return[4,this.execLayoutMethod(e,n)];case 1:return[2,t.sent()]}}))}))}))})),g.then((function(){l.onAllLayoutEnd&&l.onAllLayoutEnd(),e&&e()})).catch((function(e){console.warn("graph layout failed,",e)})),!1},t.prototype.layoutWithWorker=function(e){var t=this,n=this.layoutCfg,i=this.graph,r=this.getWorker(),o=this.workerData;if(!r)return!1;o.requestId=null,o.requestId2=null,o.currentTick=null,o.currentTickData=null,i.emit("beforelayout");var s=Promise.resolve();if(n.type)s=s.then((function(){return t.runWebworker(r,e,n)}));else if(n.pipes)for(var a=function(n){s=s.then((function(){return t.runWebworker(r,e,n)}))},l=0,c=n.pipes;l<c.length;l++){a(c[l])}return s.then((function(){n.onAllLayoutEnd&&n.onAllLayoutEnd()})).catch((function(e){console.error("layout failed",e)})),!0},t.prototype.runWebworker=function(e,t,n){var i=this,r=this.isGPU,o=this.filterLayoutData(t,n),s=o.nodes,a=o.edges,l=document.createElement("canvas"),c=r&&"undefined"!=typeof window&&window.navigator&&!navigator.gpu&&"OffscreenCanvas"in window&&"transferControlToOffscreen"in l,u=function(e,t){var n={};if(e&&"object"===CB(e))return Object.keys(e).forEach((function(i){e.hasOwnProperty(i)&&t(e[i])&&(n[i]=e[i])})),n;return e}(n,(function(e){return"function"!=typeof e}));if(c){var h=l.transferControlToOffscreen();u.type="".concat(u.type,"-gpu"),e.postMessage({type:bB,nodes:s,edges:a,layoutCfg:u,canvas:h},[h])}else e.postMessage({type:mB,nodes:s,edges:a,layoutCfg:u});return new Promise((function(t,r){e.onmessage=function(e){i.handleWorkerMessage(t,r,e,o,n)}}))},t.prototype.handleWorkerMessage=function(e,t,n,i,r){var o=this.graph,s=this.workerData,a=n.data,l=a.type,c=function(){r.onTick&&r.onTick()};switch(l){case _B:s.currentTick=a.currentTick,s.currentTickData=a,s.requestId||(s.requestId=EB((function(){IB(i,a),o.refreshPositions(),c(),a.currentTick===a.totalTicks?e():s.currentTick===a.totalTicks&&(s.requestId2=EB((function(){IB(i,s.currentTickData),o.refreshPositions(),s.requestId2=null,c(),e()}))),s.requestId=null})));break;case vB:null==s.currentTick&&(IB(i,a),e());break;case wB:null==s.currentTick&&(!function(e,t){for(var n=e.nodes,i=t.vertexEdgeData,r=n.length,o=0;o<r;o++){var s=n[o],a=i[4*o],l=i[4*o+1];s.x=a,s.y=l}}(i,a),e());break;case yB:console.warn("Web-Worker layout error!",a.message),t();break;default:t()}},t.prototype.updateLayoutCfg=function(e){var t=this,n=this.graph,i=this.layoutMethods,r=to({},this.layoutCfg,e);if(this.layoutCfg=r,null==i?void 0:i.length){if(this.data=this.setDataFromGraph(),this.stopWorker(),!e.workerEnabled||!this.layoutWithWorker(this.data)){n.emit("beforelayout");var o=Promise.resolve();1===i.length?o=o.then((function(){return Xi(t,void 0,void 0,(function(){return Zi(this,(function(e){switch(e.label){case 0:return[4,this.updateLayoutMethod(i[0],r)];case 1:return[2,e.sent()]}}))}))})):null==i||i.forEach((function(e,n){var i=r.pipes[n];o=o.then((function(){return Xi(t,void 0,void 0,(function(){return Zi(this,(function(t){switch(t.label){case 0:return[4,this.updateLayoutMethod(e,i)];case 1:return[2,t.sent()]}}))}))}))})),o.then((function(){r.onAllLayoutEnd&&r.onAllLayoutEnd()})).catch((function(e){console.warn("layout failed",e)}))}}else this.layout()},t.prototype.adjustPipesBox=function(e,t){var n=this;return new Promise((function(i){var r=e.nodes;(null==r?void 0:r.length)||i(),DB.includes(t)||(console.warn("The adjust type ".concat(t," is not supported yet, please assign it with 'force', 'grid', or 'circular'.")),i());var o={center:n.layoutCfg.center,nodeSize:function(e){return Math.max(e.height,e.width)},preventOverlap:!0,onLayoutEnd:function(){}},s=n.getLayoutBBox(r),a=s.groupNodes,l=s.layoutNodes,c=no(l);o.onLayoutEnd=function(){null==l||l.forEach((function(e,t){var n,i,r,o=e.x-(null===(n=c[t])||void 0===n?void 0:n.x),s=e.y-(null===(i=c[t])||void 0===i?void 0:i.y);null===(r=a[t])||void 0===r||r.forEach((function(e){e.x+=o,e.y+=s}))})),i()},new oF[t](o).layout({nodes:l})}))},t.prototype.hasGPUVersion=function(e){return LB.includes(e)},t.prototype.destroy=function(){this.destoryLayoutMethods();var e=this.worker;e&&(e.terminate(),this.worker=null),this.destroyed=!0,this.graph.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0,this.graph=null},t}(mg);function IB(e,t){for(var n=e.nodes,i=t.nodes,r=n.length,o=0;o<r;o++){var s=n[o];s.x=i[o].x,s.y=i[o].y}}var TB,MB=Us,AB=function(e){function t(t){var n=e.call(this,t)||this,i=n.get("defaultNode");return i||n.set("defaultNode",{type:"circle"}),i.type||(i.type="circle",n.set("defaultNode",i)),n.destroyed=!1,n}return qi(t,e),t.prototype.initLayoutController=function(){var e=new NB(this);this.set({layoutController:e})},t.prototype.initEventController=function(){var e=new pb(this);this.set({eventController:e})},t.prototype.initCanvas=function(){var e=this.get("container");if("string"==typeof e&&(e=document.getElementById(e),this.set("container",e)),!e)throw new Error("invalid container");var t,n=e.clientWidth,i=e.clientHeight,r=this.get("width")||n,o=this.get("height")||i;if(this.get("width")||this.get("height")||(this.set("width",n),this.set("height",i)),"svg"===this.get("renderer"))t=new n_({container:e,width:r,height:o});else{var s={container:e,width:r,height:o},a=this.get("pixelRatio");a&&(s.pixelRatio=a),t=new py(s)}this.set("canvas",t)},t.prototype.initPlugins=function(){var e=this;cr(e.get("plugins"),(function(t){!t.destroyed&&t.initPlugin&&t.initPlugin(e)}))},t.prototype.downloadImageWatermark=function(e,t,n,i){return Xi(this,void 0,void 0,(function(){var r,o,s;return Zi(this,(function(a){switch(a.label){case 0:return r=e.style.backgroundImage,o=r.slice(5,r.length-2),(s=new Image).src=o,[4,new Promise((function(e){s.onload=function(){var r=t.createPattern(s,"repeat");t.rect(0,0,n,i),t.fillStyle=r,t.fill(),e("")}}))];case 1:return a.sent(),[2]}}))}))},t.prototype.asyncToDataUrl=function(e,t,n,i,r,o){var s=this,a=document.querySelector(".g6-graph-watermarker"),l=this.get("canvas"),c=l.getRenderer(),u=o||l.get("el"),h="";e||(e="image/png"),setTimeout((function(){return Xi(s,void 0,void 0,(function(){var o,s,l,d,f,g,p,m,v,y;return Zi(this,(function(_){switch(_.label){case 0:return"svg"!==c?[3,1]:(o=u.cloneNode(!0),s=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),(l=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",s)).replaceChild(o,l.documentElement),d=(new XMLSerializer).serializeToString(l),h="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(d)),[3,4]);case 1:return f=void 0,g=u.getContext("2d"),p=i||this.get("width"),m=r||this.get("height"),v=void 0,a?[4,this.downloadImageWatermark(a,g,p,m)]:[3,3];case 2:_.sent(),_.label=3;case 3:if(t){y="undefined"!=typeof window?window.devicePixelRatio:1;try{f=g.getImageData(0,0,p*y,m*y),v=g.globalCompositeOperation,g.globalCompositeOperation="destination-over",g.fillStyle=t,g.fillRect(0,0,p,m)}catch(b){console.error("Download image failed. Out of memory at ImageData creation")}}h=u.toDataURL(e),t&&(g.clearRect(0,0,p,m),g.putImageData(f,0,0),g.globalCompositeOperation=v),_.label=4;case 4:return n&&n(h),[2]}}))}))}),16)},t.prototype.toDataURL=function(e,t){var n=this.get("canvas"),i=n.getRenderer(),r=n.get("el");e||(e="image/png");var o="";if("svg"===i){var s=r.cloneNode(!0),a=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),l=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",a);l.replaceChild(s,l.documentElement);var c=(new XMLSerializer).serializeToString(l);o="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(c))}else{var u=void 0,h=r.getContext("2d"),d=this.get("width"),f=this.get("height"),g=void 0;if(t){var p="undefined"!=typeof window?window.devicePixelRatio:1;try{u=h.getImageData(0,0,d*p,f*p),g=h.globalCompositeOperation,h.globalCompositeOperation="destination-over",h.fillStyle=t,h.fillRect(0,0,d,f)}catch(m){console.error("Download image failed. Out of memory at ImageData creation")}}o=r.toDataURL(e),t&&(h.clearRect(0,0,d,f),h.putImageData(u,0,0),h.globalCompositeOperation=g)}return o},t.prototype.toFullDataURL=function(e,t,n){var i=this.get("group").getCanvasBBox(),r=i.height,o=i.width,s=this.get("renderer"),a=hb('<div id="virtual-image"></div>'),l=n?n.backgroundColor:void 0,c=n?n.padding:void 0;c?Or(c)&&(c=[c,c,c,c]):c=[0,0,0,0];var u=r+c[0]+c[2],h=o+c[1]+c[3],d={container:a,height:u,width:h,quickHit:!0},f="svg"===s?new n_(d):new py(d),g=this.get("group").clone(),p=no(g.getMatrix());p||(p=[1,0,0,0,1,0,0,0,1]);var m=(i.maxX+i.minX)/2,v=(i.maxY+i.minY)/2;p=MB(p,[["t",-m,-v],["t",o/2+c[3],r/2+c[0]]]),g.resetMatrix(),g.setMatrix(p),f.add(g);var y=f.get("el"),_="";t||(t="image/png"),setTimeout((function(){if("svg"===s){var n=y.cloneNode(!0),i=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),r=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",i);r.replaceChild(n,r.documentElement);var o=(new XMLSerializer).serializeToString(r);_="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(o))}else{var a=void 0,c=y.getContext("2d"),d=void 0;if(l){var f="undefined"!=typeof window?window.devicePixelRatio:1;try{a=c.getImageData(0,0,h*f,u*f),d=c.globalCompositeOperation,c.globalCompositeOperation="destination-over",c.fillStyle=l,c.fillRect(0,0,h,u)}catch(g){console.error("Download image failed. Out of memory at ImageData creation")}}_=y.toDataURL(t),l&&(c.clearRect(0,0,h,u),c.putImageData(a,0,0),c.globalCompositeOperation=d)}e&&e(_)}),16)},t.prototype.downloadFullImage=function(e,t,n){var i=this,r=this.get("group").getCanvasBBox(),o=r.height,s=r.width,a=this.get("renderer"),l=hb('<div id="virtual-image"></div>'),c=document.querySelector(".g6-graph-watermarker"),u=n?n.backgroundColor:void 0,h=n?n.padding:void 0;h?Or(h)&&(h=[h,h,h,h]):h=[0,0,0,0];var d=o+h[0]+h[2],f=s+h[1]+h[3];if(c){var g=this.get("graphWaterMarker").cfg||{},p=g.width,m=g.height;d=Math.ceil(d/m)*m,f=Math.ceil(f/p)*p}var v={container:l,height:d,width:f},y="svg"===a?new n_(v):new py(v),_=this.get("group").clone(),b=no(_.getMatrix());b||(b=[1,0,0,0,1,0,0,0,1]);var w=(r.maxX+r.minX)/2,C=(r.maxY+r.minY)/2;b=MB(b,[["t",-w,-C],["t",s/2+h[3],o/2+h[0]]]),_.resetMatrix(),_.setMatrix(b),y.add(_);var S=y.get("el");t||(t="image/png"),this.asyncToDataUrl(t,u,(function(n){var r=document.createElement("a"),o=(e||"graph")+("svg"===a?".svg":".".concat(t.split("/")[1]));i.dataURLToImage(n,a,r,o);var s=document.createEvent("MouseEvents");s.initEvent("click",!1,!1),r.dispatchEvent(s)}),f,d,S)},t.prototype.downloadImage=function(e,t,n){var i=this,r=this;r.isAnimating()&&r.stopAnimate();var o=r.get("canvas").getRenderer();t||(t="image/png");var s=(e||"graph")+("svg"===o?".svg":t.split("/")[1]),a=document.createElement("a");r.asyncToDataUrl(t,n,(function(e){i.dataURLToImage(e,o,a,s);var t=document.createEvent("MouseEvents");t.initEvent("click",!1,!1),a.dispatchEvent(t)}))},t.prototype.dataURLToImage=function(e,t,n,i){if(e&&"data:"!==e){if("undefined"!=typeof window)if(window.Blob&&window.URL&&"svg"!==t){var r=e.split(","),o="";if(r&&r.length>0){var s=r[0].match(/:(.*?);/);s&&s.length>=2&&(o=s[1])}for(var a=atob(r[1]),l=a.length,c=new Uint8Array(l);l--;)c[l]=a.charCodeAt(l);var u=new Blob([c],{type:o});window.navigator.msSaveBlob?window.navigator.msSaveBlob(u,i):n.addEventListener("click",(function(){n.download=i,n.href=window.URL.createObjectURL(u)}))}else n.addEventListener("click",(function(){n.download=i,n.href=e}))}else console.error("Download image failed. The graph is too large or there is invalid attribute values in graph items")},t.prototype.addPlugin=function(e){e.destroyed||(this.get("plugins").push(e),e.initPlugin(this))},t.prototype.removePlugin=function(e){var t=this.get("plugins"),n=t.indexOf(e);n>=0&&(e.destroyPlugin(),t.splice(n,1))},t.prototype.setImageWaterMarker=function(e,t){void 0===e&&(e=cb.waterMarkerImage);var n=this.get("container");xr(n)&&(n=document.getElementById(n)),n.style.position||(n.style.position="relative");var i=this.get("graphWaterMarker"),r=so({},cb.imageWaterMarkerConfig,t),o=r.width,s=r.height,a=r.compatible,l=r.image;if(!i){var c={container:n,width:o,height:s,capture:!1},u=this.get("pixelRatio");u&&(c.pixelRatio=u),i=new py(c),this.set("graphWaterMarker",i)}i.get("el").style.display="none";var h=i.get("context"),d=l.rotate,f=l.x,g=l.y;h.rotate(-d*Math.PI/180);var p=new Image;p.crossOrigin="anonymous",p.src=e,p.onload=function(){if(h.drawImage(p,f,g,l.width,l.height),h.rotate(d*Math.PI/180),a)n.style.cssText="background-image: url(".concat(i.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var e=document.querySelector(".g6-graph-watermarker");e||((e=document.createElement("div")).className="g6-graph-watermarker"),e.className="g6-graph-watermarker",i.destroyed||(e.style.cssText="background-image: url(".concat(i.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;"),n.appendChild(e))}}},t.prototype.setTextWaterMarker=function(e,t){var n=this.get("container");xr(n)&&(n=document.getElementById(n)),n.style.position||(n.style.position="relative");var i=this.get("graphWaterMarker"),r=so({},cb.textWaterMarkerConfig,t),o=r.width,s=r.height,a=r.compatible,l=r.text;if(!i){var c={container:n,width:o,height:s,capture:!1},u=this.get("pixelRatio");u&&(c.pixelRatio=u),i=new py(c),this.set("graphWaterMarker",i)}i.get("el").style.display="none";var h=i.get("context"),d=l.rotate,f=l.fill,g=l.fontFamily,p=l.fontSize,m=l.baseline,v=l.x,y=l.y,_=l.lineHeight;h.rotate(-d*Math.PI/180),h.font="".concat(p,"px ").concat(g),h.fillStyle=f,h.textBaseline=m;for(var b=e.length-1;b>=0;b--)h.fillText(e[b],v,y+b*_);if(h.rotate(d*Math.PI/180),a)n.style.cssText="background-image: url(".concat(i.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var w=document.querySelector(".g6-graph-watermarker");w||((w=document.createElement("div")).className="g6-graph-watermarker"),w.style.cssText="background-image: url(".concat(i.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;"),n.appendChild(w)}},t.prototype.destroy=function(){var t,n,i,r;cr(this.get("plugins"),(function(e){e.destroyPlugin()}));var o=this.get("tooltips");if(o)for(var s=0;s<o.length;s++){var a=o[s];if(a){var l=a.parentElement;l&&l.removeChild(a)}}null===(t=this.get("eventController"))||void 0===t||t.destroy(),null===(n=this.get("layoutController"))||void 0===n||n.destroy(),null===(i=this.get("graphWaterMarker"))||void 0===i||i.destroy(),null===(r=document.querySelector(".g6-graph-watermarker"))||void 0===r||r.remove(),e.prototype.destroy.call(this)},t}(Zf),OB=hB.radialLayout,RB=hB.traverseTree,PB=function(e){function t(t){var n=e.call(this,t)||this;return n.layoutAnimating=!1,n.set("removeList",[]),n.set("layoutMethod",n.getLayout()),n}return qi(t,e),t.prototype.getLayout=function(){var e=this.get("layout");return e?"function"==typeof e?e:(e.type||(e.type="dendrogram"),e.direction||(e.direction="TB"),e.radial?function(t){var n=sB[e.type](t,e);return OB(n),n}:function(t){return sB[e.type](t,e)}):null},t.indexOfChild=function(e,t){var n=-1;return cr(e,(function(e,i){if(t===e.id)return n=i,!1})),n},t.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.animate=!0,t},t.prototype.innerAddChild=function(e,t,n){var i=this,r=e.data;r&&(r.x=e.x,r.y=e.y,r.depth=e.depth);var o=i.addItem("node",r,!1);if(t){if(o.set("parent",t),n){var s=t.get("originAttrs");if(s)o.set("originAttrs",s);else{var a=t.getModel();o.set("originAttrs",{x:a.x,y:a.y})}}var l=t.get("children");l?l.push(o):t.set("children",[o]),i.addItem("edge",{source:t.get("id"),target:o.get("id"),id:"".concat(t.get("id"),":").concat(o.get("id"))},!1)}return cr(e.children||[],(function(e){i.innerAddChild(e,o,n)})),i.emit("afteraddchild",{item:o,parent:t}),o},t.prototype.innerUpdateChild=function(e,n,i){var r=this,o=r.findById(e.id);if(o){cr(e.children||[],(function(e){r.innerUpdateChild(e,o,i)}));var s,a,l=o.get("children");if(l)if(l.length>0)for(var c=l.length-1;c>=0;c--){var u=l[c].getModel();-1===t.indexOfChild(e.children||[],u.id)&&(r.innerRemoveChild(u.id,{x:e.x,y:e.y},i),l.splice(c,1))}o.get("originAttrs")&&(s=o.get("originAttrs").x,a=o.get("originAttrs").y);var h=o.getModel();i&&o.set("originAttrs",{x:h.x,y:h.y}),o.set("model",e.data),s===e.x&&a===e.y||o.updatePosition({x:e.x,y:e.y})}else r.innerAddChild(e,n,i)},t.prototype.innerRemoveChild=function(e,t,n){var i=this,r=i.findById(e);if(r)if(cr(r.get("children"),(function(e){i.innerRemoveChild(e.getModel().id,t,n)})),n){var o=r.getModel();r.set("to",t),r.set("originAttrs",{x:o.x,y:o.y}),i.get("removeList").push(r)}else i.removeItem(r,!1)},t.prototype.changeData=function(e){var t=this;this.getNodes().map((function(e){return t.clearItemStates(e)})),this.getEdges().map((function(e){return t.clearItemStates(e)})),e?(t.data(e),t.render()):t.layout(this.get("fitView"))},t.prototype.changeLayout=function(e){console.warn("Please call updateLayout instead of changeLayout. changeLayout will be discarded soon");this.updateLayout(e)},t.prototype.updateLayout=function(e){var t=this;e?(t.set("layout",e),t.set("layoutMethod",t.getLayout()),t.layout()):console.warn("layout cannot be null")},t.prototype.refreshLayout=function(e){console.warn("Please call layout instead of refreshLayout. refreshLayout will be discarded soon");this.layout(e)},t.prototype.layout=function(e){var t=this,n=t.get("data"),i=t.get("layoutMethod"),r=i?i(n,t.get("layout")):n,o=t.get("animate");(t.emit("beforerefreshlayout",{data:n,layoutData:r}),t.emit("beforelayout"),t.innerUpdateChild(r,void 0,o),e)&&t.get("viewController").fitView();o?t.layoutAnimate(r):(t.refresh(),t.paint()),t.emit("afterrefreshlayout",{data:n,layoutData:r}),t.emit("afterlayout")},t.prototype.addChild=function(e,t){var n=this;n.emit("beforeaddchild",{model:e,parent:t}),xr(t)||(t=t.get("id"));var i=n.findDataById(t);i&&(i.children||(i.children=[]),i.children.push(e),n.changeData())},t.prototype.updateChildren=function(e,t){var n=this;t&&n.findById(t)?(n.findDataById(t).children=e,n.changeData()):console.warn("Update children failed! There is no node with id '".concat(t,"'"))},t.prototype.updateChild=function(e,n){var i=this;if(n&&i.findById(n)){var r=i.findDataById(n),o=i.findById(e.id);if(r.children||(r.children=[]),o){var s=t.indexOfChild(r.children,e.id);r.children[s]=e}else r.children.push(e);i.changeData()}else i.changeData(e)},t.prototype.removeChild=function(e){var n=this,i=n.findById(e);if(i){var r=i.get("parent");if(r&&!r.destroyed){var o=n.findDataById(r.get("id")),s=o&&o.children||[],a=i.getModel(),l=t.indexOfChild(s,a.id);s.splice(l,1)}n.changeData()}},t.prototype.findDataById=function(e,t){var n=this;if(t||(t=n.get("data")),e===t.id)return t;var i=null;return cr(t.children||[],(function(t){return t.id===e?(i=t,!1):!(i=n.findDataById(e,t))&&void 0})),i},t.prototype.layoutAnimate=function(e,t){var n=this,i=this.get("animateCfg");n.emit("beforeanimate",{data:e}),n.getEdges().forEach((function(e){var t=e.get("model");t.sourceAnchor||(t.sourceAnchor=e.get("sourceAnchorIndex"))})),this.get("canvas").animate((function(i){RB(e,(function(r){var o=n.findById(r.id);if(o){var s=o.get("originAttrs"),a=o.get("model");if(s||(s={x:a.x,y:a.y},o.set("originAttrs",s)),t){var l=t(o,i,s,e);o.set("model",Object.assign(a,l))}else a.x=s.x+(r.x-s.x)*i,a.y=s.y+(r.y-s.y)*i}return!0})),cr(n.get("removeList"),(function(e){var t=e.getModel(),n=e.get("originAttrs"),r=e.get("to");t.x=n.x+(r.x-n.x)*i,t.y=n.y+(r.y-n.y)*i})),n.refreshPositions()}),{duration:i.duration,easing:i.ease,callback:function(){cr(n.getNodes(),(function(e){e.set("originAttrs",null)})),cr(n.get("removeList"),(function(e){n.removeItem(e)})),n.set("removeList",[]),i.callback&&i.callback(),n.emit("afteranimate",{data:e})},delay:i.delay})},t.prototype.stopLayoutAnimate=function(){this.get("canvas").stopAnimate(),this.emit("layoutanimateend",{data:this.get("data")}),this.layoutAnimating=!1},t.prototype.isLayoutAnimating=function(){return this.layoutAnimating},t.prototype.render=function(){var e=this,t=e.get("data");if(!t||!lr(t)||!Object.keys(t).length)throw new Error("data must be defined first");e.clear(),e.emit("beforerender"),e.layout(this.get("fitView")),e.emit("afterrender")},t.prototype.save=function(){return this.get("data")},t}(AB),FB=function(){function e(e){this._cfgs=so(this.getDefaultCfgs(),e),this._events={},this.destroyed=!1}return e.prototype.getDefaultCfgs=function(){return{}},e.prototype.initPlugin=function(e){var t=this;t.set("graph",e);var n=t.getEvents(),i={};cr(n,(function(n,r){var o=Tr(t,n);i[r]=o,e.on(r,o)})),this._events=i,this.init()},e.prototype.getEvents=function(){return{}},e.prototype.get=function(e){var t;return null===(t=this._cfgs)||void 0===t?void 0:t[e]},e.prototype.set=function(e,t){this._cfgs[e]=t},e.prototype.destroy=function(){},e.prototype.destroyPlugin=function(){this.destroy();var e=this.get("graph");cr(this._events,(function(t,n){e.off(n,t)})),this._events=null,this._cfgs=null,this.destroyed=!0},e}(),BB=(TB=function(e,t){return(TB=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}TB(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),WB="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)",zB=function(e){function t(t){return e.call(this,t)||this}return BB(t,e),t.prototype.getDefaultCfgs=function(){return{img:WB,follow:!0}},t.prototype.init=function(){var e=this.get("graph"),t=e.get("container"),n=e.get("canvas").get("el"),i=this.get("img")||WB,r=hb("<div class='g6-grid-container' style=\"position:absolute;overflow:hidden;z-index: -1;\"></div>"),o=hb("<div\n        class='g6-grid'\n        style='position:absolute;\n        background-image: ".concat(i,";\n        user-select: none\n        '></div>"));this.set("container",r),this.set("gridContainer",o),this.positionInit(),r.appendChild(o),t.insertBefore(r,n)},t.prototype.positionInit=function(){var e=this.get("graph"),t=e.get("minZoom"),n=e.get("width"),i=e.get("height");db(this.get("container"),{width:"".concat(n,"px"),height:"".concat(i,"px")});var r=80*n/t,o=80*i/t;db(this.get("gridContainer"),{width:"".concat(r,"px"),height:"".concat(o,"px"),left:"-".concat(r/2,"px"),top:"-".concat(o/2,"px")})},t.prototype.getEvents=function(){return{viewportchange:"updateGrid"}},t.prototype.updateGrid=function(e){var t=this.get("gridContainer"),n=e.matrix;n||(n=[1,0,0,0,1,0,0,0,1]);var i=this.get("follow");db(t,{transform:"matrix(".concat(n[0],", ").concat(n[1],", ").concat(n[3],", ").concat(n[4],", ").concat(i?n[6]:"0",", ").concat(i?n[7]:"0",")")})},t.prototype.getContainer=function(){return this.get("container")},t.prototype.destroy=function(){var e=this.get("graph").get("container"),t=this.get("container");e.removeChild(t)},t}(FB),VB={exports:{}},UB=[],HB=[];function jB(e,t){if(t=t||{},void 0===e)throw new Error("insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).");var n,i=!0===t.prepend?"prepend":"append",r=void 0!==t.container?t.container:document.querySelector("head"),o=UB.indexOf(r);return-1===o&&(o=UB.push(r)-1,HB[o]={}),void 0!==HB[o]&&void 0!==HB[o][i]?n=HB[o][i]:(n=HB[o][i]=function(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}(),"prepend"===i?r.insertBefore(n,r.childNodes[0]):r.appendChild(n)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),n.styleSheet?n.styleSheet.cssText+=e:n.textContent+=e,n}VB.exports=jB,VB.exports.insertCss=jB;var GB=VB.exports,KB=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();"undefined"!=typeof document&&GB("\n  .g6-component-contextmenu {\n    border: 1px solid #e2e2e2;\n    border-radius: 4px;\n    font-size: 12px;\n    color: #545454;\n    background-color: rgba(255, 255, 255, 0.9);\n    padding: 10px 8px;\n    box-shadow: rgb(174, 174, 174) 0px 0px 10px;\n  }\n  .g6-contextmenu-ul {\n    padding: 0;\n    margin: 0;\n    list-style: none;\n  }\n\n");var qB=function(e){function t(t){return e.call(this,t)||this}return KB(t,e),t.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,handleMenuClick:void 0,getContent:function(e){return"\n          <ul class='g6-contextmenu-ul'>\n            <li>菜单项1</li>\n            <li>菜单项2</li>\n          </ul>\n        "},shouldBegin:function(e){return!0},onHide:function(){return!0},itemTypes:["node","edge","combo"],trigger:"contextmenu"}},t.prototype.getEvents=function(){return"click"===this.get("trigger")?{click:"onMenuShow",touchend:"onMenuShow"}:{contextmenu:"onMenuShow"}},t.prototype.init=function(){var e=this.get("className"),t=hb("<div class=".concat(e||"g6-component-contextmenu","></div>"));db(t,{top:"0px",position:"absolute",visibility:"hidden"});var n=this.get("container");n||(n=this.get("graph").get("container")),xr(n)&&(n=document.getElementById(n)),n.appendChild(t),this.set("menu",t)},t.prototype.onMenuShow=function(e){var t=this;e.preventDefault();var n=this.get("itemTypes");if(e.item){if(e.item&&e.item.getType&&-1===n.indexOf(e.item.getType()))return void t.onMenuHide()}else if(-1===n.indexOf("canvas"))return void t.onMenuHide();if(this.get("shouldBegin")(e)){var i=this.get("menu"),r=this.get("getContent"),o=this.get("graph"),s=r(e,o);xr(s)?i.innerHTML=s:i.innerHTML=s.outerHTML,this.removeMenuEventListener();var a=this.get("handleMenuClick");if(a){var l=function(t){a(t.target,e.item,o)};this.set("handleMenuClickWrapper",l),i.addEventListener("click",l)}var c=o.get("width"),u=o.get("height"),h=i.getBoundingClientRect(),d=this.get("offsetX")||0,f=this.get("offsetY")||0,g=o.getContainer().offsetTop,p=o.getContainer().offsetLeft,m=e.canvasX+p+d,v=e.canvasY+g+f;m+h.width>c&&(m=e.canvasX-h.width-d+p),v+h.height>u&&(v=e.canvasY-h.height-f+g),db(i,{top:"".concat(v,"px"),left:"".concat(m,"px"),visibility:"visible"});var y="click"===this.get("trigger"),_=function(e){y?y=!1:t.onMenuHide()};document.body.addEventListener("click",_),this.set("handler",_)}},t.prototype.removeMenuEventListener=function(){var e=this.get("handleMenuClickWrapper"),t=this.get("handler");e&&(this.get("menu").removeEventListener("click",e),this.set("handleMenuClickWrapper",null));t&&document.body.removeEventListener("click",t)},t.prototype.onMenuHide=function(){var e=this.get("menu");e&&db(e,{visibility:"hidden"}),this.removeMenuEventListener()},t.prototype.destroy=function(){var e=this.get("menu");if(this.removeMenuEventListener(),e){var t=this.get("container");t||(t=this.get("graph").get("container")),xr(t)&&(t=document.getElementById(t)),t.removeChild(e)}},t}(FB),$B=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),YB=function(){return(YB=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},XB=Math.max,ZB=Us,QB=function(e){function t(t){var n=e.call(this,t)||this;return n.handleUpdateCanvas=io((function(e){var t=n;t.destroyed||t.updateCanvas()}),100,!1),n}return $B(t,e),t.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",type:"default",padding:50,size:[200,120],delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0}},t.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},t.prototype.disableRefresh=function(){this.set("refresh",!1)},t.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},t.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},t.prototype.initViewport=function(){var e=this,t=this._cfgs,n=t.size,i=t.graph;if(!this.destroyed){var r=this.get("canvas").get("container"),o=hb("\n      <div\n        class=".concat(t.viewportClassName,"\n        style='position:absolute;\n          left:0;\n          top:0;\n          box-sizing:border-box;\n          outline: 2px solid #1980ff'\n        draggable=true>\n      </div>")),s=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,a=0,l=0,c=!1,u=0,h=0,d=0,f=0,g=0,p=0;o.addEventListener("dragstart",(function(r){var s,m;if(r.dataTransfer){var v=new Image;v.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E",null===(m=(s=r.dataTransfer).setDragImage)||void 0===m||m.call(s,v,0,0);try{r.dataTransfer.setData("text/html","view-port-minimap")}catch(_){r.dataTransfer.setData("text","view-port-minimap")}}if(t.refresh=!1,r.target===o){var y=o.style;u=parseInt(y.left,10),h=parseInt(y.top,10),d=parseInt(y.width,10),f=parseInt(y.height,10),d>n[0]||f>n[1]||(p=i.getZoom(),g=e.get("ratio"),c=!0,a=r.clientX,l=r.clientY)}}),!1),o.addEventListener(s?"dragover":"drag",(function(e){if(c&&!sr(e.clientX)&&!sr(e.clientY)){var t=a-e.clientX,r=l-e.clientY;(u-t<0||u-t+d>=n[0])&&(t=0),(h-r<0||h-r+f>=n[1])&&(r=0),h-=r,db(o,{left:"".concat(u-=t,"px"),top:"".concat(h,"px")}),i.translate(t*p/g,r*p/g),a=e.clientX,l=e.clientY}}),!1),o.addEventListener("dragend",(function(){c=!1,t.refresh=!0}),!1),this.set("viewport",o),r.appendChild(o)}},t.prototype.updateViewport=function(){if(!this.destroyed){var e=this.get("ratio");this.get("dx"),this.get("dy");var t=this.get("totaldx"),n=this.get("totaldy"),i=this.get("graph"),r=this.get("size"),o=i.get("width"),s=i.get("height"),a=i.getPointByCanvas(0,0),l=i.getPointByCanvas(o,s),c=this.get("viewport");c||this.initViewport();var u=(l.x-a.x)*e,h=(l.y-a.y)*e,d=a.x*e+t,f=a.y*e+n,g=d+u,p=f+h;d<0&&(u+=d,d=0),g>r[0]&&(u-=g-r[0]),f<0&&(h+=f,f=0),p>r[1]&&(h-=p-r[1]),this.set("ratio",e),db(c,{left:"".concat(d,"px"),top:"".concat(f,"px"),width:"".concat(u,"px"),height:"".concat(h,"px")})}},t.prototype.updateGraphShapes=function(){var e=this._cfgs.graph,t=this.get("canvas"),n=e.get("group");if(!n.destroyed){var i=n.clone();i.resetMatrix(),t.clear(),t.add(i),"svg"===e.get("renderer")&&this.updateVisible(i)}},t.prototype.updateVisible=function(e){var t=this;if(e.isGroup()||e.get("visible")){var n=e.get("children");if(!n||!n.length)return;n.forEach((function(e){e.get("visible")||e.hide(),t.updateVisible(e)}))}else e.hide()},t.prototype.updateKeyShapes=function(){var e=this,t=this._cfgs.graph,n=this.get("canvas"),i=n.get("children")[0]||n.addGroup();cr(t.getEdges(),(function(t){e.updateOneEdgeKeyShape(t,i)})),cr(t.getNodes(),(function(t){e.updateOneNodeKeyShape(t,i)}));var r=t.getCombos();if(r&&r.length){var o=i.find((function(e){return"comboGroup"===e.get("name")}))||i.addGroup({name:"comboGroup"});setTimeout((function(){e.destroyed||(cr(r,(function(t){e.updateOneComboKeyShape(t,o)})),null==o||o.sort(),null==o||o.toBack(),e.updateCanvas())}),250)}this.clearDestroyedShapes()},t.prototype.updateOneComboKeyShape=function(e,t){if(!this.destroyed){var n=this.get("itemMap")||{},i=n[e.get("id")],r=e.getBBox(),o=e.get("keyShape").clone(),s=o.attr(),a={x:r.centerX,y:r.centerY};i?a=Object.assign(s,a):(i=o,t.add(i));var l=i.get("type");"rect"!==l&&"image"!==l||(a.x=r.minX,a.y=r.minY),i.attr(a),e.isVisible()?i.show():i.hide(),i.exist=!0;var c=e.getModel().depth;isNaN(c)||i.set("zIndex",c),n[e.get("id")]=i,this.set("itemMap",n)}},t.prototype.updateOneNodeKeyShape=function(e,t){var n=this.get("itemMap")||{},i=n[e.get("id")],r=e.getBBox(),o=e.get("keyShape").clone(),s=o.attr(),a={x:r.centerX,y:r.centerY};i?a=Object.assign(s,a):(i=o,t.add(i));var l=i.get("type");"rect"!==l&&"image"!==l||(a.x=r.minX,a.y=r.minY),i.attr(a),e.isVisible()?i.show():i.hide(),i.exist=!0;var c=e.getModel().depth;isNaN(c)||i.set("zIndex",c),n[e.get("id")]=i,this.set("itemMap",n)},t.prototype.updateDelegateShapes=function(){var e=this,t=this._cfgs.graph,n=this.get("canvas"),i=n.get("children")[0]||n.addGroup();cr(t.getEdges(),(function(t){e.updateOneEdgeKeyShape(t,i)})),cr(t.getNodes(),(function(t){e.updateOneNodeDelegateShape(t,i)}));var r=t.getCombos();if(r&&r.length){var o=i.find((function(e){return"comboGroup"===e.get("name")}))||i.addGroup({name:"comboGroup"});setTimeout((function(){e.destroyed||(cr(r,(function(t){e.updateOneComboKeyShape(t,o)})),null==o||o.sort(),null==o||o.toBack(),e.updateCanvas())}),250)}this.clearDestroyedShapes()},t.prototype.clearDestroyedShapes=function(){var e=this.get("itemMap")||{},t=Object.keys(e);if(t&&0!==t.length)for(var n=t.length-1;n>=0;n--){var i=e[t[n]],r=i.exist;i.exist=!1,r||(i.remove(),delete e[t[n]])}},t.prototype.updateOneEdgeKeyShape=function(e,t){var n=this.get("itemMap")||{},i=n[e.get("id")];if(i){var r=e.get("keyShape").attr("path");i.attr("path",r)}else i=e.get("keyShape").clone(),t.add(i);e.isVisible()?i.show():i.hide(),i.exist=!0,n[e.get("id")]=i,this.set("itemMap",n)},t.prototype.updateOneNodeDelegateShape=function(e,t){var n=this.get("delegateStyle"),i=this.get("itemMap")||{},r=i[e.get("id")],o=e.getBBox();if(r){var s={x:o.minX,y:o.minY,width:o.width,height:o.height};r.attr(s)}else r=t.addShape("rect",{attrs:YB({x:o.minX,y:o.minY,width:o.width,height:o.height},n),name:"minimap-node-shape"});e.isVisible()?r.show():r.hide(),r.exist=!0,i[e.get("id")]=r,this.set("itemMap",i)},t.prototype.init=function(){this.initContainer(),this.get("graph").on("afterupdateitem",this.handleUpdateCanvas),this.get("graph").on("afteritemstatechange",this.handleUpdateCanvas),this.get("graph").on("afteradditem",this.handleUpdateCanvas),this.get("graph").on("afterremoveitem",this.handleUpdateCanvas),this.get("graph").on("afterrender",this.handleUpdateCanvas),this.get("graph").on("afterlayout",this.handleUpdateCanvas)},t.prototype.initContainer=function(){var e=this,t=e.get("graph"),n=e.get("size"),i=e.get("className"),r=e.get("container"),o=hb("<div class='".concat(i,"' style='width: ").concat(n[0],"px; height: ").concat(n[1],"px; overflow: hidden'></div>"));xr(r)&&(r=document.getElementById(r)),r?r.appendChild(o):t.get("container").appendChild(o),e.set("container",o);var s,a=hb('<div class="g6-minimap-container" style="position: relative;"></div>');o.appendChild(a),a.addEventListener("dragenter",(function(e){e.preventDefault()})),a.addEventListener("dragover",(function(e){e.preventDefault()})),s="svg"===t.get("renderer")?new n_({container:a,width:n[0],height:n[1]}):new py({container:a,width:n[0],height:n[1]}),e.set("canvas",s),e.updateCanvas()},t.prototype.updateCanvas=function(){if(!this.destroyed&&this.get("refresh")){var e=this.get("graph");if(!e.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var t=this.get("size"),n=this.get("canvas"),i=this.get("type"),r=this.get("padding");if(!n.destroyed){switch(i){case"default":this.updateGraphShapes();break;case"keyShape":this.updateKeyShapes();break;case"delegate":this.updateDelegateShapes()}var o=n.get("children")[0];if(o){o.resetMatrix();var s=o.getCanvasBBox(),a=e.get("canvas").getCanvasBBox(),l=e.getZoom()||1,c=a.width/l,u=a.height/l;Number.isFinite(s.width)&&(c=XB(s.width,c),u=XB(s.height,u)),c+=2*r,u+=2*r;var h=Math.min(t[0]/c,t[1]/u),d=[1,0,0,0,1,0,0,0,1],f=0,g=0;Number.isFinite(s.minX)&&(f=-s.minX),Number.isFinite(s.minY)&&(g=-s.minY);var p=(t[0]-(c-2*r)*h)/2,m=(t[1]-(u-2*r)*h)/2;d=ZB(d,[["t",f,g],["s",h,h],["t",p,m]]),o.setMatrix(d),this.set("ratio",h),this.set("totaldx",p+f*h),this.set("totaldy",m+g*h),this.set("dx",p),this.set("dy",m),this.updateViewport()}}}}},t.prototype.getCanvas=function(){return this.get("canvas")},t.prototype.getViewport=function(){return this.get("viewport")},t.prototype.getContainer=function(){return this.get("container")},t.prototype.destroy=function(){this.get("canvas").destroy();var e=this.get("container");e.parentNode.removeChild(e)},t}(FB),JB=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();function eW(e,t,n){var i=e.x-t.x,r=e.y-t.y;return!n||Math.abs(i)>n||Math.abs(r)>n?Math.sqrt(i*i+r*r):n}function tW(e,t){var n=(t.source.y-t.target.y)/(t.source.x-t.target.x),i=(n*n*t.source.x+n*(e.y-t.source.y)+e.x)/(n*n+1);return{x:i,y:n*(i-t.source.x)+t.source.y}}var nW=function(e){function t(t){return e.call(this,t)||this}return JB(t,e),t.prototype.getDefaultCfgs=function(){return{edgeBundles:[],edgePoints:[],K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:.6666667,bundleThreshold:.6,eps:1e-6,onLayoutEnd:function(){},onTick:function(){}}},t.prototype.init=function(){var e=this.get("graph"),t=this.get("onTick");this.set("tick",(function(){t&&t(),e.refreshPositions()}))},t.prototype.bundling=function(e){var t=this;if(t.set("data",e),!t.isTicking()){var n=e.edges||[],i=e.nodes||[],r={},o=!1;if(i.forEach((function(e){null!==e.x&&null!==!e.y&&void 0!==e.x&&void 0!==!e.y||(o=!0),r[e.id]=e})),o)throw new Error("please layout the graph or assign x and y for nodes first");t.set("nodeIdMap",r);var s=t.get("divisions"),a=t.get("divRate"),l=t.divideEdges(s);t.set("edgePoints",l);var c=t.getEdgeBundles();t.set("edgeBundles",c);for(var u=t.get("cycles"),h=t.get("iterations"),d=t.get("iterRate"),f=t.get("lambda"),g=0;g<u;g++){for(var p=function(e){var i=[];n.forEach((function(e,n){if(e.source!==e.target){var o=r[e.source],a=r[e.target];i[n]=t.getEdgeForces({source:o,target:a},n,s,f);for(var c=0;c<s+1;c++)l[n][c].x+=i[n][c].x,l[n][c].y+=i[n][c].y}}))},m=0;m<h;m++)p();f/=2,s*=a,h*=d,l=t.divideEdges(s),t.set("edgePoints",l)}n.forEach((function(e,t){e.source!==e.target&&(e.type="polyline",e.controlPoints=l[t].slice(1,l[t].length-1))})),t.get("graph").refresh()}},t.prototype.updateBundling=function(e){var t=this,n=e.data;if(n&&t.set("data",n),t.get("ticking")&&t.set("ticking",!1),Object.keys(e).forEach((function(n){t.set(n,e[n])})),e.onTick){var i=this.get("graph");t.set("tick",(function(){e.onTick(),i.refresh()}))}t.bundling(n)},t.prototype.divideEdges=function(e){var t=this,n=t.get("data").edges,i=t.get("nodeIdMap"),r=t.get("edgePoints");return r&&void 0!==r||(r=[]),n.forEach((function(n,o){r[o]&&void 0!==r[o]||(r[o]=[]);var s=i[n.source],a=i[n.target];if(1===e)r[o].push({x:s.x,y:s.y}),r[o].push({x:.5*(s.x+a.x),y:.5*(s.y+a.y)}),r[o].push({x:a.x,y:a.y});else{var l=(r[o]&&r[o]!==[]?t.getEdgeLength(r[o]):eW({x:s.x,y:s.y},{x:a.x,y:a.y}))/(e+1),c=l,u=[{x:s.x,y:s.y}];r[o].forEach((function(e,t){if(0!==t){for(var n=eW(e,r[o][t-1]);n>c;){var i=c/n,s={x:r[o][t-1].x,y:r[o][t-1].y};s.x+=i*(e.x-r[o][t-1].x),s.y+=i*(e.y-r[o][t-1].y),u.push(s),n-=c,c=l}c-=n}})),u.push({x:a.x,y:a.y}),r[o]=u}})),r},t.prototype.getEdgeLength=function(e){var t=0;return e.forEach((function(n,i){0!==i&&(t+=eW(n,e[i-1]))})),t},t.prototype.getEdgeBundles=function(){var e=this,t=e.get("data").edges||[],n=e.get("bundleThreshold"),i=e.get("nodeIdMap"),r=e.get("edgeBundles");return r||(r=[]),t.forEach((function(e,t){r[t]&&void 0!==r[t]||(r[t]=[])})),t.forEach((function(o,s){var a=i[o.source],l=i[o.target];t.forEach((function(t,o){if(!(o<=s)){var c=i[t.source],u=i[t.target];e.getBundleScore({source:a,target:l},{source:c,target:u})>=n&&(r[s].push(o),r[o].push(s))}}))})),r},t.prototype.getBundleScore=function(e,t){var n=this;return e.vx=e.target.x-e.source.x,e.vy=e.target.y-e.source.y,t.vx=t.target.x-t.source.x,t.vy=t.target.y-t.source.y,e.length=eW({x:e.source.x,y:e.source.y},{x:e.target.x,y:e.target.y}),t.length=eW({x:t.source.x,y:t.source.y},{x:t.target.x,y:t.target.y}),n.getAngleScore(e,t)*n.getScaleScore(e,t)*n.getPositionScore(e,t)*n.getVisibilityScore(e,t)},t.prototype.getAngleScore=function(e,t){return function(e,t){return e.x*t.x+e.y*t.y}({x:e.vx,y:e.vy},{x:t.vx,y:t.vy})/(e.length*t.length)},t.prototype.getScaleScore=function(e,t){var n=(e.length+t.length)/2;return 2/(n/Math.min(e.length,t.length)+Math.max(e.length,t.length)/n)},t.prototype.getPositionScore=function(e,t){var n=(e.length+t.length)/2;return n/(n+eW({x:(e.source.x+e.target.x)/2,y:(e.source.y+e.target.y)/2},{x:(t.source.x+t.target.x)/2,y:(t.source.y+t.target.y)/2}))},t.prototype.getVisibilityScore=function(e,t){var n=this.getEdgeVisibility(e,t),i=this.getEdgeVisibility(t,e);return n<i?n:i},t.prototype.getEdgeVisibility=function(e,t){var n=tW(t.source,e),i=tW(t.target,e),r={x:(n.x+i.x)/2,y:(n.y+i.y)/2},o={x:(e.source.x+e.target.x)/2,y:(e.source.y+e.target.y)/2};return Math.max(0,1-2*eW(r,o)/eW(n,i))},t.prototype.getEdgeForces=function(e,t,n,i){for(var r=this,o=r.get("edgePoints"),s=r.get("K")/(eW(e.source,e.target)*(n+1)),a=[{x:0,y:0}],l=1;l<n;l++){var c={x:0,y:0},u=r.getSpringForce({pre:o[t][l-1],cur:o[t][l],next:o[t][l+1]},s),h=r.getElectrostaticForce(l,t);c.x=i*(u.x+h.x),c.y=i*(u.y+h.y),a.push(c)}return a.push({x:0,y:0}),a},t.prototype.getSpringForce=function(e,t){var n=e.pre.x+e.next.x-2*e.cur.x,i=e.pre.y+e.next.y-2*e.cur.y;return{x:n*=t,y:i*=t}},t.prototype.getElectrostaticForce=function(e,t){var n=this,i=n.get("eps"),r=n.get("edgeBundles"),o=n.get("edgePoints"),s=r[t],a={x:0,y:0};return s.forEach((function(n){var r={x:o[n][e].x-o[t][e].x,y:o[n][e].y-o[t][e].y};if(Math.abs(r.x)>i||Math.abs(r.y)>i){var s=1/eW(o[n][e],o[t][e]);a.x+=r.x*s,a.y+=r.y*s}})),a},t.prototype.isTicking=function(){return this.get("ticking")},t.prototype.getSimulation=function(){return this.get("forceSimulation")},t.prototype.destroy=function(){this.get("ticking")&&this.getSimulation().stop(),e.prototype.destroy.call(this)},t}(FB),iW=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),rW=function(){return(rW=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},oW={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},sW=function(e){function t(t){return e.call(this,t)||this}return iW(t,e),t.prototype.getDefaultCfgs=function(){return{trigger:"mousemove",d:1.5,r:300,delegateStyle:no(oW),showLabel:!1,maxD:5,minD:0,scaleRBy:"unset",scaleDBy:"unset",showDPercent:!0}},t.prototype.getEvents=function(){var e;switch(this.get("trigger")){case"click":e={click:"magnify"};break;case"drag":e={click:"createDelegate"};break;default:e={mousemove:"magnify"}}return e},t.prototype.init=function(){var e=this,t=e.get("r");e.set("cachedMagnifiedModels",[]),e.set("cachedOriginPositions",{}),e.set("r2",t*t);var n=e.get("d");e.set("molecularParam",(n+1)*t)},t.prototype.createDelegate=function(e){var t=this,n=this,i=n.get("delegate");i&&!i.destroyed||(n.magnify(e),(i=n.get("delegate")).on("dragstart",(function(e){n.set("delegateCenterDiff",{x:i.attr("x")-e.x,y:i.attr("y")-e.y})})),i.on("drag",(function(e){n.magnify(e)})),"wheel"===this.get("scaleDBy")&&i.on("mousewheel",(function(e){t.scaleDByWheel(e)})),"wheel"===this.get("scaleRBy")&&i.on("mousewheel",(function(e){n.scaleRByWheel(e)})))},t.prototype.scaleRByWheel=function(e){var t=this;if(e&&e.originalEvent){e.preventDefault&&e.preventDefault();var n,i=t.get("graph"),r=t.get("delegate"),o=(r?{x:r.attr("x"),y:r.attr("y")}:void 0)||i.getPointByClient(e.clientX,e.clientY);n=e.originalEvent.wheelDelta<0?.95:1/.95;var s=t.get("maxR"),a=t.get("minR"),l=t.get("r");(l>(s||i.get("height"))&&n>1||l<(a||.05*i.get("height"))&&n<1)&&(n=1),l*=n,t.set("r",l),t.set("r2",l*l);var c=t.get("d");t.set("molecularParam",(c+1)*l),t.set("delegateCenterDiff",void 0),t.magnify(e,o)}},t.prototype.scaleRByDrag=function(e){var t=this;if(e){var n,i=t.get("dragPrePos"),r=t.get("graph"),o=r.getPointByClient(e.clientX,e.clientY);n=e.x-i.x<0?.95:1/.95;var s=t.get("maxR"),a=t.get("minR"),l=t.get("r");(l>(s||r.get("height"))&&n>1||l<(a||.05*r.get("height"))&&n<1)&&(n=1),l*=n,t.set("r",l),t.set("r2",l*l);var c=t.get("d");t.set("molecularParam",(c+1)*l),t.magnify(e,o),t.set("dragPrePos",{x:e.x,y:e.y})}},t.prototype.scaleDByWheel=function(e){var t=this;if(e||e.originalEvent){e.preventDefault&&e.preventDefault();var n=0;n=e.originalEvent.wheelDelta<0?-.1:.1;var i=t.get("d")+n,r=t.get("maxD"),o=t.get("minD");if(i<r&&i>o){t.set("d",i);var s=t.get("r");t.set("molecularParam",(i+1)*s);var a=t.get("delegate"),l=a?{x:a.attr("x"),y:a.attr("y")}:void 0;t.set("delegateCenterDiff",void 0),t.magnify(e,l)}}},t.prototype.scaleDByDrag=function(e){var t=this,n=t.get("dragPrePos"),i=e.x-n.x>0?.1:-.1,r=t.get("d")+i,o=t.get("maxD"),s=t.get("minD");if(r<o&&r>s){t.set("d",r);var a=t.get("r");t.set("molecularParam",(r+1)*a),t.magnify(e)}t.set("dragPrePos",{x:e.x,y:e.y})},t.prototype.magnify=function(e,t){var n=this;n.restoreCache();var i=n.get("graph"),r=n.get("cachedMagnifiedModels"),o=n.get("cachedOriginPositions"),s=n.get("showLabel"),a=n.get("r"),l=n.get("r2"),c=n.get("d"),u=n.get("molecularParam"),h=i.getNodes(),d=h.length,f=t?{x:t.x,y:t.y}:{x:e.x,y:e.y};!n.get("dragging")||"mousemove"!==n.get("trigger")&&"click"!==n.get("trigger")||(f=n.get("cacheCenter"));var g=n.get("delegateCenterDiff");g&&(f.x+=g.x,f.y+=g.y),n.updateDelegate(f,a);for(var p=0;p<d;p++){var m=h[p].getModel(),v=m.x,y=m.y;if(!isNaN(v)&&!isNaN(y)){var _=(v-f.x)*(v-f.x)+(y-f.y)*(y-f.y);if(!isNaN(_)&&_<l&&0!==_){var b=Math.sqrt(_),w=u*b/(c*b+a),C=(v-f.x)/b,S=(y-f.y)/b;if(m.x=C*w+f.x,m.y=S*w+f.y,o[m.id]||(o[m.id]={x:v,y:y,texts:[]}),r.push(m),s&&2*b<a)for(var x=h[p].getContainer().getChildren(),E=x.length,k=0;k<E;k++){var L=x[k];"text"===L.get("type")&&(o[m.id].texts.push({visible:L.get("visible"),shape:L}),L.set("visible",!0))}}}}i.refreshPositions()},t.prototype.restoreCache=function(){for(var e=this,t=e.get("cachedMagnifiedModels"),n=e.get("cachedOriginPositions"),i=t.length,r=0;r<i;r++){var o=t[r],s=n[o.id];o.x=s.x,o.y=s.y;for(var a=s.texts.length,l=0;l<a;l++){var c=s.texts[l];c.shape.set("visible",c.visible)}}e.set("cachedMagnifiedModels",[]),e.set("cachedOriginPositions",{})},t.prototype.updateParams=function(e){var t=this,n=e.r,i=e.d,r=e.trigger,o=e.minD,s=e.maxD,a=e.minR,l=e.maxR,c=e.scaleDBy,u=e.scaleRBy;isNaN(e.r)||(t.set("r",n),t.set("r2",n*n)),isNaN(i)||t.set("d",i),isNaN(s)||t.set("maxD",s),isNaN(o)||t.set("minD",o),isNaN(l)||t.set("maxR",l),isNaN(a)||t.set("minR",a);var h,d=t.get("d"),f=t.get("r");(t.set("molecularParam",(d+1)*f),"mousemove"!==r&&"click"!==r&&"drag"!==r||t.set("trigger",r),"drag"===c||"wheel"===c||"unset"===c)&&(t.set("scaleDBy",c),t.get("delegate").remove(),t.get("delegate").destroy(),(h=t.get("dPercentText"))&&(h.remove(),h.destroy()));"drag"!==u&&"wheel"!==u&&"unset"!==u||(t.set("scaleRBy",u),t.get("delegate").remove(),t.get("delegate").destroy(),(h=t.get("dPercentText"))&&(h.remove(),h.destroy()))},t.prototype.updateDelegate=function(e,t){var n=this,i=this,r=i.get("graph"),o=i.get("delegate");if(!o||o.destroyed){var s=r.get("group"),a=i.get("delegateStyle")||oW;o=s.addShape("circle",{attrs:rW({r:t/1.5,x:e.x,y:e.y},a),name:"lens-shape",draggable:!0}),"drag"!==this.get("trigger")&&("wheel"===this.get("scaleRBy")?o.on("mousewheel",(function(e){i.scaleRByWheel(e)})):"drag"===this.get("scaleRBy")&&(o.on("dragstart",(function(e){i.set("dragging",!0),i.set("cacheCenter",{x:e.x,y:e.y}),i.set("dragPrePos",{x:e.x,y:e.y})})),o.on("drag",(function(e){i.scaleRByDrag(e)})),o.on("dragend",(function(e){i.set("dragging",!1)}))),"wheel"===this.get("scaleDBy")?o.on("mousewheel",(function(e){n.scaleDByWheel(e)})):"drag"===this.get("scaleDBy")&&(o.on("dragstart",(function(e){i.set("dragging",!0),i.set("cacheCenter",{x:e.x,y:e.y}),i.set("dragPrePos",{x:e.x,y:e.y})})),o.on("drag",(function(e){n.scaleDByDrag(e)})),o.on("dragend",(function(e){i.set("dragging",!1)}))))}else o.attr({x:e.x,y:e.y,r:t/1.5});if(i.get("showDPercent")){var l=Math.round((i.get("d")-i.get("minD"))/(i.get("maxD")-i.get("minD"))*100),c=i.get("dPercentText"),u=e.y+t/1.5+16;if(!c||c.destroyed)c=r.get("group").addShape("text",{attrs:{text:"".concat(l,"%"),x:e.x,y:u,fill:"#aaa",stroke:"#fff",lineWidth:1,fontSize:12}}),i.set("dPercentText",c);else c.attr({text:"".concat(l,"%"),x:e.x,y:u})}i.set("delegate",o)},t.prototype.clear=function(){var e=this.get("graph");this.restoreCache(),e.refreshPositions();var t=this.get("delegate");t&&!t.destroyed&&(t.remove(),t.destroy());var n=this.get("dPercentText");n&&!n.destroyed&&(n.remove(),n.destroy())},t.prototype.destroy=function(){this.clear()},t}(FB),aW=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();"undefined"!=typeof document&&GB("\n  .g6-component-toolbar {\n    position: absolute;\n    list-style-type: none;\n    padding: 6px;\n    left: 0px;\n    top: 0px;\n    background-color: rgba(255, 255, 255, 0.9);\n    border: 1px solid #e2e2e2;\n    border-radius: 4px;\n    font-size: 12px;\n    color: #545454;\n    margin: 0;\n  }\n  .g6-component-toolbar li {\n    float: left;\n    text-align: center;\n    width: 35px;\n    height: 24px;\n    cursor: pointer;\n\t\tlist-style-type:none;\n    list-style: none;\n    margin-left: 0px;\n  }\n  .g6-component-toolbar li .icon {\n    opacity: 0.7;\n  }\n  .g6-component-toolbar li .icon:hover {\n    opacity: 1;\n  }\n");var lW=function(e){function t(t){return e.call(this,t)||this}return aW(t,e),t.prototype.getDefaultCfgs=function(){return{handleClick:void 0,getContent:function(e){return'\n          <ul class=\'g6-component-toolbar\'>\n            <li code=\'redo\'>\n              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">\n                <path d="M256 682.666667c0-102.741333 66.730667-213.333333 213.333333-213.333334 107.008 0 190.762667 56.576 230.570667 125.354667L611.968 682.666667H853.333333v-241.365334l-91.562666 91.562667C704.768 448.469333 601.130667 384 469.333333 384c-196.096 0-298.666667 150.229333-298.666666 298.666667h85.333333z" fill="" p-id="2041"></path>\n              </svg>\n            </li>\n            <li code=\'undo\'>\n              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">\n                <path d="M170.666667 682.666667h241.365333l-87.936-87.978667C363.904 525.909333 447.658667 469.333333 554.666667 469.333333c146.602667 0 213.333333 110.592 213.333333 213.333334h85.333333c0-148.437333-102.570667-298.666667-298.666666-298.666667-131.797333 0-235.392 64.469333-292.48 148.821333L170.666667 441.301333V682.666667z" fill="" p-id="2764"></path>\n              </svg>\n            </li>\n            <li  code=\'zoomOut\'>\n              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">\n                <path d="M658.432 428.736a33.216 33.216 0 0 1-33.152 33.152H525.824v99.456a33.216 33.216 0 0 1-66.304 0V461.888H360.064a33.152 33.152 0 0 1 0-66.304H459.52V296.128a33.152 33.152 0 0 1 66.304 0V395.52H625.28c18.24 0 33.152 14.848 33.152 33.152z m299.776 521.792a43.328 43.328 0 0 1-60.864-6.912l-189.248-220.992a362.368 362.368 0 0 1-215.36 70.848 364.8 364.8 0 1 1 364.8-364.736 363.072 363.072 0 0 1-86.912 235.968l192.384 224.64a43.392 43.392 0 0 1-4.8 61.184z m-465.536-223.36a298.816 298.816 0 0 0 298.432-298.432 298.816 298.816 0 0 0-298.432-298.432A298.816 298.816 0 0 0 194.24 428.8a298.816 298.816 0 0 0 298.432 298.432z"></path>\n              </svg>\n            </li>\n            <li code=\'zoomIn\'>\n              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">\n                <path d="M639.936 416a32 32 0 0 1-32 32h-256a32 32 0 0 1 0-64h256a32 32 0 0 1 32 32z m289.28 503.552a41.792 41.792 0 0 1-58.752-6.656l-182.656-213.248A349.76 349.76 0 0 1 480 768 352 352 0 1 1 832 416a350.4 350.4 0 0 1-83.84 227.712l185.664 216.768a41.856 41.856 0 0 1-4.608 59.072zM479.936 704c158.784 0 288-129.216 288-288S638.72 128 479.936 128a288.32 288.32 0 0 0-288 288c0 158.784 129.216 288 288 288z" p-id="3853"></path>\n              </svg>\n            </li>\n            <li code=\'realZoom\'>\n              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">\n                <path d="M384 320v384H320V320h64z m256 0v384H576V320h64zM512 576v64H448V576h64z m0-192v64H448V384h64z m355.968 576H92.032A28.16 28.16 0 0 1 64 931.968V28.032C64 12.608 76.608 0 95.168 0h610.368L896 192v739.968a28.16 28.16 0 0 1-28.032 28.032zM704 64v128h128l-128-128z m128 192h-190.464V64H128v832h704V256z"></path>\n              </svg>\n            </li>\n            <li code=\'autoZoom\'>\n              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">\n                <path d="M684.288 305.28l0.128-0.64-0.128-0.64V99.712c0-19.84 15.552-35.904 34.496-35.712a35.072 35.072 0 0 1 34.56 35.776v171.008h170.944c19.648 0 35.84 15.488 35.712 34.432a35.072 35.072 0 0 1-35.84 34.496h-204.16l-0.64-0.128a32.768 32.768 0 0 1-20.864-7.552c-1.344-1.024-2.816-1.664-3.968-2.816-0.384-0.32-0.512-0.768-0.832-1.088a33.472 33.472 0 0 1-9.408-22.848zM305.28 64a35.072 35.072 0 0 0-34.56 35.776v171.008H99.776A35.072 35.072 0 0 0 64 305.216c0 18.944 15.872 34.496 35.84 34.496h204.16l0.64-0.128a32.896 32.896 0 0 0 20.864-7.552c1.344-1.024 2.816-1.664 3.904-2.816 0.384-0.32 0.512-0.768 0.768-1.088a33.024 33.024 0 0 0 9.536-22.848l-0.128-0.64 0.128-0.704V99.712A35.008 35.008 0 0 0 305.216 64z m618.944 620.288h-204.16l-0.64 0.128-0.512-0.128c-7.808 0-14.72 3.2-20.48 7.68-1.28 1.024-2.752 1.664-3.84 2.752-0.384 0.32-0.512 0.768-0.832 1.088a33.664 33.664 0 0 0-9.408 22.912l0.128 0.64-0.128 0.704v204.288c0 19.712 15.552 35.904 34.496 35.712a35.072 35.072 0 0 0 34.56-35.776V753.28h170.944c19.648 0 35.84-15.488 35.712-34.432a35.072 35.072 0 0 0-35.84-34.496z m-593.92 11.52c-0.256-0.32-0.384-0.768-0.768-1.088-1.088-1.088-2.56-1.728-3.84-2.688a33.088 33.088 0 0 0-20.48-7.68l-0.512 0.064-0.64-0.128H99.84a35.072 35.072 0 0 0-35.84 34.496 35.072 35.072 0 0 0 35.712 34.432H270.72v171.008c0 19.84 15.552 35.84 34.56 35.776a35.008 35.008 0 0 0 34.432-35.712V720l-0.128-0.64 0.128-0.704a33.344 33.344 0 0 0-9.472-22.848zM512 374.144a137.92 137.92 0 1 0 0.128 275.84A137.92 137.92 0 0 0 512 374.08z"></path>\n              </svg>\n            </li>\n          </ul>\n        '},zoomSensitivity:2}},t.prototype.init=function(){var e=this,t=this.get("graph"),n=this.get("getContent")(t),i=n;xr(n)&&(i=hb(n));var r=this.get("className");i.setAttribute("class",r||"g6-component-toolbar");var o=this.get("container");o||(o=this.get("graph").get("container")),xr(o)&&(o=document.getElementById(o)),o.appendChild(i),this.set("toolBar",i);var s=this.get("handleClick");i.addEventListener("click",(function(n){var i=function(e){if(!e)return[];if(e.composedPath)return e.composedPath();for(var t=[],n=e.target;n;){if(t.push(n),"HTML"===n.tagName)return t.push(document,window),t;n=n.parentElement}return t}(n).filter((function(e){return"LI"===e.nodeName}));if(0!==i.length){var r=i[0].getAttribute("code");r&&(s?s(r,t):e.handleDefaultOperator(r,t))}}));var a=this.get("position");a&&db(i,{top:"".concat(a.y,"px"),left:"".concat(a.x,"px")}),this.bindUndoRedo()},t.prototype.bindUndoRedo=function(){var e=this.get("graph"),t=document.querySelector('.g6-component-toolbar li[code="undo"]'),n=document.querySelector('.g6-component-toolbar li[code="undo"] svg'),i=document.querySelector('.g6-component-toolbar li[code="redo"]'),r=document.querySelector('.g6-component-toolbar li[code="redo"] svg');t&&n&&i&&r&&e.on("stackchange",(function(e){var o=e.undoStack,s=e.redoStack,a=o.length,l=s.length;1===a?(t.setAttribute("style","cursor: not-allowed"),n.setAttribute("style","opacity: 0.4")):(t.removeAttribute("style"),n.removeAttribute("style")),0===l?(i.setAttribute("style","cursor: not-allowed"),r.setAttribute("style","opacity: 0.4")):(i.removeAttribute("style"),r.removeAttribute("style"))}))},t.prototype.undo=function(){var e=this.get("graph"),t=e.getUndoStack();if(t&&1!==t.length){var n=t.pop();if(n){var i=n.action;e.pushStack(i,no(n.data),"redo");var r=n.data.before;if("add"===i&&(r=n.data.after),!r)return;switch(i){case"visible":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){var n=e.findById(t.id);t.visible?e.showItem(n,!1):e.hideItem(n,!1)}))}));break;case"render":case"update":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){e.updateItem(t.id,t,!1)}))}));break;case"changedata":e.changeData(r,!1);break;case"delete":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){var n=t.itemType;delete t.itemType,e.addItem(n,t,!1)}))}));break;case"add":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){e.removeItem(t.id,!1)}))}));break;case"updateComboTree":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){e.updateComboTree(t.id,t.parentId,!1)}))}))}}}},t.prototype.redo=function(){var e=this.get("graph"),t=e.getRedoStack();if(t&&0!==t.length){var n=t.pop();if(n){var i=n.action,r=n.data.after;if(e.pushStack(i,no(n.data)),"delete"===i&&(r=n.data.before),!r)return;switch(i){case"visible":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){var n=e.findById(t.id);t.visible?e.showItem(n,!1):e.hideItem(n,!1)}))}));break;case"render":case"update":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){e.updateItem(t.id,t,!1)}))}));break;case"changedata":e.changeData(r,!1);break;case"delete":r.edges&&r.edges.forEach((function(t){e.removeItem(t.id,!1)})),r.nodes&&r.nodes.forEach((function(t){e.removeItem(t.id,!1)})),r.combos&&r.combos.forEach((function(t){e.removeItem(t.id,!1)}));break;case"add":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){var n=t.itemType;delete t.itemType,e.addItem(n,t,!1)}))}));break;case"updateComboTree":Object.keys(r).forEach((function(t){var n=r[t];n&&n.forEach((function(t){e.updateComboTree(t.id,t.parentId,!1)}))}))}}}},t.prototype.handleDefaultOperator=function(e,t){var n=t.getZoom();switch(e){case"redo":this.redo();break;case"undo":this.undo();break;case"zoomOut":var i=1/(1-.05*this.get("zoomSensitivity"));if(i*n>(this.get("maxZoom")||t.get("maxZoom")))return;t.zoomTo(n*i);break;case"zoomIn":var r=1-.05*this.get("zoomSensitivity");if(r*n<(this.get("minZoom")||t.get("minZoom")))return;t.zoomTo(n*r);break;case"realZoom":t.zoomTo(1);break;case"autoZoom":t.fitView([20,20])}},t.prototype.destroy=function(){var e=this.get("toolBar");if(e){var t=this.get("container");t||(t=this.get("graph").get("container")),xr(t)&&(t=document.getElementById(t)),t.removeChild(e)}var n=this.get("handleClick");n&&e.removeEventListener("click",n)},t}(FB),cW=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();"undefined"!=typeof document&&GB("\n  .g6-component-tooltip {\n    border: 1px solid #e2e2e2;\n    border-radius: 4px;\n    font-size: 12px;\n    color: #545454;\n    background-color: rgba(255, 255, 255, 0.9);\n    padding: 10px 8px;\n    box-shadow: rgb(174, 174, 174) 0px 0px 10px;\n  }\n  .tooltip-type {\n    padding: 0;\n    margin: 0;\n  }\n  .tooltip-id {\n    color: #531dab;\n  }\n");var uW=function(e){function t(t){return e.call(this,t)||this}return cW(t,e),t.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,getContent:function(e){return"\n          <h4 class='tooltip-type'>类型：".concat(e.item.getType(),"</h4>\n          <span class='tooltip-id'>ID：").concat(e.item.getID(),"</span>\n        ")},shouldBegin:function(e){return!0},itemTypes:["node","edge","combo"],trigger:"mouseenter",fixToNode:void 0}},t.prototype.getEvents=function(){return"click"===this.get("trigger")?{"node:click":"onClick","edge:click":"onClick","combo:click":"onClick","canvas:click":"onMouseLeave",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave",drag:"onMouseLeave"}:{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove","edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove","combo:mouseenter":"onMouseEnter","combo:mouseleave":"onMouseLeave","combo:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave","node:drag":"onMouseLeave"}},t.prototype.init=function(){var e=this,t=e.get("className")||"g6-component-tooltip",n=hb("<div class=".concat(t,"></div>")),i=e.get("container");i||(i=e.get("graph").get("container")),xr(i)&&(i=document.getElementById(i)),db(n,{position:"absolute",visibility:"hidden",display:"none"}),i.appendChild(n),"click"!==e.get("trigger")&&(n.addEventListener("mouseenter",(function(e){db(n,{visibility:"visible",display:"unset"})})),n.addEventListener("mouseleave",(function(t){e.hideTooltip()}))),e.set("tooltip",n)},t.prototype.onClick=function(e){var t=this.get("itemTypes");if(!e.item||!e.item.getType||-1!==t.indexOf(e.item.getType())){var n=e.item,i=this.get("graph");this.currentTarget===n?(this.currentTarget=null,this.hideTooltip(),i.emit("tooltipchange",{item:e.item,action:"hide"})):(this.currentTarget=n,this.showTooltip(e),i.emit("tooltipchange",{item:e.item,action:"show"}))}},t.prototype.onMouseEnter=function(e){var t=this.get("itemTypes");if(!e.item||!e.item.getType||-1!==t.indexOf(e.item.getType())){var n=e.item,i=this.get("graph");this.currentTarget=n,this.showTooltip(e),i.emit("tooltipchange",{item:e.item,action:"show"})}},t.prototype.onMouseMove=function(e){var t=this.get("itemTypes");e.item&&e.item.getType&&-1===t.indexOf(e.item.getType())||this.currentTarget&&e.item===this.currentTarget&&this.showTooltip(e)},t.prototype.onMouseLeave=function(){this.hideTooltip(),this.get("graph").emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null},t.prototype.clearContainer=function(){var e=this.get("tooltip");e&&(e.innerHTML="")},t.prototype.showTooltip=function(e){if(e.item){var t=this.get("itemTypes");if(!e.item.getType||-1!==t.indexOf(e.item.getType())){var n=this.get("tooltip"),i=this.get("getContent")(e);xr(i)?n.innerHTML=i:(this.clearContainer(),n.appendChild(i)),this.updatePosition(e)}}},t.prototype.hideTooltip=function(){var e=this.get("tooltip");e&&db(e,{visibility:"hidden",display:"none"})},t.prototype.updatePosition=function(e){var t=this.get("shouldBegin"),n=this.get("tooltip");if(t(e)){var i=this.get("graph"),r=i.get("width"),o=i.get("height"),s=this.get("offsetX")||0,a=this.get("offsetY")||0,l=i.getPointByClient(e.clientX,e.clientY),c=this.get("fixToNode"),u=e.item;if(u.getType&&"node"===u.getType()&&c&&ar(c)&&c.length>=2){var h=u.getBBox();l={x:h.minX+h.width*c[0],y:h.minY+h.height*c[1]}}var d=i.getCanvasByPoint(l.x,l.y),f=d.x,g=d.y,p=i.getContainer(),m={x:f+p.offsetLeft+s,y:g+p.offsetTop+a};db(n,{visibility:"visible",display:"unset"});var v=n.getBoundingClientRect();f+v.width+s>r&&(m.x-=v.width+s),g+v.height+a>o&&(m.y-=v.height+a),db(n,{left:"".concat(m.x,"px"),top:"".concat(m.y,"px")})}else db(n,{visibility:"hidden",display:"none"})},t.prototype.hide=function(){this.onMouseLeave()},t.prototype.destroy=function(){var e=this.get("tooltip");if(e){var t=this.get("container");t||(t=this.get("graph").get("container")),xr(t)&&(t=document.getElementById(t)),t.removeChild(e)}},t}(FB),hW={};function dW(e,t){hW[e]=t}var fW=function(){function e(e){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=e,this.initCfg(),this.init()}return e.prototype.translate=function(e){return e},e.prototype.change=function(e){to(this.__cfg__,e),this.init()},e.prototype.clone=function(){return this.constructor(this.__cfg__)},e.prototype.getTicks=function(){var e=this;return fo(this.ticks,(function(t,n){return lr(t)?t:{text:e.getText(t,n),tickValue:t,value:e.scale(t)}}))},e.prototype.getText=function(e,t){var n=this.formatter,i=n?n(e,t):e;return sr(i)||!or(i.toString)?"":i.toString()},e.prototype.getConfig=function(e){return this.__cfg__[e]},e.prototype.init=function(){to(this,this.__cfg__),this.setDomain(),co(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},e.prototype.initCfg=function(){},e.prototype.setDomain=function(){},e.prototype.calculateTicks=function(){var e=this.tickMethod,t=[];if(xr(e)){var n=function(e){return hW[e]}(e);if(!n)throw new Error("There is no method to to calculate ticks!");t=n(this)}else or(e)&&(t=e(this));return t},e.prototype.rangeMin=function(){return this.range[0]},e.prototype.rangeMax=function(){return this.range[1]},e.prototype.calcPercent=function(e,t,n){return Or(e)?(e-t)/(n-t):NaN},e.prototype.calcValue=function(e,t,n){return t+e*(n-t)},e}(),gW=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="cat",t.isCategory=!0,t}return qi(t,e),t.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var e=0;e<this.values.length;e++)this.translateIndexMap.set(this.values[e],e)}},t.prototype.translate=function(e){this.buildIndexMap();var t=this.translateIndexMap.get(e);return void 0===t&&(t=Or(e)?e:NaN),t},t.prototype.scale=function(e){var t=this.translate(e),n=this.calcPercent(t,this.min,this.max);return this.calcValue(n,this.rangeMin(),this.rangeMax())},t.prototype.invert=function(e){var t=this.max-this.min,n=this.calcPercent(e,this.rangeMin(),this.rangeMax()),i=Math.round(t*n)+this.min;return i<this.min||i>this.max?NaN:this.values[i]},t.prototype.getText=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=t;return Or(t)&&!this.values.includes(t)&&(r=this.values[r]),e.prototype.getText.apply(this,Qi([r],n))},t.prototype.initCfg=function(){this.tickMethod="cat"},t.prototype.setDomain=function(){if(sr(this.getConfig("min"))&&(this.min=0),sr(this.getConfig("max"))){var e=this.values.length;this.max=e>1?e-1:e}this.translateIndexMap&&(this.translateIndexMap=void 0)},t}(fW),pW=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,mW="[^\\s]+",vW=/\[([^]*?)\]/gm;function yW(e,t){for(var n=[],i=0,r=e.length;i<r;i++)n.push(e[i].substr(0,t));return n}var _W=function(e){return function(t,n){var i=n[e].map((function(e){return e.toLowerCase()})).indexOf(t.toLowerCase());return i>-1?i:null}};function bW(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=0,r=t;i<r.length;i++){var o=r[i];for(var s in o)e[s]=o[s]}return e}var wW=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],CW=["January","February","March","April","May","June","July","August","September","October","November","December"],SW=yW(CW,3),xW={dayNamesShort:yW(wW,3),dayNames:wW,monthNamesShort:SW,monthNames:CW,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!=10?1:0)*e%10]}},EW=bW({},xW),kW=function(e){return EW=bW(EW,e)},LW=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},DW=function(e,t){for(void 0===t&&(t=2),e=String(e);e.length<t;)e="0"+e;return e},NW={D:function(e){return String(e.getDate())},DD:function(e){return DW(e.getDate())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return DW(e.getDay())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return DW(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},YY:function(e){return DW(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return DW(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return DW(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return DW(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return DW(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return DW(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return DW(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return DW(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+DW(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4)},Z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+DW(Math.floor(Math.abs(t)/60),2)+":"+DW(Math.abs(t)%60,2)}},IW=function(e){return+e-1},TW=[null,"[1-9]\\d?"],MW=[null,mW],AW=["isPm",mW,function(e,t){var n=e.toLowerCase();return n===t.amPm[0]?0:n===t.amPm[1]?1:null}],OW=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var t=(e+"").match(/([+-]|\d\d)/gi);if(t){var n=60*+t[1]+parseInt(t[2],10);return"+"===t[0]?n:-n}return 0}],RW={D:["day","[1-9]\\d?"],DD:["day","\\d\\d"],Do:["day","[1-9]\\d?"+mW,function(e){return parseInt(e,10)}],M:["month","[1-9]\\d?",IW],MM:["month","\\d\\d",IW],YY:["year","\\d\\d",function(e){var t=+(""+(new Date).getFullYear()).substr(0,2);return+(""+(+e>68?t-1:t)+e)}],h:["hour","[1-9]\\d?",void 0,"isPm"],hh:["hour","\\d\\d",void 0,"isPm"],H:["hour","[1-9]\\d?"],HH:["hour","\\d\\d"],m:["minute","[1-9]\\d?"],mm:["minute","\\d\\d"],s:["second","[1-9]\\d?"],ss:["second","\\d\\d"],YYYY:["year","\\d{4}"],S:["millisecond","\\d",function(e){return 100*+e}],SS:["millisecond","\\d\\d",function(e){return 10*+e}],SSS:["millisecond","\\d{3}"],d:TW,dd:TW,ddd:MW,dddd:MW,MMM:["month",mW,_W("monthNamesShort")],MMMM:["month",mW,_W("monthNames")],a:AW,A:AW,ZZ:OW,Z:OW},PW={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},FW=function(e){return bW(PW,e)},BW=function(e,t,n){if(void 0===t&&(t=PW.default),void 0===n&&(n={}),"number"==typeof e&&(e=new Date(e)),"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");var i=[];t=(t=PW[t]||t).replace(vW,(function(e,t){return i.push(t),"@@@"}));var r=bW(bW({},EW),n);return(t=t.replace(pW,(function(t){return NW[t](e,r)}))).replace(/@@@/g,(function(){return i.shift()}))};function WW(e,t,n){if(void 0===n&&(n={}),"string"!=typeof t)throw new Error("Invalid format in fecha parse");if(t=PW[t]||t,e.length>1e3)return null;var i={year:(new Date).getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},r=[],o=[],s=t.replace(vW,(function(e,t){return o.push(LW(t)),"@@@"})),a={},l={};s=LW(s).replace(pW,(function(e){var t=RW[e],n=t[0],i=t[1],o=t[3];if(a[n])throw new Error("Invalid format. "+n+" specified twice in format");return a[n]=!0,o&&(l[o]=!0),r.push(t),"("+i+")"})),Object.keys(l).forEach((function(e){if(!a[e])throw new Error("Invalid format. "+e+" is required in specified format")})),s=s.replace(/@@@/g,(function(){return o.shift()}));var c=e.match(new RegExp(s,"i"));if(!c)return null;for(var u=bW(bW({},EW),n),h=1;h<c.length;h++){var d=r[h-1],f=d[0],g=d[2],p=g?g(c[h],u):+c[h];if(null==p)return null;i[f]=p}1===i.isPm&&null!=i.hour&&12!=+i.hour?i.hour=+i.hour+12:0===i.isPm&&12==+i.hour&&(i.hour=0);for(var m=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond),v=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],y=(h=0,v.length);h<y;h++)if(a[v[h][0]]&&i[v[h][0]]!==m[v[h][1]]())return null;return null==i.timezoneOffset?m:new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond))}var zW={format:BW,parse:WW,defaultI18n:xW,setGlobalDateI18n:kW,setGlobalDateMasks:FW},VW=Object.freeze(Object.defineProperty({__proto__:null,default:zW,assign:bW,format:BW,parse:WW,defaultI18n:xW,setGlobalDateI18n:kW,setGlobalDateMasks:FW},Symbol.toStringTag,{value:"Module"}));function UW(e,t){return(VW.format||zW.format)(e,t)}function HW(e){return xr(e)&&(e=e.indexOf("T")>0?new Date(e).getTime():new Date(e.replace(/-/gi,"/")).getTime()),Yr(e)&&(e=e.getTime()),e}var jW=36e5,GW=24*jW,KW=31*GW,qW=[["HH:mm:ss",1e3],["HH:mm:ss",1e4],["HH:mm:ss",3e4],["HH:mm",6e4],["HH:mm",6e5],["HH:mm",18e5],["HH",jW],["HH",6*jW],["HH",12*jW],["YYYY-MM-DD",GW],["YYYY-MM-DD",4*GW],["YYYY-WW",7*GW],["YYYY-MM",KW],["YYYY-MM",4*KW],["YYYY-MM",6*KW],["YYYY",380*GW]];function $W(e,t,n){var i,r=(i=function(e){return e[1]},function(e,t,n,r){for(var o=sr(n)?0:n,s=sr(r)?e.length:r;o<s;){var a=o+s>>>1;i(e[a])>t?s=a:o=a+1}return o})(qW,(t-e)/n)-1,o=qW[r];return r<0?o=qW[0]:r>=qW.length&&(o=Lr(qW)),o}var YW=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="timeCat",t}return qi(t,e),t.prototype.translate=function(e){e=HW(e);var t=this.values.indexOf(e);return-1===t&&(t=Or(e)&&e<this.values.length?e:NaN),t},t.prototype.getText=function(e,t){var n=this.translate(e);if(n>-1){var i=this.values[n],r=this.formatter;return i=r?r(i,t):UW(i,this.mask)}return e},t.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},t.prototype.setDomain=function(){var t=this.values;cr(t,(function(e,n){t[n]=HW(e)})),t.sort((function(e,t){return e-t})),e.prototype.setDomain.call(this)},t}(gW),XW=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isContinuous=!0,t}return qi(t,e),t.prototype.scale=function(e){if(sr(e))return NaN;var t=this.rangeMin(),n=this.rangeMax();return this.max===this.min?t:t+this.getScalePercent(e)*(n-t)},t.prototype.init=function(){e.prototype.init.call(this);var t=this.ticks,n=kr(t),i=Lr(t);n<this.min&&(this.min=n),i>this.max&&(this.max=i),sr(this.minLimit)||(this.min=n),sr(this.maxLimit)||(this.max=i)},t.prototype.setDomain=function(){var e=vr(this.values),t=e.min,n=e.max;sr(this.min)&&(this.min=t),sr(this.max)&&(this.max=n),this.min>this.max&&(this.min=t,this.max=n)},t.prototype.calculateTicks=function(){var t=this,n=e.prototype.calculateTicks.call(this);return this.nice||(n=nr(n,(function(e){return e>=t.min&&e<=t.max}))),n},t.prototype.getScalePercent=function(e){var t=this.max,n=this.min;return(e-n)/(t-n)},t.prototype.getInvertPercent=function(e){return(e-this.rangeMin())/(this.rangeMax()-this.rangeMin())},t}(fW),ZW=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="linear",t.isLinear=!0,t}return qi(t,e),t.prototype.invert=function(e){var t=this.getInvertPercent(e);return this.min+t*(this.max-this.min)},t.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},t}(XW);function QW(e,t){var n=Math.E;return t>=0?Math.pow(n,Math.log(t)/e):-1*Math.pow(n,Math.log(-t)/e)}function JW(e,t){return 1===e?1:Math.log(t)/Math.log(e)}function ez(e,t,n){sr(n)&&(n=Math.max.apply(null,e));var i=n;return cr(e,(function(e){e>0&&e<i&&(i=e)})),i===n&&(i=n/t),i>1&&(i=1),i}var tz=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="log",t}return qi(t,e),t.prototype.invert=function(e){var t,n=this.base,i=JW(n,this.max),r=this.rangeMin(),o=this.rangeMax()-r,s=this.positiveMin;if(s){if(0===e)return 0;var a=1/(i-(t=JW(n,s/n)))*o;if(e<a)return e/a*s}else t=JW(n,this.min);var l=(e-r)/o*(i-t)+t;return Math.pow(n,l)},t.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},t.prototype.setDomain=function(){e.prototype.setDomain.call(this);var t=this.min;if(t<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");0===t&&(this.positiveMin=ez(this.values,this.base,this.max))},t.prototype.getScalePercent=function(e){var t=this.max,n=this.min;if(t===n)return 0;if(e<=0)return 0;var i=this.base,r=this.positiveMin;return r&&(n=1*r/i),e<r?e/r/(JW(i,t)-JW(i,n)):(JW(i,e)-JW(i,n))/(JW(i,t)-JW(i,n))},t}(XW),nz=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="pow",t}return qi(t,e),t.prototype.invert=function(e){var t=this.getInvertPercent(e),n=this.exponent,i=QW(n,this.max),r=QW(n,this.min),o=t*(i-r)+r,s=o>=0?1:-1;return Math.pow(o,n)*s},t.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},t.prototype.getScalePercent=function(e){var t=this.max,n=this.min;if(t===n)return 0;var i=this.exponent;return(QW(i,e)-QW(i,n))/(QW(i,t)-QW(i,n))},t}(XW),iz=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="time",t}return qi(t,e),t.prototype.getText=function(e,t){var n=this.translate(e),i=this.formatter;return i?i(n,t):UW(n,this.mask)},t.prototype.scale=function(t){var n=t;return(xr(n)||Yr(n))&&(n=this.translate(n)),e.prototype.scale.call(this,n)},t.prototype.translate=function(e){return HW(e)},t.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},t.prototype.setDomain=function(){var e=this.values,t=this.getConfig("min"),n=this.getConfig("max");if(sr(t)&&Or(t)||(this.min=this.translate(this.min)),sr(n)&&Or(n)||(this.max=this.translate(this.max)),e&&e.length){var i=[],r=1/0,o=r,s=0;cr(e,(function(e){var t=HW(e);if(isNaN(t))throw new TypeError("Invalid Time: "+e+" in time scale!");r>t?(o=r,r=t):o>t&&(o=t),s<t&&(s=t),i.push(t)})),e.length>1&&(this.minTickInterval=o-r),sr(t)&&(this.min=r),sr(n)&&(this.max=s)}},t}(ZW),rz=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="quantize",t}return qi(t,e),t.prototype.invert=function(e){var t=this.ticks,n=t.length,i=this.getInvertPercent(e),r=Math.floor(i*(n-1));if(r>=n-1)return Lr(t);if(r<0)return kr(t);var o=t[r],s=r/(n-1);return o+(i-s)/((r+1)/(n-1)-s)*(t[r+1]-o)},t.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},t.prototype.calculateTicks=function(){var t=e.prototype.calculateTicks.call(this);return this.nice||(Lr(t)!==this.max&&t.push(this.max),kr(t)!==this.min&&t.unshift(this.min)),t},t.prototype.getScalePercent=function(e){var t=this.ticks;if(e<kr(t))return 0;if(e>Lr(t))return 1;var n=0;return cr(t,(function(t,i){if(!(e>=t))return!1;n=i})),n/(t.length-1)},t}(XW),oz=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="quantile",t}return qi(t,e),t.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},t}(rz),sz={};function az(e,t){if(function(e){return sz[e]}(e))throw new Error("type '"+e+"' existed.");sz[e]=t}var lz=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="identity",t.isIdentity=!0,t}return qi(t,e),t.prototype.calculateTicks=function(){return this.values},t.prototype.scale=function(e){return this.values[0]!==e&&Or(e)?e:this.range[0]},t.prototype.invert=function(e){var t=this.range;return e<t[0]||e>t[1]?NaN:this.values[0]},t}(fW);function cz(e){return Math.abs(e)<1e-15?e:parseFloat(e.toFixed(15))}var uz=[1,5,2,2.5,4,3],hz=100*Number.EPSILON;function dz(e,t,n,i,r,o){var s=Co(t),a=ao(t,e),l=0,c=function(e,t){return(e%t+t)%t}(i,o);return(c<hz||o-c<hz)&&i<=0&&r>=0&&(l=1),1-a/(s-1)-n+l}function fz(e,t,n){var i=Co(t);return 1-ao(t,e)/(i-1)-n+1}function gz(e,t,n,i,r,o){var s=(e-1)/(o-r),a=(t-1)/(Math.max(o,i)-Math.min(n,r));return 2-Math.max(s/a,a/s)}function pz(e,t){return e>=t?2-(e-1)/(t-1):1}function mz(e,t,n,i){var r=t-e;return 1-.5*(Math.pow(t-i,2)+Math.pow(e-n,2))/Math.pow(.1*r,2)}function vz(e,t,n){var i=t-e;if(n>i){var r=(n-i)/2;return 1-Math.pow(r,2)/Math.pow(.1*i,2)}return 1}function yz(e,t,n,i,r,o){void 0===n&&(n=5),void 0===i&&(i=!0),void 0===r&&(r=uz),void 0===o&&(o=[.25,.2,.5,.05]);var s=n<0?0:Math.round(n);if(Number.isNaN(e)||Number.isNaN(t)||"number"!=typeof e||"number"!=typeof t||!s)return{min:0,max:0,ticks:[]};if(t-e<1e-15||1===s)return{min:e,max:t,ticks:[e]};for(var a={score:-2,lmin:0,lmax:0,lstep:0},l=1;l<1/0;){for(var c=0;c<r.length;c+=1){var u=r[c],h=fz(u,r,l);if(o[0]*h+o[1]+o[2]+o[3]<a.score){l=1/0;break}for(var d=2;d<1/0;){var f=pz(d,s);if(o[0]*h+o[1]+o[2]*f+o[3]<a.score)break;for(var g=(t-e)/(d+1)/l/u,p=Math.ceil(Math.log10(g));p<1/0;){var m=l*u*Math.pow(10,p),v=vz(e,t,m*(d-1));if(o[0]*h+o[1]*v+o[2]*f+o[3]<a.score)break;var y=Math.floor(t/m)*l-(d-1)*l,_=Math.ceil(e/m)*l;if(y<=_)for(var b=_-y,w=0;w<=b;w+=1){var C=(y+w)*(m/l),S=C+m*(d-1),x=m,E=dz(u,r,l,C,S,x),k=mz(e,t,C,S),L=gz(d,s,e,t,C,S),D=o[0]*E+o[1]*k+o[2]*L+1*o[3];D>a.score&&(!i||C<=e&&S>=t)&&(a.lmin=C,a.lmax=S,a.lstep=x,a.score=D)}p+=1}d+=1}}l+=1}var N=cz(a.lmax),I=cz(a.lmin),T=cz(a.lstep),M=Math.floor(function(e){return Math.round(1e12*e)/1e12}((N-I)/T))+1,A=new Array(M);A[0]=cz(I);for(c=1;c<M;c++)A[c]=cz(A[c-1]+T);return{min:Math.min(e,kr(A)),max:Math.max(t,Lr(A)),ticks:A}}function _z(e){var t=e.values,n=e.tickInterval,i=e.tickCount,r=t;if(Or(n))return nr(r,(function(e,t){return t%n==0}));var o=e.min,s=e.max;if(sr(o)&&(o=0),sr(s)&&(s=t.length-1),Or(i)&&i<s-o){var a=yz(o,s,i,!1,[1,2,5,3,4,7,6,8,9]).ticks;return nr(a,(function(e){return e>=o&&e<=s})).map((function(e){return t[e]}))}return t.slice(o,s+1)}var bz=Math.sqrt(50),wz=Math.sqrt(10),Cz=Math.sqrt(2),Sz=function(){function e(){this._domain=[0,1]}return e.prototype.domain=function(e){return e?(this._domain=Array.from(e,Number),this):this._domain.slice()},e.prototype.nice=function(e){var t,n;void 0===e&&(e=5);var i,r=this._domain.slice(),o=0,s=this._domain.length-1,a=this._domain[o],l=this._domain[s];return l<a&&(a=(t=[l,a])[0],l=t[1],o=(n=[s,o])[0],s=n[1]),(i=xz(a,l,e))>0?i=xz(a=Math.floor(a/i)*i,l=Math.ceil(l/i)*i,e):i<0&&(i=xz(a=Math.ceil(a*i)/i,l=Math.floor(l*i)/i,e)),i>0?(r[o]=Math.floor(a/i)*i,r[s]=Math.ceil(l/i)*i,this.domain(r)):i<0&&(r[o]=Math.ceil(a*i)/i,r[s]=Math.floor(l*i)/i,this.domain(r)),this},e.prototype.ticks=function(e){return void 0===e&&(e=5),function(e,t,n){var i,r,o,s,a=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];(i=t<e)&&(r=e,e=t,t=r);if(0===(s=xz(e,t,n))||!isFinite(s))return[];if(s>0)for(e=Math.ceil(e/s),t=Math.floor(t/s),o=new Array(r=Math.ceil(t-e+1));++a<r;)o[a]=(e+a)*s;else for(e=Math.floor(e*s),t=Math.ceil(t*s),o=new Array(r=Math.ceil(e-t+1));++a<r;)o[a]=(e-a)/s;i&&o.reverse();return o}(this._domain[0],this._domain[this._domain.length-1],e||5)},e}();function xz(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=bz?10:o>=wz?5:o>=Cz?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=bz?10:o>=wz?5:o>=Cz?2:1)}function Ez(e,t,n){return("ceil"===n?Math.ceil(e/t):"floor"===n?Math.floor(e/t):Math.round(e/t))*t}function kz(e,t,n){var i=Ez(e,n,"floor"),r=Ez(t,n,"ceil");i=Ar(i,n),r=Ar(r,n);for(var o=[],s=Math.max((r-i)/(Math.pow(2,12)-1),n),a=i;a<=r;a+=s){var l=Ar(a,s);o.push(l)}return{min:i,max:r,ticks:o}}function Lz(e,t,n){var i,r=e.minLimit,o=e.maxLimit,s=e.min,a=e.max,l=e.tickCount,c=void 0===l?5:l,u=sr(r)?sr(t)?s:t:r,h=sr(o)?sr(n)?a:n:o;if(u>h&&(h=(i=[u,h])[0],u=i[1]),c<=2)return[u,h];for(var d=(h-u)/(c-1),f=[],g=0;g<c;g++)f.push(u+d*g);return f}function Dz(e,t,n){if(void 0===n&&(n=5),e===t)return{max:t,min:e,ticks:[e]};var i=n<0?0:Math.round(n);if(0===i)return{max:t,min:e,ticks:[]};var r=(t-e)/i,o=Math.pow(10,Math.floor(Math.log10(r))),s=o;2*o-r<1.5*(r-s)&&5*o-r<2.75*(r-(s=2*o))&&10*o-r<1.5*(r-(s=5*o))&&(s=10*o);for(var a=Math.ceil(t/s),l=Math.floor(e/s),c=Math.max(a*s,t),u=Math.min(l*s,e),h=Math.floor((c-u)/s)+1,d=new Array(h),f=0;f<h;f++)d[f]=cz(u+f*s);return{min:u,max:c,ticks:d}}function Nz(e,t){var n=e.length*t;return 1===t?e[e.length-1]:0===t?e[0]:n%1!=0?e[Math.ceil(n)-1]:e.length%2==0?(e[n-1]+e[n])/2:e[n]}function Iz(e){return new Date(e).getFullYear()}function Tz(e){return new Date(e,0,1).getTime()}function Mz(e){return new Date(e).getMonth()}function Az(e,t){return new Date(e,t,1).getTime()}dW("cat",_z),dW("time-cat",(function(e){var t=_z(e),n=Lr(e.values);return n!==Lr(t)&&t.push(n),t})),dW("wilkinson-extended",(function(e){var t=e.min,n=e.max,i=e.tickCount,r=e.nice,o=e.tickInterval,s=e.minLimit,a=e.maxLimit,l=yz(t,n,i,r).ticks;return sr(s)&&sr(a)?o?kz(t,n,o).ticks:l:Lz(e,kr(l),Lr(l))})),dW("r-pretty",(function(e){var t=e.min,n=e.max,i=e.tickCount,r=e.tickInterval,o=e.minLimit,s=e.maxLimit,a=Dz(t,n,i).ticks;return sr(o)&&sr(s)?r?kz(t,n,r).ticks:a:Lz(e,kr(a),Lr(a))})),dW("time",(function(e){var t=e.min,n=e.max,i=e.minTickInterval,r=e.tickInterval,o=e.tickCount;if(r)o=Math.ceil((n-t)/r);else{var s=(n-t)/(r=$W(t,n,o)[1])/o;s>1&&(r*=Math.ceil(s)),i&&r<i&&(r=i)}r=Math.max(Math.floor((n-t)/(Math.pow(2,12)-1)),r);for(var a=[],l=t;l<n+r;l+=r)a.push(l);return a})),dW("time-pretty",(function(e){var t=e.min,n=e.max,i=e.minTickInterval,r=e.tickCount,o=e.tickInterval,s=[];o||(o=(n-t)/r,i&&o<i&&(o=i)),o=Math.max(Math.floor((n-t)/(Math.pow(2,12)-1)),o);var a=Iz(t);if(o>31536e6)for(var l=Iz(n),c=Math.ceil(o/31536e6),u=a;u<=l+c;u+=c)s.push(Tz(u));else if(o>KW){var h=Math.ceil(o/KW),d=Mz(t),f=function(e,t){var n=Iz(e),i=Iz(t),r=Mz(e);return 12*(i-n)+(Mz(t)-r)%12}(t,n);for(u=0;u<=f+h;u+=h)s.push(Az(a,u+d))}else if(o>GW){var g=(_=new Date(t)).getFullYear(),p=_.getMonth(),m=_.getDate(),v=Math.ceil(o/GW),y=function(e,t){return Math.ceil((t-e)/GW)}(t,n);for(u=0;u<y+v;u+=v)s.push(new Date(g,p,m+u).getTime())}else if(o>jW){g=(_=new Date(t)).getFullYear(),p=_.getMonth(),v=_.getDate();var _,b=_.getHours(),w=Math.ceil(o/jW),C=function(e,t){return Math.ceil((t-e)/jW)}(t,n);for(u=0;u<=C+w;u+=w)s.push(new Date(g,p,v,b+u).getTime())}else if(o>6e4){var S=function(e,t){return Math.ceil((t-e)/6e4)}(t,n),x=Math.ceil(o/6e4);for(u=0;u<=S+x;u+=x)s.push(t+6e4*u)}else{var E=o;E<1e3&&(E=1e3);var k=1e3*Math.floor(t/1e3),L=Math.ceil((n-t)/1e3),D=Math.ceil(E/1e3);for(u=0;u<L+D;u+=D)s.push(k+1e3*u)}return s.length>=512&&console.warn("Notice: current ticks length("+s.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+o+") is too small, increase the value to solve the problem!"),s})),dW("log",(function(e){var t,n=e.base,i=e.tickCount,r=e.min,o=e.max,s=e.values,a=JW(n,o);if(r>0)t=Math.floor(JW(n,r));else{var l=ez(s,n,o);t=Math.floor(JW(n,l))}for(var c=a-t,u=Math.ceil(c/i),h=[],d=t;d<a+u;d+=u)h.push(Math.pow(n,d));return r<=0&&h.unshift(0),h})),dW("pow",(function(e){var t=e.exponent,n=e.tickCount,i=Math.ceil(QW(t,e.max));return Dz(Math.floor(QW(t,e.min)),i,n).ticks.map((function(e){var n=e>=0?1:-1;return Math.pow(e,t)*n}))})),dW("quantile",(function(e){var t=e.tickCount,n=e.values;if(!n||!n.length)return[];for(var i=n.slice().sort((function(e,t){return e-t})),r=[],o=0;o<t;o++){var s=o/(t-1);r.push(Nz(i,s))}return r})),dW("d3-linear",(function(e){var t=e.min,n=e.max,i=e.tickInterval,r=e.minLimit,o=e.maxLimit,s=function(e){var t=e.min,n=e.max,i=e.nice,r=e.tickCount,o=new Sz;return o.domain([t,n]),i&&o.nice(r),o.ticks(r)}(e);return sr(r)&&sr(o)?i?kz(t,n,i).ticks:s:Lz(e,kr(s),Lr(s))})),az("cat",gW),az("category",gW),az("identity",lz),az("linear",ZW),az("log",tz),az("pow",nz),az("time",iz),az("timeCat",YW),az("quantize",rz),az("quantile",oz);function Oz(e){return function(e){return fo(e,(function(e,t){return[0===t?"M":"L",e[0],e[1]]}))}(e)}function Rz(e,t,n,i){void 0===i&&(i=!0);var r=new ZW({values:e}),o=new gW({values:fo(e,(function(e,t){return t}))}),s=fo(e,(function(e,i){return[o.scale(i)*t,n-r.scale(e)*n]}));return i?function(e){if(e.length<=2)return Oz(e);var t=[];cr(e,(function(e){ho(e,t.slice(t.length-2))||t.push(e[0],e[1])}));var n=zd(t,!1),i=kr(e),r=i[0],o=i[1];return n.unshift(["M",r,o]),n}(s):Oz(s)}function Pz(e,t,n,i){void 0===i&&(i=5);for(var r=new ZW({values:e}),o=new gW({values:fo(e,(function(e,t){return t}))}),s=fo(e,(function(e,i){return[o.scale(i)*t,n-r.scale(e)*n]})),a=[],l=0;l<s.length;l++){var c=s[l],u=Bz({x:c[0],y:c[1],y0:n,size:i});a.push.apply(a,u)}return function(e,t){void 0===t&&(t=!0);var n=[],i=e[0];n.push(["M",i.x,i.y]);for(var r=1,o=e.length;r<o;r++)n.push(["L",e[r].x,e[r].y]);t&&(n.push(["L",i.x,i.y]),n.push(["z"]));return n}(a)}function Fz(e,t,n,i){var r=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}([],e,!0),o=function(e,t){var n=new ZW({values:e}),i=Math.max(0,n.min);return t-n.scale(i)*t}(i,n);return r.push(["L",t,o]),r.push(["L",0,o]),r.push(["Z"]),r}function Bz(e){var t,n,i,r,o=e.x,s=e.y,a=e.y0,l=e.size;ar(s)?(t=s[0],n=s[1]):(t=a,n=s),ar(o)?(i=o[0],r=o[1]):(i=o-l/2,r=o+l/2);var c=[{x:i,y:t},{x:i,y:n}];return c.push({x:r,y:n},{x:r,y:t}),c}var Wz=function(){return(Wz=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},zz={stroke:"#C5C5C5",strokeOpacity:.85},Vz={fill:"#CACED4",opacity:.85},Uz=function(){function e(e){var t=e.x,n=void 0===t?0:t,i=e.y,r=void 0===i?0:i,o=e.width,s=void 0===o?200:o,a=e.height,l=void 0===a?26:a,c=e.smooth,u=void 0===c||c,h=e.isArea,d=void 0!==h&&h,f=e.data,g=void 0===f?[]:f,p=e.lineStyle,m=e.areaStyle,v=e.group,y=e.interval,_=void 0===y?null:y;this.group=v,this.x=n,this.y=r,this.width=s,this.height=l,this.data=g,this.smooth=u,this.isArea=d,this.lineStyle=Object.assign({},zz,p),this.areaStyle=Object.assign({},Vz,m),this.intervalConfig=_,this.renderLine()}return e.prototype.renderLine=function(){var e=this,t=e.x,n=e.y,i=e.width,r=e.height;e.barWidth;var o=e.data,s=e.smooth,a=e.isArea,l=e.lineStyle,c=e.areaStyle,u=this.group.addGroup({name:"trend-group"});if(o){var h=Rz(o,i,r,s);if(u.addShape("path",{attrs:Wz({path:h},l),name:"trend-line"}),a){var d=Fz(h,i,r,o);u.addShape("path",{attrs:Wz({path:d},c),name:"trend-area"})}}this.intervalConfig&&u.addShape("path",{attrs:Wz({path:Pz(this.intervalConfig.data,i,r,this.intervalConfig.style.barWidth)},this.intervalConfig.style),name:"trend-interval"}),u.move(t,n)},e.prototype.destory=function(){this.group.destroy()},e}(),Hz=function(){return(Hz=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},jz={fill:"#1890ff",stroke:"#1890ff",type:"trend",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#0050b3"},Gz={fill:"#fff",stroke:"#1890ff",radius:2,opacity:1,cursor:"ew-resize"},Kz=function(){function e(e){var t=e.group,n=e.name,i=e.type,r=e.x,o=void 0===r?0:r,s=e.y,a=void 0===s?0:s,l=e.width,c=void 0===l?2:l,u=e.height,h=void 0===u?24:u,d=e.style,f=void 0===d?{}:d;this.group=t,this.name=n,this.handleType=i,this.x=o,this.y=a,this.width=c,this.height=h,"trend"===i?this.style=Hz(Hz({},jz),f):"simple"===i&&(this.style=Hz(Hz({},Gz),f)),this.renderHandle()}return e.prototype.setX=function(e){this.setXY(e,void 0)},e.prototype.setY=function(e){this.setXY(void 0,e)},e.prototype.setXY=function(e,t){Or(e)&&(this.x=e),Or(t)&&(this.y=t),this.updateXY()},e.prototype.renderHandle=function(){var e=this,t=e.width,n=e.height,i=e.style,r=e.name,o=i.fill,s=i.stroke,a=i.radius,l=i.opacity,c=i.cursor;this.handleGroup=this.group.addGroup(),"trend"===this.handleType?(this.verticalLine=this.handleGroup.addShape("rect",{attrs:{x:0,y:0,width:t,height:n,fill:o,stroke:s,radius:a,opacity:l,cursor:c},name:"".concat(r,"-handler")}),this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:0,r:2*t,fill:o,stroke:s,radius:a,opacity:l,cursor:c,lineAppendWidth:12},name:"".concat(r,"-handler")}),this.bottomCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:n,r:2*t,fill:o,stroke:s,radius:a,opacity:l,cursor:c},name:"".concat(r,"-handler")})):"simple"===this.handleType&&(this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:n/2,r:2*t,fill:o,stroke:s,radius:a,opacity:l,cursor:c,lineWidth:2},name:"".concat(r,"-handler")})),this.updateXY(),"trend"===this.handleType?this.bindTrendEvents():"simple"===this.handleType&&this.bindSimpleEvents()},e.prototype.bindSimpleEvents=function(){var e=this,t=this.name;this.handleGroup.on("".concat(t,"-handler:mouseenter"),(function(){var t=e.style.highLightFill;e.topCircle.attr("fill",t)})),this.handleGroup.on("".concat(t,"-handler:mouseleave"),(function(){var t=e.style.fill;e.topCircle.attr("fill",t)}))},e.prototype.bindTrendEvents=function(){var e=this,t=this.name;this.handleGroup.on("".concat(t,"-handler:mouseenter"),(function(){var t=e.style.highLightFill;e.verticalLine.attr("fill",t),e.topCircle.attr("fill",t),e.bottomCircle.attr("fill",t)})),this.handleGroup.on("".concat(t,"-handler:mouseleave"),(function(){var t=e.style.fill;e.verticalLine.attr("fill",t),e.topCircle.attr("fill",t),e.bottomCircle.attr("fill",t)}))},e.prototype.show=function(){this.handleGroup.show()},e.prototype.hide=function(){this.handleGroup.hide()},e.prototype.updateXY=function(){this.handleGroup.setMatrix([1,0,0,0,1,0,this.x,this.y,1])},e}(),qz=function(){return(qz=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},$z=function(){function e(e){this.config=so({},e),this.init()}return e.prototype.update=function(e){this.config=so({},this.config,e),this.updateElement(),this.renderMarker()},e.prototype.init=function(){this.initElement(),this.renderMarker()},e.prototype.initElement=function(){var e=this.config,t=e.group,n=e.style,i=n.scale,r=void 0===i?1:i,o=n.offsetX,s=void 0===o?0:o,a=n.offsetY,l=void 0===a?0:a,c=this.config.x+s,u=this.config.y+l,h=t.addGroup({name:"playPauseBtn"});this.startMarkerGroup=h.addGroup({name:"playPauseBtn"}),this.circle=t.addShape("circle",{attrs:qz({x:c,y:u,r:this.config.r*r},n),name:"playPauseBtn"}),this.startMarker=this.startMarkerGroup.addShape("path",{attrs:{path:this.getStartMarkerPath(c,u,r),fill:n.stroke||"#aaa"},name:"start-marker"}),this.pauseMarkerGroup=h.addGroup({name:"playPauseBtn"});var d=.25*this.config.r*r,f=.5*this.config.r*Math.sqrt(3)*r;this.pauseLeftMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:c-.375*this.config.r*r,y:u-f/2,width:d,height:f,fill:n.stroke||"#aaa",lineWidth:0}}),this.pauseRightMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:c+1/8*this.config.r*r,y:u-f/2,width:d,height:f,fill:n.stroke||"#aaa",lineWidth:0}})},e.prototype.updateElement=function(){var e=this.config.style,t=e.scale,n=void 0===t?1:t,i=e.offsetX,r=void 0===i?0:i,o=e.offsetY,s=void 0===o?0:o,a=this.config.x+r,l=this.config.y+s;this.circle.attr("x",a),this.circle.attr("y",l),this.circle.attr("r",this.config.r*n),this.startMarker.attr("path",this.getStartMarkerPath(a,l,n));var c=.25*this.config.r*n,u=.5*this.config.r*Math.sqrt(3)*n;this.pauseLeftMarker.attr("x",a-.375*this.config.r*n),this.pauseLeftMarker.attr("y",l-u/2),this.pauseLeftMarker.attr("width",c),this.pauseLeftMarker.attr("height",u),this.pauseRightMarker.attr("x",a+1/8*this.config.r*n),this.pauseRightMarker.attr("y",l-u/2),this.pauseRightMarker.attr("width",c),this.pauseRightMarker.attr("height",u)},e.prototype.renderMarker=function(){this.config.isPlay?(this.startMarkerGroup.hide(),this.pauseMarkerGroup.show()):(this.startMarkerGroup.show(),this.pauseMarkerGroup.hide())},e.prototype.getStartMarkerPath=function(e,t,n){var i=.5*this.config.r*Math.sqrt(3)*n;return[["M",e-i/Math.sqrt(3)/2,t-i/2],["L",e+i/Math.sqrt(3),t],["L",e-i/Math.sqrt(3)/2,t+i/2]]},e}(),Yz=function(){return(Yz=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Xz=Us,Zz={fill:"#aaa",fillOpacity:.35,stroke:"#aaa"},Qz={fill:"#fff"},Jz={fill:"green"},eV={pointer:{fill:"#aaa",lineWidth:0},scroller:{stroke:"#aaa",fill:"#aaa",lineWidth:1,lineAppendWidth:5,cursor:"pointer"},text:{fill:"#aaa",textBaseline:"top"}},tV={check:{stroke:"green",lineWidth:3},box:{fill:"#fff",stroke:"#aaa",lineWidth:2,radius:3,width:12,height:12},text:{fill:"#aaa",fontSize:12,textBaseline:"top"}},nV={speed:1,loop:!1,fill:"#fff",stroke:"#fff",hideTimeTypeController:!1,preBtnStyle:{fill:"#aaa",stroke:"#aaa"},nextBtnStyle:{fill:"#aaa",stroke:"#aaa"},playBtnStyle:{fill:"#aaa",stroke:"#aaa",fillOpacity:.05},speedControllerStyle:eV,timeTypeControllerStyle:tV},iV=function(){function e(e){this.controllerCfg=so({},nV,e),this.group=e.group,this.controllerGroup=this.group.addGroup({name:"controller-group"}),this.speedAxisY=[],this.currentSpeed=this.controllerCfg.speed,this.currentType="range",this.fontFamily=e.fontFamily||"Arial, sans-serif",this.init()}return e.prototype.init=function(){this.renderPlayButton()},e.prototype.getNextMarkerPath=function(e,t,n){return[["M",e,t-n],["L",e+n,t],["L",e,t+n],["Z",e,t-n],["M",e,t],["L",e-n,t-n],["L",e-n,t+n],["Z"]]},e.prototype.getPreMarkerPath=function(e,t,n){return[["M",e,t-n],["L",e-n,t],["L",e,t+n],["L",e,t-n],["M",e,t],["L",e+n,t-n],["L",e+n,t+n],["Z"]]},e.prototype.renderPlayButton=function(){var e=this.controllerCfg,t=e.width,n=e.height,i=e.x,r=e.y,o=e.hideTimeTypeController,s=e.fill,a=void 0===s?"#aaa":s,l=e.stroke,c=void 0===l?"green":l,u=e.containerStyle,h=void 0===u?{}:u,d=Yz(Yz({},Zz),e.playBtnStyle||{}),f=Yz(Yz({},Qz),e.preBtnStyle||{}),g=Yz(Yz({},Jz),e.nextBtnStyle||{}),p=n/2-5,m=r+10,v=this.controllerGroup.addShape("rect",{attrs:Yz({x:i,y:m,width:t,height:n,stroke:c,fill:a},h),name:"container-rect"});this.playButton?this.playButton.update({x:t/2,y:m,r:p}):this.playButton=new $z({group:this.controllerGroup,x:t/2,y:m+p+5,r:p,isPlay:this.isPlay,style:d});var y=f.offsetX||0,_=f.offsetY||0,b=(f.scale||1)*p;this.controllerGroup.addShape("path",{attrs:Yz({path:this.getPreMarkerPath(t/2-5*p+y,m+p+5+_,.5*b)},f),name:"preStepBtn"});var w=g.offsetX||0,C=g.offsetY||0,S=(g.scale||1)*p;this.controllerGroup.addShape("path",{attrs:Yz({path:this.getNextMarkerPath(t/2+5*p+w,m+p+5+C,.5*S)},g),name:"nextStepBtn"}),v.toBack(),this.renderSpeedBtn(),o||this.renderToggleTime(),this.bindEvent();var x=this.controllerCfg.scale,E=void 0===x?1:x,k=this.controllerGroup.getCanvasBBox(),L=(k.maxX+k.minX)/2,D=(k.maxY+k.minY)/2,N=Xz([1,0,0,0,1,0,0,0,1],[["t",-L,-D],["s",E,E],["t",L,D]]);this.controllerGroup.setMatrix(N)},e.prototype.renderSpeedBtn=function(){var e=this.controllerCfg,t=e.y,n=e.width,i=e.hideTimeTypeController,r=Yz(Yz({},eV),this.controllerCfg.speedControllerStyle||{}),o=r.scroller,s=void 0===o?{}:o,a=r.text,l=void 0===a?{}:a,c=r.pointer,u=void 0===c?{}:c,h=r.scale,d=void 0===h?1:h,f=r.offsetX,g=void 0===f?0:f,p=r.offsetY,m=void 0===p?0:p,v=this.controllerGroup.addGroup({name:"speed-group"});this.speedGroup=v;var y=5;this.speedAxisY=[19,22,26,32,39];for(var _=0;_<5;_++){var b=t+this.speedAxisY[_],w=n-(i?50:110);v.addShape("line",{attrs:Yz({x1:w,x2:w+15,y1:b,y2:b},s),speed:y,name:"speed-rect"}),this.speedAxisY[_]=b,y-=1}this.speedText=v.addShape("text",{attrs:Yz({x:n-(i?50:110)+20,y:this.speedAxisY[0]+4,text:"1.0X",fontFamily:this.fontFamily||"Arial, sans-serif"},l),name:"speed-text"}),this.speedPoint=v.addShape("path",{attrs:Yz({path:this.getPointerPath(n-(i?50:110),0),matrix:[1,0,0,0,1,0,0,this.speedAxisY[4],1]},u),name:"speed-pointer"});var C=this.speedGroup.getCanvasBBox(),S=(C.maxX+C.minX)/2,x=(C.maxY+C.minY)/2,E=this.speedGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];E=Xz(E,[["t",-S,-x],["s",d,d],["t",S+g*d,x+m*d]]),this.speedGroup.setMatrix(E)},e.prototype.getPointerPath=function(e,t){return[["M",e,t],["L",e-10,t-4],["L",e-10,t+4],["Z"]]},e.prototype.renderToggleTime=function(){var e,t=this.controllerCfg.width,n=Yz(Yz({},tV),this.controllerCfg.timeTypeControllerStyle||{}),i=n.scale,r=void 0===i?1:i,o=n.offsetX,s=void 0===o?0:o,a=n.offsetY,l=void 0===a?0:a,c=n.box,u=void 0===c?{}:c,h=n.check,d=void 0===h?{}:h,f=n.text,g=void 0===f?{}:f;this.toggleGroup=this.controllerGroup.addGroup({name:"toggle-group"}),this.toggleGroup.addShape("rect",{attrs:Yz({x:t-50,y:this.speedAxisY[0]+3.5},u),isChecked:!1,name:"toggle-model"}),this.checkedIcon=this.toggleGroup.addShape("path",{attrs:Yz({path:[["M",t-50+3,this.speedAxisY[1]+6],["L",t-50+7,this.speedAxisY[1]+10],["L",t-50+12,this.speedAxisY[1]+4]]},d),capture:!1,name:"check-icon"}),this.checkedIcon.hide(),this.checkedText=this.toggleGroup.addShape("text",{attrs:Yz({text:(null===(e=this.controllerCfg)||void 0===e?void 0:e.timePointControllerText)||"单一时间",x:t-50+15,y:this.speedAxisY[0]+4,fontFamily:"undefined"!=typeof window&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},g),name:"checked-text"});var p=this.toggleGroup.getCanvasBBox(),m=(p.maxX+p.minX)/2,v=(p.maxY+p.minY)/2,y=this.toggleGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];y=Xz(y,[["t",-m,-v],["s",r,r],["t",m+s*r,v+l*r]]),this.toggleGroup.setMatrix(y)},e.prototype.bindEvent=function(){var e=this;this.speedGroup.on("speed-rect:click",(function(t){var n=t.target.attr("y1"),i=e.speedPoint.attr("matrix"),r=e.speedAxisY.indexOf(i[7]||0),o=e.speedAxisY.indexOf(n),s=e.speedAxisY[o]-e.speedAxisY[r];i=Xz(i,[["t",0,s]]),e.speedPoint.setMatrix(i),e.currentSpeed=e.speedAxisY.length-o,e.speedText.attr("text","".concat(e.currentSpeed,".0X")),e.group.emit("timebarConfigChanged",{speed:e.currentSpeed,type:e.currentType})})),this.speedGroup.on("mousewheel",(function(t){t.preventDefault();var n=e.speedPoint.attr("matrix")||[1,0,0,0,1,0,0,0,1],i=n[7],r=e.speedAxisY.indexOf(i);if(-1===r){var o=1/0;e.speedAxisY.forEach((function(e,t){var n=Math.abs(e-i);o>n&&(o=n,r=t)}))}r=t.originalEvent.deltaY>0?Math.max(0,r-1):Math.min(e.speedAxisY.length-1,r+1);var s=e.speedAxisY[r]-i;n=Xz(n,[["t",0,s]]),e.speedPoint.setMatrix(n),e.currentSpeed=e.speedAxisY.length-r,e.speedText.attr("text","".concat(e.currentSpeed,".0X")),e.group.emit("timebarConfigChanged",{speed:e.currentSpeed,type:e.currentType})})),this.toggleGroup&&this.toggleGroup.on("toggle-model:click",(function(t){var n,i,r=t.target.get("isChecked");r?(e.checkedIcon.hide(),e.checkedText.attr("text",(null===(i=e.controllerCfg)||void 0===i?void 0:i.timePointControllerText)||"单一时间"),e.currentType="range"):(e.checkedIcon.show(),e.checkedText.attr("text",(null===(n=e.controllerCfg)||void 0===n?void 0:n.timeRangeControllerText)||"时间范围"),e.currentType="single"),t.target.set("isChecked",!r),e.group.emit("timebarConfigChanged",{type:e.currentType,speed:e.currentSpeed})}))},e.prototype.destroy=function(){this.speedGroup.off("speed-rect:click"),this.toggleGroup&&(this.toggleGroup.off("toggle-model:click"),this.toggleGroup.destroy()),this.speedGroup.destroy()},e}(),rV=function(){return(rV=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},oV=Us,sV={fill:"#416180",opacity:.05},aV={fill:"#416180",opacity:.15,radius:5},lV={fill:"#5B8FF9",opacity:.3,cursor:"grab"},cV={width:2,height:24},uV={textBaseline:"middle",fill:"#000",opacity:.45},hV={textAlign:"center",textBaseline:"top",fill:"#607889",opacity:.35},dV={lineWidth:1,stroke:"#ccc"},fV=function(){function e(e){var t=this;this.prevX=0,this.onMouseDown=function(e){return function(n){t.currentHandler=e;var i=n.originalEvent;i.stopPropagation(),i.preventDefault(),t.prevX=po(i,"touches.0.pageX",i.pageX);var r=t.canvas.get("container");r.addEventListener("mousemove",t.onMouseMove),r.addEventListener("mouseup",t.onMouseUp),r.addEventListener("mouseleave",t.onMouseUp),r.addEventListener("touchmove",t.onMouseMove),r.addEventListener("touchend",t.onMouseUp),r.addEventListener("touchcancel",t.onMouseUp)}},this.onMouseMove=function(e){e.stopPropagation(),e.preventDefault();var n=po(e,"touches.0.pageX",e.pageX),i=n-t.prevX,r=t.adjustOffsetRange(i/t.width);t.updateStartEnd(r),t.updateUI(),t.prevX=n},this.onMouseUp=function(){t.currentHandler&&(t.currentHandler=void 0);var e=t.canvas.get("container");e&&(e.removeEventListener("mousemove",t.onMouseMove),e.removeEventListener("mouseup",t.onMouseUp),e.removeEventListener("mouseleave",t.onMouseUp),e.removeEventListener("touchmove",t.onMouseMove),e.removeEventListener("touchend",t.onMouseUp),e.removeEventListener("touchcancel",t.onMouseUp))};var n=e.x,i=void 0===n?0:n,r=e.y,o=void 0===r?0:r,s=e.width,a=void 0===s?100:s,l=e.height,c=e.padding,u=void 0===c?10:c,h=e.trendCfg,d=e.controllerCfg,f=void 0===d?{speed:1}:d,g=e.backgroundStyle,p=void 0===g?{}:g,m=e.foregroundStyle,v=void 0===m?{}:m,y=e.handlerStyle,_=void 0===y?{}:y,b=e.textStyle,w=void 0===b?{}:b,C=e.start,S=void 0===C?0:C,x=e.end,E=void 0===x?1:x,k=e.minText,L=void 0===k?"":k,D=e.maxText,N=void 0===D?"":D,I=e.group,T=e.graph,M=e.canvas,A=e.tick,O=void 0===A?{tickLabelStyle:{},tickLineStyle:{},tickLabelFormatter:function(e){return e},ticks:[]}:A,R=e.type;this.graph=T,this.canvas=M,this.group=I,this.timeBarType=R,this.x=i,this.y=o,this.width=a,this.height=l,this.padding=u,this.ticks=O.ticks,this.trendCfg=h,this.controllerCfg=f,this.currentSpeed=f.speed||1,this.tickLabelFormatter=O.tickLabelFormatter,"trend"===R?this.backgroundStyle=rV(rV({},sV),p):"simple"===R&&(this.backgroundStyle=rV(rV({},aV),p)),this.foregroundStyle=rV(rV({},lV),v),this.handlerStyle=rV(rV({},cV),_),this.textStyle=rV(rV({},uV),w),this.tickLabelStyle=rV(rV({},hV),O.tickLabelStyle),this.tickLineStyle=rV(rV({},dV),O.tickLineStyle),this.currentMode="range",this.start=S,this.end=E,this.minText=L,this.maxText=N,this.fontFamily="undefined"!=typeof window&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlider()}return e.prototype.update=function(e){var t=e.x,n=e.y,i=e.width,r=e.height,o=e.minText,s=e.maxText,a=e.start,l=e.end;this.start=Math.min(1,Math.max(a,0)),this.end=Math.min(1,Math.max(l,0)),to(this,{x:t,y:n,width:i,height:r,minText:o,maxText:s}),this.updateUI()},e.prototype.setText=function(e,t){this.minTextShape.attr("text",e),this.maxTextShape.attr("text",t)},e.prototype.renderSlider=function(){var e=this,t=this,n=t.width,i=t.height,r=t.timeBarType;if("trend"===r&&Co(po(this.trendCfg,"data"))){var o=new Uz(rV(rV({x:this.x,y:this.y,width:n,height:i},this.trendCfg),{group:this.group}));this.trendComponent=o}var s=this.group.addGroup({name:"slider-group"});s.addShape("rect",{attrs:rV({x:0,y:0,width:n,height:i},this.backgroundStyle),name:"background"});var a=this.group.addGroup();"trend"===r?(this.minTextShape=a.addShape("text",{attrs:rV({x:0,y:i/2+this.y,textAlign:"right",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=a.addShape("text",{attrs:rV({y:i/2+this.y,textAlign:"left",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})):(this.minTextShape=a.addShape("text",{attrs:rV({x:0,y:this.y-10,textAlign:"center",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=a.addShape("text",{attrs:rV({y:this.y-10,textAlign:"center",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})),this.foregroundShape=this.group.addGroup().addShape("rect",{attrs:rV({x:0,y:this.y,height:i},this.foregroundStyle),name:"foreground-shape"}),this.foregroundShape.on("mousedown",(function(e){e.target.attr("cursor","grabbing")})),this.foregroundShape.on("mouseup",(function(t){t.target.attr("cursor",e.foregroundStyle.cursor||"grab")}));var l=po(this.handlerStyle,"width",2),c=po(this.handlerStyle,"height",24),u=this.group.addGroup({name:"minHandlerShape"});this.minHandlerShape=new Kz({name:"minHandlerShape",group:u,type:r,x:this.x,y:this.y,width:l,height:c,style:this.handlerStyle});var h=this.group.addGroup({name:"maxHandlerShape"});this.maxHandlerShape=new Kz({name:"maxHandlerShape",group:h,type:r,x:this.x,y:this.y,width:l,height:c,style:this.handlerStyle});var d=this.ticks,f=n/(d.length-1);this.tickPosList=[],this.textList&&this.textList.length&&this.textList.forEach((function(e){e.destroy()}));var g=-1/0,p=this.tickLabelStyle.rotate;delete this.tickLabelStyle.rotate,this.textList=d.map((function(t,n){var r;e.tickPosList.push(e.x+n*f),e.tickLabelFormatter?(r=e.tickLabelFormatter(t),!xr(r)&&r&&(r=t.date)):r=t.date;var o=e.x+n*f,s=e.y+i+5,a=e.group.addShape("text",{attrs:rV({x:o,y:s,text:r,fontFamily:e.fontFamily||"Arial, sans-serif"},e.tickLabelStyle),name:"tick-label"});if(Or(p)&&n!==d.length-1){var l=oV([1,0,0,0,1,0,0,0,1],[["t",-o,-s],["r",p],["t",o-5,s+2]]);a.attr({textAlign:"left",matrix:l})}0===n?a.attr({textAlign:"left"}):n!==d.length-1&&a.attr({textAlign:"right"});var c=e.group.addShape("line",{attrs:rV({x1:e.x+n*f,y1:e.y+i+2,x2:e.x+n*f,y2:e.y+i+6},e.tickLineStyle),name:"tick-line"});c.toBack();var u=a.getBBox();return u.minX>g?(a.show(),c.show(),g=u.minX+u.width+10):(a.hide(),c.hide()),a})),this.controllerBtnGroup=new iV(rV({group:this.group,x:this.x,y:this.y+i+25,width:n,height:35},this.controllerCfg)),this.updateStartEnd(0),this.updateUI(),s.move(this.x,this.y),this.bindEvents()},e.prototype.bindEvents=function(){var e=this,t=this.group.find((function(e){return"minHandlerShape"===e.get("name")}));t&&(t.on("minHandlerShape-handler:mousedown",this.onMouseDown(this.minHandlerShape)),t.on("minHandlerShape-handler:touchstart",this.onMouseDown(this.minHandlerShape)));var n=this.group.find((function(e){return"maxHandlerShape"===e.get("name")}));n&&(n.on("maxHandlerShape-handler:mousedown",this.onMouseDown(this.maxHandlerShape)),n.on("maxHandlerShape-handler:touchstart",this.onMouseDown(this.maxHandlerShape))),this.foregroundShape.on("mousedown",this.onMouseDown(this.foregroundShape)),this.foregroundShape.on("touchstart",this.onMouseDown(this.foregroundShape)),this.group.on("".concat("playPauseBtn",":click"),(function(){e.isPlay=!e.isPlay,e.currentHandler=e.maxHandlerShape,e.changePlayStatus()})),this.group.on("".concat("nextStepBtn",":click"),(function(){e.currentHandler=e.maxHandlerShape,e.updateStartEnd(.01),e.updateUI()})),this.group.on("".concat("preStepBtn",":click"),(function(){e.currentHandler=e.maxHandlerShape,e.updateStartEnd(-.01),e.updateUI()})),this.group.on("timebarConfigChanged",(function(t){var n=t.type,i=t.speed;e.currentSpeed=i,e.currentMode=n,"single"===n?(e.minHandlerShape.hide(),e.foregroundShape.hide(),e.minTextShape.hide()):"range"===n&&(e.minHandlerShape.show(),e.foregroundShape.show(),e.minTextShape.show())}))},e.prototype.adjustTickIndex=function(e){for(var t=0;t<this.tickPosList.length-1;t++)if(this.tickPosList[t]<=e&&e<=this.tickPosList[t+1])return Math.abs(this.tickPosList[t]-e)<Math.abs(e-this.tickPosList[t+1])?t:t+1;return 0},e.prototype.adjustOffsetRange=function(e){switch(this.currentHandler){case this.minHandlerShape:var t=0-this.start,n=1-this.start;return Math.min(n,Math.max(t,e));case this.maxHandlerShape:t=0-this.end,n=1-this.end;return Math.min(n,Math.max(t,e));case this.foregroundShape:t=0-this.start,n=1-this.end;return Math.min(n,Math.max(t,e));default:return 0}},e.prototype.updateStartEnd=function(e){var t=this.ticks[this.adjustTickIndex(this.start*this.width)],n=this.ticks[this.adjustTickIndex(this.end*this.width)];if(!this.currentHandler)return this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):null==t?void 0:t.date,void(this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(n):null==n?void 0:n.date);switch(this.currentHandler){case this.minHandlerShape:this.maxText=this.maxTextShape.attr("text"),this.start+=e,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):t.date;break;case this.maxHandlerShape:this.minText=this.minTextShape.attr("text"),this.end+=e,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(n):n.date;break;case this.foregroundShape:this.start+=e,this.end+=e,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):t.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(n):n.date}},e.prototype.updateUI=function(){var e=this;this.start<0&&(this.start=0),this.end>1&&(this.end=1);var t=this.x+this.start*this.width,n=this.x+this.end*this.width;this.foregroundShape.attr("x",t),this.foregroundShape.attr("width",n-t);var i=po(this.handlerStyle,"width",2);this.setText(this.minText,this.maxText);var r=this.dodgeText([t,n]),o=r[0],s=r[1];this.minHandlerShape.setX(t-i/2),cr(o,(function(t,n){return e.minTextShape.attr(n,t)})),this.maxHandlerShape.setX(n-i/2),cr(s,(function(t,n){return e.maxTextShape.attr(n,t)})),"range"===this.currentMode?this.graph.emit("valuechange",{value:[this.start,this.end].sort()}):"single"===this.currentMode&&this.graph.emit("valuechange",{value:[this.end,this.end]})},e.prototype.dodgeText=function(e){var t,n,i=po(this.handlerStyle,"width",2),r=this.minTextShape,o=this.maxTextShape,s=e[0],a=e[1],l=!1;s>a&&(s=(t=[a,s])[0],a=t[1],r=(n=[o,r])[0],o=n[1],l=!0);var c=r.getBBox(),u=o.getBBox(),h=null,d=null;return"trend"===this.timeBarType?(h=s-c.width<this.x+2?{x:s+i/2+2,textAlign:"left"}:{x:s-i/2-2,textAlign:"right"},d=a+u.width>this.x+this.width?{x:a-i/2-2,textAlign:"right"}:{x:a+i/2+2,textAlign:"left"}):"simple"===this.timeBarType&&(h=r.attr("x")>c.width?{x:s,textAlign:"center"}:{x:s,textAlign:"left"},d=o.attr("x")>this.width-u.width?{x:a,textAlign:"right"}:{x:a,textAlign:"center"}),l?[d,h]:[h,d]},e.prototype.startPlay=function(){var e=this;return"undefined"!=typeof window?window.requestAnimationFrame((function(){var t=e,n=t.ticks,i=t.width,r=e.currentSpeed,o=i/n.length/(1e3*(10-r)/60),s=e.adjustOffsetRange(o/e.width);e.updateStartEnd(s),e.updateUI(),e.isPlay&&(e.playHandler=e.startPlay())})):void 0},e.prototype.changePlayStatus=function(e){void 0===e&&(e=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit("timebarstartplay",null)):this.playHandler&&("undefined"!=typeof window&&window.cancelAnimationFrame(this.playHandler),e&&this.graph.emit("timebarendplay",null))},e.prototype.destory=function(){this.graph.off("valuechange");var e=this.group,t=e.find((function(e){return"minHandlerShape"===e.get("name")}));t&&(t.off("minHandlerShape-handler:mousedown"),t.off("minHandlerShape-handler:touchstart"),t.destroy());var n=e.find((function(e){return"maxHandlerShape"===e.get("name")}));n&&(n.off("maxHandlerShape-handler:mousedown"),n.off("maxHandlerShape-handler:touchstart"),n.destroy()),this.foregroundShape.off("mousedown"),this.foregroundShape.off("touchstart"),this.foregroundShape.destroy(),e.off("".concat("playPauseBtn",":click")),e.off("".concat("nextStepBtn",":click")),e.off("".concat("preStepBtn",":click")),e.off("timebarConfigChanged"),e.destroy(),this.trendComponent&&this.trendComponent.destory()},e}(),gV=function(){function e(e){var t=e.x,n=void 0===t?0:t,i=e.y,r=void 0===i?0:i,o=e.container,s=e.text,a=e.padding,l=void 0===a?[4,4,4,4]:a,c=e.className,u=void 0===c?"g6-component-timebar-tooltip":c,h=e.backgroundColor,d=void 0===h?"#000":h,f=e.textColor,g=void 0===f?"#fff":f,p=e.opacity,m=void 0===p?.8:p,v=e.fontSize,y=void 0===v?12:v;this.container=o,this.className=u,this.backgroundColor=d,this.textColor=g,this.x=n,this.y=r,this.text=s,this.padding=l,this.opacity=m,this.fontSize=y,this.render()}return e.prototype.render=function(){var e=this,t=e.className;e.x,e.y;var n=e.backgroundColor,i=e.textColor,r=e.text,o=e.padding,s=e.opacity,a=e.fontSize,l=e.container,c=hb("<div class='".concat(t,"' style=\"position: absolute; width: fit-content; height: fit-content; opacity: ").concat(s,'"></div>'));xr(l)&&(l=document.getElementById(l)),l.appendChild(c),e.parentHeight=l.offsetHeight,e.parentWidth=l.offsetWidth,db(c,{visibility:"hidden",top:0,left:0});var u=hb("\n      <div style='position: absolute; white-space:nowrap; background-color: ".concat(n,"; font-size: ").concat(a,"px; border-radius: 4px; width: fit-content; height: fit-content; color: ").concat(i,"; padding: ").concat(o[0],"px ").concat(o[1],"px ").concat(o[2],"px ").concat(o[3],"px'></div>"));u.innerHTML=r,c.appendChild(u),e.backgroundDOM=u;var h=hb("<div style='position: absolute; width: 0px; height: 0px; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid ".concat(n,"'></div>"));c.appendChild(h),e.arrowDOM=h,e.container=c},e.prototype.show=function(e){var t=this,n=e.text,i=e.x;e.y,e.clientX,e.clientY,t.backgroundDOM.innerHTML=n;var r=t.backgroundDOM.offsetWidth,o=t.backgroundDOM.offsetHeight,s=t.arrowDOM.offsetWidth,a=t.arrowDOM.offsetHeight;db(t.container,{top:"".concat(-o-a,"px"),left:"".concat(i,"px"),visibility:"visible"}),db(t.backgroundDOM,{marginLeft:"".concat(-r/2,"px")}),db(t.arrowDOM,{marginLeft:"".concat(-s/2,"px"),top:"".concat(o,"px")});var l=i-r/2,c=i+r/2;l<0?db(t.backgroundDOM,{marginLeft:"".concat(-r/2-l,"px")}):c>t.parentWidth&&db(t.backgroundDOM,{marginLeft:"".concat(-r/2-c+t.parentWidth+12,"px")})},e.prototype.hide=function(){db(this.container,{top:0,left:0,visibility:"hidden"})},e}(),pV=function(){return(pV=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},mV=Us,vV={fill:"#5B8FF9"},yV={fill:"#e6e8e9"},_V=function(){function e(e){this.frameCount=0,this.fontFamily="Arial, sans-serif";var t=e.graph,n=e.canvas,i=e.group,r=e.width,o=e.height,s=e.padding,a=e.data,l=e.start,c=e.end,u=e.x,h=void 0===u?0:u,d=e.y,f=void 0===d?0:d,g=e.tickLabelFormatter,p=e.selectedTickStyle,m=void 0===p?vV:p,v=e.unselectedTickStyle,y=void 0===v?yV:v,_=e.tooltipBackgroundColor,b=e.tooltipFomatter,w=e.tickLabelStyle;this.graph=t,this.group=i,this.sliceGroup=i.addGroup({name:"slice-group"}),this.canvas=n,this.width=r,this.height=o,this.padding=s,this.data=a,this.start=l,this.end=c,this.tickLabelFormatter=g,this.tickLabelStyle=w||{},this.selectedTickStyle=m,this.unselectedTickStyle=y,this.x=h,this.y=f,this.tooltipBackgroundColor=_,this.tooltipFomatter=b,this.fontFamily="undefined"!=typeof window&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlices(),this.initEvent()}return e.prototype.renderSlices=function(){var e=this,t=this,n=t.width,i=t.height,r=t.padding,o=t.data,s=t.start,a=t.end,l=t.tickLabelFormatter,c=t.selectedTickStyle,u=t.unselectedTickStyle,h=t.tickLabelStyle,d=n-2*r,f=i-(3*r+4+10)-2*r,g=o.length,p=(d-2*(g-1))/g;this.tickWidth=p;var m=this.sliceGroup,v=[],y=[],_=Math.round(g*s),b=Math.round(g*a);this.startTickRectId=_,this.endTickRectId=b;var w=h.rotate;delete h.rotate,o.forEach((function(t,i){var o=i>=_&&i<=b?c:u,s=m.addShape("rect",{attrs:pV({x:r+i*(p+2),y:r,width:p,height:f},o),draggable:!0,name:"tick-rect-".concat(i)}),a=m.addShape("rect",{attrs:{x:r+i*p+2*(2*i-1)/2,y:r,width:0===i||i===g-1?p+1:p+2,height:f,fill:"#fff",opacity:0},draggable:!0,name:"pick-rect-".concat(i)});a.toFront();var d,C=s.getBBox(),S=(C.minX+C.maxX)/2;if(v.push({rect:s,pickRect:a,value:t.date,x:S,y:C.minY}),l?(d=l(t),!xr(d)&&d&&(d=t.date)):i%Math.round(g/10)==0&&(d=t.date),d){y.push(d);var x=C.maxY+2*r;m.addShape("line",{attrs:{stroke:"#BFBFBF",x1:S,y1:x,x2:S,y2:x+4},name:"tick-line"});var E=x+4+r,k=m.addShape("text",{attrs:pV({fill:"#8c8c8c",stroke:"#fff",lineWidth:1,x:S,y:E,textAlign:"center",text:d,textBaseline:"top",fontSize:10,fontFamily:e.fontFamily||"Arial, sans-serif"},h),capture:!1,name:"tick-label"}),L=k.getBBox();if(L.maxX>n?k.attr("textAlign","right"):L.minX<0&&k.attr("textAlign","left"),Or(w)&&10!==y.length){var D=mV([1,0,0,0,1,0,0,0,1],[["t",-S,-E],["r",w],["t",S-5,E+2]]);k.attr({textAlign:"left",matrix:D})}1===y.length?k.attr({textAlign:"left"}):10===y.length&&k.attr({textAlign:"right"})}})),this.tickRects=v;var C=this.group;this.currentSpeed=1,this.controllerBtnGroup=new iV({group:C,x:this.x,y:this.y+i+5,width:n,height:40,hideTimeTypeController:!0,speed:this.currentSpeed,fontFamily:this.fontFamily||"Arial, sans-serif"})},e.prototype.initEvent=function(){var e=this,t=this.sliceGroup;t.on("click",(function(t){var n=t.target;if("rect"===n.get("type")&&n.get("name")){var i=parseInt(n.get("name").split("-")[2],10);if(!isNaN(i)){var r=e.tickRects,o=e.unselectedTickStyle;r.forEach((function(e){e.rect.attr(o)}));var s=e.selectedTickStyle;r[i].rect.attr(s),e.startTickRectId=i,e.endTickRectId=i;var a=i/r.length;e.graph.emit("valuechange",{value:[a,a]})}}})),t.on("dragstart",(function(t){var n=e.tickRects,i=e.unselectedTickStyle;n.forEach((function(e){e.rect.attr(i)}));var r=t.target,o=parseInt(r.get("name").split("-")[2],10),s=e.selectedTickStyle;n[o].rect.attr(s),e.startTickRectId=o;var a=o/n.length;e.graph.emit("valuechange",{value:[a,a]}),e.dragging=!0})),t.on("dragover",(function(t){if(e.dragging&&"rect"===t.target.get("type")){for(var n=parseInt(t.target.get("name").split("-")[2],10),i=e.startTickRectId,r=e.tickRects,o=e.selectedTickStyle,s=e.unselectedTickStyle,a=0;a<r.length;a++){var l=a>=i&&a<=n?o:s;r[a].rect.attr(l)}var c=r.length;e.endTickRectId=n;var u=i/c,h=n/c;e.graph.emit("valuechange",{value:[u,h]})}})),t.on("drop",(function(t){if(e.dragging&&(e.dragging=!1,"rect"===t.target.get("type"))){var n=e.startTickRectId,i=parseInt(t.target.get("name").split("-")[2],10);if(!(i<n)){var r=e.selectedTickStyle,o=e.tickRects;o[i].rect.attr(r),e.endTickRectId=i;var s=o.length,a=n/s,l=i/s;e.graph.emit("valuechange",{value:[a,l]})}}}));var n=this,i=n.tooltipBackgroundColor,r=n.tooltipFomatter,o=n.canvas,s=new gV({container:o.get("container"),backgroundColor:i}),a=this.tickRects;a.forEach((function(e){var t=e.pickRect;t.on("mouseenter",(function(e){var t=e.target;if("rect"===t.get("type")){var n=parseInt(t.get("name").split("-")[2],10),i=o.getClientByPoint(a[n].x,a[n].y);s.show({x:a[n].x,y:a[n].y,clientX:i.x,clientY:i.y,text:r?r(a[n].value):a[n].value})}})),t.on("mouseleave",(function(e){s.hide()}))}));var l=this.group;l.on("".concat("playPauseBtn",":click"),(function(){e.isPlay=!e.isPlay,e.changePlayStatus()})),l.on("".concat("nextStepBtn",":click"),(function(){e.updateStartEnd(1)})),l.on("".concat("preStepBtn",":click"),(function(){e.updateStartEnd(-1)})),l.on("timebarConfigChanged",(function(t){t.type;var n=t.speed;e.currentSpeed=n}))},e.prototype.changePlayStatus=function(e){void 0===e&&(e=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit("timebarstartplay",null)):this.playHandler&&("undefined"!=typeof window&&window.cancelAnimationFrame(this.playHandler),e&&this.graph.emit("timebarendplay",null))},e.prototype.startPlay=function(){var e=this;return"undefined"!=typeof window?window.requestAnimationFrame((function(){var t=e.currentSpeed;e.frameCount%(60/t)==0&&(e.frameCount=0,e.updateStartEnd(1)),e.frameCount++,e.isPlay&&(e.playHandler=e.startPlay())})):void 0},e.prototype.updateStartEnd=function(e){var t=this,n=this.tickRects,i=n.length,r=this.unselectedTickStyle,o=this.selectedTickStyle,s=t.endTickRectId;if(e>0?t.endTickRectId++:(n[t.endTickRectId].rect.attr(r),t.endTickRectId--),s!==t.startTickRectId)t.endTickRectId<t.startTickRectId&&(t.startTickRectId=t.endTickRectId);else{for(var a=t.startTickRectId;a<=t.endTickRectId-1;a++)n[a].rect.attr(r);t.startTickRectId=t.endTickRectId}if(n[t.endTickRectId]){n[t.endTickRectId].rect.attr(o);var l=t.startTickRectId/i,c=t.endTickRectId/i;this.graph.emit("valuechange",{value:[l,c]})}},e.prototype.destory=function(){this.graph.off("valuechange");var e=this.sliceGroup;e.off("click"),e.off("dragstart"),e.off("dragover"),e.off("drop"),this.tickRects.forEach((function(e){var t=e.pickRect;t.off("mouseenter"),t.off("mouseleave")})),this.tickRects.length=0,e.off("".concat("playPauseBtn",":click")),e.off("".concat("nextStepBtn",":click")),e.off("".concat("preStepBtn",":click")),e.off("timebarConfigChanged"),this.sliceGroup.destroy()},e}(),bV=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),wV=function(){return(wV=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},CV=function(e){function t(t){return e.call(this,t)||this}return bV(t,e),t.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-component-timebar",padding:10,type:"trend",trend:{data:[],isArea:!1,smooth:!0},controllerCfg:{speed:1,loop:!1},slider:{start:.1,end:.9,minText:"min",maxText:"max"},tick:{start:.1,end:.9,data:[]},textStyle:{},filterEdge:!1,filterItemTypes:["node"],containerCSS:{}}},t.prototype.initContainer=function(){var e,t,n=this.get("graph"),i=this._cfgs,r=i.width,o=i.height,s=this.get("className")||"g6-component-timebar",a=this.get("container"),l=this.get("graph").get("container");a?(xr(a)&&(a=document.getElementById(a)),e=a):db(e=hb("<div class='".concat(s,"'></div>")),{position:"relative"}),l.appendChild(e),this.set("timeBarContainer",e),t="SVG"===n.get("renderer")?new n_({container:e,width:r,height:o}):new py({container:e,width:r,height:o}),this.get("containerCSS")&&db(e,this.get("containerCSS")),this.set("canvas",t)},t.prototype.init=function(){this.initContainer();var e=this.get("canvas").addGroup({name:"timebar-group"});this.set("timeBarGroup",e),this.renderTrend(),this.initEvent();var t="undefined"!=typeof window&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif";this.set("fontFamily",t)},t.prototype.renderTrend=function(){var e=this,t=this._cfgs,n=t.width,i=t.x,r=t.y,o=t.padding,s=t.type,a=t.trend,l=t.slider,c=t.controllerCfg,u=t.textStyle,h=t.tick,d=t.backgroundStyle,f=t.foregroundStyle,g=a.data,p=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(a,["data"]),m=n-2*o,v="trend"===s?26:4,y=this.get("graph"),_=this.get("timeBarGroup"),b=this.get("canvas"),w=null;if("trend"===s||"simple"===s){var C=this.get("getValue");w=new fV(wV(wV({graph:y,canvas:b,group:_,type:s,x:i+o,y:"trend"===s?r+o:r+o+15,width:m,height:v,padding:o,backgroundStyle:d,foregroundStyle:f,trendCfg:wV(wV({},p),{data:g.map((function(e){return(null==C?void 0:C(e))||e.value}))})},l),{tick:{ticks:g,tickLabelFormatter:h.tickLabelFormatter,tickLabelStyle:h.tickLabelStyle,tickLineStyle:h.tickLineStyle},handlerStyle:wV(wV({},l.handlerStyle),{height:l.height||v}),controllerCfg:c,textStyle:u}))}else"tick"===s&&(w=new _V(wV({graph:y,canvas:b,group:_,x:i+o,y:r+o,width:n,height:42,padding:2},h)));var S=function t(){var n=e.get("timebar");n.draggingHandler=!1,n.isPlay&&(n.isPlay=!1,n.currentHandler=n.maxHandlerShape,n.changePlayStatus()),document.removeEventListener("mouseup",t)};b.on("mousedown",(function(e){"maxHandlerShape-handler"!==e.target.get("name")&&"minHandlerShape-handler"!==e.target.get("name")&&e.target!==w.foregroundShape||document.addEventListener("mouseup",S)})),this.set("timebar",w)},t.prototype.filterData=function(e){var t,n=e.value,i=null,r=this._cfgs.type;if("trend"===r||"simple"===r?i=this._cfgs.trend.data:"tick"===r&&(i=this._cfgs.tick.data),i&&0!==i.length){var o=this.get("rangeChange"),s=this.get("graph"),a=Math.round(i.length*n[0]),l=Math.round(i.length*n[1]);l=l>=i.length?i.length-1:l,a=a>=i.length?i.length-1:a;var c=null===(t=this._cfgs.tick)||void 0===t?void 0:t.tickLabelFormatter,u=c?c(i[a]):i[a].date,h=c?c(i[l]):i[l].date;if("tick"!==r)this.get("timebar").setText(u,h);if(o)o(s,u,h);else{(!this.cacheGraphData||this.cacheGraphData.nodes&&0===this.cacheGraphData.nodes.length)&&(this.cacheGraphData=s.get("data"));var d=this.get("filterItemTypes"),f=this.get("changeData"),g=this.get("getDate"),p=this.get("shouldIgnore"),m=i[a].date,v=i[l].date;if(f||void 0===f){var y=this.cacheGraphData.nodes,_=this.cacheGraphData.edges;if(d.includes("node")){var b=(y=y.filter((function(e){var t=+((null==g?void 0:g(e))||e.date);return t>=m&&t<=v||(null==p?void 0:p("node",e,{min:m,max:v}))}))).map((function(e){return e.id}));_&&(_=_.filter((function(e){return b.includes(e.source)&&b.includes(e.target)||(null==p?void 0:p("edge",e,{min:m,max:v}))})))}(this.get("filterEdge")||d.includes("edge"))&&(_=_.filter((function(e){var t=+((null==g?void 0:g(e))||e.date);return t>=m&&t<=v||(null==p?void 0:p("edge",e,{min:m,max:v}))}))),s.changeData({nodes:y,edges:_})}else d.includes("node")&&s.getNodes().forEach((function(e){var t=e.getModel();if(!(null==p?void 0:p("node",t,{min:m,max:v}))){var n=+((null==g?void 0:g(t))||t.date);n<m||n>v?s.hideItem(e):s.showItem(e)}})),(this.get("filterEdge")||d.includes("edge"))&&s.getEdges().forEach((function(e){var t=e.getModel();if(!(null==p?void 0:p("edge",t,{min:i[a].date,max:i[l].date}))){var n=+((null==g?void 0:g(t))||t.date);n<i[a].date||n>i[l].date?s.hideItem(e):s.showItem(e)}}))}}else console.warn("请配置 TimeBar 组件的数据")},t.prototype.initEvent=function(){var e=this,t=0,n=0,i=this._cfgs.type;i&&"trend"!==i&&"simple"!==i?"tick"===i&&(t=this._cfgs.tick.start,n=this._cfgs.tick.end):(t=this._cfgs.slider.start,n=this._cfgs.slider.end);var r=this.get("graph");r.on("afterrender",(function(i){e.filterData({value:[t,n]})})),r.on("valuechange",vo((function(t){e.filterData(t)}),200,{trailing:!0,leading:!0}))},t.prototype.destroy=function(){var t=this.get("timebar");t&&t.destory&&t.destory(),e.prototype.destroy.call(this);var n=this.get("timeBarContainer");if(n){var i=this.get("container");i||(i=this.get("graph").get("container")),xr(i)&&(i=document.getElementById(i)),i.removeChild(n)}},t}(FB),SV=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),xV=pg.applyMatrix;var EV=function(e){function t(t){return e.call(this,t)||this}return SV(t,e),t.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",width:200,delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0}},t.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},t.prototype.disableRefresh=function(){this.set("refresh",!1)},t.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},t.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},t.prototype.initViewport=function(){var e=this,t=this._cfgs,n=t.graph;if(!this.destroyed){var i=this.get("container");xr(i)&&(i=document.getElementById(i));var r=hb("<div class=".concat(t.viewportClassName,"\n      style='position:absolute;\n        left:0;\n        top:0;\n        box-sizing:border-box;\n        border: 2px solid #1980ff'>\n      </div>")),o=0,s=0,a=!1,l=0,c=0,u=0,h=0,d=0,f=0;i.addEventListener("mousedown",(function(i){if(t.refresh=!1,i.target===r){var l=r.style;u=parseInt(l.width,10),h=parseInt(l.height,10);var c=e.get("width"),g=e.get("height");u>c||h>g||(f=n.getZoom(),d=e.get("ratio"),a=!0,o=i.clientX,s=i.clientY)}}),!1),i.addEventListener("mousemove",(function(t){if(a&&!sr(t.clientX)&&!sr(t.clientY)){var i=e.get("width"),g=e.get("height"),p=r.style;l=parseInt(p.left,10),c=parseInt(p.top,10),u=parseInt(p.width,10),h=parseInt(p.height,10);var m=o-t.clientX,v=s-t.clientY;l-m<0?m=l:l-m+u>=i&&(m=0),c-v<0?v=c:c-v+h>=g&&(v=0),c-=v,db(r,{left:"".concat(l-=m,"px"),top:"".concat(c,"px")}),n.translate(m*f/d,v*f/d),o=t.clientX,s=t.clientY}}),!1),i.addEventListener("mouseleave",(function(){a=!1,t.refresh=!0}),!1),i.addEventListener("mouseup",(function(){a=!1,t.refresh=!0}),!1),this.set("viewport",r),i.appendChild(r)}},t.prototype.updateViewport=function(){if(!this.destroyed){var e=this.get("ratio"),t=this.get("width"),n=this.get("height"),i=this.get("graph"),r=i.get("width"),o=r/i.get("height"),s=i.getGroup(),a=s.getCanvasBBox(),l=[(a.minX+a.maxX)/2,(a.minY+a.maxY)/2],c=[a.maxX-a.minX,a.maxY-a.minY],u={centerX:l[0],centerY:l[1],width:0,height:0,minX:0,minY:0};a[0]/a[1]>o?(u.width=c[0],u.height=u.width/o):(u.height=c[1],u.width=u.height*o),u.minX=l[0]-u.width/2,u.minY=l[1]-u.height/2;var h=s.getMatrix();h||(h=[1,0,0,0,1,0,0,0,1]);var d=Mo([1,0,0,0,1,0,0,0,1],h),f=xV({x:u.minX,y:u.minY},d),g=i.getCanvasByPoint(f.x,f.y),p=this.get("viewport");p||this.initViewport();var m=r/u.width,v=m*t,y=m*n,_=t*-g.x/u.width,b=n*-g.y/u.height,w=_+v,C=b+y;_<0&&(v+=_,_=0),w>t&&(v-=w-t),b<0&&(y+=b,b=0),C>n&&(y-=C-n),this.set("ratio",e),db(p,{left:"".concat(_,"px"),top:"".concat(b,"px"),width:"".concat(v,"px"),height:"".concat(y,"px")})}},t.prototype.init=function(){this.initContainer()},t.prototype.initContainer=function(){var e=this,t=e.get("graph"),n=t.get("width"),i=t.get("height")/n,r=e.get("className"),o=e.get("container"),s=e.get("width"),a=e.get("height");s||a||(s=200),s?(a=i*s,e.set("height",a)):(s=1/i*a,e.set("width",s));var l=hb("<div class='".concat(r,"' style='width: ").concat(s,"px; height: ").concat(a,"px; overflow: hidden; position: relative;'></div>"));xr(o)&&(o=document.getElementById(o)),o?o.appendChild(l):t.get("container").appendChild(l),e.set("container",l);var c=hb('<div class="g6-minimap-container" style="position: relative; width: 100%; height: 100%; text-align: center; display: table;"></div>');l.appendChild(c);var u=hb('<span style="display: table-cell; vertical-align: middle; "></span>');c.appendChild(u),e.set("containerDOM",c),e.set("containerSpan",u);var h=hb('<img alt="" src="'.concat(this.get("graphImg"),'" style="display: inline-block; user-select: none;" draggable="false" />'));e.set("imgDOM",h),e.updateImgSize(),u.appendChild(h),e.updateCanvas()},t.prototype.updateImgSize=function(){var e=this,t=e.get("imgDOM"),n=e.get("width"),i=e.get("height");t.onload=function(){var e=function(e,t){var n,i;if(e.naturalWidth)n=e.naturalWidth,i=e.naturalHeight;else{var r=new Image;r.src=e.src,r.onload=function(){t&&t(r.width,r.height)}}return[n,i]}(t);e[0]>e[1]?t.width=n:t.height=i}},t.prototype.updateCanvas=function(){if(this.get("refresh")){var e=this.get("graph");if(!e.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var t=this.get("width")/e.get("canvas").getCanvasBBox().width;this.set("ratio",t),this.updateViewport()}}},t.prototype.getViewport=function(){return this.get("viewport")},t.prototype.getContainer=function(){return this.get("container")},t.prototype.updateGraphImg=function(e){var t=this;t.get("imgDOM").remove(),t.set("graphImg",e);var n=hb('<img alt="" src="'.concat(e,'" style="display: inline-block;" ondragstart="return false;" onselectstart="return false;"/>'));t.set("imgDOM",n),n.src=e,t.updateImgSize(),t.get("containerSpan").appendChild(n),t.updateCanvas()},t.prototype.destroy=function(){var e=this.get("container");e.parentNode.removeChild(e)},t}(FB),kV=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),LV=function(){return(LV=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},DV=pg.distance,NV={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:1,fill:"#fff"},IV=function(e){function t(t){return e.call(this,t)||this}return kV(t,e),t.prototype.getDefaultCfgs=function(){return{type:"both",trigger:"mousemove",r:60,delegateStyle:no(NV),showLabel:"edge",scaleRBy:"wheel"}},t.prototype.getEvents=function(){var e;switch(this.get("trigger")){case"click":e={click:"filter"};break;case"drag":e={click:"createDelegate"};break;default:e={mousemove:"filter"}}return e},t.prototype.init=function(){var e=this,t=e.get("showLabel"),n="node"===t||"both"===t,i="edge"===t||"both"===t;e.set("showNodeLabel",n),e.set("showEdgeLabel",i),e.get("shouldShow")||e.set("shouldShow",(function(){return!0}))},t.prototype.createDelegate=function(e){var t=this,n=t.get("delegate");n&&!n.destroyed||(t.filter(e),(n=t.get("delegate")).on("dragstart",(function(e){})),n.on("drag",(function(e){t.filter(e)})),"wheel"===this.get("scaleRBy")&&n.on("mousewheel",(function(e){t.scaleRByWheel(e)})))},t.prototype.scaleRByWheel=function(e){var t=this;if(e&&e.originalEvent){e.preventDefault&&e.preventDefault();var n,i=t.get("graph"),r=t.get("delegate");(r?{x:r.attr("x"),y:r.attr("y")}:void 0)||i.getPointByClient(e.clientX,e.clientY),n=e.originalEvent.wheelDelta<0?.95:1/.95;var o=t.get("maxR"),s=t.get("minR"),a=t.get("r");(a>(o||i.get("height"))&&n>1||a<(s||.05*i.get("height"))&&n<1)&&(n=1),a*=n,t.set("r",a),t.filter(e)}},t.prototype.filter=function(e){var t=this,n=t.get("graph"),i=n.getNodes(),r={},o=t.get("r"),s=t.get("type"),a={x:e.x,y:e.y};t.updateDelegate(a,o);var l=t.get("shouldShow"),c=t.get("vShapes");c&&c.forEach((function(e){e.remove(),e.destroy()})),c=[],i.forEach((function(e){var t=e.getModel(),n=t.x,i=t.y;DV({x:n,y:i},a)<o&&(r[t.id]=e)}));var u=n.getEdges(),h=[];u.forEach((function(e){var t=e.getModel(),n=t.source,i=t.target;l(t)&&("only-source"===s||"one"===s?r[n]&&!r[i]&&h.push(e):"only-target"===s||"one"===s?r[i]&&!r[n]&&h.push(e):"both"===s&&r[n]&&r[i]&&h.push(e))}));var d=t.get("showNodeLabel"),f=t.get("showEdgelabel"),g=n.get("group");h.forEach((function(e){e.get("group").get("children").forEach((function(e){var t=e.get("type"),n=g.addShape(t,{attrs:e.attr()});c.push(n),d&&"text"===t&&n.set("visible",!0)}))})),Object.keys(r).forEach((function(e){var t=r[e].get("group").clone();if(g.add(t),c.push(t),f)for(var n=t.get("children"),i=0;i<n.length;i++){var o=n[i];"text"===o.get("type")&&o.set("visible",!0)}})),t.set("vShapes",c)},t.prototype.updateParams=function(e){var t=this,n=e.r,i=e.trigger,r=e.minR,o=e.maxR,s=e.scaleRBy,a=e.showLabel,l=e.shouldShow;if(isNaN(e.r)||t.set("r",n),isNaN(o)||t.set("maxR",o),isNaN(r)||t.set("minR",r),"mousemove"!==i&&"click"!==i||t.set("trigger",i),"wheel"===s||"unset"===s){t.set("scaleRBy",s),t.get("delegate").remove(),t.get("delegate").destroy();var c=t.get("dPercentText");c&&(c.remove(),c.destroy())}"node"!==a&&"both"!==a||t.set("showNodeLabel",!0),"edge"!==a&&"both"!==a||t.set("showEdgeLabel",!0),l&&t.set("shouldShow",l)},t.prototype.updateDelegate=function(e,t){var n=this,i=n.get("graph"),r=n.get("delegate");if(!r||r.destroyed){var o=i.get("group"),s=n.get("delegateStyle")||NV;r=o.addShape("circle",{attrs:LV({r:t,x:e.x,y:e.y},s),name:"lens-shape",draggable:!0}),"drag"!==this.get("trigger")&&"wheel"===this.get("scaleRBy")&&r.on("mousewheel",(function(e){n.scaleRByWheel(e)}))}else r.attr({x:e.x,y:e.y,r:t});n.set("delegate",r)},t.prototype.clear=function(){var e=this,t=e.get("vShapes");t&&t.forEach((function(e){e.remove(),e.destroy()})),t=[],e.set("vShapes",t);var n=e.get("delegate");n&&!n.destroyed&&(n.remove(),n.destroy())},t.prototype.destroy=function(){this.clear()},t}(FB),TV=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),MV=pg.pointLineDistance,AV={stroke:"#FA8C16",lineWidth:1},OV=function(e){function t(t){return e.call(this,t)||this}return TV(t,e),t.prototype.getDefaultCfgs=function(){return{line:AV,itemAlignType:"center",tolerance:5,horizontalLines:{},verticalLines:{},alignLines:[]}},t.prototype.init=function(){},t.prototype.getEvents=function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd"}},t.prototype.onDragStart=function(){this.initBoxLine()},t.prototype.onDrag=function(e){var t=e.item,n=(t.get("delegateShape")||t).getBBox(),i=t.getModel(),r=i.x-n.x,o=i.y-n.y;this.show({x:n.minX+r,y:n.minY+o},{width:n.width,height:n.height})},t.prototype.onDragEnd=function(){this.destory()},t.prototype.initBoxLine=function(){var e=this._cfgs,t=e.horizontalLines,n=e.verticalLines,i=e.itemAlignType;this.get("graph").getNodes().forEach((function(e){var r=e.getBBox(),o=e.get("id");!0===i||"horizontal"===i?(t["".concat(o,"tltr")]=[r.minX,r.minY,r.maxX,r.minY,e],t["".concat(o,"lcrc")]=[r.minX,r.centerY,r.maxX,r.centerY,e],t["".concat(o,"blbr")]=[r.minX,r.maxY,r.maxX,r.maxY,e]):"center"===i&&(t["".concat(o,"lcrc")]=[r.minX,r.centerY,r.maxX,r.centerY,e]),!0===i||"vertical"===i?(n["".concat(o,"tlbl")]=[r.minX,r.minY,r.minX,r.maxY,e],n["".concat(o,"tcbc")]=[r.centerX,r.minY,r.centerX,r.maxY,e],n["".concat(o,"trbr")]=[r.maxX,r.minY,r.maxX,r.maxY,e]):"center"===i&&(n["".concat(o,"tcbc")]=[r.centerX,r.minY,r.centerX,r.maxY,e])}))},t.prototype.show=function(e,t){var n=to({},e);return this.itemAlign(e,t,n),e},t.prototype.itemAlign=function(e,t,n){var i=this,r=this._cfgs,o=r.horizontalLines,s=r.verticalLines,a=r.tolerance,l={x:n.x+t.width/2,y:n.y},c={x:n.x+t.width/2,y:n.y+t.height/2},u={x:n.x+t.width/2,y:n.y+t.height},h={x:n.x,y:n.y+t.height/2},d={x:n.x+t.width,y:n.y+t.height/2},f=[],g=[],p=null;if(this.clearAlignLine(),cr(o,(function(e){e[4].isVisible&&(f.push(i.getLineDisObject(e,l)),f.push(i.getLineDisObject(e,c)),f.push(i.getLineDisObject(e,u)))})),cr(s,(function(e){e[4].isVisible&&(g.push(i.getLineDisObject(e,h)),g.push(i.getLineDisObject(e,c)),g.push(i.getLineDisObject(e,d)))})),f.sort((function(e,t){return e.dis-t.dis})),g.sort((function(e,t){return e.dis-t.dis})),0!==f.length&&f[0].dis<a){e.y=f[0].line[1]-f[0].point.y+n.y,p={type:"item",horizontals:[f[0]]};for(var m=1;m<3;m++)f[0].dis===f[m].dis&&p.horizontals.push(f[m])}if(0!==g.length&&g[0].dis<a){e.x=g[0].line[0]-g[0].point.x+n.x,p?p.verticals=[g[0]]:p={type:"item",verticals:[g[0]]};for(m=1;m<3;m++)g[0].dis===g[m].dis&&p.verticals.push(g[m])}p&&(p.bbox=t,this.addAlignLine(p))},t.prototype.addAlignLine=function(e){var t=e.bbox,n=e.type,i=e.horizontals,r=e.verticals,o=this._cfgs,s=o.line,a=o.alignLines,l=this.get("graph").get("group");"item"===n&&(i&&cr(i,(function(e){var n,i,r=e.line,o=e.point,c=(r[0]+r[2])/2;o.x<c?(n=o.x-t.width/2,i=Math.max(r[0],r[2])):(n=o.x+t.width/2,i=Math.min(r[0],r[2]));var u=to({x1:n,y1:r[1],x2:i,y2:r[1]},s),h=l.addShape("line",{attrs:u,capture:!1});a.push(h)})),r&&cr(r,(function(e){var n,i,r=e.line,o=e.point,c=(r[1]+r[3])/2;o.y<c?(n=o.y-t.height/2,i=Math.max(r[1],r[3])):(n=o.y+t.height/2,i=Math.min(r[1],r[3]));var u=to({x1:r[0],y1:n,x2:r[0],y2:i},s),h=l.addShape("line",{attrs:u,capture:!1});a.push(h)})))},t.prototype.getLineDisObject=function(e,t){return{line:e,point:t,dis:MV(e,t)}},t.prototype.getContainer=function(){return this.get("container")},t.prototype.clearAlignLine=function(){var e=this._cfgs.alignLines;cr(e,(function(e){e.remove()})),e.length=0},t.prototype.destory=function(){var e=this._cfgs,t=e.horizontalLines,n=e.verticalLines;this.get("graph").getNodes().forEach((function(e){var i=e.get("id");delete t["".concat(i,"tltr")],delete t["".concat(i,"lcrc")],delete t["".concat(i,"blbr")],delete n["".concat(i,"tlbl")],delete n["".concat(i,"tcbc")],delete n["".concat(i,"trbr")]})),this.clearAlignLine()},t}(FB),RV=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),PV=function(){return(PV=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},FV=["click","mouseenter"],BV={PluginBase:FB,Menu:qB,Grid:zB,Minimap:QB,Bundling:nW,ToolBar:lW,Tooltip:uW,Fisheye:sW,TimeBar:CV,ImageMinimap:EV,EdgeFilterLens:IV,SnapLine:OV,Legend:function(e){function t(t){return e.call(this,t)||this}return RV(t,e),t.prototype.getDefaultCfgs=function(){return{data:{},position:"top",padding:8,margin:8,offsetX:0,offsetY:0,layout:"horizontal",flipPage:!1,containerStyle:{},align:void 0,horiSep:8,vertiSep:8,filter:{enable:!1,trigger:"click"}}},t.prototype.init=function(){this.formatArray("padding"),this.formatArray("margin");var e=this.get("filter")||{};e.multiple&&"mouseenter"===e.trigger&&this.set("multiple",!1);var t=this.get("align");if(!t){var n=this.get("position").split("-");n.includes("left")&&(t="left"),t=n.includes("right")?"right":"center",this.set("align",t)}var i=this.get("graph").get("container"),r=hb("<div class='g6-legend-container' style=\"position: absolute;\"></div>");i.appendChild(r),this.set("container",r);var o=this.render();db(r,this.getContainerPos(o)),this.bindEvents()},t.prototype.getContainerPos=function(e){void 0===e&&(e=[0,0]);var t=this.get("graph"),n=this.get("offsetX"),i=this.get("offsetY"),r=this.get("margin"),o=this.get("position").split("-"),s={top:0,right:1,bottom:2,left:3},a={left:(t.getWidth()-e[0])/2+0,top:(t.getHeight()-e[1])/2+0};return o.forEach((function(n){var i=r[s[n]],o=n;switch(n){case"top":case"left":i+=0;break;case"bottom":i=t.getHeight()-e[1]-i+0,o="top";break;default:i=t.getWidth()-e[0]-i+0,o="left"}a[o]=i})),a.top+=i+t.getContainer().offsetTop,a.left+=n+t.getContainer().offsetLeft,Object.keys(a).forEach((function(e){a[e]="".concat(a[e],"px")})),a},t.prototype.bindEvents=function(){var e=this,t=e.get("filter");if(t&&t.enable){var n=t.trigger||"click";FV.includes(n)||(console.warn("Trigger for legend filterling must be 'click' or 'mouseenter', 'click' will take effect by default."),n="click");var i=e.get("legendCanvas");"mouseenter"===n?(i.on("node-container:mouseenter",(function(t){return e.filterData(t)})),i.on("node-container:mouseleave",(function(t){e.clearFilter(),e.clearActiveLegend()}))):(i.on("node-container:click",(function(t){return e.filterData(t)})),i.on("click",(function(t){t.target&&t.target.isCanvas&&t.target.isCanvas()&&(e.clearFilter(),e.clearActiveLegend())})))}},t.prototype.changeData=function(e){this.set("data",e);var t=this.render();db(this.get("container"),this.getContainerPos(t))},t.prototype.activateLegend=function(e){var t=this.get("filter");(null==t?void 0:t.multiple)||this.clearActiveLegend();var n=e.get("parent");n.get("active")?(n.set("active",!1),this.findLegendItemsByState("active").length&&n.set("inactive",!0)):(n.set("inactive",!1),n.set("active",!0)),this.findLegendItemsByState("active").length?this.findLegendItemsByState("active","all",!1).forEach((function(e){e.set("inactive",!0)})):this.clearActiveLegend();var i=(null==t?void 0:t.lengedStateStyles)||{},r=(null==i?void 0:i.inactive)||{opacity:.5,"text-shape":{opacity:.5}},o=r["text-shape"]||{};this.findLegendItemsByState("inactive").forEach((function(e){var t=e.get("children"),n=t[0],i=t[1];n.attr(PV(PV({},n.get("oriAttrs")),r)),i.attr(PV(PV({},i.get("oriAttrs")),o))}));var s=(null==i?void 0:i.active)||{stroke:"#000",lineWidth:2,"text-shape":{fontWeight:"bold"}},a=s["text-shape"]||{};this.findLegendItemsByState("active").forEach((function(e){var t=e.get("children"),n=t[0],i=t[1];n.attr(PV(PV({},n.get("oriAttrs")),s)),i.attr(PV(PV({},i.get("oriAttrs")),a))}))},t.prototype.findLegendItemsByState=function(e,t,n){void 0===t&&(t="all"),void 0===n&&(n=!0);var i=this.get("legendCanvas").find((function(e){return"root"===e.get("name")})),r=i.find((function(e){return"node-group"===e.get("name")})),o=i.find((function(e){return"edge-group"===e.get("name")}));return"node"===t?r.get("children").filter((function(t){return!!t.get(e)===n})):"edge"===t?o.get("children").filter((function(t){return!!t.get(e)===n})):r.get("children").filter((function(t){return!!t.get(e)===n})).concat(o.get("children").filter((function(t){return!!t.get(e)===n})))},t.prototype.clearActiveLegend=function(){var e=this.get("legendCanvas").find((function(e){return"root"===e.get("name")}));[e.find((function(e){return"node-group"===e.get("name")})),e.find((function(e){return"edge-group"===e.get("name")}))].forEach((function(e){e.get("children").forEach((function(e){e.set("active",!1),e.set("inactive",!1);var t=e.get("children"),n=t[0],i=t[1];n.attr(n.get("oriAttrs")),i.attr(i.get("oriAttrs"))}))}))},t.prototype.filterData=function(e){var t=this.get("filter"),n=null==t?void 0:t.filterFunctions;if(t&&n){var i=this.get("legendCanvas"),r=this.get("graph"),o=t.graphActiveState||"active",s=t.graphInactiveState||"inactive",a=t.multiple;this.clearFilter(),a||this.clearActiveLegend(),this.activateLegend(e.target);var l=i.find((function(e){return"root"===e.get("name")})),c=l.find((function(e){return"node-group"===e.get("name")})),u=l.find((function(e){return"edge-group"===e.get("name")})),h=c.get("children").filter((function(e){return e.get("active")})),d=u.get("children").filter((function(e){return e.get("active")})),f=0,g=["getNodes","getEdges"];g.forEach((function(e){r[e]().forEach((function(t){var i=!1;("getNodes"===e?h:d).forEach((function(e){var r=n[e.get("id")];i=i||r(t.getModel())})),i?(r.setItemState(t,s,!1),r.setItemState(t,o,!0),f++):(r.setItemState(t,o,!1),r.setItemState(t,s,!0))}))})),f||g.forEach((function(e){r[e]().forEach((function(e){r.clearItemStates(e,[s])}))}))}},t.prototype.clearFilter=function(){var e=this.get("graph"),t=this.get("filter");if(t){var n=t.graphActiveState||"active",i=t.graphInactiveState||"inactive";e.getNodes().forEach((function(t){e.clearItemStates(t,[n,i])})),e.getEdges().forEach((function(t){e.clearItemStates(t,[n,i])}))}},t.prototype.render=function(){var e=this;this.processData();var t=this.get("legendCanvas");if(!t){var n=(t=new py({container:this.get("container"),width:200,height:200})).addGroup({name:"root"});n.addGroup({name:"node-group"}),n.addGroup({name:"edge-group"}),this.set("legendCanvas",t)}var i=t.find((function(e){return"root"===e.get("name")})),r=i.find((function(e){return"node-group"===e.get("name")})),o=i.find((function(e){return"edge-group"===e.get("name")})),s=this.get("itemsData"),a=[r,o];["nodes","edges"].forEach((function(t,n){s[t].forEach((function(i){var r,o,s=a[n].addGroup({id:i.id,name:"node-container"}),l=i.type,c=e.getShapeSize(i),u=c.width,h=c.height,d=c.r,f=e.getStyle(t.substr(0,4),i);switch(i.type){case"circle":o={r:d,x:0,y:0};break;case"rect":o={width:u,height:h,x:-u/2,y:-h/2};break;case"ellipse":o={r1:u,r2:h,x:0,y:0};break;case"line":o={x1:-u/2,y1:0,x2:u/2,y2:0},l="line";break;case"quadratic":o={path:[["M",-u/2,0],["Q",0,u/2,u/2,0]]},l="path";break;case"cubic":o={path:[["M",-u/2,0],["C",-u/6,u/2,u/6,-u/2,u/2,0]]},l="path";break;default:o={r:d,x:0,y:0}}var g=s.addShape(l,{attrs:PV(PV({},o),f),name:"".concat(i.type,"-node-keyShape"),oriAttrs:PV({opacity:1},f)});if(i.label){var p=g.getBBox(),m=(null===(r=i.labelCfg)||void 0===r?void 0:r.style)||{},v=PV({textAlign:"begin",fontSize:12,textBaseline:"middle",fill:"#000",opacity:1,fontWeight:"normal"},m);s.addShape("text",{attrs:PV({x:p.maxX+4,y:0,text:i.label},v),className:"legend-label",name:"".concat(i.type,"-node-text"),oriAttrs:v})}}))}));var l,c=this.get("padding"),u=i.find((function(e){return"title-container"===e.get("name")})),h={height:0,maxY:0,width:0};if(this.get("title")){u||(u=i.addGroup({name:"title-container"}));var d={fontSize:20,fontFamily:"Arial",fontWeight:300,textBaseline:"top",textAlign:"center",fill:"#000",x:0,y:c[0]},f=this.get("titleConfig")||{},g=Object.assign(d,f.style||{});l=u.addShape("text",{attrs:PV({text:this.get("title")},g)}),h=u.getCanvasBBox(),u.setMatrix([1,0,0,0,1,0,f.offsetX,f.offsetY,1])}this.layoutItems();var p=i.getCanvasBBox(),m=r.getCanvasBBox(),v=m.minX<0?Math.abs(m.minX)+c[3]:c[3],y=h.maxY<m.minY?Math.abs(h.maxY-m.minY)+c[0]:h.maxY+c[0],_=[1,0,0,0,1,0,v,y,1];r.setMatrix(_);var b=[(p=i.getCanvasBBox()).minX+p.width+c[1],p.minY+p.height+c[2]];if(l){f=PV({position:"center",offsetX:0,offsetY:0},this.get("titleConfig"));h=u.getCanvasBBox();var w=u.getMatrix()||[1,0,0,0,1,0,0,0,1];"center"===f.position?w[6]=b[0]/2+f.offsetX:"right"===f.position?(w[6]=b[0]-c[3]+f.offsetX,l.attr({textAlign:"right"})):(w[6]=c[3]+f.offsetX,l.attr({textAlign:"left"})),u.setMatrix(w),h=u.getCanvasBBox(),_=[1,0,0,0,1,0,v=m.minX<0?Math.abs(m.minX)+c[3]:c[3],y=m.minY<h.maxY?Math.abs(h.maxY-m.minY)+c[0]:h.maxY+c[0],1],r.setMatrix(_);var C=[1,0,0,0,1,0,v,y,1];"vertical"===this.get("layout")?C[6]+=m.maxX+this.get("horiSep"):C[7]+=m.maxY+this.get("vertiSep"),o.setMatrix(C)}else{m=r.getCanvasBBox();var S=[1,0,0,0,1,0,0,0,1];"vertical"===this.get("layout")?S[6]+=_[6]+m.maxX+this.get("horiSep"):S[7]+=_[7]+m.maxY+this.get("vertiSep"),o.setMatrix(S)}p=i.getCanvasBBox(),m=r.getCanvasBBox(),_=r.getMatrix()||[1,0,0,0,1,0,0,0,1];var x=o.getMatrix()||[1,0,0,0,1,0,0,0,1],E=o.getCanvasBBox();b=[Math.max(m.width+_[6],E.width+x[6])+c[1],Math.max(m.height+_[7],E.height+x[7])+c[2]],t.changeSize(b[0],b[1]);var k=this.get("containerStyle"),L=i.getMatrix()||[1,0,0,0,1,0,0,0,1],D=pg.invertMatrix({x:0,y:0},L);return i.addShape("rect",{attrs:PV({x:D.x+(k.lineWidth||1),y:D.y+(k.lineWidth||1),width:b[0]-2*(k.lineWidth||1),height:b[1]-2*(k.lineWidth||1),fill:"#f00",stroke:"#000",lineWidth:1,opacity:.5},k),name:"legend-back-rect",capture:!1}).toBack(),b},t.prototype.layoutItems=function(){var e=this.get("legendCanvas"),t=this.get("horiSep"),n=this.get("vertiSep"),i=this.get("layout"),r=this.get("align"),o=[0,0],s=e.find((function(e){return"root"===e.get("name")})),a=s.find((function(e){return"node-group"===e.get("name")})),l=s.find((function(e){return"edge-group"===e.get("name")})),c={min:0,max:-1/0};a.get("children").forEach((function(e,r){0===r&&(c.min=o[0]);var s=e.get("children")[0],a=e.getCanvasBBox(),l=s.getBBox(),u=l.width,h=(l.height,0),d=0;"vertical"===i?(h=o[1],d=o[0]+u/2,o[0]=d+a.height+n,a.maxX):(h=o[0]+u/2,d=o[1],o[0]=h+a.width+t,a.maxY),o[0]>c.max&&(c.max=o[0]),e.setMatrix([1,0,0,0,1,0,h,d,1])}));var u=c.max-c.min,h={min:0,max:-1/0},d=a.getCanvasBBox();o[0]=0,o[1]="vertical"===i?d.maxX+t:d.maxY+n,l.get("children").forEach((function(e,r){0===r&&(h.min=o[0]);var s=e.get("children")[0],a=e.getCanvasBBox(),l=s.getBBox(),c=l.width,u=l.height,d=0,f=0;"vertical"===i?(d=o[1],f=o[0],o[0]=f+a.height+n,e.setMatrix([1,0,0,0,1,0,0,f+u/2,1])):(d=o[0],f=o[1],o[0]=d+a.width+t,e.setMatrix([1,0,0,0,1,0,d+c/2,0,1])),o[0]>h.max&&(h.max=o[0])}));var f=h.max-h.min;if(r&&""!==r&&"left"!==r){var g=u-f,p="center"===r?Math.abs(g)/2:Math.abs(g);(g<0?a:l).get("children").forEach((function(e){var t=e.getMatrix()||[1,0,0,0,1,0,0,0,1];"vertical"===i?t[7]+=p:t[6]+=p,e.setMatrix(t)}))}},t.prototype.processData=function(){var e=this.get("data"),t={nodes:[],edges:[]};e.nodes&&(e.nodes.sort((function(e,t){return e.order-t.order})),e.nodes.forEach((function(e){var n,i,r,o,s,a=e.size||[(null===(n=e.style)||void 0===n?void 0:n.width)||(null===(i=e.style)||void 0===i?void 0:i.r)||8,(null===(r=e.style)||void 0===r?void 0:r.height)||(null===(o=e.style)||void 0===o?void 0:o.r)||8],l=(null===(s=e.labelCfg)||void 0===s?void 0:s.style)||{};t.nodes.push({id:e.id||bo(),type:e.type||"circle",style:PV({},e.style),order:e.order,label:e.label,itemType:"node",size:a,labelCfg:{position:"right",style:PV({fontFamily:"Arial"},l)}})}))),e.edges&&(e.edges.sort((function(e,t){return e.order-t.order})),e.edges.forEach((function(e){var n,i,r=e.type||"line";"cubic-horizontal"===e.type&&(r="cubic");var o=(null===(n=e.labelCfg)||void 0===n?void 0:n.style)||{},s=e.size||[(null===(i=e.style)||void 0===i?void 0:i.width)||8,1];t.edges.push({id:e.id||bo(),type:r,size:s,style:PV({lineWidth:ar(s)?s[1]:1},e.style),order:e.order,label:e.label,itemType:"edge",labelCfg:{position:"right",style:PV({fontFamily:"Arial"},o)}})}))),this.set("itemsData",t)},t.prototype.getContainer=function(){return this.get("container")},t.prototype.formatArray=function(e){var t=this.get(e);if(Or(t))this.set(e,[t,t,t,t]);else if(ar(t))switch(t.length){case 0:this.set(e,[0,0,0,0]);break;case 1:this.set(e,[t[0],t[0],t[0],t[0]]);break;case 2:this.set(e,[t[0],t[1],t[0],t[1]]);break;case 3:this.set(e,[t[0],t[1],t[2],t[1]])}return this.get(e)},t.prototype.getShapeSize=function(e){var t,n,i;return e.size&&(ar(e.size)?(t=e.size[0],n=e.size[1]||e.size[0],i=e.size[0]/2):Or(e.size)&&(t=e.size,n=e.size,i=e.size/2)),e.style&&(e.style.width&&(t=e.style.width),e.style.height&&(n=e.style.height),e.style.r&&(i=e.style.r)),i||(i=5),t||(t=i),n||(n=i),{width:t,height:n,r:i}},t.prototype.getStyle=function(e,t){return PV(PV({},"node"===e?{fill:"#ccc",lineWidth:0}:{stroke:"#000",lineWidth:1}),t.style||{})},t.prototype.destroy=function(){var e=this.get("graph").get("container"),t=this.get("container");e.removeChild(t)},t}(FB)};yg("circle",{options:{size:Cg.defaultNode.size,style:{x:0,y:0,stroke:Cg.defaultNode.style.stroke,fill:Cg.defaultNode.style.fill,lineWidth:Cg.defaultNode.style.lineWidth},labelCfg:{style:{fill:Cg.nodeLabel.style.fill,fontSize:Cg.nodeLabel.style.fontSize,fontFamily:Cg.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Cg.defaultNode.linkPoints.size,lineWidth:Cg.defaultNode.linkPoints.lineWidth,fill:Cg.defaultNode.linkPoints.fill,stroke:Cg.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:$i({},Cg.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).icon,i=void 0===n?{}:n,r=this.getShapeStyle(e),o=so({},i,e.icon),s="".concat(this.type,"-keyShape"),a=t.addShape("circle",{attrs:r,className:s,name:s,draggable:!0});t.shapeMap[s]=a;var l=o.width,c=o.height,u=o.show,h=o.text;if(u){var d="".concat(this.type,"-icon");t.shapeMap[d]=h?t.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},o),className:d,name:d,draggable:!0}):t.addShape("image",{attrs:$i({x:-l/2,y:-c/2},o),className:d,name:d,draggable:!0})}return this.drawLinkPoints(e,t),a},drawLinkPoints:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).linkPoints;if(n){var i=n||{},r=i.top,o=i.left,s=i.right,a=i.bottom,l=i.size,c=i.r,u=Yi(i,["top","left","right","bottom","size","r"]),h=this.getSize(e)[0]/2;if(o){var d="link-point-left";t.shapeMap[d]=t.addShape("circle",{attrs:$i($i({},u),{x:-h,y:0,r:l/2||c||5}),className:d,name:d,isAnchorPoint:!0})}if(s){var f="link-point-right";t.shapeMap[f]=t.addShape("circle",{attrs:$i($i({},u),{x:h,y:0,r:l/2||c||5}),className:f,name:f,isAnchorPoint:!0})}if(r){var g="link-point-top";t.shapeMap[g]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:-h,r:l/2||c||5}),className:g,name:g,isAnchorPoint:!0})}if(a){var p="link-point-bottom";t.shapeMap[p]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:h,r:l/2||c||5}),className:p,name:p,isAnchorPoint:!0})}}},getShapeStyle:function(e){var t=(this.mergeStyle||this.getOptions(e)).style,n={stroke:e.color},i=so({},t,n),r=this.getSize(e)[0]/2;return $i({x:0,y:0,r:r},i)},update:function(e,t,n){var i=t.getContainer(),r=this.getSize(e),o=$i({},e.style);void 0===e.style.stroke&&e.color&&(o.stroke=e.color),void 0!==e.style.r||isNaN(r[0])||(o.r=r[0]/2),this.updateShape(e,t,o,!0,n),this.updateLinkPoints(e,i)}},"single-node"),yg("rect",{options:{size:[100,30],style:{radius:0,stroke:Cg.defaultNode.style.stroke,fill:Cg.defaultNode.style.fill,lineWidth:Cg.defaultNode.style.lineWidth},labelCfg:{style:{fill:Cg.nodeLabel.style.fill,fontSize:Cg.nodeLabel.style.fontSize,fontFamily:Cg.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Cg.defaultNode.linkPoints.size,lineWidth:Cg.defaultNode.linkPoints.lineWidth,fill:Cg.defaultNode.linkPoints.fill,stroke:Cg.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},anchorPoints:[[0,.5],[1,.5]],stateStyles:$i({},Cg.nodeStateStyles)},shapeType:"rect",labelPosition:"center",drawShape:function(e,t){var n=this.getShapeStyle(e),i=t.addShape("rect",{attrs:n,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return t.shapeMap["".concat(this.type,"-keyShape")]=i,this.drawLinkPoints(e,t),i},drawLinkPoints:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).linkPoints,i=void 0===n?{}:n,r=i.top,o=i.left,s=i.right,a=i.bottom,l=i.size,c=i.r,u=Yi(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0],f=h[1];o&&(t.shapeMap["link-point-left"]=t.addShape("circle",{attrs:$i($i({},u),{x:-d/2,y:0,r:l/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),s&&(t.shapeMap["link-point-right"]=t.addShape("circle",{attrs:$i($i({},u),{x:d/2,y:0,r:l/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),r&&(t.shapeMap["link-point-top"]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:-f/2,r:l/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),a&&(t.shapeMap["link-point-bottom"]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:f/2,r:l/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(e){var t=to({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),n=this.getSize(e),i=t.width||n[0],r=t.height||n[1];return $i({x:-i/2,y:-r/2,width:i,height:r},t)},update:function(e,t,n){var i=t.getContainer(),r=this.getOptions({}).style,o=this.getSize(e),s=t.get("keyShape");e.size||(o[0]=s.attr("width")||r.width,o[1]=s.attr("height")||r.height);var a={stroke:e.color,x:-o[0]/2,y:-o[1]/2,width:o[0],height:o[1]},l=to({},r,s.attr(),a);l=to(l,e.style),this.updateShape(e,t,l,!1,n),this.updateLinkPoints(e,i)}},"single-node"),yg("ellipse",{options:{size:[80,40],style:{x:0,y:0,stroke:Cg.defaultNode.style.stroke,fill:Cg.defaultNode.style.fill,lineWidth:Cg.defaultNode.style.lineWidth},labelCfg:{style:{fill:Cg.nodeLabel.style.fill,fontSize:Cg.nodeLabel.style.fontSize,fontFamily:Cg.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Cg.defaultNode.linkPoints.size,lineWidth:Cg.defaultNode.linkPoints.lineWidth,fill:Cg.defaultNode.linkPoints.fill,stroke:Cg.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:$i({},Cg.nodeStateStyles)},shapeType:"ellipse",labelPosition:"center",drawShape:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).icon,i=void 0===n?{}:n,r=this.getShapeStyle(e),o=t.addShape("ellipse",{attrs:r,className:"ellipse-keyShape",name:"ellipse-keyShape",draggable:!0});t.shapeMap["ellipse-keyShape"]=o;var s=i.width,a=i.height,l=i.show,c=i.text;return l&&(t.shapeMap["".concat(this.type,"-icon")]=c?t.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):t.addShape("image",{attrs:$i({x:-s/2,y:-a/2},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(e,t),o},drawLinkPoints:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).linkPoints,i=void 0===n?{}:n,r=i.top,o=i.left,s=i.right,a=i.bottom,l=i.size,c=i.r,u=Yi(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0]/2,f=h[1]/2;o&&(t.shapeMap["link-point-left"]=t.addShape("circle",{attrs:$i($i({},u),{x:-d,y:0,r:l/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),s&&(t.shapeMap["link-point-right"]=t.addShape("circle",{attrs:$i($i({},u),{x:d,y:0,r:l/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),r&&(t.shapeMap["link-point-top"]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:-f,r:l/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),a&&(t.shapeMap["link-point-bottom"]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:f,r:l/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(e){var t=to({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),n=this.getSize(e),i=n[0]/2,r=n[1]/2;return $i({x:0,y:0,rx:i,ry:r},t)},update:function(e,t,n){var i=t.getContainer(),r=this.getOptions({}).style,o=this.getSize(e),s={stroke:e.color,rx:o[0]/2,ry:o[1]/2},a=to({},r,t.get("keyShape").attr(),s);a=to(a,e.style),this.updateShape(e,t,a,!0,n),this.updateLinkPoints(e,i)}},"single-node"),yg("diamond",{options:{size:[80,80],style:{stroke:Cg.defaultNode.style.stroke,fill:Cg.defaultNode.style.fill,lineWidth:Cg.defaultNode.style.lineWidth},labelCfg:{style:{fill:Cg.nodeLabel.style.fill,fontSize:Cg.nodeLabel.style.fontSize,fontFamily:Cg.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Cg.defaultNode.linkPoints.size,lineWidth:Cg.defaultNode.linkPoints.lineWidth,fill:Cg.defaultNode.linkPoints.fill,stroke:Cg.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:$i({},Cg.nodeStateStyles)},shapeType:"diamond",labelPosition:"center",drawShape:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).icon,i=void 0===n?{}:n,r=this.getShapeStyle(e),o=t.addShape("path",{attrs:r,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});t.shapeMap["".concat(this.type,"-keyShape")]=o;var s=i.width,a=i.height,l=i.show,c=i.text;return l&&(t.shapeMap["".concat(this.type,"-icon")]=c?t.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):t.addShape("image",{attrs:$i({x:-s/2,y:-a/2},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(e,t),o},drawLinkPoints:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).linkPoints,i=void 0===n?{}:n,r=i.top,o=i.left,s=i.right,a=i.bottom,l=i.size,c=i.r,u=Yi(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0],f=h[1];o&&(t.shapeMap["link-point-left"]=t.addShape("circle",{attrs:$i($i({},u),{x:-d/2,y:0,r:l/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),s&&(t.shapeMap["link-point-right"]=t.addShape("circle",{attrs:$i($i({},u),{x:d/2,y:0,r:l/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),r&&(t.shapeMap["link-point-top"]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:-f/2,r:l/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),a&&(t.shapeMap["link-point-bottom"]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:f/2,r:l/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getPath:function(e){var t=this.getSize(e),n=t[0],i=t[1];return[["M",0,-i/2],["L",n/2,0],["L",0,i/2],["L",-n/2,0],["Z"]]},getShapeStyle:function(e){var t=to({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),n=this.getPath(e);return $i({path:n},t)},update:function(e,t,n){var i=t.getContainer(),r=this.getOptions({}).style,o=this.getPath(e),s={stroke:e.color,path:o},a=to({},r,t.get("keyShape").attr(),s);a=to(a,e.style),this.updateShape(e,t,a,!0,n),this.updateLinkPoints(e,i)}},"single-node"),yg("triangle",{options:{size:40,direction:"up",style:{stroke:Cg.defaultNode.style.stroke,fill:Cg.defaultNode.style.fill,lineWidth:Cg.defaultNode.style.lineWidth},labelCfg:{style:{fill:Cg.nodeLabel.style.fill,fontSize:Cg.nodeLabel.style.fontSize},offset:15},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Cg.defaultNode.linkPoints.size,lineWidth:Cg.defaultNode.linkPoints.lineWidth,fill:Cg.defaultNode.linkPoints.fill,stroke:Cg.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20,offset:6},stateStyles:$i({},Cg.nodeStateStyles)},shapeType:"triangle",labelPosition:"bottom",drawShape:function(e,t){var n=this.mergeStyle||this.getOptions(e),i=n.icon,r=void 0===i?{}:i,o=n.direction,s=this.getShapeStyle(e),a=e.direction||o,l=t.addShape("path",{attrs:s,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});t.shapeMap["".concat(this.type,"-keyShape")]=l;var c=r.width,u=r.height,h=r.show,d=r.offset,f=r.text;if(h)if(f)t.shapeMap["".concat(this.type,"-icon")]=t.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0});else{var g=-c/2,p=-u/2;"up"!==a&&"down"!==a||(p+=d),"left"!==a&&"right"!==a||(g+=d),t.shapeMap["".concat(this.type,"-icon")]=t.addShape("image",{attrs:$i({x:g,y:p},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})}return this.drawLinkPoints(e,t),l},drawLinkPoints:function(e,t){var n=this.mergeStyle||this.getOptions(e),i=n.linkPoints,r=void 0===i?{}:i,o=n.direction,s=e.direction||o,a=r.top,l=r.left,c=r.right,u=r.bottom,h=r.size,d=r.r,f=Yi(r,["top","left","right","bottom","size","r"]),g=this.getSize(e)[0];if(l){var p=null,m=g*Math.sin(1/3*Math.PI),v=g*Math.sin(1/3*Math.PI);"up"===s?p=[-v,m]:"down"===s?p=[-v,-m]:"left"===s&&(p=[-v,v-m]),p&&(t.shapeMap["link-point-left"]=t.addShape("circle",{attrs:$i($i({},f),{x:p[0],y:p[1],r:h/2||d||5}),className:"link-point-left",name:"link-point-left"}))}if(c){var y=null;m=g*Math.sin(1/3*Math.PI),v=g*Math.sin(1/3*Math.PI);"up"===s?y=[v,m]:"down"===s?y=[v,-m]:"right"===s&&(y=[v,v-m]),y&&(t.shapeMap["link-point-right"]=t.addShape("circle",{attrs:$i($i({},f),{x:y[0],y:y[1],r:h/2||d||5}),className:"link-point-right",name:"link-point-right"}))}if(a){var _=null;m=g*Math.sin(1/3*Math.PI),v=g*Math.sin(1/3*Math.PI);"up"===s?_=[v-m,-m]:"left"===s?_=[v,-m]:"right"===s&&(_=[-v,-m]),_&&(t.shapeMap["link-point-top"]=t.addShape("circle",{attrs:$i($i({},f),{x:_[0],y:_[1],r:h/2||d||5}),className:"link-point-top",name:"link-point-top"}))}if(u){var b=null;m=g*Math.sin(1/3*Math.PI),v=g*Math.sin(1/3*Math.PI);"down"===s?b=[-v+m,m]:"left"===s?b=[v,m]:"right"===s&&(b=[-v,m]),b&&(t.shapeMap["link-point-bottom"]=t.addShape("circle",{attrs:$i($i({},f),{x:b[0],y:b[1],r:h/2||d||5}),className:"link-point-bottom",name:"link-point-bottom"}))}},getPath:function(e){var t=(this.mergeStyle||this.getOptions(e)).direction,n=e.direction||t,i=this.getSize(e)[0],r=i*Math.sin(1/3*Math.PI),o=i*Math.sin(1/3*Math.PI),s=[["M",-o,r],["L",0,-r],["L",o,r],["Z"]];return"down"===n?s=[["M",-o,-r],["L",o,-r],["L",0,r],["Z"]]:"left"===n?s=[["M",-o,o-r],["L",o,-o],["L",o,o],["Z"]]:"right"===n&&(s=[["M",o,o-r],["L",-o,o],["L",-o,-o],["Z"]]),s},getShapeStyle:function(e){var t=to({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),n=this.getPath(e);return $i({path:n},t)},update:function(e,t,n){var i=t.getContainer(),r=this.getOptions({}).style,o=this.getPath(e),s={stroke:e.color,path:o},a=to({},r,t.get("keyShape").attr(),s);a=to(a,e.style),this.updateShape(e,t,a,!0,n),this.updateLinkPoints(e,i)},updateLinkPoints:function(e,t){var n=this.getOptions({}),i=n.linkPoints,r=n.direction,o=e.direction||r,s=t.shapeMap["link-point-left"]||t.find((function(e){return"link-point-left"===e.get("className")})),a=t.shapeMap["link-point-right"]||t.find((function(e){return"link-point-right"===e.get("className")})),l=t.shapeMap["link-point-top"]||t.find((function(e){return"link-point-top"===e.get("className")})),c=t.shapeMap["link-point-bottom"]||t.find((function(e){return"link-point-bottom"===e.get("className")})),u=i,h=s||a||l||c;h&&(u=h.attr());var d=to({},u,e.linkPoints),f=d.fill,g=d.stroke,p=d.lineWidth,m=d.size/2;m||(m=d.r);var v=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},y=v.left,_=v.right,b=v.top,w=v.bottom,C=this.getSize(e)[0],S={r:m,fill:f,stroke:g,lineWidth:p},x=null,E=C*Math.sin(1/3*Math.PI),k=C*Math.sin(1/3*Math.PI);"up"===o?x=[-k,E]:"down"===o?x=[-k,-E]:"left"===o&&(x=[-k,k-E]),x&&(s?y||void 0===y?s.attr($i($i({},S),{x:x[0],y:x[1]})):(s.remove(),delete t.shapeMap["link-point-left"]):y&&(t.shapeMap["link-point-left"]=t.addShape("circle",{attrs:$i($i({},S),{x:x[0],y:x[1]}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})));var L=null;"up"===o?L=[k,E]:"down"===o?L=[k,-E]:"right"===o&&(L=[k,k-E]),L&&(a?_||void 0===_?a.attr($i($i({},S),{x:L[0],y:L[1]})):(a.remove(),delete t.shapeMap["link-point-right"]):_&&(t.shapeMap["link-point-right"]=t.addShape("circle",{attrs:$i($i({},S),{x:L[0],y:L[1]}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})));var D=null;"up"===o?D=[k-E,-E]:"left"===o?D=[k,-E]:"right"===o&&(D=[-k,-E]),D&&(l?b||void 0===b?l.attr($i($i({},S),{x:D[0],y:D[1]})):(l.remove(),delete t.shapeMap["link-point-top"]):b&&(t.shapeMap["link-point-top"]=t.addShape("circle",{attrs:$i($i({},S),{x:D[0],y:D[1]}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})));var N=null;"down"===o?N=[-k+E,E]:"left"===o?N=[k,E]:"right"===o&&(N=[-k,E]),N&&(c?w||void 0===w?c.attr($i($i({},S),{x:N[0],y:N[1]})):(c.remove(),delete t.shapeMap["link-point-bottom"]):w&&(t.shapeMap["link-point-bottom"]=t.addShape("circle",{attrs:$i($i({},S),{x:N[0],y:N[1]}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})))}},"single-node"),yg("modelRect",{options:{size:[185,70],style:{radius:5,stroke:"#69c0ff",fill:"#ffffff",lineWidth:Cg.defaultNode.style.lineWidth,fillOpacity:1},labelCfg:{style:{fill:"#595959",fontSize:14,fontFamily:Cg.windowFontFamily},offset:30},descriptionCfg:{style:{fontSize:12,fill:"#bfbfbf",fontFamily:Cg.windowFontFamily},paddingTop:0},preRect:{show:!0,width:4,fill:"#40a9ff",radius:2},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:10,lineWidth:1,fill:"#72CC4A",stroke:"#72CC4A"},logoIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",width:16,height:16,offset:0},stateIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg",width:16,height:16,offset:-5},anchorPoints:[[0,.5],[1,.5]]},shapeType:"modelRect",drawShape:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).preRect,i=void 0===n?{}:n,r=this.getShapeStyle(e),o=this.getSize(e),s=o[0],a=o[1],l=t.addShape("rect",{attrs:r,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});t.shapeMap["".concat(this.type,"-keyShape")]=l;var c=i.show,u=Yi(i,["show"]);return c&&(t.shapeMap["pre-rect"]=t.addShape("rect",{attrs:$i({x:-s/2,y:-a/2,height:a},u),className:"pre-rect",name:"pre-rect",draggable:!0})),this.drawLogoIcon(e,t),this.drawStateIcon(e,t),this.drawLinkPoints(e,t),l},drawLogoIcon:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).logoIcon,i=void 0===n?{}:n,r=this.getSize(e)[0];if(i.show){var o=i.width,s=i.height,a=i.x,l=i.y,c=i.offset,u=i.text,h=Yi(i,["width","height","x","y","offset","text"]);t.shapeMap["rect-logo-icon"]=u?t.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},h),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0}):t.addShape("image",{attrs:$i($i({},h),{x:a||-r/2+o+c,y:l||-s/2,width:o,height:s}),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0})}},drawStateIcon:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).stateIcon,i=void 0===n?{}:n,r=this.getSize(e)[0];if(i.show){var o=i.width,s=i.height,a=i.x,l=i.y,c=i.offset,u=i.text,h=Yi(i,["width","height","x","y","offset","text"]);t.shapeMap["rect-state-icon"]=u?t.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},h),className:"rect-state-icon",name:"rect-state-icon",draggable:!0}):t.addShape("image",{attrs:$i($i({},h),{x:a||r/2-o+c,y:l||-s/2,width:o,height:s}),className:"rect-state-icon",name:"rect-state-icon",draggable:!0})}},drawLinkPoints:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).linkPoints,i=void 0===n?{}:n,r=i.top,o=i.left,s=i.right,a=i.bottom,l=i.size,c=i.r,u=Yi(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0],f=h[1];o&&(t.shapeMap["link-point-left"]=t.addShape("circle",{attrs:$i($i({},u),{x:-d/2,y:0,r:l/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),s&&(t.shapeMap["link-point-right"]=t.addShape("circle",{attrs:$i($i({},u),{x:d/2,y:0,r:l/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),r&&(t.shapeMap["link-point-top"]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:-f/2,r:l/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),a&&(t.shapeMap["link-point-bottom"]=t.addShape("circle",{attrs:$i($i({},u),{x:0,y:f/2,r:l/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},drawLabel:function(e,t){var n=this.getOptions(e),i=n.labelCfg,r=void 0===i?{}:i,o=n.logoIcon,s=void 0===o?{}:o,a=n.descriptionCfg,l=void 0===a?{}:a,c=this.getSize(e)[0],u=null,h=s.show,d=s.width,f=-c/2+r.offset;h&&(f=-c/2+d+r.offset);var g=r.style,p=l.style,m=l.paddingTop;return xr(e.description)?(u=t.addShape("text",{attrs:$i($i({},g),{x:f,y:-5,text:e.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),t.shapeMap["text-shape"]=u,t.shapeMap["rect-description"]=t.addShape("text",{attrs:$i($i({},p),{x:f,y:17+(m||0),text:e.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})):(u=t.addShape("text",{attrs:$i($i({},g),{x:f,y:7,text:e.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),t.shapeMap["text-shape"]=u),u},getShapeStyle:function(e){var t=to({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),n=this.getSize(e),i=t.width||n[0],r=t.height||n[1];return $i({x:-i/2,y:-r/2,width:i,height:r},t)},update:function(e,t){var n=this.mergeStyle||this.getOptions(e),i=n.style,r=void 0===i?{}:i,o=n.labelCfg,s=void 0===o?{}:o,a=n.descriptionCfg,l=void 0===a?{}:a,c=this.getSize(e),u=c[0],h=c[1];t.get("keyShape").attr($i($i({},r),{x:-u/2,y:-h/2,width:u,height:h}));var d=t.getContainer(),f=d.shapeMap["rect-logo-icon"]||d.find((function(e){return"rect-logo-icon"===e.get("className")})),g=to({},f?f.attr():{},e.logoIcon),p=g.width;void 0===p&&(p=this.options.logoIcon.width);var m=e.logoIcon?e.logoIcon.show:void 0,v=s.offset,y=-u/2+p+v;m||void 0===m||(y=-u/2+v);var _=d.shapeMap["node-label"]||d.find((function(e){return"node-label"===e.get("className")})),b=d.shapeMap["rect-description"]||d.find((function(e){return"rect-description"===e.get("className")}));if(e.label)if(_){var w=e.labelCfg?e.labelCfg.style:{},C=to({},_.attr(),w);e.label&&(C.text=e.label),C.x=y,xr(e.description)&&(C.y=-5),b&&(b.resetMatrix(),b.attr({x:y})),_.resetMatrix(),_.attr(C)}else d.shapeMap["node-label"]=d.addShape("text",{attrs:$i($i({},s.style),{x:y,y:e.description?-5:7,text:e.label}),className:"node-label",name:"node-label",draggable:!0,labelRelated:!0});if(xr(e.description)){var S=l.paddingTop;if(b){w=e.descriptionCfg?e.descriptionCfg.style:{};var x=to({},b.attr(),w);xr(e.description)&&(x.text=e.description),x.x=y,b.resetMatrix(),b.attr($i($i({},x),{y:17+(S||0)}))}else d.shapeMap["rect-description"]=d.addShape("text",{attrs:$i($i({},l.style),{x:y,y:17+(S||0),text:e.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})}var E=d.shapeMap["pre-rect"]||d.find((function(e){return"pre-rect"===e.get("className")}));if(E&&!E.destroyed){var k=to({},E.attr(),e.preRect);E.attr($i($i({},k),{x:-u/2,y:-h/2,height:h}))}if(f&&!f.destroyed)if(m||void 0===m){var L=g.width,D=g.height,N=g.x,I=g.y,T=g.offset,M=Yi(g,["width","height","x","y","offset"]);f.attr($i($i({},M),{x:N||-u/2+L+T,y:I||-D/2,width:L,height:D}))}else f.remove(),delete d.shapeMap["pre-rect"];else m&&this.drawLogoIcon(e,d);var A=d.shapeMap["rect-state-icon"]||d.find((function(e){return"rect-state-icon"===e.get("className")})),O=to({},A?A.attr():{},e.stateIcon);if(A){O.show||void 0===O.show||(A.remove(),delete d.shapeMap["rect-state-icon"]);var R=O.width,P=(D=O.height,N=O.x,I=O.y,O.offset),F=Yi(O,["width","height","x","y","offset"]);A.attr($i($i({},F),{x:N||u/2-R+P,y:I||-D/2,width:R,height:D}))}else O.show&&this.drawStateIcon(e,d);this.updateLinkPoints(e,d)}},"single-node"),yg("star",{options:{size:60,style:{stroke:Cg.defaultNode.style.stroke,fill:Cg.defaultNode.style.fill,lineWidth:Cg.defaultNode.style.lineWidth},labelCfg:{style:{fill:Cg.nodeLabel.style.fill,fontSize:Cg.nodeLabel.style.fontSize,fontFamily:Cg.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Cg.defaultNode.linkPoints.size,lineWidth:Cg.defaultNode.linkPoints.lineWidth,fill:Cg.defaultNode.linkPoints.fill,stroke:Cg.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:$i({},Cg.nodeStateStyles)},shapeType:"star",labelPosition:"center",drawShape:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).icon,i=void 0===n?{}:n,r=this.getShapeStyle(e),o=t.addShape("path",{attrs:r,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});t.shapeMap["".concat(this.type,"-keyShape")]=o;var s=i.width,a=i.height,l=i.show,c=i.text;return l&&(t.shapeMap["".concat(this.type,"-icon")]=c?t.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):t.addShape("image",{attrs:$i({x:-s/2,y:-a/2},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(e,t),o},drawLinkPoints:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).linkPoints,i=void 0===n?{}:n,r=i.top,o=i.left,s=i.right,a=i.leftBottom,l=i.rightBottom,c=i.size,u=i.r,h=Yi(i,["top","left","right","leftBottom","rightBottom","size","r"]),d=this.getSize(e)[0];if(s){var f=Math.cos(.1*Math.PI)*d,g=Math.sin(.1*Math.PI)*d;t.shapeMap["link-point-right"]=t.addShape("circle",{attrs:$i($i({},h),{x:f,y:-g,r:c/2||u||5}),className:"link-point-right",name:"link-point-right"})}if(r){f=Math.cos(.5*Math.PI)*d,g=Math.sin(.5*Math.PI)*d;t.shapeMap["link-point-top"]=t.addShape("circle",{attrs:$i($i({},h),{x:f,y:-g,r:c/2||u||5}),className:"link-point-top",name:"link-point-top"})}if(o){f=Math.cos(.9*Math.PI)*d,g=Math.sin(.9*Math.PI)*d;t.shapeMap["link-point-left"]=t.addShape("circle",{attrs:$i($i({},h),{x:f,y:-g,r:c/2||u||5}),className:"link-point-left",name:"link-point-left"})}if(a){f=Math.cos(1.3*Math.PI)*d,g=Math.sin(1.3*Math.PI)*d;t.shapeMap["link-point-bottom"]=t.addShape("circle",{attrs:$i($i({},h),{x:f,y:-g,r:c/2||u||5}),className:"link-point-left-bottom",name:"link-point-left-bottom"})}if(l){f=Math.cos(1.7*Math.PI)*d,g=Math.sin(1.7*Math.PI)*d;t.shapeMap["link-point-right-bottom"]=t.addShape("circle",{attrs:$i($i({},h),{x:f,y:-g,r:c/2||u||5}),className:"link-point-right-bottom",name:"link-point-right-bottom"})}},getPath:function(e){for(var t=this.getSize(e)[0],n=3*t/8,i=e.innerR||n,r=[],o=0;o<5;o++){var s=Math.cos((18+72*o)/180*Math.PI)*t,a=Math.sin((18+72*o)/180*Math.PI)*t,l=Math.cos((54+72*o)/180*Math.PI)*i,c=Math.sin((54+72*o)/180*Math.PI)*i;0===o?r.push(["M",s,-a]):r.push(["L",s,-a]),r.push(["L",l,-c])}return r.push(["Z"]),r},getShapeStyle:function(e){var t=to({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),n=this.getPath(e);return $i({path:n},t)},update:function(e,t,n){var i=t.getContainer(),r=this.getOptions({}).style,o=this.getPath(e),s={stroke:e.color,path:o},a=to({},r,t.get("keyShape").attr(),s);a=to(a,e.style),this.updateShape(e,t,a,!0,n),this.updateLinkPoints(e,i)},updateLinkPoints:function(e,t){var n=this.getOptions({}).linkPoints,i=t.shapeMap["link-point-left"]||t.find((function(e){return"link-point-left"===e.get("className")})),r=t.shapeMap["link-point-right"]||t.find((function(e){return"link-point-right"===e.get("className")})),o=t.shapeMap["link-point-top"]||t.find((function(e){return"link-point-top"===e.get("className")})),s=t.shapeMap["link-point-left-bottom"]||t.find((function(e){return"link-point-left-bottom"===e.get("className")})),a=t.shapeMap["link-point-left-bottom"]||t.find((function(e){return"link-point-right-bottom"===e.get("className")})),l=n,c=i||r||o||s||a;c&&(l=c.attr());var u=to({},l,e.linkPoints),h=u.fill,d=u.stroke,f=u.lineWidth,g=u.size/2;g||(g=u.r);var p=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,leftBottom:void 0,rightBottom:void 0},m=p.left,v=p.right,y=p.top,_=p.leftBottom,b=p.rightBottom,w=this.getSize(e)[0],C={r:g,fill:h,stroke:d,lineWidth:f},S=Math.cos(.1*Math.PI)*w,x=Math.sin(.1*Math.PI)*w;r?v||void 0===v?r.attr($i($i({},C),{x:S,y:-x})):(r.remove(),delete t.shapeMap["link-point-right"]):v&&(t.shapeMap["link-point-right"]=t.addShape("circle",{attrs:$i($i({},C),{x:S,y:-x}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),S=Math.cos(.5*Math.PI)*w,x=Math.sin(.5*Math.PI)*w,o?y||void 0===y?o.attr($i($i({},C),{x:S,y:-x})):(o.remove(),delete t.shapeMap["link-point-top"]):y&&(t.shapeMap["link-point-top"]=t.addShape("circle",{attrs:$i($i({},C),{x:S,y:-x}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),S=Math.cos(.9*Math.PI)*w,x=Math.sin(.9*Math.PI)*w,i?m||void 0===m?i.attr($i($i({},C),{x:S,y:-x})):(i.remove(),delete t.shapeMap["link-point-left"]):m&&(t.shapeMap["link-point-left"]=t.addShape("circle",{attrs:$i($i({},C),{x:S,y:-x}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),S=Math.cos(1.3*Math.PI)*w,x=Math.sin(1.3*Math.PI)*w,s?_||void 0===_?s.attr($i($i({},C),{x:S,y:-x})):(s.remove(),delete t.shapeMap["link-point-left-bottom"]):_&&(t.shapeMap["link-point-left-bottom"]=t.addShape("circle",{attrs:$i($i({},C),{x:S,y:-x}),className:"link-point-left-bottom",name:"link-point-left-bottom",isAnchorPoint:!0})),S=Math.cos(1.7*Math.PI)*w,x=Math.sin(1.7*Math.PI)*w,a?b||void 0===b?a.attr($i($i({},C),{x:S,y:-x})):(s.remove(),delete t.shapeMap["link-point-right-bottom"]):b&&(t.shapeMap["link-point-right-bottom"]=t.addShape("circle",{attrs:$i($i({},C),{x:S,y:-x}),className:"link-point-right-bottom",name:"link-point-right-bottom",isAnchorPoint:!0}))}},"single-node");var WV=pg.defaultSubjectColors;yg("donut",{options:{size:Cg.defaultNode.size,style:{x:0,y:0,stroke:Cg.defaultNode.style.stroke,fill:Cg.defaultNode.style.fill,lineWidth:Cg.defaultNode.style.lineWidth},labelCfg:{style:{fill:Cg.nodeLabel.style.fill,fontSize:Cg.nodeLabel.style.fontSize,fontFamily:Cg.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Cg.defaultNode.linkPoints.size,lineWidth:Cg.defaultNode.linkPoints.lineWidth,fill:Cg.defaultNode.linkPoints.fill,stroke:Cg.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:$i({},Cg.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(e,t){var n=(this.mergeStyle||this.getOptions(e)).icon,i=void 0===n?{}:n,r=this.getShapeStyle(e),o=so({},i,e.icon),s=t.addShape("circle",{attrs:r,className:"".concat(this.type,"-keyShape"),draggable:!0,name:"".concat(this.type,"-keyShape")});t.shapeMap["".concat(this.type,"-keyShape")]=s;var a=o.width,l=o.height,c=o.show,u=o.text;c&&(t.shapeMap["".concat(this.type,"-icon")]=u?t.addShape("text",{attrs:$i({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},o),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):t.addShape("image",{attrs:$i({x:-a/2,y:-l/2},o),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}));var h=s.attr("r"),d=.6*h,f=(h+d)/2,g=e,p=g.donutAttrs,m=void 0===p?{}:p,v=g.donutColorMap,y=void 0===v?{}:v,_=Object.keys(m).length;if(m&&_>1){var b=[],w=0;if(Object.keys(m).forEach((function(e){var t=m[e]||0;Or(t)&&(b.push({key:e,value:t,color:y[e]}),w+=t)})),w){var C=h-d;if(1===_)return void(t.shapeMap["fan-shape-0"]=t.addShape("circle",{attrs:{r:f,x:0,y:0,stroke:b[0].color||WV[0],lineWidth:C},name:"fan-shape-0"}));var S=[f,0],x=0;b.forEach((function(e,n){var i=e.value/w;if(!(i<.001))if(i>.999&&(i=1),1!==i){e.percent=i,e.angle=i*Math.PI*2,e.beginAgnle=x,x+=e.angle,e.endAngle=x,e.arcBegin=S,e.arcEnd=[f*Math.cos(e.endAngle),-f*Math.sin(e.endAngle)];var r=e.angle>Math.PI?1:0,o=[["M",e.arcBegin[0],e.arcBegin[1]],["A",f,f,0,r,0,e.arcEnd[0],e.arcEnd[1]],["L",e.arcEnd[0],e.arcEnd[1]]];t.shapeMap["fan-shape-".concat(n)]=t.addShape("path",{attrs:{path:o,lineWidth:C,stroke:e.color||WV[n%WV.length]},name:"fan-shape-".concat(n)}),S=e.arcEnd}else t.shapeMap["fan-shape-".concat(n)]=t.addShape("circle",{attrs:{r:f,x:0,y:0,stroke:e.color||WV[n%WV.length],lineWidth:C},name:"fan-shape-".concat(n)})}))}}return this.drawLinkPoints(e,t),s},update:void 0},"circle");var zV=function(e){var t=e.x,n=e.y;return{x:t,y:n,centerX:t,centerY:n,minX:t,minY:n,maxX:t,maxY:n,height:0,width:0}},VV=function(e){for(var t=[],n={},i=e.length-1;i>=0;i--){var r=e[i];r.id="".concat(r.x,"|||").concat(r.y),n[r.id]=r,t.push(r)}return t},UV=function(e){return VV(e)},HV=function(e,t){return e.width||e.height?{centerX:e.centerX,centerY:e.centerY,minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t,height:e.height+2*t,width:e.width+2*t}:e},jV=function(e,t,n){var i=function(e,t){var n=Math.abs(e.x-t.centerX),i=Math.abs(e.y-t.centerY);return 0===n&&0===i?0:n/t.width>i/t.height}(t,e);if(0===i){var r=e.centerX,o=e.centerY;return n.y<t.y?o=e.minY:n.x>t.x?r=e.maxX:n.x<t.x?r=e.minX:n.x===t.x&&(o=e.maxY),{x:r,y:o}}return i?{x:t.x>e.centerX?e.maxX:e.minX,y:t.y}:{x:t.x,y:t.y>e.centerY?e.maxY:e.minY}},GV=function(e,t){var n=Math.min(e.minX,t.minX),i=Math.min(e.minY,t.minY),r=Math.max(e.maxX,t.maxX),o=Math.max(e.maxY,t.maxY);return{centerX:(n+r)/2,centerY:(i+o)/2,minX:n,minY:i,maxX:r,maxY:o,height:o-i,width:r-n}},KV=function(e){return[{x:e.minX,y:e.minY},{x:e.maxX,y:e.minY},{x:e.maxX,y:e.maxY},{x:e.minX,y:e.maxY}]},qV=function(e,t){var n=e.x,i=e.y;return n<t.minX||n>t.maxX||i<t.minY||i>t.maxY},$V=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},YV=function(e,t,n,i,r){return $V(e,t)+$V(e,n)+function(e,t){var n=0;return t.forEach((function(t){t&&(e.x===t.x&&(n+=-2),e.y===t.y&&(n+=-2))})),n}(e,[t,n,i,r])},XV=function e(t,n,i,r,o){void 0===o&&(o=0),t.unshift(n[r]),i[r]&&i[r]!==r&&o<=100&&e(t,n,i,i[r],o+1)},ZV=function(e,t,n,i){var r=n.x-e.x,o=n.y-e.y,s=i.x-e.x,a=i.y-e.y,l=n.x-t.x,c=n.y-t.y,u=i.x-t.x,h=i.y-t.y;return(r*a-o*s)*(l*h-c*u)<=0&&(r*c-o*l)*(s*h-a*u)<=0},QV=function(e,t,n){if(n.width||n.height){var i=KV(n),r=i[0],o=i[1],s=i[2],a=i[3];return ZV(e,t,r,o)||ZV(e,t,r,a)||ZV(e,t,o,s)||ZV(e,t,s,a)}return!1},JV=function(e,t,n,i){var r=[];return e.forEach((function(e){if(e!==t&&(e.x===t.x||e.y===t.y)){if(QV(e,t,n)||QV(e,t,i))return;r.push(e)}})),VV(r)},eU=function(e,t){var n=[],i=e[0];return n.push("M".concat(i.x," ").concat(i.y)),e.forEach((function(i,r){var o=e[r+1],s=e[r+2];if(o&&s)if(function(e,t,n){return!(e.x===t.x&&t.x===n.x||e.y===t.y&&t.y===n.y)}(i,o,s)){var a=function(e,t,n,i){var r=$V(e,t),o=$V(n,t);return r<i&&(i=r),o<i&&(i=o),[{x:t.x-i/r*(t.x-e.x),y:t.y-i/r*(t.y-e.y)},{x:t.x-i/o*(t.x-n.x),y:t.y-i/o*(t.y-n.y)}]}(i,o,s,t),l=a[0],c=a[1];n.push("L".concat(l.x," ").concat(l.y)),n.push("Q".concat(o.x," ").concat(o.y," ").concat(c.x," ").concat(c.y)),n.push("L".concat(c.x," ").concat(c.y))}else n.push("L".concat(o.x," ").concat(o.y));else o&&n.push("L".concat(o.x," ").concat(o.y))})),n.join("")},tU=function(e,t,n,i,r){var o,s;if(n&&n.getType())if("combo"===n.getType()){(o=n.getKeyShape().getCanvasBBox()||zV(e)).centerX=(o.minX+o.maxX)/2,o.centerY=(o.minY+o.maxY)/2}else o=n.getBBox();else o=zV(e);if(i&&i.getType())if("combo"===i.getType()){var a=i.getKeyShape().getBBox();if(a){var l=i.getModel(),c=l.x,u=l.y;(s={x:c,y:u,width:a.width,height:a.height,minX:a.minX+c,maxX:a.maxX+c,minY:a.minY+u,maxY:a.maxY+u}).centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2}else s=zV(t)}else s=i&&i.getBBox();else s=zV(t);var h=HV(o,r),d=HV(s,r),f=jV(h,e,t),g=jV(d,t,e),p=function(e){void 0===e&&(e=[]);var t=[],n=[];e.forEach((function(e){t.push(e.x),n.push(e.y)}));var i=Math.min.apply(Math,t),r=Math.max.apply(Math,t),o=Math.min.apply(Math,n),s=Math.max.apply(Math,n);return{centerX:(i+r)/2,centerY:(o+s)/2,maxX:r,maxY:s,minX:i,minY:o,height:s-o,width:r-i}}([f,g]),m=GV(h,p),v=GV(d,p),y=[];y=y.concat(KV(m)).concat(KV(v));var _={x:(e.x+t.x)/2,y:(e.y+t.y)/2};[p,m,v].forEach((function(e){y=y.concat(function(e,t){return function(e,t){return t<e.minX||t>e.maxX?[]:[{x:t,y:e.minY},{x:t,y:e.maxY}]}(e,t.x).concat(function(e,t){return t<e.minY||t>e.maxY?[]:[{x:e.minX,y:t},{x:e.maxX,y:t}]}(e,t.y))}(e,_).filter((function(e){return qV(e,h)&&qV(e,d)})))})),[{x:f.x,y:g.y},{x:g.x,y:f.y}].forEach((function(e){qV(e,h)&&qV(e,d)&&y.push(e)})),y.unshift(f),y.push(g);var b=function(e,t,n,i,r,o,s){var a=[],l=[t],c={},u={},h={};u[t.id]=0,h[t.id]=YV(t,n,t);var d,f,g,p,m,v={};for(e.forEach((function(e){v[e.id]=e}));l.length;){if(d=void 0,f=1/0,l.forEach((function(e){h[e.id]<=f&&(f=h[e.id],d=e)})),d===n){var y=[];return XV(y,v,c,n.id),y}p=d,m=void 0,(m=(g=l).indexOf(p))>-1&&g.splice(m,1),a.push(d),JV(e,d,i,r).forEach((function(e){if(-1===a.indexOf(e)){-1===l.indexOf(e)&&l.push(e);var i=h[d.id]+$V(d,e);u[e.id]&&i>=u[e.id]||(c[e.id]=d.id,u[e.id]=i,h[e.id]=u[e.id]+YV(e,n,t,o,s))}}))}return[t,n]}(y=VV(y),f,g,o,s,e,t);return b.unshift(e),b.push(t),UV(b)},nU={offset:20,maxAllowedDirectionChange:Math.PI/2,maximumLoops:2e3,gridSize:10,directions:[{stepX:1,stepY:0},{stepX:-1,stepY:0},{stepX:0,stepY:1},{stepX:0,stepY:-1}],get penalties(){return{0:0,45:this.gridSize/2,90:this.gridSize/2}},distFunc:function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},fallbackRoute:function(e,t,n,i,r){return UV(tU(e,t,n,i,r.offset))}},iU=function(e,t){var n=Math.round(Math.abs(e/t));return n<0?0:(e<0?-1:1)*n},rU=function(e,t){var n=t.x-e.x,i=t.y-e.y;return n||i?Math.atan2(i,n):0},oU=function(e,t){var n=Math.abs(e-t);return n>Math.PI?2*Math.PI-n:n},sU=function(e,t,n){for(var i=1/0,r=0,o=t.length;r<o;r++){var s=n(e,t[r]);s<i&&(i=s)}return i},aU=function(e,t,n,i,r){var o=[];if(!n)return[e];var s=r.directions,a=r.offset,l=n.getBBox(),c=t.x>l.minX&&t.x<l.maxX&&t.y>l.minY&&t.y<l.maxY,u=HV(l,a);for(var h in u)u[h]=iU(u[h],r.gridSize);if(c){for(var d=0,f=s;d<f.length;d++){var g=f[d],p=[[{x:u.minX,y:u.minY},{x:u.maxX,y:u.minY}],[{x:u.minX,y:u.minY},{x:u.minX,y:u.maxY}],[{x:u.maxX,y:u.minY},{x:u.maxX,y:u.maxY}],[{x:u.minX,y:u.maxY},{x:u.maxX,y:u.maxY}]];for(h=0;h<4;h++){var m=p[h],v=pg.getLineIntersect(e,{x:e.x+g.stepX*u.width,y:e.y+g.stepY*u.height},m[0],m[1]);v&&!QV(e,v,l)&&(v.id="".concat(v.x,"|||").concat(v.y),o.push(v))}}return o}var y=jV(u,e,i);return y.id="".concat(y.x,"|||").concat(y.y),[y]},lU=function(e,t,n,i){var r=rU(e,t);if(!n[e.id]){var o=rU(i,e);return oU(o,r)}var s=rU({x:n[e.id].x,y:n[e.id].y},e);return oU(s,r)},cU=function(e,t,n,i,r,o,s){var a=[i],l=e.id,c=e.x,u=e.y,h={x:c,y:u,id:l};for(lU(h,o,t,n)&&a.unshift({x:o.x===i.x?i.x:h.x*s,y:o.y===i.y?i.y:h.y*s});t[l]&&t[l].id!==l;){var d={x:c,y:u,id:l},f=t[l].id,g=t[l].x,p=t[l].y,m={x:g,y:p,id:f};lU(m,d,t,n)&&a.unshift({x:m.x===d.x?a[0].x:m.x*s,y:m.y===d.y?a[0].y:m.y*s}),l=f,c=g,u=p}var v=c,y=u;return a[0].x=v===n.x?r.x:a[0].x,a[0].y=y===n.y?r.y:a[0].y,a.unshift(r),a},uU=function(e,t,n,i,r){if(isNaN(e.x)||isNaN(t.x))return[];var o=so(nU,r);o.obstacles=o.obstacles||[];var s=o.gridSize,a=function(e,t,n){var i={};return e.forEach((function(e){if(e)for(var r=HV(e.getBBox(),n),o=iU(r.minX,t);o<=iU(r.maxX,t);o+=1)for(var s=iU(r.minY,t);s<=iU(r.maxY,t);s+=1)i["".concat(o,"|||").concat(s)]=!0})),i}(o.obstacles.concat([n,i]),s,o.offset),l={x:iU(e.x,s),y:iU(e.y,s)},c={x:iU(t.x,s),y:iU(t.y,s)};e.id="".concat(l.x,"|||").concat(l.y),t.id="".concat(c.x,"|||").concat(c.y);var u=aU(l,e,n,c,o),h=aU(c,t,i,l,o);u.forEach((function(e){delete a[e.id]})),h.forEach((function(e){delete a[e.id]}));for(var d={},f={},g={},p={},m={},v=0;v<u.length;v++){var y=u[v];d[y.id]=y,p[y.id]=0,m[y.id]=sU(y,h,o.distFunc)}for(var _,b,w,C,S,x,E,k=o.maximumLoops,L=o.penalties;Object.keys(d).length>0&&k>0&&(_=void 0,b=1/0,Object.keys(d).forEach((function(e){var t=d[e].id;m[t]<=b&&(b=m[t],_=d[t])})),_);){if(h.findIndex((function(e){return e.x===_.x&&e.y===_.y}))>-1)return cU(_,g,l,t,e,c,s);delete d[_.id],f[_.id]=!0;for(v=0;v<o.directions.length;v++)w=o.directions[v],f[(C={x:_.x+w.stepX,y:_.y+w.stepY,id:"".concat(Math.round(_.x)+w.stepX,"|||").concat(Math.round(_.y)+w.stepY)}).id]||(E=lU(_,C,g,l))>o.maxAllowedDirectionChange||a[C.id]||(d[C.id]||(d[C.id]=C),S=o.distFunc(_,C)+(isNaN(L[E])?s:L[E]),x=p[_.id]+S,p[C.id]&&x>=p[C.id]||(g[C.id]=_,p[C.id]=x,m[C.id]=x+sU(C,h,o.distFunc)));k-=1}return o.fallbackRoute(e,t,n,i,o)};_g("polyline",{options:{color:Cg.defaultEdge.color,size:Cg.defaultEdge.size,style:{radius:0,offset:15,x:0,y:0,stroke:Cg.defaultEdge.style.stroke,lineAppendWidth:Cg.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:Cg.edgeLabel.style.fill,fontSize:Cg.edgeLabel.style.fontSize,fontFamily:Cg.windowFontFamily}},routeCfg:{obstacles:[],maxAllowedDirectionChange:Math.PI,maximumLoops:500,gridSize:10},stateStyles:$i({},Cg.edgeStateStyles)},shapeType:"polyline",labelPosition:"center",drawShape:function(e,t){var n=this.getShapeStyle(e);0===n.radius&&delete n.radius;var i=t.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:n});return t.shapeMap["edge-shape"]=i,i},getShapeStyle:function(e){var t=to({},this.options.style,{stroke:e.color},e.style);e=this.getPathPoints(e),this.radius=t.radius,this.offset=t.offset;var n=e.startPoint,i=e.endPoint,r=this.getControlPoints(e),o=[n];r&&(o=o.concat(r)),o.push(i);var s=e.sourceNode,a=e.targetNode,l=t.radius,c=to({},this.options.routeCfg,e.routeCfg);c.offset=t.offset;var u=this.getPath(o,s,a,l,c);return(ar(u)&&u.length<=1||xr(u)&&-1===u.indexOf("L"))&&(u="M0 0, L0 0"),(isNaN(n.x)||isNaN(n.y)||isNaN(i.x)||isNaN(i.y))&&(u="M0 0, L0 0"),to({},Cg.defaultEdge.style,t,{lineWidth:e.size,path:u})},updateShapeStyle:function(e,t){var n=t.getContainer();if(t.isVisible()){var i={stroke:e.color},r=n.shapeMap["edge-shape"]||n.find((function(e){return"edge-shape"===e.get("className")}))||t.getKeyShape(),o=e.size,s=(e=this.getPathPoints(e)).startPoint,a=e.endPoint,l=this.getControlPoints(e),c=[s];l&&(c=c.concat(l)),c.push(a);var u=r.attr(),h=to({},i,u,e.style),d=e.sourceNode,f=e.targetNode,g=h.radius,p=to({},this.options.routeCfg,e.routeCfg);p.offset=h.offset;var m=this.getPath(c,d,f,g,p);(ar(m)&&m.length<=1||xr(m)&&-1===m.indexOf("L"))&&(m="M0 0, L0 0"),(isNaN(s.x)||isNaN(s.y)||isNaN(a.x)||isNaN(a.y))&&(m="M0 0, L0 0"),u.endArrow&&!1===h.endArrow&&(e.style.endArrow={path:""}),u.startArrow&&!1===h.startArrow&&(e.style.startArrow={path:""});var v=to(i,r.attr(),{lineWidth:o,path:m},e.style);r&&r.attr(v)}},getPath:function(e,t,n,i,r){var o=r.offset,s=r.simple;if(!o||e.length>2){if(i)return eU(e,i);var a=[];return cr(e,(function(e,t){0===t?a.push(["M",e.x,e.y]):a.push(["L",e.x,e.y])})),a}var l=s?tU(e[e.length-1],e[0],n,t,o):uU(e[0],e[e.length-1],t,n,r);return l&&l.length?i?eU(l,i):pg.pointsToPolygon(l):"M0 0, L0 0"}},"single-edge");var hU=hB.cloneEvent,dU=hB.isNaN,fU=Math.abs,gU=["shift","ctrl","alt","control"],pU={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,scalableRange:0,allowDragOnItem:!1}},getEvents:function(){return{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"onMouseUp",keyup:"onKeyUp",focus:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onMouseUp"}},updateViewport:function(e){var t=this.origin,n=+e.clientX,i=+e.clientY;if(!dU(n)&&!dU(i)){var r=n-t.x,o=i-t.y;"x"===this.get("direction")?o=0:"y"===this.get("direction")&&(r=0),this.origin={x:n,y:i};var s=this.graph.get("width"),a=this.graph.get("height"),l=this.graph.get("canvas").getCanvasBBox(),c=this.scalableRange,u=this.scalableRange;c<1&&c>-1&&(c*=s,u*=a),(l.minX<=s+c&&l.minX+r>s+c||l.maxX+c>=0&&l.maxX+c+r<0)&&(r=0),(l.minY<=a+u&&l.minY+o>a+u||l.maxY+u>=0&&l.maxY+u+o<0)&&(o=0),this.graph.translate(r,o)}},onTouchStart:function(e){var t=e.originalEvent.touches,n=t[0],i=t[1];n&&i||(e.preventDefault(),this.onMouseDown(e))},onMouseDown:function(e){var t=this,n=e.originalEvent;if((!n||e.name===ug.TOUCHSTART||0===n.button)&&(e.name===ug.TOUCHSTART||"undefined"==typeof window||!window.event||window.event.buttons||window.event.button)&&this.shouldBegin.call(this,e)&&!t.keydown){var i=e.target,r=i&&i.isCanvas&&i.isCanvas();if((this.allowDragOnItem||r)&&(t.origin={x:e.clientX,y:e.clientY},t.dragging=!1,this.enableOptimize)){for(var o=this.graph,s=o.getEdges(),a=0,l=s.length;a<l;a++){var c=s[a].get("group").get("children");c&&c.forEach((function(e){e.set("ori-visibility",e.get("ori-visibility")||e.get("visible")),e.hide()}))}for(var u=o.getNodes(),h=0,d=u.length;h<d;h++)for(var f=0,g=u[h].getContainer().get("children");f<g.length;f++){var p=g[f];p.get("isKeyShape")||(p.set("ori-visibility",p.get("ori-visibility")||p.get("visible")),p.hide())}}}},onTouchMove:function(e){var t=e.originalEvent.touches,n=t[0],i=t[1];n&&i?this.onMouseUp(e):(e.preventDefault(),this.onMouseMove(e))},onMouseMove:function(e){var t=this.graph;if(!this.keydown){var n=e.target,i=n&&n.isCanvas&&n.isCanvas();if((this.allowDragOnItem||i)&&(e=hU(e),this.origin)){if(this.dragging)e.type="drag",t.emit("canvas:drag",e);else{if(fU(this.origin.x-e.clientX)+fU(this.origin.y-e.clientY)<10)return;this.shouldBegin.call(this,e)&&(e.type="dragstart",t.emit("canvas:dragstart",e),this.originPosition={x:e.clientX,y:e.clientY},this.dragging=!0)}this.shouldUpdate.call(this,e)&&this.updateViewport(e)}}},onMouseUp:function(e){var t,n,i=this.graph;if(!this.keydown){var r=i.getZoom(),o=i.get("modeController"),s=null===(n=null===(t=null==o?void 0:o.modes[o.mode])||void 0===t?void 0:t.filter((function(e){return"zoom-canvas"===e.type})))||void 0===n?void 0:n[0],a=s?s.optimizeZoom||.1:0;if(this.enableOptimize){for(var l=i.getEdges(),c=0,u=l.length;c<u;c++){var h=l[c].get("group").get("children");h&&h.forEach((function(e){e.get("ori-visibility")&&e.show()}))}if(r>a)for(var d=i.getNodes(),f=0,g=d.length;f<g;f++)for(var p=0,m=d[f].getContainer().get("children");p<m.length;p++){var v=m[p];if(!v.get("isKeyShape"))v.get("ori-visibility")&&v.show()}}this.dragging?(e=hU(e),this.shouldEnd.call(this,e)&&this.updateViewport(e),e.type="dragend",e.dx=e.clientX-this.originPosition.x,e.dy=e.clientY-this.originPosition.y,i.emit("canvas:dragend",e),this.endDrag()):this.origin=null}},endDrag:function(){this.origin=null,this.dragging=!1,this.dragbegin=!1},onKeyDown:function(e){var t=e.key;t&&(gU.indexOf(t.toLowerCase())>-1?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.keydown=!1,this.origin=null,this.dragging=!1,this.dragbegin=!1}},mU={getDefaultCfg:function(){return{updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected",enableOptimize:!1,enableDebounce:!1,enableStack:!0}},getEvents:function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave","combo:drop":"onDropCombo","node:drop":"onDropNode","canvas:drop":"onDropCanvas",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onDragEnd"}},validationCombo:function(e){return!(!this.origin||!e||e.destroyed)&&"combo"===e.getType()},onTouchStart:function(e){if(e.item){try{var t=e.originalEvent.touches,n=t[0],i=t[1];if(n&&i)return;e.preventDefault()}catch(r){console.warn("Touch original event not exist!")}this.onDragStart(e)}},onTouchMove:function(e){try{var t=e.originalEvent.touches,n=t[0],i=t[1];if(n&&i)return void this.onDragEnd(e);e.preventDefault()}catch(r){console.warn("Touch original event not exist!")}this.onDrag(e)},onDragStart:function(e){var t=this;if(this.currentShouldEnd=!0,this.shouldBegin.call(this,e)){var n=e.item;if(n&&!n.destroyed&&!n.hasLocked()){n.getContainer().set("capture",!1),this.cachedCaptureItems||(this.cachedCaptureItems=[]),this.cachedCaptureItems.push(n);var i=e.target;if(i)if(i.get("isAnchorPoint"))return;var r=this.graph;this.targets=[],this.targetCombo=null;var o=r.findAllByState("node",this.selectedState),s=n.get("id");0===o.filter((function(e){var t=e.get("id");return s===t})).length?this.targets.push(n):o.length>1?o.forEach((function(e){e.hasLocked()||t.targets.push(e)})):this.targets.push(n);var a=[];this.targets.forEach((function(e){a.push(no(e.getModel()))})),this.set("beforeDragNodes",a),this.hidenEdge={},this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach((function(e){e.getEdges().forEach((function(e){e.isVisible()&&(t.hidenEdge[e.getID()]=!0,e.hide())}))})),this.origin={x:e.x,y:e.y},this.point={},this.originPoint={}}}},onDrag:function(e){var t=this;this.origin&&this.shouldUpdate.call(this,e)&&(this.get("enableDelegate")?this.updateDelegate(e):this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:e,updateEdge:this.get("updateEdge")}):this.targets.map((function(n){t.update(n,e)})))},onDragEnd:function(e){var t,n=this;if(this.origin){null===(t=this.cachedCaptureItems)||void 0===t||t.forEach((function(e){e.getContainer().set("capture",!0)})),this.cachedCaptureItems=[],this.delegateRect&&(this.delegateRect.remove(),this.delegateRect=null),this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach((function(e){e.getEdges().forEach((function(e){n.hidenEdge[e.getID()]&&e.show(),e.refresh()}))})),this.hidenEdge={};var i=this.graph;if(i.get("enabledStack")&&this.enableStack){var r={before:{nodes:[],edges:[],combos:[]},after:{nodes:[],edges:[],combos:[]}};this.get("beforeDragNodes").forEach((function(e){r.before.nodes.push({id:e.id,x:e.x,y:e.y})})),this.targets.forEach((function(e){var t=e.getModel();r.after.nodes.push({id:t.id,x:t.x,y:t.y})})),i.pushStack("update",no(r))}i.emit("dragnodeend",{items:this.targets,targetItem:null}),this.point={},this.origin=null,this.originPoint={},this.targets.length=0,this.targetCombo=null}},onDropCombo:function(e){var t=e.item;if(this.currentShouldEnd=this.shouldEnd.call(this,e,t),this.updatePositions(e,!this.currentShouldEnd),this.currentShouldEnd&&this.validationCombo(t)){var n=this.graph;if(this.comboActiveState&&n.setItemState(t,this.comboActiveState,!1),this.targetCombo=t,this.onlyChangeComboSize)n.updateCombos();else{var i=t.getModel();this.targets.map((function(e){e.getModel().comboId!==i.id&&n.updateComboTree(e,i.id)})),n.updateCombo(t)}n.emit("dragnodeend",{items:this.targets,targetItem:this.targetCombo})}},onDropCanvas:function(e){var t=this.graph;this.currentShouldEnd=this.shouldEnd.call(this,e,void 0),this.updatePositions(e,!this.currentShouldEnd),this.targets&&0!==this.targets.length&&this.currentShouldEnd&&(this.onlyChangeComboSize?t.updateCombos():this.targets.map((function(e){e.getModel().comboId&&t.updateComboTree(e)})))},onDropNode:function(e){if(this.targets&&0!==this.targets.length){var t=this,n=e.item,i=t.graph,r=n.getModel().comboId,o=r?i.findById(r):void 0;if(this.currentShouldEnd=this.shouldEnd.call(this,e,o),this.updatePositions(e,!this.currentShouldEnd),this.currentShouldEnd){if(this.onlyChangeComboSize)i.updateCombos();else if(r){var s=i.findById(r);t.comboActiveState&&i.setItemState(s,t.comboActiveState,!1),this.targets.map((function(e){var t=e.getModel();r!==t.comboId&&i.updateComboTree(e,r)})),i.updateCombo(s)}else this.targets.map((function(e){e.getModel().comboId&&i.updateComboTree(e)}));i.emit("dragnodeend",{items:this.targets,targetItem:n})}}},onDragEnter:function(e){var t=e.item;if(this.validationCombo(t)){var n=this.graph;this.comboActiveState&&n.setItemState(t,this.comboActiveState,!0)}},onDragLeave:function(e){var t=e.item;if(this.validationCombo(t)){var n=this.graph;this.comboActiveState&&n.setItemState(t,this.comboActiveState,!1)}},updatePositions:function(e,t){var n=this;this.targets&&0!==this.targets.length&&(this.get("enableDelegate")?this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:e,updateEdge:this.get("updateEdge"),updateFunc:this.update}):t||this.targets.map((function(t){return n.update(t,e)})):this.targets.map((function(i){return n.update(i,e,t)})))},update:function(e,t,n){var i=this.origin,r=e.get("model"),o=e.get("id");this.point[o]||(this.point[o]={x:r.x||0,y:r.y||0});var s=t.x-i.x+this.point[o].x,a=t.y-i.y+this.point[o].y;n&&(s+=i.x-t.x,a+=i.y-t.y);var l={x:s,y:a};this.get("updateEdge")?this.graph.updateItem(e,l,!1):e.updatePosition(l)},debounceUpdate:io((function(e){var t=e.targets,n=e.graph,i=e.point,r=e.origin,o=e.evt,s=e.updateEdge;e.updateFunc,t.map((function(e){var t=e.get("model"),a=e.get("id");i[a]||(i[a]={x:t.x||0,y:t.y||0});var l={x:o.x-r.x+i[a].x,y:o.y-r.y+i[a].y};s?n.updateItem(e,l,!1):e.updatePosition(l)}))}),50,!0),updateDelegate:function(e){var t=this.graph;if(this.delegateRect){var n=e.x-this.origin.x+this.originPoint.minX,i=e.y-this.origin.y+this.originPoint.minY;this.delegateRect.attr({x:n,y:i})}else{var r=t.get("group"),o=so({},cb.delegateStyle,this.delegateStyle),s=this.calculationGroupPosition(e),a=s.x,l=s.y,c=s.width,u=s.height,h=s.minX,d=s.minY;this.originPoint={x:a,y:l,width:c,height:u,minX:h,minY:d},this.delegateRect=r.addShape("rect",{attrs:$i({width:c,height:u,x:a,y:l},o),name:"rect-delegate-shape"}),this.delegate=this.delegateRect,this.delegateRect.set("capture",!1)}},calculationGroupPosition:function(e){var t=this.targets;0===t.length&&t.push(e.item);for(var n=1/0,i=-1/0,r=1/0,o=-1/0,s=0;s<t.length;s++){var a=t[s].getBBox(),l=a.minX,c=a.minY,u=a.maxX,h=a.maxY;l<n&&(n=l),c<r&&(r=c),u>i&&(i=u),h>o&&(o=h)}return{x:Math.floor(n),y:Math.floor(r),width:Math.ceil(i)-Math.floor(n),height:Math.ceil(o)-Math.floor(r),minX:n,minY:r}}},vU={getDefaultCfg:function(){return{trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,shouldUpdate:function(){return!0}}},getEvents:function(){return"mouseenter"===this.get("trigger")?{"node:mouseenter":"setAllItemStates","combo:mouseenter":"setAllItemStates","node:mouseleave":"clearActiveState","combo:mouseleave":"clearActiveState"}:{"node:click":"setAllItemStates","combo:click":"setAllItemStates","canvas:click":"clearActiveState","node:touchstart":"setOnTouchStart","combo:touchstart":"setOnTouchStart","canvas:touchstart":"clearOnTouchStart"}},setOnTouchStart:function(e){try{var t=e.originalEvent.touches,n=t[0],i=t[1];if(n&&i)return;e.preventDefault()}catch(r){console.warn("Touch original event not exist!")}this.setAllItemStates(e)},clearOnTouchStart:function(e){try{var t=e.originalEvent.touches,n=t[0],i=t[1];if(n&&i)return;e.preventDefault()}catch(r){console.warn("Touch original event not exist!")}this.clearActiveState(e)},setAllItemStates:function(e){var t=e.item,n=this.graph;if(this.item=t,this.shouldUpdate(e.item,{event:e,action:"activate"})){for(var i=this.activeState,r=this.inactiveState,o=n.getNodes(),s=n.getCombos(),a=n.getEdges(),l=n.get("vedges"),c=o.length,u=s.length,h=a.length,d=l.length,f=0;f<c;f++){var g=o[f],p=g.hasState("selected");this.resetSelected&&p&&n.setItemState(g,"selected",!1),n.setItemState(g,i,!1),r&&n.setItemState(g,r,!0)}for(f=0;f<u;f++){var m=s[f];p=m.hasState("selected");this.resetSelected&&p&&n.setItemState(m,"selected",!1),n.setItemState(m,i,!1),r&&n.setItemState(m,r,!0)}for(f=0;f<h;f++){var v=a[f];n.setItemState(v,i,!1),r&&n.setItemState(v,r,!0)}for(f=0;f<d;f++){var y=l[f];n.setItemState(y,i,!1),r&&n.setItemState(y,r,!0)}r&&n.setItemState(t,r,!1),n.setItemState(t,i,!0);var _=t.getEdges(),b=_.length;for(f=0;f<b;f++){var w=void 0;w=(v=_[f]).getSource()===t?v.getTarget():v.getSource(),r&&n.setItemState(w,r,!1),n.setItemState(w,i,!0),n.setItemState(v,r,!1),n.setItemState(v,i,!0),v.toFront()}n.emit("afteractivaterelations",{item:e.item,action:"activate"})}},clearActiveState:function(e){var t=this,n=t.get("graph");if(t.shouldUpdate(e.item,{event:e,action:"deactivate"})){var i=this.activeState,r=this.inactiveState,o=n.get("autoPaint");n.setAutoPaint(!1);for(var s=n.getNodes()||[],a=n.getCombos()||[],l=n.getEdges()||[],c=n.get("vedges")||[],u=s.length,h=a.length,d=l.length,f=c.length,g=0;g<u;g++){var p=s[g];n.clearItemStates(p,[i,r])}for(g=0;g<h;g++){var m=a[g];n.clearItemStates(m,[i,r])}for(g=0;g<d;g++){var v=l[g];n.clearItemStates(v,[i,r,"deactivate"])}for(g=0;g<f;g++){var y=c[g];n.clearItemStates(y,[i,r,"deactivate"])}n.paint(),n.setAutoPaint(o),n.emit("afteractivaterelations",{item:e.item||t.get("item"),action:"deactivate"})}}},yU=Math.min,_U=Math.max,bU=Math.abs,wU=["drag","shift","ctrl","alt","control"],CU={getDefaultCfg:function(){return{brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:"shift",includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return wU.indexOf(this.trigger.toLowerCase())>-1||(this.trigger="shift",console.warn("Behavior brush-select 的 trigger 参数不合法，请输入 'drag'、'shift'、'ctrl' 或 'alt'")),"drag"===this.trigger?{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates"}:{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates",keyup:"onKeyUp",keydown:"onKeyDown"}},onMouseDown:function(e){var t=e.item,n=this.brush;t||("drag"===this.trigger||this.keydown)&&(this.selectedNodes&&0!==this.selectedNodes.length&&this.clearStates(),n||(n=this.createBrush()),this.originPoint={x:e.canvasX,y:e.canvasY},n.attr({width:0,height:0}),n.show(),this.dragging=!0)},onMouseMove:function(e){this.dragging&&("drag"===this.trigger||this.keydown)&&this.updateBrush(e)},onMouseUp:function(e){this.graph,(this.brush||this.dragging)&&("drag"===this.trigger||this.keydown)&&(this.brush.remove(!0),this.brush=null,this.getSelectedNodes(e),this.dragging=!1)},clearStates:function(){var e=this.graph,t=this.selectedState,n=e.findAllByState("node",t),i=e.findAllByState("edge",t);n.forEach((function(n){return e.setItemState(n,t,!1)})),i.forEach((function(n){return e.setItemState(n,t,!1)})),this.selectedNodes=[],this.selectedEdges=[],this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),e.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedNodes:function(e){var t=this,n=this,i=n.graph,r=n.originPoint,o=n.shouldUpdate,s=this.selectedState,a={x:e.x,y:e.y},l=i.getPointByCanvas(r.x,r.y),c=yU(a.x,l.x),u=_U(a.x,l.x),h=yU(a.y,l.y),d=_U(a.y,l.y),f=[],g=[];i.getNodes().forEach((function(e){if(e.isVisible()){var t=e.getBBox();if(t.centerX>=c&&t.centerX<=u&&t.centerY>=h&&t.centerY<=d&&o(e,"select")){f.push(e);var n=e.getModel();g.push(n.id),i.setItemState(e,s,!0)}}}));var p=[];this.includeEdges&&f.forEach((function(e){e.getOutEdges().forEach((function(e){if(e.isVisible()){var n=e.getModel(),r=n.source,s=n.target;g.includes(r)&&g.includes(s)&&o(e,"select")&&(p.push(e),i.setItemState(e,t.selectedState,!0))}}))})),this.selectedEdges=p,this.selectedNodes=f,this.onSelect&&this.onSelect(f,p),i.emit("nodeselectchange",{selectedItems:{nodes:f,edges:p},select:!0})},createBrush:function(){var e=this.graph.get("canvas").addShape("rect",{attrs:this.brushStyle,capture:!1,name:"brush-shape"});return this.brush=e,this.delegate=e,e},updateBrush:function(e){var t=this.originPoint;this.brush.attr({width:bU(e.canvasX-t.x),height:bU(e.canvasY-t.y),x:yU(e.canvasX,t.x),y:yU(e.canvasY,t.y)})},onKeyDown:function(e){var t=e.key;if(t){var n=this.trigger.toLowerCase(),i=t.toLowerCase();this.keydown=i===n||"control"===i&&"ctrl"===n||"ctrl"===i&&"control"===n}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.keydown=!1}},SU=["shift","ctrl","alt","control"],xU={getDefaultCfg:function(){return{multiple:!0,trigger:"shift",selectedState:"selected"}},getEvents:function(){var e=this;return SU.indexOf(e.trigger.toLowerCase())>-1||(e.trigger="shift",console.warn("Behavior brush-select 的 trigger 参数不合法，请输入 'drag'、'shift'、'ctrl' 或 'alt'")),e.multiple?{"node:click":"onClick","combo:click":"onClick","canvas:click":"onCanvasClick",keyup:"onKeyUp",keydown:"onKeyDown"}:{"node:click":"onClick","combo:click":"onClick","canvas:click":"onCanvasClick"}},onClick:function(e){var t=this,n=e.item;if(n&&!n.destroyed){n.getType();var i=t.graph,r=t.keydown,o=t.multiple,s=t.shouldUpdate;if(t.shouldBegin.call(t,e)){if(!r||!o)cr(i.findAllByState("node",t.selectedState).concat(i.findAllByState("combo",t.selectedState)),(function(e){e!==n&&i.setItemState(e,t.selectedState,!1)}));if(n.hasState(t.selectedState)){s.call(t,e)&&i.setItemState(n,t.selectedState,!1);var a=i.findAllByState("node",t.selectedState),l=i.findAllByState("combo",t.selectedState);i.emit("nodeselectchange",{target:n,selectedItems:{nodes:a,combos:l},select:!1})}else{s.call(t,e)&&i.setItemState(n,t.selectedState,!0);a=i.findAllByState("node",t.selectedState),l=i.findAllByState("combo",t.selectedState);i.emit("nodeselectchange",{target:n,selectedItems:{nodes:a,combos:l},select:!0})}}}},onCanvasClick:function(e){var t=this,n=this.graph;this.shouldBegin.call(this,e)&&(cr(n.findAllByState("node",this.selectedState),(function(e){n.setItemState(e,t.selectedState,!1)})),cr(n.findAllByState("combo",this.selectedState),(function(e){n.setItemState(e,t.selectedState,!1)})),n.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1}))},onKeyDown:function(e){var t=e.key;t&&(t.toLowerCase()===this.trigger.toLowerCase()||"control"===t.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.keydown=!1}},EU=Us,kU={getDefaultCfg:function(){return{sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"},animate:!1,animateCfg:{duration:500}}},getEvents:function(){var e=this.fixSelectedItems;return e.fixState||(e.fixState="selected"),e.fixAll&&(e.fixLineWidth=!0,e.fixLabel=!0),{wheel:"onWheel",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd"}},onTouchStart:function(e){var t=e.originalEvent.touches,n=t[0],i=t[1];e.preventDefault(),i&&(this.shouldBegin&&!this.shouldBegin.call(this,e)||(this.startPoint={pageX:n.pageX,pageY:n.pageY},this.moveable=!0,i&&(this.endPoint={pageX:i.pageX,pageY:i.pageY}),this.originScale=this.graph.getZoom()||this.currentScale||1))},onTouchMove:function(e){if(this.moveable){e.preventDefault();var t=e.originalEvent.touches,n=t[0],i=t[1];if(i){this.endPoint||(this.endPoint={pageX:i.pageX,pageY:i.pageY});var r=function(e,t){return Math.hypot(t.x-e.x,t.y-e.y)},o=r({x:n.pageX,y:n.pageY},{x:i.pageX,y:i.pageY})/r({x:this.startPoint.pageX,y:this.startPoint.pageY},{x:this.endPoint.pageX,y:this.endPoint.pageY}),s=this.originScale*o;this.currentScale=s;var a=this.get("minZoom")||this.graph.get("minZoom");if(!(s>(this.get("maxZoom")||this.graph.get("maxZoom"))||s<a)){var l=this.get("animate"),c=this.get("animateCfg"),u=this.graph.get("canvas").getPointByClient(e.clientX,e.clientY);this.graph.zoomTo(s,{x:u.x,y:u.y},l,c),this.graph.emit("wheelzoom",e)}}}},onTouchEnd:function(){this.moveable=!1,this.endPoint=null},onWheel:function(e){var t=this,n=this.graph,i=this.fixSelectedItems;if((!this.shouldBegin||this.shouldBegin.call(this,e))&&this.shouldUpdate.call(this,e)){e.preventDefault();var r,o=n.get("canvas").getPointByClient(e.clientX,e.clientY),s=this.get("sensitivity"),a=n.getZoom();r=a*(e.wheelDelta<0?1-.05*s:1/(1-.05*s));var l=this.get("minZoom")||n.get("minZoom");if(!(r>(this.get("maxZoom")||n.get("maxZoom"))||r<l)){if(this.get("enableOptimize")){var c=this.get("optimizeZoom"),u=this.get("optimized"),h=n.getNodes(),d=n.getEdges(),f=h.length,g=d.length;if(!u){for(var p=0;p<f;p++){if(!(E=h[p]).destroyed)for(var m=(q=E.get("group").get("children")).length,v=0;v<m;v++){(R=q[v]).destoryed||R.get("isKeyShape")||(R.set("ori-visibility",R.get("ori-visibility")||R.get("visible")),R.hide())}}for(var y=0;y<g;y++)for(m=(q=(K=d[y]).get("group").get("children")).length,v=0;v<m;v++){(R=q[v]).set("ori-visibility",R.get("ori-visibility")||R.get("visible")),R.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var _=setTimeout((function(){var e=n.getZoom();if(t.get("optimized")){t.set("optimized",!1);for(var i=0;i<f;i++){var r=h[i],o=(u=r.get("group").get("children")).length;if(e<c)(a=(p=r.getKeyShape()).get("ori-visibility"))&&p.show();else for(var s=0;s<o;s++){var a=(v=u[s]).get("ori-visibility");!v.get("visible")&&a&&a&&v.show()}}for(var l=0;l<g;l++){var u,p,m=d[l];o=(u=m.get("group").get("children")).length;if(e<c)(a=(p=m.getKeyShape()).get("ori-visibility"))&&p.show();else for(s=0;s<o;s++){var v;if(!(v=u[s]).get("visible"))(a=v.get("ori-visibility"))&&v.show()}}}}),100);this.set("timeout",_)}if(a<=1){var b=void 0,w=void 0;if(i.fixAll||i.fixLineWidth||i.fixLabel){b=n.findAllByState("node",i.fixState),w=n.findAllByState("edge",i.fixState);for(var C=a/r,S=b.length,x=0;x<S;x++){var E,k=(E=b[x]).getContainer(),L=E.getModel(),D=E.getOriginStyle(),N=E.getStateStyle(i.fixState),I=E.get("shapeFactory").getShape(L.type).getStateStyle(i.fixState,E)[i.fixState];if(i.fixAll){if(r<=1){var T=no(k.getMatrix());T||(T=[1,0,0,0,1,0,0,0,1]);var M=E.getModel(),A=M.x,O=M.y;T=EU(T,[["t",-A,-O],["s",C,C],["t",A,O]]),k.setMatrix(T)}}else for(m=(q=k.get("children")).length,v=0;v<m;v++){var R=q[v],P=void 0,F=void 0;if(i.fixLabel)if("text"===R.get("type")){P=R.attr("fontSize")||12;var B=N[R.get("name")],W=I[R.get("name")],z=B?B.fontSize:12,V=W?W.fontSize:12,U=z||V||12;if(r<=1&&R.attr("fontSize",U/r),F)break}if(i.fixLineWidth&&R.get("isKeyShape")){F=R.attr("lineWidth")||0;var H=N.lineWidth||I.lineWidth||D.lineWidth||0;if(r<=1&&R.attr("lineWidth",H/r),P)break}}}for(var j=w.length,G=0;G<j;G++){var K,q=(k=(K=w[G]).getContainer()).get("children");for(L=K.getModel(),N=K.getStateStyle(i.fixState),I=K.get("shapeFactory").getShape(L.type).getStateStyle(i.fixState,K)[i.fixState],m=q.length,v=0;v<m;v++){R=q[v],P=void 0,F=void 0;if(i.fixLabel||i.fixAll)if("text"===R.get("type")){P=R.attr("fontSize")||12;B=N[R.get("name")],W=I[R.get("name")],z=B?B.fontSize:12,V=W?W.fontSize:12,U=z||V||12;if(r<=1&&R.attr("fontSize",U/r),F)break}if((i.fixLineWidth||i.fixAll)&&R.get("isKeyShape")){F=R.attr("lineWidth")||0;H=N.lineWidth||I.lineWidth||1;if(r<=1&&R.attr("lineWidth",H/r),P)break}}}}}var $=this.get("animate"),Y=this.get("animateCfg");n.zoomTo(r,{x:o.x,y:o.y},$,Y),n.emit("wheelzoom",e)}}}},LU={onMouseEnter:function(e){var t=e.item;this.currentTarget=t,this.showTooltip(e),this.graph.emit("tooltipchange",{item:e.item,action:"show"})},onMouseMove:function(e){this.shouldUpdate(e)?this.currentTarget&&e.item===this.currentTarget&&this.updatePosition(e):this.hideTooltip()},onMouseLeave:function(e){this.shouldEnd(e)&&(this.hideTooltip(),this.graph.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null)},showTooltip:function(e){var t=this.container;if(e.item&&!e.item.destroyed){t||(t=this.createTooltip(this.graph.get("canvas")),this.container=t);var n=this.formatText(e.item.get("model"),e);t.innerHTML=n,db(this.container,{visibility:"visible"}),this.updatePosition(e)}},hideTooltip:function(){db(this.container,{visibility:"hidden"})},updatePosition:function(e){var t=this.get("shouldBegin"),n=this,i=n.width,r=n.height,o=n.container,s=n.graph;if(t(e)){var a=s.getPointByClient(e.clientX,e.clientY),l=s.getCanvasByPoint(a.x,a.y),c=l.x,u=l.y,h=o.getBoundingClientRect();c>i/2?c-=h.width:c+=this.offset,u>r/2?u-=h.height:u+=this.offset;var d="".concat(c,"px"),f="".concat(u,"px");db(this.container,{left:d,top:f,visibility:"visible"})}else db(o,{visibility:"hidden"})},createTooltip:function(e){var t=e.get("el");t.style.position="relative";var n=hb('<div class="g6-tooltip g6-'.concat(this.item,'-tooltip"></div>'));return t.parentNode.appendChild(n),db(n,{position:"absolute",visibility:"visible"}),this.width=e.get("width"),this.height=e.get("height"),this.container=n,this.graph.get("tooltips").push(n),n}},DU=$i({getDefaultCfg:function(){return{item:"node",offset:12,formatText:function(e){return e.label}}},getEvents:function(){return{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},LU),NU=$i({getDefaultCfg:function(){return{item:"edge",offset:12,formatText:function(e){return"source: ".concat(e.source," target: ").concat(e.target)}}},getEvents:function(){return{"edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},LU),IU=["click","dblclick"],TU={getDefaultCfg:function(){return{trigger:"click",onChange:function(){}}},getEvents:function(){var e,t;return IU.includes(this.trigger)?t=this.trigger:(t="click",console.warn("Behavior collapse-expand 的 trigger 参数不合法，请输入 'click' 或 'dblclick'")),(e={})["node:".concat(t)]="onNodeClick",e.touchstart="onNodeClick",e},onNodeClick:function(e){var t=e.item;if(t){var n=this.graph.findDataById(t.get("id"));if(n){var i=n.children;if(i&&0!==i.length){var r=!n.collapsed;this.shouldBegin(e,r)&&(n.collapsed=r,t.getModel().collapsed=r,this.graph.emit("itemcollapsed",{item:e.item,collapsed:r}),this.shouldUpdate(e,r)&&(this.onChange(t,r),this.graph.layout()))}}}}},MU=hB.calculationItemsBBox,AU=function e(t,n){if(!1!==n(t)&&t){var i=t.get("combos");if(0===i.length)return!1;cr(i,(function(t){e(t,n)}))}},OU={getDefaultCfg:function(){return{enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected"}},getEvents:function(){return{"combo:dragstart":"onDragStart","combo:drag":"onDrag","combo:dragend":"onDragEnd","combo:drop":"onDrop","node:drop":"onNodeDrop","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave"}},validationCombo:function(e){var t=e.item;return!(!t||t.destroyed)&&(!!this.shouldUpdate.call(this,e)&&"combo"===t.getType())},onDragStart:function(e){var t=this,n=this.graph,i=e.item;if(this.currentShouldEnd=!0,this.validationCombo(e)){this.targets=[];var r=n.findAllByState("combo",this.selectedState),o=i.get("id");0===r.filter((function(e){var t=e.get("id");return o===t})).length?this.targets.push(i):this.targets=r,this.activeState&&this.targets.map((function(e){var i=e.getModel();if(i.parentId){var r=n.findById(i.parentId);r&&n.setItemState(r,t.activeState,!0)}})),this.point={},this.originPoint={},this.origin={x:e.x,y:e.y},this.currentItemChildCombos=[],AU(i,(function(e){if(e.destroyed)return!1;var n=e.getModel();return t.currentItemChildCombos.push(n.id),!0}))}},onDrag:function(e){var t=this;if(this.origin&&this.validationCombo(e))if(this.enableDelegate)this.updateDelegate(e);else{if(this.activeState){var n=this.graph,i=e.item,r=i.getModel(),o=n.getCombos(),s=i.getBBox(),a=s.centerX,l=s.centerY,c=s.width;o.filter((function(e){var n=e.getModel();return r.parentId,n.id!==r.id&&!t.currentItemChildCombos.includes(n.id)})).map((function(e){var i=e.getBBox(),r=i.centerX,o=i.centerY,s=i.width,u=a-r,h=l-o,d=2*Math.sqrt(u*u+h*h);c+s-d>.8*c?n.setItemState(e,t.activeState,!0):n.setItemState(e,t.activeState,!1)}))}cr(this.targets,(function(n){t.updateCombo(n,e)}))}},updatePositions:function(e,t){var n=this;(this.enableDelegate||t)&&cr(this.targets,(function(i){n.updateCombo(i,e,t)}))},onDrop:function(e){var t=this,n=e.item;if(this.currentShouldEnd=this.shouldEnd.call(this,e,n),this.updatePositions(e,!this.currentShouldEnd),this.currentShouldEnd&&n&&this.targets&&!n.destroyed){var i=this.graph,r=n.getModel();this.targets.map((function(e){e.getModel().parentId!==r.id?(t.activeState&&i.setItemState(n,t.activeState,!1),t.onlyChangeComboSize?i.updateCombo(e):i.updateComboTree(e,r.id)):i.updateCombo(n)})),this.end(n,e),this.endComparison=!0}},onNodeDrop:function(e){var t=this;if(this.targets&&0!==this.targets.length){var n=this.graph,i=e.item.getModel().comboId,r=i?n.findById(i):void 0;if(this.currentShouldEnd=this.shouldEnd.call(this,e,r),this.updatePositions(e,!this.currentShouldEnd),this.currentShouldEnd){var o;if(i){if(this.activeState){var s=n.findById(i);n.setItemState(s,this.activeState,!1)}this.targets.map((function(e){t.onlyChangeComboSize?n.updateCombo(e):i!==e.getID()&&(o=n.findById(i),i!==e.getModel().parentId&&n.updateComboTree(e,i))}))}else this.targets.map((function(e){t.onlyChangeComboSize?n.updateCombo(e):e.getModel().comboId&&n.updateComboTree(e)}));this.endComparison=!0,this.end(o,e)}}},onDragEnter:function(e){if(this.origin&&this.validationCombo(e)){var t=e.item,n=this.graph;this.activeState&&n.setItemState(t,this.activeState,!0)}},onDragLeave:function(e){if(this.origin&&this.validationCombo(e)){var t=e.item,n=this.graph;this.activeState&&n.setItemState(t,this.activeState,!1)}},onDragEnd:function(e){if(this.targets&&0!==this.targets.length){var t=e.item;this.currentShouldEnd&&this.updatePositions(e);var n=this.getParentCombo(t.getModel().parentId),i=this.graph;n&&this.activeState&&i.setItemState(n,this.activeState,!1),this.end(void 0,e)}},end:function(e,t){var n=this;if(this.origin){var i=this.graph;if(this.delegateShape)i.get("delegateGroup").clear(),this.delegateShape=null;e&&this.activeState&&i.setItemState(e,this.activeState,!1),e||this.targets.map((function(e){n.onlyChangeComboSize?i.updateCombo(e):i.updateComboTree(e)})),this.point=[],this.origin=null,this.originPoint=null,this.targets.length=0}},traverse:function(e,t){var n=this;!1!==t(e)&&(e&&(cr(e.get("combos"),(function(e){n.traverse(e,t)})),cr(e.get("nodes"),(function(e){n.traverse(e,t)}))))},updateCombo:function(e,t,n){var i=this;this.traverse(e,(function(e){return!e.destroyed&&(i.updateSignleItem(e,t,n),!0)}))},updateSignleItem:function(e,t,n){var i=this.origin,r=this.graph,o=e.getModel(),s=e.get("id");this.point[s]||(this.point[s]={x:o.x,y:o.y});var a=t.x-i.x+this.point[s].x,l=t.y-i.y+this.point[s].y;n&&(a+=i.x-t.x,l+=i.y-t.y),r.updateItem(e,{x:a,y:l})},getParentCombo:function(e){var t=this.graph;if(e){var n=t.findById(e);if(n)return n}},updateDelegate:function(e){var t=this.graph;if(this.delegateShape){var n=e.x-this.origin.x+this.originPoint.minX,i=e.y-this.origin.y+this.originPoint.minY;this.delegateShape.attr({x:n,y:i})}else{var r=t.get("delegateGroup"),o=null,s=(o=this.targets.length>1?MU(this.targets):this.targets[0].getBBox()).x,a=o.y,l=o.width,c=o.height,u=o.minX,h=o.minY;this.originPoint={x:s,y:a,width:l,height:c,minX:u,minY:h};var d=$i($i({},cb.delegateStyle),this.delegateStyle);this.delegateShape=r.addShape("rect",{attrs:$i({width:o.width,height:o.height,x:o.x,y:o.y},d),name:"combo-delegate-shape"}),this.delegateShape.set("capture",!1),this.delegate=this.delegateShape}}},RU=["click","dblclick"],PU={getDefaultCfg:function(){return{trigger:"dblclick",relayout:!0}},getEvents:function(){var e,t;return RU.includes(this.trigger)?t=this.trigger:(t="dblclick",console.warn("Behavior collapse-expand-group 的 trigger 参数不合法，请输入 'click' 或 'dblclick'")),(e={})["combo:".concat(t)]="onComboClick",e},onComboClick:function(e){var t=e.item,n=this.graph,i=this.relayout;if(t&&!t.destroyed&&"combo"===t.getType()){var r=t.getModel().id;r&&(n.collapseExpandCombo(r),i&&n.get("layout")?n.layout():n.refreshPositions())}}},FU=hB.isPolygonsIntersect,BU=hB.pathToPoints,WU=["drag","shift","ctrl","alt","control"],zU=["click","drag"],VU=["shift","ctrl","control","alt","meta",void 0],UU=["shift","ctrl","alt","control"],HU=["shift","ctrl","alt","control"];cr({"drag-canvas":pU,"zoom-canvas":kU,"drag-node":mU,"activate-relations":vU,"brush-select":CU,"click-select":xU,"lasso-select":{getDefaultCfg:function(){return{delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:"shift",includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return WU.indexOf(this.trigger.toLowerCase())>-1||(this.trigger="shift",console.warn("Behavior lasso-select 的 trigger 参数不合法，请输入 'drag'、'shift'、'ctrl' 或 'alt'")),"drag"===this.trigger?{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd","canvas:click":"clearStates"}:{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd",keyup:"onKeyUp",keydown:"onKeyDown","canvas:click":"clearStates"}},onDragStart:function(e){var t=this.lasso;e.item||("drag"===this.trigger||this.keydown)&&(this.selectedNodes&&0!==this.selectedNodes.length&&this.clearStates(),t||(t=this.createLasso()),this.dragging=!0,this.originPoint={x:e.x,y:e.y},this.points.push(this.originPoint),t.show())},onDragMove:function(e){this.dragging&&("drag"===this.trigger||this.keydown)&&(this.points.push({x:e.x,y:e.y}),this.updateLasso(e))},onDragEnd:function(e){(this.lasso||this.dragging)&&("drag"===this.trigger||this.keydown)&&(this.points.push(this.originPoint),this.getSelectedItems(),this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1)},getLassoPath:function(){var e=this.points,t=[];return e.length&&(e.forEach((function(e,n){0===n?t.push(["M",e.x,e.y]):t.push(["L",e.x,e.y])})),t.push(["L",e[0].x,e[0].y])),t},clearStates:function(){var e=this.graph,t=this.selectedState,n=e.findAllByState("node",t),i=e.findAllByState("edge",t);n.forEach((function(n){return e.setItemState(n,t,!1)})),i.forEach((function(n){return e.setItemState(n,t,!1)})),this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),this.selectedNodes=[],this.selectedEdges=[],e.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedItems:function(){var e=this,t=this.graph,n=this.shouldUpdate,i=this.points.map((function(e){return[t.getCanvasByPoint(e.x,e.y).x,t.getCanvasByPoint(e.x,e.y).y]})),r=this.selectedState,o=[],s=[];t.getNodes().forEach((function(e){if(e.isVisible()&&function(e,t){var n,i=e.getKeyShape();if("path"===e.get("type"))n=BU(i.attr("path"));else{var r=i.getCanvasBBox();n=[[r.minX,r.minY],[r.maxX,r.minY],[r.maxX,r.maxY],[r.minX,r.maxY]]}return FU(t,n)}(e,i)&&n(e,"select")){o.push(e);var a=e.getModel();s.push(a.id),t.setItemState(e,r,!0)}}));var a=[];this.includeEdges&&o.forEach((function(i){i.getOutEdges().forEach((function(i){if(i.isVisible()){var r=i.getModel(),o=r.source,l=r.target;s.includes(o)&&s.includes(l)&&n(i,"select")&&(a.push(i),t.setItemState(i,e.selectedState,!0))}}))})),this.selectedEdges=a,this.selectedNodes=o,this.onSelect&&this.onSelect(o,a),t.emit("nodeselectchange",{selectedItems:{nodes:o,edges:a},select:!0})},createLasso:function(){var e=this.graph.get("delegateGroup").addShape("path",{attrs:$i({path:[]},this.delegateStyle),capture:!1,name:"lasso-shape"});return this.lasso=e,this.delegate=e,this.points=[],e},updateLasso:function(e){this.lasso.attr({path:this.getLassoPath()})},onKeyDown:function(e){var t=e.key;t&&(t.toLowerCase()===this.trigger.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.lasso&&(this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1),this.keydown=!1}},tooltip:DU,"edge-tooltip":NU,"collapse-expand":TU,"drag-combo":OU,"collapse-expand-combo":PU,"create-edge":{getDefaultCfg:function(){return{trigger:"click",key:undefined,edgeConfig:{},getEdgeConfig:void 0}},getEvents:function(){var e,t=this;return zU.indexOf(t.trigger.toLowerCase())>-1||(t.trigger="click",console.warn("Behavior create-edge 的 trigger 参数不合法，请输入 'click'，'drag'")),t.key&&-1===VU.indexOf(t.key.toLowerCase())&&(t.trigger=undefined,console.warn("Behavior create-edge 的 key 参数不合法，请输入 'shift'，'ctrl'，'alt'，'control'，或 undefined")),"drag"===t.trigger?e={"node:dragstart":"onClick","combo:dragstart":"onClick",drag:"updateEndPoint","node:drop":"onClick","combo:drop":"onClick",dragend:"onDragEnd"}:"click"===t.trigger&&(e={"node:click":"onClick",mousemove:"updateEndPoint","edge:click":"cancelCreating","canvas:click":"cancelCreating","combo:click":"onClick"}),t.key&&(e.keydown="onKeyDown",e.keyup="onKeyUp"),e},onDragEnd:function(e){var t=this;if(!t.key||t.keydown){var n=e.item;n&&n.getID()!==t.source&&"node"===n.getType()||t.cancelCreating({item:t.edge,x:e.x,y:e.y})}},onClick:function(e){var t=this;if(!t.key||t.keydown){var n=e.item,i=t.graph,r=n.getModel(),o=t.getEdgeConfig;if(t.addingEdge&&t.edge){if(!t.shouldEnd.call(t,e))return;var s=void 0;s=o&&or(o)?o({source:t.source,target:r.id}):t.edgeConfig;var a=$i({target:r.id},s);if(t.source===r.id&&(a.type="loop"),i.emit("beforecreateedge",{}),i.updateItem(t.edge,a,!1),i.get("enabledStack")){var l=$i($i({},t.edge.getModel()),{itemType:"edge"}),c={};c.edges=[l],i.pushStack("add",{before:{},after:c})}i.emit("aftercreateedge",{edge:t.edge}),t.edge.getKeyShape().set("capture",!0),t.edge=null,t.addingEdge=!1}else{if(!t.shouldBegin.call(t,e))return;s=void 0;s=o&&or(o)?o({source:r.id,target:r.id}):t.edgeConfig,t.edge=i.addItem("edge",$i({source:r.id,target:r.id},s),!1),t.source=r.id,t.addingEdge=!0,t.edge.getKeyShape().set("capture",!1)}}},updateEndPoint:function(e){var t=this;if(!t.key||t.keydown){t.edge&&t.edge.destroyed&&t.cancelCreating({item:t.edge});var n={x:e.x,y:e.y};t.graph.findById(t.source)?t.addingEdge&&t.edge&&t.graph.updateItem(t.edge,{target:n},!1):t.addingEdge=!1}},cancelCreating:function(e){var t,n,i=this;if(!i.key||i.keydown){var r=i.graph,o=e.item;return i.addingEdge&&(i.edge===o||(null===(n=null===(t=e.target)||void 0===t?void 0:t.isCanvas)||void 0===n?void 0:n.call(t)))?(i.edge&&!i.edge.destroyed&&r.removeItem(i.edge,!1),i.edge=null,void(i.addingEdge=!1)):void 0}},onKeyDown:function(e){var t=this,n=e.key;n&&(n.toLowerCase()===t.key.toLowerCase()?t.keydown=!0:t.keydown=!1)},onKeyUp:function(){var e=this;e.addingEdge&&e.edge&&(e.graph.removeItem(e.edge,!1),e.addingEdge=!1,e.edge=null),this.keydown=!1}},"shortcuts-call":{getDefaultCfg:function(){return{trigger:"ctrl",combinedKey:"1",functionName:"fitView",functionParams:[]}},getEvents:function(){return UU.indexOf(this.trigger.toLowerCase())>-1||(this.trigger="ctrl",console.warn("Behavior shortcuts-fit-view 的 trigger 参数 '".concat(this.trigger,"' 不合法，请输入 'drag'、'shift'、'ctrl' 或 'alt'"))),this.combinedKey===this.trigger&&(this.combinedKey=void 0),{keyup:"onKeyUp",keydown:"onKeyDown"}},onKeyDown:function(e){var t=e.key;if(t){var n=this.trigger.toLowerCase(),i=t.toLowerCase();this.triggerKeydown||(this.triggerKeydown=i===n||"control"===i&&"ctrl"===n||"ctrl"===i&&"control"===n);var r=this.graph;if(!r[this.functionName])return console.warn("Behavior shortcuts-fit-view 的 functionName 参数 '".concat(this.functionName,"' 不合法，它不是 Graph 的一个函数名")),{};if(!this.triggerKeydown||this.combinedKey){var o=this.combinedKey.toLowerCase();this.triggerKeydown&&(i===o||"control"===i&&"ctrl"===o||"ctrl"===i&&"control"===o)&&(this.functionParams&&this.functionParams.length?r[this.functionName].apply(r,this.functionParams):r[this.functionName]())}else this.functionParams&&this.functionParams.length?r[this.functionName].apply(r,this.functionParams):r[this.functionName]()}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.triggerKeydown=!1}},"scroll-canvas":{getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,zoomKey:"ctrl",scalableRange:0}},getEvents:function(){return this.zoomKey&&-1!==HU.indexOf(this.zoomKey)||(this.zoomKey="ctrl"),{wheel:"onWheel"}},onWheel:function(e){var t=this,n=this.graph,i=e["".concat(this.zoomKey,"Key")];if("control"===this.zoomKey&&(i=e.ctrlKey),i){var r=n.get("canvas").getPointByClient(e.clientX,e.clientY),o=n.getZoom();e.wheelDelta>0?o+=.05*o:o-=.05*o,n.zoomTo(o,{x:r.x,y:r.y})}else{var s=e.deltaX||e.movementX,a=e.deltaY||e.movementY;!a&&navigator.userAgent.indexOf("Firefox")>-1&&(a=125*-e.wheelDelta/3);var l=this.graph.get("width"),c=this.graph.get("height"),u=this.graph.get("canvas").getCanvasBBox(),h=this.scalableRange,d=this.scalableRange;h<1&&h>-1&&(h*=l,d*=c);var f=u.minX,g=u.maxX,p=u.minY,m=u.maxY;s>0?g<-h?s=0:g-s<-h&&(s=g+h):s<0&&(f>l+h?s=0:f-s>l+h&&(s=f-(l+h))),a>0?m<-d?a=0:m-a<-d&&(a=m+d):a<0&&(p>c+d?a=0:p-a>c+d&&(a=p-(c+d))),"x"===this.get("direction")?a=0:"y"===this.get("direction")&&(s=0),n.translate(-s,-a)}if(e.preventDefault(),this.get("enableOptimize")){var v=this.get("optimizeZoom"),y=this.get("optimized"),_=n.getNodes(),b=n.getEdges(),w=_.length,C=b.length;if(!y){for(var S=0;S<w;S++){var x=_[S];if(!x.destroyed)for(var E=(D=x.get("group").get("children")).length,k=0;k<E;k++){(N=D[k]).destoryed||N.get("isKeyShape")||(N.set("ori-visibility",N.get("ori-visibility")||N.get("visible")),N.hide())}}for(var L=0;L<C;L++){var D;for(E=(D=b[L].get("group").get("children")).length,k=0;k<E;k++){var N;(N=D[k]).set("ori-visibility",N.get("ori-visibility")||N.get("visible")),N.hide()}}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var I=setTimeout((function(){var e=n.getZoom();if(t.get("optimized")){t.set("optimized",!1);for(var i=0;i<w;i++){var r=_[i],o=(c=r.get("group").get("children")).length;if(e<v)(a=(u=r.getKeyShape()).get("ori-visibility"))&&u.show();else for(var s=0;s<o;s++){var a=(d=c[s]).get("ori-visibility");!d.get("visible")&&a&&a&&d.show()}}for(var l=0;l<C;l++){var c,u,h=b[l];o=(c=h.get("group").get("children")).length;if(e<v)(a=(u=h.getKeyShape()).get("ori-visibility"))&&u.show();else for(s=0;s<o;s++){var d;if(!(d=c[s]).get("visible"))(a=d.get("ori-visibility"))&&d.show()}}}}),100);this.set("timeout",I)}}}},(function(e,t){wg(t,e)}));var jU=$i($i({},il),sv),GU={version:cb.version,Graph:AB,TreeGraph:PB,Util:hB,Layout:oF,TreeLayout:fB,registerLayout:function(e,t){t.isCustomLayout=!0,oF[e]=Tb(e,t)},Global:cb,registerBehavior:wg,registerCombo:bg,registerEdge:_g,registerNode:yg,Minimap:BV.Minimap,Grid:BV.Grid,Bundling:BV.Bundling,Menu:BV.Menu,ToolBar:BV.ToolBar,Tooltip:BV.Tooltip,Legend:BV.Legend,TimeBar:BV.TimeBar,SnapLine:BV.SnapLine,Fisheye:BV.Fisheye,ImageMinimap:BV.ImageMinimap,EdgeFilterLens:BV.EdgeFilterLens,Algorithm:jU,Arrow:{triangle:function(e,t,n){void 0===e&&(e=10),void 0===t&&(t=15),void 0===n&&(n=0);var i=2*n;return"M ".concat(i,",0 L ").concat(i+t,",-").concat(e/2," L ").concat(i+t,",").concat(e/2," Z")},vee:function(e,t,n){void 0===e&&(e=15),void 0===t&&(t=20),void 0===n&&(n=0);var i=2*n;return"M ".concat(i,",0 L ").concat(i+t,",-").concat(e/2,"\n        L ").concat(i+2*t/3,",0 L ").concat(i+t,",").concat(e/2," Z")},circle:function(e,t){return void 0===e&&(e=5),void 0===t&&(t=0),"M ".concat(2*t,", 0\n            a ").concat(e,",").concat(e," 0 1,0 ").concat(2*e,",0\n            a ").concat(e,",").concat(e," 0 1,0 ").concat(2*-e,",0")},rect:function(e,t,n){void 0===e&&(e=10),void 0===t&&(t=10),void 0===n&&(n=0);var i=2*n;return"M ".concat(i,",").concat(-e/2," \n        L ").concat(i+t,",").concat(-e/2," \n        L ").concat(i+t,",").concat(e/2," \n        L ").concat(i,",").concat(e/2," Z")},diamond:function(e,t,n){void 0===e&&(e=15),void 0===t&&(t=15),void 0===n&&(n=0);var i=2*n;return"M ".concat(i,",0 \n        L ").concat(i+t/2,",").concat(-e/2," \n        L ").concat(i+t,",0 \n        L ").concat(i+t/2,",").concat(e/2," Z")},triangleRect:function(e,t,n,i,r,o){void 0===e&&(e=15),void 0===t&&(t=15),void 0===n&&(n=15),void 0===i&&(i=3),void 0===r&&(r=5),void 0===o&&(o=0);var s=2*o,a=s+t+r;return"M ".concat(s,",0 L ").concat(s+t,",-").concat(e/2," L ").concat(s+t,",").concat(e/2," Z\n            M ").concat(a,", -").concat(n/2,"\n            L ").concat(a+i," -").concat(n/2,"\n            L ").concat(a+i," ").concat(n/2,"\n            L ").concat(a," ").concat(n/2,"\n            Z")}},Marker:dg,Shape:bf};GU.version="4.5.5",GU.registerNode("dagNode",{getAnchorPoints:()=>[[.5,0],[.5,1]],drawShape(e,t){const n=e.colors;return(null==e?void 0:e.title)&&(null==t||t.addShape("rect",{attrs:a({text:null==e?void 0:e.title,x:-90,y:-20,width:180,height:20,lineWidth:1,cursor:"pointer"},n.topCss),name:"node-top"}),null==t||t.addShape("text",{attrs:a({text:null==e?void 0:e.title,x:0,y:-10,fontSize:11,textAlign:"center",textBaseline:"middle",fontWeight:"bold",cursor:"pointer"},n.topTitleCss),name:"node-top-title"})),(null==e?void 0:e.subTitle)&&(null==t||t.addShape("rect",{attrs:a({x:-90,y:0,width:180,height:20,lineWidth:1,cursor:"pointer"},n.bottomCss),name:"node-bottom"}),null==t||t.addShape("text",{attrs:a({text:null==e?void 0:e.subTitle,x:0,y:10,fontSize:10,textAlign:"center",textBaseline:"middle",fontWeight:"bold",cursor:"pointer"},n.bottomTitleCss),name:"node-bottom-title"})),t.addShape("rect",{attrs:a({x:-90,y:-20,width:180,height:40,lineWidth:1,radius:4},n.borderCss),name:"node-border"})}},"single-node");const KU=e=>{const t=e.findAllByState("node","selected");e.findAllByState("edge","selected").forEach((t=>e.setItemState(t,"selected",!1))),t.forEach((t=>e.setItemState(t,"selected",!1)))},qU=(e,t,n)=>{e.on(t,(t=>{const i=t.item;i&&n(i,e,t)}))},$U=e=>{let t=h.exports.useRef();const n=h.exports.useRef(null),i=jn(n);return h.exports.useEffect((()=>{i.height&&i.width&&(t.current&&t.current.destroy(),t.current=(e=>{var t,n;const i=(null==(t=document.getElementById("mountNode"))?void 0:t.scrollWidth)||800,r=(null==(n=document.getElementById("mountNode"))?void 0:n.scrollHeight)||500,o=new GU.Menu({offsetX:6,offsetY:10,itemTypes:["node"],getContent:e=>"",shouldBegin:()=>!1}),s=new GU.Graph({container:"mountNode",fitCenter:!0,fitViewPadding:10,autoPaint:!0,modes:{default:["drag-canvas","zoom-canvas"]},plugins:[o],layout:{type:"dagre",nodesep:50,ranksep:30,controlPoints:!0},defaultNode:{type:"dagNode"},defaultEdge:{type:"cubic-vertical",style:{radius:50,endArrow:{path:GU.Arrow.triangle(8,8,0),d:0,fill:"#C2C8D5"},lineWidth:1,stroke:"#C2C8D5",shadowBlur:0}},edgeStateStyles:{hover:{lineWidth:2,cursor:"pointer"},selected:{stroke:"#1890ff",lineWidth:2,shadowColor:"#fff",endArrow:{path:GU.Arrow.triangle(8,8,0),d:0,fill:"#1890ff",shadowBlur:0}}},width:i,height:r});return qU(s,"node:click",((t,n,i)=>{var r;KU(s),t._cfg.edges.forEach((e=>{n.setItemState(e,"selected",!0)})),e("nodeClick",i,null==(r=t._cfg)?void 0:r.id),n.setItemState(t,"selected",!0)})),qU(s,"edge:click",((t,n,i)=>{var r;KU(s),n.setItemState(t,"selected",!0);const o=s.findAllByState("node","selected");o.length>0&&e("nodeBlur",i,null==(r=o[0]._cfg)?void 0:r.id)})),qU(s,"node:mouseenter",((e,t,n)=>t.setItemState(e,"hover",!0))),qU(s,"node:mouseleave",((e,t,n)=>t.setItemState(e,"hover",!1))),qU(s,"edge:mouseenter",((e,t,n)=>t.setItemState(e,"hover",!0))),qU(s,"edge:mouseleave",((e,t,n)=>t.setItemState(e,"hover",!1))),s.on("node:contextmenu",(t=>{var n,i;e("nodeContextmenu",t,null==(i=null==(n=t.item)?void 0:n._cfg)?void 0:i.id)})),s})(e.onGraphEvent),t.current.data(e.graphData),t.current.render())}),[e.graphData,i]),d.createElement("div",{ref:n,className:f(e.className,"relative h-full w-full")},d.createElement("div",{className:"relative h-full w-full",id:"mountNode",onClick:t=>e.onGraphEvent("graphClick")}))};const YU=(e,t)=>{const n={topCss:{fill:"#1890ff"},topTitleCss:{fill:"#fff"},bottomCss:{},bottomTitleCss:{},borderCss:{lineWidth:2}},i="24, 144, 255",r={topCss:{fill:`rgba(${i}, 0.5)`,width:180,x:-90},topTitleCss:{fill:"light"===e?"rgb(0,40,126)":"#f6f6f6",width:180},borderCss:{stroke:`rgb(${i})`,width:180,x:-90},bottomCss:{fill:`rgba(${i}, 0.1)`,width:180,x:-90},bottomTitleCss:{fill:"#888"}};return{nodes:[...t.nodes.map((e=>({id:e.id+"",data:a({},e),title:e.name,subTitle:e.type,colors:r,stateStyles:{hover:{"node-border":{lineWidth:2}},selected:{"node-border":n.borderCss,"node-top":n.topCss,"node-top-title":n.topTitleCss,"node-bottom":n.bottomCss}}})))],edges:[...t.edges.map((e=>({source:e.source+"",target:e.target+""})))]}},XU=p((e=>{const{uiStore:t}=be("BenchStore"),{bizId:n,windowTab:i}=e,[r,o]=h.exports.useState();h.exports.useEffect((()=>{s()}),[i]);const s=()=>ce(n).then((e=>{o(e)}));return d.createElement("div",{className:"kanbna-container"},d.createElement(zi,{options:[{name:"commit",icon:"commit2",label:"提交"},{name:"refresh",icon:"refresh2",label:"刷新"}],onClick:e=>{switch(e.name){case"refresh":s()}}}),r&&d.createElement("div",{className:"graph-container"},d.createElement($U,{graphData:YU(t.uiSetting.theme,{edges:r.edges,nodes:r.nodes.map((e=>({id:e.id,name:e.name,type:e.fileType})))}),onGraphEvent:(e,n,i)=>{"nodeClick"===e&&J((e=>{if(e){const n=r.nodes.find((e=>e.id===Number(i)));n&&t.addTab({key:`file_${i}`,type:n.fileType,id:n.id,label:n.name,tmp:!e,menu:"development"})}}))}})))}));var ZU={},QU={exports:{}},JU={exports:{}},eH={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={WORD:"word",STRING:"string",RESERVED:"reserved",RESERVED_TOP_LEVEL:"reserved-top-level",RESERVED_TOP_LEVEL_NO_INDENT:"reserved-top-level-no-indent",RESERVED_NEWLINE:"reserved-newline",OPERATOR:"operator",OPEN_PAREN:"open-paren",CLOSE_PAREN:"close-paren",LINE_COMMENT:"line-comment",BLOCK_COMMENT:"block-comment",NUMBER:"number",PLACEHOLDER:"placeholder"},e.exports=t.default}(eH,eH.exports);var tH={exports:{}},nH={};Object.defineProperty(nH,"__esModule",{value:!0}),nH.sortByLengthDesc=nH.escapeRegExp=nH.isEmpty=nH.last=nH.trimSpacesEnd=void 0;nH.trimSpacesEnd=function(e){return e.replace(/[\t ]+$/,"")};nH.last=function(e){return e[e.length-1]};nH.isEmpty=function(e){return!Array.isArray(e)||0===e.length};nH.escapeRegExp=function(e){return e.replace(/[\$\(-\+\.\?\[-\^\{-\}]/g,"\\$&")};nH.sortByLengthDesc=function(e){return e.sort((function(e,t){return t.length-e.length||e.localeCompare(t)}))},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=nH;function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r="top-level",o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indent=t||"  ",this.indentTypes=[]}var t,o,s;return t=e,(o=[{key:"getIndent",value:function(){return this.indent.repeat(this.indentTypes.length)}},{key:"increaseTopLevel",value:function(){this.indentTypes.push(r)}},{key:"increaseBlockLevel",value:function(){this.indentTypes.push("block-level")}},{key:"decreaseTopLevel",value:function(){this.indentTypes.length>0&&(0,n.last)(this.indentTypes)===r&&this.indentTypes.pop()}},{key:"decreaseBlockLevel",value:function(){for(;this.indentTypes.length>0&&this.indentTypes.pop()===r;);}},{key:"resetIndentation",value:function(){this.indentTypes=[]}}])&&i(t.prototype,o),s&&i(t,s),e}();t.default=o,e.exports=t.default}(tH,tH.exports);var iH={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(eH.exports);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=0}var t,r,o;return t=e,(r=[{key:"beginIfPossible",value:function(e,t){0===this.level&&this.isInlineBlock(e,t)?this.level=1:this.level>0?this.level++:this.level=0}},{key:"end",value:function(){this.level--}},{key:"isActive",value:function(){return this.level>0}},{key:"isInlineBlock",value:function(e,t){for(var i=0,r=0,o=t;o<e.length;o++){var s=e[o];if((i+=s.value.length)>50)return!1;if(s.type===n.default.OPEN_PAREN)r++;else if(s.type===n.default.CLOSE_PAREN&&0==--r)return!0;if(this.isForbiddenToken(s))return!1}return!1}},{key:"isForbiddenToken",value:function(e){var t=e.type,i=e.value;return t===n.default.RESERVED_TOP_LEVEL||t===n.default.RESERVED_NEWLINE||t===n.default.COMMENT||t===n.default.BLOCK_COMMENT||";"===i}}])&&i(t.prototype,r),o&&i(t,o),e}();t.default=r,e.exports=t.default}(iH,iH.exports);var rH={exports:{}};!function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.params=t,this.index=0}var t,i,r;return t=e,(i=[{key:"get",value:function(e){var t=e.key,n=e.value;return this.params?t?this.params[t]:this.params[this.index++]:n}}])&&n(t.prototype,i),r&&n(t,r),e}();t.default=i,e.exports=t.default}(rH,rH.exports);var oH={};Object.defineProperty(oH,"__esModule",{value:!0}),oH.isEnd=oH.isWindow=oH.isBy=oH.isSet=oH.isLimit=oH.isBetween=oH.isAnd=void 0;var sH=function(e){return e&&e.__esModule?e:{default:e}}(eH.exports);var aH=function(e,t){return function(n){return(null==n?void 0:n.type)===e&&t.test(null==n?void 0:n.value)}},lH=aH(sH.default.RESERVED_NEWLINE,/^AND$/i);oH.isAnd=lH;var cH=aH(sH.default.RESERVED,/^BETWEEN$/i);oH.isBetween=cH;var uH=aH(sH.default.RESERVED_TOP_LEVEL,/^LIMIT$/i);oH.isLimit=uH;var hH=aH(sH.default.RESERVED_TOP_LEVEL,/^[S\u017F]ET$/i);oH.isSet=hH;var dH=aH(sH.default.RESERVED,/^BY$/i);oH.isBy=dH;var fH=aH(sH.default.RESERVED_TOP_LEVEL,/^WINDOW$/i);oH.isWindow=fH;var gH=aH(sH.default.CLOSE_PAREN,/^END$/i);oH.isEnd=gH,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(eH.exports),i=l(tH.exports),r=l(iH.exports),o=l(rH.exports),s=nH,a=oH;function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfg=t,this.indentation=new i.default(this.cfg.indent),this.inlineBlock=new r.default,this.params=new o.default(this.cfg.params),this.previousReservedToken={},this.tokens=[],this.index=0}var t,l,h;return t=e,(l=[{key:"tokenizer",value:function(){throw new Error("tokenizer() not implemented by subclass")}},{key:"tokenOverride",value:function(e){return e}},{key:"format",value:function(e){return this.tokens=this.tokenizer().tokenize(e),this.getFormattedQueryFromTokens().trim()}},{key:"getFormattedQueryFromTokens",value:function(){var e=this,t="";return this.tokens.forEach((function(i,r){e.index=r,(i=e.tokenOverride(i)).type===n.default.LINE_COMMENT?t=e.formatLineComment(i,t):i.type===n.default.BLOCK_COMMENT?t=e.formatBlockComment(i,t):i.type===n.default.RESERVED_TOP_LEVEL?(t=e.formatTopLevelReservedWord(i,t),e.previousReservedToken=i):i.type===n.default.RESERVED_TOP_LEVEL_NO_INDENT?(t=e.formatTopLevelReservedWordNoIndent(i,t),e.previousReservedToken=i):i.type===n.default.RESERVED_NEWLINE?(t=e.formatNewlineReservedWord(i,t),e.previousReservedToken=i):i.type===n.default.RESERVED?(t=e.formatWithSpaces(i,t),e.previousReservedToken=i):t=i.type===n.default.OPEN_PAREN?e.formatOpeningParentheses(i,t):i.type===n.default.CLOSE_PAREN?e.formatClosingParentheses(i,t):i.type===n.default.PLACEHOLDER?e.formatPlaceholder(i,t):","===i.value?e.formatComma(i,t):":"===i.value?e.formatWithSpaceAfter(i,t):"."===i.value?e.formatWithoutSpaces(i,t):";"===i.value?e.formatQuerySeparator(i,t):e.formatWithSpaces(i,t)})),t}},{key:"formatLineComment",value:function(e,t){return this.addNewline(t+this.show(e))}},{key:"formatBlockComment",value:function(e,t){return this.addNewline(this.addNewline(t)+this.indentComment(e.value))}},{key:"indentComment",value:function(e){return e.replace(/\n[\t ]*/g,"\n"+this.indentation.getIndent()+" ")}},{key:"formatTopLevelReservedWordNoIndent",value:function(e,t){return this.indentation.decreaseTopLevel(),t=this.addNewline(t)+this.equalizeWhitespace(this.show(e)),this.addNewline(t)}},{key:"formatTopLevelReservedWord",value:function(e,t){return this.indentation.decreaseTopLevel(),t=this.addNewline(t),this.indentation.increaseTopLevel(),t+=this.equalizeWhitespace(this.show(e)),this.addNewline(t)}},{key:"formatNewlineReservedWord",value:function(e,t){return(0,a.isAnd)(e)&&(0,a.isBetween)(this.tokenLookBehind(2))?this.formatWithSpaces(e,t):this.addNewline(t)+this.equalizeWhitespace(this.show(e))+" "}},{key:"equalizeWhitespace",value:function(e){return e.replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/g," ")}},{key:"formatOpeningParentheses",value:function(e,t){var i,r,o=(c(i={},n.default.OPEN_PAREN,!0),c(i,n.default.LINE_COMMENT,!0),c(i,n.default.OPERATOR,!0),i);return 0!==e.whitespaceBefore.length||o[null===(r=this.tokenLookBehind())||void 0===r?void 0:r.type]||(t=(0,s.trimSpacesEnd)(t)),t+=this.show(e),this.inlineBlock.beginIfPossible(this.tokens,this.index),this.inlineBlock.isActive()||(this.indentation.increaseBlockLevel(),t=this.addNewline(t)),t}},{key:"formatClosingParentheses",value:function(e,t){return this.inlineBlock.isActive()?(this.inlineBlock.end(),this.formatWithSpaceAfter(e,t)):(this.indentation.decreaseBlockLevel(),this.formatWithSpaces(e,this.addNewline(t)))}},{key:"formatPlaceholder",value:function(e,t){return t+this.params.get(e)+" "}},{key:"formatComma",value:function(e,t){return t=(0,s.trimSpacesEnd)(t)+this.show(e)+" ",this.inlineBlock.isActive()||(0,a.isLimit)(this.previousReservedToken)?t:this.addNewline(t)}},{key:"formatWithSpaceAfter",value:function(e,t){return(0,s.trimSpacesEnd)(t)+this.show(e)+" "}},{key:"formatWithoutSpaces",value:function(e,t){return(0,s.trimSpacesEnd)(t)+this.show(e)}},{key:"formatWithSpaces",value:function(e,t){return t+this.show(e)+" "}},{key:"formatQuerySeparator",value:function(e,t){return this.indentation.resetIndentation(),(0,s.trimSpacesEnd)(t)+this.show(e)+"\n".repeat(this.cfg.linesBetweenQueries||1)}},{key:"show",value:function(e){var t=e.type,i=e.value;return!this.cfg.uppercase||t!==n.default.RESERVED&&t!==n.default.RESERVED_TOP_LEVEL&&t!==n.default.RESERVED_TOP_LEVEL_NO_INDENT&&t!==n.default.RESERVED_NEWLINE&&t!==n.default.OPEN_PAREN&&t!==n.default.CLOSE_PAREN?i:i.toUpperCase()}},{key:"addNewline",value:function(e){return(e=(0,s.trimSpacesEnd)(e)).endsWith("\n")||(e+="\n"),e+this.indentation.getIndent()}},{key:"tokenLookBehind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.tokens[this.index-e]}},{key:"tokenLookAhead",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.tokens[this.index+e]}}])&&u(t.prototype,l),h&&u(t,h),e}();t.default=h,e.exports=t.default}(JU,JU.exports);var pH={exports:{}},mH={};Object.defineProperty(mH,"__esModule",{value:!0}),mH.createOperatorRegex=function(e){return new RegExp("^(".concat((0,vH.sortByLengthDesc)(e).map(vH.escapeRegExp).join("|"),"|.)"),"u")},mH.createLineCommentRegex=function(e){return new RegExp("^((?:".concat(e.map((function(e){return(0,vH.escapeRegExp)(e)})).join("|"),").*?)(?:\r\n|\r|\n|$)"),"u")},mH.createReservedWordRegex=function(e){if(0===e.length)return new RegExp("^\b$","u");var t=(0,vH.sortByLengthDesc)(e).join("|").replace(/ /g,"\\s+");return new RegExp("^(".concat(t,")\\b"),"iu")},mH.createWordRegex=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new RegExp("^([\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}".concat(e.join(""),"]+)"),"u")},mH.createStringRegex=function(e){return new RegExp("^("+yH(e)+")","u")},mH.createStringPattern=yH,mH.createParenRegex=function(e){return new RegExp("^("+e.map(_H).join("|")+")","iu")},mH.createPlaceholderRegex=function(e,t){if((0,vH.isEmpty)(e))return!1;var n=e.map(vH.escapeRegExp).join("|");return new RegExp("^((?:".concat(n,")(?:").concat(t,"))"),"u")};var vH=nH;function yH(e){var t={"``":"((`[^`]*($|`))+)","{}":"((\\{[^\\}]*($|\\}))+)","[]":"((\\[[^\\]]*($|\\]))(\\][^\\]]*($|\\]))*)",'""':'(("[^"\\\\]*(?:\\\\.[^"\\\\]*)*("|$))+)',"''":"(('[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)","N''":"((N'[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)","U&''":"((U&'[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)",'U&""':'((U&"[^"\\\\]*(?:\\\\.[^"\\\\]*)*("|$))+)',$$:"((?<tag>\\$\\w*\\$)[\\s\\S]*?(?:\\k<tag>|$))"};return e.map((function(e){return t[e]})).join("|")}function _H(e){return 1===e.length?(0,vH.escapeRegExp)(e):"\\b"+e+"\\b"}!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(eH.exports),r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(i,o,a):i[o]=e[o]}i.default=e,t&&t.set(e,i);return i}(mH),o=nH;function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.WHITESPACE_REGEX=/^([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)/,this.NUMBER_REGEX=/^((\x2D[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?[0-9]+(\.[0-9]+)?([Ee]\x2D?[0-9]+(\.[0-9]+)?)?|0x[0-9A-Fa-f]+|0b[01]+)\b/,this.OPERATOR_REGEX=r.createOperatorRegex(["<>","<=",">="].concat(u(t.operators||[]))),this.BLOCK_COMMENT_REGEX=/^(\/\*(?:(?![])[\s\S])*?(?:\*\/|$))/,this.LINE_COMMENT_REGEX=r.createLineCommentRegex(t.lineCommentTypes),this.RESERVED_TOP_LEVEL_REGEX=r.createReservedWordRegex(t.reservedTopLevelWords),this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX=r.createReservedWordRegex(t.reservedTopLevelWordsNoIndent),this.RESERVED_NEWLINE_REGEX=r.createReservedWordRegex(t.reservedNewlineWords),this.RESERVED_PLAIN_REGEX=r.createReservedWordRegex(t.reservedWords),this.WORD_REGEX=r.createWordRegex(t.specialWordChars),this.STRING_REGEX=r.createStringRegex(t.stringTypes),this.OPEN_PAREN_REGEX=r.createParenRegex(t.openParens),this.CLOSE_PAREN_REGEX=r.createParenRegex(t.closeParens),this.INDEXED_PLACEHOLDER_REGEX=r.createPlaceholderRegex(t.indexedPlaceholderTypes,"[0-9]*"),this.IDENT_NAMED_PLACEHOLDER_REGEX=r.createPlaceholderRegex(t.namedPlaceholderTypes,"[a-zA-Z0-9._$]+"),this.STRING_NAMED_PLACEHOLDER_REGEX=r.createPlaceholderRegex(t.namedPlaceholderTypes,r.createStringPattern(t.stringTypes))}var t,n,s;return t=e,(n=[{key:"tokenize",value:function(e){for(var t,n=[];e.length;){var i=this.getWhitespace(e);(e=e.substring(i.length)).length&&(t=this.getNextToken(e,t),e=e.substring(t.value.length),n.push(l(l({},t),{},{whitespaceBefore:i})))}return n}},{key:"getWhitespace",value:function(e){var t=e.match(this.WHITESPACE_REGEX);return t?t[1]:""}},{key:"getNextToken",value:function(e,t){return this.getCommentToken(e)||this.getStringToken(e)||this.getOpenParenToken(e)||this.getCloseParenToken(e)||this.getPlaceholderToken(e)||this.getNumberToken(e)||this.getReservedWordToken(e,t)||this.getWordToken(e)||this.getOperatorToken(e)}},{key:"getCommentToken",value:function(e){return this.getLineCommentToken(e)||this.getBlockCommentToken(e)}},{key:"getLineCommentToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.LINE_COMMENT,regex:this.LINE_COMMENT_REGEX})}},{key:"getBlockCommentToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.BLOCK_COMMENT,regex:this.BLOCK_COMMENT_REGEX})}},{key:"getStringToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.STRING,regex:this.STRING_REGEX})}},{key:"getOpenParenToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.OPEN_PAREN,regex:this.OPEN_PAREN_REGEX})}},{key:"getCloseParenToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.CLOSE_PAREN,regex:this.CLOSE_PAREN_REGEX})}},{key:"getPlaceholderToken",value:function(e){return this.getIdentNamedPlaceholderToken(e)||this.getStringNamedPlaceholderToken(e)||this.getIndexedPlaceholderToken(e)}},{key:"getIdentNamedPlaceholderToken",value:function(e){return this.getPlaceholderTokenWithKey({input:e,regex:this.IDENT_NAMED_PLACEHOLDER_REGEX,parseKey:function(e){return e.slice(1)}})}},{key:"getStringNamedPlaceholderToken",value:function(e){var t=this;return this.getPlaceholderTokenWithKey({input:e,regex:this.STRING_NAMED_PLACEHOLDER_REGEX,parseKey:function(e){return t.getEscapedPlaceholderKey({key:e.slice(2,-1),quoteChar:e.slice(-1)})}})}},{key:"getIndexedPlaceholderToken",value:function(e){return this.getPlaceholderTokenWithKey({input:e,regex:this.INDEXED_PLACEHOLDER_REGEX,parseKey:function(e){return e.slice(1)}})}},{key:"getPlaceholderTokenWithKey",value:function(e){var t=e.input,n=e.regex,r=e.parseKey,o=this.getTokenOnFirstMatch({input:t,regex:n,type:i.default.PLACEHOLDER});return o&&(o.key=r(o.value)),o}},{key:"getEscapedPlaceholderKey",value:function(e){var t=e.key,n=e.quoteChar;return t.replace(new RegExp((0,o.escapeRegExp)("\\"+n),"gu"),n)}},{key:"getNumberToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.NUMBER,regex:this.NUMBER_REGEX})}},{key:"getOperatorToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.OPERATOR,regex:this.OPERATOR_REGEX})}},{key:"getReservedWordToken",value:function(e,t){if(!t||!t.value||"."!==t.value)return this.getTopLevelReservedToken(e)||this.getNewlineReservedToken(e)||this.getTopLevelReservedTokenNoIndent(e)||this.getPlainReservedToken(e)}},{key:"getTopLevelReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.RESERVED_TOP_LEVEL,regex:this.RESERVED_TOP_LEVEL_REGEX})}},{key:"getNewlineReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.RESERVED_NEWLINE,regex:this.RESERVED_NEWLINE_REGEX})}},{key:"getTopLevelReservedTokenNoIndent",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.RESERVED_TOP_LEVEL_NO_INDENT,regex:this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX})}},{key:"getPlainReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.RESERVED,regex:this.RESERVED_PLAIN_REGEX})}},{key:"getWordToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.WORD,regex:this.WORD_REGEX})}},{key:"getTokenOnFirstMatch",value:function(e){var t=e.input,n=e.type,i=e.regex,r=t.match(i);return r?{type:n,value:r[1]}:void 0}}])&&d(t.prototype,n),s&&d(t,s),e}();t.default=f,e.exports=t.default}(pH,pH.exports),function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(JU.exports),r=o(pH.exports);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=["ABS","ACTIVATE","ALIAS","ALL","ALLOCATE","ALLOW","ALTER","ANY","ARE","ARRAY","AS","ASC","ASENSITIVE","ASSOCIATE","ASUTIME","ASYMMETRIC","AT","ATOMIC","ATTRIBUTES","AUDIT","AUTHORIZATION","AUX","AUXILIARY","AVG","BEFORE","BEGIN","BETWEEN","BIGINT","BINARY","BLOB","BOOLEAN","BOTH","BUFFERPOOL","BY","CACHE","CALL","CALLED","CAPTURE","CARDINALITY","CASCADED","CASE","CAST","CCSID","CEIL","CEILING","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CLOB","CLONE","CLOSE","CLUSTER","COALESCE","COLLATE","COLLECT","COLLECTION","COLLID","COLUMN","COMMENT","COMMIT","CONCAT","CONDITION","CONNECT","CONNECTION","CONSTRAINT","CONTAINS","CONTINUE","CONVERT","CORR","CORRESPONDING","COUNT","COUNT_BIG","COVAR_POP","COVAR_SAMP","CREATE","CROSS","CUBE","CUME_DIST","CURRENT","CURRENT_DATE","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_LC_CTYPE","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_SERVER","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CURRENT_USER","CURSOR","CYCLE","DATA","DATABASE","DATAPARTITIONNAME","DATAPARTITIONNUM","DATE","DAY","DAYS","DB2GENERAL","DB2GENRL","DB2SQL","DBINFO","DBPARTITIONNAME","DBPARTITIONNUM","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFAULTS","DEFINITION","DELETE","DENSERANK","DENSE_RANK","DEREF","DESCRIBE","DESCRIPTOR","DETERMINISTIC","DIAGNOSTICS","DISABLE","DISALLOW","DISCONNECT","DISTINCT","DO","DOCUMENT","DOUBLE","DROP","DSSIZE","DYNAMIC","EACH","EDITPROC","ELEMENT","ELSE","ELSEIF","ENABLE","ENCODING","ENCRYPTION","END","END-EXEC","ENDING","ERASE","ESCAPE","EVERY","EXCEPTION","EXCLUDING","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXP","EXPLAIN","EXTENDED","EXTERNAL","EXTRACT","FALSE","FENCED","FETCH","FIELDPROC","FILE","FILTER","FINAL","FIRST","FLOAT","FLOOR","FOR","FOREIGN","FREE","FULL","FUNCTION","FUSION","GENERAL","GENERATED","GET","GLOBAL","GOTO","GRANT","GRAPHIC","GROUP","GROUPING","HANDLER","HASH","HASHED_VALUE","HINT","HOLD","HOUR","HOURS","IDENTITY","IF","IMMEDIATE","IN","INCLUDING","INCLUSIVE","INCREMENT","INDEX","INDICATOR","INDICATORS","INF","INFINITY","INHERIT","INNER","INOUT","INSENSITIVE","INSERT","INT","INTEGER","INTEGRITY","INTERSECTION","INTERVAL","INTO","IS","ISOBID","ISOLATION","ITERATE","JAR","JAVA","KEEP","KEY","LABEL","LANGUAGE","LARGE","LATERAL","LC_CTYPE","LEADING","LEAVE","LEFT","LIKE","LINKTYPE","LN","LOCAL","LOCALDATE","LOCALE","LOCALTIME","LOCALTIMESTAMP","LOCATOR","LOCATORS","LOCK","LOCKMAX","LOCKSIZE","LONG","LOOP","LOWER","MAINTAINED","MATCH","MATERIALIZED","MAX","MAXVALUE","MEMBER","MERGE","METHOD","MICROSECOND","MICROSECONDS","MIN","MINUTE","MINUTES","MINVALUE","MOD","MODE","MODIFIES","MODULE","MONTH","MONTHS","MULTISET","NAN","NATIONAL","NATURAL","NCHAR","NCLOB","NEW","NEW_TABLE","NEXTVAL","NO","NOCACHE","NOCYCLE","NODENAME","NODENUMBER","NOMAXVALUE","NOMINVALUE","NONE","NOORDER","NORMALIZE","NORMALIZED","NOT","NULL","NULLIF","NULLS","NUMERIC","NUMPARTS","OBID","OCTET_LENGTH","OF","OFFSET","OLD","OLD_TABLE","ON","ONLY","OPEN","OPTIMIZATION","OPTIMIZE","OPTION","ORDER","OUT","OUTER","OVER","OVERLAPS","OVERLAY","OVERRIDING","PACKAGE","PADDED","PAGESIZE","PARAMETER","PART","PARTITION","PARTITIONED","PARTITIONING","PARTITIONS","PASSWORD","PATH","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","PIECESIZE","PLAN","POSITION","POWER","PRECISION","PREPARE","PREVVAL","PRIMARY","PRIQTY","PRIVILEGES","PROCEDURE","PROGRAM","PSID","PUBLIC","QUERY","QUERYNO","RANGE","RANK","READ","READS","REAL","RECOVERY","RECURSIVE","REF","REFERENCES","REFERENCING","REFRESH","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","RELEASE","RENAME","REPEAT","RESET","RESIGNAL","RESTART","RESTRICT","RESULT","RESULT_SET_LOCATOR","RETURN","RETURNS","REVOKE","RIGHT","ROLE","ROLLBACK","ROLLUP","ROUND_CEILING","ROUND_DOWN","ROUND_FLOOR","ROUND_HALF_DOWN","ROUND_HALF_EVEN","ROUND_HALF_UP","ROUND_UP","ROUTINE","ROW","ROWNUMBER","ROWS","ROWSET","ROW_NUMBER","RRN","RUN","SAVEPOINT","SCHEMA","SCOPE","SCRATCHPAD","SCROLL","SEARCH","SECOND","SECONDS","SECQTY","SECURITY","SENSITIVE","SEQUENCE","SESSION","SESSION_USER","SIGNAL","SIMILAR","SIMPLE","SMALLINT","SNAN","SOME","SOURCE","SPECIFIC","SPECIFICTYPE","SQL","SQLEXCEPTION","SQLID","SQLSTATE","SQLWARNING","SQRT","STACKED","STANDARD","START","STARTING","STATEMENT","STATIC","STATMENT","STAY","STDDEV_POP","STDDEV_SAMP","STOGROUP","STORES","STYLE","SUBMULTISET","SUBSTRING","SUM","SUMMARY","SYMMETRIC","SYNONYM","SYSFUN","SYSIBM","SYSPROC","SYSTEM","SYSTEM_USER","TABLE","TABLESAMPLE","TABLESPACE","THEN","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TRAILING","TRANSACTION","TRANSLATE","TRANSLATION","TREAT","TRIGGER","TRIM","TRUE","TRUNCATE","TYPE","UESCAPE","UNDO","UNIQUE","UNKNOWN","UNNEST","UNTIL","UPPER","USAGE","USER","USING","VALIDPROC","VALUE","VARCHAR","VARIABLE","VARIANT","VARYING","VAR_POP","VAR_SAMP","VCAT","VERSION","VIEW","VOLATILE","VOLUMES","WHEN","WHENEVER","WHILE","WIDTH_BUCKET","WINDOW","WITH","WITHIN","WITHOUT","WLM","WRITE","XMLELEMENT","XMLEXISTS","XMLNAMESPACES","YEAR","YEARS"],f=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INTERSECT","LIMIT","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],g=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],p=["AND","OR","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","FULL JOIN","FULL OUTER JOIN","CROSS JOIN","NATURAL JOIN"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,n,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return t=u,(n=[{key:"tokenizer",value:function(){return new r.default({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:g,stringTypes:['""',"''","``","[]"],openParens:["("],closeParens:[")"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["#","@"],operators:["**","!=","!>","!>","||"]})}}])&&a(t.prototype,n),i&&a(t,i),u}(i.default);t.default=m,e.exports=t.default}(QU,QU.exports);var bH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(JU.exports),r=o(pH.exports);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=["ACCESSIBLE","ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","BIGINT","BINARY","BLOB","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHAR","CHARACTER","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CURRENT_DATE","CURRENT_ROLE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DEC","DECIMAL","DECLARE","DEFAULT","DELAYED","DELETE","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DO_DOMAIN_IDS","DOUBLE","DROP","DUAL","EACH","ELSE","ELSEIF","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FLOAT","FLOAT4","FLOAT8","FOR","FORCE","FOREIGN","FROM","FULLTEXT","GENERAL","GRANT","GROUP","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IGNORE_DOMAIN_IDS","IGNORE_SERVER_IDS","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","INTERSECT","INTERVAL","INTO","IS","ITERATE","JOIN","KEY","KEYS","KILL","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINEAR","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LONG","LONGBLOB","LONGTEXT","LOOP","LOW_PRIORITY","MASTER_HEARTBEAT_PERIOD","MASTER_SSL_VERIFY_SERVER_CERT","MATCH","MAXVALUE","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NOT","NO_WRITE_TO_BINLOG","NULL","NUMERIC","ON","OPTIMIZE","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PAGE_CHECKSUM","PARSE_VCOL_EXPR","PARTITION","POSITION","PRECISION","PRIMARY","PROCEDURE","PURGE","RANGE","READ","READS","READ_WRITE","REAL","RECURSIVE","REF_SYSTEM_ID","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESIGNAL","RESTRICT","RETURN","RETURNING","REVOKE","RIGHT","RLIKE","ROWS","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SENSITIVE","SEPARATOR","SET","SHOW","SIGNAL","SLOW","SMALLINT","SPATIAL","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SSL","STARTING","STATS_AUTO_RECALC","STATS_PERSISTENT","STATS_SAMPLE_PAGES","STRAIGHT_JOIN","TABLE","TERMINATED","THEN","TINYBLOB","TINYINT","TINYTEXT","TO","TRAILING","TRIGGER","TRUE","UNDO","UNION","UNIQUE","UNLOCK","UNSIGNED","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","VARBINARY","VARCHAR","VARCHARACTER","VARYING","WHEN","WHERE","WHILE","WINDOW","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL"],f=["ADD","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","ORDER BY","SELECT","SET","UPDATE","VALUES","WHERE"],g=["INTERSECT","INTERSECT ALL","UNION","UNION ALL"],p=["AND","ELSE","OR","WHEN","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","CROSS JOIN","NATURAL JOIN","STRAIGHT_JOIN","NATURAL LEFT JOIN","NATURAL LEFT OUTER JOIN","NATURAL RIGHT JOIN","NATURAL RIGHT OUTER JOIN"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,n,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return t=u,(n=[{key:"tokenizer",value:function(){return new r.default({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:g,stringTypes:["``","''",'""'],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[],lineCommentTypes:["--","#"],specialWordChars:["@"],operators:[":=","<<",">>","!=","<>","<=>","&&","||"]})}}])&&a(t.prototype,n),i&&a(t,i),u}(i.default);t.default=m,e.exports=t.default}(bH,bH.exports);var wH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(JU.exports),r=o(pH.exports);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=["ACCESSIBLE","ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","BIGINT","BINARY","BLOB","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHAR","CHARACTER","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CUBE","CUME_DIST","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DEC","DECIMAL","DECLARE","DEFAULT","DELAYED","DELETE","DENSE_RANK","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DOUBLE","DROP","DUAL","EACH","ELSE","ELSEIF","EMPTY","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FIRST_VALUE","FLOAT","FLOAT4","FLOAT8","FOR","FORCE","FOREIGN","FROM","FULLTEXT","FUNCTION","GENERATED","GET","GRANT","GROUP","GROUPING","GROUPS","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","INTERVAL","INTO","IO_AFTER_GTIDS","IO_BEFORE_GTIDS","IS","ITERATE","JOIN","JSON_TABLE","KEY","KEYS","KILL","LAG","LAST_VALUE","LATERAL","LEAD","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINEAR","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LONG","LONGBLOB","LONGTEXT","LOOP","LOW_PRIORITY","MASTER_BIND","MASTER_SSL_VERIFY_SERVER_CERT","MATCH","MAXVALUE","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NOT","NO_WRITE_TO_BINLOG","NTH_VALUE","NTILE","NULL","NUMERIC","OF","ON","OPTIMIZE","OPTIMIZER_COSTS","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PARTITION","PERCENT_RANK","PRECISION","PRIMARY","PROCEDURE","PURGE","RANGE","RANK","READ","READS","READ_WRITE","REAL","RECURSIVE","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESIGNAL","RESTRICT","RETURN","REVOKE","RIGHT","RLIKE","ROW","ROWS","ROW_NUMBER","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SENSITIVE","SEPARATOR","SET","SHOW","SIGNAL","SMALLINT","SPATIAL","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SSL","STARTING","STORED","STRAIGHT_JOIN","SYSTEM","TABLE","TERMINATED","THEN","TINYBLOB","TINYINT","TINYTEXT","TO","TRAILING","TRIGGER","TRUE","UNDO","UNION","UNIQUE","UNLOCK","UNSIGNED","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","VARBINARY","VARCHAR","VARCHARACTER","VARYING","VIRTUAL","WHEN","WHERE","WHILE","WINDOW","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL"],f=["ADD","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","ORDER BY","SELECT","SET","UPDATE","VALUES","WHERE"],g=["INTERSECT","INTERSECT ALL","UNION","UNION ALL"],p=["AND","ELSE","OR","WHEN","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","CROSS JOIN","NATURAL JOIN","STRAIGHT_JOIN","NATURAL LEFT JOIN","NATURAL LEFT OUTER JOIN","NATURAL RIGHT JOIN","NATURAL RIGHT OUTER JOIN"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,n,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return t=u,(n=[{key:"tokenizer",value:function(){return new r.default({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:g,stringTypes:["``","''",'""'],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[],lineCommentTypes:["--","#"],specialWordChars:["@"],operators:[":=","<<",">>","!=","<>","<=>","&&","||","->","->>"]})}}])&&a(t.prototype,n),i&&a(t,i),u}(i.default);t.default=m,e.exports=t.default}(wH,wH.exports);var CH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(JU.exports),r=o(pH.exports);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=["ALL","ALTER","ANALYZE","AND","ANY","ARRAY","AS","ASC","BEGIN","BETWEEN","BINARY","BOOLEAN","BREAK","BUCKET","BUILD","BY","CALL","CASE","CAST","CLUSTER","COLLATE","COLLECTION","COMMIT","CONNECT","CONTINUE","CORRELATE","COVER","CREATE","DATABASE","DATASET","DATASTORE","DECLARE","DECREMENT","DELETE","DERIVED","DESC","DESCRIBE","DISTINCT","DO","DROP","EACH","ELEMENT","ELSE","END","EVERY","EXCEPT","EXCLUDE","EXECUTE","EXISTS","EXPLAIN","FALSE","FETCH","FIRST","FLATTEN","FOR","FORCE","FROM","FUNCTION","GRANT","GROUP","GSI","HAVING","IF","IGNORE","ILIKE","IN","INCLUDE","INCREMENT","INDEX","INFER","INLINE","INNER","INSERT","INTERSECT","INTO","IS","JOIN","KEY","KEYS","KEYSPACE","KNOWN","LAST","LEFT","LET","LETTING","LIKE","LIMIT","LSM","MAP","MAPPING","MATCHED","MATERIALIZED","MERGE","MISSING","NAMESPACE","NEST","NOT","NULL","NUMBER","OBJECT","OFFSET","ON","OPTION","OR","ORDER","OUTER","OVER","PARSE","PARTITION","PASSWORD","PATH","POOL","PREPARE","PRIMARY","PRIVATE","PRIVILEGE","PROCEDURE","PUBLIC","RAW","REALM","REDUCE","RENAME","RETURN","RETURNING","REVOKE","RIGHT","ROLE","ROLLBACK","SATISFIES","SCHEMA","SELECT","SELF","SEMI","SET","SHOW","SOME","START","STATISTICS","STRING","SYSTEM","THEN","TO","TRANSACTION","TRIGGER","TRUE","TRUNCATE","UNDER","UNION","UNIQUE","UNKNOWN","UNNEST","UNSET","UPDATE","UPSERT","USE","USER","USING","VALIDATE","VALUE","VALUED","VALUES","VIA","VIEW","WHEN","WHERE","WHILE","WITH","WITHIN","WORK","XOR"],f=["DELETE FROM","EXCEPT ALL","EXCEPT","EXPLAIN DELETE FROM","EXPLAIN UPDATE","EXPLAIN UPSERT","FROM","GROUP BY","HAVING","INFER","INSERT INTO","LET","LIMIT","MERGE","NEST","ORDER BY","PREPARE","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UNNEST","UPDATE","UPSERT","USE KEYS","VALUES","WHERE"],g=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],p=["AND","OR","XOR","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,n,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return t=u,(n=[{key:"tokenizer",value:function(){return new r.default({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:g,stringTypes:['""',"''","``"],openParens:["(","[","{"],closeParens:[")","]","}"],namedPlaceholderTypes:["$"],lineCommentTypes:["#","--"],operators:["==","!="]})}}])&&a(t.prototype,n),i&&a(t,i),u}(i.default);t.default=m,e.exports=t.default}(CH,CH.exports);var SH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(JU.exports),r=oH,o=a(pH.exports),s=a(eH.exports);function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=f(e);if(t){var r=f(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=["A","ACCESSIBLE","AGENT","AGGREGATE","ALL","ALTER","ANY","ARRAY","AS","ASC","AT","ATTRIBUTE","AUTHID","AVG","BETWEEN","BFILE_BASE","BINARY_INTEGER","BINARY","BLOB_BASE","BLOCK","BODY","BOOLEAN","BOTH","BOUND","BREADTH","BULK","BY","BYTE","C","CALL","CALLING","CASCADE","CASE","CHAR_BASE","CHAR","CHARACTER","CHARSET","CHARSETFORM","CHARSETID","CHECK","CLOB_BASE","CLONE","CLOSE","CLUSTER","CLUSTERS","COALESCE","COLAUTH","COLLECT","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPILED","COMPRESS","CONNECT","CONSTANT","CONSTRUCTOR","CONTEXT","CONTINUE","CONVERT","COUNT","CRASH","CREATE","CREDENTIAL","CURRENT","CURRVAL","CURSOR","CUSTOMDATUM","DANGLING","DATA","DATE_BASE","DATE","DAY","DECIMAL","DEFAULT","DEFINE","DELETE","DEPTH","DESC","DETERMINISTIC","DIRECTORY","DISTINCT","DO","DOUBLE","DROP","DURATION","ELEMENT","ELSIF","EMPTY","END","ESCAPE","EXCEPTIONS","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXTENDS","EXTERNAL","EXTRACT","FALSE","FETCH","FINAL","FIRST","FIXED","FLOAT","FOR","FORALL","FORCE","FROM","FUNCTION","GENERAL","GOTO","GRANT","GROUP","HASH","HEAP","HIDDEN","HOUR","IDENTIFIED","IF","IMMEDIATE","IN","INCLUDING","INDEX","INDEXES","INDICATOR","INDICES","INFINITE","INSTANTIABLE","INT","INTEGER","INTERFACE","INTERVAL","INTO","INVALIDATE","IS","ISOLATION","JAVA","LANGUAGE","LARGE","LEADING","LENGTH","LEVEL","LIBRARY","LIKE","LIKE2","LIKE4","LIKEC","LIMITED","LOCAL","LOCK","LONG","MAP","MAX","MAXLEN","MEMBER","MERGE","MIN","MINUTE","MLSLABEL","MOD","MODE","MONTH","MULTISET","NAME","NAN","NATIONAL","NATIVE","NATURAL","NATURALN","NCHAR","NEW","NEXTVAL","NOCOMPRESS","NOCOPY","NOT","NOWAIT","NULL","NULLIF","NUMBER_BASE","NUMBER","OBJECT","OCICOLL","OCIDATE","OCIDATETIME","OCIDURATION","OCIINTERVAL","OCILOBLOCATOR","OCINUMBER","OCIRAW","OCIREF","OCIREFCURSOR","OCIROWID","OCISTRING","OCITYPE","OF","OLD","ON","ONLY","OPAQUE","OPEN","OPERATOR","OPTION","ORACLE","ORADATA","ORDER","ORGANIZATION","ORLANY","ORLVARY","OTHERS","OUT","OVERLAPS","OVERRIDING","PACKAGE","PARALLEL_ENABLE","PARAMETER","PARAMETERS","PARENT","PARTITION","PASCAL","PCTFREE","PIPE","PIPELINED","PLS_INTEGER","PLUGGABLE","POSITIVE","POSITIVEN","PRAGMA","PRECISION","PRIOR","PRIVATE","PROCEDURE","PUBLIC","RAISE","RANGE","RAW","READ","REAL","RECORD","REF","REFERENCE","RELEASE","RELIES_ON","REM","REMAINDER","RENAME","RESOURCE","RESULT_CACHE","RESULT","RETURN","RETURNING","REVERSE","REVOKE","ROLLBACK","ROW","ROWID","ROWNUM","ROWTYPE","SAMPLE","SAVE","SAVEPOINT","SB1","SB2","SB4","SEARCH","SECOND","SEGMENT","SELF","SEPARATE","SEQUENCE","SERIALIZABLE","SHARE","SHORT","SIZE_T","SIZE","SMALLINT","SOME","SPACE","SPARSE","SQL","SQLCODE","SQLDATA","SQLERRM","SQLNAME","SQLSTATE","STANDARD","START","STATIC","STDDEV","STORED","STRING","STRUCT","STYLE","SUBMULTISET","SUBPARTITION","SUBSTITUTABLE","SUBTYPE","SUCCESSFUL","SUM","SYNONYM","SYSDATE","TABAUTH","TABLE","TDO","THE","THEN","TIME","TIMESTAMP","TIMEZONE_ABBR","TIMEZONE_HOUR","TIMEZONE_MINUTE","TIMEZONE_REGION","TO","TRAILING","TRANSACTION","TRANSACTIONAL","TRIGGER","TRUE","TRUSTED","TYPE","UB1","UB2","UB4","UID","UNDER","UNIQUE","UNPLUG","UNSIGNED","UNTRUSTED","USE","USER","USING","VALIDATE","VALIST","VALUE","VARCHAR","VARCHAR2","VARIABLE","VARIANCE","VARRAY","VARYING","VIEW","VIEWS","VOID","WHENEVER","WHILE","WITH","WORK","WRAPPED","WRITE","YEAR","ZONE"],p=["ADD","ALTER COLUMN","ALTER TABLE","BEGIN","CONNECT BY","DECLARE","DELETE FROM","DELETE","END","EXCEPT","EXCEPTION","FETCH FIRST","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","LOOP","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","START WITH","UPDATE","VALUES","WHERE"],m=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],v=["AND","CROSS APPLY","ELSE","END","OR","OUTER APPLY","WHEN","XOR","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","FULL JOIN","FULL OUTER JOIN","CROSS JOIN","NATURAL JOIN"],y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(d,e);var t,n,i,a=h(d);function d(){return l(this,d),a.apply(this,arguments)}return t=d,(n=[{key:"tokenizer",value:function(){return new o.default({reservedWords:g,reservedTopLevelWords:p,reservedNewlineWords:v,reservedTopLevelWordsNoIndent:m,stringTypes:['""',"N''","''","``"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["_","$","#",".","@"],operators:["||","**","!=",":="]})}},{key:"tokenOverride",value:function(e){return(0,r.isSet)(e)&&(0,r.isBy)(this.previousReservedToken)?{type:s.default.RESERVED,value:e.value}:e}}])&&c(t.prototype,n),i&&c(t,i),d}(i.default);t.default=y,e.exports=t.default}(SH,SH.exports);var xH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(JU.exports),r=o(pH.exports);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=["ABORT","ABSOLUTE","ACCESS","ACTION","ADD","ADMIN","AFTER","AGGREGATE","ALL","ALSO","ALTER","ALWAYS","ANALYSE","ANALYZE","AND","ANY","ARRAY","AS","ASC","ASSERTION","ASSIGNMENT","ASYMMETRIC","AT","ATTACH","ATTRIBUTE","AUTHORIZATION","BACKWARD","BEFORE","BEGIN","BETWEEN","BIGINT","BINARY","BIT","BOOLEAN","BOTH","BY","CACHE","CALL","CALLED","CASCADE","CASCADED","CASE","CAST","CATALOG","CHAIN","CHAR","CHARACTER","CHARACTERISTICS","CHECK","CHECKPOINT","CLASS","CLOSE","CLUSTER","COALESCE","COLLATE","COLLATION","COLUMN","COLUMNS","COMMENT","COMMENTS","COMMIT","COMMITTED","CONCURRENTLY","CONFIGURATION","CONFLICT","CONNECTION","CONSTRAINT","CONSTRAINTS","CONTENT","CONTINUE","CONVERSION","COPY","COST","CREATE","CROSS","CSV","CUBE","CURRENT","CURRENT_CATALOG","CURRENT_DATE","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","CYCLE","DATA","DATABASE","DAY","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFAULTS","DEFERRABLE","DEFERRED","DEFINER","DELETE","DELIMITER","DELIMITERS","DEPENDS","DESC","DETACH","DICTIONARY","DISABLE","DISCARD","DISTINCT","DO","DOCUMENT","DOMAIN","DOUBLE","DROP","EACH","ELSE","ENABLE","ENCODING","ENCRYPTED","END","ENUM","ESCAPE","EVENT","EXCEPT","EXCLUDE","EXCLUDING","EXCLUSIVE","EXECUTE","EXISTS","EXPLAIN","EXPRESSION","EXTENSION","EXTERNAL","EXTRACT","FALSE","FAMILY","FETCH","FILTER","FIRST","FLOAT","FOLLOWING","FOR","FORCE","FOREIGN","FORWARD","FREEZE","FROM","FULL","FUNCTION","FUNCTIONS","GENERATED","GLOBAL","GRANT","GRANTED","GREATEST","GROUP","GROUPING","GROUPS","HANDLER","HAVING","HEADER","HOLD","HOUR","IDENTITY","IF","ILIKE","IMMEDIATE","IMMUTABLE","IMPLICIT","IMPORT","IN","INCLUDE","INCLUDING","INCREMENT","INDEX","INDEXES","INHERIT","INHERITS","INITIALLY","INLINE","INNER","INOUT","INPUT","INSENSITIVE","INSERT","INSTEAD","INT","INTEGER","INTERSECT","INTERVAL","INTO","INVOKER","IS","ISNULL","ISOLATION","JOIN","KEY","LABEL","LANGUAGE","LARGE","LAST","LATERAL","LEADING","LEAKPROOF","LEAST","LEFT","LEVEL","LIKE","LIMIT","LISTEN","LOAD","LOCAL","LOCALTIME","LOCALTIMESTAMP","LOCATION","LOCK","LOCKED","LOGGED","MAPPING","MATCH","MATERIALIZED","MAXVALUE","METHOD","MINUTE","MINVALUE","MODE","MONTH","MOVE","NAME","NAMES","NATIONAL","NATURAL","NCHAR","NEW","NEXT","NFC","NFD","NFKC","NFKD","NO","NONE","NORMALIZE","NORMALIZED","NOT","NOTHING","NOTIFY","NOTNULL","NOWAIT","NULL","NULLIF","NULLS","NUMERIC","OBJECT","OF","OFF","OFFSET","OIDS","OLD","ON","ONLY","OPERATOR","OPTION","OPTIONS","OR","ORDER","ORDINALITY","OTHERS","OUT","OUTER","OVER","OVERLAPS","OVERLAY","OVERRIDING","OWNED","OWNER","PARALLEL","PARSER","PARTIAL","PARTITION","PASSING","PASSWORD","PLACING","PLANS","POLICY","POSITION","PRECEDING","PRECISION","PREPARE","PREPARED","PRESERVE","PRIMARY","PRIOR","PRIVILEGES","PROCEDURAL","PROCEDURE","PROCEDURES","PROGRAM","PUBLICATION","QUOTE","RANGE","READ","REAL","REASSIGN","RECHECK","RECURSIVE","REF","REFERENCES","REFERENCING","REFRESH","REINDEX","RELATIVE","RELEASE","RENAME","REPEATABLE","REPLACE","REPLICA","RESET","RESTART","RESTRICT","RETURNING","RETURNS","REVOKE","RIGHT","ROLE","ROLLBACK","ROLLUP","ROUTINE","ROUTINES","ROW","ROWS","RULE","SAVEPOINT","SCHEMA","SCHEMAS","SCROLL","SEARCH","SECOND","SECURITY","SELECT","SEQUENCE","SEQUENCES","SERIALIZABLE","SERVER","SESSION","SESSION_USER","SET","SETOF","SETS","SHARE","SHOW","SIMILAR","SIMPLE","SKIP","SMALLINT","SNAPSHOT","SOME","SQL","STABLE","STANDALONE","START","STATEMENT","STATISTICS","STDIN","STDOUT","STORAGE","STORED","STRICT","STRIP","SUBSCRIPTION","SUBSTRING","SUPPORT","SYMMETRIC","SYSID","SYSTEM","TABLE","TABLES","TABLESAMPLE","TABLESPACE","TEMP","TEMPLATE","TEMPORARY","TEXT","THEN","TIES","TIME","TIMESTAMP","TO","TRAILING","TRANSACTION","TRANSFORM","TREAT","TRIGGER","TRIM","TRUE","TRUNCATE","TRUSTED","TYPE","TYPES","UESCAPE","UNBOUNDED","UNCOMMITTED","UNENCRYPTED","UNION","UNIQUE","UNKNOWN","UNLISTEN","UNLOGGED","UNTIL","UPDATE","USER","USING","VACUUM","VALID","VALIDATE","VALIDATOR","VALUE","VALUES","VARCHAR","VARIADIC","VARYING","VERBOSE","VERSION","VIEW","VIEWS","VOLATILE","WHEN","WHERE","WHITESPACE","WINDOW","WITH","WITHIN","WITHOUT","WORK","WRAPPER","WRITE","XML","XMLATTRIBUTES","XMLCONCAT","XMLELEMENT","XMLEXISTS","XMLFOREST","XMLNAMESPACES","XMLPARSE","XMLPI","XMLROOT","XMLSERIALIZE","XMLTABLE","YEAR","YES","ZONE"],f=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","CASE","DELETE FROM","END","EXCEPT","FETCH FIRST","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],g=["INTERSECT","INTERSECT ALL","UNION","UNION ALL"],p=["AND","ELSE","OR","WHEN","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","FULL JOIN","FULL OUTER JOIN","CROSS JOIN","NATURAL JOIN"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,n,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return t=u,(n=[{key:"tokenizer",value:function(){return new r.default({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:g,stringTypes:['""',"''","U&''",'U&""',"$$"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["$"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],operators:["!=","<<",">>","||/","|/","::","->>","->","~~*","~~","!~~*","!~~","~*","!~*","!~","!!"]})}}])&&a(t.prototype,n),i&&a(t,i),u}(i.default);t.default=m,e.exports=t.default}(xH,xH.exports);var EH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(JU.exports),r=o(pH.exports);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=["AES128","AES256","ALLOWOVERWRITE","ANALYSE","ARRAY","AS","ASC","AUTHORIZATION","BACKUP","BINARY","BLANKSASNULL","BOTH","BYTEDICT","BZIP2","CAST","CHECK","COLLATE","COLUMN","CONSTRAINT","CREATE","CREDENTIALS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURRENT_USER_ID","DEFAULT","DEFERRABLE","DEFLATE","DEFRAG","DELTA","DELTA32K","DESC","DISABLE","DISTINCT","DO","ELSE","EMPTYASNULL","ENABLE","ENCODE","ENCRYPT","ENCRYPTION","END","EXPLICIT","FALSE","FOR","FOREIGN","FREEZE","FULL","GLOBALDICT256","GLOBALDICT64K","GRANT","GZIP","IDENTITY","IGNORE","ILIKE","INITIALLY","INTO","LEADING","LOCALTIME","LOCALTIMESTAMP","LUN","LUNS","LZO","LZOP","MINUS","MOSTLY13","MOSTLY32","MOSTLY8","NATURAL","NEW","NULLS","OFF","OFFLINE","OFFSET","OLD","ON","ONLY","OPEN","ORDER","OVERLAPS","PARALLEL","PARTITION","PERCENT","PERMISSIONS","PLACING","PRIMARY","RAW","READRATIO","RECOVER","REFERENCES","REJECTLOG","RESORT","RESTORE","SESSION_USER","SIMILAR","SYSDATE","SYSTEM","TABLE","TAG","TDES","TEXT255","TEXT32K","THEN","TIMESTAMP","TO","TOP","TRAILING","TRUE","TRUNCATECOLUMNS","UNIQUE","USER","USING","VERBOSE","WALLET","WHEN","WITH","WITHOUT","PREDICATE","COLUMNS","COMPROWS","COMPRESSION","COPY","FORMAT","DELIMITER","FIXEDWIDTH","AVRO","JSON","ENCRYPTED","BZIP2","GZIP","LZOP","PARQUET","ORC","ACCEPTANYDATE","ACCEPTINVCHARS","BLANKSASNULL","DATEFORMAT","EMPTYASNULL","ENCODING","ESCAPE","EXPLICIT_IDS","FILLRECORD","IGNOREBLANKLINES","IGNOREHEADER","NULL AS","REMOVEQUOTES","ROUNDEC","TIMEFORMAT","TRIMBLANKS","TRUNCATECOLUMNS","COMPROWS","COMPUPDATE","MAXERROR","NOLOAD","STATUPDATE","MANIFEST","REGION","IAM_ROLE","MASTER_SYMMETRIC_KEY","SSH","ACCEPTANYDATE","ACCEPTINVCHARS","ACCESS_KEY_ID","SECRET_ACCESS_KEY","AVRO","BLANKSASNULL","BZIP2","COMPROWS","COMPUPDATE","CREDENTIALS","DATEFORMAT","DELIMITER","EMPTYASNULL","ENCODING","ENCRYPTED","ESCAPE","EXPLICIT_IDS","FILLRECORD","FIXEDWIDTH","FORMAT","IAM_ROLE","GZIP","IGNOREBLANKLINES","IGNOREHEADER","JSON","LZOP","MANIFEST","MASTER_SYMMETRIC_KEY","MAXERROR","NOLOAD","NULL AS","READRATIO","REGION","REMOVEQUOTES","ROUNDEC","SSH","STATUPDATE","TIMEFORMAT","SESSION_TOKEN","TRIMBLANKS","TRUNCATECOLUMNS","EXTERNAL","DATA CATALOG","HIVE METASTORE","CATALOG_ROLE","VACUUM","COPY","UNLOAD","EVEN","ALL"],f=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","INTERSECT","TOP","LIMIT","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UNION ALL","UNION","UPDATE","VALUES","WHERE","VACUUM","COPY","UNLOAD","ANALYZE","ANALYSE","DISTKEY","SORTKEY","COMPOUND","INTERLEAVED","FORMAT","DELIMITER","FIXEDWIDTH","AVRO","JSON","ENCRYPTED","BZIP2","GZIP","LZOP","PARQUET","ORC","ACCEPTANYDATE","ACCEPTINVCHARS","BLANKSASNULL","DATEFORMAT","EMPTYASNULL","ENCODING","ESCAPE","EXPLICIT_IDS","FILLRECORD","IGNOREBLANKLINES","IGNOREHEADER","NULL AS","REMOVEQUOTES","ROUNDEC","TIMEFORMAT","TRIMBLANKS","TRUNCATECOLUMNS","COMPROWS","COMPUPDATE","MAXERROR","NOLOAD","STATUPDATE","MANIFEST","REGION","IAM_ROLE","MASTER_SYMMETRIC_KEY","SSH","ACCEPTANYDATE","ACCEPTINVCHARS","ACCESS_KEY_ID","SECRET_ACCESS_KEY","AVRO","BLANKSASNULL","BZIP2","COMPROWS","COMPUPDATE","CREDENTIALS","DATEFORMAT","DELIMITER","EMPTYASNULL","ENCODING","ENCRYPTED","ESCAPE","EXPLICIT_IDS","FILLRECORD","FIXEDWIDTH","FORMAT","IAM_ROLE","GZIP","IGNOREBLANKLINES","IGNOREHEADER","JSON","LZOP","MANIFEST","MASTER_SYMMETRIC_KEY","MAXERROR","NOLOAD","NULL AS","READRATIO","REGION","REMOVEQUOTES","ROUNDEC","SSH","STATUPDATE","TIMEFORMAT","SESSION_TOKEN","TRIMBLANKS","TRUNCATECOLUMNS","EXTERNAL","DATA CATALOG","HIVE METASTORE","CATALOG_ROLE"],g=[],p=["AND","ELSE","OR","OUTER APPLY","WHEN","VACUUM","COPY","UNLOAD","ANALYZE","ANALYSE","DISTKEY","SORTKEY","COMPOUND","INTERLEAVED","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","FULL JOIN","FULL OUTER JOIN","CROSS JOIN","NATURAL JOIN"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,n,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return t=u,(n=[{key:"tokenizer",value:function(){return new r.default({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:g,stringTypes:['""',"''","``"],openParens:["("],closeParens:[")"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:["@","#","$"],lineCommentTypes:["--"],operators:["|/","||/","<<",">>","!=","||"]})}}])&&a(t.prototype,n),i&&a(t,i),u}(i.default);t.default=m,e.exports=t.default}(EH,EH.exports);var kH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(JU.exports),r=oH,o=a(pH.exports),s=a(eH.exports);function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=f(e);if(t){var r=f(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=["ALL","ALTER","ANALYSE","ANALYZE","ARRAY_ZIP","ARRAY","AS","ASC","AVG","BETWEEN","CASCADE","CASE","CAST","COALESCE","COLLECT_LIST","COLLECT_SET","COLUMN","COLUMNS","COMMENT","CONSTRAINT","CONTAINS","CONVERT","COUNT","CUME_DIST","CURRENT ROW","CURRENT_DATE","CURRENT_TIMESTAMP","DATABASE","DATABASES","DATE_ADD","DATE_SUB","DATE_TRUNC","DAY_HOUR","DAY_MINUTE","DAY_SECOND","DAY","DAYS","DECODE","DEFAULT","DELETE","DENSE_RANK","DESC","DESCRIBE","DISTINCT","DISTINCTROW","DIV","DROP","ELSE","ENCODE","END","EXISTS","EXPLAIN","EXPLODE_OUTER","EXPLODE","FILTER","FIRST_VALUE","FIRST","FIXED","FLATTEN","FOLLOWING","FROM_UNIXTIME","FULL","GREATEST","GROUP_CONCAT","HOUR_MINUTE","HOUR_SECOND","HOUR","HOURS","IF","IFNULL","IN","INSERT","INTERVAL","INTO","IS","LAG","LAST_VALUE","LAST","LEAD","LEADING","LEAST","LEVEL","LIKE","MAX","MERGE","MIN","MINUTE_SECOND","MINUTE","MONTH","NATURAL","NOT","NOW()","NTILE","NULL","NULLIF","OFFSET","ON DELETE","ON UPDATE","ON","ONLY","OPTIMIZE","OVER","PERCENT_RANK","PRECEDING","RANGE","RANK","REGEXP","RENAME","RLIKE","ROW","ROWS","SECOND","SEPARATOR","SEQUENCE","SIZE","STRING","STRUCT","SUM","TABLE","TABLES","TEMPORARY","THEN","TO_DATE","TO_JSON","TO","TRAILING","TRANSFORM","TRUE","TRUNCATE","TYPE","TYPES","UNBOUNDED","UNIQUE","UNIX_TIMESTAMP","UNLOCK","UNSIGNED","USING","VARIABLES","VIEW","WHEN","WITH","YEAR_MONTH"],p=["ADD","AFTER","ALTER COLUMN","ALTER DATABASE","ALTER SCHEMA","ALTER TABLE","CLUSTER BY","CLUSTERED BY","DELETE FROM","DISTRIBUTE BY","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","OPTIONS","ORDER BY","PARTITION BY","PARTITIONED BY","RANGE","ROWS","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","TBLPROPERTIES","UPDATE","USING","VALUES","WHERE","WINDOW"],m=["EXCEPT ALL","EXCEPT","INTERSECT ALL","INTERSECT","UNION ALL","UNION"],v=["AND","CREATE OR","CREATE","ELSE","LATERAL VIEW","OR","OUTER APPLY","WHEN","XOR","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","FULL JOIN","FULL OUTER JOIN","CROSS JOIN","NATURAL JOIN","ANTI JOIN","SEMI JOIN","LEFT ANTI JOIN","LEFT SEMI JOIN","RIGHT OUTER JOIN","RIGHT SEMI JOIN","NATURAL ANTI JOIN","NATURAL FULL OUTER JOIN","NATURAL INNER JOIN","NATURAL LEFT ANTI JOIN","NATURAL LEFT OUTER JOIN","NATURAL LEFT SEMI JOIN","NATURAL OUTER JOIN","NATURAL RIGHT OUTER JOIN","NATURAL RIGHT SEMI JOIN","NATURAL SEMI JOIN"],y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(d,e);var t,n,i,a=h(d);function d(){return l(this,d),a.apply(this,arguments)}return t=d,(n=[{key:"tokenizer",value:function(){return new o.default({reservedWords:g,reservedTopLevelWords:p,reservedNewlineWords:v,reservedTopLevelWordsNoIndent:m,stringTypes:['""',"''","``","{}"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:["$"],lineCommentTypes:["--"],operators:["!=","<=>","&&","||","=="]})}},{key:"tokenOverride",value:function(e){if((0,r.isWindow)(e)){var t=this.tokenLookAhead();if(t&&t.type===s.default.OPEN_PAREN)return{type:s.default.RESERVED,value:e.value}}if((0,r.isEnd)(e)){var n=this.tokenLookBehind();if(n&&n.type===s.default.OPERATOR&&"."===n.value)return{type:s.default.WORD,value:e.value}}return e}}])&&c(t.prototype,n),i&&c(t,i),d}(i.default);t.default=y,e.exports=t.default}(kH,kH.exports);var LH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(JU.exports),r=o(pH.exports);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=["ABS","ALL","ALLOCATE","ALTER","AND","ANY","ARE","ARRAY","AS","ASENSITIVE","ASYMMETRIC","AT","ATOMIC","AUTHORIZATION","AVG","BEGIN","BETWEEN","BIGINT","BINARY","BLOB","BOOLEAN","BOTH","BY","CALL","CALLED","CARDINALITY","CASCADED","CASE","CAST","CEIL","CEILING","CHAR","CHAR_LENGTH","CHARACTER","CHARACTER_LENGTH","CHECK","CLOB","CLOSE","COALESCE","COLLATE","COLLECT","COLUMN","COMMIT","CONDITION","CONNECT","CONSTRAINT","CONVERT","CORR","CORRESPONDING","COUNT","COVAR_POP","COVAR_SAMP","CREATE","CROSS","CUBE","CUME_DIST","CURRENT","CURRENT_CATALOG","CURRENT_DATE","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CURRENT_USER","CURSOR","CYCLE","DATE","DAY","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DELETE","DENSE_RANK","DEREF","DESCRIBE","DETERMINISTIC","DISCONNECT","DISTINCT","DOUBLE","DROP","DYNAMIC","EACH","ELEMENT","ELSE","END","END-EXEC","ESCAPE","EVERY","EXCEPT","EXEC","EXECUTE","EXISTS","EXP","EXTERNAL","EXTRACT","FALSE","FETCH","FILTER","FLOAT","FLOOR","FOR","FOREIGN","FREE","FROM","FULL","FUNCTION","FUSION","GET","GLOBAL","GRANT","GROUP","GROUPING","HAVING","HOLD","HOUR","IDENTITY","IN","INDICATOR","INNER","INOUT","INSENSITIVE","INSERT","INT","INTEGER","INTERSECT","INTERSECTION","INTERVAL","INTO","IS","JOIN","LANGUAGE","LARGE","LATERAL","LEADING","LEFT","LIKE","LIKE_REGEX","LN","LOCAL","LOCALTIME","LOCALTIMESTAMP","LOWER","MATCH","MAX","MEMBER","MERGE","METHOD","MIN","MINUTE","MOD","MODIFIES","MODULE","MONTH","MULTISET","NATIONAL","NATURAL","NCHAR","NCLOB","NEW","NO","NONE","NORMALIZE","NOT","NULL","NULLIF","NUMERIC","OCTET_LENGTH","OCCURRENCES_REGEX","OF","OLD","ON","ONLY","OPEN","OR","ORDER","OUT","OUTER","OVER","OVERLAPS","OVERLAY","PARAMETER","PARTITION","PERCENT_RANK","PERCENTILE_CONT","PERCENTILE_DISC","POSITION","POSITION_REGEX","POWER","PRECISION","PREPARE","PRIMARY","PROCEDURE","RANGE","RANK","READS","REAL","RECURSIVE","REF","REFERENCES","REFERENCING","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","RELEASE","RESULT","RETURN","RETURNS","REVOKE","RIGHT","ROLLBACK","ROLLUP","ROW","ROW_NUMBER","ROWS","SAVEPOINT","SCOPE","SCROLL","SEARCH","SECOND","SELECT","SENSITIVE","SESSION_USER","SET","SIMILAR","SMALLINT","SOME","SPECIFIC","SPECIFICTYPE","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQRT","START","STATIC","STDDEV_POP","STDDEV_SAMP","SUBMULTISET","SUBSTRING","SUBSTRING_REGEX","SUM","SYMMETRIC","SYSTEM","SYSTEM_USER","TABLE","TABLESAMPLE","THEN","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TRAILING","TRANSLATE","TRANSLATE_REGEX","TRANSLATION","TREAT","TRIGGER","TRIM","TRUE","UESCAPE","UNION","UNIQUE","UNKNOWN","UNNEST","UPDATE","UPPER","USER","USING","VALUE","VALUES","VAR_POP","VAR_SAMP","VARBINARY","VARCHAR","VARYING","WHEN","WHENEVER","WHERE","WIDTH_BUCKET","WINDOW","WITH","WITHIN","WITHOUT","YEAR"],f=["ADD","ALTER COLUMN","ALTER TABLE","CASE","DELETE FROM","END","FETCH FIRST","FETCH NEXT","FETCH PRIOR","FETCH LAST","FETCH ABSOLUTE","FETCH RELATIVE","FROM","GROUP BY","HAVING","INSERT INTO","LIMIT","ORDER BY","SELECT","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],g=["INTERSECT","INTERSECT ALL","INTERSECT DISTINCT","UNION","UNION ALL","UNION DISTINCT","EXCEPT","EXCEPT ALL","EXCEPT DISTINCT"],p=["AND","ELSE","OR","WHEN","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","FULL JOIN","FULL OUTER JOIN","CROSS JOIN","NATURAL JOIN"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,n,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return t=u,(n=[{key:"tokenizer",value:function(){return new r.default({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:g,stringTypes:['""',"''"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[],lineCommentTypes:["--"]})}}])&&a(t.prototype,n),i&&a(t,i),u}(i.default);t.default=m,e.exports=t.default}(LH,LH.exports);var DH={exports:{}};!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(JU.exports),r=o(pH.exports);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(zWe){return!1}}();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=["ADD","EXTERNAL","PROCEDURE","ALL","FETCH","PUBLIC","ALTER","FILE","RAISERROR","AND","FILLFACTOR","READ","ANY","FOR","READTEXT","AS","FOREIGN","RECONFIGURE","ASC","FREETEXT","REFERENCES","AUTHORIZATION","FREETEXTTABLE","REPLICATION","BACKUP","FROM","RESTORE","BEGIN","FULL","RESTRICT","BETWEEN","FUNCTION","RETURN","BREAK","GOTO","REVERT","BROWSE","GRANT","REVOKE","BULK","GROUP","RIGHT","BY","HAVING","ROLLBACK","CASCADE","HOLDLOCK","ROWCOUNT","CASE","IDENTITY","ROWGUIDCOL","CHECK","IDENTITY_INSERT","RULE","CHECKPOINT","IDENTITYCOL","SAVE","CLOSE","IF","SCHEMA","CLUSTERED","IN","SECURITYAUDIT","COALESCE","INDEX","SELECT","COLLATE","INNER","SEMANTICKEYPHRASETABLE","COLUMN","INSERT","SEMANTICSIMILARITYDETAILSTABLE","COMMIT","INTERSECT","SEMANTICSIMILARITYTABLE","COMPUTE","INTO","SESSION_USER","CONSTRAINT","IS","SET","CONTAINS","JOIN","SETUSER","CONTAINSTABLE","KEY","SHUTDOWN","CONTINUE","KILL","SOME","CONVERT","LEFT","STATISTICS","CREATE","LIKE","SYSTEM_USER","CROSS","LINENO","TABLE","CURRENT","LOAD","TABLESAMPLE","CURRENT_DATE","MERGE","TEXTSIZE","CURRENT_TIME","NATIONAL","THEN","CURRENT_TIMESTAMP","NOCHECK","TO","CURRENT_USER","NONCLUSTERED","TOP","CURSOR","NOT","TRAN","DATABASE","NULL","TRANSACTION","DBCC","NULLIF","TRIGGER","DEALLOCATE","OF","TRUNCATE","DECLARE","OFF","TRY_CONVERT","DEFAULT","OFFSETS","TSEQUAL","DELETE","ON","UNION","DENY","OPEN","UNIQUE","DESC","OPENDATASOURCE","UNPIVOT","DISK","OPENQUERY","UPDATE","DISTINCT","OPENROWSET","UPDATETEXT","DISTRIBUTED","OPENXML","USE","DOUBLE","OPTION","USER","DROP","OR","VALUES","DUMP","ORDER","VARYING","ELSE","OUTER","VIEW","END","OVER","WAITFOR","ERRLVL","PERCENT","WHEN","ESCAPE","PIVOT","WHERE","EXCEPT","PLAN","WHILE","EXEC","PRECISION","WITH","EXECUTE","PRIMARY","WITHIN GROUP","EXISTS","PRINT","WRITETEXT","EXIT","PROC"],f=["ADD","ALTER COLUMN","ALTER TABLE","CASE","DELETE FROM","END","EXCEPT","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],g=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],p=["AND","ELSE","OR","WHEN","JOIN","INNER JOIN","LEFT JOIN","LEFT OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","FULL JOIN","FULL OUTER JOIN","CROSS JOIN"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,n,i,o=c(u);function u(){return s(this,u),o.apply(this,arguments)}return t=u,(n=[{key:"tokenizer",value:function(){return new r.default({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:g,stringTypes:['""',"N''","''","[]"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:[],namedPlaceholderTypes:["@"],lineCommentTypes:["--"],specialWordChars:["#","@"],operators:[">=","<=","<>","!=","!<","!>","+=","-=","*=","/=","%=","|=","&=","^=","::"]})}}])&&a(t.prototype,n),i&&a(t,i),u}(i.default);t.default=m,e.exports=t.default}(DH,DH.exports),Object.defineProperty(ZU,"__esModule",{value:!0}),ZU.supportedDialects=HH=ZU.format=void 0;var NH=WH(QU.exports),IH=WH(bH.exports),TH=WH(wH.exports),MH=WH(CH.exports),AH=WH(SH.exports),OH=WH(xH.exports),RH=WH(EH.exports),PH=WH(kH.exports),FH=WH(LH.exports),BH=WH(DH.exports);function WH(e){return e&&e.__esModule?e:{default:e}}function zH(e){return(zH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var VH,UH={db2:NH.default,mariadb:IH.default,mysql:TH.default,n1ql:MH.default,plsql:AH.default,postgresql:OH.default,redshift:RH.default,spark:PH.default,sql:FH.default,tsql:BH.default},HH=ZU.format=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)throw new Error("Invalid query argument. Extected string, instead got "+zH(e));var n=FH.default;if(void 0!==t.language&&(n=UH[t.language]),void 0===n)throw Error("Unsupported SQL dialect: ".concat(t.language));return new n(t).format(e)},jH=Object.keys(UH);function GH(e,t,...n){return function(e,t){let n;return n=0===t.length?e:e.replace(/\{(\d+)\}/g,(function(e,n){const i=n[0];return void 0!==t[i]?t[i]:e})),n}(t,n)}ZU.supportedDialects=jH;let KH,qH,$H,YH=!1,XH=!1,ZH=!1,QH=!1,JH=!1,ej=!1,tj="en";const nj="object"==typeof self?self:"object"==typeof global?global:{};let ij;void 0!==nj.vscode&&void 0!==nj.vscode.process?ij=nj.vscode.process:"undefined"!=typeof process&&(ij=process);const rj="string"==typeof(null===(VH=null==ij?void 0:ij.versions)||void 0===VH?void 0:VH.electron)&&"renderer"===ij.type,oj=rj&&(null==ij?void 0:ij.sandboxed),sj="string"==typeof(()=>{if(oj)return"bypassHeatCheck";const e=null==ij?void 0:ij.env.VSCODE_BROWSER_CODE_LOADING;return"string"==typeof e?"none"===e||"code"===e||"bypassHeatCheck"===e||"bypassHeatCheckAndEagerCompile"===e?e:"bypassHeatCheck":void 0})();if("object"!=typeof navigator||rj)if("object"==typeof ij){YH="win32"===ij.platform,XH="darwin"===ij.platform,ZH="linux"===ij.platform,ZH&&ij.env.SNAP&&ij.env.SNAP_REVISION,KH="en",tj="en";const e=ij.env.VSCODE_NLS_CONFIG;if(e)try{const t=JSON.parse(e),n=t.availableLanguages["*"];KH=t.locale,tj=n||"en",qH=t._translationsConfigFile}catch(zWe){}QH=!0}else console.error("Unable to resolve platform.");else $H=navigator.userAgent,YH=$H.indexOf("Windows")>=0,XH=$H.indexOf("Macintosh")>=0,ej=($H.indexOf("Macintosh")>=0||$H.indexOf("iPad")>=0||$H.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,ZH=$H.indexOf("Linux")>=0,JH=!0,KH=navigator.language,tj=KH;const aj=YH,lj=XH,cj=ZH,uj=QH,hj=JH,dj=ej,fj=$H,gj=function(){if(nj.setImmediate)return nj.setImmediate.bind(nj);if("function"==typeof nj.postMessage&&!nj.importScripts){let e=[];nj.addEventListener("message",(t=>{if(t.data&&t.data.vscodeSetImmediateId)for(let n=0,i=e.length;n<i;n++){const i=e[n];if(i.id===t.data.vscodeSetImmediateId)return e.splice(n,1),void i.callback()}}));let t=0;return n=>{const i=++t;e.push({id:i,callback:n}),nj.postMessage({vscodeSetImmediateId:i},"*")}}if("function"==typeof(null==ij?void 0:ij.nextTick))return ij.nextTick.bind(ij);const e=Promise.resolve();return t=>e.then(t)}(),pj=XH||ej?2:YH?1:3;let mj=!0,vj=!1;function yj(){if(!vj){vj=!0;const e=new Uint8Array(2);e[0]=1,e[1]=2;const t=new Uint16Array(e.buffer);mj=513===t[0]}return mj}const _j=function(e=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(const n of"`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?")e.indexOf(n)>=0||(t+="\\"+n);return t+="\\s]+)",new RegExp(t,"g")}();function bj(e){let t=_j;if(e&&e instanceof RegExp)if(e.global)t=e;else{let n="g";e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.unicode&&(n+="u"),t=new RegExp(e.source,n)}return t.lastIndex=0,t}const wj={maxLen:1e3,windowSize:15,timeBudget:150};function Cj(e,t,n,i,r=wj){if(n.length>r.maxLen){let o=e-r.maxLen/2;return o<0?o=0:i+=o,Cj(e,t,n=n.substring(o,e+r.maxLen/2),i,r)}const o=Date.now(),s=e-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-o>=r.timeBudget);c++){const e=s-r.windowSize*c;t.lastIndex=Math.max(0,e);const i=Sj(t,n,s,a);if(!i&&l)break;if(l=i,e<=0)break;a=e}if(l){let e={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return t.lastIndex=0,e}return null}function Sj(e,t,n,i){let r;for(;r=e.exec(t);){const t=r.index||0;if(t<=n&&e.lastIndex>=n)return r;if(i>0&&t>i)return null}return null}class xj{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class Ej{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class kj{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class Lj{constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}compute(e,t,n){return n}}class Dj{constructor(e,t=null){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0,this.deps=t}validate(e){return this.defaultValue}}class Nj{constructor(e,t,n,i){this.id=e,this.name=t,this.defaultValue=n,this.schema=i}validate(e){return void 0===e?this.defaultValue:e}compute(e,t,n){return n}}function Ij(e,t){return void 0===e?t:"false"!==e&&Boolean(e)}class Tj extends Nj{constructor(e,t,n,i){void 0!==i&&(i.type="boolean",i.default=n),super(e,t,n,i)}validate(e){return Ij(e,this.defaultValue)}}class Mj extends Nj{constructor(e,t,n,i,r,o){void 0!==o&&(o.type="integer",o.default=n,o.minimum=i,o.maximum=r),super(e,t,n,o),this.minimum=i,this.maximum=r}static clampedInt(e,t,n,i){if(void 0===e)return t;let r=parseInt(e,10);return isNaN(r)?t:(r=Math.max(n,r),r=Math.min(i,r),0|r)}validate(e){return Mj.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class Aj extends Nj{constructor(e,t,n,i,r){void 0!==r&&(r.type="number",r.default=n),super(e,t,n,r),this.validationFn=i}static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if("number"==typeof e)return e;if(void 0===e)return t;const n=parseFloat(e);return isNaN(n)?t:n}validate(e){return this.validationFn(Aj.float(e,this.defaultValue))}}class Oj extends Nj{static string(e,t){return"string"!=typeof e?t:e}constructor(e,t,n,i){void 0!==i&&(i.type="string",i.default=n),super(e,t,n,i)}validate(e){return Oj.string(e,this.defaultValue)}}function Rj(e,t,n){return"string"!=typeof e||-1===n.indexOf(e)?t:e}class Pj extends Nj{constructor(e,t,n,i,r){void 0!==r&&(r.type="string",r.enum=i,r.default=n),super(e,t,n,r),this._allowedValues=i}validate(e){return Rj(e,this.defaultValue,this._allowedValues)}}class Fj extends Lj{constructor(e,t,n,i,r,o,s){void 0!==s&&(s.type="string",s.enum=r,s.default=i),super(e,t,n,s),this._allowedValues=r,this._convert=o}validate(e){return"string"!=typeof e||-1===this._allowedValues.indexOf(e)?this.defaultValue:this._convert(e)}}var Bj,Wj;(Wj=Bj||(Bj={}))[Wj.Line=1]="Line",Wj[Wj.Block=2]="Block",Wj[Wj.Underline=3]="Underline",Wj[Wj.LineThin=4]="LineThin",Wj[Wj.BlockOutline=5]="BlockOutline",Wj[Wj.UnderlineThin=6]="UnderlineThin";class zj extends Lj{constructor(){super(41,"fontLigatures",zj.OFF,{anyOf:[{type:"boolean",description:GH(0,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:GH(0,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:GH(0,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return void 0===e?this.defaultValue:"string"==typeof e?"false"===e?zj.OFF:"true"===e?zj.ON:e:Boolean(e)?zj.ON:zj.OFF}}zj.OFF='"liga" off, "calt" off',zj.ON='"liga" on, "calt" on';class Vj extends Lj{constructor(){super(43,"fontWeight",Gj.fontWeight,{anyOf:[{type:"number",minimum:Vj.MINIMUM_VALUE,maximum:Vj.MAXIMUM_VALUE,errorMessage:GH(0,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Vj.SUGGESTION_VALUES}],default:Gj.fontWeight,description:GH(0,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return"normal"===e||"bold"===e?e:String(Mj.clampedInt(e,Gj.fontWeight,Vj.MINIMUM_VALUE,Vj.MAXIMUM_VALUE))}}Vj.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],Vj.MINIMUM_VALUE=1,Vj.MAXIMUM_VALUE=1e3;class Uj extends Dj{constructor(){super(128,[46,55,35,62,90,57,58,92,115,118,119,120,2])}compute(e,t,n){return Uj.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,n=e.scrollBeyondLastLine?t-1:0,i=(e.viewLineCount+n)/(e.pixelRatio*e.height);return{typicalViewportLineCount:t,extraLinesBeyondLastLine:n,desiredRatio:i,minimapLineCount:Math.floor(e.viewLineCount/i)}}static _computeMinimapLayout(e,t){const n=e.outerWidth,i=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};const o=t.stableMinimapLayoutInput,s=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,a=e.lineHeight,l=e.typicalHalfwidthCharacterWidth,c=e.scrollBeyondLastLine,u=e.minimap.renderCharacters;let h=r>=2?Math.round(2*e.minimap.scale):e.minimap.scale;const d=e.minimap.maxColumn,f=e.minimap.size,g=e.minimap.side,p=e.verticalScrollbarWidth,m=e.viewLineCount,v=e.remainingWidth,y=e.isViewportWrapping,_=u?2:3;let b=Math.floor(r*i);const w=b/r;let C=!1,S=!1,x=_*h,E=h/r,k=1;if("fill"===f||"fit"===f){const{typicalViewportLineCount:n,extraLinesBeyondLastLine:o,desiredRatio:l,minimapLineCount:u}=Uj.computeContainedMinimapLineCount({viewLineCount:m,scrollBeyondLastLine:c,height:i,lineHeight:a,pixelRatio:r});if(m/u>1)C=!0,S=!0,h=1,x=1,E=h/r;else{let i=!1,c=h+1;if("fit"===f){const e=Math.ceil((m+o)*x);y&&s&&v<=t.stableFitRemainingWidth?(i=!0,c=t.stableFitMaxMinimapScale):i=e>b}if("fill"===f||i){C=!0;const i=h;x=Math.min(a*r,Math.max(1,Math.floor(1/l))),y&&s&&v<=t.stableFitRemainingWidth&&(c=t.stableFitMaxMinimapScale),h=Math.min(c,Math.max(1,Math.floor(x/_))),h>i&&(k=Math.min(2,h/i)),E=h/r/k,b=Math.ceil(Math.max(n,m+o)*x),y?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=v,t.stableFitMaxMinimapScale=h):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const L=Math.floor(d*E),D=Math.min(L,Math.max(0,Math.floor((v-p-2)*E/(l+E)))+8);let N=Math.floor(r*D);const I=N/r;N=Math.floor(N*k);return{renderMinimap:u?1:2,minimapLeft:"left"===g?0:n-D-p,minimapWidth:D,minimapHeightIsEditorHeight:C,minimapIsSampling:S,minimapScale:h,minimapLineHeight:x,minimapCanvasInnerWidth:N,minimapCanvasInnerHeight:b,minimapCanvasOuterWidth:I,minimapCanvasOuterHeight:w}}static computeLayout(e,t){const n=0|t.outerWidth,i=0|t.outerHeight,r=0|t.lineHeight,o=0|t.lineNumbersDigitCount,s=t.typicalHalfwidthCharacterWidth,a=t.maxDigitWidth,l=t.pixelRatio,c=t.viewLineCount,u=e.get(120),h="inherit"===u?e.get(119):u,d="inherit"===h?e.get(115):h,f=e.get(118),g=e.get(2),p=t.isDominatedByLongLines,m=e.get(46),v=0!==e.get(57).renderType,y=e.get(58),_=e.get(92),b=e.get(62),w=e.get(90),C=w.verticalScrollbarSize,S=w.verticalHasArrows,x=w.arrowSize,E=w.horizontalScrollbarSize,k=e.get(55),L=e.get(35);let D;if("string"==typeof k&&/^\d+(\.\d+)?ch$/.test(k)){const e=parseFloat(k.substr(0,k.length-2));D=Mj.clampedInt(e*s,0,0,1e3)}else D=Mj.clampedInt(k,0,0,1e3);L&&(D+=16);let N=0;if(v){const e=Math.max(o,y);N=Math.round(e*a)}let I=0;m&&(I=r);let T=0,M=T+I,A=M+N,O=A+D;const R=n-I-N-D;let P=!1,F=!1,B=-1;2!==g&&("inherit"===h&&p?(P=!0,F=!0):"on"===d||"bounded"===d?F=!0:"wordWrapColumn"===d&&(B=f));const W=Uj._computeMinimapLayout({outerWidth:n,outerHeight:i,lineHeight:r,typicalHalfwidthCharacterWidth:s,pixelRatio:l,scrollBeyondLastLine:_,minimap:b,verticalScrollbarWidth:C,viewLineCount:c,remainingWidth:R,isViewportWrapping:F},t.memory||new kj);0!==W.renderMinimap&&0===W.minimapLeft&&(T+=W.minimapWidth,M+=W.minimapWidth,A+=W.minimapWidth,O+=W.minimapWidth);const z=R-W.minimapWidth,V=Math.max(1,Math.floor((z-C-2)/s)),U=S?x:0;return F&&(B=Math.max(1,V),"bounded"===d&&(B=Math.min(B,f))),{width:n,height:i,glyphMarginLeft:T,glyphMarginWidth:I,lineNumbersLeft:M,lineNumbersWidth:N,decorationsLeft:A,decorationsWidth:D,contentLeft:O,contentWidth:z,minimap:W,viewportColumn:V,isWordWrapMinified:P,isViewportWrapping:F,wrappingColumn:B,verticalScrollbarWidth:C,horizontalScrollbarHeight:E,overviewRuler:{top:U,width:C,height:i-2*U,right:0}}}}function Hj(e){const t=e.get(85);return"editable"===t?e.get(78):"on"!==t}function jj(e,t){if("string"!=typeof e)return t;switch(e){case"hidden":return 2;case"visible":return 3;default:return 1}}const Gj={fontFamily:lj?"Menlo, Monaco, 'Courier New', monospace":cj?"'Droid Sans Mono', 'monospace', monospace, 'Droid Sans Fallback'":"Consolas, 'Courier New', monospace",fontWeight:"normal",fontSize:lj?12:14,lineHeight:0,letterSpacing:0},Kj=4,qj=4,$j=!0,Yj=!0,Xj=!0,Zj=!0,Qj=[];function Jj(e){return Qj[e.id]=e,e}const eG={acceptSuggestionOnCommitCharacter:Jj(new Tj(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:GH(0,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:Jj(new Pj(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",GH(0,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:GH(0,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:Jj(new class extends Lj{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[GH(0,"The editor will use platform APIs to detect when a Screen Reader is attached."),GH(0,"The editor will be permanently optimized for usage with a Screen Reader. Word wrapping will be disabled."),GH(0,"The editor will never be optimized for usage with a Screen Reader.")],default:"auto",description:GH(0,"Controls whether the editor should run in a mode where it is optimized for screen readers. Setting to on will disable word wrapping.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,n){return 0===n?e.accessibilitySupport:n}}),accessibilityPageSize:Jj(new Mj(3,"accessibilityPageSize",10,1,1073741824,{description:GH(0,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default.")})),ariaLabel:Jj(new Oj(4,"ariaLabel",GH(0,"Editor content"))),autoClosingBrackets:Jj(new Pj(5,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",GH(0,"Use language configurations to determine when to autoclose brackets."),GH(0,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:GH(0,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingDelete:Jj(new Pj(6,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",GH(0,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:GH(0,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:Jj(new Pj(7,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",GH(0,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:GH(0,"Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:Jj(new Pj(8,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",GH(0,"Use language configurations to determine when to autoclose quotes."),GH(0,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:GH(0,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:Jj(new Fj(9,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],(function(e){switch(e){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}),{enumDescriptions:[GH(0,"The editor will not insert indentation automatically."),GH(0,"The editor will keep the current line's indentation."),GH(0,"The editor will keep the current line's indentation and honor language defined brackets."),GH(0,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),GH(0,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:GH(0,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:Jj(new Tj(10,"automaticLayout",!1)),autoSurround:Jj(new Pj(11,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[GH(0,"Use language configurations to determine when to automatically surround selections."),GH(0,"Surround with quotes but not brackets."),GH(0,"Surround with brackets but not quotes."),""],description:GH(0,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),stickyTabStops:Jj(new Tj(102,"stickyTabStops",!1,{description:GH(0,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:Jj(new Tj(12,"codeLens",!0,{description:GH(0,"Controls whether the editor shows CodeLens.")})),codeLensFontFamily:Jj(new Oj(13,"codeLensFontFamily","",{description:GH(0,"Controls the font family for CodeLens.")})),codeLensFontSize:Jj(new Mj(14,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:GH(0,"Controls the font size in pixels for CodeLens. When set to `0`, the 90% of `#editor.fontSize#` is used.")})),colorDecorators:Jj(new Tj(15,"colorDecorators",!0,{description:GH(0,"Controls whether the editor should render the inline color decorators and color picker.")})),columnSelection:Jj(new Tj(16,"columnSelection",!1,{description:GH(0,"Enable that the selection with the mouse and keys is doing column selection.")})),comments:Jj(new class extends Lj{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(17,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:GH(0,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:GH(0,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{insertSpace:Ij(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Ij(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}),contextmenu:Jj(new Tj(18,"contextmenu",!0)),copyWithSyntaxHighlighting:Jj(new Tj(19,"copyWithSyntaxHighlighting",!0,{description:GH(0,"Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:Jj(new Fj(20,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],(function(e){switch(e){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}),{description:GH(0,"Control the cursor animation style.")})),cursorSmoothCaretAnimation:Jj(new Tj(21,"cursorSmoothCaretAnimation",!1,{description:GH(0,"Controls whether the smooth caret animation should be enabled.")})),cursorStyle:Jj(new Fj(22,"cursorStyle",Bj.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],(function(e){switch(e){case"line":return Bj.Line;case"block":return Bj.Block;case"underline":return Bj.Underline;case"line-thin":return Bj.LineThin;case"block-outline":return Bj.BlockOutline;case"underline-thin":return Bj.UnderlineThin}}),{description:GH(0,"Controls the cursor style.")})),cursorSurroundingLines:Jj(new Mj(23,"cursorSurroundingLines",0,0,1073741824,{description:GH(0,"Controls the minimal number of visible leading and trailing lines surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:Jj(new Pj(24,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[GH(0,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),GH(0,"`cursorSurroundingLines` is enforced always.")],description:GH(0,"Controls when `cursorSurroundingLines` should be enforced.")})),cursorWidth:Jj(new Mj(25,"cursorWidth",0,0,1073741824,{markdownDescription:GH(0,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:Jj(new Tj(26,"disableLayerHinting",!1)),disableMonospaceOptimizations:Jj(new Tj(27,"disableMonospaceOptimizations",!1)),domReadOnly:Jj(new Tj(28,"domReadOnly",!1)),dragAndDrop:Jj(new Tj(29,"dragAndDrop",!0,{description:GH(0,"Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:Jj(new class extends Tj{constructor(){super(30,"emptySelectionClipboard",!0,{description:GH(0,"Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}}),extraEditorClassName:Jj(new Oj(31,"extraEditorClassName","")),fastScrollSensitivity:Jj(new Aj(32,"fastScrollSensitivity",5,(e=>e<=0?5:e),{markdownDescription:GH(0,"Scrolling speed multiplier when pressing `Alt`.")})),find:Jj(new class extends Lj{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:!0,autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(33,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:GH(0,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"boolean",default:e.seedSearchStringFromSelection,description:GH(0,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[GH(0,"Never turn on Find in selection automatically (default)."),GH(0,"Always turn on Find in selection automatically."),GH(0,"Turn on Find in selection automatically when multiple lines of content are selected.")],description:GH(0,"Controls the condition for turning on find in selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:GH(0,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:lj},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:GH(0,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:GH(0,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{cursorMoveOnType:Ij(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:Ij(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection),autoFindInSelection:"boolean"==typeof e.autoFindInSelection?e.autoFindInSelection?"always":"never":Rj(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Ij(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Ij(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Ij(t.loop,this.defaultValue.loop)}}}),fixedOverflowWidgets:Jj(new Tj(34,"fixedOverflowWidgets",!1)),folding:Jj(new Tj(35,"folding",!0,{description:GH(0,"Controls whether the editor has code folding enabled.")})),foldingStrategy:Jj(new Pj(36,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[GH(0,"Use a language-specific folding strategy if available, else the indentation-based one."),GH(0,"Use the indentation-based folding strategy.")],description:GH(0,"Controls the strategy for computing folding ranges.")})),foldingHighlight:Jj(new Tj(37,"foldingHighlight",!0,{description:GH(0,"Controls whether the editor should highlight folded ranges.")})),unfoldOnClickAfterEndOfLine:Jj(new Tj(38,"unfoldOnClickAfterEndOfLine",!1,{description:GH(0,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:Jj(new Oj(39,"fontFamily",Gj.fontFamily,{description:GH(0,"Controls the font family.")})),fontInfo:Jj(new class extends Dj{constructor(){super(40)}compute(e,t,n){return e.fontInfo}}),fontLigatures2:Jj(new zj),fontSize:Jj(new class extends Nj{constructor(){super(42,"fontSize",Gj.fontSize,{type:"number",minimum:6,maximum:100,default:Gj.fontSize,description:GH(0,"Controls the font size in pixels.")})}validate(e){let t=Aj.float(e,this.defaultValue);return 0===t?Gj.fontSize:Aj.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}}),fontWeight:Jj(new Vj),formatOnPaste:Jj(new Tj(44,"formatOnPaste",!1,{description:GH(0,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:Jj(new Tj(45,"formatOnType",!1,{description:GH(0,"Controls whether the editor should automatically format the line after typing.")})),glyphMargin:Jj(new Tj(46,"glyphMargin",!0,{description:GH(0,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:Jj(new class extends Lj{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[GH(0,"Show peek view of the results (default)"),GH(0,"Go to the primary result and show a peek view"),GH(0,"Go to the primary result and enable peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(47,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:GH(0,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":Object.assign({description:GH(0,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleTypeDefinitions":Object.assign({description:GH(0,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleDeclarations":Object.assign({description:GH(0,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleImplementations":Object.assign({description:GH(0,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleReferences":Object.assign({description:GH(0,"Controls the behavior the 'Go to References'-command when multiple target locations exist.")},t),"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:GH(0,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:GH(0,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:GH(0,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:GH(0,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:GH(0,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){var t,n,i,r,o;if(!e||"object"!=typeof e)return this.defaultValue;const s=e;return{multiple:Rj(s.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:null!==(t=s.multipleDefinitions)&&void 0!==t?t:Rj(s.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:null!==(n=s.multipleTypeDefinitions)&&void 0!==n?n:Rj(s.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:null!==(i=s.multipleDeclarations)&&void 0!==i?i:Rj(s.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:null!==(r=s.multipleImplementations)&&void 0!==r?r:Rj(s.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:null!==(o=s.multipleReferences)&&void 0!==o?o:Rj(s.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Oj.string(s.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Oj.string(s.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Oj.string(s.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Oj.string(s.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Oj.string(s.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}),hideCursorInOverviewRuler:Jj(new Tj(48,"hideCursorInOverviewRuler",!1,{description:GH(0,"Controls whether the cursor should be hidden in the overview ruler.")})),highlightActiveIndentGuide:Jj(new Tj(49,"highlightActiveIndentGuide",!0,{description:GH(0,"Controls whether the editor should highlight the active indent guide.")})),hover:Jj(new class extends Lj{constructor(){const e={enabled:!0,delay:300,sticky:!0};super(50,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:GH(0,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,description:GH(0,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:GH(0,"Controls whether the hover should remain visible when mouse is moved over it.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:Ij(t.enabled,this.defaultValue.enabled),delay:Mj.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Ij(t.sticky,this.defaultValue.sticky)}}}),inDiffEditor:Jj(new Tj(51,"inDiffEditor",!1)),letterSpacing:Jj(new Aj(53,"letterSpacing",Gj.letterSpacing,(e=>Aj.clamp(e,-5,20)),{description:GH(0,"Controls the letter spacing in pixels.")})),lightbulb:Jj(new class extends Lj{constructor(){const e={enabled:!0};super(54,"lightbulb",e,{"editor.lightbulb.enabled":{type:"boolean",default:e.enabled,description:GH(0,"Enables the code action lightbulb in the editor.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;return{enabled:Ij(e.enabled,this.defaultValue.enabled)}}}),lineDecorationsWidth:Jj(new Nj(55,"lineDecorationsWidth",10)),lineHeight:Jj(new class extends Aj{constructor(){super(56,"lineHeight",Gj.lineHeight,(e=>Aj.clamp(e,0,150)),{markdownDescription:GH(0,"Controls the line height. \n - Use 0 to automatically compute the line height from the font size.\n - Values between 0 and 8 will be used as a multiplier with the font size.\n - Values greater than or equal to 8 will be used as effective values.")})}compute(e,t,n){return e.fontInfo.lineHeight}}),lineNumbers:Jj(new class extends Lj{constructor(){super(57,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[GH(0,"Line numbers are not rendered."),GH(0,"Line numbers are rendered as absolute number."),GH(0,"Line numbers are rendered as distance in lines to cursor position."),GH(0,"Line numbers are rendered every 10 lines.")],default:"on",description:GH(0,"Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return void 0!==e&&("function"==typeof e?(t=4,n=e):t="interval"===e?3:"relative"===e?2:"on"===e?1:0),{renderType:t,renderFn:n}}}),lineNumbersMinChars:Jj(new Mj(58,"lineNumbersMinChars",5,1,300)),linkedEditing:Jj(new Tj(59,"linkedEditing",!1,{description:GH(0,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols, e.g. HTML tags, are updated while editing.")})),links:Jj(new Tj(60,"links",!0,{description:GH(0,"Controls whether the editor should detect links and make them clickable.")})),matchBrackets:Jj(new Pj(61,"matchBrackets","always",["always","near","never"],{description:GH(0,"Highlight matching brackets.")})),minimap:Jj(new class extends Lj{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",renderCharacters:!0,maxColumn:120,scale:1};super(62,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:GH(0,"Controls whether the minimap is shown.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[GH(0,"The minimap has the same size as the editor contents (and might scroll)."),GH(0,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),GH(0,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:GH(0,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:GH(0,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:GH(0,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:GH(0,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:GH(0,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:GH(0,"Limit the width of the minimap to render at most a certain number of columns.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:Ij(t.enabled,this.defaultValue.enabled),size:Rj(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:Rj(t.side,this.defaultValue.side,["right","left"]),showSlider:Rj(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Ij(t.renderCharacters,this.defaultValue.renderCharacters),scale:Mj.clampedInt(t.scale,1,1,3),maxColumn:Mj.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}),mouseStyle:Jj(new Pj(63,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:Jj(new Aj(64,"mouseWheelScrollSensitivity",1,(e=>0===e?1:e),{markdownDescription:GH(0,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:Jj(new Tj(65,"mouseWheelZoom",!1,{markdownDescription:GH(0,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:Jj(new Tj(66,"multiCursorMergeOverlapping",!0,{description:GH(0,"Merge multiple cursors when they are overlapping.")})),multiCursorModifier:Jj(new Fj(67,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],(function(e){return"ctrlCmd"===e?lj?"metaKey":"ctrlKey":"altKey"}),{markdownEnumDescriptions:[GH(0,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),GH(0,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:GH(0,"The modifier to be used to add multiple cursors with the mouse. The Go To Definition and Open Link mouse gestures will adapt such that they do not conflict with the multicursor modifier. [Read more](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:Jj(new Pj(68,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[GH(0,"Each cursor pastes a single line of the text."),GH(0,"Each cursor pastes the full text.")],markdownDescription:GH(0,"Controls pasting when the line count of the pasted text matches the cursor count.")})),occurrencesHighlight:Jj(new Tj(69,"occurrencesHighlight",!0,{description:GH(0,"Controls whether the editor should highlight semantic symbol occurrences.")})),overviewRulerBorder:Jj(new Tj(70,"overviewRulerBorder",!0,{description:GH(0,"Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:Jj(new Mj(71,"overviewRulerLanes",3,0,3)),padding:Jj(new class extends Lj{constructor(){super(72,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:GH(0,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:GH(0,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{top:Mj.clampedInt(t.top,0,0,1e3),bottom:Mj.clampedInt(t.bottom,0,0,1e3)}}}),parameterHints:Jj(new class extends Lj{constructor(){const e={enabled:!0,cycle:!1};super(73,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:GH(0,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:GH(0,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:Ij(t.enabled,this.defaultValue.enabled),cycle:Ij(t.cycle,this.defaultValue.cycle)}}}),peekWidgetDefaultFocus:Jj(new Pj(74,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[GH(0,"Focus the tree when opening peek"),GH(0,"Focus the editor when opening peek")],description:GH(0,"Controls whether to focus the inline editor or the tree in the peek widget.")})),definitionLinkOpensInPeek:Jj(new Tj(75,"definitionLinkOpensInPeek",!1,{description:GH(0,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:Jj(new class extends Lj{constructor(){const e={other:!0,comments:!1,strings:!1};super(76,"quickSuggestions",e,{anyOf:[{type:"boolean"},{type:"object",properties:{strings:{type:"boolean",default:e.strings,description:GH(0,"Enable quick suggestions inside strings.")},comments:{type:"boolean",default:e.comments,description:GH(0,"Enable quick suggestions inside comments.")},other:{type:"boolean",default:e.other,description:GH(0,"Enable quick suggestions outside of strings and comments.")}}}],default:e,description:GH(0,"Controls whether suggestions should automatically show up while typing.")}),this.defaultValue=e}validate(e){if("boolean"==typeof e)return e;if(e&&"object"==typeof e){const t=e,n={other:Ij(t.other,this.defaultValue.other),comments:Ij(t.comments,this.defaultValue.comments),strings:Ij(t.strings,this.defaultValue.strings)};return!!(n.other&&n.comments&&n.strings)||!!(n.other||n.comments||n.strings)&&n}return this.defaultValue}}),quickSuggestionsDelay:Jj(new Mj(77,"quickSuggestionsDelay",10,0,1073741824,{description:GH(0,"Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:Jj(new Tj(78,"readOnly",!1)),renameOnType:Jj(new Tj(79,"renameOnType",!1,{description:GH(0,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:GH(0,"Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:Jj(new Tj(80,"renderControlCharacters",!1,{description:GH(0,"Controls whether the editor should render control characters.")})),renderIndentGuides:Jj(new Tj(81,"renderIndentGuides",!0,{description:GH(0,"Controls whether the editor should render indent guides.")})),renderFinalNewline:Jj(new Tj(82,"renderFinalNewline",!0,{description:GH(0,"Render last line number when the file ends with a newline.")})),renderLineHighlight:Jj(new Pj(83,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",GH(0,"Highlights both the gutter and the current line.")],description:GH(0,"Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:Jj(new Tj(84,"renderLineHighlightOnlyWhenFocus",!1,{description:GH(0,"Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:Jj(new Pj(85,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:Jj(new Pj(86,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",GH(0,"Render whitespace characters except for single spaces between words."),GH(0,"Render whitespace characters only on selected text."),GH(0,"Render only trailing whitespace characters."),""],description:GH(0,"Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:Jj(new Mj(87,"revealHorizontalRightPadding",30,0,1e3)),roundedSelection:Jj(new Tj(88,"roundedSelection",!0,{description:GH(0,"Controls whether selections should have rounded corners.")})),rulers:Jj(new class extends Lj{constructor(){const e=[],t={type:"number",description:GH(0,"Number of monospace characters at which this editor ruler will render.")};super(89,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:GH(0,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:GH(0,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if("number"==typeof n)t.push({column:Mj.clampedInt(n,0,0,1e4),color:null});else if(n&&"object"==typeof n){const e=n;t.push({column:Mj.clampedInt(e.column,0,0,1e4),color:e.color})}return t.sort(((e,t)=>e.column-t.column)),t}return this.defaultValue}}),scrollbar:Jj(new class extends Lj{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1};super(90,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[GH(0,"The vertical scrollbar will be visible only when necessary."),GH(0,"The vertical scrollbar will always be visible."),GH(0,"The vertical scrollbar will always be hidden.")],default:"auto",description:GH(0,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[GH(0,"The horizontal scrollbar will be visible only when necessary."),GH(0,"The horizontal scrollbar will always be visible."),GH(0,"The horizontal scrollbar will always be hidden.")],default:"auto",description:GH(0,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:GH(0,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:GH(0,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:GH(0,"Controls whether clicks scroll by page or jump to click position.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e,n=Mj.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),i=Mj.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Mj.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:jj(t.vertical,this.defaultValue.vertical),horizontal:jj(t.horizontal,this.defaultValue.horizontal),useShadows:Ij(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Ij(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Ij(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Ij(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Ij(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:Mj.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:i,verticalSliderSize:Mj.clampedInt(t.verticalSliderSize,i,0,1e3),scrollByPage:Ij(t.scrollByPage,this.defaultValue.scrollByPage)}}}),scrollBeyondLastColumn:Jj(new Mj(91,"scrollBeyondLastColumn",5,0,1073741824,{description:GH(0,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:Jj(new Tj(92,"scrollBeyondLastLine",!0,{description:GH(0,"Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:Jj(new Tj(93,"scrollPredominantAxis",!0,{description:GH(0,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:Jj(new Tj(94,"selectionClipboard",!0,{description:GH(0,"Controls whether the Linux primary clipboard should be supported."),included:cj})),selectionHighlight:Jj(new Tj(95,"selectionHighlight",!0,{description:GH(0,"Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:Jj(new Tj(96,"selectOnLineNumbers",!0)),showFoldingControls:Jj(new Pj(97,"showFoldingControls","mouseover",["always","mouseover"],{enumDescriptions:[GH(0,"Always show the folding controls."),GH(0,"Only show the folding controls when the mouse is over the gutter.")],description:GH(0,"Controls when the folding controls on the gutter are shown.")})),showUnused:Jj(new Tj(98,"showUnused",!0,{description:GH(0,"Controls fading out of unused code.")})),showDeprecated:Jj(new Tj(123,"showDeprecated",!0,{description:GH(0,"Controls strikethrough deprecated variables.")})),inlayHints:Jj(new class extends Lj{constructor(){const e={enabled:!0,fontSize:0,fontFamily:Gj.fontFamily};super(124,"inlayHints",e,{"editor.inlayHints.enabled":{type:"boolean",default:e.enabled,description:GH(0,"Enables the inlay hints in the editor.")},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:GH(0,"Controls font size of inlay hints in the editor. When set to `0`, the 90% of `#editor.fontSize#` is used.")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,description:GH(0,"Controls font family of inlay hints in the editor.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:Ij(t.enabled,this.defaultValue.enabled),fontSize:Mj.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Oj.string(t.fontFamily,this.defaultValue.fontFamily)}}}),snippetSuggestions:Jj(new Pj(99,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[GH(0,"Show snippet suggestions on top of other suggestions."),GH(0,"Show snippet suggestions below other suggestions."),GH(0,"Show snippets suggestions with other suggestions."),GH(0,"Do not show snippet suggestions.")],description:GH(0,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:Jj(new class extends Lj{constructor(){super(100,"smartSelect",{selectLeadingAndTrailingWhitespace:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:GH(0,"Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"}})}validate(e){return e&&"object"==typeof e?{selectLeadingAndTrailingWhitespace:Ij(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace)}:this.defaultValue}}),smoothScrolling:Jj(new Tj(101,"smoothScrolling",!1,{description:GH(0,"Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:Jj(new Mj(103,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:Jj(new class extends Lj{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!0,localityBonus:!1,shareSuggestSelections:!1,showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"prefix",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(104,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[GH(0,"Insert suggestion without overwriting text right of the cursor."),GH(0,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:GH(0,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:GH(0,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:GH(0,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:GH(0,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:GH(0,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:GH(0,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:GH(0,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:GH(0,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.previewMode":{type:"string",enum:["prefix","subwordDiff"],enumDescriptions:[GH(0,"Only render a preview if the replace text is a prefix of the insert text."),GH(0,"Only render a preview if the replace text is a subword of the insert text.")],default:e.previewMode,description:GH(0,"Controls which mode to use for rendering the suggest preview.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:GH(0,"Controls whether suggest details show inline with the label or only in the details widget")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:GH(0,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:GH(0,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:GH(0,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{insertMode:Rj(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Ij(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Ij(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Ij(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Ij(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),showIcons:Ij(t.showIcons,this.defaultValue.showIcons),showStatusBar:Ij(t.showStatusBar,this.defaultValue.showStatusBar),preview:Ij(t.preview,this.defaultValue.preview),previewMode:Rj(t.previewMode,this.defaultValue.previewMode,["prefix","subwordDiff"]),showInlineDetails:Ij(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Ij(t.showMethods,this.defaultValue.showMethods),showFunctions:Ij(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Ij(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Ij(t.showDeprecated,this.defaultValue.showDeprecated),showFields:Ij(t.showFields,this.defaultValue.showFields),showVariables:Ij(t.showVariables,this.defaultValue.showVariables),showClasses:Ij(t.showClasses,this.defaultValue.showClasses),showStructs:Ij(t.showStructs,this.defaultValue.showStructs),showInterfaces:Ij(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Ij(t.showModules,this.defaultValue.showModules),showProperties:Ij(t.showProperties,this.defaultValue.showProperties),showEvents:Ij(t.showEvents,this.defaultValue.showEvents),showOperators:Ij(t.showOperators,this.defaultValue.showOperators),showUnits:Ij(t.showUnits,this.defaultValue.showUnits),showValues:Ij(t.showValues,this.defaultValue.showValues),showConstants:Ij(t.showConstants,this.defaultValue.showConstants),showEnums:Ij(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Ij(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Ij(t.showKeywords,this.defaultValue.showKeywords),showWords:Ij(t.showWords,this.defaultValue.showWords),showColors:Ij(t.showColors,this.defaultValue.showColors),showFiles:Ij(t.showFiles,this.defaultValue.showFiles),showReferences:Ij(t.showReferences,this.defaultValue.showReferences),showFolders:Ij(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Ij(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Ij(t.showSnippets,this.defaultValue.showSnippets),showUsers:Ij(t.showUsers,this.defaultValue.showUsers),showIssues:Ij(t.showIssues,this.defaultValue.showIssues)}}}),inlineSuggest:Jj(new class extends Lj{constructor(){const e={enabled:!1,mode:"subwordDiff"};super(52,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:GH(0,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.mode":{type:"string",enum:["prefix","subwordDiff"],enumDescriptions:[GH(0,"Only render an inline suggestion if the replace text is a prefix of the insert text."),GH(0,"Only render an inline suggestion if the replace text is a subword of the insert text.")],default:e.mode,description:GH(0,"Controls which mode to use for rendering inline suggestions.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:Ij(t.enabled,this.defaultValue.enabled),mode:Rj(t.mode,this.defaultValue.mode,["prefix","subwordDiff"])}}}),suggestFontSize:Jj(new Mj(105,"suggestFontSize",0,0,1e3,{markdownDescription:GH(0,"Font size for the suggest widget. When set to `0`, the value of `#editor.fontSize#` is used.")})),suggestLineHeight:Jj(new Mj(106,"suggestLineHeight",0,0,1e3,{markdownDescription:GH(0,"Line height for the suggest widget. When set to `0`, the value of `#editor.lineHeight#` is used. The minimum value is 8.")})),suggestOnTriggerCharacters:Jj(new Tj(107,"suggestOnTriggerCharacters",!0,{description:GH(0,"Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:Jj(new Pj(108,"suggestSelection","recentlyUsed",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[GH(0,"Always select the first suggestion."),GH(0,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),GH(0,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:GH(0,"Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:Jj(new Pj(109,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[GH(0,"Tab complete will insert the best matching suggestion when pressing tab."),GH(0,"Disable tab completions."),GH(0,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:GH(0,"Enables tab completions.")})),tabIndex:Jj(new Mj(110,"tabIndex",0,-1,1073741824)),unusualLineTerminators:Jj(new Pj(111,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[GH(0,"Unusual line terminators are automatically removed."),GH(0,"Unusual line terminators are ignored."),GH(0,"Unusual line terminators prompt to be removed.")],description:GH(0,"Remove unusual line terminators that might cause problems.")})),useShadowDOM:Jj(new Tj(112,"useShadowDOM",!0)),useTabStops:Jj(new Tj(113,"useTabStops",!0,{description:GH(0,"Inserting and deleting whitespace follows tab stops.")})),wordSeparators:Jj(new Oj(114,"wordSeparators","`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?",{description:GH(0,"Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:Jj(new Pj(115,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[GH(0,"Lines will never wrap."),GH(0,"Lines will wrap at the viewport width."),GH(0,"Lines will wrap at `#editor.wordWrapColumn#`."),GH(0,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:GH(0,"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:Jj(new Oj(116,"wordWrapBreakAfterCharacters"," \t})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:Jj(new Oj(117,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:Jj(new Mj(118,"wordWrapColumn",80,1,1073741824,{markdownDescription:GH(0,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:Jj(new Pj(119,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:Jj(new Pj(120,"wordWrapOverride2","inherit",["off","on","inherit"])),wrappingIndent:Jj(new Fj(121,"wrappingIndent",1,"same",["none","same","indent","deepIndent"],(function(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}}),{enumDescriptions:[GH(0,"No indentation. Wrapped lines begin at column 1."),GH(0,"Wrapped lines get the same indentation as the parent."),GH(0,"Wrapped lines get +1 indentation toward the parent."),GH(0,"Wrapped lines get +2 indentation toward the parent.")],description:GH(0,"Controls the indentation of wrapped lines.")})),wrappingStrategy:Jj(new Pj(122,"wrappingStrategy","simple",["simple","advanced"],{enumDescriptions:[GH(0,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),GH(0,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],description:GH(0,"Controls the algorithm that computes wrapping points.")})),editorClassName:Jj(new class extends Dj{constructor(){super(125,[63,31])}compute(e,t,n){const i=["monaco-editor"];return t.get(31)&&i.push(t.get(31)),e.extraEditorClassName&&i.push(e.extraEditorClassName),"default"===t.get(63)?i.push("mouse-default"):"copy"===t.get(63)&&i.push("mouse-copy"),t.get(98)&&i.push("showUnused"),t.get(123)&&i.push("showDeprecated"),i.join(" ")}}),pixelRatio:Jj(new class extends Dj{constructor(){super(126)}compute(e,t,n){return e.pixelRatio}}),tabFocusMode:Jj(new class extends Dj{constructor(){super(127,[78])}compute(e,t,n){return!!t.get(78)||e.tabFocusMode}}),layoutInfo:Jj(new Uj),wrappingInfo:Jj(new class extends Dj{constructor(){super(129,[128])}compute(e,t,n){const i=t.get(128);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:i.isWordWrapMinified,isViewportWrapping:i.isViewportWrapping,wrappingColumn:i.wrappingColumn}}})};const tG=new class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout((()=>{if(e.stack)throw new Error(e.message+"\n\n"+e.stack);throw e}),0)}}emit(e){this.listeners.forEach((t=>{t(e)}))}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};function nG(e){oG(e)||tG.onUnexpectedError(e)}function iG(e){oG(e)||tG.onUnexpectedExternalError(e)}function rG(e){if(e instanceof Error){let{name:t,message:n}=e;return{$isError:!0,name:t,message:n,stack:e.stacktrace||e.stack}}return e}function oG(e){return e instanceof Error&&"Canceled"===e.name&&"Canceled"===e.message}function sG(){const e=new Error("Canceled");return e.name=e.message,e}function aG(e){return e?new Error(`Illegal argument: ${e}`):new Error("Illegal argument")}var lG;function cG(e){}!function(e){e.is=function(e){return e&&"object"==typeof e&&"function"==typeof e[Symbol.iterator]};const t=Object.freeze([]);e.empty=function(){return t},e.single=function*(e){yield e},e.from=function(e){return e||t},e.isEmpty=function(e){return!e||!0===e[Symbol.iterator]().next().done},e.first=function(e){return e[Symbol.iterator]().next().value},e.some=function(e,t){for(const n of e)if(t(n))return!0;return!1},e.find=function(e,t){for(const n of e)if(t(n))return n},e.filter=function*(e,t){for(const n of e)t(n)&&(yield n)},e.map=function*(e,t){let n=0;for(const i of e)yield t(i,n++)},e.concat=function*(...e){for(const t of e)for(const e of t)yield e},e.concatNested=function*(e){for(const t of e)for(const e of t)yield e},e.reduce=function(e,t,n){let i=n;for(const r of e)i=t(i,r);return i},e.slice=function*(e,t,n=e.length){for(t<0&&(t+=e.length),n<0?n+=e.length:n>e.length&&(n=e.length);t<n;t++)yield e[t]},e.consume=function(t,n=Number.POSITIVE_INFINITY){const i=[];if(0===n)return[i,t];const r=t[Symbol.iterator]();for(let o=0;o<n;o++){const t=r.next();if(t.done)return[i,e.empty()];i.push(t.value)}return[i,{[Symbol.iterator]:()=>r}]},e.equals=function(e,t,n=((e,t)=>e===t)){const i=e[Symbol.iterator](),r=t[Symbol.iterator]();for(;;){const e=i.next(),t=r.next();if(e.done!==t.done)return!1;if(e.done)return!0;if(!n(e.value,t.value))return!1}}}(lG||(lG={}));class uG extends Error{constructor(e){super(`Encountered errors while disposing of store. Errors: [${e.join(", ")}]`),this.errors=e}}function hG(e){return"function"==typeof e.dispose&&0===e.dispose.length}function dG(e){if(lG.is(e)){let t=[];for(const n of e)if(n)try{n.dispose()}catch(zWe){t.push(zWe)}if(1===t.length)throw t[0];if(t.length>1)throw new uG(t);return Array.isArray(e)?[]:e}if(e)return e.dispose(),e}function fG(...e){return e.forEach(cG),gG((()=>dG(e)))}function gG(e){return{dispose:()=>{e()}}}class pG{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}clear(){try{dG(this._toDispose.values())}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?pG.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}}pG.DISABLE_DISPOSED_WARNING=!1;class mG{constructor(){this._store=new pG}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}}mG.None=Object.freeze({dispose(){}});class vG{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||(null===(t=this._value)||void 0===t||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,null===(e=this._value)||void 0===e||e.dispose(),this._value=void 0}}class yG{constructor(e){this.object=e}dispose(){}}class _G{constructor(e){this.element=e,this.next=_G.Undefined,this.prev=_G.Undefined}}_G.Undefined=new _G(void 0);class bG{constructor(){this._first=_G.Undefined,this._last=_G.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===_G.Undefined}clear(){let e=this._first;for(;e!==_G.Undefined;){const t=e.next;e.prev=_G.Undefined,e.next=_G.Undefined,e=t}this._first=_G.Undefined,this._last=_G.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const n=new _G(e);if(this._first===_G.Undefined)this._first=n,this._last=n;else if(t){const e=this._last;this._last=n,n.prev=e,e.next=n}else{const e=this._first;this._first=n,n.next=e,e.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==_G.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==_G.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==_G.Undefined&&e.next!==_G.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===_G.Undefined&&e.next===_G.Undefined?(this._first=_G.Undefined,this._last=_G.Undefined):e.next===_G.Undefined?(this._last=this._last.prev,this._last.next=_G.Undefined):e.prev===_G.Undefined&&(this._first=this._first.next,this._first.prev=_G.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==_G.Undefined;)yield e.element,e=e.next}}const wG=nj.performance&&"function"==typeof nj.performance.now;class CG{constructor(e){this._highResolution=wG&&e,this._startTime=this._now(),this._stopTime=-1}static create(e=!0){return new CG(e)}stop(){this._stopTime=this._now()}elapsed(){return-1!==this._stopTime?this._stopTime-this._startTime:this._now()-this._startTime}_now(){return this._highResolution?nj.performance.now():Date.now()}}var SG;!function(e){function t(e){return(t,n=null,i)=>{let r,o=!1;return r=e((e=>{if(!o)return r?r.dispose():o=!0,t.call(n,e)}),null,i),o&&r.dispose(),r}}function n(e,t){return s(((n,i=null,r)=>e((e=>n.call(i,t(e))),null,r)))}function i(e,t){return s(((n,i=null,r)=>e((e=>{t(e),n.call(i,e)}),null,r)))}function r(e,t){return s(((n,i=null,r)=>e((e=>t(e)&&n.call(i,e)),null,r)))}function o(e,t,i){let r=i;return n(e,(e=>(r=t(r,e),r)))}function s(e){let t;const n=new EG({onFirstListenerAdd(){t=e(n.fire,n)},onLastListenerRemove(){t.dispose()}});return n.event}function a(e,t,n=100,i=!1,r){let o,s,a,l=0;const c=new EG({leakWarningThreshold:r,onFirstListenerAdd(){o=e((e=>{l++,s=t(s,e),i&&!a&&(c.fire(s),s=void 0),clearTimeout(a),a=setTimeout((()=>{const e=s;s=void 0,a=void 0,(!i||l>1)&&c.fire(e),l=0}),n)}))},onLastListenerRemove(){o.dispose()}});return c.event}function l(e,t=((e,t)=>e===t)){let n,i=!0;return r(e,(e=>{const r=i||!t(e,n);return i=!1,n=e,r}))}e.None=()=>mG.None,e.once=t,e.map=n,e.forEach=i,e.filter=r,e.signal=function(e){return e},e.any=function(...e){return(t,n=null,i)=>fG(...e.map((e=>e((e=>t.call(n,e)),null,i))))},e.reduce=o,e.debounce=a,e.latch=l,e.split=function(t,n){return[e.filter(t,n),e.filter(t,(e=>!n(e)))]},e.buffer=function(e,t=!1,n=[]){let i=n.slice(),r=e((e=>{i?i.push(e):s.fire(e)}));const o=()=>{i&&i.forEach((e=>s.fire(e))),i=null},s=new EG({onFirstListenerAdd(){r||(r=e((e=>s.fire(e))))},onFirstListenerDidAdd(){i&&(t?setTimeout(o):o())},onLastListenerRemove(){r&&r.dispose(),r=null}});return s.event};class c{constructor(e){this.event=e}map(e){return new c(n(this.event,e))}forEach(e){return new c(i(this.event,e))}filter(e){return new c(r(this.event,e))}reduce(e,t){return new c(o(this.event,e,t))}latch(){return new c(l(this.event))}debounce(e,t=100,n=!1,i){return new c(a(this.event,e,t,n,i))}on(e,t,n){return this.event(e,t,n)}once(e,n,i){return t(this.event)(e,n,i)}}e.chain=function(e){return new c(e)},e.fromNodeEventEmitter=function(e,t,n=(e=>e)){const i=(...e)=>r.fire(n(...e)),r=new EG({onFirstListenerAdd:()=>e.on(t,i),onLastListenerRemove:()=>e.removeListener(t,i)});return r.event},e.fromDOMEventEmitter=function(e,t,n=(e=>e)){const i=(...e)=>r.fire(n(...e)),r=new EG({onFirstListenerAdd:()=>e.addEventListener(t,i),onLastListenerRemove:()=>e.removeEventListener(t,i)});return r.event},e.toPromise=function(e){return new Promise((n=>t(e)(n)))}}(SG||(SG={}));class xG{constructor(e){this._listenerCount=0,this._invocationCount=0,this._elapsedOverall=0,this._name=`${e}_${xG._idPool++}`}start(e){this._stopWatch=new CG(!0),this._listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this._elapsedOverall+=e,this._invocationCount+=1,console.info(`did FIRE ${this._name}: elapsed_ms: ${e.toFixed(5)}, listener: ${this._listenerCount} (elapsed_overall: ${this._elapsedOverall.toFixed(2)}, invocations: ${this._invocationCount})`),this._stopWatch=void 0}}}xG._idPool=0;class EG{constructor(e){var t;this._disposed=!1,this._options=e,this._leakageMon=void 0,this._perfMon=(null===(t=this._options)||void 0===t?void 0:t._profName)?new xG(this._options._profName):void 0}get event(){return this._event||(this._event=(e,t,n)=>{var i;this._listeners||(this._listeners=new bG);const r=this._listeners.isEmpty();r&&this._options&&this._options.onFirstListenerAdd&&this._options.onFirstListenerAdd(this);const o=this._listeners.push(t?[e,t]:e);r&&this._options&&this._options.onFirstListenerDidAdd&&this._options.onFirstListenerDidAdd(this),this._options&&this._options.onListenerDidAdd&&this._options.onListenerDidAdd(this,e,t);const s=null===(i=this._leakageMon)||void 0===i?void 0:i.check(this._listeners.size);let a;return a={dispose:()=>{if(s&&s(),a.dispose=EG._noop,!this._disposed&&(o(),this._options&&this._options.onLastListenerRemove)){this._listeners&&!this._listeners.isEmpty()||this._options.onLastListenerRemove(this)}}},n instanceof pG?n.add(a):Array.isArray(n)&&n.push(a),a}),this._event}fire(e){var t,n;if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new bG);for(let t of this._listeners)this._deliveryQueue.push([t,e]);for(null===(t=this._perfMon)||void 0===t||t.start(this._deliveryQueue.size);this._deliveryQueue.size>0;){const[e,t]=this._deliveryQueue.shift();try{"function"==typeof e?e.call(void 0,t):e[0].call(e[1],t)}catch(zWe){nG(zWe)}}null===(n=this._perfMon)||void 0===n||n.stop()}}dispose(){var e,t,n,i,r;this._disposed||(this._disposed=!0,null===(e=this._listeners)||void 0===e||e.clear(),null===(t=this._deliveryQueue)||void 0===t||t.clear(),null===(i=null===(n=this._options)||void 0===n?void 0:n.onLastListenerRemove)||void 0===i||i.call(n),null===(r=this._leakageMon)||void 0===r||r.dispose())}}EG._noop=function(){};class kG extends EG{constructor(e){super(e),this._isPaused=0,this._eventQueue=new bG,this._mergeFn=null==e?void 0:e.merge}pause(){this._isPaused++}resume(){if(0!==this._isPaused&&0==--this._isPaused)if(this._mergeFn){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}else for(;!this._isPaused&&0!==this._eventQueue.size;)super.fire(this._eventQueue.shift())}fire(e){this._listeners&&(0!==this._isPaused?this._eventQueue.push(e):super.fire(e))}}class LG extends kG{constructor(e){var t;super(e),this._delay=null!==(t=e.delay)&&void 0!==t?t:100}fire(e){this._handle||(this.pause(),this._handle=setTimeout((()=>{this._handle=void 0,this.resume()}),this._delay)),super.fire(e)}}class DG{constructor(){this.buffers=[]}wrapEvent(e){return(t,n,i)=>e((e=>{const i=this.buffers[this.buffers.length-1];i?i.push((()=>t.call(n,e))):t.call(n,e)}),void 0,i)}bufferEvents(e){const t=[];this.buffers.push(t);const n=e();return this.buffers.pop(),t.forEach((e=>e())),n}}class NG{constructor(){this.listening=!1,this.inputEvent=SG.None,this.inputEventListener=mG.None,this.emitter=new EG({onFirstListenerDidAdd:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onLastListenerRemove:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const IG=Object.freeze((function(e,t){const n=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(n)}}}));var TG,MG;(MG=TG||(TG={})).isCancellationToken=function(e){return e===MG.None||e===MG.Cancelled||e instanceof AG||!(!e||"object"!=typeof e)&&"boolean"==typeof e.isCancellationRequested&&"function"==typeof e.onCancellationRequested},MG.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:SG.None}),MG.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:IG});class AG{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?IG:(this._emitter||(this._emitter=new EG),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class OG{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new AG),this._token}cancel(){this._token?this._token instanceof AG&&this._token.cancel():this._token=TG.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener&&this._parentListener.dispose(),this._token?this._token instanceof AG&&this._token.dispose():this._token=TG.None}}class RG{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const PG=new RG,FG=new RG,BG=new RG;var WG,zG;function VG(e,t){return(e|(65535&t)<<16>>>0)>>>0}function UG(e,t){if(0===e)return null;const n=(65535&e)>>>0,i=(4294901760&e)>>>16;return new GG(0!==i?[HG(n,t),HG(i,t)]:[HG(n,t)])}function HG(e,t){const n=!!(2048&e),i=!!(256&e);return new jG(2===t?i:n,!!(1024&e),!!(512&e),2===t?n:i,255&e)}!function(){function e(e,t,n=t,i=n){PG.define(e,t),FG.define(e,n),BG.define(e,i)}e(0,"unknown"),e(1,"Backspace"),e(2,"Tab"),e(3,"Enter"),e(4,"Shift"),e(5,"Ctrl"),e(6,"Alt"),e(7,"PauseBreak"),e(8,"CapsLock"),e(9,"Escape"),e(10,"Space"),e(11,"PageUp"),e(12,"PageDown"),e(13,"End"),e(14,"Home"),e(15,"LeftArrow","Left"),e(16,"UpArrow","Up"),e(17,"RightArrow","Right"),e(18,"DownArrow","Down"),e(19,"Insert"),e(20,"Delete"),e(21,"0"),e(22,"1"),e(23,"2"),e(24,"3"),e(25,"4"),e(26,"5"),e(27,"6"),e(28,"7"),e(29,"8"),e(30,"9"),e(31,"A"),e(32,"B"),e(33,"C"),e(34,"D"),e(35,"E"),e(36,"F"),e(37,"G"),e(38,"H"),e(39,"I"),e(40,"J"),e(41,"K"),e(42,"L"),e(43,"M"),e(44,"N"),e(45,"O"),e(46,"P"),e(47,"Q"),e(48,"R"),e(49,"S"),e(50,"T"),e(51,"U"),e(52,"V"),e(53,"W"),e(54,"X"),e(55,"Y"),e(56,"Z"),e(57,"Meta"),e(58,"ContextMenu"),e(59,"F1"),e(60,"F2"),e(61,"F3"),e(62,"F4"),e(63,"F5"),e(64,"F6"),e(65,"F7"),e(66,"F8"),e(67,"F9"),e(68,"F10"),e(69,"F11"),e(70,"F12"),e(71,"F13"),e(72,"F14"),e(73,"F15"),e(74,"F16"),e(75,"F17"),e(76,"F18"),e(77,"F19"),e(78,"NumLock"),e(79,"ScrollLock"),e(80,";",";","OEM_1"),e(81,"=","=","OEM_PLUS"),e(82,",",",","OEM_COMMA"),e(83,"-","-","OEM_MINUS"),e(84,".",".","OEM_PERIOD"),e(85,"/","/","OEM_2"),e(86,"`","`","OEM_3"),e(110,"ABNT_C1"),e(111,"ABNT_C2"),e(87,"[","[","OEM_4"),e(88,"\\","\\","OEM_5"),e(89,"]","]","OEM_6"),e(90,"'","'","OEM_7"),e(91,"OEM_8"),e(92,"OEM_102"),e(93,"NumPad0"),e(94,"NumPad1"),e(95,"NumPad2"),e(96,"NumPad3"),e(97,"NumPad4"),e(98,"NumPad5"),e(99,"NumPad6"),e(100,"NumPad7"),e(101,"NumPad8"),e(102,"NumPad9"),e(103,"NumPad_Multiply"),e(104,"NumPad_Add"),e(105,"NumPad_Separator"),e(106,"NumPad_Subtract"),e(107,"NumPad_Decimal"),e(108,"NumPad_Divide")}(),(zG=WG||(WG={})).toString=function(e){return PG.keyCodeToStr(e)},zG.fromString=function(e){return PG.strToKeyCode(e)},zG.toUserSettingsUS=function(e){return FG.keyCodeToStr(e)},zG.toUserSettingsGeneral=function(e){return BG.keyCodeToStr(e)},zG.fromUserSettings=function(e){return FG.strToKeyCode(e)||BG.strToKeyCode(e)};class jG{constructor(e,t,n,i,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=n,this.metaKey=i,this.keyCode=r}equals(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return 0===this.keyCode||5===this.keyCode||57===this.keyCode||6===this.keyCode||4===this.keyCode}toChord(){return new GG([this])}isDuplicateModifierCase(){return this.ctrlKey&&5===this.keyCode||this.shiftKey&&4===this.keyCode||this.altKey&&6===this.keyCode||this.metaKey&&57===this.keyCode}}class GG{constructor(e){if(0===e.length)throw aG("parts");this.parts=e}}class KG{constructor(e,t,n,i,r,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=n,this.metaKey=i,this.keyLabel=r,this.keyAriaLabel=o}}let qG;if(void 0!==nj.vscode&&void 0!==nj.vscode.process){const e=nj.vscode.process;qG={get platform(){return e.platform},get env(){return e.env},cwd:()=>e.cwd(),nextTick:e=>gj(e)}}else qG="undefined"!=typeof process?{get platform(){return process.platform},get env(){return process.env},cwd:()=>process.env.VSCODE_CWD||process.cwd(),nextTick:e=>process.nextTick(e)}:{get platform(){return aj?"win32":lj?"darwin":"linux"},nextTick:e=>gj(e),get env(){return{}},cwd:()=>"/"};const $G=qG.cwd,YG=qG.env,XG=qG.platform;class ZG extends Error{constructor(e,t,n){let i;"string"==typeof t&&0===t.indexOf("not ")?(i="must not be",t=t.replace(/^not /,"")):i="must be";const r=-1!==e.indexOf(".")?"property":"argument";let o=`The "${e}" ${r} ${i} of type ${t}`;o+=". Received type "+typeof n,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function QG(e,t){if("string"!=typeof e)throw new ZG(t,"string",e)}function JG(e){return 47===e||92===e}function eK(e){return 47===e}function tK(e){return e>=65&&e<=90||e>=97&&e<=122}function nK(e,t,n,i){let r="",o=0,s=-1,a=0,l=0;for(let c=0;c<=e.length;++c){if(c<e.length)l=e.charCodeAt(c);else{if(i(l))break;l=47}if(i(l)){if(s===c-1||1===a);else if(2===a){if(r.length<2||2!==o||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2)){if(r.length>2){const e=r.lastIndexOf(n);-1===e?(r="",o=0):(r=r.slice(0,e),o=r.length-1-r.lastIndexOf(n)),s=c,a=0;continue}if(0!==r.length){r="",o=0,s=c,a=0;continue}}t&&(r+=r.length>0?`${n}..`:"..",o=2)}else r.length>0?r+=`${n}${e.slice(s+1,c)}`:r=e.slice(s+1,c),o=c-s-1;s=c,a=0}else 46===l&&-1!==a?++a:a=-1}return r}function iK(e,t){if(null===t||"object"!=typeof t)throw new ZG("pathObject","Object",t);const n=t.dir||t.root,i=t.base||`${t.name||""}${t.ext||""}`;return n?n===t.root?`${n}${i}`:`${n}${e}${i}`:i}const rK={resolve(...e){let t="",n="",i=!1;for(let r=e.length-1;r>=-1;r--){let o;if(r>=0){if(o=e[r],QG(o,"path"),0===o.length)continue}else 0===t.length?o=$G():(o=YG[`=${t}`]||$G(),(void 0===o||o.slice(0,2).toLowerCase()!==t.toLowerCase()&&92===o.charCodeAt(2))&&(o=`${t}\\`));const s=o.length;let a=0,l="",c=!1;const u=o.charCodeAt(0);if(1===s)JG(u)&&(a=1,c=!0);else if(JG(u))if(c=!0,JG(o.charCodeAt(1))){let e=2,t=e;for(;e<s&&!JG(o.charCodeAt(e));)e++;if(e<s&&e!==t){const n=o.slice(t,e);for(t=e;e<s&&JG(o.charCodeAt(e));)e++;if(e<s&&e!==t){for(t=e;e<s&&!JG(o.charCodeAt(e));)e++;e!==s&&e===t||(l=`\\\\${n}\\${o.slice(t,e)}`,a=e)}}}else a=1;else tK(u)&&58===o.charCodeAt(1)&&(l=o.slice(0,2),a=2,s>2&&JG(o.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(t.length>0){if(l.toLowerCase()!==t.toLowerCase())continue}else t=l;if(i){if(t.length>0)break}else if(n=`${o.slice(a)}\\${n}`,i=c,c&&t.length>0)break}return n=nK(n,!i,"\\",JG),i?`${t}\\${n}`:`${t}${n}`||"."},normalize(e){QG(e,"path");const t=e.length;if(0===t)return".";let n,i=0,r=!1;const o=e.charCodeAt(0);if(1===t)return eK(o)?"\\":e;if(JG(o))if(r=!0,JG(e.charCodeAt(1))){let r=2,o=r;for(;r<t&&!JG(e.charCodeAt(r));)r++;if(r<t&&r!==o){const s=e.slice(o,r);for(o=r;r<t&&JG(e.charCodeAt(r));)r++;if(r<t&&r!==o){for(o=r;r<t&&!JG(e.charCodeAt(r));)r++;if(r===t)return`\\\\${s}\\${e.slice(o)}\\`;r!==o&&(n=`\\\\${s}\\${e.slice(o,r)}`,i=r)}}}else i=1;else tK(o)&&58===e.charCodeAt(1)&&(n=e.slice(0,2),i=2,t>2&&JG(e.charCodeAt(2))&&(r=!0,i=3));let s=i<t?nK(e.slice(i),!r,"\\",JG):"";return 0!==s.length||r||(s="."),s.length>0&&JG(e.charCodeAt(t-1))&&(s+="\\"),void 0===n?r?`\\${s}`:s:r?`${n}\\${s}`:`${n}${s}`},isAbsolute(e){QG(e,"path");const t=e.length;if(0===t)return!1;const n=e.charCodeAt(0);return JG(n)||t>2&&tK(n)&&58===e.charCodeAt(1)&&JG(e.charCodeAt(2))},join(...e){if(0===e.length)return".";let t,n;for(let o=0;o<e.length;++o){const i=e[o];QG(i,"path"),i.length>0&&(void 0===t?t=n=i:t+=`\\${i}`)}if(void 0===t)return".";let i=!0,r=0;if("string"==typeof n&&JG(n.charCodeAt(0))){++r;const e=n.length;e>1&&JG(n.charCodeAt(1))&&(++r,e>2&&(JG(n.charCodeAt(2))?++r:i=!1))}if(i){for(;r<t.length&&JG(t.charCodeAt(r));)r++;r>=2&&(t=`\\${t.slice(r)}`)}return rK.normalize(t)},relative(e,t){if(QG(e,"from"),QG(t,"to"),e===t)return"";const n=rK.resolve(e),i=rK.resolve(t);if(n===i)return"";if((e=n.toLowerCase())===(t=i.toLowerCase()))return"";let r=0;for(;r<e.length&&92===e.charCodeAt(r);)r++;let o=e.length;for(;o-1>r&&92===e.charCodeAt(o-1);)o--;const s=o-r;let a=0;for(;a<t.length&&92===t.charCodeAt(a);)a++;let l=t.length;for(;l-1>a&&92===t.charCodeAt(l-1);)l--;const c=l-a,u=s<c?s:c;let h=-1,d=0;for(;d<u;d++){const n=e.charCodeAt(r+d);if(n!==t.charCodeAt(a+d))break;92===n&&(h=d)}if(d!==u){if(-1===h)return i}else{if(c>u){if(92===t.charCodeAt(a+d))return i.slice(a+d+1);if(2===d)return i.slice(a+d)}s>u&&(92===e.charCodeAt(r+d)?h=d:2===d&&(h=3)),-1===h&&(h=0)}let f="";for(d=r+h+1;d<=o;++d)d!==o&&92!==e.charCodeAt(d)||(f+=0===f.length?"..":"\\..");return a+=h,f.length>0?`${f}${i.slice(a,l)}`:(92===i.charCodeAt(a)&&++a,i.slice(a,l))},toNamespacedPath(e){if("string"!=typeof e)return e;if(0===e.length)return"";const t=rK.resolve(e);if(t.length<=2)return e;if(92===t.charCodeAt(0)){if(92===t.charCodeAt(1)){const e=t.charCodeAt(2);if(63!==e&&46!==e)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(tK(t.charCodeAt(0))&&58===t.charCodeAt(1)&&92===t.charCodeAt(2))return`\\\\?\\${t}`;return e},dirname(e){QG(e,"path");const t=e.length;if(0===t)return".";let n=-1,i=0;const r=e.charCodeAt(0);if(1===t)return JG(r)?e:".";if(JG(r)){if(n=i=1,JG(e.charCodeAt(1))){let r=2,o=r;for(;r<t&&!JG(e.charCodeAt(r));)r++;if(r<t&&r!==o){for(o=r;r<t&&JG(e.charCodeAt(r));)r++;if(r<t&&r!==o){for(o=r;r<t&&!JG(e.charCodeAt(r));)r++;if(r===t)return e;r!==o&&(n=i=r+1)}}}}else tK(r)&&58===e.charCodeAt(1)&&(n=t>2&&JG(e.charCodeAt(2))?3:2,i=n);let o=-1,s=!0;for(let a=t-1;a>=i;--a)if(JG(e.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(-1===o){if(-1===n)return".";o=n}return e.slice(0,o)},basename(e,t){void 0!==t&&QG(t,"ext"),QG(e,"path");let n,i=0,r=-1,o=!0;if(e.length>=2&&tK(e.charCodeAt(0))&&58===e.charCodeAt(1)&&(i=2),void 0!==t&&t.length>0&&t.length<=e.length){if(t===e)return"";let s=t.length-1,a=-1;for(n=e.length-1;n>=i;--n){const l=e.charCodeAt(n);if(JG(l)){if(!o){i=n+1;break}}else-1===a&&(o=!1,a=n+1),s>=0&&(l===t.charCodeAt(s)?-1==--s&&(r=n):(s=-1,r=a))}return i===r?r=a:-1===r&&(r=e.length),e.slice(i,r)}for(n=e.length-1;n>=i;--n)if(JG(e.charCodeAt(n))){if(!o){i=n+1;break}}else-1===r&&(o=!1,r=n+1);return-1===r?"":e.slice(i,r)},extname(e){QG(e,"path");let t=0,n=-1,i=0,r=-1,o=!0,s=0;e.length>=2&&58===e.charCodeAt(1)&&tK(e.charCodeAt(0))&&(t=i=2);for(let a=e.length-1;a>=t;--a){const t=e.charCodeAt(a);if(JG(t)){if(!o){i=a+1;break}}else-1===r&&(o=!1,r=a+1),46===t?-1===n?n=a:1!==s&&(s=1):-1!==n&&(s=-1)}return-1===n||-1===r||0===s||1===s&&n===r-1&&n===i+1?"":e.slice(n,r)},format:iK.bind(null,"\\"),parse(e){QG(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;const n=e.length;let i=0,r=e.charCodeAt(0);if(1===n)return JG(r)?(t.root=t.dir=e,t):(t.base=t.name=e,t);if(JG(r)){if(i=1,JG(e.charCodeAt(1))){let t=2,r=t;for(;t<n&&!JG(e.charCodeAt(t));)t++;if(t<n&&t!==r){for(r=t;t<n&&JG(e.charCodeAt(t));)t++;if(t<n&&t!==r){for(r=t;t<n&&!JG(e.charCodeAt(t));)t++;t===n?i=t:t!==r&&(i=t+1)}}}}else if(tK(r)&&58===e.charCodeAt(1)){if(n<=2)return t.root=t.dir=e,t;if(i=2,JG(e.charCodeAt(2))){if(3===n)return t.root=t.dir=e,t;i=3}}i>0&&(t.root=e.slice(0,i));let o=-1,s=i,a=-1,l=!0,c=e.length-1,u=0;for(;c>=i;--c)if(r=e.charCodeAt(c),JG(r)){if(!l){s=c+1;break}}else-1===a&&(l=!1,a=c+1),46===r?-1===o?o=c:1!==u&&(u=1):-1!==o&&(u=-1);return-1!==a&&(-1===o||0===u||1===u&&o===a-1&&o===s+1?t.base=t.name=e.slice(s,a):(t.name=e.slice(s,o),t.base=e.slice(s,a),t.ext=e.slice(o,a))),t.dir=s>0&&s!==i?e.slice(0,s-1):t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},oK={resolve(...e){let t="",n=!1;for(let i=e.length-1;i>=-1&&!n;i--){const r=i>=0?e[i]:$G();QG(r,"path"),0!==r.length&&(t=`${r}/${t}`,n=47===r.charCodeAt(0))}return t=nK(t,!n,"/",eK),n?`/${t}`:t.length>0?t:"."},normalize(e){if(QG(e,"path"),0===e.length)return".";const t=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0===(e=nK(e,!t,"/",eK)).length?t?"/":n?"./":".":(n&&(e+="/"),t?`/${e}`:e)},isAbsolute:e=>(QG(e,"path"),e.length>0&&47===e.charCodeAt(0)),join(...e){if(0===e.length)return".";let t;for(let n=0;n<e.length;++n){const i=e[n];QG(i,"path"),i.length>0&&(void 0===t?t=i:t+=`/${i}`)}return void 0===t?".":oK.normalize(t)},relative(e,t){if(QG(e,"from"),QG(t,"to"),e===t)return"";if((e=oK.resolve(e))===(t=oK.resolve(t)))return"";const n=e.length,i=n-1,r=t.length-1,o=i<r?i:r;let s=-1,a=0;for(;a<o;a++){const n=e.charCodeAt(1+a);if(n!==t.charCodeAt(1+a))break;47===n&&(s=a)}if(a===o)if(r>o){if(47===t.charCodeAt(1+a))return t.slice(1+a+1);if(0===a)return t.slice(1+a)}else i>o&&(47===e.charCodeAt(1+a)?s=a:0===a&&(s=0));let l="";for(a=1+s+1;a<=n;++a)a!==n&&47!==e.charCodeAt(a)||(l+=0===l.length?"..":"/..");return`${l}${t.slice(1+s)}`},toNamespacedPath:e=>e,dirname(e){if(QG(e,"path"),0===e.length)return".";const t=47===e.charCodeAt(0);let n=-1,i=!0;for(let r=e.length-1;r>=1;--r)if(47===e.charCodeAt(r)){if(!i){n=r;break}}else i=!1;return-1===n?t?"/":".":t&&1===n?"//":e.slice(0,n)},basename(e,t){void 0!==t&&QG(t,"ext"),QG(e,"path");let n,i=0,r=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t===e)return"";let s=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){const l=e.charCodeAt(n);if(47===l){if(!o){i=n+1;break}}else-1===a&&(o=!1,a=n+1),s>=0&&(l===t.charCodeAt(s)?-1==--s&&(r=n):(s=-1,r=a))}return i===r?r=a:-1===r&&(r=e.length),e.slice(i,r)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!o){i=n+1;break}}else-1===r&&(o=!1,r=n+1);return-1===r?"":e.slice(i,r)},extname(e){QG(e,"path");let t=-1,n=0,i=-1,r=!0,o=0;for(let s=e.length-1;s>=0;--s){const a=e.charCodeAt(s);if(47!==a)-1===i&&(r=!1,i=s+1),46===a?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1);else if(!r){n=s+1;break}}return-1===t||-1===i||0===o||1===o&&t===i-1&&t===n+1?"":e.slice(t,i)},format:iK.bind(null,"/"),parse(e){QG(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;const n=47===e.charCodeAt(0);let i;n?(t.root="/",i=1):i=0;let r=-1,o=0,s=-1,a=!0,l=e.length-1,c=0;for(;l>=i;--l){const t=e.charCodeAt(l);if(47!==t)-1===s&&(a=!1,s=l+1),46===t?-1===r?r=l:1!==c&&(c=1):-1!==r&&(c=-1);else if(!a){o=l+1;break}}if(-1!==s){const i=0===o&&n?1:o;-1===r||0===c||1===c&&r===s-1&&r===o+1?t.base=t.name=e.slice(i,s):(t.name=e.slice(i,r),t.base=e.slice(i,s),t.ext=e.slice(r,s))}return o>0?t.dir=e.slice(0,o-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};oK.win32=rK.win32=rK,oK.posix=rK.posix=oK;const sK="win32"===XG?rK.normalize:oK.normalize,aK="win32"===XG?rK.resolve:oK.resolve,lK="win32"===XG?rK.relative:oK.relative,cK="win32"===XG?rK.dirname:oK.dirname,uK="win32"===XG?rK.basename:oK.basename,hK="win32"===XG?rK.extname:oK.extname,dK="win32"===XG?rK.sep:oK.sep,fK=/^\w[\w\d+.-]*$/,gK=/^\//,pK=/^\/\//;function mK(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!fK.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!gK.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(pK.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}const vK="/",yK=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class _K{constructor(e,t,n,i,r,o=!1){"object"==typeof e?(this.scheme=e.scheme||"",this.authority=e.authority||"",this.path=e.path||"",this.query=e.query||"",this.fragment=e.fragment||""):(this.scheme=function(e,t){return e||t?e:"file"}(e,o),this.authority=t||"",this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==vK&&(t=vK+t):t=vK}return t}(this.scheme,n||""),this.query=i||"",this.fragment=r||"",mK(this,o))}static isUri(e){return e instanceof _K||!!e&&("string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme&&"string"==typeof e.fsPath&&"function"==typeof e.with&&"function"==typeof e.toString)}get fsPath(){return EK(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:i,query:r,fragment:o}=e;return void 0===t?t=this.scheme:null===t&&(t=""),void 0===n?n=this.authority:null===n&&(n=""),void 0===i?i=this.path:null===i&&(i=""),void 0===r?r=this.query:null===r&&(r=""),void 0===o?o=this.fragment:null===o&&(o=""),t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&o===this.fragment?this:new wK(t,n,i,r,o)}static parse(e,t=!1){const n=yK.exec(e);return n?new wK(n[2]||"",NK(n[4]||""),NK(n[5]||""),NK(n[7]||""),NK(n[9]||""),t):new wK("","","","","")}static file(e){let t="";if(aj&&(e=e.replace(/\\/g,vK)),e[0]===vK&&e[1]===vK){const n=e.indexOf(vK,2);-1===n?(t=e.substring(2),e=vK):(t=e.substring(2,n),e=e.substring(n)||vK)}return new wK("file",t,e,"","")}static from(e){const t=new wK(e.scheme,e.authority,e.path,e.query,e.fragment);return mK(t,!0),t}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return n=aj&&"file"===e.scheme?_K.file(rK.join(EK(e,!0),...t)).path:oK.join(e.path,...t),e.with({path:n})}toString(e=!1){return kK(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof _K)return e;{const t=new wK(e);return t._formatted=e.external,t._fsPath=e._sep===bK?e.fsPath:null,t}}return e}}const bK=aj?1:void 0;class wK extends _K{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=EK(this,!1)),this._fsPath}toString(e=!1){return e?kK(this,!0):(this._formatted||(this._formatted=kK(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=bK),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const CK={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function SK(e,t){let n,i=-1;for(let r=0;r<e.length;r++){const o=e.charCodeAt(r);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||45===o||46===o||95===o||126===o||t&&47===o)-1!==i&&(n+=encodeURIComponent(e.substring(i,r)),i=-1),void 0!==n&&(n+=e.charAt(r));else{void 0===n&&(n=e.substr(0,r));const t=CK[o];void 0!==t?(-1!==i&&(n+=encodeURIComponent(e.substring(i,r)),i=-1),n+=t):-1===i&&(i=r)}}return-1!==i&&(n+=encodeURIComponent(e.substring(i))),void 0!==n?n:e}function xK(e){let t;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);35===i||63===i?(void 0===t&&(t=e.substr(0,n)),t+=CK[i]):void 0!==t&&(t+=e[n])}return void 0!==t?t:e}function EK(e,t){let n;return n=e.authority&&e.path.length>1&&"file"===e.scheme?`//${e.authority}${e.path}`:47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,aj&&(n=n.replace(/\//g,"\\")),n}function kK(e,t){const n=t?xK:SK;let i="",{scheme:r,authority:o,path:s,query:a,fragment:l}=e;if(r&&(i+=r,i+=":"),(o||"file"===r)&&(i+=vK,i+=vK),o){let e=o.indexOf("@");if(-1!==e){const t=o.substr(0,e);o=o.substr(e+1),e=t.indexOf(":"),-1===e?i+=n(t,!1):(i+=n(t.substr(0,e),!1),i+=":",i+=n(t.substr(e+1),!1)),i+="@"}o=o.toLowerCase(),e=o.indexOf(":"),-1===e?i+=n(o,!1):(i+=n(o.substr(0,e),!1),i+=o.substr(e))}if(s){if(s.length>=3&&47===s.charCodeAt(0)&&58===s.charCodeAt(2)){const e=s.charCodeAt(1);e>=65&&e<=90&&(s=`/${String.fromCharCode(e+32)}:${s.substr(3)}`)}else if(s.length>=2&&58===s.charCodeAt(1)){const e=s.charCodeAt(0);e>=65&&e<=90&&(s=`${String.fromCharCode(e+32)}:${s.substr(2)}`)}i+=n(s,!0)}return a&&(i+="?",i+=n(a,!1)),l&&(i+="#",i+=t?l:SK(l,!1)),i}function LK(e){try{return decodeURIComponent(e)}catch(t){return e.length>3?e.substr(0,3)+LK(e.substr(3)):e}}const DK=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function NK(e){return e.match(DK)?e.replace(DK,(e=>LK(e))):e}class IK{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new IK(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return IK.equals(this,e)}static equals(e,t){return!e&&!t||!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return IK.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<t.column}isBeforeOrEqual(e){return IK.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<=t.column}static compare(e,t){let n=0|e.lineNumber,i=0|t.lineNumber;if(n===i){return(0|e.column)-(0|t.column)}return n-i}clone(){return new IK(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new IK(e.lineNumber,e.column)}static isIPosition(e){return e&&"number"==typeof e.lineNumber&&"number"==typeof e.column}}class TK{constructor(e,t,n,i){e>n||e===n&&t>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return TK.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return TK.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber)&&(!(t.lineNumber===e.startLineNumber&&t.column<e.startColumn)&&!(t.lineNumber===e.endLineNumber&&t.column>e.endColumn))}containsRange(e){return TK.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)))}strictContainsRange(e){return TK.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)))}plusRange(e){return TK.plusRange(this,e)}static plusRange(e,t){let n,i,r,o;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,i=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,i=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,o=e.endColumn),new TK(n,i,r,o)}intersectRanges(e){return TK.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,o=e.endColumn,s=t.startLineNumber,a=t.startColumn,l=t.endLineNumber,c=t.endColumn;return n<s?(n=s,i=a):n===s&&(i=Math.max(i,a)),r>l?(r=l,o=c):r===l&&(o=Math.min(o,c)),n>r||n===r&&i>o?null:new TK(n,i,r,o)}equalsRange(e){return TK.equalsRange(this,e)}static equalsRange(e,t){return!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return TK.getEndPosition(this)}static getEndPosition(e){return new IK(e.endLineNumber,e.endColumn)}getStartPosition(){return TK.getStartPosition(this)}static getStartPosition(e){return new IK(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new TK(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new TK(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return TK.collapseToStart(this)}static collapseToStart(e){return new TK(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}static fromPositions(e,t=e){return new TK(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new TK(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&"number"==typeof e.startLineNumber&&"number"==typeof e.startColumn&&"number"==typeof e.endLineNumber&&"number"==typeof e.endColumn}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const n=0|e.startLineNumber,i=0|t.startLineNumber;if(n===i){const n=0|e.startColumn,i=0|t.startColumn;if(n===i){const n=0|e.endLineNumber,i=0|t.endLineNumber;if(n===i){return(0|e.endColumn)-(0|t.endColumn)}return n-i}return n-i}return n-i}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}}class MK extends TK{constructor(e,t,n,i){super(e,t,n,i),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=i}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return MK.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return 0===this.getDirection()?new MK(this.startLineNumber,this.startColumn,e,t):new MK(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new IK(this.positionLineNumber,this.positionColumn)}setStartPosition(e,t){return 0===this.getDirection()?new MK(e,t,this.endLineNumber,this.endColumn):new MK(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new MK(e.lineNumber,e.column,t.lineNumber,t.column)}static liftSelection(e){return new MK(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&"number"==typeof e.selectionStartLineNumber&&"number"==typeof e.selectionStartColumn&&"number"==typeof e.positionLineNumber&&"number"==typeof e.positionColumn}static createWithDirection(e,t,n,i,r){return 0===r?new MK(e,t,n,i):new MK(n,i,e,t)}}class AK{constructor(e,t,n){this._tokenBrand=void 0,this.offset=0|e,this.type=t,this.language=n}toString(){return"("+this.offset+", "+this.type+")"}}class OK{constructor(e,t){this._tokenizationResultBrand=void 0,this.tokens=e,this.endState=t}}class RK{constructor(e,t){this._tokenizationResult2Brand=void 0,this.tokens=e,this.endState=t}}var PK,FK,BK,WK,zK,VK,UK,HK,jK,GK,KK,qK,$K,YK,XK,ZK,QK,JK,eq,tq,nq,iq,rq,oq,sq,aq,lq,cq,uq,hq,dq,fq,gq,pq,mq,vq,yq,_q,bq,wq,Cq,Sq,xq,Eq,kq,Lq,Dq,Nq,Iq,Tq,Mq,Aq,Oq,Rq,Pq,Fq,Bq,Wq,zq,Vq,Uq,Hq,jq,Gq,Kq,qq,$q,Yq,Xq;(FK=PK||(PK={}))[FK.Unknown=0]="Unknown",FK[FK.Disabled=1]="Disabled",FK[FK.Enabled=2]="Enabled",(WK=BK||(BK={}))[WK.KeepWhitespace=1]="KeepWhitespace",WK[WK.InsertAsSnippet=4]="InsertAsSnippet",(VK=zK||(zK={}))[VK.Method=0]="Method",VK[VK.Function=1]="Function",VK[VK.Constructor=2]="Constructor",VK[VK.Field=3]="Field",VK[VK.Variable=4]="Variable",VK[VK.Class=5]="Class",VK[VK.Struct=6]="Struct",VK[VK.Interface=7]="Interface",VK[VK.Module=8]="Module",VK[VK.Property=9]="Property",VK[VK.Event=10]="Event",VK[VK.Operator=11]="Operator",VK[VK.Unit=12]="Unit",VK[VK.Value=13]="Value",VK[VK.Constant=14]="Constant",VK[VK.Enum=15]="Enum",VK[VK.EnumMember=16]="EnumMember",VK[VK.Keyword=17]="Keyword",VK[VK.Text=18]="Text",VK[VK.Color=19]="Color",VK[VK.File=20]="File",VK[VK.Reference=21]="Reference",VK[VK.Customcolor=22]="Customcolor",VK[VK.Folder=23]="Folder",VK[VK.TypeParameter=24]="TypeParameter",VK[VK.User=25]="User",VK[VK.Issue=26]="Issue",VK[VK.Snippet=27]="Snippet",(HK=UK||(UK={}))[HK.Deprecated=1]="Deprecated",(GK=jK||(jK={}))[GK.Invoke=0]="Invoke",GK[GK.TriggerCharacter=1]="TriggerCharacter",GK[GK.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions",(qK=KK||(KK={}))[qK.EXACT=0]="EXACT",qK[qK.ABOVE=1]="ABOVE",qK[qK.BELOW=2]="BELOW",(YK=$K||($K={}))[YK.NotSet=0]="NotSet",YK[YK.ContentFlush=1]="ContentFlush",YK[YK.RecoverFromMarkers=2]="RecoverFromMarkers",YK[YK.Explicit=3]="Explicit",YK[YK.Paste=4]="Paste",YK[YK.Undo=5]="Undo",YK[YK.Redo=6]="Redo",(ZK=XK||(XK={}))[ZK.LF=1]="LF",ZK[ZK.CRLF=2]="CRLF",(JK=QK||(QK={}))[JK.Text=0]="Text",JK[JK.Read=1]="Read",JK[JK.Write=2]="Write",(tq=eq||(eq={}))[tq.None=0]="None",tq[tq.Keep=1]="Keep",tq[tq.Brackets=2]="Brackets",tq[tq.Advanced=3]="Advanced",tq[tq.Full=4]="Full",(iq=nq||(nq={}))[iq.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",iq[iq.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",iq[iq.accessibilitySupport=2]="accessibilitySupport",iq[iq.accessibilityPageSize=3]="accessibilityPageSize",iq[iq.ariaLabel=4]="ariaLabel",iq[iq.autoClosingBrackets=5]="autoClosingBrackets",iq[iq.autoClosingDelete=6]="autoClosingDelete",iq[iq.autoClosingOvertype=7]="autoClosingOvertype",iq[iq.autoClosingQuotes=8]="autoClosingQuotes",iq[iq.autoIndent=9]="autoIndent",iq[iq.automaticLayout=10]="automaticLayout",iq[iq.autoSurround=11]="autoSurround",iq[iq.codeLens=12]="codeLens",iq[iq.codeLensFontFamily=13]="codeLensFontFamily",iq[iq.codeLensFontSize=14]="codeLensFontSize",iq[iq.colorDecorators=15]="colorDecorators",iq[iq.columnSelection=16]="columnSelection",iq[iq.comments=17]="comments",iq[iq.contextmenu=18]="contextmenu",iq[iq.copyWithSyntaxHighlighting=19]="copyWithSyntaxHighlighting",iq[iq.cursorBlinking=20]="cursorBlinking",iq[iq.cursorSmoothCaretAnimation=21]="cursorSmoothCaretAnimation",iq[iq.cursorStyle=22]="cursorStyle",iq[iq.cursorSurroundingLines=23]="cursorSurroundingLines",iq[iq.cursorSurroundingLinesStyle=24]="cursorSurroundingLinesStyle",iq[iq.cursorWidth=25]="cursorWidth",iq[iq.disableLayerHinting=26]="disableLayerHinting",iq[iq.disableMonospaceOptimizations=27]="disableMonospaceOptimizations",iq[iq.domReadOnly=28]="domReadOnly",iq[iq.dragAndDrop=29]="dragAndDrop",iq[iq.emptySelectionClipboard=30]="emptySelectionClipboard",iq[iq.extraEditorClassName=31]="extraEditorClassName",iq[iq.fastScrollSensitivity=32]="fastScrollSensitivity",iq[iq.find=33]="find",iq[iq.fixedOverflowWidgets=34]="fixedOverflowWidgets",iq[iq.folding=35]="folding",iq[iq.foldingStrategy=36]="foldingStrategy",iq[iq.foldingHighlight=37]="foldingHighlight",iq[iq.unfoldOnClickAfterEndOfLine=38]="unfoldOnClickAfterEndOfLine",iq[iq.fontFamily=39]="fontFamily",iq[iq.fontInfo=40]="fontInfo",iq[iq.fontLigatures=41]="fontLigatures",iq[iq.fontSize=42]="fontSize",iq[iq.fontWeight=43]="fontWeight",iq[iq.formatOnPaste=44]="formatOnPaste",iq[iq.formatOnType=45]="formatOnType",iq[iq.glyphMargin=46]="glyphMargin",iq[iq.gotoLocation=47]="gotoLocation",iq[iq.hideCursorInOverviewRuler=48]="hideCursorInOverviewRuler",iq[iq.highlightActiveIndentGuide=49]="highlightActiveIndentGuide",iq[iq.hover=50]="hover",iq[iq.inDiffEditor=51]="inDiffEditor",iq[iq.inlineSuggest=52]="inlineSuggest",iq[iq.letterSpacing=53]="letterSpacing",iq[iq.lightbulb=54]="lightbulb",iq[iq.lineDecorationsWidth=55]="lineDecorationsWidth",iq[iq.lineHeight=56]="lineHeight",iq[iq.lineNumbers=57]="lineNumbers",iq[iq.lineNumbersMinChars=58]="lineNumbersMinChars",iq[iq.linkedEditing=59]="linkedEditing",iq[iq.links=60]="links",iq[iq.matchBrackets=61]="matchBrackets",iq[iq.minimap=62]="minimap",iq[iq.mouseStyle=63]="mouseStyle",iq[iq.mouseWheelScrollSensitivity=64]="mouseWheelScrollSensitivity",iq[iq.mouseWheelZoom=65]="mouseWheelZoom",iq[iq.multiCursorMergeOverlapping=66]="multiCursorMergeOverlapping",iq[iq.multiCursorModifier=67]="multiCursorModifier",iq[iq.multiCursorPaste=68]="multiCursorPaste",iq[iq.occurrencesHighlight=69]="occurrencesHighlight",iq[iq.overviewRulerBorder=70]="overviewRulerBorder",iq[iq.overviewRulerLanes=71]="overviewRulerLanes",iq[iq.padding=72]="padding",iq[iq.parameterHints=73]="parameterHints",iq[iq.peekWidgetDefaultFocus=74]="peekWidgetDefaultFocus",iq[iq.definitionLinkOpensInPeek=75]="definitionLinkOpensInPeek",iq[iq.quickSuggestions=76]="quickSuggestions",iq[iq.quickSuggestionsDelay=77]="quickSuggestionsDelay",iq[iq.readOnly=78]="readOnly",iq[iq.renameOnType=79]="renameOnType",iq[iq.renderControlCharacters=80]="renderControlCharacters",iq[iq.renderIndentGuides=81]="renderIndentGuides",iq[iq.renderFinalNewline=82]="renderFinalNewline",iq[iq.renderLineHighlight=83]="renderLineHighlight",iq[iq.renderLineHighlightOnlyWhenFocus=84]="renderLineHighlightOnlyWhenFocus",iq[iq.renderValidationDecorations=85]="renderValidationDecorations",iq[iq.renderWhitespace=86]="renderWhitespace",iq[iq.revealHorizontalRightPadding=87]="revealHorizontalRightPadding",iq[iq.roundedSelection=88]="roundedSelection",iq[iq.rulers=89]="rulers",iq[iq.scrollbar=90]="scrollbar",iq[iq.scrollBeyondLastColumn=91]="scrollBeyondLastColumn",iq[iq.scrollBeyondLastLine=92]="scrollBeyondLastLine",iq[iq.scrollPredominantAxis=93]="scrollPredominantAxis",iq[iq.selectionClipboard=94]="selectionClipboard",iq[iq.selectionHighlight=95]="selectionHighlight",iq[iq.selectOnLineNumbers=96]="selectOnLineNumbers",iq[iq.showFoldingControls=97]="showFoldingControls",iq[iq.showUnused=98]="showUnused",iq[iq.snippetSuggestions=99]="snippetSuggestions",iq[iq.smartSelect=100]="smartSelect",iq[iq.smoothScrolling=101]="smoothScrolling",iq[iq.stickyTabStops=102]="stickyTabStops",iq[iq.stopRenderingLineAfter=103]="stopRenderingLineAfter",iq[iq.suggest=104]="suggest",iq[iq.suggestFontSize=105]="suggestFontSize",iq[iq.suggestLineHeight=106]="suggestLineHeight",iq[iq.suggestOnTriggerCharacters=107]="suggestOnTriggerCharacters",iq[iq.suggestSelection=108]="suggestSelection",iq[iq.tabCompletion=109]="tabCompletion",iq[iq.tabIndex=110]="tabIndex",iq[iq.unusualLineTerminators=111]="unusualLineTerminators",iq[iq.useShadowDOM=112]="useShadowDOM",iq[iq.useTabStops=113]="useTabStops",iq[iq.wordSeparators=114]="wordSeparators",iq[iq.wordWrap=115]="wordWrap",iq[iq.wordWrapBreakAfterCharacters=116]="wordWrapBreakAfterCharacters",iq[iq.wordWrapBreakBeforeCharacters=117]="wordWrapBreakBeforeCharacters",iq[iq.wordWrapColumn=118]="wordWrapColumn",iq[iq.wordWrapOverride1=119]="wordWrapOverride1",iq[iq.wordWrapOverride2=120]="wordWrapOverride2",iq[iq.wrappingIndent=121]="wrappingIndent",iq[iq.wrappingStrategy=122]="wrappingStrategy",iq[iq.showDeprecated=123]="showDeprecated",iq[iq.inlayHints=124]="inlayHints",iq[iq.editorClassName=125]="editorClassName",iq[iq.pixelRatio=126]="pixelRatio",iq[iq.tabFocusMode=127]="tabFocusMode",iq[iq.layoutInfo=128]="layoutInfo",iq[iq.wrappingInfo=129]="wrappingInfo",(oq=rq||(rq={}))[oq.TextDefined=0]="TextDefined",oq[oq.LF=1]="LF",oq[oq.CRLF=2]="CRLF",(aq=sq||(sq={}))[aq.LF=0]="LF",aq[aq.CRLF=1]="CRLF",(cq=lq||(lq={}))[cq.None=0]="None",cq[cq.Indent=1]="Indent",cq[cq.IndentOutdent=2]="IndentOutdent",cq[cq.Outdent=3]="Outdent",(hq=uq||(uq={}))[hq.Other=0]="Other",hq[hq.Type=1]="Type",hq[hq.Parameter=2]="Parameter",(fq=dq||(dq={}))[fq.Automatic=0]="Automatic",fq[fq.Explicit=1]="Explicit",(pq=gq||(gq={}))[pq.DependsOnKbLayout=-1]="DependsOnKbLayout",pq[pq.Unknown=0]="Unknown",pq[pq.Backspace=1]="Backspace",pq[pq.Tab=2]="Tab",pq[pq.Enter=3]="Enter",pq[pq.Shift=4]="Shift",pq[pq.Ctrl=5]="Ctrl",pq[pq.Alt=6]="Alt",pq[pq.PauseBreak=7]="PauseBreak",pq[pq.CapsLock=8]="CapsLock",pq[pq.Escape=9]="Escape",pq[pq.Space=10]="Space",pq[pq.PageUp=11]="PageUp",pq[pq.PageDown=12]="PageDown",pq[pq.End=13]="End",pq[pq.Home=14]="Home",pq[pq.LeftArrow=15]="LeftArrow",pq[pq.UpArrow=16]="UpArrow",pq[pq.RightArrow=17]="RightArrow",pq[pq.DownArrow=18]="DownArrow",pq[pq.Insert=19]="Insert",pq[pq.Delete=20]="Delete",pq[pq.KEY_0=21]="KEY_0",pq[pq.KEY_1=22]="KEY_1",pq[pq.KEY_2=23]="KEY_2",pq[pq.KEY_3=24]="KEY_3",pq[pq.KEY_4=25]="KEY_4",pq[pq.KEY_5=26]="KEY_5",pq[pq.KEY_6=27]="KEY_6",pq[pq.KEY_7=28]="KEY_7",pq[pq.KEY_8=29]="KEY_8",pq[pq.KEY_9=30]="KEY_9",pq[pq.KEY_A=31]="KEY_A",pq[pq.KEY_B=32]="KEY_B",pq[pq.KEY_C=33]="KEY_C",pq[pq.KEY_D=34]="KEY_D",pq[pq.KEY_E=35]="KEY_E",pq[pq.KEY_F=36]="KEY_F",pq[pq.KEY_G=37]="KEY_G",pq[pq.KEY_H=38]="KEY_H",pq[pq.KEY_I=39]="KEY_I",pq[pq.KEY_J=40]="KEY_J",pq[pq.KEY_K=41]="KEY_K",pq[pq.KEY_L=42]="KEY_L",pq[pq.KEY_M=43]="KEY_M",pq[pq.KEY_N=44]="KEY_N",pq[pq.KEY_O=45]="KEY_O",pq[pq.KEY_P=46]="KEY_P",pq[pq.KEY_Q=47]="KEY_Q",pq[pq.KEY_R=48]="KEY_R",pq[pq.KEY_S=49]="KEY_S",pq[pq.KEY_T=50]="KEY_T",pq[pq.KEY_U=51]="KEY_U",pq[pq.KEY_V=52]="KEY_V",pq[pq.KEY_W=53]="KEY_W",pq[pq.KEY_X=54]="KEY_X",pq[pq.KEY_Y=55]="KEY_Y",pq[pq.KEY_Z=56]="KEY_Z",pq[pq.Meta=57]="Meta",pq[pq.ContextMenu=58]="ContextMenu",pq[pq.F1=59]="F1",pq[pq.F2=60]="F2",pq[pq.F3=61]="F3",pq[pq.F4=62]="F4",pq[pq.F5=63]="F5",pq[pq.F6=64]="F6",pq[pq.F7=65]="F7",pq[pq.F8=66]="F8",pq[pq.F9=67]="F9",pq[pq.F10=68]="F10",pq[pq.F11=69]="F11",pq[pq.F12=70]="F12",pq[pq.F13=71]="F13",pq[pq.F14=72]="F14",pq[pq.F15=73]="F15",pq[pq.F16=74]="F16",pq[pq.F17=75]="F17",pq[pq.F18=76]="F18",pq[pq.F19=77]="F19",pq[pq.NumLock=78]="NumLock",pq[pq.ScrollLock=79]="ScrollLock",pq[pq.US_SEMICOLON=80]="US_SEMICOLON",pq[pq.US_EQUAL=81]="US_EQUAL",pq[pq.US_COMMA=82]="US_COMMA",pq[pq.US_MINUS=83]="US_MINUS",pq[pq.US_DOT=84]="US_DOT",pq[pq.US_SLASH=85]="US_SLASH",pq[pq.US_BACKTICK=86]="US_BACKTICK",pq[pq.US_OPEN_SQUARE_BRACKET=87]="US_OPEN_SQUARE_BRACKET",pq[pq.US_BACKSLASH=88]="US_BACKSLASH",pq[pq.US_CLOSE_SQUARE_BRACKET=89]="US_CLOSE_SQUARE_BRACKET",pq[pq.US_QUOTE=90]="US_QUOTE",pq[pq.OEM_8=91]="OEM_8",pq[pq.OEM_102=92]="OEM_102",pq[pq.NUMPAD_0=93]="NUMPAD_0",pq[pq.NUMPAD_1=94]="NUMPAD_1",pq[pq.NUMPAD_2=95]="NUMPAD_2",pq[pq.NUMPAD_3=96]="NUMPAD_3",pq[pq.NUMPAD_4=97]="NUMPAD_4",pq[pq.NUMPAD_5=98]="NUMPAD_5",pq[pq.NUMPAD_6=99]="NUMPAD_6",pq[pq.NUMPAD_7=100]="NUMPAD_7",pq[pq.NUMPAD_8=101]="NUMPAD_8",pq[pq.NUMPAD_9=102]="NUMPAD_9",pq[pq.NUMPAD_MULTIPLY=103]="NUMPAD_MULTIPLY",pq[pq.NUMPAD_ADD=104]="NUMPAD_ADD",pq[pq.NUMPAD_SEPARATOR=105]="NUMPAD_SEPARATOR",pq[pq.NUMPAD_SUBTRACT=106]="NUMPAD_SUBTRACT",pq[pq.NUMPAD_DECIMAL=107]="NUMPAD_DECIMAL",pq[pq.NUMPAD_DIVIDE=108]="NUMPAD_DIVIDE",pq[pq.KEY_IN_COMPOSITION=109]="KEY_IN_COMPOSITION",pq[pq.ABNT_C1=110]="ABNT_C1",pq[pq.ABNT_C2=111]="ABNT_C2",pq[pq.MAX_VALUE=112]="MAX_VALUE",(vq=mq||(mq={}))[vq.Hint=1]="Hint",vq[vq.Info=2]="Info",vq[vq.Warning=4]="Warning",vq[vq.Error=8]="Error",(_q=yq||(yq={}))[_q.Unnecessary=1]="Unnecessary",_q[_q.Deprecated=2]="Deprecated",(wq=bq||(bq={}))[wq.Inline=1]="Inline",wq[wq.Gutter=2]="Gutter",(Sq=Cq||(Cq={}))[Sq.UNKNOWN=0]="UNKNOWN",Sq[Sq.TEXTAREA=1]="TEXTAREA",Sq[Sq.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",Sq[Sq.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",Sq[Sq.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",Sq[Sq.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",Sq[Sq.CONTENT_TEXT=6]="CONTENT_TEXT",Sq[Sq.CONTENT_EMPTY=7]="CONTENT_EMPTY",Sq[Sq.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",Sq[Sq.CONTENT_WIDGET=9]="CONTENT_WIDGET",Sq[Sq.OVERVIEW_RULER=10]="OVERVIEW_RULER",Sq[Sq.SCROLLBAR=11]="SCROLLBAR",Sq[Sq.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",Sq[Sq.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR",(Eq=xq||(xq={}))[Eq.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",Eq[Eq.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",Eq[Eq.TOP_CENTER=2]="TOP_CENTER",(Lq=kq||(kq={}))[Lq.Left=1]="Left",Lq[Lq.Center=2]="Center",Lq[Lq.Right=4]="Right",Lq[Lq.Full=7]="Full",(Nq=Dq||(Dq={}))[Nq.Off=0]="Off",Nq[Nq.On=1]="On",Nq[Nq.Relative=2]="Relative",Nq[Nq.Interval=3]="Interval",Nq[Nq.Custom=4]="Custom",(Tq=Iq||(Iq={}))[Tq.None=0]="None",Tq[Tq.Text=1]="Text",Tq[Tq.Blocks=2]="Blocks",(Aq=Mq||(Mq={}))[Aq.Smooth=0]="Smooth",Aq[Aq.Immediate=1]="Immediate",(Rq=Oq||(Oq={}))[Rq.Auto=1]="Auto",Rq[Rq.Hidden=2]="Hidden",Rq[Rq.Visible=3]="Visible",(Fq=Pq||(Pq={}))[Fq.LTR=0]="LTR",Fq[Fq.RTL=1]="RTL",(Wq=Bq||(Bq={}))[Wq.Invoke=1]="Invoke",Wq[Wq.TriggerCharacter=2]="TriggerCharacter",Wq[Wq.ContentChange=3]="ContentChange",(Vq=zq||(zq={}))[Vq.File=0]="File",Vq[Vq.Module=1]="Module",Vq[Vq.Namespace=2]="Namespace",Vq[Vq.Package=3]="Package",Vq[Vq.Class=4]="Class",Vq[Vq.Method=5]="Method",Vq[Vq.Property=6]="Property",Vq[Vq.Field=7]="Field",Vq[Vq.Constructor=8]="Constructor",Vq[Vq.Enum=9]="Enum",Vq[Vq.Interface=10]="Interface",Vq[Vq.Function=11]="Function",Vq[Vq.Variable=12]="Variable",Vq[Vq.Constant=13]="Constant",Vq[Vq.String=14]="String",Vq[Vq.Number=15]="Number",Vq[Vq.Boolean=16]="Boolean",Vq[Vq.Array=17]="Array",Vq[Vq.Object=18]="Object",Vq[Vq.Key=19]="Key",Vq[Vq.Null=20]="Null",Vq[Vq.EnumMember=21]="EnumMember",Vq[Vq.Struct=22]="Struct",Vq[Vq.Event=23]="Event",Vq[Vq.Operator=24]="Operator",Vq[Vq.TypeParameter=25]="TypeParameter",(Hq=Uq||(Uq={}))[Hq.Deprecated=1]="Deprecated",(Gq=jq||(jq={}))[Gq.Hidden=0]="Hidden",Gq[Gq.Blink=1]="Blink",Gq[Gq.Smooth=2]="Smooth",Gq[Gq.Phase=3]="Phase",Gq[Gq.Expand=4]="Expand",Gq[Gq.Solid=5]="Solid",function(e){e[e.Line=1]="Line",e[e.Block=2]="Block",e[e.Underline=3]="Underline",e[e.LineThin=4]="LineThin",e[e.BlockOutline=5]="BlockOutline",e[e.UnderlineThin=6]="UnderlineThin"}(Kq||(Kq={})),($q=qq||(qq={}))[$q.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",$q[$q.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",$q[$q.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",$q[$q.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter",(Xq=Yq||(Yq={}))[Xq.None=0]="None",Xq[Xq.Same=1]="Same",Xq[Xq.Indent=2]="Indent",Xq[Xq.DeepIndent=3]="DeepIndent";class Zq{static chord(e,t){return VG(e,t)}}function Qq(){return{editor:void 0,languages:void 0,CancellationTokenSource:OG,Emitter:EG,KeyCode:gq,KeyMod:Zq,Position:IK,Range:TK,Selection:MK,SelectionDirection:Pq,MarkerSeverity:mq,MarkerTag:yq,Uri:_K,Token:AK}}Zq.CtrlCmd=2048,Zq.Shift=1024,Zq.Alt=512,Zq.WinCtrl=256;var Jq,e$;(e$=Jq||(Jq={})).serviceIds=new Map,e$.DI_TARGET="$di$target",e$.DI_DEPENDENCIES="$di$dependencies",e$.getServiceDependencies=function(e){return e[e$.DI_DEPENDENCIES]||[]};const t$=i$("instantiationService");function n$(e,t,n,i){t[Jq.DI_TARGET]===t?t[Jq.DI_DEPENDENCIES].push({id:e,index:n,optional:i}):(t[Jq.DI_DEPENDENCIES]=[{id:e,index:n,optional:i}],t[Jq.DI_TARGET]=t)}function i$(e){if(Jq.serviceIds.has(e))return Jq.serviceIds.get(e);const t=function(e,n,i){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");n$(t,e,i,!1)};return t.toString=()=>e,Jq.serviceIds.set(e,t),t}function r$(e){return function(t,n,i){if(3!==arguments.length)throw new Error("@optional-decorator can only be used to decorate a parameter");n$(e,t,i,!0)}}const o$=i$("codeEditorService");class s${constructor(){this._zoomLevel=0,this._lastZoomLevelChangeTime=0,this._onDidChangeZoomLevel=new EG,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this._zoomFactor=1}getZoomLevel(){return this._zoomLevel}getTimeSinceLastZoomLevelChanged(){return Date.now()-this._lastZoomLevelChangeTime}getZoomFactor(){return this._zoomFactor}getPixelRatio(){let e=document.createElement("canvas").getContext("2d");return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}}function a$(){return s$.INSTANCE.getZoomLevel()}function l$(e){return s$.INSTANCE.onDidChangeZoomLevel(e)}function c$(){return s$.INSTANCE.getPixelRatio()}s$.INSTANCE=new s$;const u$=navigator.userAgent,h$=u$.indexOf("Firefox")>=0,d$=u$.indexOf("AppleWebKit")>=0,f$=u$.indexOf("Chrome")>=0,g$=!f$&&u$.indexOf("Safari")>=0,p$=!f$&&!g$&&d$,m$=u$.indexOf("Android")>=0,v$=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches;let y$=new Array(230),_$=new Array(112);!function(){for(let t=0;t<_$.length;t++)_$[t]=-1;function e(e,t){y$[e]=t,_$[t]=e}e(3,7),e(8,1),e(9,2),e(13,3),e(16,4),e(17,5),e(18,6),e(19,7),e(20,8),e(27,9),e(32,10),e(33,11),e(34,12),e(35,13),e(36,14),e(37,15),e(38,16),e(39,17),e(40,18),e(45,19),e(46,20),e(48,21),e(49,22),e(50,23),e(51,24),e(52,25),e(53,26),e(54,27),e(55,28),e(56,29),e(57,30),e(65,31),e(66,32),e(67,33),e(68,34),e(69,35),e(70,36),e(71,37),e(72,38),e(73,39),e(74,40),e(75,41),e(76,42),e(77,43),e(78,44),e(79,45),e(80,46),e(81,47),e(82,48),e(83,49),e(84,50),e(85,51),e(86,52),e(87,53),e(88,54),e(89,55),e(90,56),e(93,58),e(96,93),e(97,94),e(98,95),e(99,96),e(100,97),e(101,98),e(102,99),e(103,100),e(104,101),e(105,102),e(106,103),e(107,104),e(108,105),e(109,106),e(110,107),e(111,108),e(112,59),e(113,60),e(114,61),e(115,62),e(116,63),e(117,64),e(118,65),e(119,66),e(120,67),e(121,68),e(122,69),e(123,70),e(124,71),e(125,72),e(126,73),e(127,74),e(128,75),e(129,76),e(130,77),e(144,78),e(145,79),e(186,80),e(187,81),e(188,82),e(189,83),e(190,84),e(191,85),e(192,86),e(193,110),e(194,111),e(219,87),e(220,88),e(221,89),e(222,90),e(223,91),e(226,92),e(229,109),h$?(e(59,80),e(107,81),e(109,83),lj&&e(224,57)):d$&&(e(91,57),e(lj?93:92,57))}();const b$=lj?256:2048,w$=lj?2048:256;class C${constructor(e){this._standardKeyboardEventBrand=!0;let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.keyCode=function(e){if(e.charCode){let t=String.fromCharCode(e.charCode).toUpperCase();return WG.fromString(t)}return y$[e.keyCode]||0}(t),this.code=t.code,this.ctrlKey=this.ctrlKey||5===this.keyCode,this.altKey=this.altKey||6===this.keyCode,this.shiftKey=this.shiftKey||4===this.keyCode,this.metaKey=this.metaKey||57===this.keyCode,this._asKeybinding=this._computeKeybinding(),this._asRuntimeKeybinding=this._computeRuntimeKeybinding()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeybinding(){return this._asRuntimeKeybinding}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;5!==this.keyCode&&4!==this.keyCode&&6!==this.keyCode&&57!==this.keyCode&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=b$),this.altKey&&(t|=512),this.shiftKey&&(t|=1024),this.metaKey&&(t|=w$),t|=e,t}_computeRuntimeKeybinding(){let e=0;return 5!==this.keyCode&&4!==this.keyCode&&6!==this.keyCode&&57!==this.keyCode&&(e=this.keyCode),new jG(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}let S$=!1,x$=null;function E$(e){if(!e.parent||e.parent===e)return null;try{let t=e.location,n=e.parent.location;if("null"!==t.origin&&"null"!==n.origin&&(t.protocol!==n.protocol||t.hostname!==n.hostname||t.port!==n.port))return S$=!0,null}catch(zWe){return S$=!0,null}return e.parent}class k${static getSameOriginWindowChain(){if(!x$){x$=[];let e,t=window;do{e=E$(t),e?x$.push({window:t,iframeElement:t.frameElement||null}):x$.push({window:t,iframeElement:null}),t=e}while(t)}return x$.slice(0)}static hasDifferentOriginAncestor(){return x$||this.getSameOriginWindowChain(),S$}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let n=0,i=0,r=this.getSameOriginWindowChain();for(const o of r){if(n+=o.window.scrollY,i+=o.window.scrollX,o.window===t)break;if(!o.iframeElement)break;let e=o.iframeElement.getBoundingClientRect();n+=e.top,i+=e.left}return{top:n,left:i}}}class L${constructor(e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=0===e.button,this.middleButton=1===e.button,this.rightButton=2===e.button,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,"dblclick"===e.type&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,"number"==typeof e.pageX?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop);let t=k$.getPositionOfChildWindowRelativeToAncestorWindow(self,e.view);this.posx-=t.left,this.posy-=t.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class D${constructor(e,t=0,n=0){if(this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=n,this.deltaX=t,e){let t=e,n=e;if(void 0!==t.wheelDeltaY)this.deltaY=t.wheelDeltaY/120;else if(void 0!==n.VERTICAL_AXIS&&n.axis===n.VERTICAL_AXIS)this.deltaY=-n.detail/3;else if("wheel"===e.type){const t=e;t.deltaMode===t.DOM_DELTA_LINE?this.deltaY=h$&&!lj?-e.deltaY/3:-e.deltaY:this.deltaY=-e.deltaY/40}if(void 0!==t.wheelDeltaX)this.deltaX=g$&&aj?-t.wheelDeltaX/120:t.wheelDeltaX/120;else if(void 0!==n.HORIZONTAL_AXIS&&n.axis===n.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if("wheel"===e.type){const t=e;t.deltaMode===t.DOM_DELTA_LINE?this.deltaX=h$&&!lj?-e.deltaX/3:-e.deltaX:this.deltaX=-e.deltaX/40}0===this.deltaY&&0===this.deltaX&&e.wheelDelta&&(this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation()}}var N$=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function I$(e){const t=new OG,n=e(t.token),i=new Promise(((e,i)=>{t.token.onCancellationRequested((()=>{i(sG())})),Promise.resolve(n).then((n=>{t.dispose(),e(n)}),(e=>{t.dispose(),i(e)}))}));return new class{cancel(){t.cancel()}then(e,t){return i.then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return i.finally(e)}}}function T$(e,t,n){return Promise.race([e,new Promise((e=>t.onCancellationRequested((()=>e(n)))))])}class M${constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const e=()=>{this.queuedPromise=null;const e=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,e};this.queuedPromise=new Promise((t=>{this.activePromise.then(e,e).then(t)}))}return new Promise(((e,t)=>{this.queuedPromise.then(e,t)}))}return this.activePromise=e(),new Promise(((e,t)=>{this.activePromise.then((t=>{this.activePromise=null,e(t)}),(e=>{this.activePromise=null,t(e)}))}))}}class A${constructor(e){this.defaultDelay=e,this.timeout=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(((e,t)=>{this.doResolve=e,this.doReject=t})).then((()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const e=this.task;return this.task=null,e()}}))),this.timeout=setTimeout((()=>{this.timeout=null,this.doResolve&&this.doResolve(null)}),t),this.completionPromise}isTriggered(){return null!==this.timeout}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject&&this.doReject(sG()),this.completionPromise=null)}cancelTimeout(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}dispose(){this.cancel()}}class O${constructor(e){this.delayer=new A$(e),this.throttler=new M$}trigger(e,t){return this.delayer.trigger((()=>this.throttler.queue(e)),t)}dispose(){this.delayer.dispose()}}function R$(e,t){return t?new Promise(((n,i)=>{const r=setTimeout(n,e);t.onCancellationRequested((()=>{clearTimeout(r),i(sG())}))})):I$((t=>R$(e,t)))}function P$(e,t=0){const n=setTimeout(e,t);return gG((()=>clearTimeout(n)))}function F$(e,t=(e=>!!e),n=null){let i=0;const r=e.length,o=()=>{if(i>=r)return Promise.resolve(n);const s=e[i++];return Promise.resolve(s()).then((e=>t(e)?Promise.resolve(e):o()))};return o()}class B${constructor(e,t){this._token=-1,"function"==typeof e&&"number"==typeof t&&this.setIfNotSet(e,t)}dispose(){this.cancel()}cancel(){-1!==this._token&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setTimeout((()=>{this._token=-1,e()}),t)}setIfNotSet(e,t){-1===this._token&&(this._token=setTimeout((()=>{this._token=-1,e()}),t))}}class W${constructor(){this._token=-1}dispose(){this.cancel()}cancel(){-1!==this._token&&(clearInterval(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setInterval((()=>{e()}),t)}}class z${constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return-1!==this.timeoutToken}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner&&this.runner()}}let V$;!function(){if("function"!=typeof requestIdleCallback||"function"!=typeof cancelIdleCallback){const e=Object.freeze({didTimeout:!0,timeRemaining:()=>15});V$=t=>{const n=setTimeout((()=>t(e)));let i=!1;return{dispose(){i||(i=!0,clearTimeout(n))}}}}else V$=(e,t)=>{const n=requestIdleCallback(e,"number"==typeof t?{timeout:t}:void 0);let i=!1;return{dispose(){i||(i=!0,cancelIdleCallback(n))}}}}();class U${constructor(e){this._didRun=!1,this._executor=()=>{try{this._value=e()}catch(t){this._error=t}finally{this._didRun=!0}},this._handle=V$((()=>this._executor()))}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}}var H$,j$,G$;(H$||(H$={})).settled=function(e){return N$(this,void 0,void 0,(function*(){let t;const n=yield Promise.all(e.map((e=>e.then((e=>e),(e=>{t||(t=e)})))));if(void 0!==t)throw t;return n}))},(G$=j$||(j$={})).inMemory="inmemory",G$.vscode="vscode",G$.internal="private",G$.walkThrough="walkThrough",G$.walkThroughSnippet="walkThroughSnippet",G$.http="http",G$.https="https",G$.file="file",G$.mailto="mailto",G$.untitled="untitled",G$.data="data",G$.command="command",G$.vscodeRemote="vscode-remote",G$.vscodeRemoteResource="vscode-remote-resource",G$.userData="vscode-userdata",G$.vscodeCustomEditor="vscode-custom-editor",G$.vscodeNotebook="vscode-notebook",G$.vscodeNotebookCell="vscode-notebook-cell",G$.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",G$.vscodeNotebookCellOutput="vscode-notebook-cell-output",G$.vscodeInteractive="vscode-interactive",G$.vscodeInteractiveInput="vscode-interactive-input",G$.vscodeSettings="vscode-settings",G$.vscodeWorkspaceTrust="vscode-workspace-trust",G$.vscodeTerminal="vscode-terminal",G$.webviewPanel="webview-panel",G$.vscodeWebview="vscode-webview",G$.extension="extension",G$.vscodeFileResource="vscode-file",G$.tmp="tmp";const K$=new class{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null}setPreferredWebSchema(e){this._preferredWebSchema=e}rewrite(e){if(this._delegate)return this._delegate(e);const t=e.authority;let n=this._hosts[t];n&&-1!==n.indexOf(":")&&(n=`[${n}]`);const i=this._ports[t],r=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return"string"==typeof r&&(o+=`&tkn=${encodeURIComponent(r)}`),_K.from({scheme:hj?this._preferredWebSchema:j$.vscodeRemoteResource,authority:`${n}:${i}`,path:"/vscode-remote-resource",query:o})}};const q$=new class{constructor(){this.FALLBACK_AUTHORITY="vscode-app"}asBrowserUri(e,t,n){const i=this.toUri(e,t);if(i.scheme===j$.vscodeRemote)return K$.rewrite(i);let r=!1;return uj&&(n||sj)&&i.scheme===j$.file&&(r=!0),i.scheme===j$.file&&"function"==typeof nj.importScripts&&"vscode-file://vscode-app"===nj.origin&&(r=!0),r?i.with({scheme:j$.vscodeFileResource,authority:i.authority||this.FALLBACK_AUTHORITY,query:null,fragment:null}):i}toUri(e,t){return _K.isUri(e)?e:_K.parse(t.toUrl(e))}},$$=(uj||document.queryCommandSupported&&document.queryCommandSupported("copy")||navigator&&navigator.clipboard&&navigator.clipboard.writeText,uj||navigator&&navigator.clipboard&&navigator.clipboard.readText,uj||v$||navigator.keyboard,"ontouchstart"in window||navigator.maxTouchPoints>0||window.navigator.msMaxTouchPoints,window.PointerEvent&&("ontouchstart"in window||window.navigator.maxTouchPoints>0||navigator.maxTouchPoints>0||window.navigator.msMaxTouchPoints>0));function Y$(e){for(;e.firstChild;)e.firstChild.remove()}function X$(e){var t;return null!==(t=null==e?void 0:e.isConnected)&&void 0!==t&&t}class Z${constructor(e,t,n,i){this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function Q$(e,t,n,i){return new Z$(e,t,n,i)}function J$(e){return function(t){return e(new L$(t))}}let eY=function(e,t,n,i){let r=n;return"click"===t||"mousedown"===t?r=J$(n):"keydown"!==t&&"keypress"!==t&&"keyup"!==t||(r=function(e){return function(t){return e(new C$(t))}}(n)),Q$(e,t,r,i)};function tY(e,t,n){return Q$(e,dj&&$$?RY.POINTER_DOWN:RY.MOUSE_DOWN,t,n)}function nY(e,t,n){return Q$(e,dj&&$$?RY.POINTER_UP:RY.MOUSE_UP,t,n)}function iY(e,t){return Q$(e,"mouseout",(n=>{let i=n.relatedTarget;for(;i&&i!==e;)i=i.parentNode;i!==e&&t(n)}))}let rY,oY,sY=null;class aY{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(zWe){nG(zWe)}}static sort(e,t){return t.priority-e.priority}}!function(){let e=[],t=null,n=!1,i=!1,r=()=>{for(n=!1,t=e,e=[],i=!0;t.length>0;){t.sort(aY.sort),t.shift().execute()}i=!1};oY=(t,i=0)=>{let o=new aY(t,i);return e.push(o),n||(n=!0,function(e){if(!sY){const e=e=>setTimeout((()=>e((new Date).getTime())),0);sY=self.requestAnimationFrame||self.msRequestAnimationFrame||self.webkitRequestAnimationFrame||self.mozRequestAnimationFrame||self.oRequestAnimationFrame||e}sY.call(self,e)}(r)),o},rY=(e,n)=>{if(i){let i=new aY(e,n);return t.push(i),i}return oY(e,n)}}();const lY=function(e,t){return t};class cY extends mG{constructor(e,t,n,i=lY,r=8){super();let o=null,s=0,a=this._register(new B$),l=()=>{s=(new Date).getTime(),n(o),o=null};this._register(Q$(e,t,(e=>{o=i(o,e);let t=(new Date).getTime()-s;t>=r?(a.cancel(),l()):a.setIfNotSet(l,r-t)})))}}function uY(e,t,n,i,r){return new cY(e,t,n,i,r)}function hY(e){return document.defaultView.getComputedStyle(e,null)}function dY(e){if(e!==document.body)return new gY(e.clientWidth,e.clientHeight);if(dj&&window.visualViewport)return new gY(window.visualViewport.width,window.visualViewport.height);if(window.innerWidth&&window.innerHeight)return new gY(window.innerWidth,window.innerHeight);if(document.body&&document.body.clientWidth&&document.body.clientHeight)return new gY(document.body.clientWidth,document.body.clientHeight);if(document.documentElement&&document.documentElement.clientWidth&&document.documentElement.clientHeight)return new gY(document.documentElement.clientWidth,document.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class fY{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,n){let i=hY(e),r="0";return i&&(r=i.getPropertyValue?i.getPropertyValue(t):i.getAttribute(n)),fY.convertToPixels(e,r)}static getBorderLeftWidth(e){return fY.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return fY.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return fY.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return fY.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return fY.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return fY.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return fY.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return fY.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return fY.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return fY.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return fY.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return fY.getDimension(e,"margin-bottom","marginBottom")}}class gY{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new gY(e,t):this}static is(e){return"object"==typeof e&&"number"==typeof e.height&&"number"==typeof e.width}static lift(e){return e instanceof gY?e:new gY(e.width,e.height)}static equals(e,t){return e===t||!(!e||!t)&&(e.width===t.width&&e.height===t.height)}}function pY(e){let t=e.offsetParent,n=e.offsetTop,i=e.offsetLeft;for(;null!==(e=e.parentNode)&&e!==document.body&&e!==document.documentElement;){n-=e.scrollTop;const r=EY(e)?null:hY(e);r&&(i-="rtl"!==r.direction?e.scrollLeft:-e.scrollLeft),e===t&&(i+=fY.getBorderLeftWidth(e),n+=fY.getBorderTopWidth(e),n+=e.offsetTop,i+=e.offsetLeft,t=e.offsetParent)}return{left:i,top:n}}function mY(e){let t=e.getBoundingClientRect();return{left:t.left+vY.scrollX,top:t.top+vY.scrollY,width:t.width,height:t.height}}const vY=new class{get scrollX(){return"number"==typeof window.scrollX?window.scrollX:document.body.scrollLeft+document.documentElement.scrollLeft}get scrollY(){return"number"==typeof window.scrollY?window.scrollY:document.body.scrollTop+document.documentElement.scrollTop}};function yY(e){let t=fY.getMarginLeft(e)+fY.getMarginRight(e);return e.offsetWidth+t}function _Y(e){let t=fY.getBorderLeftWidth(e)+fY.getBorderRightWidth(e),n=fY.getPaddingLeft(e)+fY.getPaddingRight(e);return e.offsetWidth-t-n}function bY(e){let t=fY.getBorderTopWidth(e)+fY.getBorderBottomWidth(e),n=fY.getPaddingTop(e)+fY.getPaddingBottom(e);return e.offsetHeight-t-n}function wY(e){let t=fY.getMarginTop(e)+fY.getMarginBottom(e);return e.offsetHeight+t}function CY(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function SY(e,t,n){for(;e&&e.nodeType===e.ELEMENT_NODE;){if(e.classList.contains(t))return e;if(n)if("string"==typeof n){if(e.classList.contains(n))return null}else if(e===n)return null;e=e.parentNode}return null}function xY(e,t,n){return!!SY(e,t,n)}function EY(e){return e&&!!e.host&&!!e.mode}function kY(e){return!!LY(e)}function LY(e){for(;e.parentNode;){if(e===document.body)return null;e=e.parentNode}return EY(e)?e:null}function DY(){let e=document.activeElement;for(;null==e?void 0:e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function NY(e=document.getElementsByTagName("head")[0]){let t=document.createElement("style");return t.type="text/css",t.media="screen",e.appendChild(t),t}let IY=null;function TY(){return IY||(IY=NY()),IY}function MY(e,t,n=TY()){n&&t&&n.sheet.insertRule(e+"{"+t+"}",0)}function AY(e,t=TY()){if(!t)return;let n=function(e){var t,n;return(null===(t=null==e?void 0:e.sheet)||void 0===t?void 0:t.rules)?e.sheet.rules:(null===(n=null==e?void 0:e.sheet)||void 0===n?void 0:n.cssRules)?e.sheet.cssRules:[]}(t),i=[];for(let r=0;r<n.length;r++){-1!==n[r].selectorText.indexOf(e)&&i.push(r)}for(let r=i.length-1;r>=0;r--)t.sheet.deleteRule(i[r])}function OY(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}const RY={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:d$?"webkitAnimationStart":"animationstart",ANIMATION_END:d$?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:d$?"webkitAnimationIteration":"animationiteration"},PY=function(e,t){e.preventDefault?e.preventDefault():e.returnValue=!1,t&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)};class FY extends mG{constructor(e){super(),this._onDidFocus=this._register(new EG),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new EG),this.onDidBlur=this._onDidBlur.event;let t=CY(document.activeElement,e),n=!1;const i=()=>{n=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(n=!0,window.setTimeout((()=>{n&&(n=!1,t=!1,this._onDidBlur.fire())}),0))};this._refreshStateHandler=()=>{CY(document.activeElement,e)!==t&&(t?r():i())},this._register(Q$(e,RY.FOCUS,i,!0)),this._register(Q$(e,RY.BLUR,r,!0))}}function BY(e){return new FY(e)}function WY(e,...t){if(e.append(...t),1===t.length&&"string"!=typeof t[0])return t[0]}function zY(e,...t){e.innerText="",WY(e,...t)}const VY=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var UY,HY;function jY(e,t,n,...i){let r=VY.exec(t);if(!r)throw new Error("Bad use of emmet");n=Object.assign({},n||{});let o,s=r[1]||"div";return o=e!==UY.HTML?document.createElementNS(e,s):document.createElement(s),r[3]&&(o.id=r[3]),r[4]&&(o.className=r[4].replace(/\./g," ").trim()),Object.keys(n).forEach((e=>{const t=n[e];void 0!==t&&(/^on\w+$/.test(e)?o[e]=t:"selected"===e?t&&o.setAttribute(e,"true"):o.setAttribute(e,t))})),o.append(...i),o}function GY(e,t,...n){return jY(UY.HTML,e,t,...n)}function KY(...e){for(let t of e)t.style.display="",t.removeAttribute("aria-hidden")}function qY(...e){for(let t of e)t.style.display="none",t.setAttribute("aria-hidden","true")}function $Y(e){return Array.prototype.slice.call(document.getElementsByTagName(e),0)}function YY(e){const t=window.devicePixelRatio*e;return Math.max(1,Math.floor(t))/window.devicePixelRatio}function XY(e){window.open(e,"_blank","noopener")}function ZY(e){return e?`url('${q$.asBrowserUri(e).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function QY(e){return`'${e.replace(/'/g,"%27")}'`}(HY=UY||(UY={})).HTML="http://www.w3.org/1999/xhtml",HY.SVG="http://www.w3.org/2000/svg",GY.SVG=function(e,t,...n){return jY(UY.SVG,e,t,...n)},K$.setPreferredWebSchema(/^https:/.test(window.location.href)?"https":"http");class JY extends EG{constructor(){super(),this._subscriptions=new pG,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(Q$(window,"keydown",(e=>{if(e.defaultPrevented)return;const t=new C$(e);if(6!==t.keyCode||!e.repeat){if(e.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(e.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(e.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(e.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else{if(6===t.keyCode)return;this._keyStatus.lastKeyPressed=void 0}this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=e,this.fire(this._keyStatus))}}),!0)),this._subscriptions.add(Q$(window,"keyup",(e=>{e.defaultPrevented||(!e.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!e.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!e.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!e.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=e,this.fire(this._keyStatus)))}),!0)),this._subscriptions.add(Q$(document.body,"mousedown",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),this._subscriptions.add(Q$(document.body,"mouseup",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),this._subscriptions.add(Q$(document.body,"mousemove",(e=>{e.buttons&&(this._keyStatus.lastKeyPressed=void 0)}),!0)),this._subscriptions.add(Q$(window,"blur",(()=>{this.resetKeyStatus()})))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return JY.instance||(JY.instance=new JY),JY.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}function eX(e){return!e||"string"!=typeof e||0===e.trim().length}const tX=/{(\d+)}/g;function nX(e,...t){return 0===t.length?e:e.replace(tX,(function(e,n){const i=parseInt(n,10);return isNaN(i)||i<0||i>=t.length?e:t[i]}))}function iX(e){return e.replace(/[<>&]/g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}}))}function rX(e){return e.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function oX(e,t=" "){return aX(sX(e,t),t)}function sX(e,t){if(!e||!t)return e;const n=t.length;if(0===n||0===e.length)return e;let i=0;for(;e.indexOf(t,i)===i;)i+=n;return e.substring(i)}function aX(e,t){if(!e||!t)return e;const n=t.length,i=e.length;if(0===n||0===i)return e;let r=i,o=-1;for(;o=e.lastIndexOf(t,r-1),-1!==o&&o+n===r;){if(0===o)return"";r=o}return e.substring(0,r)}function lX(e,t,n={}){if(!e)throw new Error("Cannot create regex from empty string");t||(e=rX(e)),n.wholeWord&&(/\B/.test(e.charAt(0))||(e="\\b"+e),/\B/.test(e.charAt(e.length-1))||(e+="\\b"));let i="";return n.global&&(i+="g"),n.matchCase||(i+="i"),n.multiline&&(i+="m"),n.unicode&&(i+="u"),new RegExp(e,i)}function cX(e){return(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")}function uX(e){return e.split(/\r\n|\r|\n/)}function hX(e){for(let t=0,n=e.length;t<n;t++){const n=e.charCodeAt(t);if(32!==n&&9!==n)return t}return-1}function dX(e,t=0,n=e.length){for(let i=t;i<n;i++){const n=e.charCodeAt(i);if(32!==n&&9!==n)return e.substring(t,i)}return e.substring(t,n)}function fX(e,t=e.length-1){for(let n=t;n>=0;n--){const t=e.charCodeAt(n);if(32!==t&&9!==t)return n}return-1}function gX(e,t){return e<t?-1:e>t?1:0}function pX(e,t,n=0,i=e.length,r=0,o=t.length){for(;n<i&&r<o;n++,r++){let i=e.charCodeAt(n),o=t.charCodeAt(r);if(i<o)return-1;if(i>o)return 1}const s=i-n,a=o-r;return s<a?-1:s>a?1:0}function mX(e,t){return vX(e,t,0,e.length,0,t.length)}function vX(e,t,n=0,i=e.length,r=0,o=t.length){for(;n<i&&r<o;n++,r++){let s=e.charCodeAt(n),a=t.charCodeAt(r);if(s===a)continue;const l=s-a;if((32!==l||!_X(a))&&(-32!==l||!_X(s)))return yX(s)&&yX(a)?l:pX(e.toLowerCase(),t.toLowerCase(),n,i,r,o)}const s=i-n,a=o-r;return s<a?-1:s>a?1:0}function yX(e){return e>=97&&e<=122}function _X(e){return e>=65&&e<=90}function bX(e){return yX(e)||_X(e)}function wX(e,t){return e.length===t.length&&CX(e,t)}function CX(e,t,n=e.length){for(let i=0;i<n;i++){const n=e.charCodeAt(i),r=t.charCodeAt(i);if(n!==r)if(bX(n)&&bX(r)){const e=Math.abs(n-r);if(0!==e&&32!==e)return!1}else if(String.fromCharCode(n).toLowerCase()!==String.fromCharCode(r).toLowerCase())return!1}return!0}function SX(e,t){const n=t.length;return!(t.length>e.length)&&CX(e,t,n)}function xX(e,t){let n,i=Math.min(e.length,t.length);for(n=0;n<i;n++)if(e.charCodeAt(n)!==t.charCodeAt(n))return n;return i}function EX(e,t){let n,i=Math.min(e.length,t.length);const r=e.length-1,o=t.length-1;for(n=0;n<i;n++)if(e.charCodeAt(r-n)!==t.charCodeAt(o-n))return n;return i}function kX(e){return 55296<=e&&e<=56319}function LX(e){return 56320<=e&&e<=57343}function DX(e,t){return t-56320+(e-55296<<10)+65536}function NX(e,t,n){const i=e.charCodeAt(n);if(kX(i)&&n+1<t){const t=e.charCodeAt(n+1);if(LX(t))return DX(i,t)}return i}function IX(e,t){const n=e.charCodeAt(t-1);if(LX(n)&&t>1){const i=e.charCodeAt(t-2);if(kX(i))return DX(i,n)}return n}function TX(e,t){const n=KX.getInstance(),i=t,r=e.length,o=NX(e,r,t);t+=o>=65536?2:1;let s=n.getGraphemeBreakType(o);for(;t<r;){const i=NX(e,r,t),o=n.getGraphemeBreakType(i);if(GX(s,o))break;t+=i>=65536?2:1,s=o}return t-i}const MX=/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u08BD\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE33\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDCFF]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD50-\uDFFF]|\uD83B[\uDC00-\uDEBB])/;function AX(e){return MX.test(e)}const OX=/(?:[\u231A\u231B\u23F0\u23F3\u2600-\u27BF\u2B50\u2B55]|\uD83C[\uDDE6-\uDDFF\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD00-\uDDFF\uDE70-\uDED6])/;const RX=/^[\t\n\r\x20-\x7E]*$/;function PX(e){return RX.test(e)}const FX=/[\u2028\u2029]/;function BX(e){return FX.test(e)}function WX(e){return(e=+e)>=11904&&e<=55215||e>=63744&&e<=64255||e>=65281&&e<=65374}function zX(e){return e>=127462&&e<=127487||8986===e||8987===e||9200===e||9203===e||e>=9728&&e<=10175||11088===e||11093===e||e>=127744&&e<=128591||e>=128640&&e<=128764||e>=128992&&e<=129003||e>=129280&&e<=129535||e>=129648&&e<=129750}const VX=String.fromCharCode(65279);function UX(e){return!!(e&&e.length>0&&65279===e.charCodeAt(0))}function HX(e){return(e%=52)<26?String.fromCharCode(97+e):String.fromCharCode(65+e-26)}function jX(e){return KX.getInstance().getGraphemeBreakType(e)}function GX(e,t){return 0===e?5!==t&&7!==t:(2!==e||3!==t)&&(4===e||2===e||3===e||(4===t||2===t||3===t||(8!==e||8!==t&&9!==t&&11!==t&&12!==t)&&((11!==e&&9!==e||9!==t&&10!==t)&&((12!==e&&10!==e||10!==t)&&(5!==t&&13!==t&&(7!==t&&(1!==e&&((13!==e||14!==t)&&(6!==e||6!==t)))))))))}class KX{constructor(){this._data=JSON.parse("[0,0,0,51592,51592,11,44424,44424,11,72251,72254,5,7150,7150,7,48008,48008,11,55176,55176,11,128420,128420,14,3276,3277,5,9979,9980,14,46216,46216,11,49800,49800,11,53384,53384,11,70726,70726,5,122915,122916,5,129320,129327,14,2558,2558,5,5906,5908,5,9762,9763,14,43360,43388,8,45320,45320,11,47112,47112,11,48904,48904,11,50696,50696,11,52488,52488,11,54280,54280,11,70082,70083,1,71350,71350,7,73111,73111,5,127892,127893,14,128726,128727,14,129473,129474,14,2027,2035,5,2901,2902,5,3784,3789,5,6754,6754,5,8418,8420,5,9877,9877,14,11088,11088,14,44008,44008,5,44872,44872,11,45768,45768,11,46664,46664,11,47560,47560,11,48456,48456,11,49352,49352,11,50248,50248,11,51144,51144,11,52040,52040,11,52936,52936,11,53832,53832,11,54728,54728,11,69811,69814,5,70459,70460,5,71096,71099,7,71998,71998,5,72874,72880,5,119149,119149,7,127374,127374,14,128335,128335,14,128482,128482,14,128765,128767,14,129399,129400,14,129680,129685,14,1476,1477,5,2377,2380,7,2759,2760,5,3137,3140,7,3458,3459,7,4153,4154,5,6432,6434,5,6978,6978,5,7675,7679,5,9723,9726,14,9823,9823,14,9919,9923,14,10035,10036,14,42736,42737,5,43596,43596,5,44200,44200,11,44648,44648,11,45096,45096,11,45544,45544,11,45992,45992,11,46440,46440,11,46888,46888,11,47336,47336,11,47784,47784,11,48232,48232,11,48680,48680,11,49128,49128,11,49576,49576,11,50024,50024,11,50472,50472,11,50920,50920,11,51368,51368,11,51816,51816,11,52264,52264,11,52712,52712,11,53160,53160,11,53608,53608,11,54056,54056,11,54504,54504,11,54952,54952,11,68108,68111,5,69933,69940,5,70197,70197,7,70498,70499,7,70845,70845,5,71229,71229,5,71727,71735,5,72154,72155,5,72344,72345,5,73023,73029,5,94095,94098,5,121403,121452,5,126981,127182,14,127538,127546,14,127990,127990,14,128391,128391,14,128445,128449,14,128500,128505,14,128752,128752,14,129160,129167,14,129356,129356,14,129432,129442,14,129648,129651,14,129751,131069,14,173,173,4,1757,1757,1,2274,2274,1,2494,2494,5,2641,2641,5,2876,2876,5,3014,3016,7,3262,3262,7,3393,3396,5,3570,3571,7,3968,3972,5,4228,4228,7,6086,6086,5,6679,6680,5,6912,6915,5,7080,7081,5,7380,7392,5,8252,8252,14,9096,9096,14,9748,9749,14,9784,9786,14,9833,9850,14,9890,9894,14,9938,9938,14,9999,9999,14,10085,10087,14,12349,12349,14,43136,43137,7,43454,43456,7,43755,43755,7,44088,44088,11,44312,44312,11,44536,44536,11,44760,44760,11,44984,44984,11,45208,45208,11,45432,45432,11,45656,45656,11,45880,45880,11,46104,46104,11,46328,46328,11,46552,46552,11,46776,46776,11,47000,47000,11,47224,47224,11,47448,47448,11,47672,47672,11,47896,47896,11,48120,48120,11,48344,48344,11,48568,48568,11,48792,48792,11,49016,49016,11,49240,49240,11,49464,49464,11,49688,49688,11,49912,49912,11,50136,50136,11,50360,50360,11,50584,50584,11,50808,50808,11,51032,51032,11,51256,51256,11,51480,51480,11,51704,51704,11,51928,51928,11,52152,52152,11,52376,52376,11,52600,52600,11,52824,52824,11,53048,53048,11,53272,53272,11,53496,53496,11,53720,53720,11,53944,53944,11,54168,54168,11,54392,54392,11,54616,54616,11,54840,54840,11,55064,55064,11,65438,65439,5,69633,69633,5,69837,69837,1,70018,70018,7,70188,70190,7,70368,70370,7,70465,70468,7,70712,70719,5,70835,70840,5,70850,70851,5,71132,71133,5,71340,71340,7,71458,71461,5,71985,71989,7,72002,72002,7,72193,72202,5,72281,72283,5,72766,72766,7,72885,72886,5,73104,73105,5,92912,92916,5,113824,113827,4,119173,119179,5,121505,121519,5,125136,125142,5,127279,127279,14,127489,127490,14,127570,127743,14,127900,127901,14,128254,128254,14,128369,128370,14,128400,128400,14,128425,128432,14,128468,128475,14,128489,128494,14,128715,128720,14,128745,128745,14,128759,128760,14,129004,129023,14,129296,129304,14,129340,129342,14,129388,129392,14,129404,129407,14,129454,129455,14,129485,129487,14,129659,129663,14,129719,129727,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2363,2363,7,2402,2403,5,2507,2508,7,2622,2624,7,2691,2691,7,2786,2787,5,2881,2884,5,3006,3006,5,3072,3072,5,3170,3171,5,3267,3268,7,3330,3331,7,3406,3406,1,3538,3540,5,3655,3662,5,3897,3897,5,4038,4038,5,4184,4185,5,4352,4447,8,6068,6069,5,6155,6157,5,6448,6449,7,6742,6742,5,6783,6783,5,6966,6970,5,7042,7042,7,7143,7143,7,7212,7219,5,7412,7412,5,8206,8207,4,8294,8303,4,8596,8601,14,9410,9410,14,9742,9742,14,9757,9757,14,9770,9770,14,9794,9794,14,9828,9828,14,9855,9855,14,9882,9882,14,9900,9903,14,9929,9933,14,9963,9967,14,9987,9988,14,10006,10006,14,10062,10062,14,10175,10175,14,11744,11775,5,42607,42607,5,43043,43044,7,43263,43263,5,43444,43445,7,43569,43570,5,43698,43700,5,43766,43766,5,44032,44032,11,44144,44144,11,44256,44256,11,44368,44368,11,44480,44480,11,44592,44592,11,44704,44704,11,44816,44816,11,44928,44928,11,45040,45040,11,45152,45152,11,45264,45264,11,45376,45376,11,45488,45488,11,45600,45600,11,45712,45712,11,45824,45824,11,45936,45936,11,46048,46048,11,46160,46160,11,46272,46272,11,46384,46384,11,46496,46496,11,46608,46608,11,46720,46720,11,46832,46832,11,46944,46944,11,47056,47056,11,47168,47168,11,47280,47280,11,47392,47392,11,47504,47504,11,47616,47616,11,47728,47728,11,47840,47840,11,47952,47952,11,48064,48064,11,48176,48176,11,48288,48288,11,48400,48400,11,48512,48512,11,48624,48624,11,48736,48736,11,48848,48848,11,48960,48960,11,49072,49072,11,49184,49184,11,49296,49296,11,49408,49408,11,49520,49520,11,49632,49632,11,49744,49744,11,49856,49856,11,49968,49968,11,50080,50080,11,50192,50192,11,50304,50304,11,50416,50416,11,50528,50528,11,50640,50640,11,50752,50752,11,50864,50864,11,50976,50976,11,51088,51088,11,51200,51200,11,51312,51312,11,51424,51424,11,51536,51536,11,51648,51648,11,51760,51760,11,51872,51872,11,51984,51984,11,52096,52096,11,52208,52208,11,52320,52320,11,52432,52432,11,52544,52544,11,52656,52656,11,52768,52768,11,52880,52880,11,52992,52992,11,53104,53104,11,53216,53216,11,53328,53328,11,53440,53440,11,53552,53552,11,53664,53664,11,53776,53776,11,53888,53888,11,54000,54000,11,54112,54112,11,54224,54224,11,54336,54336,11,54448,54448,11,54560,54560,11,54672,54672,11,54784,54784,11,54896,54896,11,55008,55008,11,55120,55120,11,64286,64286,5,66272,66272,5,68900,68903,5,69762,69762,7,69817,69818,5,69927,69931,5,70003,70003,5,70070,70078,5,70094,70094,7,70194,70195,7,70206,70206,5,70400,70401,5,70463,70463,7,70475,70477,7,70512,70516,5,70722,70724,5,70832,70832,5,70842,70842,5,70847,70848,5,71088,71089,7,71102,71102,7,71219,71226,5,71231,71232,5,71342,71343,7,71453,71455,5,71463,71467,5,71737,71738,5,71995,71996,5,72000,72000,7,72145,72147,7,72160,72160,5,72249,72249,7,72273,72278,5,72330,72342,5,72752,72758,5,72850,72871,5,72882,72883,5,73018,73018,5,73031,73031,5,73109,73109,5,73461,73462,7,94031,94031,5,94192,94193,7,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,126976,126979,14,127184,127231,14,127344,127345,14,127405,127461,14,127514,127514,14,127561,127567,14,127778,127779,14,127896,127896,14,127985,127986,14,127995,127999,5,128326,128328,14,128360,128366,14,128378,128378,14,128394,128397,14,128405,128406,14,128422,128423,14,128435,128443,14,128453,128464,14,128479,128480,14,128484,128487,14,128496,128498,14,128640,128709,14,128723,128724,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129096,129103,14,129292,129292,14,129311,129311,14,129329,129330,14,129344,129349,14,129360,129374,14,129394,129394,14,129402,129402,14,129413,129425,14,129445,129450,14,129466,129471,14,129483,129483,14,129511,129535,14,129653,129655,14,129667,129670,14,129705,129711,14,129731,129743,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2307,2307,7,2366,2368,7,2382,2383,7,2434,2435,7,2497,2500,5,2519,2519,5,2563,2563,7,2631,2632,5,2677,2677,5,2750,2752,7,2763,2764,7,2817,2817,5,2879,2879,5,2891,2892,7,2914,2915,5,3008,3008,5,3021,3021,5,3076,3076,5,3146,3149,5,3202,3203,7,3264,3265,7,3271,3272,7,3298,3299,5,3390,3390,5,3402,3404,7,3426,3427,5,3535,3535,5,3544,3550,7,3635,3635,7,3763,3763,7,3893,3893,5,3953,3966,5,3981,3991,5,4145,4145,7,4157,4158,5,4209,4212,5,4237,4237,5,4520,4607,10,5970,5971,5,6071,6077,5,6089,6099,5,6277,6278,5,6439,6440,5,6451,6456,7,6683,6683,5,6744,6750,5,6765,6770,7,6846,6846,5,6964,6964,5,6972,6972,5,7019,7027,5,7074,7077,5,7083,7085,5,7146,7148,7,7154,7155,7,7222,7223,5,7394,7400,5,7416,7417,5,8204,8204,5,8233,8233,4,8288,8292,4,8413,8416,5,8482,8482,14,8986,8987,14,9193,9203,14,9654,9654,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9775,14,9792,9792,14,9800,9811,14,9825,9826,14,9831,9831,14,9852,9853,14,9872,9873,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9936,9936,14,9941,9960,14,9974,9974,14,9982,9985,14,9992,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10145,10145,14,11013,11015,14,11503,11505,5,12334,12335,5,12951,12951,14,42612,42621,5,43014,43014,5,43047,43047,7,43204,43205,5,43335,43345,5,43395,43395,7,43450,43451,7,43561,43566,5,43573,43574,5,43644,43644,5,43710,43711,5,43758,43759,7,44005,44005,5,44012,44012,7,44060,44060,11,44116,44116,11,44172,44172,11,44228,44228,11,44284,44284,11,44340,44340,11,44396,44396,11,44452,44452,11,44508,44508,11,44564,44564,11,44620,44620,11,44676,44676,11,44732,44732,11,44788,44788,11,44844,44844,11,44900,44900,11,44956,44956,11,45012,45012,11,45068,45068,11,45124,45124,11,45180,45180,11,45236,45236,11,45292,45292,11,45348,45348,11,45404,45404,11,45460,45460,11,45516,45516,11,45572,45572,11,45628,45628,11,45684,45684,11,45740,45740,11,45796,45796,11,45852,45852,11,45908,45908,11,45964,45964,11,46020,46020,11,46076,46076,11,46132,46132,11,46188,46188,11,46244,46244,11,46300,46300,11,46356,46356,11,46412,46412,11,46468,46468,11,46524,46524,11,46580,46580,11,46636,46636,11,46692,46692,11,46748,46748,11,46804,46804,11,46860,46860,11,46916,46916,11,46972,46972,11,47028,47028,11,47084,47084,11,47140,47140,11,47196,47196,11,47252,47252,11,47308,47308,11,47364,47364,11,47420,47420,11,47476,47476,11,47532,47532,11,47588,47588,11,47644,47644,11,47700,47700,11,47756,47756,11,47812,47812,11,47868,47868,11,47924,47924,11,47980,47980,11,48036,48036,11,48092,48092,11,48148,48148,11,48204,48204,11,48260,48260,11,48316,48316,11,48372,48372,11,48428,48428,11,48484,48484,11,48540,48540,11,48596,48596,11,48652,48652,11,48708,48708,11,48764,48764,11,48820,48820,11,48876,48876,11,48932,48932,11,48988,48988,11,49044,49044,11,49100,49100,11,49156,49156,11,49212,49212,11,49268,49268,11,49324,49324,11,49380,49380,11,49436,49436,11,49492,49492,11,49548,49548,11,49604,49604,11,49660,49660,11,49716,49716,11,49772,49772,11,49828,49828,11,49884,49884,11,49940,49940,11,49996,49996,11,50052,50052,11,50108,50108,11,50164,50164,11,50220,50220,11,50276,50276,11,50332,50332,11,50388,50388,11,50444,50444,11,50500,50500,11,50556,50556,11,50612,50612,11,50668,50668,11,50724,50724,11,50780,50780,11,50836,50836,11,50892,50892,11,50948,50948,11,51004,51004,11,51060,51060,11,51116,51116,11,51172,51172,11,51228,51228,11,51284,51284,11,51340,51340,11,51396,51396,11,51452,51452,11,51508,51508,11,51564,51564,11,51620,51620,11,51676,51676,11,51732,51732,11,51788,51788,11,51844,51844,11,51900,51900,11,51956,51956,11,52012,52012,11,52068,52068,11,52124,52124,11,52180,52180,11,52236,52236,11,52292,52292,11,52348,52348,11,52404,52404,11,52460,52460,11,52516,52516,11,52572,52572,11,52628,52628,11,52684,52684,11,52740,52740,11,52796,52796,11,52852,52852,11,52908,52908,11,52964,52964,11,53020,53020,11,53076,53076,11,53132,53132,11,53188,53188,11,53244,53244,11,53300,53300,11,53356,53356,11,53412,53412,11,53468,53468,11,53524,53524,11,53580,53580,11,53636,53636,11,53692,53692,11,53748,53748,11,53804,53804,11,53860,53860,11,53916,53916,11,53972,53972,11,54028,54028,11,54084,54084,11,54140,54140,11,54196,54196,11,54252,54252,11,54308,54308,11,54364,54364,11,54420,54420,11,54476,54476,11,54532,54532,11,54588,54588,11,54644,54644,11,54700,54700,11,54756,54756,11,54812,54812,11,54868,54868,11,54924,54924,11,54980,54980,11,55036,55036,11,55092,55092,11,55148,55148,11,55216,55238,9,65056,65071,5,65529,65531,4,68097,68099,5,68159,68159,5,69446,69456,5,69688,69702,5,69808,69810,7,69815,69816,7,69821,69821,1,69888,69890,5,69932,69932,7,69957,69958,7,70016,70017,5,70067,70069,7,70079,70080,7,70089,70092,5,70095,70095,5,70191,70193,5,70196,70196,5,70198,70199,5,70367,70367,5,70371,70378,5,70402,70403,7,70462,70462,5,70464,70464,5,70471,70472,7,70487,70487,5,70502,70508,5,70709,70711,7,70720,70721,7,70725,70725,7,70750,70750,5,70833,70834,7,70841,70841,7,70843,70844,7,70846,70846,7,70849,70849,7,71087,71087,5,71090,71093,5,71100,71101,5,71103,71104,5,71216,71218,7,71227,71228,7,71230,71230,7,71339,71339,5,71341,71341,5,71344,71349,5,71351,71351,5,71456,71457,7,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123628,123631,5,125252,125258,5,126980,126980,14,127183,127183,14,127245,127247,14,127340,127343,14,127358,127359,14,127377,127386,14,127462,127487,6,127491,127503,14,127535,127535,14,127548,127551,14,127568,127569,14,127744,127777,14,127780,127891,14,127894,127895,14,127897,127899,14,127902,127984,14,127987,127989,14,127991,127994,14,128000,128253,14,128255,128317,14,128329,128334,14,128336,128359,14,128367,128368,14,128371,128377,14,128379,128390,14,128392,128393,14,128398,128399,14,128401,128404,14,128407,128419,14,128421,128421,14,128424,128424,14,128433,128434,14,128444,128444,14,128450,128452,14,128465,128467,14,128476,128478,14,128481,128481,14,128483,128483,14,128488,128488,14,128495,128495,14,128499,128499,14,128506,128591,14,128710,128714,14,128721,128722,14,128725,128725,14,128728,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129664,129666,14,129671,129679,14,129686,129704,14,129712,129718,14,129728,129730,14,129744,129750,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2259,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3134,3136,5,3142,3144,5,3157,3158,5,3201,3201,5,3260,3260,5,3263,3263,5,3266,3266,5,3270,3270,5,3274,3275,7,3285,3286,5,3328,3329,5,3387,3388,5,3391,3392,7,3398,3400,7,3405,3405,5,3415,3415,5,3457,3457,5,3530,3530,5,3536,3537,7,3542,3542,5,3551,3551,5,3633,3633,5,3636,3642,5,3761,3761,5,3764,3772,5,3864,3865,5,3895,3895,5,3902,3903,7,3967,3967,7,3974,3975,5,3993,4028,5,4141,4144,5,4146,4151,5,4155,4156,7,4182,4183,7,4190,4192,5,4226,4226,5,4229,4230,5,4253,4253,5,4448,4519,9,4957,4959,5,5938,5940,5,6002,6003,5,6070,6070,7,6078,6085,7,6087,6088,7,6109,6109,5,6158,6158,4,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6848,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7673,5,8203,8203,4,8205,8205,13,8232,8232,4,8234,8238,4,8265,8265,14,8293,8293,4,8400,8412,5,8417,8417,5,8421,8432,5,8505,8505,14,8617,8618,14,9000,9000,14,9167,9167,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9776,9783,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9935,14,9937,9937,14,9939,9940,14,9961,9962,14,9968,9973,14,9975,9978,14,9981,9981,14,9986,9986,14,9989,9989,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10084,14,10133,10135,14,10160,10160,14,10548,10549,14,11035,11036,14,11093,11093,14,11647,11647,5,12330,12333,5,12336,12336,14,12441,12442,5,12953,12953,14,42608,42610,5,42654,42655,5,43010,43010,5,43019,43019,5,43045,43046,5,43052,43052,5,43188,43203,7,43232,43249,5,43302,43309,5,43346,43347,7,43392,43394,5,43443,43443,5,43446,43449,5,43452,43453,5,43493,43493,5,43567,43568,7,43571,43572,7,43587,43587,5,43597,43597,7,43696,43696,5,43703,43704,5,43713,43713,5,43756,43757,5,43765,43765,7,44003,44004,7,44006,44007,7,44009,44010,7,44013,44013,5,44033,44059,12,44061,44087,12,44089,44115,12,44117,44143,12,44145,44171,12,44173,44199,12,44201,44227,12,44229,44255,12,44257,44283,12,44285,44311,12,44313,44339,12,44341,44367,12,44369,44395,12,44397,44423,12,44425,44451,12,44453,44479,12,44481,44507,12,44509,44535,12,44537,44563,12,44565,44591,12,44593,44619,12,44621,44647,12,44649,44675,12,44677,44703,12,44705,44731,12,44733,44759,12,44761,44787,12,44789,44815,12,44817,44843,12,44845,44871,12,44873,44899,12,44901,44927,12,44929,44955,12,44957,44983,12,44985,45011,12,45013,45039,12,45041,45067,12,45069,45095,12,45097,45123,12,45125,45151,12,45153,45179,12,45181,45207,12,45209,45235,12,45237,45263,12,45265,45291,12,45293,45319,12,45321,45347,12,45349,45375,12,45377,45403,12,45405,45431,12,45433,45459,12,45461,45487,12,45489,45515,12,45517,45543,12,45545,45571,12,45573,45599,12,45601,45627,12,45629,45655,12,45657,45683,12,45685,45711,12,45713,45739,12,45741,45767,12,45769,45795,12,45797,45823,12,45825,45851,12,45853,45879,12,45881,45907,12,45909,45935,12,45937,45963,12,45965,45991,12,45993,46019,12,46021,46047,12,46049,46075,12,46077,46103,12,46105,46131,12,46133,46159,12,46161,46187,12,46189,46215,12,46217,46243,12,46245,46271,12,46273,46299,12,46301,46327,12,46329,46355,12,46357,46383,12,46385,46411,12,46413,46439,12,46441,46467,12,46469,46495,12,46497,46523,12,46525,46551,12,46553,46579,12,46581,46607,12,46609,46635,12,46637,46663,12,46665,46691,12,46693,46719,12,46721,46747,12,46749,46775,12,46777,46803,12,46805,46831,12,46833,46859,12,46861,46887,12,46889,46915,12,46917,46943,12,46945,46971,12,46973,46999,12,47001,47027,12,47029,47055,12,47057,47083,12,47085,47111,12,47113,47139,12,47141,47167,12,47169,47195,12,47197,47223,12,47225,47251,12,47253,47279,12,47281,47307,12,47309,47335,12,47337,47363,12,47365,47391,12,47393,47419,12,47421,47447,12,47449,47475,12,47477,47503,12,47505,47531,12,47533,47559,12,47561,47587,12,47589,47615,12,47617,47643,12,47645,47671,12,47673,47699,12,47701,47727,12,47729,47755,12,47757,47783,12,47785,47811,12,47813,47839,12,47841,47867,12,47869,47895,12,47897,47923,12,47925,47951,12,47953,47979,12,47981,48007,12,48009,48035,12,48037,48063,12,48065,48091,12,48093,48119,12,48121,48147,12,48149,48175,12,48177,48203,12,48205,48231,12,48233,48259,12,48261,48287,12,48289,48315,12,48317,48343,12,48345,48371,12,48373,48399,12,48401,48427,12,48429,48455,12,48457,48483,12,48485,48511,12,48513,48539,12,48541,48567,12,48569,48595,12,48597,48623,12,48625,48651,12,48653,48679,12,48681,48707,12,48709,48735,12,48737,48763,12,48765,48791,12,48793,48819,12,48821,48847,12,48849,48875,12,48877,48903,12,48905,48931,12,48933,48959,12,48961,48987,12,48989,49015,12,49017,49043,12,49045,49071,12,49073,49099,12,49101,49127,12,49129,49155,12,49157,49183,12,49185,49211,12,49213,49239,12,49241,49267,12,49269,49295,12,49297,49323,12,49325,49351,12,49353,49379,12,49381,49407,12,49409,49435,12,49437,49463,12,49465,49491,12,49493,49519,12,49521,49547,12,49549,49575,12,49577,49603,12,49605,49631,12,49633,49659,12,49661,49687,12,49689,49715,12,49717,49743,12,49745,49771,12,49773,49799,12,49801,49827,12,49829,49855,12,49857,49883,12,49885,49911,12,49913,49939,12,49941,49967,12,49969,49995,12,49997,50023,12,50025,50051,12,50053,50079,12,50081,50107,12,50109,50135,12,50137,50163,12,50165,50191,12,50193,50219,12,50221,50247,12,50249,50275,12,50277,50303,12,50305,50331,12,50333,50359,12,50361,50387,12,50389,50415,12,50417,50443,12,50445,50471,12,50473,50499,12,50501,50527,12,50529,50555,12,50557,50583,12,50585,50611,12,50613,50639,12,50641,50667,12,50669,50695,12,50697,50723,12,50725,50751,12,50753,50779,12,50781,50807,12,50809,50835,12,50837,50863,12,50865,50891,12,50893,50919,12,50921,50947,12,50949,50975,12,50977,51003,12,51005,51031,12,51033,51059,12,51061,51087,12,51089,51115,12,51117,51143,12,51145,51171,12,51173,51199,12,51201,51227,12,51229,51255,12,51257,51283,12,51285,51311,12,51313,51339,12,51341,51367,12,51369,51395,12,51397,51423,12,51425,51451,12,51453,51479,12,51481,51507,12,51509,51535,12,51537,51563,12,51565,51591,12,51593,51619,12,51621,51647,12,51649,51675,12,51677,51703,12,51705,51731,12,51733,51759,12,51761,51787,12,51789,51815,12,51817,51843,12,51845,51871,12,51873,51899,12,51901,51927,12,51929,51955,12,51957,51983,12,51985,52011,12,52013,52039,12,52041,52067,12,52069,52095,12,52097,52123,12,52125,52151,12,52153,52179,12,52181,52207,12,52209,52235,12,52237,52263,12,52265,52291,12,52293,52319,12,52321,52347,12,52349,52375,12,52377,52403,12,52405,52431,12,52433,52459,12,52461,52487,12,52489,52515,12,52517,52543,12,52545,52571,12,52573,52599,12,52601,52627,12,52629,52655,12,52657,52683,12,52685,52711,12,52713,52739,12,52741,52767,12,52769,52795,12,52797,52823,12,52825,52851,12,52853,52879,12,52881,52907,12,52909,52935,12,52937,52963,12,52965,52991,12,52993,53019,12,53021,53047,12,53049,53075,12,53077,53103,12,53105,53131,12,53133,53159,12,53161,53187,12,53189,53215,12,53217,53243,12,53245,53271,12,53273,53299,12,53301,53327,12,53329,53355,12,53357,53383,12,53385,53411,12,53413,53439,12,53441,53467,12,53469,53495,12,53497,53523,12,53525,53551,12,53553,53579,12,53581,53607,12,53609,53635,12,53637,53663,12,53665,53691,12,53693,53719,12,53721,53747,12,53749,53775,12,53777,53803,12,53805,53831,12,53833,53859,12,53861,53887,12,53889,53915,12,53917,53943,12,53945,53971,12,53973,53999,12,54001,54027,12,54029,54055,12,54057,54083,12,54085,54111,12,54113,54139,12,54141,54167,12,54169,54195,12,54197,54223,12,54225,54251,12,54253,54279,12,54281,54307,12,54309,54335,12,54337,54363,12,54365,54391,12,54393,54419,12,54421,54447,12,54449,54475,12,54477,54503,12,54505,54531,12,54533,54559,12,54561,54587,12,54589,54615,12,54617,54643,12,54645,54671,12,54673,54699,12,54701,54727,12,54729,54755,12,54757,54783,12,54785,54811,12,54813,54839,12,54841,54867,12,54869,54895,12,54897,54923,12,54925,54951,12,54953,54979,12,54981,55007,12,55009,55035,12,55037,55063,12,55065,55091,12,55093,55119,12,55121,55147,12,55149,55175,12,55177,55203,12,55243,55291,10,65024,65039,5,65279,65279,4,65520,65528,4,66045,66045,5,66422,66426,5,68101,68102,5,68152,68154,5,68325,68326,5,69291,69292,5,69632,69632,7,69634,69634,7,69759,69761,5]")}static getInstance(){return KX._INSTANCE||(KX._INSTANCE=new KX),KX._INSTANCE}getGraphemeBreakType(e){if(e<32)return 10===e?3:13===e?2:4;if(e<127)return 0;const t=this._data,n=t.length/3;let i=1;for(;i<=n;)if(e<t[3*i])i*=2;else{if(!(e>t[3*i+1]))return t[3*i+2];i=2*i+1}return 0}}function qX(e,t){if(0===e)return 0;const n=function(e,t){let n=IX(t,e);e-=$X(n);for(;YX(n)||65039===n||8419===n;){if(0===e)return;n=IX(t,e),e-=$X(n)}if(!zX(n))return;if(e>=0){const n=IX(t,e);8205===n&&(e-=$X(n))}return e}(e,t);if(void 0!==n)return n;return e-=$X(IX(t,e))}function $X(e){return e>=65536?2:1}function YX(e){return 127995<=e&&e<=127999}var XX,ZX;KX._INSTANCE=null;class QX{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){return e.charCodeAt(0)-this._value.charCodeAt(this._pos)}value(){return this._value[this._pos]}}class JX{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++){if(46===this._value.charCodeAt(this._to)){if(!e)break;this._from++}else e=!1}return this}cmp(e){return this._caseSensitive?pX(e,this._value,0,e.length,this._from,this._to):vX(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class eZ{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){return this._value=e.replace(/\\$|\/$/,""),this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++){const t=this._value.charCodeAt(this._to);if(47===t||this._splitOnBackslash&&92===t){if(!e)break;this._from++}else e=!1}return this}cmp(e){return this._caseSensitive?pX(e,this._value,0,e.length,this._from,this._to):vX(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class tZ{constructor(e){this._ignorePathCasing=e,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new eZ(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5),this._stateIdx=0,this}next(){return 3===this._states[this._stateIdx]&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return 3===this._states[this._stateIdx]&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(1===this._states[this._stateIdx])return mX(e,this._value.scheme);if(2===this._states[this._stateIdx])return mX(e,this._value.authority);if(3===this._states[this._stateIdx])return this._pathIterator.cmp(e);if(4===this._states[this._stateIdx])return gX(e,this._value.query);if(5===this._states[this._stateIdx])return gX(e,this._value.fragment);throw new Error}value(){if(1===this._states[this._stateIdx])return this._value.scheme;if(2===this._states[this._stateIdx])return this._value.authority;if(3===this._states[this._stateIdx])return this._pathIterator.value();if(4===this._states[this._stateIdx])return this._value.query;if(5===this._states[this._stateIdx])return this._value.fragment;throw new Error}}class nZ{isEmpty(){return!(this.left||this.mid||this.right||this.value)}}class iZ{constructor(e){this._iter=e}static forUris(e=(()=>!1)){return new iZ(new tZ(e))}static forStrings(){return new iZ(new QX)}static forConfigKeys(){return new iZ(new JX)}clear(){this._root=void 0}set(e,t){const n=this._iter.reset(e);let i;for(this._root||(this._root=new nZ,this._root.segment=n.value()),i=this._root;;){const e=n.cmp(i.segment);if(e>0)i.left||(i.left=new nZ,i.left.segment=n.value()),i=i.left;else if(e<0)i.right||(i.right=new nZ,i.right.segment=n.value()),i=i.right;else{if(!n.hasNext())break;n.next(),i.mid||(i.mid=new nZ,i.mid.segment=n.value()),i=i.mid}}const r=i.value;return i.value=t,i.key=e,r}get(e){var t;return null===(t=this._getNode(e))||void 0===t?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let n=this._root;for(;n;){const e=t.cmp(n.segment);if(e>0)n=n.left;else if(e<0)n=n.right;else{if(!t.hasNext())break;t.next(),n=n.mid}}return n}has(e){const t=this._getNode(e);return!(void 0===(null==t?void 0:t.value)&&void 0===(null==t?void 0:t.mid))}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const n=this._iter.reset(e),i=[];let r=this._root;for(;r;){const e=n.cmp(r.segment);if(e>0)i.push([1,r]),r=r.left;else if(e<0)i.push([-1,r]),r=r.right;else{if(!n.hasNext()){for(t?(r.left=void 0,r.mid=void 0,r.right=void 0):r.value=void 0;i.length>0&&r.isEmpty();){let[e,t]=i.pop();switch(e){case 1:t.left=void 0;break;case 0:t.mid=void 0;break;case-1:t.right=void 0}r=t}break}n.next(),i.push([0,r]),r=r.mid}}}findSubstr(e){const t=this._iter.reset(e);let n,i=this._root;for(;i;){const e=t.cmp(i.segment);if(e>0)i=i.left;else if(e<0)i=i.right;else{if(!t.hasNext())break;t.next(),n=i.value||n,i=i.mid}}return i&&i.value||n}findSuperstr(e){const t=this._iter.reset(e);let n=this._root;for(;n;){const e=t.cmp(n.segment);if(e>0)n=n.left;else if(e<0)n=n.right;else{if(!t.hasNext())return n.mid?this._entries(n.mid):void 0;t.next(),n=n.mid}}}forEach(e){for(const[t,n]of this)e(n,t)}*[Symbol.iterator](){yield*this._entries(this._root)}*_entries(e){if(!e)return;const t=[e];for(;t.length>0;){const e=t.pop();e&&(e.value&&(yield[e.key,e.value]),e.left&&t.push(e.left),e.mid&&t.push(e.mid),e.right&&t.push(e.right))}}}class rZ{constructor(e,t){this[XX]="ResourceMap",e instanceof rZ?(this.map=new Map(e.map),this.toKey=null!=t?t:rZ.defaultToKey):(this.map=new Map,this.toKey=null!=e?e:rZ.defaultToKey)}set(e,t){return this.map.set(this.toKey(e),t),this}get(e){return this.map.get(this.toKey(e))}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){void 0!==t&&(e=e.bind(t));for(let[n,i]of this.map)e(i,_K.parse(n),this)}values(){return this.map.values()}*keys(){for(let e of this.map.keys())yield _K.parse(e)}*entries(){for(let e of this.map.entries())yield[_K.parse(e[0]),e[1]]}*[(XX=Symbol.toStringTag,Symbol.iterator)](){for(let e of this.map)yield[_K.parse(e[0]),e[1]]}}rZ.defaultToKey=e=>e.toString();class oZ{constructor(){this[ZX]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null===(e=this._head)||void 0===e?void 0:e.value}get last(){var e;return null===(e=this._tail)||void 0===e?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const n=this._map.get(e);if(n)return 0!==t&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,0!==n&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:default:this.addItemLast(i)}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.key,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}values(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.value,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}entries(){const e=this,t=this._state;let n=this._head;const i={[Symbol.iterator]:()=>i,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:[n.key,n.value],done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return i}[(ZX=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(1===t||2===t)if(1===t){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(2===t){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}class sZ extends oZ{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}const aZ="undefined"!=typeof Buffer,lZ="undefined"!=typeof TextDecoder;let cZ;class uZ{constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}static wrap(e){return aZ&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new uZ(e)}toString(){return aZ?this.buffer.toString():lZ?(cZ||(cZ=new TextDecoder),cZ.decode(this.buffer)):function(e){const t=e.byteLength,n=[];let i=0;for(;i<t;){const r=e[i];let o;if(o=r>=240&&i+3<t?(7&e[i++])<<18>>>0|(63&e[i++])<<12>>>0|(63&e[i++])<<6>>>0|(63&e[i++])<<0>>>0:r>=224&&i+2<t?(15&e[i++])<<12>>>0|(63&e[i++])<<6>>>0|(63&e[i++])<<0>>>0:r>=192&&i+1<t?(31&e[i++])<<6>>>0|(63&e[i++])<<0>>>0:e[i++],o>=0&&o<=55295||o>=57344&&o<=65535)n.push(String.fromCharCode(o));else if(o>=65536&&o<=1114111){const e=o-65536,t=55296+((1047552&e)>>>10),i=56320+((1023&e)>>>0);n.push(String.fromCharCode(t)),n.push(String.fromCharCode(i))}else n.push(String.fromCharCode(65533))}return n.join("")}(this.buffer)}}function hZ(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0}function dZ(e,t,n){e[n+0]=255&t,t>>>=8,e[n+1]=255&t}function fZ(e,t){return e[t]*Math.pow(2,24)+e[t+1]*Math.pow(2,16)+e[t+2]*Math.pow(2,8)+e[t+3]}function gZ(e,t,n){e[n+3]=t,t>>>=8,e[n+2]=t,t>>>=8,e[n+1]=t,t>>>=8,e[n]=t}function pZ(e,t){return e[t]}function mZ(e,t,n){e[n]=t}function vZ(e){let t=JSON.parse(e);return t=yZ(t),t}function yZ(e,t=0){if(!e||t>200)return e;if("object"==typeof e){switch(e.$mid){case 1:return _K.revive(e);case 2:return new RegExp(e.source,e.flags)}if(e instanceof uZ||e instanceof Uint8Array)return e;if(Array.isArray(e))for(let n=0;n<e.length;++n)e[n]=yZ(e[n],t+1);else for(const n in e)Object.hasOwnProperty.call(e,n)&&(e[n]=yZ(e[n],t+1))}return e}function _Z(e){return-1===e.indexOf("/")&&(e=function(e){return e.replace(/[\\/]/g,oK.sep)}(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e="/"+e),e}function bZ(e){return!!aj&&(((t=e.charCodeAt(0))>=65&&t<=90||t>=97&&t<=122)&&58===e.charCodeAt(1));var t}function wZ(e){return EK(e,!0)}const CZ=new class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:gX(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t||!(!e||!t)&&this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}joinPath(e,...t){return _K.joinPath(e,...t)}basenameOrAuthority(e){return EZ(e)||e.authority}basename(e){return oK.basename(e.path)}dirname(e){if(0===e.path.length)return e;let t;return e.scheme===j$.file?t=_K.file(cK(wZ(e))).path:(t=oK.dirname(e.path),e.authority&&t.length&&47!==t.charCodeAt(0)&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return t=e.scheme===j$.file?_K.file(sK(wZ(e))).path:oK.normalize(e.path),e.with({path:t})}resolvePath(e,t){if(e.scheme===j$.file){const n=_K.file(aK(wZ(e),t));return e.with({authority:n.authority,path:n.path})}return t=_Z(t),e.with({path:oK.resolve(e.path,t)})}}((()=>!1)),SZ=CZ.isEqual.bind(CZ),xZ=CZ.basenameOrAuthority.bind(CZ),EZ=CZ.basename.bind(CZ),kZ=CZ.dirname.bind(CZ),LZ=CZ.joinPath.bind(CZ),DZ=CZ.normalizePath.bind(CZ),NZ=CZ.resolvePath.bind(CZ);var IZ,TZ;function MZ(e){return Array.isArray(e)}function AZ(e){return"string"==typeof e}function OZ(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function RZ(e){return"number"==typeof e&&!isNaN(e)}function PZ(e){return!0===e||!1===e}function FZ(e){return void 0===e}function BZ(e){return FZ(e)||null===e}function WZ(e,t){if(!e)throw new Error(t?`Unexpected type, expected '${t}'`:"Unexpected type")}function zZ(e){if(BZ(e))throw new Error("Assertion Failed: argument is undefined or null");return e}function VZ(e){return"function"==typeof e}function UZ(e,t){if(AZ(t)){if(typeof e!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(VZ(t)){try{if(e instanceof t)return}catch(n){}if(!BZ(e)&&e.constructor===t)return;if(1===t.length&&!0===t.call(void 0,e))return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function HZ(e){const t=[];for(const n of function(e){let t=[],n=Object.getPrototypeOf(e);for(;Object.prototype!==n;)t=t.concat(Object.getOwnPropertyNames(n)),n=Object.getPrototypeOf(n);return t}(e))"function"==typeof e[n]&&t.push(n);return t}function jZ(e,t){const n=e=>function(){const n=Array.prototype.slice.call(arguments,0);return t(e,n)};let i={};for(const r of e)i[r]=n(r);return i}function GZ(e){return null===e?void 0:e}(TZ=IZ||(IZ={})).META_DATA_LABEL="label",TZ.META_DATA_DESCRIPTION="description",TZ.META_DATA_SIZE="size",TZ.META_DATA_MIME="mime",TZ.parseMetaData=function(e){const t=new Map;e.path.substring(e.path.indexOf(";")+1,e.path.lastIndexOf(";")).split(";").forEach((e=>{const[n,i]=e.split(":");n&&i&&t.set(n,i)}));const n=e.path.substring(0,e.path.indexOf(";"));return n&&t.set(TZ.META_DATA_MIME,n),t};const KZ=i$("commandService"),qZ=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new EG,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(e,t){if(!e)throw new Error("invalid command");if("string"==typeof e){if(!t)throw new Error("invalid command");return this.registerCommand({id:e,handler:t})}if(e.description){const t=[];for(let i of e.description.args)t.push(i.constraint);const n=e.handler;e.handler=function(e,...i){return function(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++)UZ(e[i],t[i])}(i,t),n(e,...i)}}const{id:n}=e;let i=this._commands.get(n);i||(i=new bG,this._commands.set(n,i));let r=i.unshift(e),o=gG((()=>{r();const e=this._commands.get(n);(null==e?void 0:e.isEmpty())&&this._commands.delete(n)}));return this._onDidRegisterCommand.fire(n),o}registerCommandAlias(e,t){return qZ.registerCommand(e,((e,...n)=>e.get(KZ).executeCommand(t,...n)))}getCommand(e){const t=this._commands.get(e);if(t&&!t.isEmpty())return lG.first(t)}getCommands(){const e=new Map;for(const t of this._commands.keys()){const n=this.getCommand(t);n&&e.set(t,n)}return e}};var $Z,YZ;qZ.registerCommand("noop",(()=>{})),(YZ=$Z||($Z={}))[YZ.API=0]="API",YZ[YZ.USER=1]="USER";var XZ=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const ZZ=i$("openerService"),QZ=Object.freeze({_serviceBrand:void 0,registerOpener:()=>mG.None,registerValidator:()=>mG.None,registerExternalUriResolver:()=>mG.None,setDefaultExternalOpener(){},registerExternalOpener:()=>mG.None,open(){return XZ(this,void 0,void 0,(function*(){return!1}))},resolveExternalUri(e){return XZ(this,void 0,void 0,(function*(){return{resolved:e,dispose(){}}}))}});function JZ(e,t){return _K.isUri(e)?wX(e.scheme,t):SX(e,t+":")}var eQ=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},tQ=function(e,t){return function(n,i){t(n,i,e)}},nQ=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let iQ=class{constructor(e){this._commandService=e}open(e,t){return nQ(this,void 0,void 0,(function*(){if(!JZ(e,j$.command))return!1;if(!(null==t?void 0:t.allowCommands))return!0;"string"==typeof e&&(e=_K.parse(e));let n=[];try{n=vZ(decodeURIComponent(e.query))}catch(i){try{n=vZ(e.query)}catch(r){}}return Array.isArray(n)||(n=[n]),yield this._commandService.executeCommand(e.path,...n),!0}))}};iQ=eQ([tQ(0,KZ)],iQ);let rQ=class{constructor(e){this._editorService=e}open(e,t){return nQ(this,void 0,void 0,(function*(){let n;"string"==typeof e&&(e=_K.parse(e));const i=/^L?(\d+)(?:,(\d+))?/.exec(e.fragment);return i&&(n={startLineNumber:parseInt(i[1]),startColumn:i[2]?parseInt(i[2]):1},e=e.with({fragment:""})),e.scheme===j$.file&&(e=DZ(e)),yield this._editorService.openCodeEditor({resource:e,options:Object.assign({selection:n,context:(null==t?void 0:t.fromUserGesture)?$Z.USER:$Z.API},null==t?void 0:t.editorOptions)},this._editorService.getFocusedCodeEditor(),null==t?void 0:t.openToSide),!0}))}};rQ=eQ([tQ(0,o$)],rQ);let oQ=class{constructor(e,t){this._openers=new bG,this._validators=new bG,this._resolvers=new bG,this._resolvedUriTargets=new rZ((e=>e.with({path:null,fragment:null,query:null}).toString())),this._externalOpeners=new bG,this._defaultExternalOpener={openExternal:e=>nQ(this,void 0,void 0,(function*(){return JZ(e,j$.http)||JZ(e,j$.https)?XY(e):window.location.href=e,!0}))},this._openers.push({open:(e,t)=>nQ(this,void 0,void 0,(function*(){return!!((null==t?void 0:t.openExternal)||JZ(e,j$.mailto)||JZ(e,j$.http)||JZ(e,j$.https))&&(yield this._doOpenExternal(e,t),!0)}))}),this._openers.push(new iQ(t)),this._openers.push(new rQ(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}registerValidator(e){return{dispose:this._validators.push(e)}}registerExternalUriResolver(e){return{dispose:this._resolvers.push(e)}}setDefaultExternalOpener(e){this._defaultExternalOpener=e}registerExternalOpener(e){return{dispose:this._externalOpeners.push(e)}}open(e,t){var n;return nQ(this,void 0,void 0,(function*(){const i="string"==typeof e?_K.parse(e):e,r=null!==(n=this._resolvedUriTargets.get(i))&&void 0!==n?n:e;for(const e of this._validators)if(!(yield e.shouldOpen(r)))return!1;for(const n of this._openers){if(yield n.open(e,t))return!0}return!1}))}resolveExternalUri(e,t){return nQ(this,void 0,void 0,(function*(){for(const i of this._resolvers)try{const n=yield i.resolveExternalUri(e,t);if(n)return this._resolvedUriTargets.has(n.resolved)||this._resolvedUriTargets.set(n.resolved,e),n}catch(n){}throw new Error("Could not resolve external URI: "+e.toString())}))}_doOpenExternal(e,t){return nQ(this,void 0,void 0,(function*(){const n="string"==typeof e?_K.parse(e):e;let i,r;try{i=(yield this.resolveExternalUri(n,t)).resolved}catch(o){i=n}if(r="string"==typeof e&&n.toString()===i.toString()?e:encodeURI(i.toString(!0)),null==t?void 0:t.allowContributedOpeners){const e="string"==typeof(null==t?void 0:t.allowContributedOpeners)?null==t?void 0:t.allowContributedOpeners:void 0;for(const t of this._externalOpeners){if(yield t.openExternal(r,{sourceUri:n,preferredOpenerId:e},TG.None))return!0}}return this._defaultExternalOpener.openExternal(r,{sourceUri:n},TG.None)}))}dispose(){this._validators.clear()}};function sQ(e,t){if(!e)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}function aQ(e){if(!e||"object"!=typeof e)return e;if(e instanceof RegExp)return e;const t=Array.isArray(e)?[]:{};return Object.keys(e).forEach((n=>{e[n]&&"object"==typeof e[n]?t[n]=aQ(e[n]):t[n]=e[n]})),t}oQ=eQ([tQ(0,o$),tQ(1,KZ)],oQ);const lQ=Object.prototype.hasOwnProperty;function cQ(e,t){return uQ(e,t,new Set)}function uQ(e,t,n){if(BZ(e))return e;const i=t(e);if(void 0!==i)return i;if(MZ(e)){const i=[];for(const r of e)i.push(uQ(r,t,n));return i}if(OZ(e)){if(n.has(e))throw new Error("Cannot clone recursive data-structure");n.add(e);const i={};for(let r in e)lQ.call(e,r)&&(i[r]=uQ(e[r],t,n));return n.delete(e),i}return e}function hQ(e,t,n=!0){return OZ(e)?(OZ(t)&&Object.keys(t).forEach((i=>{i in e?n&&(OZ(e[i])&&OZ(t[i])?hQ(e[i],t[i],n):e[i]=t[i]):e[i]=t[i]})),e):t}function dQ(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;if(Array.isArray(e)!==Array.isArray(t))return!1;let n,i;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(!dQ(e[n],t[n]))return!1}else{const r=[];for(i in e)r.push(i);r.sort();const o=[];for(i in t)o.push(i);if(o.sort(),!dQ(r,o))return!1;for(n=0;n<r.length;n++)if(!dQ(e[r[n]],t[r[n]]))return!1}return!0}function fQ(e,t,n){const i=t(e);return void 0===i?n:i}const gQ={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0};class pQ extends mG{constructor(e,t={}){super(),this._onDidUpdate=this._register(new EG),this._editor=e,this._options=hQ(t,gQ,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=Boolean(this._options.alwaysRevealFirst),this._register(this._editor.onDidDispose((()=>this.dispose()))),this._register(this._editor.onDidUpdateDiff((()=>this._onDiffUpdated()))),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition((e=>{this.ignoreSelectionChange||(this.nextIdx=-1)}))),this._options.alwaysRevealFirst&&this._register(this._editor.getModifiedEditor().onDidChangeModel((e=>{this.revealFirst=!0}))),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&null!==this._editor.getLineChanges()&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(e){this.ranges=[],e&&e.forEach((e=>{!this._options.ignoreCharChanges&&e.charChanges?e.charChanges.forEach((e=>{this.ranges.push({rhs:!0,range:new TK(e.modifiedStartLineNumber,e.modifiedStartColumn,e.modifiedEndLineNumber,e.modifiedEndColumn)})})):this.ranges.push({rhs:!0,range:new TK(e.modifiedStartLineNumber,1,e.modifiedStartLineNumber,1)})})),this.ranges.sort(((e,t)=>e.range.getStartPosition().isBeforeOrEqual(t.range.getStartPosition())?-1:t.range.getStartPosition().isBeforeOrEqual(e.range.getStartPosition())?1:0)),this._onDidUpdate.fire(this)}_initIdx(e){let t=!1,n=this._editor.getPosition();if(n){for(let i=0,r=this.ranges.length;i<r&&!t;i++){let r=this.ranges[i].range;n.isBeforeOrEqual(r.getStartPosition())&&(this.nextIdx=i+(e?0:-1),t=!0)}t||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}else this.nextIdx=0}_move(e,t){if(sQ(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;-1===this.nextIdx?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));let n=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{let e=n.range.getStartPosition();this._editor.setPosition(e),this._editor.revealPositionInCenter(e,t)}finally{this.ignoreSelectionChange=!1}}canNavigate(){return this.ranges&&this.ranges.length>0}next(e=0){this._move(!0,e)}previous(e=0){this._move(!1,e)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}}const mQ=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new EG,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(e){e=Math.min(Math.max(-5,e),20),this._zoomLevel!==e&&(this._zoomLevel=e,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},vQ=lj?1.5:1.35;class yQ{constructor(e){this._bareFontInfoBrand=void 0,this.zoomLevel=e.zoomLevel,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.lineHeight=0|e.lineHeight,this.letterSpacing=e.letterSpacing}static createFromValidatedSettings(e,t,n,i){const r=e.get(39),o=e.get(43),s=e.get(42),a=e.get(41),l=e.get(56),c=e.get(53);return yQ._create(r,o,s,a,l,c,t,n,i)}static _create(e,t,n,i,r,o,s,a,l){0===r?r=vQ*n:r<8&&(r*=n),(r=Math.round(r))<8&&(r=8);const c=1+(l?0:.1*mQ.getZoomLevel());return new yQ({zoomLevel:s,pixelRatio:a,fontFamily:e,fontWeight:t,fontSize:n*=c,fontFeatureSettings:i,lineHeight:r*=c,letterSpacing:o})}getId(){return this.zoomLevel+"-"+this.pixelRatio+"-"+this.fontFamily+"-"+this.fontWeight+"-"+this.fontSize+"-"+this.fontFeatureSettings+"-"+this.lineHeight+"-"+this.letterSpacing}getMassagedFontFamily(){return/[,"']/.test(this.fontFamily)?this.fontFamily:/[+ ]/.test(this.fontFamily)?`"${this.fontFamily}"`:this.fontFamily}}class _Q extends yQ{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=1,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}const bQ={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var wQ,CQ;!function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=4]="Right",e[e.Full=7]="Full"}(wQ||(wQ={})),function(e){e[e.Inline=1]="Inline",e[e.Gutter=2]="Gutter"}(CQ||(CQ={}));class SQ{constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,0|e.tabSize),this.indentSize=0|e.tabSize,this.insertSpaces=Boolean(e.insertSpaces),this.defaultEOL=0|e.defaultEOL,this.trimAutoWhitespace=Boolean(e.trimAutoWhitespace)}equals(e){return this.tabSize===e.tabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class xQ{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}class EQ{constructor(e,t,n,i,r,o){this.identifier=e,this.range=t,this.text=n,this.forceMoveMarkers=i,this.isAutoWhitespaceEdit=r,this._isTracked=o}}class kQ{constructor(e,t,n){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=n}}function LQ(e){return DQ(e,0)}function DQ(e,t){switch(typeof e){case"object":return null===e?NQ(349,t):Array.isArray(e)?(n=e,i=NQ(104579,i=t),n.reduce(((e,t)=>DQ(t,e)),i)):function(e,t){return t=NQ(181387,t),Object.keys(e).sort().reduce(((t,n)=>(t=IQ(n,t),DQ(e[n],t))),t)}(e,t);case"string":return IQ(e,t);case"boolean":return function(e,t){return NQ(e?433:863,t)}(e,t);case"number":return NQ(e,t);case"undefined":return NQ(937,t);default:return NQ(617,t)}var n,i}function NQ(e,t){return(t<<5)-t+e|0}function IQ(e,t){t=NQ(149417,t);for(let n=0,i=e.length;n<i;n++)t=NQ(e.charCodeAt(n),t);return t}function TQ(e,t,n=32){const i=n-t;return(e<<t|(~((1<<i)-1)&e)>>>i)>>>0}function MQ(e,t=0,n=e.byteLength,i=0){for(let r=0;r<n;r++)e[t+r]=i}function AQ(e,t=32){return e instanceof ArrayBuffer?Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join(""):function(e,t,n="0"){for(;e.length<t;)e=n+e;return e}((e>>>0).toString(16),t/4)}class OQ{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(0===t)return;const n=this._buff;let i,r,o=this._buffLen,s=this._leftoverHighSurrogate;for(0!==s?(i=s,r=-1,s=0):(i=e.charCodeAt(0),r=0);;){let a=i;if(kX(i)){if(!(r+1<t)){s=i;break}{const t=e.charCodeAt(r+1);LX(t)?(r++,a=DX(i,t)):a=65533}}else LX(i)&&(a=65533);if(o=this._push(n,o,a),r++,!(r<t))break;i=e.charCodeAt(r)}this._buffLen=o,this._leftoverHighSurrogate=s}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(1984&n)>>>6,e[t++]=128|(63&n)>>>0):n<65536?(e[t++]=224|(61440&n)>>>12,e[t++]=128|(4032&n)>>>6,e[t++]=128|(63&n)>>>0):(e[t++]=240|(1835008&n)>>>18,e[t++]=128|(258048&n)>>>12,e[t++]=128|(4032&n)>>>6,e[t++]=128|(63&n)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),AQ(this._h0)+AQ(this._h1)+AQ(this._h2)+AQ(this._h3)+AQ(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,MQ(this._buff,this._buffLen),this._buffLen>56&&(this._step(),MQ(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=OQ._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,TQ(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let n,i,r,o=this._h0,s=this._h1,a=this._h2,l=this._h3,c=this._h4;for(let u=0;u<80;u++)u<20?(n=s&a|~s&l,i=1518500249):u<40?(n=s^a^l,i=1859775393):u<60?(n=s&a|s&l|a&l,i=2400959708):(n=s^a^l,i=3395469782),r=TQ(o,5)+n+c+i+e.getUint32(4*u,!1)&4294967295,c=l,l=a,a=TQ(s,30),s=o,o=r;this._h0=this._h0+o&4294967295,this._h1=this._h1+s&4294967295,this._h2=this._h2+a&4294967295,this._h3=this._h3+l&4294967295,this._h4=this._h4+c&4294967295}}function RQ(e,t,n){return Math.min(Math.max(e,t),n)}OQ._bigBlock32=new DataView(new ArrayBuffer(320));class PQ{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this}get value(){return this._val}}const FQ=/\//g;function BQ(e){switch(e){case 0:return"";case 1:return"[^/\\\\]*?";default:return"(?:[/\\\\]|[^/\\\\]+[/\\\\]|[/\\\\][^/\\\\]+)*?"}}function WQ(e,t){if(!e)return[];const n=[];let i=!1,r=!1,o="";for(const s of e){switch(s){case t:if(!i&&!r){n.push(o),o="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":r=!0;break;case"]":r=!1}o+=s}return o&&n.push(o),n}function zQ(e){if(!e)return"";let t="";const n=WQ(e,"/");if(n.every((e=>"**"===e)))t=".*";else{let e=!1;n.forEach(((i,r)=>{if("**"===i)return void(e||(t+=BQ(2),e=!0));let o=!1,s="",a=!1,l="";for(const e of i)if("}"!==e&&o)s+=e;else if(!a||"]"===e&&l)switch(e){case"{":o=!0;continue;case"[":a=!0;continue;case"}":const n=`(?:${WQ(s,",").map((e=>zQ(e))).join("|")})`;t+=n,o=!1,s="";break;case"]":t+="["+l+"]",a=!1,l="";break;case"?":t+="[^/\\\\]";continue;case"*":t+=BQ(1);continue;default:t+=rX(e)}else{let t;t="-"===e?e:"^"!==e&&"!"!==e||l?"/"===e?"":rX(e):"^",l+=t}r<n.length-1&&("**"!==n[r+1]||r+2<n.length)&&(t+="[/\\\\]"),e=!1}))}return t}const VQ=/^\*\*\/\*\.[\w\.-]+$/,UQ=/^\*\*\/([\w\.-]+)\/?$/,HQ=/^{\*\*\/[\*\.]?[\w\.-]+\/?(,\*\*\/[\*\.]?[\w\.-]+\/?)*}$/,jQ=/^{\*\*\/[\*\.]?[\w\.-]+(\/(\*\*)?)?(,\*\*\/[\*\.]?[\w\.-]+(\/(\*\*)?)?)*}$/,GQ=/^\*\*((\/[\w\.-]+)+)\/?$/,KQ=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,qQ=new sZ(1e4),$Q=function(){return!1},YQ=function(){return null};function XQ(e,t){if(!e)return YQ;let n;n="string"!=typeof e?e.pattern:e,n=n.trim();const i=`${n}_${!!t.trimForExclusions}`;let r,o=qQ.get(i);if(o)return ZQ(o,e);if(VQ.test(n)){const e=n.substr(4);o=function(t,i){return"string"==typeof t&&t.endsWith(e)?n:null}}else o=(r=UQ.exec(QQ(n,t)))?function(e,t){const n=`/${e}`,i=`\\${e}`,r=function(r,o){return"string"!=typeof r?null:o?o===e?t:null:r===e||r.endsWith(n)||r.endsWith(i)?t:null},o=[e];return r.basenames=o,r.patterns=[t],r.allBasenames=o,r}(r[1],n):(t.trimForExclusions?jQ:HQ).test(n)?function(e,t){const n=tJ(e.slice(1,-1).split(",").map((e=>XQ(e,t))).filter((e=>e!==YQ)),e),i=n.length;if(!i)return YQ;if(1===i)return n[0];const r=function(t,i){for(let r=0,o=n.length;r<o;r++)if(n[r](t,i))return e;return null},o=n.find((e=>!!e.allBasenames));o&&(r.allBasenames=o.allBasenames);const s=n.reduce(((e,t)=>t.allPaths?e.concat(t.allPaths):e),[]);s.length&&(r.allPaths=s);return r}(n,t):(r=GQ.exec(QQ(n,t)))?JQ(r[1].substr(1),n,!0):(r=KQ.exec(QQ(n,t)))?JQ(r[1],n,!1):function(e){try{const t=new RegExp(`^${zQ(e)}$`);return function(n){return t.lastIndex=0,"string"==typeof n&&t.test(n)?e:null}}catch(t){return YQ}}(n);return qQ.set(i,o),ZQ(o,e)}function ZQ(e,t){return"string"==typeof t?e:function(n,i){return function(e,t,n,i=dK){if(e===t)return!0;if(!e||!t)return!1;if(t.length>e.length)return!1;if(n){if(!SX(e,t))return!1;if(t.length===e.length)return!0;let n=t.length;return t.charAt(t.length-1)===i&&n--,e.charAt(n)===i}return t.charAt(t.length-1)!==i&&(t+=i),0===e.indexOf(t)}(n,t.base)?e(lK(t.base,n),i):null}}function QQ(e,t){return t.trimForExclusions&&e.endsWith("/**")?e.substr(0,e.length-2):e}function JQ(e,t,n){const i=dK===oK.sep,r=i?e:e.replace(FQ,dK),o=dK+r,s=oK.sep+e,a=n?function(n,a){return"string"!=typeof n||n!==r&&!n.endsWith(o)&&(i||n!==e&&!n.endsWith(s))?null:t}:function(n,o){return"string"!=typeof n||n!==r&&(i||n!==e)?null:t};return a.allPaths=[(n?"*/":"./")+e],a}function eJ(e,t,n){return!(!e||"string"!=typeof t)&&function(e,t={}){if(!e)return $Q;if("string"==typeof e||function(e){const t=e;return t&&"string"==typeof t.base&&"string"==typeof t.pattern}(e)){const n=XQ(e,t);if(n===YQ)return $Q;const i=function(e,t){return!!n(e,t)};return n.allBasenames&&(i.allBasenames=n.allBasenames),n.allPaths&&(i.allPaths=n.allPaths),i}return function(e,t){const n=tJ(Object.getOwnPropertyNames(e).map((n=>function(e,t,n){if(!1===t)return YQ;const i=XQ(e,n);if(i===YQ)return YQ;if("boolean"==typeof t)return i;if(t){const n=t.when;if("string"==typeof n){const t=(t,r,o,s)=>{if(!s||!i(t,r))return null;const a=s(n.replace("$(basename)",o));return function(e){return!!e&&"function"==typeof e.then}(a)?a.then((t=>t?e:null)):a?e:null};return t.requiresSiblings=!0,t}}return i}(n,e[n],t))).filter((e=>e!==YQ))),i=n.length;if(!i)return YQ;if(!n.some((e=>!!e.requiresSiblings))){if(1===i)return n[0];const e=function(e,t){for(let i=0,r=n.length;i<r;i++){const r=n[i](e,t);if(r)return r}return null},t=n.find((e=>!!e.allBasenames));t&&(e.allBasenames=t.allBasenames);const r=n.reduce(((e,t)=>t.allPaths?e.concat(t.allPaths):e),[]);return r.length&&(e.allPaths=r),e}const r=function(e,t,i){let r;for(let o=0,s=n.length;o<s;o++){const s=n[o];s.requiresSiblings&&i&&(t||(t=uK(e)),r||(r=t.substr(0,t.length-hK(e).length)));const a=s(e,t,r,i);if(a)return a}return null},o=n.find((e=>!!e.allBasenames));o&&(r.allBasenames=o.allBasenames);const s=n.reduce(((e,t)=>t.allPaths?e.concat(t.allPaths):e),[]);s.length&&(r.allPaths=s);return r}(e,t)}(e)(t,void 0,n)}function tJ(e,t){const n=e.filter((e=>!!e.basenames));if(n.length<2)return e;const i=n.reduce(((e,t)=>{const n=t.basenames;return n?e.concat(n):e}),[]);let r;if(t){r=[];for(let e=0,n=i.length;e<n;e++)r.push(t)}else r=n.reduce(((e,t)=>{const n=t.patterns;return n?e.concat(n):e}),[]);const o=function(e,t){if("string"!=typeof e)return null;if(!t){let n;for(n=e.length;n>0;n--){const t=e.charCodeAt(n-1);if(47===t||92===t)break}t=e.substr(n)}const n=i.indexOf(t);return-1!==n?r[n]:null};o.basenames=i,o.patterns=r,o.allBasenames=i;const s=e.filter((e=>!e.basenames));return s.push(o),s}function nJ(e,t,n,i){if(Array.isArray(e)){let r=0;for(const o of e){const e=nJ(o,t,n,i);if(10===e)return e;e>r&&(r=e)}return r}if("string"==typeof e)return i?"*"===e?5:e===n?10:0:0;if(e){const{language:r,pattern:o,scheme:s,hasAccessToAllModels:a}=e;if(!i&&!a)return 0;let l=0;if(s)if(s===t.scheme)l=10;else{if("*"!==s)return 0;l=5}if(r)if(r===n)l=10;else{if("*"!==r)return 0;l=Math.max(l,5)}if(o){let e;if(e="string"==typeof o?o:Object.assign(Object.assign({},o),{base:sK(o.base)}),e!==t.fsPath&&!eJ(e,t.fsPath))return 0;l=10}return l}return 0}const iJ=i$("modelService");function rJ(e){return!e.isTooLargeForSyncing()&&!e.isForSimpleWidget}function oJ(e){return"string"!=typeof e&&(Array.isArray(e)?e.every(oJ):!!e.exclusive)}class sJ{constructor(){this._clock=0,this._entries=[],this._onDidChange=new EG}get onDidChange(){return this._onDidChange.event}register(e,t){let n={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(n),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),gG((()=>{if(n){let e=this._entries.indexOf(n);e>=0&&(this._entries.splice(e,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),n=void 0)}}))}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e);const t=[];for(let n of this._entries)n._score>0&&t.push(n.provider);return t}ordered(e){const t=[];return this._orderedForEach(e,(e=>t.push(e.provider))),t}orderedGroups(e){const t=[];let n,i;return this._orderedForEach(e,(e=>{n&&i===e._score?n.push(e.provider):(i=e._score,n=[e.provider],t.push(n))})),t}_orderedForEach(e,t){if(e){this._updateScores(e);for(const e of this._entries)e._score>0&&t(e)}}_updateScores(e){let t={uri:e.uri.toString(),language:e.getLanguageIdentifier().language};if(!this._lastCandidate||this._lastCandidate.language!==t.language||this._lastCandidate.uri!==t.uri){this._lastCandidate=t;for(let t of this._entries)if(t._score=nJ(t.selector,e.uri,e.getLanguageIdentifier().language,rJ(e)),oJ(t.selector)&&t._score>0){for(let e of this._entries)e._score=0;t._score=1e3;break}this._entries.sort(sJ._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:e._time<t._time?1:e._time>t._time?-1:0}}class aJ{constructor(e,t,n=Number.MAX_SAFE_INTEGER){this._registry=e,this.min=t,this.max=n,this._cache=new sZ(50,.7)}_key(e){return e.id+LQ(this._registry.all(e))}_clamp(e){return void 0===e?this.min:Math.min(this.max,Math.max(this.min,Math.floor(1.3*e)))}get(e){const t=this._key(e),n=this._cache.get(t);return this._clamp(null==n?void 0:n.value)}update(e,t){const n=this._key(e);let i=this._cache.get(n);return i||(i=new PQ,this._cache.set(n,i)),i.update(t),this.get(e)}}const lJ=new class{constructor(){this._icons=new Map,this._onDidRegister=new EG}add(e){const t=this._icons.get(e.id);t?e.description?t.description=e.description:console.error(`Duplicate registration of codicon ${e.id}`):(this._icons.set(e.id,e),this._onDidRegister.fire(e))}get(e){return this._icons.get(e)}get all(){return this._icons.values()}get onDidRegister(){return this._onDidRegister.event}},cJ=lJ;function uJ(e,t){return new hJ(e,t)}class hJ{constructor(e,t,n){this.id=e,this.definition=t,this.description=n,lJ.add(this)}get classNames(){return"codicon codicon-"+this.id}get classNamesArray(){return["codicon","codicon-"+this.id]}get cssSelector(){return".codicon.codicon-"+this.id}}var dJ,fJ;!function(e){e.iconNameSegment="[A-Za-z0-9]+",e.iconNameExpression="[A-Za-z0-9\\-]+",e.iconModifierExpression="~[A-Za-z]+";const t=new RegExp(`^(${e.iconNameExpression})(${e.iconModifierExpression})?$`);function n(e){if(e instanceof hJ)return["codicon","codicon-"+e.id];const i=t.exec(e.id);if(!i)return n(hJ.error);let[,r,o]=i;const s=["codicon","codicon-"+r];return o&&s.push("codicon-modifier-"+o.substr(1)),s}e.asClassNameArray=n,e.asClassName=function(e){return n(e).join(" ")},e.asCSSSelector=function(e){return"."+n(e).join(".")}}(dJ||(dJ={})),(fJ=hJ||(hJ={})).add=new fJ("add",{fontCharacter:"\\ea60"}),fJ.plus=new fJ("plus",{fontCharacter:"\\ea60"}),fJ.gistNew=new fJ("gist-new",{fontCharacter:"\\ea60"}),fJ.repoCreate=new fJ("repo-create",{fontCharacter:"\\ea60"}),fJ.lightbulb=new fJ("lightbulb",{fontCharacter:"\\ea61"}),fJ.lightBulb=new fJ("light-bulb",{fontCharacter:"\\ea61"}),fJ.repo=new fJ("repo",{fontCharacter:"\\ea62"}),fJ.repoDelete=new fJ("repo-delete",{fontCharacter:"\\ea62"}),fJ.gistFork=new fJ("gist-fork",{fontCharacter:"\\ea63"}),fJ.repoForked=new fJ("repo-forked",{fontCharacter:"\\ea63"}),fJ.gitPullRequest=new fJ("git-pull-request",{fontCharacter:"\\ea64"}),fJ.gitPullRequestAbandoned=new fJ("git-pull-request-abandoned",{fontCharacter:"\\ea64"}),fJ.recordKeys=new fJ("record-keys",{fontCharacter:"\\ea65"}),fJ.keyboard=new fJ("keyboard",{fontCharacter:"\\ea65"}),fJ.tag=new fJ("tag",{fontCharacter:"\\ea66"}),fJ.tagAdd=new fJ("tag-add",{fontCharacter:"\\ea66"}),fJ.tagRemove=new fJ("tag-remove",{fontCharacter:"\\ea66"}),fJ.person=new fJ("person",{fontCharacter:"\\ea67"}),fJ.personFollow=new fJ("person-follow",{fontCharacter:"\\ea67"}),fJ.personOutline=new fJ("person-outline",{fontCharacter:"\\ea67"}),fJ.personFilled=new fJ("person-filled",{fontCharacter:"\\ea67"}),fJ.gitBranch=new fJ("git-branch",{fontCharacter:"\\ea68"}),fJ.gitBranchCreate=new fJ("git-branch-create",{fontCharacter:"\\ea68"}),fJ.gitBranchDelete=new fJ("git-branch-delete",{fontCharacter:"\\ea68"}),fJ.sourceControl=new fJ("source-control",{fontCharacter:"\\ea68"}),fJ.mirror=new fJ("mirror",{fontCharacter:"\\ea69"}),fJ.mirrorPublic=new fJ("mirror-public",{fontCharacter:"\\ea69"}),fJ.star=new fJ("star",{fontCharacter:"\\ea6a"}),fJ.starAdd=new fJ("star-add",{fontCharacter:"\\ea6a"}),fJ.starDelete=new fJ("star-delete",{fontCharacter:"\\ea6a"}),fJ.starEmpty=new fJ("star-empty",{fontCharacter:"\\ea6a"}),fJ.comment=new fJ("comment",{fontCharacter:"\\ea6b"}),fJ.commentAdd=new fJ("comment-add",{fontCharacter:"\\ea6b"}),fJ.alert=new fJ("alert",{fontCharacter:"\\ea6c"}),fJ.warning=new fJ("warning",{fontCharacter:"\\ea6c"}),fJ.search=new fJ("search",{fontCharacter:"\\ea6d"}),fJ.searchSave=new fJ("search-save",{fontCharacter:"\\ea6d"}),fJ.logOut=new fJ("log-out",{fontCharacter:"\\ea6e"}),fJ.signOut=new fJ("sign-out",{fontCharacter:"\\ea6e"}),fJ.logIn=new fJ("log-in",{fontCharacter:"\\ea6f"}),fJ.signIn=new fJ("sign-in",{fontCharacter:"\\ea6f"}),fJ.eye=new fJ("eye",{fontCharacter:"\\ea70"}),fJ.eyeUnwatch=new fJ("eye-unwatch",{fontCharacter:"\\ea70"}),fJ.eyeWatch=new fJ("eye-watch",{fontCharacter:"\\ea70"}),fJ.circleFilled=new fJ("circle-filled",{fontCharacter:"\\ea71"}),fJ.primitiveDot=new fJ("primitive-dot",{fontCharacter:"\\ea71"}),fJ.closeDirty=new fJ("close-dirty",{fontCharacter:"\\ea71"}),fJ.debugBreakpoint=new fJ("debug-breakpoint",{fontCharacter:"\\ea71"}),fJ.debugBreakpointDisabled=new fJ("debug-breakpoint-disabled",{fontCharacter:"\\ea71"}),fJ.debugHint=new fJ("debug-hint",{fontCharacter:"\\ea71"}),fJ.primitiveSquare=new fJ("primitive-square",{fontCharacter:"\\ea72"}),fJ.edit=new fJ("edit",{fontCharacter:"\\ea73"}),fJ.pencil=new fJ("pencil",{fontCharacter:"\\ea73"}),fJ.info=new fJ("info",{fontCharacter:"\\ea74"}),fJ.issueOpened=new fJ("issue-opened",{fontCharacter:"\\ea74"}),fJ.gistPrivate=new fJ("gist-private",{fontCharacter:"\\ea75"}),fJ.gitForkPrivate=new fJ("git-fork-private",{fontCharacter:"\\ea75"}),fJ.lock=new fJ("lock",{fontCharacter:"\\ea75"}),fJ.mirrorPrivate=new fJ("mirror-private",{fontCharacter:"\\ea75"}),fJ.close=new fJ("close",{fontCharacter:"\\ea76"}),fJ.removeClose=new fJ("remove-close",{fontCharacter:"\\ea76"}),fJ.x=new fJ("x",{fontCharacter:"\\ea76"}),fJ.repoSync=new fJ("repo-sync",{fontCharacter:"\\ea77"}),fJ.sync=new fJ("sync",{fontCharacter:"\\ea77"}),fJ.clone=new fJ("clone",{fontCharacter:"\\ea78"}),fJ.desktopDownload=new fJ("desktop-download",{fontCharacter:"\\ea78"}),fJ.beaker=new fJ("beaker",{fontCharacter:"\\ea79"}),fJ.microscope=new fJ("microscope",{fontCharacter:"\\ea79"}),fJ.vm=new fJ("vm",{fontCharacter:"\\ea7a"}),fJ.deviceDesktop=new fJ("device-desktop",{fontCharacter:"\\ea7a"}),fJ.file=new fJ("file",{fontCharacter:"\\ea7b"}),fJ.fileText=new fJ("file-text",{fontCharacter:"\\ea7b"}),fJ.more=new fJ("more",{fontCharacter:"\\ea7c"}),fJ.ellipsis=new fJ("ellipsis",{fontCharacter:"\\ea7c"}),fJ.kebabHorizontal=new fJ("kebab-horizontal",{fontCharacter:"\\ea7c"}),fJ.mailReply=new fJ("mail-reply",{fontCharacter:"\\ea7d"}),fJ.reply=new fJ("reply",{fontCharacter:"\\ea7d"}),fJ.organization=new fJ("organization",{fontCharacter:"\\ea7e"}),fJ.organizationFilled=new fJ("organization-filled",{fontCharacter:"\\ea7e"}),fJ.organizationOutline=new fJ("organization-outline",{fontCharacter:"\\ea7e"}),fJ.newFile=new fJ("new-file",{fontCharacter:"\\ea7f"}),fJ.fileAdd=new fJ("file-add",{fontCharacter:"\\ea7f"}),fJ.newFolder=new fJ("new-folder",{fontCharacter:"\\ea80"}),fJ.fileDirectoryCreate=new fJ("file-directory-create",{fontCharacter:"\\ea80"}),fJ.trash=new fJ("trash",{fontCharacter:"\\ea81"}),fJ.trashcan=new fJ("trashcan",{fontCharacter:"\\ea81"}),fJ.history=new fJ("history",{fontCharacter:"\\ea82"}),fJ.clock=new fJ("clock",{fontCharacter:"\\ea82"}),fJ.folder=new fJ("folder",{fontCharacter:"\\ea83"}),fJ.fileDirectory=new fJ("file-directory",{fontCharacter:"\\ea83"}),fJ.symbolFolder=new fJ("symbol-folder",{fontCharacter:"\\ea83"}),fJ.logoGithub=new fJ("logo-github",{fontCharacter:"\\ea84"}),fJ.markGithub=new fJ("mark-github",{fontCharacter:"\\ea84"}),fJ.github=new fJ("github",{fontCharacter:"\\ea84"}),fJ.terminal=new fJ("terminal",{fontCharacter:"\\ea85"}),fJ.console=new fJ("console",{fontCharacter:"\\ea85"}),fJ.repl=new fJ("repl",{fontCharacter:"\\ea85"}),fJ.zap=new fJ("zap",{fontCharacter:"\\ea86"}),fJ.symbolEvent=new fJ("symbol-event",{fontCharacter:"\\ea86"}),fJ.error=new fJ("error",{fontCharacter:"\\ea87"}),fJ.stop=new fJ("stop",{fontCharacter:"\\ea87"}),fJ.variable=new fJ("variable",{fontCharacter:"\\ea88"}),fJ.symbolVariable=new fJ("symbol-variable",{fontCharacter:"\\ea88"}),fJ.array=new fJ("array",{fontCharacter:"\\ea8a"}),fJ.symbolArray=new fJ("symbol-array",{fontCharacter:"\\ea8a"}),fJ.symbolModule=new fJ("symbol-module",{fontCharacter:"\\ea8b"}),fJ.symbolPackage=new fJ("symbol-package",{fontCharacter:"\\ea8b"}),fJ.symbolNamespace=new fJ("symbol-namespace",{fontCharacter:"\\ea8b"}),fJ.symbolObject=new fJ("symbol-object",{fontCharacter:"\\ea8b"}),fJ.symbolMethod=new fJ("symbol-method",{fontCharacter:"\\ea8c"}),fJ.symbolFunction=new fJ("symbol-function",{fontCharacter:"\\ea8c"}),fJ.symbolConstructor=new fJ("symbol-constructor",{fontCharacter:"\\ea8c"}),fJ.symbolBoolean=new fJ("symbol-boolean",{fontCharacter:"\\ea8f"}),fJ.symbolNull=new fJ("symbol-null",{fontCharacter:"\\ea8f"}),fJ.symbolNumeric=new fJ("symbol-numeric",{fontCharacter:"\\ea90"}),fJ.symbolNumber=new fJ("symbol-number",{fontCharacter:"\\ea90"}),fJ.symbolStructure=new fJ("symbol-structure",{fontCharacter:"\\ea91"}),fJ.symbolStruct=new fJ("symbol-struct",{fontCharacter:"\\ea91"}),fJ.symbolParameter=new fJ("symbol-parameter",{fontCharacter:"\\ea92"}),fJ.symbolTypeParameter=new fJ("symbol-type-parameter",{fontCharacter:"\\ea92"}),fJ.symbolKey=new fJ("symbol-key",{fontCharacter:"\\ea93"}),fJ.symbolText=new fJ("symbol-text",{fontCharacter:"\\ea93"}),fJ.symbolReference=new fJ("symbol-reference",{fontCharacter:"\\ea94"}),fJ.goToFile=new fJ("go-to-file",{fontCharacter:"\\ea94"}),fJ.symbolEnum=new fJ("symbol-enum",{fontCharacter:"\\ea95"}),fJ.symbolValue=new fJ("symbol-value",{fontCharacter:"\\ea95"}),fJ.symbolRuler=new fJ("symbol-ruler",{fontCharacter:"\\ea96"}),fJ.symbolUnit=new fJ("symbol-unit",{fontCharacter:"\\ea96"}),fJ.activateBreakpoints=new fJ("activate-breakpoints",{fontCharacter:"\\ea97"}),fJ.archive=new fJ("archive",{fontCharacter:"\\ea98"}),fJ.arrowBoth=new fJ("arrow-both",{fontCharacter:"\\ea99"}),fJ.arrowDown=new fJ("arrow-down",{fontCharacter:"\\ea9a"}),fJ.arrowLeft=new fJ("arrow-left",{fontCharacter:"\\ea9b"}),fJ.arrowRight=new fJ("arrow-right",{fontCharacter:"\\ea9c"}),fJ.arrowSmallDown=new fJ("arrow-small-down",{fontCharacter:"\\ea9d"}),fJ.arrowSmallLeft=new fJ("arrow-small-left",{fontCharacter:"\\ea9e"}),fJ.arrowSmallRight=new fJ("arrow-small-right",{fontCharacter:"\\ea9f"}),fJ.arrowSmallUp=new fJ("arrow-small-up",{fontCharacter:"\\eaa0"}),fJ.arrowUp=new fJ("arrow-up",{fontCharacter:"\\eaa1"}),fJ.bell=new fJ("bell",{fontCharacter:"\\eaa2"}),fJ.bold=new fJ("bold",{fontCharacter:"\\eaa3"}),fJ.book=new fJ("book",{fontCharacter:"\\eaa4"}),fJ.bookmark=new fJ("bookmark",{fontCharacter:"\\eaa5"}),fJ.debugBreakpointConditionalUnverified=new fJ("debug-breakpoint-conditional-unverified",{fontCharacter:"\\eaa6"}),fJ.debugBreakpointConditional=new fJ("debug-breakpoint-conditional",{fontCharacter:"\\eaa7"}),fJ.debugBreakpointConditionalDisabled=new fJ("debug-breakpoint-conditional-disabled",{fontCharacter:"\\eaa7"}),fJ.debugBreakpointDataUnverified=new fJ("debug-breakpoint-data-unverified",{fontCharacter:"\\eaa8"}),fJ.debugBreakpointData=new fJ("debug-breakpoint-data",{fontCharacter:"\\eaa9"}),fJ.debugBreakpointDataDisabled=new fJ("debug-breakpoint-data-disabled",{fontCharacter:"\\eaa9"}),fJ.debugBreakpointLogUnverified=new fJ("debug-breakpoint-log-unverified",{fontCharacter:"\\eaaa"}),fJ.debugBreakpointLog=new fJ("debug-breakpoint-log",{fontCharacter:"\\eaab"}),fJ.debugBreakpointLogDisabled=new fJ("debug-breakpoint-log-disabled",{fontCharacter:"\\eaab"}),fJ.briefcase=new fJ("briefcase",{fontCharacter:"\\eaac"}),fJ.broadcast=new fJ("broadcast",{fontCharacter:"\\eaad"}),fJ.browser=new fJ("browser",{fontCharacter:"\\eaae"}),fJ.bug=new fJ("bug",{fontCharacter:"\\eaaf"}),fJ.calendar=new fJ("calendar",{fontCharacter:"\\eab0"}),fJ.caseSensitive=new fJ("case-sensitive",{fontCharacter:"\\eab1"}),fJ.check=new fJ("check",{fontCharacter:"\\eab2"}),fJ.checklist=new fJ("checklist",{fontCharacter:"\\eab3"}),fJ.chevronDown=new fJ("chevron-down",{fontCharacter:"\\eab4"}),fJ.chevronLeft=new fJ("chevron-left",{fontCharacter:"\\eab5"}),fJ.chevronRight=new fJ("chevron-right",{fontCharacter:"\\eab6"}),fJ.chevronUp=new fJ("chevron-up",{fontCharacter:"\\eab7"}),fJ.chromeClose=new fJ("chrome-close",{fontCharacter:"\\eab8"}),fJ.chromeMaximize=new fJ("chrome-maximize",{fontCharacter:"\\eab9"}),fJ.chromeMinimize=new fJ("chrome-minimize",{fontCharacter:"\\eaba"}),fJ.chromeRestore=new fJ("chrome-restore",{fontCharacter:"\\eabb"}),fJ.circleOutline=new fJ("circle-outline",{fontCharacter:"\\eabc"}),fJ.debugBreakpointUnverified=new fJ("debug-breakpoint-unverified",{fontCharacter:"\\eabc"}),fJ.circleSlash=new fJ("circle-slash",{fontCharacter:"\\eabd"}),fJ.circuitBoard=new fJ("circuit-board",{fontCharacter:"\\eabe"}),fJ.clearAll=new fJ("clear-all",{fontCharacter:"\\eabf"}),fJ.clippy=new fJ("clippy",{fontCharacter:"\\eac0"}),fJ.closeAll=new fJ("close-all",{fontCharacter:"\\eac1"}),fJ.cloudDownload=new fJ("cloud-download",{fontCharacter:"\\eac2"}),fJ.cloudUpload=new fJ("cloud-upload",{fontCharacter:"\\eac3"}),fJ.code=new fJ("code",{fontCharacter:"\\eac4"}),fJ.collapseAll=new fJ("collapse-all",{fontCharacter:"\\eac5"}),fJ.colorMode=new fJ("color-mode",{fontCharacter:"\\eac6"}),fJ.commentDiscussion=new fJ("comment-discussion",{fontCharacter:"\\eac7"}),fJ.compareChanges=new fJ("compare-changes",{fontCharacter:"\\eafd"}),fJ.creditCard=new fJ("credit-card",{fontCharacter:"\\eac9"}),fJ.dash=new fJ("dash",{fontCharacter:"\\eacc"}),fJ.dashboard=new fJ("dashboard",{fontCharacter:"\\eacd"}),fJ.database=new fJ("database",{fontCharacter:"\\eace"}),fJ.debugContinue=new fJ("debug-continue",{fontCharacter:"\\eacf"}),fJ.debugDisconnect=new fJ("debug-disconnect",{fontCharacter:"\\ead0"}),fJ.debugPause=new fJ("debug-pause",{fontCharacter:"\\ead1"}),fJ.debugRestart=new fJ("debug-restart",{fontCharacter:"\\ead2"}),fJ.debugStart=new fJ("debug-start",{fontCharacter:"\\ead3"}),fJ.debugStepInto=new fJ("debug-step-into",{fontCharacter:"\\ead4"}),fJ.debugStepOut=new fJ("debug-step-out",{fontCharacter:"\\ead5"}),fJ.debugStepOver=new fJ("debug-step-over",{fontCharacter:"\\ead6"}),fJ.debugStop=new fJ("debug-stop",{fontCharacter:"\\ead7"}),fJ.debug=new fJ("debug",{fontCharacter:"\\ead8"}),fJ.deviceCameraVideo=new fJ("device-camera-video",{fontCharacter:"\\ead9"}),fJ.deviceCamera=new fJ("device-camera",{fontCharacter:"\\eada"}),fJ.deviceMobile=new fJ("device-mobile",{fontCharacter:"\\eadb"}),fJ.diffAdded=new fJ("diff-added",{fontCharacter:"\\eadc"}),fJ.diffIgnored=new fJ("diff-ignored",{fontCharacter:"\\eadd"}),fJ.diffModified=new fJ("diff-modified",{fontCharacter:"\\eade"}),fJ.diffRemoved=new fJ("diff-removed",{fontCharacter:"\\eadf"}),fJ.diffRenamed=new fJ("diff-renamed",{fontCharacter:"\\eae0"}),fJ.diff=new fJ("diff",{fontCharacter:"\\eae1"}),fJ.discard=new fJ("discard",{fontCharacter:"\\eae2"}),fJ.editorLayout=new fJ("editor-layout",{fontCharacter:"\\eae3"}),fJ.emptyWindow=new fJ("empty-window",{fontCharacter:"\\eae4"}),fJ.exclude=new fJ("exclude",{fontCharacter:"\\eae5"}),fJ.extensions=new fJ("extensions",{fontCharacter:"\\eae6"}),fJ.eyeClosed=new fJ("eye-closed",{fontCharacter:"\\eae7"}),fJ.fileBinary=new fJ("file-binary",{fontCharacter:"\\eae8"}),fJ.fileCode=new fJ("file-code",{fontCharacter:"\\eae9"}),fJ.fileMedia=new fJ("file-media",{fontCharacter:"\\eaea"}),fJ.filePdf=new fJ("file-pdf",{fontCharacter:"\\eaeb"}),fJ.fileSubmodule=new fJ("file-submodule",{fontCharacter:"\\eaec"}),fJ.fileSymlinkDirectory=new fJ("file-symlink-directory",{fontCharacter:"\\eaed"}),fJ.fileSymlinkFile=new fJ("file-symlink-file",{fontCharacter:"\\eaee"}),fJ.fileZip=new fJ("file-zip",{fontCharacter:"\\eaef"}),fJ.files=new fJ("files",{fontCharacter:"\\eaf0"}),fJ.filter=new fJ("filter",{fontCharacter:"\\eaf1"}),fJ.flame=new fJ("flame",{fontCharacter:"\\eaf2"}),fJ.foldDown=new fJ("fold-down",{fontCharacter:"\\eaf3"}),fJ.foldUp=new fJ("fold-up",{fontCharacter:"\\eaf4"}),fJ.fold=new fJ("fold",{fontCharacter:"\\eaf5"}),fJ.folderActive=new fJ("folder-active",{fontCharacter:"\\eaf6"}),fJ.folderOpened=new fJ("folder-opened",{fontCharacter:"\\eaf7"}),fJ.gear=new fJ("gear",{fontCharacter:"\\eaf8"}),fJ.gift=new fJ("gift",{fontCharacter:"\\eaf9"}),fJ.gistSecret=new fJ("gist-secret",{fontCharacter:"\\eafa"}),fJ.gist=new fJ("gist",{fontCharacter:"\\eafb"}),fJ.gitCommit=new fJ("git-commit",{fontCharacter:"\\eafc"}),fJ.gitCompare=new fJ("git-compare",{fontCharacter:"\\eafd"}),fJ.gitMerge=new fJ("git-merge",{fontCharacter:"\\eafe"}),fJ.githubAction=new fJ("github-action",{fontCharacter:"\\eaff"}),fJ.githubAlt=new fJ("github-alt",{fontCharacter:"\\eb00"}),fJ.globe=new fJ("globe",{fontCharacter:"\\eb01"}),fJ.grabber=new fJ("grabber",{fontCharacter:"\\eb02"}),fJ.graph=new fJ("graph",{fontCharacter:"\\eb03"}),fJ.gripper=new fJ("gripper",{fontCharacter:"\\eb04"}),fJ.heart=new fJ("heart",{fontCharacter:"\\eb05"}),fJ.home=new fJ("home",{fontCharacter:"\\eb06"}),fJ.horizontalRule=new fJ("horizontal-rule",{fontCharacter:"\\eb07"}),fJ.hubot=new fJ("hubot",{fontCharacter:"\\eb08"}),fJ.inbox=new fJ("inbox",{fontCharacter:"\\eb09"}),fJ.issueClosed=new fJ("issue-closed",{fontCharacter:"\\eb0a"}),fJ.issueReopened=new fJ("issue-reopened",{fontCharacter:"\\eb0b"}),fJ.issues=new fJ("issues",{fontCharacter:"\\eb0c"}),fJ.italic=new fJ("italic",{fontCharacter:"\\eb0d"}),fJ.jersey=new fJ("jersey",{fontCharacter:"\\eb0e"}),fJ.json=new fJ("json",{fontCharacter:"\\eb0f"}),fJ.kebabVertical=new fJ("kebab-vertical",{fontCharacter:"\\eb10"}),fJ.key=new fJ("key",{fontCharacter:"\\eb11"}),fJ.law=new fJ("law",{fontCharacter:"\\eb12"}),fJ.lightbulbAutofix=new fJ("lightbulb-autofix",{fontCharacter:"\\eb13"}),fJ.linkExternal=new fJ("link-external",{fontCharacter:"\\eb14"}),fJ.link=new fJ("link",{fontCharacter:"\\eb15"}),fJ.listOrdered=new fJ("list-ordered",{fontCharacter:"\\eb16"}),fJ.listUnordered=new fJ("list-unordered",{fontCharacter:"\\eb17"}),fJ.liveShare=new fJ("live-share",{fontCharacter:"\\eb18"}),fJ.loading=new fJ("loading",{fontCharacter:"\\eb19"}),fJ.location=new fJ("location",{fontCharacter:"\\eb1a"}),fJ.mailRead=new fJ("mail-read",{fontCharacter:"\\eb1b"}),fJ.mail=new fJ("mail",{fontCharacter:"\\eb1c"}),fJ.markdown=new fJ("markdown",{fontCharacter:"\\eb1d"}),fJ.megaphone=new fJ("megaphone",{fontCharacter:"\\eb1e"}),fJ.mention=new fJ("mention",{fontCharacter:"\\eb1f"}),fJ.milestone=new fJ("milestone",{fontCharacter:"\\eb20"}),fJ.mortarBoard=new fJ("mortar-board",{fontCharacter:"\\eb21"}),fJ.move=new fJ("move",{fontCharacter:"\\eb22"}),fJ.multipleWindows=new fJ("multiple-windows",{fontCharacter:"\\eb23"}),fJ.mute=new fJ("mute",{fontCharacter:"\\eb24"}),fJ.noNewline=new fJ("no-newline",{fontCharacter:"\\eb25"}),fJ.note=new fJ("note",{fontCharacter:"\\eb26"}),fJ.octoface=new fJ("octoface",{fontCharacter:"\\eb27"}),fJ.openPreview=new fJ("open-preview",{fontCharacter:"\\eb28"}),fJ.package_=new fJ("package",{fontCharacter:"\\eb29"}),fJ.paintcan=new fJ("paintcan",{fontCharacter:"\\eb2a"}),fJ.pin=new fJ("pin",{fontCharacter:"\\eb2b"}),fJ.play=new fJ("play",{fontCharacter:"\\eb2c"}),fJ.run=new fJ("run",{fontCharacter:"\\eb2c"}),fJ.plug=new fJ("plug",{fontCharacter:"\\eb2d"}),fJ.preserveCase=new fJ("preserve-case",{fontCharacter:"\\eb2e"}),fJ.preview=new fJ("preview",{fontCharacter:"\\eb2f"}),fJ.project=new fJ("project",{fontCharacter:"\\eb30"}),fJ.pulse=new fJ("pulse",{fontCharacter:"\\eb31"}),fJ.question=new fJ("question",{fontCharacter:"\\eb32"}),fJ.quote=new fJ("quote",{fontCharacter:"\\eb33"}),fJ.radioTower=new fJ("radio-tower",{fontCharacter:"\\eb34"}),fJ.reactions=new fJ("reactions",{fontCharacter:"\\eb35"}),fJ.references=new fJ("references",{fontCharacter:"\\eb36"}),fJ.refresh=new fJ("refresh",{fontCharacter:"\\eb37"}),fJ.regex=new fJ("regex",{fontCharacter:"\\eb38"}),fJ.remoteExplorer=new fJ("remote-explorer",{fontCharacter:"\\eb39"}),fJ.remote=new fJ("remote",{fontCharacter:"\\eb3a"}),fJ.remove=new fJ("remove",{fontCharacter:"\\eb3b"}),fJ.replaceAll=new fJ("replace-all",{fontCharacter:"\\eb3c"}),fJ.replace=new fJ("replace",{fontCharacter:"\\eb3d"}),fJ.repoClone=new fJ("repo-clone",{fontCharacter:"\\eb3e"}),fJ.repoForcePush=new fJ("repo-force-push",{fontCharacter:"\\eb3f"}),fJ.repoPull=new fJ("repo-pull",{fontCharacter:"\\eb40"}),fJ.repoPush=new fJ("repo-push",{fontCharacter:"\\eb41"}),fJ.report=new fJ("report",{fontCharacter:"\\eb42"}),fJ.requestChanges=new fJ("request-changes",{fontCharacter:"\\eb43"}),fJ.rocket=new fJ("rocket",{fontCharacter:"\\eb44"}),fJ.rootFolderOpened=new fJ("root-folder-opened",{fontCharacter:"\\eb45"}),fJ.rootFolder=new fJ("root-folder",{fontCharacter:"\\eb46"}),fJ.rss=new fJ("rss",{fontCharacter:"\\eb47"}),fJ.ruby=new fJ("ruby",{fontCharacter:"\\eb48"}),fJ.saveAll=new fJ("save-all",{fontCharacter:"\\eb49"}),fJ.saveAs=new fJ("save-as",{fontCharacter:"\\eb4a"}),fJ.save=new fJ("save",{fontCharacter:"\\eb4b"}),fJ.screenFull=new fJ("screen-full",{fontCharacter:"\\eb4c"}),fJ.screenNormal=new fJ("screen-normal",{fontCharacter:"\\eb4d"}),fJ.searchStop=new fJ("search-stop",{fontCharacter:"\\eb4e"}),fJ.server=new fJ("server",{fontCharacter:"\\eb50"}),fJ.settingsGear=new fJ("settings-gear",{fontCharacter:"\\eb51"}),fJ.settings=new fJ("settings",{fontCharacter:"\\eb52"}),fJ.shield=new fJ("shield",{fontCharacter:"\\eb53"}),fJ.smiley=new fJ("smiley",{fontCharacter:"\\eb54"}),fJ.sortPrecedence=new fJ("sort-precedence",{fontCharacter:"\\eb55"}),fJ.splitHorizontal=new fJ("split-horizontal",{fontCharacter:"\\eb56"}),fJ.splitVertical=new fJ("split-vertical",{fontCharacter:"\\eb57"}),fJ.squirrel=new fJ("squirrel",{fontCharacter:"\\eb58"}),fJ.starFull=new fJ("star-full",{fontCharacter:"\\eb59"}),fJ.starHalf=new fJ("star-half",{fontCharacter:"\\eb5a"}),fJ.symbolClass=new fJ("symbol-class",{fontCharacter:"\\eb5b"}),fJ.symbolColor=new fJ("symbol-color",{fontCharacter:"\\eb5c"}),fJ.symbolConstant=new fJ("symbol-constant",{fontCharacter:"\\eb5d"}),fJ.symbolEnumMember=new fJ("symbol-enum-member",{fontCharacter:"\\eb5e"}),fJ.symbolField=new fJ("symbol-field",{fontCharacter:"\\eb5f"}),fJ.symbolFile=new fJ("symbol-file",{fontCharacter:"\\eb60"}),fJ.symbolInterface=new fJ("symbol-interface",{fontCharacter:"\\eb61"}),fJ.symbolKeyword=new fJ("symbol-keyword",{fontCharacter:"\\eb62"}),fJ.symbolMisc=new fJ("symbol-misc",{fontCharacter:"\\eb63"}),fJ.symbolOperator=new fJ("symbol-operator",{fontCharacter:"\\eb64"}),fJ.symbolProperty=new fJ("symbol-property",{fontCharacter:"\\eb65"}),fJ.wrench=new fJ("wrench",{fontCharacter:"\\eb65"}),fJ.wrenchSubaction=new fJ("wrench-subaction",{fontCharacter:"\\eb65"}),fJ.symbolSnippet=new fJ("symbol-snippet",{fontCharacter:"\\eb66"}),fJ.tasklist=new fJ("tasklist",{fontCharacter:"\\eb67"}),fJ.telescope=new fJ("telescope",{fontCharacter:"\\eb68"}),fJ.textSize=new fJ("text-size",{fontCharacter:"\\eb69"}),fJ.threeBars=new fJ("three-bars",{fontCharacter:"\\eb6a"}),fJ.thumbsdown=new fJ("thumbsdown",{fontCharacter:"\\eb6b"}),fJ.thumbsup=new fJ("thumbsup",{fontCharacter:"\\eb6c"}),fJ.tools=new fJ("tools",{fontCharacter:"\\eb6d"}),fJ.triangleDown=new fJ("triangle-down",{fontCharacter:"\\eb6e"}),fJ.triangleLeft=new fJ("triangle-left",{fontCharacter:"\\eb6f"}),fJ.triangleRight=new fJ("triangle-right",{fontCharacter:"\\eb70"}),fJ.triangleUp=new fJ("triangle-up",{fontCharacter:"\\eb71"}),fJ.twitter=new fJ("twitter",{fontCharacter:"\\eb72"}),fJ.unfold=new fJ("unfold",{fontCharacter:"\\eb73"}),fJ.unlock=new fJ("unlock",{fontCharacter:"\\eb74"}),fJ.unmute=new fJ("unmute",{fontCharacter:"\\eb75"}),fJ.unverified=new fJ("unverified",{fontCharacter:"\\eb76"}),fJ.verified=new fJ("verified",{fontCharacter:"\\eb77"}),fJ.versions=new fJ("versions",{fontCharacter:"\\eb78"}),fJ.vmActive=new fJ("vm-active",{fontCharacter:"\\eb79"}),fJ.vmOutline=new fJ("vm-outline",{fontCharacter:"\\eb7a"}),fJ.vmRunning=new fJ("vm-running",{fontCharacter:"\\eb7b"}),fJ.watch=new fJ("watch",{fontCharacter:"\\eb7c"}),fJ.whitespace=new fJ("whitespace",{fontCharacter:"\\eb7d"}),fJ.wholeWord=new fJ("whole-word",{fontCharacter:"\\eb7e"}),fJ.window=new fJ("window",{fontCharacter:"\\eb7f"}),fJ.wordWrap=new fJ("word-wrap",{fontCharacter:"\\eb80"}),fJ.zoomIn=new fJ("zoom-in",{fontCharacter:"\\eb81"}),fJ.zoomOut=new fJ("zoom-out",{fontCharacter:"\\eb82"}),fJ.listFilter=new fJ("list-filter",{fontCharacter:"\\eb83"}),fJ.listFlat=new fJ("list-flat",{fontCharacter:"\\eb84"}),fJ.listSelection=new fJ("list-selection",{fontCharacter:"\\eb85"}),fJ.selection=new fJ("selection",{fontCharacter:"\\eb85"}),fJ.listTree=new fJ("list-tree",{fontCharacter:"\\eb86"}),fJ.debugBreakpointFunctionUnverified=new fJ("debug-breakpoint-function-unverified",{fontCharacter:"\\eb87"}),fJ.debugBreakpointFunction=new fJ("debug-breakpoint-function",{fontCharacter:"\\eb88"}),fJ.debugBreakpointFunctionDisabled=new fJ("debug-breakpoint-function-disabled",{fontCharacter:"\\eb88"}),fJ.debugStackframeActive=new fJ("debug-stackframe-active",{fontCharacter:"\\eb89"}),fJ.debugStackframeDot=new fJ("debug-stackframe-dot",{fontCharacter:"\\eb8a"}),fJ.debugStackframe=new fJ("debug-stackframe",{fontCharacter:"\\eb8b"}),fJ.debugStackframeFocused=new fJ("debug-stackframe-focused",{fontCharacter:"\\eb8b"}),fJ.debugBreakpointUnsupported=new fJ("debug-breakpoint-unsupported",{fontCharacter:"\\eb8c"}),fJ.symbolString=new fJ("symbol-string",{fontCharacter:"\\eb8d"}),fJ.debugReverseContinue=new fJ("debug-reverse-continue",{fontCharacter:"\\eb8e"}),fJ.debugStepBack=new fJ("debug-step-back",{fontCharacter:"\\eb8f"}),fJ.debugRestartFrame=new fJ("debug-restart-frame",{fontCharacter:"\\eb90"}),fJ.callIncoming=new fJ("call-incoming",{fontCharacter:"\\eb92"}),fJ.callOutgoing=new fJ("call-outgoing",{fontCharacter:"\\eb93"}),fJ.menu=new fJ("menu",{fontCharacter:"\\eb94"}),fJ.expandAll=new fJ("expand-all",{fontCharacter:"\\eb95"}),fJ.feedback=new fJ("feedback",{fontCharacter:"\\eb96"}),fJ.groupByRefType=new fJ("group-by-ref-type",{fontCharacter:"\\eb97"}),fJ.ungroupByRefType=new fJ("ungroup-by-ref-type",{fontCharacter:"\\eb98"}),fJ.account=new fJ("account",{fontCharacter:"\\eb99"}),fJ.bellDot=new fJ("bell-dot",{fontCharacter:"\\eb9a"}),fJ.debugConsole=new fJ("debug-console",{fontCharacter:"\\eb9b"}),fJ.library=new fJ("library",{fontCharacter:"\\eb9c"}),fJ.output=new fJ("output",{fontCharacter:"\\eb9d"}),fJ.runAll=new fJ("run-all",{fontCharacter:"\\eb9e"}),fJ.syncIgnored=new fJ("sync-ignored",{fontCharacter:"\\eb9f"}),fJ.pinned=new fJ("pinned",{fontCharacter:"\\eba0"}),fJ.githubInverted=new fJ("github-inverted",{fontCharacter:"\\eba1"}),fJ.debugAlt=new fJ("debug-alt",{fontCharacter:"\\eb91"}),fJ.serverProcess=new fJ("server-process",{fontCharacter:"\\eba2"}),fJ.serverEnvironment=new fJ("server-environment",{fontCharacter:"\\eba3"}),fJ.pass=new fJ("pass",{fontCharacter:"\\eba4"}),fJ.stopCircle=new fJ("stop-circle",{fontCharacter:"\\eba5"}),fJ.playCircle=new fJ("play-circle",{fontCharacter:"\\eba6"}),fJ.record=new fJ("record",{fontCharacter:"\\eba7"}),fJ.debugAltSmall=new fJ("debug-alt-small",{fontCharacter:"\\eba8"}),fJ.vmConnect=new fJ("vm-connect",{fontCharacter:"\\eba9"}),fJ.cloud=new fJ("cloud",{fontCharacter:"\\ebaa"}),fJ.merge=new fJ("merge",{fontCharacter:"\\ebab"}),fJ.exportIcon=new fJ("export",{fontCharacter:"\\ebac"}),fJ.graphLeft=new fJ("graph-left",{fontCharacter:"\\ebad"}),fJ.magnet=new fJ("magnet",{fontCharacter:"\\ebae"}),fJ.notebook=new fJ("notebook",{fontCharacter:"\\ebaf"}),fJ.redo=new fJ("redo",{fontCharacter:"\\ebb0"}),fJ.checkAll=new fJ("check-all",{fontCharacter:"\\ebb1"}),fJ.pinnedDirty=new fJ("pinned-dirty",{fontCharacter:"\\ebb2"}),fJ.passFilled=new fJ("pass-filled",{fontCharacter:"\\ebb3"}),fJ.circleLargeFilled=new fJ("circle-large-filled",{fontCharacter:"\\ebb4"}),fJ.circleLargeOutline=new fJ("circle-large-outline",{fontCharacter:"\\ebb5"}),fJ.combine=new fJ("combine",{fontCharacter:"\\ebb6"}),fJ.gather=new fJ("gather",{fontCharacter:"\\ebb6"}),fJ.table=new fJ("table",{fontCharacter:"\\ebb7"}),fJ.variableGroup=new fJ("variable-group",{fontCharacter:"\\ebb8"}),fJ.typeHierarchy=new fJ("type-hierarchy",{fontCharacter:"\\ebb9"}),fJ.typeHierarchySub=new fJ("type-hierarchy-sub",{fontCharacter:"\\ebba"}),fJ.typeHierarchySuper=new fJ("type-hierarchy-super",{fontCharacter:"\\ebbb"}),fJ.gitPullRequestCreate=new fJ("git-pull-request-create",{fontCharacter:"\\ebbc"}),fJ.runAbove=new fJ("run-above",{fontCharacter:"\\ebbd"}),fJ.runBelow=new fJ("run-below",{fontCharacter:"\\ebbe"}),fJ.notebookTemplate=new fJ("notebook-template",{fontCharacter:"\\ebbf"}),fJ.debugRerun=new fJ("debug-rerun",{fontCharacter:"\\ebc0"}),fJ.workspaceTrusted=new fJ("workspace-trusted",{fontCharacter:"\\ebc1"}),fJ.workspaceUntrusted=new fJ("workspace-untrusted",{fontCharacter:"\\ebc2"}),fJ.workspaceUnspecified=new fJ("workspace-unspecified",{fontCharacter:"\\ebc3"}),fJ.terminalCmd=new fJ("terminal-cmd",{fontCharacter:"\\ebc4"}),fJ.terminalDebian=new fJ("terminal-debian",{fontCharacter:"\\ebc5"}),fJ.terminalLinux=new fJ("terminal-linux",{fontCharacter:"\\ebc6"}),fJ.terminalPowershell=new fJ("terminal-powershell",{fontCharacter:"\\ebc7"}),fJ.terminalTmux=new fJ("terminal-tmux",{fontCharacter:"\\ebc8"}),fJ.terminalUbuntu=new fJ("terminal-ubuntu",{fontCharacter:"\\ebc9"}),fJ.terminalBash=new fJ("terminal-bash",{fontCharacter:"\\ebca"}),fJ.arrowSwap=new fJ("arrow-swap",{fontCharacter:"\\ebcb"}),fJ.copy=new fJ("copy",{fontCharacter:"\\ebcc"}),fJ.personAdd=new fJ("person-add",{fontCharacter:"\\ebcd"}),fJ.filterFilled=new fJ("filter-filled",{fontCharacter:"\\ebce"}),fJ.wand=new fJ("wand",{fontCharacter:"\\ebcf"}),fJ.debugLineByLine=new fJ("debug-line-by-line",{fontCharacter:"\\ebd0"}),fJ.inspect=new fJ("inspect",{fontCharacter:"\\ebd1"}),fJ.dropDownButton=new fJ("drop-down-button",fJ.chevronDown.definition);class gJ{constructor(e,t){this.language=e,this.id=t}}class pJ{static getLanguageId(e){return(255&e)>>>0}static getTokenType(e){return(1792&e)>>>8}static getFontStyle(e){return(14336&e)>>>11}static getForeground(e){return(8372224&e)>>>14}static getBackground(e){return(4286578688&e)>>>23}static getClassNameFromMetadata(e){let t="mtk"+this.getForeground(e),n=this.getFontStyle(e);return 1&n&&(t+=" mtki"),2&n&&(t+=" mtkb"),4&n&&(t+=" mtku"),t}static getInlineStyleFromMetadata(e,t){const n=this.getForeground(e),i=this.getFontStyle(e);let r=`color: ${t[n]};`;return 1&i&&(r+="font-style: italic;"),2&i&&(r+="font-weight: bold;"),4&i&&(r+="text-decoration: underline;"),r}}const mJ=function(){let e=Object.create(null);return e[0]="symbol-method",e[1]="symbol-function",e[2]="symbol-constructor",e[3]="symbol-field",e[4]="symbol-variable",e[5]="symbol-class",e[6]="symbol-struct",e[7]="symbol-interface",e[8]="symbol-module",e[9]="symbol-property",e[10]="symbol-event",e[11]="symbol-operator",e[12]="symbol-unit",e[13]="symbol-value",e[14]="symbol-constant",e[15]="symbol-enum",e[16]="symbol-enum-member",e[17]="symbol-keyword",e[27]="symbol-snippet",e[18]="symbol-text",e[19]="symbol-color",e[20]="symbol-file",e[21]="symbol-reference",e[22]="symbol-customcolor",e[23]="symbol-folder",e[24]="symbol-type-parameter",e[25]="account",e[26]="issues",function(t){const n=e[t];let i=n&&cJ.get(n);return i||(console.info("No codicon found for CompletionItemKind "+t),i=hJ.symbolProperty),i.classNames}}();let vJ=function(){let e=Object.create(null);return e.method=0,e.function=1,e.constructor=2,e.field=3,e.variable=4,e.class=5,e.struct=6,e.interface=7,e.module=8,e.property=9,e.event=10,e.operator=11,e.unit=12,e.value=13,e.constant=14,e.enum=15,e["enum-member"]=16,e.enumMember=16,e.keyword=17,e.snippet=27,e.text=18,e.color=19,e.file=20,e.reference=21,e.customcolor=22,e.folder=23,e["type-parameter"]=24,e.typeParameter=24,e.account=25,e.issue=26,function(t,n){let i=e[t];return void 0!==i||n||(i=9),i}}();var yJ,_J,bJ,wJ,CJ;!function(e){e[e.Automatic=0]="Automatic",e[e.Explicit=1]="Explicit"}(yJ||(yJ={})),function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"}(_J||(_J={})),function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"}(bJ||(bJ={})),function(e){const t=new Map;t.set("file",0),t.set("module",1),t.set("namespace",2),t.set("package",3),t.set("class",4),t.set("method",5),t.set("property",6),t.set("field",7),t.set("constructor",8),t.set("enum",9),t.set("interface",10),t.set("function",11),t.set("variable",12),t.set("constant",13),t.set("string",14),t.set("number",15),t.set("boolean",16),t.set("array",17),t.set("object",18),t.set("key",19),t.set("null",20),t.set("enum-member",21),t.set("struct",22),t.set("event",23),t.set("operator",24),t.set("type-parameter",25);const n=new Map;n.set(0,"file"),n.set(1,"module"),n.set(2,"namespace"),n.set(3,"package"),n.set(4,"class"),n.set(5,"method"),n.set(6,"property"),n.set(7,"field"),n.set(8,"constructor"),n.set(9,"enum"),n.set(10,"interface"),n.set(11,"function"),n.set(12,"variable"),n.set(13,"constant"),n.set(14,"string"),n.set(15,"number"),n.set(16,"boolean"),n.set(17,"array"),n.set(18,"object"),n.set(19,"key"),n.set(20,"null"),n.set(21,"enum-member"),n.set(22,"struct"),n.set(23,"event"),n.set(24,"operator"),n.set(25,"type-parameter"),e.fromString=function(e){return t.get(e)},e.toString=function(e){return n.get(e)},e.toCssClassName=function(e,t){const i=n.get(e);let r=i&&cJ.get("symbol-"+i);return r||(console.info("No codicon found for SymbolKind "+e),r=hJ.symbolProperty),`${t?"inline":"block"} ${r.classNames}`}}(wJ||(wJ={}));class SJ{constructor(e){this.value=e}}SJ.Comment=new SJ("comment"),SJ.Imports=new SJ("imports"),SJ.Region=new SJ("region"),function(e){e[e.Other=0]="Other",e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"}(CJ||(CJ={}));const xJ=new sJ,EJ=new sJ,kJ=new sJ,LJ=new sJ,DJ=new sJ,NJ=new sJ,IJ=new sJ,TJ=new sJ,MJ=new sJ,AJ=new sJ,OJ=new sJ,RJ=new sJ,PJ=new sJ,FJ=new sJ,BJ=new sJ,WJ=new sJ,zJ=new sJ,VJ=new sJ,UJ=new sJ,HJ=new sJ,jJ=new sJ,GJ=new sJ,KJ=new sJ,qJ=new sJ,$J=new sJ,YJ=new class{constructor(){this._map=new Map,this._promises=new Map,this._onDidChange=new EG,this.onDidChange=this._onDidChange.event,this._colorMap=null}fire(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._map.set(e,t),this.fire([e]),gG((()=>{this._map.get(e)===t&&(this._map.delete(e),this.fire([e]))}))}registerPromise(e,t){let n=null,i=!1;return this._promises.set(e,t.then((t=>{this._promises.delete(e),!i&&t&&(n=this.register(e,t))}))),gG((()=>{i=!0,n&&n.dispose()}))}getPromise(e){const t=this.get(e);if(t)return Promise.resolve(t);const n=this._promises.get(e);return n?n.then((t=>this.get(e))):null}get(e){return this._map.get(e)||null}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._map.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};const XJ=new class{clone(){return this}equals(e){return this===e}},ZJ=new gJ("vs.editor.nullMode",0);function QJ(e,t,n,i){return new OK([new AK(i,"",e)],n)}function JJ(e,t,n,i){let r=new Uint32Array(2);return r[0]=i,r[1]=(16384|e<<0|2<<23)>>>0,new RK(r,null===n?XJ:n)}const e0=i$("editorWorkerService"),t0=i$("modeService"),n0=i$("textModelService");let i0=!1;function r0(e){hj&&(i0||(i0=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(e.message))}class o0{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null)}setWorkerId(e){this._workerId=e}sendMessage(e,t){let n=String(++this._lastSentReq);return new Promise(((i,r)=>{this._pendingReplies[n]={resolve:i,reject:r},this._send({vsWorker:this._workerId,req:n,method:e,args:t})}))}handleMessage(e){e&&e.vsWorker&&(-1!==this._workerId&&e.vsWorker!==this._workerId||this._handleMessage(e))}_handleMessage(e){if(e.seq){let t=e;if(!this._pendingReplies[t.seq])return void console.warn("Got reply to unknown seq");let n=this._pendingReplies[t.seq];if(delete this._pendingReplies[t.seq],t.err){let e=t.err;return t.err.$isError&&(e=new Error,e.name=t.err.name,e.message=t.err.message,e.stack=t.err.stack),void n.reject(e)}return void n.resolve(t.res)}let t=e,n=t.req;this._handler.handleMessage(t.method,t.args).then((e=>{this._send({vsWorker:this._workerId,seq:n,res:e,err:void 0})}),(e=>{e.detail instanceof Error&&(e.detail=rG(e.detail)),this._send({vsWorker:this._workerId,seq:n,res:void 0,err:rG(e)})}))}_send(e){let t=[];if(e.req){const n=e;for(let e=0;e<n.args.length;e++)n.args[e]instanceof ArrayBuffer&&t.push(n.args[e])}else{const n=e;n.res instanceof ArrayBuffer&&t.push(n.res)}this._handler.sendMessage(e,t)}}class s0 extends mG{constructor(e,t,n){super();let i=null;this._worker=this._register(e.create("vs/base/common/worker/simpleWorker",(e=>{this._protocol.handleMessage(e)}),(e=>{i&&i(e)}))),this._protocol=new o0({sendMessage:(e,t)=>{this._worker.postMessage(e,t)},handleMessage:(e,t)=>{if("function"!=typeof n[e])return Promise.reject(new Error("Missing method "+e+" on main thread host."));try{return Promise.resolve(n[e].apply(n,t))}catch(zWe){return Promise.reject(zWe)}}}),this._protocol.setWorkerId(this._worker.getId());let r=null;void 0!==self.require&&"function"==typeof self.require.getConfig?r=self.require.getConfig():void 0!==self.requirejs&&(r=self.requirejs.s.contexts._.config);const o=HZ(n);this._onModuleLoaded=this._protocol.sendMessage("$initialize",[this._worker.getId(),JSON.parse(JSON.stringify(r)),t,o]);const s=(e,t)=>this._request(e,t);this._lazyProxy=new Promise(((e,n)=>{i=n,this._onModuleLoaded.then((t=>{e(jZ(t,s))}),(e=>{n(e),this._onError("Worker failed to load "+t,e)}))}))}getProxyObject(){return this._lazyProxy}_request(e,t){return new Promise(((n,i)=>{this._onModuleLoaded.then((()=>{this._protocol.sendMessage(e,t).then(n,i)}),i)}))}_onError(e,t){console.error(e),console.info(t)}}var a0;const l0=null===(a0=window.trustedTypes)||void 0===a0?void 0:a0.createPolicy("defaultWorkerFactory",{createScriptURL:e=>e});class c0{constructor(e,t,n,i,r){this.id=t;const o=function(e,t){if(nj.MonacoEnvironment){if("function"==typeof nj.MonacoEnvironment.getWorker)return nj.MonacoEnvironment.getWorker(e,t);if("function"==typeof nj.MonacoEnvironment.getWorkerUrl){const n=nj.MonacoEnvironment.getWorkerUrl(e,t);return new Worker(l0?l0.createScriptURL(n):n,{name:t})}}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}("workerMain.js",n);!function(e){return"function"==typeof e.then}(o)?this.worker=Promise.resolve(o):this.worker=o,this.postMessage(e,[]),this.worker.then((e=>{e.onmessage=function(e){i(e.data)},e.onmessageerror=r,"function"==typeof e.addEventListener&&e.addEventListener("error",r)}))}getId(){return this.id}postMessage(e,t){this.worker&&this.worker.then((n=>n.postMessage(e,t)))}dispose(){this.worker&&this.worker.then((e=>e.terminate())),this.worker=null}}class u0{constructor(e){this._label=e,this._webWorkerFailedBeforeError=!1}create(e,t,n){let i=++u0.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new c0(e,i,this._label||"anonymous"+i,t,(e=>{r0(e),this._webWorkerFailedBeforeError=e,n(e)}))}}var h0;u0.LAST_WORKER_ID=0,function(e){e[e.None=0]="None",e[e.Indent=1]="Indent",e[e.IndentOutdent=2]="IndentOutdent",e[e.Outdent=3]="Outdent"}(h0||(h0={}));class d0{constructor(e){if(this._standardAutoClosingPairConditionalBrand=void 0,this.open=e.open,this.close=e.close,this._standardTokenMask=0,Array.isArray(e.notIn))for(let t=0,n=e.notIn.length;t<n;t++){switch(e.notIn[t]){case"string":this._standardTokenMask|=2;break;case"comment":this._standardTokenMask|=1;break;case"regex":this._standardTokenMask|=4}}}isOK(e){return 0==(this._standardTokenMask&e)}}class f0{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)g0(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),g0(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),g0(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),g0(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),1===t.close.length&&1===t.open.length&&g0(this.autoClosingPairsCloseSingleChar,t.close,t)}}function g0(e,t,n){e.has(t)?e.get(t).push(n):e.set(t,[n])}function p0(e,t){let n=e.getCount(),i=e.findTokenIndexAtOffset(t),r=e.getLanguageId(i),o=i;for(;o+1<n&&e.getLanguageId(o+1)===r;)o++;let s=i;for(;s>0&&e.getLanguageId(s-1)===r;)s--;return new m0(e,r,s,o+1,e.getStartOffset(s),e.getEndOffset(o))}class m0{constructor(e,t,n,i,r,o){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=n,this._lastTokenIndex=i,this.firstCharOffset=r,this._lastCharOffset=o}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}}function v0(e){return 0!=(7&e)}class y0{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map((e=>new d0(e))):e.brackets?this._autoClosingPairs=e.brackets.map((e=>new d0({open:e[0],close:e[1]}))):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new d0({open:t.open,close:t.close||""}))}this._autoCloseBefore="string"==typeof e.autoCloseBefore?e.autoCloseBefore:y0.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(){return this._autoCloseBefore}static shouldAutoClosePair(e,t,n){if(0===t.getTokenCount())return!0;const i=t.findTokenIndexAtOffset(n-2),r=t.getStandardTokenType(i);return e.isOK(r)}getSurroundingPairs(){return this._surroundingPairs}}let _0,b0,w0;function C0(){return _0||(_0=new TextDecoder("UTF-16LE")),_0}function S0(){return w0||(w0=yj()?C0():(b0||(b0=new TextDecoder("UTF-16BE")),b0)),w0}y0.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED=";:.,=}])> \n\t";const x0="undefined"!=typeof TextDecoder;let E0,k0;function L0(e,t,n){let i=[],r=0;for(let o=0;o<n;o++){const n=hZ(e,t);t+=2,i[r++]=String.fromCharCode(n)}return i.join("")}x0?(E0=e=>new D0(e),k0=function(e,t,n){const i=new Uint16Array(e.buffer,t,n);if(n>0&&(65279===i[0]||65534===i[0]))return L0(e,t,n);return C0().decode(i)}):(E0=e=>new N0,k0=L0);class D0{constructor(e){this._capacity=0|e,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return null!==this._completedStrings?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(0===this._bufferLength)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return S0().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,null===this._completedStrings?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}write1(e){const t=this._capacity-this._bufferLength;t<=1&&(0===t||kX(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCII(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIIString(e){const t=e.length;if(this._bufferLength+t>=this._capacity)return this._flushBuffer(),void(this._completedStrings[this._completedStrings.length]=e);for(let n=0;n<t;n++)this._buffer[this._bufferLength++]=e.charCodeAt(n)}}class N0{constructor(){this._pieces=[],this._piecesLen=0}reset(){this._pieces=[],this._piecesLen=0}build(){return this._pieces.join("")}write1(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCII(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCIIString(e){this._pieces[this._piecesLen++]=e}}class I0{constructor(e,t,n,i,r,o){this._richEditBracketBrand=void 0,this.languageIdentifier=e,this.index=t,this.open=n,this.close=i,this.forwardRegex=r,this.reversedRegex=o,this._openSet=I0._toSet(this.open),this._closeSet=I0._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const n of e)t.add(n);return t}}class T0{constructor(e,t){this._richEditBracketsBrand=void 0;const n=function(e){const t=e.length;e=e.map((e=>[e[0].toLowerCase(),e[1].toLowerCase()]));const n=[];for(let s=0;s<t;s++)n[s]=s;const i=(e,t)=>{const[n,i]=e,[r,o]=t;return n===r||n===o||i===r||i===o},r=(e,i)=>{const r=Math.min(e,i),o=Math.max(e,i);for(let s=0;s<t;s++)n[s]===o&&(n[s]=r)};for(let s=0;s<t;s++){const o=e[s];for(let a=s+1;a<t;a++)i(o,e[a])&&r(n[s],n[a])}const o=[];for(let s=0;s<t;s++){let i=[],r=[];for(let o=0;o<t;o++)if(n[o]===s){const[t,n]=e[o];i.push(t),r.push(n)}i.length>0&&o.push({open:i,close:r})}return o}(t);this.brackets=n.map(((t,i)=>new I0(e,i,t.open,t.close,function(e,t,n,i){let r=[];r=r.concat(e),r=r.concat(t);for(let o=0,s=r.length;o<s;o++)M0(r[o],n,i,r);return r=O0(r),r.sort(A0),r.reverse(),P0(r)}(t.open,t.close,n,i),function(e,t,n,i){let r=[];r=r.concat(e),r=r.concat(t);for(let o=0,s=r.length;o<s;o++)M0(r[o],n,i,r);return r=O0(r),r.sort(A0),r.reverse(),P0(r.map(F0))}(t.open,t.close,n,i)))),this.forwardRegex=function(e){let t=[];for(const n of e){for(const e of n.open)t.push(e);for(const e of n.close)t.push(e)}return t=O0(t),P0(t)}(this.brackets),this.reversedRegex=function(e){let t=[];for(const n of e){for(const e of n.open)t.push(e);for(const e of n.close)t.push(e)}return t=O0(t),P0(t.map(F0))}(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const i of this.brackets){for(const e of i.open)this.textIsBracket[e]=i,this.textIsOpenBracket[e]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,e.length);for(const e of i.close)this.textIsBracket[e]=i,this.textIsOpenBracket[e]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,e.length)}}}function M0(e,t,n,i){for(let r=0,o=t.length;r<o;r++){if(r===n)continue;const o=t[r];for(const t of o.open)t.indexOf(e)>=0&&i.push(t);for(const t of o.close)t.indexOf(e)>=0&&i.push(t)}}function A0(e,t){return e.length-t.length}function O0(e){if(e.length<=1)return e;const t=[],n=new Set;for(const i of e)n.has(i)||(t.push(i),n.add(i));return t}function R0(e){const t=/^[\w ]+$/.test(e);return e=rX(e),t?`\\b${e}\\b`:e}function P0(e){return lX(`(${e.map(R0).join(")|(")})`,!0)}const F0=function(){let e=null,t=null;return function(n){return e!==n&&(e=n,t=function(e){if(x0){const t=new Uint16Array(e.length);let n=0;for(let i=e.length-1;i>=0;i--)t[n++]=e.charCodeAt(i);return S0().decode(t)}{let t=[],n=0;for(let i=e.length-1;i>=0;i--)t[n++]=e.charAt(i);return t.join("")}}(e)),t}}();class B0{static _findPrevBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let o=n.length-(r.index||0),s=r[0].length,a=i+o;return new TK(t,a-s+1,t,a+1)}static findPrevBracketInRange(e,t,n,i,r){const o=F0(n).substring(n.length-r,n.length-i);return this._findPrevBracketInText(e,t,o,i)}static findNextBracketInText(e,t,n,i){let r=n.match(e);if(!r)return null;let o=r.index||0,s=r[0].length;if(0===s)return null;let a=i+o;return new TK(t,a+1,t,a+1+s)}static findNextBracketInRange(e,t,n,i,r){const o=n.substring(i,r);return this.findNextBracketInText(e,t,o,i)}}class W0{constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const n of t.close){const t=n.charAt(n.length-1);e.push(t)}return e=e.filter(((e,t,n)=>n.indexOf(e)===t)),e}onElectricCharacter(e,t,n){if(!this._richEditBrackets||0===this._richEditBrackets.brackets.length)return null;const i=t.findTokenIndexAtOffset(n-1);if(v0(t.getStandardTokenType(i)))return null;const r=this._richEditBrackets.reversedRegex,o=t.getLineContent().substring(0,n-1)+e,s=B0.findPrevBracketInRange(r,1,o,0,o.length);if(!s)return null;const a=o.substring(s.startColumn-1,s.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[a])return null;const l=t.getActualLineContentBefore(s.startColumn-1);return/^\s*$/.test(l)?{matchOpenBracket:a}:null}}function z0(e){return e.global&&(e.lastIndex=0),!0}class V0{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&z0(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&z0(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&z0(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&z0(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class U0{constructor(e){(e=e||{}).brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach((e=>{const t=U0._createOpenBracketRegExp(e[0]),n=U0._createCloseBracketRegExp(e[1]);t&&n&&this._brackets.push({open:e[0],openRegExp:t,close:e[1],closeRegExp:n})})),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,n,i){if(e>=3)for(let r=0,o=this._regExpRules.length;r<o;r++){let e=this._regExpRules[r];if([{reg:e.beforeText,text:n},{reg:e.afterText,text:i},{reg:e.previousLineText,text:t}].every((e=>!e.reg||(e.reg.lastIndex=0,e.reg.test(e.text)))))return e.action}if(e>=2&&n.length>0&&i.length>0)for(let r=0,o=this._brackets.length;r<o;r++){let e=this._brackets[r];if(e.openRegExp.test(n)&&e.closeRegExp.test(i))return{indentAction:h0.IndentOutdent}}if(e>=2&&n.length>0)for(let r=0,o=this._brackets.length;r<o;r++){if(this._brackets[r].openRegExp.test(n))return{indentAction:h0.Indent}}return null}static _createOpenBracketRegExp(e){let t=rX(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",U0._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=rX(e);return/\B/.test(t.charAt(t.length-1))||(t+="\\b"),t="^\\s*"+t,U0._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return nG(t),null}}}class H0{constructor(e,t){this._languageIdentifier=e,this._brackets=null,this._electricCharacter=null,this._conf=t,this._onEnterSupport=this._conf.brackets||this._conf.indentationRules||this._conf.onEnterRules?new U0(this._conf):null,this.comments=H0._handleComments(this._conf),this.characterPair=new y0(this._conf),this.wordDefinition=this._conf.wordPattern||_j,this.indentationRules=this._conf.indentationRules,this._conf.indentationRules?this.indentRulesSupport=new V0(this._conf.indentationRules):this.indentRulesSupport=null,this.foldingRules=this._conf.folding||{}}get brackets(){return!this._brackets&&this._conf.brackets&&(this._brackets=new T0(this._languageIdentifier,this._conf.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new W0(this.brackets)),this._electricCharacter}onEnter(e,t,n,i){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,n,i):null}static _handleComments(e){let t=e.comments;if(!t)return null;let n={};if(t.lineComment&&(n.lineCommentToken=t.lineComment),t.blockComment){let[e,i]=t.blockComment;n.blockCommentStartToken=e,n.blockCommentEndToken=i}return n}}class j0{constructor(e){this.languageIdentifier=e}}class G0{constructor(e,t,n){this.configuration=e,this.priority=t,this.order=n}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class K0{constructor(e){this.languageIdentifier=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const n=new G0(e,t,++this._order);return this._entries.push(n),this._resolved=null,gG((()=>{for(let e=0;e<this._entries.length;e++)if(this._entries[e]===n){this._entries.splice(e,1),this._resolved=null;break}}))}getRichEditSupport(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new H0(this.languageIdentifier,e))}return this._resolved}_resolve(){if(0===this._entries.length)return null;this._entries.sort(G0.cmp);const e={};for(const t of this._entries){const n=t.configuration;e.comments=n.comments||e.comments,e.brackets=n.brackets||e.brackets,e.wordPattern=n.wordPattern||e.wordPattern,e.indentationRules=n.indentationRules||e.indentationRules,e.onEnterRules=n.onEnterRules||e.onEnterRules,e.autoClosingPairs=n.autoClosingPairs||e.autoClosingPairs,e.surroundingPairs=n.surroundingPairs||e.surroundingPairs,e.autoCloseBefore=n.autoCloseBefore||e.autoCloseBefore,e.folding=n.folding||e.folding,e.__electricCharacterSupport=n.__electricCharacterSupport||e.__electricCharacterSupport}return e}}const q0=new class{constructor(){this._entries2=new Map,this._onDidChange=new EG,this.onDidChange=this._onDidChange.event}register(e,t,n=0){let i=this._entries2.get(e.id);i||(i=new K0(e),this._entries2.set(e.id,i));const r=i.register(t,n);return this._onDidChange.fire(new j0(e)),gG((()=>{r.dispose(),this._onDidChange.fire(new j0(e))}))}_getRichEditSupport(e){const t=this._entries2.get(e);return t?t.getRichEditSupport():null}getIndentationRules(e){const t=this._getRichEditSupport(e);return t&&t.indentationRules||null}_getElectricCharacterSupport(e){let t=this._getRichEditSupport(e);return t&&t.electricCharacter||null}getElectricCharacters(e){let t=this._getElectricCharacterSupport(e);return t?t.getElectricCharacters():[]}onElectricCharacter(e,t,n){let i=p0(t,n-1),r=this._getElectricCharacterSupport(i.languageId);return r?r.onElectricCharacter(e,i,n-i.firstCharOffset):null}getComments(e){let t=this._getRichEditSupport(e);return t&&t.comments||null}_getCharacterPairSupport(e){let t=this._getRichEditSupport(e);return t&&t.characterPair||null}getAutoClosingPairs(e){const t=this._getCharacterPairSupport(e);return new f0(t?t.getAutoClosingPairs():[])}getAutoCloseBeforeSet(e){let t=this._getCharacterPairSupport(e);return t?t.getAutoCloseBeforeSet():y0.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED}getSurroundingPairs(e){let t=this._getCharacterPairSupport(e);return t?t.getSurroundingPairs():[]}shouldAutoClosePair(e,t,n){const i=p0(t,n-1);return y0.shouldAutoClosePair(e,i,n-i.firstCharOffset)}getWordDefinition(e){let t=this._getRichEditSupport(e);return bj(t&&t.wordDefinition||null)}getFoldingRules(e){let t=this._getRichEditSupport(e);return t?t.foldingRules:{}}getIndentRulesSupport(e){let t=this._getRichEditSupport(e);return t&&t.indentRulesSupport||null}getPrecedingValidLine(e,t,n){let i=e.getLanguageIdAtPosition(t,0);if(t>1){let r,o=-1;for(r=t-1;r>=1;r--){if(e.getLanguageIdAtPosition(r,0)!==i)return o;let t=e.getLineContent(r);if(!n.shouldIgnore(t)&&!/^\s+$/.test(t)&&""!==t)return r;o=r}}return-1}getInheritIndentForLine(e,t,n,i=!0){if(e<4)return null;const r=this.getIndentRulesSupport(t.getLanguageIdentifier().id);if(!r)return null;if(n<=1)return{indentation:"",action:null};const o=this.getPrecedingValidLine(t,n,r);if(o<0)return null;if(o<1)return{indentation:"",action:null};const s=t.getLineContent(o);if(r.shouldIncrease(s)||r.shouldIndentNextLine(s))return{indentation:dX(s),action:h0.Indent,line:o};if(r.shouldDecrease(s))return{indentation:dX(s),action:null,line:o};{if(1===o)return{indentation:dX(t.getLineContent(o)),action:null,line:o};const e=o-1,n=r.getIndentMetadata(t.getLineContent(e));if(!(3&n)&&4&n){let n=0;for(let i=e-1;i>0;i--)if(!r.shouldIndentNextLine(t.getLineContent(i))){n=i;break}return{indentation:dX(t.getLineContent(n+1)),action:null,line:n+1}}if(i)return{indentation:dX(t.getLineContent(o)),action:null,line:o};for(let i=o;i>0;i--){const e=t.getLineContent(i);if(r.shouldIncrease(e))return{indentation:dX(e),action:h0.Indent,line:i};if(r.shouldIndentNextLine(e)){let e=0;for(let n=i-1;n>0;n--)if(!r.shouldIndentNextLine(t.getLineContent(i))){e=n;break}return{indentation:dX(t.getLineContent(e+1)),action:null,line:e+1}}if(r.shouldDecrease(e))return{indentation:dX(e),action:null,line:i}}return{indentation:dX(t.getLineContent(1)),action:null,line:1}}}getGoodIndentForLine(e,t,n,i,r){if(e<4)return null;const o=this._getRichEditSupport(n);if(!o)return null;const s=this.getIndentRulesSupport(n);if(!s)return null;const a=this.getInheritIndentForLine(e,t,i),l=t.getLineContent(i);if(a){const n=a.line;if(void 0!==n){const i=o.onEnter(e,"",t.getLineContent(n),"");if(i){let e=dX(t.getLineContent(n));return i.removeText&&(e=e.substring(0,e.length-i.removeText)),i.indentAction===h0.Indent||i.indentAction===h0.IndentOutdent?e=r.shiftIndent(e):i.indentAction===h0.Outdent&&(e=r.unshiftIndent(e)),s.shouldDecrease(l)&&(e=r.unshiftIndent(e)),i.appendText&&(e+=i.appendText),dX(e)}}return s.shouldDecrease(l)?a.action===h0.Indent?a.indentation:r.unshiftIndent(a.indentation):a.action===h0.Indent?r.shiftIndent(a.indentation):a.indentation}return null}getIndentForEnter(e,t,n,i){if(e<4)return null;t.forceTokenization(n.startLineNumber);const r=t.getLineTokens(n.startLineNumber),o=p0(r,n.startColumn-1),s=o.getLineContent();let a,l,c=!1;if(o.firstCharOffset>0&&r.getLanguageId(0)!==o.languageId?(c=!0,a=s.substr(0,n.startColumn-1-o.firstCharOffset)):a=r.getLineContent().substring(0,n.startColumn-1),n.isEmpty())l=s.substr(n.startColumn-1-o.firstCharOffset);else{l=this.getScopedLineTokens(t,n.endLineNumber,n.endColumn).getLineContent().substr(n.endColumn-1-o.firstCharOffset)}const u=this.getIndentRulesSupport(o.languageId);if(!u)return null;const h=a,d=dX(a),f={getLineTokens:e=>t.getLineTokens(e),getLanguageIdentifier:()=>t.getLanguageIdentifier(),getLanguageIdAtPosition:(e,n)=>t.getLanguageIdAtPosition(e,n),getLineContent:e=>e===n.startLineNumber?h:t.getLineContent(e)},g=dX(r.getLineContent()),p=this.getInheritIndentForLine(e,f,n.startLineNumber+1);if(!p){const e=c?g:d;return{beforeEnter:e,afterEnter:e}}let m=c?g:p.indentation;return p.action===h0.Indent&&(m=i.shiftIndent(m)),u.shouldDecrease(l)&&(m=i.unshiftIndent(m)),{beforeEnter:c?g:d,afterEnter:m}}getIndentActionForType(e,t,n,i,r){if(e<4)return null;const o=this.getScopedLineTokens(t,n.startLineNumber,n.startColumn);if(o.firstCharOffset)return null;const s=this.getIndentRulesSupport(o.languageId);if(!s)return null;const a=o.getLineContent(),l=a.substr(0,n.startColumn-1-o.firstCharOffset);let c;if(n.isEmpty())c=a.substr(n.startColumn-1-o.firstCharOffset);else{c=this.getScopedLineTokens(t,n.endLineNumber,n.endColumn).getLineContent().substr(n.endColumn-1-o.firstCharOffset)}if(!s.shouldDecrease(l+c)&&s.shouldDecrease(l+i+c)){const i=this.getInheritIndentForLine(e,t,n.startLineNumber,!1);if(!i)return null;let o=i.indentation;return i.action!==h0.Indent&&(o=r.unshiftIndent(o)),o}return null}getIndentMetadata(e,t){const n=this.getIndentRulesSupport(e.getLanguageIdentifier().id);return n?t<1||t>e.getLineCount()?null:n.getIndentMetadata(e.getLineContent(t)):null}getEnterAction(e,t,n){const i=this.getScopedLineTokens(t,n.startLineNumber,n.startColumn),r=this._getRichEditSupport(i.languageId);if(!r)return null;const o=i.getLineContent(),s=o.substr(0,n.startColumn-1-i.firstCharOffset);let a;if(n.isEmpty())a=o.substr(n.startColumn-1-i.firstCharOffset);else{a=this.getScopedLineTokens(t,n.endLineNumber,n.endColumn).getLineContent().substr(n.endColumn-1-i.firstCharOffset)}let l="";if(n.startLineNumber>1&&0===i.firstCharOffset){const e=this.getScopedLineTokens(t,n.startLineNumber-1);e.languageId===i.languageId&&(l=e.getLineContent())}const c=r.onEnter(e,l,s,a);if(!c)return null;const u=c.indentAction;let h=c.appendText;const d=c.removeText||0;h?u===h0.Indent&&(h="\t"+h):h=u===h0.Indent||u===h0.IndentOutdent?"\t":"";let f=this.getIndentationAtPosition(t,n.startLineNumber,n.startColumn);return d&&(f=f.substring(0,f.length-d)),{indentAction:u,appendText:h,removeText:d,indentation:f}}getIndentationAtPosition(e,t,n){let i=dX(e.getLineContent(t));return i.length>n-1&&(i=i.substring(0,n-1)),i}getScopedLineTokens(e,t,n){e.forceTokenization(t);return p0(e.getLineTokens(t),void 0===n?e.getLineMaxColumn(t)-1:n-1)}getBracketsSupport(e){const t=this._getRichEditSupport(e);return t&&t.brackets||null}};class $0{constructor(e,t,n,i){this.originalStart=e,this.originalLength=t,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class Y0{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let n=0,i=e.length;n<i;n++)t[n]=e.charCodeAt(n);return t}}function X0(e,t,n){return new e1(new Y0(e),new Y0(t)).ComputeDiff(n).changes}class Z0{static Assert(e,t){if(!e)throw new Error(t)}}class Q0{static Copy(e,t,n,i,r){for(let o=0;o<r;o++)n[i+o]=e[t+o]}static Copy2(e,t,n,i,r){for(let o=0;o<r;o++)n[i+o]=e[t+o]}}class J0{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new $0(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class e1{constructor(e,t,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=t;const[i,r,o]=e1._getElements(e),[s,a,l]=e1._getElements(t);this._hasStrings=o&&l,this._originalStringElements=i,this._originalElementsOrHash=r,this._modifiedStringElements=s,this._modifiedElementsOrHash=a,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&"string"==typeof e[0]}static _getElements(e){const t=e.getElements();if(e1._isStringArray(t)){const e=new Int32Array(t.length);for(let n=0,i=t.length;n<i;n++)e[n]=IQ(t[n],0);return[t,e,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]===this._modifiedElementsOrHash[t]&&(!this._hasStrings||this._originalStringElements[e]===this._modifiedStringElements[t])}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;return e1._getStrictElement(this._originalSequence,e)===e1._getStrictElement(this._modifiedSequence,t)}static _getStrictElement(e,t){return"function"==typeof e.getStrictElement?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]===this._originalElementsOrHash[t]&&(!this._hasStrings||this._originalStringElements[e]===this._originalStringElements[t])}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]===this._modifiedElementsOrHash[t]&&(!this._hasStrings||this._modifiedStringElements[e]===this._modifiedStringElements[t])}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,n,i,r){const o=[!1];let s=this.ComputeDiffRecursive(e,t,n,i,o);return r&&(s=this.PrettifyChanges(s)),{quitEarly:o[0],changes:s}}ComputeDiffRecursive(e,t,n,i,r){for(r[0]=!1;e<=t&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;t>=e&&i>=n&&this.ElementsAreEqual(t,i);)t--,i--;if(e>t||n>i){let r;return n<=i?(Z0.Assert(e===t+1,"originalStart should only be one more than originalEnd"),r=[new $0(e,0,n,i-n+1)]):e<=t?(Z0.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),r=[new $0(e,t-e+1,n,0)]):(Z0.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Z0.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),r=[]),r}const o=[0],s=[0],a=this.ComputeRecursionPoint(e,t,n,i,o,s,r),l=o[0],c=s[0];if(null!==a)return a;if(!r[0]){const o=this.ComputeDiffRecursive(e,l,n,c,r);let s=[];return s=r[0]?[new $0(l+1,t-(l+1)+1,c+1,i-(c+1)+1)]:this.ComputeDiffRecursive(l+1,t,c+1,i,r),this.ConcatenateChanges(o,s)}return[new $0(e,t-e+1,n,i-n+1)]}WALKTRACE(e,t,n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v){let y=null,_=null,b=new J0,w=t,C=n,S=d[0]-p[0]-i,x=-1073741824,E=this.m_forwardHistory.length-1;do{const t=S+e;t===w||t<C&&l[t-1]<l[t+1]?(f=(u=l[t+1])-S-i,u<x&&b.MarkNextChange(),x=u,b.AddModifiedElement(u+1,f),S=t+1-e):(f=(u=l[t-1]+1)-S-i,u<x&&b.MarkNextChange(),x=u-1,b.AddOriginalElement(u,f+1),S=t-1-e),E>=0&&(e=(l=this.m_forwardHistory[E])[0],w=1,C=l.length-1)}while(--E>=-1);if(y=b.getReverseChanges(),v[0]){let e=d[0]+1,t=p[0]+1;if(null!==y&&y.length>0){const n=y[y.length-1];e=Math.max(e,n.getOriginalEnd()),t=Math.max(t,n.getModifiedEnd())}_=[new $0(e,h-e+1,t,g-t+1)]}else{b=new J0,w=o,C=s,S=d[0]-p[0]-a,x=1073741824,E=m?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const e=S+r;e===w||e<C&&c[e-1]>=c[e+1]?(f=(u=c[e+1]-1)-S-a,u>x&&b.MarkNextChange(),x=u+1,b.AddOriginalElement(u+1,f+1),S=e+1-r):(f=(u=c[e-1])-S-a,u>x&&b.MarkNextChange(),x=u,b.AddModifiedElement(u+1,f+1),S=e-1-r),E>=0&&(r=(c=this.m_reverseHistory[E])[0],w=1,C=c.length-1)}while(--E>=-1);_=b.getChanges()}return this.ConcatenateChanges(y,_)}ComputeRecursionPoint(e,t,n,i,r,o,s){let a=0,l=0,c=0,u=0,h=0,d=0;e--,n--,r[0]=0,o[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const f=t-e+(i-n),g=f+1,p=new Int32Array(g),m=new Int32Array(g),v=i-n,y=t-e,_=e-n,b=t-i,w=(y-v)%2==0;p[v]=e,m[y]=t,s[0]=!1;for(let C=1;C<=f/2+1;C++){let f=0,S=0;c=this.ClipDiagonalBound(v-C,C,v,g),u=this.ClipDiagonalBound(v+C,C,v,g);for(let e=c;e<=u;e+=2){a=e===c||e<u&&p[e-1]<p[e+1]?p[e+1]:p[e-1]+1,l=a-(e-v)-_;const n=a;for(;a<t&&l<i&&this.ElementsAreEqual(a+1,l+1);)a++,l++;if(p[e]=a,a+l>f+S&&(f=a,S=l),!w&&Math.abs(e-y)<=C-1&&a>=m[e])return r[0]=a,o[0]=l,n<=m[e]&&C<=1448?this.WALKTRACE(v,c,u,_,y,h,d,b,p,m,a,t,r,l,i,o,w,s):null}const x=(f-e+(S-n)-C)/2;if(null!==this.ContinueProcessingPredicate&&!this.ContinueProcessingPredicate(f,x))return s[0]=!0,r[0]=f,o[0]=S,x>0&&C<=1448?this.WALKTRACE(v,c,u,_,y,h,d,b,p,m,a,t,r,l,i,o,w,s):(e++,n++,[new $0(e,t-e+1,n,i-n+1)]);h=this.ClipDiagonalBound(y-C,C,y,g),d=this.ClipDiagonalBound(y+C,C,y,g);for(let g=h;g<=d;g+=2){a=g===h||g<d&&m[g-1]>=m[g+1]?m[g+1]-1:m[g-1],l=a-(g-y)-b;const f=a;for(;a>e&&l>n&&this.ElementsAreEqual(a,l);)a--,l--;if(m[g]=a,w&&Math.abs(g-v)<=C&&a<=p[g])return r[0]=a,o[0]=l,f>=p[g]&&C<=1448?this.WALKTRACE(v,c,u,_,y,h,d,b,p,m,a,t,r,l,i,o,w,s):null}if(C<=1447){let e=new Int32Array(u-c+2);e[0]=v-c+1,Q0.Copy2(p,c,e,1,u-c+1),this.m_forwardHistory.push(e),e=new Int32Array(d-h+2),e[0]=y-h+1,Q0.Copy2(m,h,e,1,d-h+1),this.m_reverseHistory.push(e)}}return this.WALKTRACE(v,c,u,_,y,h,d,b,p,m,a,t,r,l,i,o,w,s)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const n=e[t],i=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,o=n.originalLength>0,s=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<r&&(!o||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!s||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){const e=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!e)break;n.originalStart++,n.modifiedStart++}let a=[null];t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],a)&&(e[t]=a[0],e.splice(t+1,1),t--)}for(let t=e.length-1;t>=0;t--){const n=e[t];let i=0,r=0;if(t>0){const n=e[t-1];i=n.originalStart+n.originalLength,r=n.modifiedStart+n.modifiedLength}const o=n.originalLength>0,s=n.modifiedLength>0;let a=0,l=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let e=1;;e++){const t=n.originalStart-e,c=n.modifiedStart-e;if(t<i||c<r)break;if(o&&!this.OriginalElementsAreEqual(t,t+n.originalLength))break;if(s&&!this.ModifiedElementsAreEqual(c,c+n.modifiedLength))break;const u=(t===i&&c===r?5:0)+this._boundaryScore(t,n.originalLength,c,n.modifiedLength);u>l&&(l=u,a=e)}n.originalStart-=a,n.modifiedStart-=a;const c=[null];t>0&&this.ChangesOverlap(e[t-1],e[t],c)&&(e[t-1]=c[0],e.splice(t,1),t++)}if(this._hasStrings)for(let t=1,n=e.length;t<n;t++){const n=e[t-1],i=e[t],r=i.originalStart-n.originalStart-n.originalLength,o=n.originalStart,s=i.originalStart+i.originalLength,a=s-o,l=n.modifiedStart,c=i.modifiedStart+i.modifiedLength,u=c-l;if(r<5&&a<20&&u<20){const e=this._findBetterContiguousSequence(o,a,l,u,r);if(e){const[t,o]=e;t===n.originalStart+n.originalLength&&o===n.modifiedStart+n.modifiedLength||(n.originalLength=t-n.originalStart,n.modifiedLength=o-n.modifiedStart,i.originalStart=t+r,i.modifiedStart=o+r,i.originalLength=s-i.originalStart,i.modifiedLength=c-i.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,n,i,r){if(t<r||i<r)return null;const o=e+t-r+1,s=n+i-r+1;let a=0,l=0,c=0;for(let u=e;u<o;u++)for(let e=n;e<s;e++){const t=this._contiguousSequenceScore(u,e,r);t>0&&t>a&&(a=t,l=u,c=e)}return a>0?[l,c]:null}_contiguousSequenceScore(e,t,n){let i=0;for(let r=0;r<n;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;i+=this._originalStringElements[e+r].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1||this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const n=e+t;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1||this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const n=e+t;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,t,n,i){return(this._OriginalRegionIsBoundary(e,t)?1:0)+(this._ModifiedRegionIsBoundary(n,i)?1:0)}ConcatenateChanges(e,t){let n=[];if(0===e.length||0===t.length)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],n)){const i=new Array(e.length+t.length-1);return Q0.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Q0.Copy(t,1,i,e.length,t.length-1),i}{const n=new Array(e.length+t.length);return Q0.Copy(e,0,n,0,e.length),Q0.Copy(t,0,n,e.length,t.length),n}}ChangesOverlap(e,t,n){if(Z0.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Z0.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const i=e.originalStart;let r=e.originalLength;const o=e.modifiedStart;let s=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(s=t.modifiedStart+t.modifiedLength-e.modifiedStart),n[0]=new $0(i,r,o,s),!0}return n[0]=null,!1}ClipDiagonalBound(e,t,n,i){if(e>=0&&e<i)return e;const r=t%2==0;if(e<0){return r===(n%2==0)?0:1}return r===((i-n-1)%2==0)?i-1:i-2}}function t1(e,t,n,i){return new e1(e,t,n).ComputeDiff(i)}class n1{constructor(e){const t=[],n=[];for(let i=0,r=e.length;i<r;i++)t[i]=a1(e[i],1),n[i]=l1(e[i],1);this.lines=e,this._startColumns=t,this._endColumns=n}getElements(){const e=[];for(let t=0,n=this.lines.length;t<n;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,n){const i=[],r=[],o=[];let s=0;for(let a=t;a<=n;a++){const t=this.lines[a],n=e?this._startColumns[a]:1,l=e?this._endColumns[a]:t.length+1;for(let e=n;e<l;e++)i[s]=t.charCodeAt(e-1),r[s]=a+1,o[s]=e,s++}return new i1(i,r,o)}}class i1{constructor(e,t,n){this._charCodes=e,this._lineNumbers=t,this._columns=n}getElements(){return this._charCodes}getStartLineNumber(e){return this._lineNumbers[e]}getStartColumn(e){return this._columns[e]}getEndLineNumber(e){return this._lineNumbers[e]}getEndColumn(e){return this._columns[e]+1}}class r1{constructor(e,t,n,i,r,o,s,a){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=n,this.originalEndColumn=i,this.modifiedStartLineNumber=r,this.modifiedStartColumn=o,this.modifiedEndLineNumber=s,this.modifiedEndColumn=a}static createFromDiffChange(e,t,n){let i,r,o,s,a,l,c,u;return 0===e.originalLength?(i=0,r=0,o=0,s=0):(i=t.getStartLineNumber(e.originalStart),r=t.getStartColumn(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1),s=t.getEndColumn(e.originalStart+e.originalLength-1)),0===e.modifiedLength?(a=0,l=0,c=0,u=0):(a=n.getStartLineNumber(e.modifiedStart),l=n.getStartColumn(e.modifiedStart),c=n.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),u=n.getEndColumn(e.modifiedStart+e.modifiedLength-1)),new r1(i,r,o,s,a,l,c,u)}}class o1{constructor(e,t,n,i,r){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=n,this.modifiedEndLineNumber=i,this.charChanges=r}static createFromDiffResult(e,t,n,i,r,o,s){let a,l,c,u,h;if(0===t.originalLength?(a=n.getStartLineNumber(t.originalStart)-1,l=0):(a=n.getStartLineNumber(t.originalStart),l=n.getEndLineNumber(t.originalStart+t.originalLength-1)),0===t.modifiedLength?(c=i.getStartLineNumber(t.modifiedStart)-1,u=0):(c=i.getStartLineNumber(t.modifiedStart),u=i.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&r()){const o=n.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),a=i.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);let l=t1(o,a,r,!0).changes;s&&(l=function(e){if(e.length<=1)return e;const t=[e[0]];let n=t[0];for(let i=1,r=e.length;i<r;i++){const r=e[i],o=r.originalStart-(n.originalStart+n.originalLength),s=r.modifiedStart-(n.modifiedStart+n.modifiedLength);Math.min(o,s)<3?(n.originalLength=r.originalStart+r.originalLength-n.originalStart,n.modifiedLength=r.modifiedStart+r.modifiedLength-n.modifiedStart):(t.push(r),n=r)}return t}(l)),h=[];for(let e=0,t=l.length;e<t;e++)h.push(r1.createFromDiffChange(l[e],o,a))}return new o1(a,l,c,u,h)}}class s1{constructor(e,t,n){this.shouldComputeCharChanges=n.shouldComputeCharChanges,this.shouldPostProcessCharChanges=n.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=n.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=n.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new n1(e),this.modified=new n1(t),this.continueLineDiff=c1(n.maxComputationTime),this.continueCharDiff=c1(0===n.maxComputationTime?0:Math.min(n.maxComputationTime,5e3))}computeDiff(){if(1===this.original.lines.length&&0===this.original.lines[0].length)return 1===this.modified.lines.length&&0===this.modified.lines[0].length?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};if(1===this.modified.lines.length&&0===this.modified.lines[0].length)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};const e=t1(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,n=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const e=[];for(let n=0,i=t.length;n<i;n++)e.push(o1.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[n],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:n,changes:e}}const i=[];let r=0,o=0;for(let s=-1,a=t.length;s<a;s++){const e=s+1<a?t[s+1]:null,n=e?e.originalStart:this.originalLines.length,l=e?e.modifiedStart:this.modifiedLines.length;for(;r<n&&o<l;){const e=this.originalLines[r],t=this.modifiedLines[o];if(e!==t){{let n=a1(e,1),s=a1(t,1);for(;n>1&&s>1;){if(e.charCodeAt(n-2)!==t.charCodeAt(s-2))break;n--,s--}(n>1||s>1)&&this._pushTrimWhitespaceCharChange(i,r+1,1,n,o+1,1,s)}{let n=l1(e,1),s=l1(t,1);const a=e.length+1,l=t.length+1;for(;n<a&&s<l;){if(e.charCodeAt(n-1)!==e.charCodeAt(s-1))break;n++,s++}(n<a||s<l)&&this._pushTrimWhitespaceCharChange(i,r+1,n,a,o+1,s,l)}}r++,o++}e&&(i.push(o1.createFromDiffResult(this.shouldIgnoreTrimWhitespace,e,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),r+=e.originalLength,o+=e.modifiedLength)}return{quitEarly:n,changes:i}}_pushTrimWhitespaceCharChange(e,t,n,i,r,o,s){if(this._mergeTrimWhitespaceCharChange(e,t,n,i,r,o,s))return;let a;this.shouldComputeCharChanges&&(a=[new r1(t,n,t,i,r,o,r,s)]),e.push(new o1(t,t,r,r,a))}_mergeTrimWhitespaceCharChange(e,t,n,i,r,o,s){const a=e.length;if(0===a)return!1;const l=e[a-1];return 0!==l.originalEndLineNumber&&0!==l.modifiedEndLineNumber&&(l.originalEndLineNumber+1===t&&l.modifiedEndLineNumber+1===r&&(l.originalEndLineNumber=t,l.modifiedEndLineNumber=r,this.shouldComputeCharChanges&&l.charChanges&&l.charChanges.push(new r1(t,n,t,i,r,o,r,s)),!0))}}function a1(e,t){const n=hX(e);return-1===n?t:n+1}function l1(e,t){const n=fX(e);return-1===n?t:n+2}function c1(e){if(0===e)return()=>!0;const t=Date.now();return()=>Date.now()-t<e}function u1(e){return e<0?0:e>255?255:0|e}function h1(e){return e<0?0:e>4294967295?4294967295:0|e}class d1{constructor(e,t){this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class f1{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=h1(e);const n=this.values,i=this.prefixSum,r=t.length;return 0!==r&&(this.values=new Uint32Array(n.length+r),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e),e+r),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(i.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}changeValue(e,t){return e=h1(e),t=h1(t),this.values[e]!==t&&(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=h1(e),t=h1(t);const n=this.values,i=this.prefixSum;if(e>=n.length)return!1;let r=n.length-e;return t>=r&&(t=r),0!==t&&(this.values=new Uint32Array(n.length-t),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(i.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return 0===this.values.length?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=h1(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;0===t&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let n=t;n<=e;n++)this.prefixSum[n]=this.prefixSum[n-1]+this.values[n];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,n=this.values.length-1,i=0,r=0,o=0;for(;t<=n;)if(i=t+(n-t)/2|0,r=this.prefixSum[i],o=r-this.values[i],e<o)n=i-1;else{if(!(e>=r))break;t=i+1}return new d1(i,e-o)}}class g1{constructor(e){let t=u1(e);this._defaultValue=t,this._asciiMap=g1._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);for(let n=0;n<256;n++)t[n]=e;return t}set(e,t){let n=u1(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}}class p1{constructor(){this._actual=new g1(0)}add(e){this._actual.set(e,1)}has(e){return 1===this._actual.get(e)}}class m1{constructor(e,t,n){const i=new Uint8Array(e*t);for(let r=0,o=e*t;r<o;r++)i[r]=n;this._data=i,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,n){this._data[e*this.cols+t]=n}}class v1{constructor(e){let t=0,n=0;for(let r=0,o=e.length;r<o;r++){let[i,o,s]=e[r];o>t&&(t=o),i>n&&(n=i),s>n&&(n=s)}t++,n++;let i=new m1(n,t,0);for(let r=0,o=e.length;r<o;r++){let[t,n,o]=e[r];i.set(t,n,o)}this._states=i,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let y1=null;let _1=null;class b1{static _createLink(e,t,n,i,r){let o=r-1;do{const n=t.charCodeAt(o);if(2!==e.get(n))break;o--}while(o>i);if(i>0){const e=t.charCodeAt(i-1),n=t.charCodeAt(o);(40===e&&41===n||91===e&&93===n||123===e&&125===n)&&o--}return{range:{startLineNumber:n,startColumn:i+1,endLineNumber:n,endColumn:o+2},url:t.substring(i,o+1)}}static computeLinks(e,t=function(){return null===y1&&(y1=new v1([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),y1}()){const n=function(){if(null===_1){_1=new g1(0);const e=" \t<>'\"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…";for(let n=0;n<e.length;n++)_1.set(e.charCodeAt(n),1);const t=".,;";for(let n=0;n<t.length;n++)_1.set(t.charCodeAt(n),2)}return _1}();let i=[];for(let r=1,o=e.getLineCount();r<=o;r++){const o=e.getLineContent(r),s=o.length;let a=0,l=0,c=0,u=1,h=!1,d=!1,f=!1,g=!1;for(;a<s;){let e=!1;const s=o.charCodeAt(a);if(13===u){let t;switch(s){case 40:h=!0,t=0;break;case 41:t=h?0:1;break;case 91:f=!0,d=!0,t=0;break;case 93:f=!1,t=d?0:1;break;case 123:g=!0,t=0;break;case 125:t=g?0:1;break;case 39:t=34===c||96===c?0:1;break;case 34:t=39===c||96===c?0:1;break;case 96:t=39===c||34===c?0:1;break;case 42:t=42===c?1:0;break;case 124:t=124===c?1:0;break;case 32:t=f?0:1;break;default:t=n.get(s)}1===t&&(i.push(b1._createLink(n,o,r,l,a)),e=!0)}else if(12===u){let t;91===s?(d=!0,t=0):t=n.get(s),1===t?e=!0:u=13}else u=t.nextState(u,s),0===u&&(e=!0);e&&(u=1,h=!1,d=!1,g=!1,l=a+1,c=s),a++}13===u&&i.push(b1._createLink(n,o,r,l,s))}return i}}class w1{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,n,i,r){if(e&&t){let n=this.doNavigateValueSet(t,r);if(n)return{range:e,value:n}}if(n&&i){let e=this.doNavigateValueSet(i,r);if(e)return{range:n,value:e}}return null}doNavigateValueSet(e,t){let n=this.numberReplace(e,t);return null!==n?n:this.textReplace(e,t)}numberReplace(e,t){let n=Math.pow(10,e.length-(e.lastIndexOf(".")+1)),i=Number(e),r=parseFloat(e);return isNaN(i)||isNaN(r)||i!==r?null:0!==i||t?(i=Math.floor(i*n),i+=t?n:-n,String(i/n)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,n){let i=null;for(let r=0,o=e.length;null===i&&r<o;r++)i=this.valueSetReplace(e[r],t,n);return i}valueSetReplace(e,t,n){let i=e.indexOf(t);return i>=0?(i+=n?1:-1,i<0?i=e.length-1:i%=e.length,e[i]):null}}w1.INSTANCE=new w1;var C1=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class S1 extends class{constructor(e,t,n,i){this._uri=e,this._lines=t,this._eol=n,this._versionId=i,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return null===this._cachedTextValue&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const n of t)this._acceptDeleteRange(n.range),this._acceptInsertText(new IK(n.range.startLineNumber,n.range.startColumn),n.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,n=new Uint32Array(t);for(let i=0;i<t;i++)n[i]=this._lines[i].length+e;this._lineStarts=new f1(n)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.changeValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber!==e.endLineNumber)this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber);else{if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1))}}_acceptInsertText(e,t){if(0===t.length)return;let n=uX(t);if(1===n.length)return void this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]+this._lines[e.lineNumber-1].substring(e.column-1));n[n.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]);let i=new Uint32Array(n.length-1);for(let r=1;r<n.length;r++)this._lines.splice(e.lineNumber+r-1,0,n[r]),i[r-1]=n[r].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,i)}}{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){let n=Cj(e.column,bj(t),this._lines[e.lineNumber-1],0);return n?new TK(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn):null}words(e){const t=this._lines,n=this._wordenize.bind(this);let i=0,r="",o=0,s=[];return{*[Symbol.iterator](){for(;;)if(o<s.length){const e=r.substring(s[o].start,s[o].end);o+=1,yield e}else{if(!(i<t.length))break;r=t[i],s=n(r,e),o=0,i+=1}}}}getLineWords(e,t){let n=this._lines[e-1],i=this._wordenize(n,t),r=[];for(const o of i)r.push({word:n.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1});return r}_wordenize(e,t){const n=[];let i;for(t.lastIndex=0;(i=t.exec(e))&&0!==i[0].length;)n.push({start:i.index,end:i.index+i[0].length});return n}getValueInRange(e){if((e=this._validateRange(e)).startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);let t=this._eol,n=e.startLineNumber-1,i=e.endLineNumber-1,r=[];r.push(this._lines[n].substring(e.startColumn-1));for(let o=n+1;o<i;o++)r.push(this._lines[o]);return r.push(this._lines[i].substring(0,e.endColumn-1)),r.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();let t=this._lineStarts.getIndexOf(e),n=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,n)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),n=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||n.lineNumber!==e.endLineNumber||n.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:n.lineNumber,endColumn:n.column}:e}_validatePosition(e){if(!IK.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:n}=e,i=!1;if(t<1)t=1,n=1,i=!0;else if(t>this._lines.length)t=this._lines.length,n=this._lines[t-1].length+1,i=!0;else{let e=this._lines[t-1].length+1;n<1?(n=1,i=!0):n>e&&(n=e,i=!0)}return i?{lineNumber:t,column:n}:e}}class x1{constructor(e,t){this._host=e,this._models=Object.create(null),this._foreignModuleFactory=t,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(e){return this._models[e]}_getModels(){let e=[];return Object.keys(this._models).forEach((t=>e.push(this._models[t]))),e}acceptNewModel(e){this._models[e.url]=new S1(_K.parse(e.url),e.lines,e.EOL,e.versionId)}acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}acceptRemovedModel(e){this._models[e]&&delete this._models[e]}computeDiff(e,t,n,i){return C1(this,void 0,void 0,(function*(){const r=this._getModel(e),o=this._getModel(t);if(!r||!o)return null;const s=r.getLinesContent(),a=o.getLinesContent(),l=new s1(s,a,{shouldComputeCharChanges:!0,shouldPostProcessCharChanges:!0,shouldIgnoreTrimWhitespace:n,shouldMakePrettyDiff:!0,maxComputationTime:i}).computeDiff(),c=!(l.changes.length>0)&&this._modelsAreIdentical(r,o);return{quitEarly:l.quitEarly,identical:c,changes:l.changes}}))}_modelsAreIdentical(e,t){const n=e.getLineCount();if(n!==t.getLineCount())return!1;for(let i=1;i<=n;i++){if(e.getLineContent(i)!==t.getLineContent(i))return!1}return!0}computeMoreMinimalEdits(e,t){return C1(this,void 0,void 0,(function*(){const n=this._getModel(e);if(!n)return t;const i=[];let r;t=t.slice(0).sort(((e,t)=>{if(e.range&&t.range)return TK.compareRangesUsingStarts(e.range,t.range);return(e.range?0:1)-(t.range?0:1)}));for(let{range:e,text:o,eol:s}of t){if("number"==typeof s&&(r=s),TK.isEmpty(e)&&!o)continue;const t=n.getValueInRange(e);if(o=o.replace(/\r\n|\n|\r/g,n.eol),t===o)continue;if(Math.max(o.length,t.length)>x1._diffLimit){i.push({range:e,text:o});continue}const a=X0(t,o,!1),l=n.offsetAt(TK.lift(e).getStartPosition());for(const e of a){const t=n.positionAt(l+e.originalStart),r=n.positionAt(l+e.originalStart+e.originalLength),s={text:o.substr(e.modifiedStart,e.modifiedLength),range:{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:r.lineNumber,endColumn:r.column}};n.getValueInRange(s.range)!==s.text&&i.push(s)}}return"number"==typeof r&&i.push({eol:r,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),i}))}computeLinks(e){return C1(this,void 0,void 0,(function*(){let t=this._getModel(e);return t?function(e){return e&&"function"==typeof e.getLineCount&&"function"==typeof e.getLineContent?b1.computeLinks(e):[]}(t):null}))}textualSuggest(e,t,n,i){return C1(this,void 0,void 0,(function*(){const r=new CG(!0),o=new RegExp(n,i),s=new Set;e:for(let n of e){const e=this._getModel(n);if(e)for(let n of e.words(o))if(n!==t&&isNaN(Number(n))&&(s.add(n),s.size>x1._suggestionsLimit))break e}return{words:Array.from(s),duration:r.elapsed()}}))}computeWordRanges(e,t,n,i){return C1(this,void 0,void 0,(function*(){let r=this._getModel(e);if(!r)return Object.create(null);const o=new RegExp(n,i),s=Object.create(null);for(let e=t.startLineNumber;e<t.endLineNumber;e++){let t=r.getLineWords(e,o);for(const n of t){if(!isNaN(Number(n.word)))continue;let t=s[n.word];t||(t=[],s[n.word]=t),t.push({startLineNumber:e,startColumn:n.startColumn,endLineNumber:e,endColumn:n.endColumn})}}return s}))}navigateValueSet(e,t,n,i,r){return C1(this,void 0,void 0,(function*(){let o=this._getModel(e);if(!o)return null;let s=new RegExp(i,r);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});let a=o.getValueInRange(t),l=o.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},s);if(!l)return null;let c=o.getValueInRange(l);return w1.INSTANCE.navigateValueSet(t,a,l,c,n)}))}loadForeignModule(e,t,n){let i={host:jZ(n,((e,t)=>this._host.fhr(e,t))),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(i,t),Promise.resolve(HZ(this._foreignModule))):Promise.reject(new Error("Unexpected usage"))}fmr(e,t){if(!this._foreignModule||"function"!=typeof this._foreignModule[e])return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(zWe){return Promise.reject(zWe)}}}x1._diffLimit=1e5,x1._suggestionsLimit=1e4,"function"==typeof importScripts&&(nj.monaco=Qq());const E1=i$("textResourceConfigurationService"),k1=i$("textResourcePropertiesService");function L1(e,t=0){return e[e.length-(1+t)]}function D1(e,t,n=((e,t)=>e===t)){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(let i=0,r=e.length;i<r;i++)if(!n(e[i],t[i]))return!1;return!0}function N1(e,t,n){let i=0,r=e.length-1;for(;i<=r;){const o=(i+r)/2|0,s=n(e[o],t);if(s<0)i=o+1;else{if(!(s>0))return o;r=o-1}}return-(i+1)}function I1(e,t){let n=0,i=e.length;if(0===i)return 0;for(;n<i;){const r=Math.floor((n+i)/2);t(e[r])?i=r:n=r+1}return n}function T1(e,t,n){if((e|=0)>=t.length)throw new TypeError("invalid index");let i=t[Math.floor(t.length*Math.random())],r=[],o=[],s=[];for(let a of t){const e=n(a,i);e<0?r.push(a):e>0?o.push(a):s.push(a)}return e<r.length?T1(e,r,n):e<r.length+s.length?s[0]:T1(e-(r.length+s.length),o,n)}function M1(e,t){const n=[];let i;for(const r of e.slice(0).sort(t))i&&0===t(i[0],r)?i.push(r):(i=[r],n.push(i));return n}function A1(e){return e.filter((e=>!!e))}function O1(e){return!Array.isArray(e)||0===e.length}function R1(e){return Array.isArray(e)&&e.length>0}function P1(e,t){if(!t)return e.filter(((t,n)=>e.indexOf(t)===n));const n=Object.create(null);return e.filter((e=>{const i=t(e);return!n[i]&&(n[i]=!0,!0)}))}function F1(e){const t=new Set;return e.filter((e=>!t.has(e)&&(t.add(e),!0)))}function B1(e,t){return e.length>0?e[0]:t}function W1(e){return[].concat(...e)}function z1(e,t){let n="number"==typeof t?e:0;"number"==typeof t?n=e:(n=0,t=e);const i=[];if(n<=t)for(let r=n;r<t;r++)i.push(r);else for(let r=n;r>t;r--)i.push(r);return i}function V1(e,t,n){const i=e.slice(0,t),r=e.slice(t);return i.concat(n,r)}function U1(e,t){const n=e.indexOf(t);n>-1&&(e.splice(n,1),e.unshift(t))}function H1(e,t){const n=e.indexOf(t);n>-1&&(e.splice(n,1),e.push(t))}function j1(e){return Array.isArray(e)?e:[e]}class G1{constructor(e){this.items=e,this.firstIdx=0,this.lastIdx=this.items.length-1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const n=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,n}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const n=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,n}}const K1=i$("logService");var q1,$1;($1=q1||(q1={}))[$1.Trace=0]="Trace",$1[$1.Debug=1]="Debug",$1[$1.Info=2]="Info",$1[$1.Warning=3]="Warning",$1[$1.Error=4]="Error",$1[$1.Critical=5]="Critical",$1[$1.Off=6]="Off";const Y1=q1.Info;class X1 extends mG{constructor(){super(...arguments),this.level=Y1,this._onDidChangeLogLevel=this._register(new EG)}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}}class Z1 extends X1{constructor(e=Y1){super(),this.setLevel(e)}trace(e,...t){this.getLevel()<=q1.Trace&&console.log("%cTRACE","color: #888",e,...t)}debug(e,...t){this.getLevel()<=q1.Debug&&console.log("%cDEBUG","background: #eee; color: #888",e,...t)}info(e,...t){this.getLevel()<=q1.Info&&console.log("%c INFO","color: #33f",e,...t)}error(e,...t){this.getLevel()<=q1.Error&&console.log("%c  ERR","color: #f33",e,...t)}dispose(){}}class Q1 extends mG{constructor(e){super(),this.logger=e,this._register(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}error(e,...t){this.logger.error(e,...t)}}var J1=function(e,t){return function(n,i){t(n,i,e)}},e2=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function t2(e,t){let n=e.getModel(t);return!!n&&!n.isTooLargeForSyncing()}let n2=class extends mG{constructor(e,t,n){super(),this._modelService=e,this._workerManager=this._register(new r2(this._modelService)),this._logService=n,this._register(HJ.register("*",{provideLinks:(e,t)=>t2(this._modelService,e.uri)?this._workerManager.withWorker().then((t=>t.computeLinks(e.uri))).then((e=>e&&{links:e})):Promise.resolve({links:[]})})),this._register(kJ.register("*",new i2(this._workerManager,t,this._modelService)))}dispose(){super.dispose()}canComputeDiff(e,t){return t2(this._modelService,e)&&t2(this._modelService,t)}computeDiff(e,t,n,i){return this._workerManager.withWorker().then((r=>r.computeDiff(e,t,n,i)))}computeMoreMinimalEdits(e,t){if(R1(t)){if(!t2(this._modelService,e))return Promise.resolve(t);const n=CG.create(!0),i=this._workerManager.withWorker().then((n=>n.computeMoreMinimalEdits(e,t)));return i.finally((()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),n.elapsed()))),Promise.race([i,R$(1e3).then((()=>t))])}return Promise.resolve(void 0)}canNavigateValueSet(e){return t2(this._modelService,e)}navigateValueSet(e,t,n){return this._workerManager.withWorker().then((i=>i.navigateValueSet(e,t,n)))}canComputeWordRanges(e){return t2(this._modelService,e)}computeWordRanges(e,t){return this._workerManager.withWorker().then((n=>n.computeWordRanges(e,t)))}};n2=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([J1(0,iJ),J1(1,E1),J1(2,K1)],n2);class i2{constructor(e,t,n){this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=n}provideCompletionItems(e,t){return e2(this,void 0,void 0,(function*(){const n=this._configurationService.getValue(e.uri,t,"editor");if(!n.wordBasedSuggestions)return;const i=[];if("currentDocument"===n.wordBasedSuggestionsMode)t2(this._modelService,e.uri)&&i.push(e.uri);else for(const t of this._modelService.getModels())t2(this._modelService,t.uri)&&(t===e?i.unshift(t.uri):"allDocuments"!==n.wordBasedSuggestionsMode&&t.getLanguageIdentifier().id!==e.getLanguageIdentifier().id||i.push(t.uri));if(0===i.length)return;const r=q0.getWordDefinition(e.getLanguageIdentifier().id),o=e.getWordAtPosition(t),s=o?new TK(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):TK.fromPositions(t),a=s.setEndPosition(t.lineNumber,t.column),l=yield this._workerManager.withWorker(),c=yield l.textualSuggest(i,null==o?void 0:o.word,r);return c?{duration:c.duration,suggestions:c.words.map((e=>({kind:18,label:e,insertText:e,range:{insert:a,replace:s}})))}:void 0}))}}class r2 extends mG{constructor(e){super(),this._modelService=e,this._editorWorkerClient=null,this._lastWorkerUsedTime=(new Date).getTime(),this._register(new W$).cancelAndSet((()=>this._checkStopIdleWorker()),Math.round(15e4)),this._register(this._modelService.onModelRemoved((e=>this._checkStopEmptyWorker())))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;0===this._modelService.getModels().length&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;(new Date).getTime()-this._lastWorkerUsedTime>3e5&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=(new Date).getTime(),this._editorWorkerClient||(this._editorWorkerClient=new l2(this._modelService,!1,"editorWorkerService")),Promise.resolve(this._editorWorkerClient)}}class o2 extends mG{constructor(e,t,n){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!n){let e=new W$;e.cancelAndSet((()=>this._checkStopModelSync()),Math.round(3e4)),this._register(e)}}dispose(){for(let e in this._syncedModels)dG(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e){for(const t of e){let e=t.toString();this._syncedModels[e]||this._beginModelSync(t),this._syncedModels[e]&&(this._syncedModelsLastUsedTime[e]=(new Date).getTime())}}_checkStopModelSync(){let e=(new Date).getTime(),t=[];for(let n in this._syncedModelsLastUsedTime){e-this._syncedModelsLastUsedTime[n]>6e4&&t.push(n)}for(const n of t)this._stopModelSync(n)}_beginModelSync(e){let t=this._modelService.getModel(e);if(!t)return;if(t.isTooLargeForSyncing())return;let n=e.toString();this._proxy.acceptNewModel({url:t.uri.toString(),lines:t.getLinesContent(),EOL:t.getEOL(),versionId:t.getVersionId()});const i=new pG;i.add(t.onDidChangeContent((e=>{this._proxy.acceptModelChanged(n.toString(),e)}))),i.add(t.onWillDispose((()=>{this._stopModelSync(n)}))),i.add(gG((()=>{this._proxy.acceptRemovedModel(n)}))),this._syncedModels[n]=i}_stopModelSync(e){let t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],dG(t)}}class s2{constructor(e){this._instance=e,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class a2{constructor(e){this._workerClient=e}fhr(e,t){return this._workerClient.fhr(e,t)}}class l2 extends mG{constructor(e,t,n){super(),this._disposed=!1,this._modelService=e,this._keepIdleModels=t,this._workerFactory=new u0(n),this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new s0(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new a2(this)))}catch(e){r0(e),this._worker=new s2(new x1(new a2(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,(e=>(r0(e),this._worker=new s2(new x1(new a2(this),null)),this._getOrCreateWorker().getProxyObject())))}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new o2(e,this._modelService,this._keepIdleModels))),this._modelManager}_withSyncedResources(e){return this._disposed?Promise.reject(sG()):this._getProxy().then((t=>(this._getOrCreateModelManager(t).ensureSyncedResources(e),t)))}computeDiff(e,t,n,i){return this._withSyncedResources([e,t]).then((r=>r.computeDiff(e.toString(),t.toString(),n,i)))}computeMoreMinimalEdits(e,t){return this._withSyncedResources([e]).then((n=>n.computeMoreMinimalEdits(e.toString(),t)))}computeLinks(e){return this._withSyncedResources([e]).then((t=>t.computeLinks(e.toString())))}textualSuggest(e,t,n){return e2(this,void 0,void 0,(function*(){const i=yield this._withSyncedResources(e),r=n.source,o=cX(n);return i.textualSuggest(e.map((e=>e.toString())),t,r,o)}))}computeWordRanges(e,t){return this._withSyncedResources([e]).then((n=>{let i=this._modelService.getModel(e);if(!i)return Promise.resolve(null);let r=q0.getWordDefinition(i.getLanguageIdentifier().id),o=r.source,s=cX(r);return n.computeWordRanges(e.toString(),t,o,s)}))}navigateValueSet(e,t,n){return this._withSyncedResources([e]).then((i=>{let r=this._modelService.getModel(e);if(!r)return null;let o=q0.getWordDefinition(r.getLanguageIdentifier().id),s=o.source,a=cX(o);return i.navigateValueSet(e.toString(),t,n,s,a)}))}dispose(){super.dispose(),this._disposed=!0}}class c2 extends l2{constructor(e,t){super(e,t.keepIdleModels||!1,t.label),this._foreignModuleId=t.moduleId,this._foreignModuleCreateData=t.createData||null,this._foreignModuleHost=t.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||"function"!=typeof this._foreignModuleHost[e])return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(zWe){return Promise.reject(zWe)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then((e=>{const t=this._foreignModuleHost?HZ(this._foreignModuleHost):[];return e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then((t=>{this._foreignModuleCreateData=null;const n=(t,n)=>e.fmr(t,n),i=(e,t)=>function(){const n=Array.prototype.slice.call(arguments,0);return t(e,n)};let r={};for(const e of t)r[e]=i(e,n);return r}))}))),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then((e=>this.getProxy()))}}class u2{constructor(e,t){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t}static createEmpty(e){const t=u2.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=t,new u2(n,e)}equals(e){return e instanceof u2&&this.slicedEquals(e,0,this._tokensCount)}slicedEquals(e,t,n){if(this._text!==e._text)return!1;if(this._tokensCount!==e._tokensCount)return!1;const i=t<<1,r=i+(n<<1);for(let o=i;o<r;o++)if(this._tokens[o]!==e._tokens[o])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[1+(e<<1)]}getLanguageId(e){const t=this._tokens[1+(e<<1)];return pJ.getLanguageId(t)}getStandardTokenType(e){const t=this._tokens[1+(e<<1)];return pJ.getTokenType(t)}getForeground(e){const t=this._tokens[1+(e<<1)];return pJ.getForeground(t)}getClassName(e){const t=this._tokens[1+(e<<1)];return pJ.getClassNameFromMetadata(t)}getInlineStyle(e,t){const n=this._tokens[1+(e<<1)];return pJ.getInlineStyleFromMetadata(n,t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return u2.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,n){return new h2(this,e,t,n)}static convertToEndOffset(e,t){const n=(e.length>>>1)-1;for(let i=0;i<n;i++)e[i<<1]=e[i+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let n=0,i=(e.length>>>1)-1;for(;n<i;){const r=n+Math.floor((i-n)/2),o=e[r<<1];if(o===t)return r+1;o<t?n=r+1:o>t&&(i=r)}return n}withInserted(e){if(0===e.length)return this;let t=0,n=0,i="";const r=new Array;let o=0;for(;;){let s=t<this._tokensCount?this._tokens[t<<1]:-1,a=n<e.length?e[n]:null;if(-1!==s&&(null===a||s<=a.offset)){i+=this._text.substring(o,s);const e=this._tokens[1+(t<<1)];r.push(i.length,e),t++,o=s}else{if(!a)break;if(a.offset>o){i+=this._text.substring(o,a.offset);const e=this._tokens[1+(t<<1)];r.push(i.length,e),o=a.offset}i+=a.text,r.push(i.length,a.tokenMetadata),n++}}return new u2(new Uint32Array(r),i)}}u2.defaultTokenMetadata=16793600;class h2{constructor(e,t,n,i){this._source=e,this._startOffset=t,this._endOffset=n,this._deltaOffset=i,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this._tokensCount=0;for(let r=this._firstTokenIndex,o=e.getCount();r<o;r++){if(e.getStartOffset(r)>=n)break;this._tokensCount++}}equals(e){return e instanceof h2&&(this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount))}getCount(){return this._tokensCount}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}class d2{constructor(e,t,n,i){this.startColumn=e,this.endColumn=t,this.className=n,this.type=i,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(!d2._equals(e[i],t[i]))return!1;return!0}static extractWrapped(e,t,n){if(0===e.length)return e;const i=t+1,r=n+1,o=n-t,s=[];let a=0;for(const l of e)l.endColumn<=i||l.startColumn>=r||(s[a++]=new d2(Math.max(1,l.startColumn-i+1),Math.min(o+1,l.endColumn-i+1),l.className,l.type));return s}static filter(e,t,n,i){if(0===e.length)return[];let r=[],o=0;for(let s=0,a=e.length;s<a;s++){const a=e[s],l=a.range;if(l.endLineNumber<t||l.startLineNumber>t)continue;if(l.isEmpty()&&(0===a.type||3===a.type))continue;const c=l.startLineNumber===t?l.startColumn:n,u=l.endLineNumber===t?l.endColumn:i;r[o++]=new d2(c,u,a.inlineClassName,a.type)}return r}static _typeCompare(e,t){const n=[2,0,1,3];return n[e]-n[t]}static compare(e,t){if(e.startColumn===t.startColumn){if(e.endColumn===t.endColumn){const n=d2._typeCompare(e.type,t.type);return 0===n?e.className<t.className?-1:e.className>t.className?1:0:n}return e.endColumn-t.endColumn}return e.startColumn-t.startColumn}}class f2{constructor(e,t,n,i){this.startOffset=e,this.endOffset=t,this.className=n,this.metadata=i}}class g2{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let n=0,i=e.length;n<i;n++)t|=e[n];return t}consumeLowerThan(e,t,n){for(;this.count>0&&this.stopOffsets[0]<e;){let e=0;for(;e+1<this.count&&this.stopOffsets[e]===this.stopOffsets[e+1];)e++;n.push(new f2(t,this.stopOffsets[e],this.classNames.join(" "),g2._metadata(this.metadata))),t=this.stopOffsets[e]+1,this.stopOffsets.splice(0,e+1),this.classNames.splice(0,e+1),this.metadata.splice(0,e+1),this.count-=e+1}return this.count>0&&t<e&&(n.push(new f2(t,e-1,this.classNames.join(" "),g2._metadata(this.metadata))),t=e),t}insert(e,t,n){if(0===this.count||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(n);else for(let i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t),this.metadata.splice(i,0,n);break}this.count++}}class p2{constructor(e,t,n){this._linePartBrand=void 0,this.endIndex=e,this.type=t,this.metadata=n}isWhitespace(){return!!(1&this.metadata)}isPseudoAfter(){return!!(4&this.metadata)}}class m2{constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}}class v2{constructor(e,t,n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v,y){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.continuesWithWrappedLine=i,this.isBasicASCII=r,this.containsRTL=o,this.fauxIndentLength=s,this.lineTokens=a,this.lineDecorations=l.sort(d2.compare),this.tabSize=c,this.startVisibleColumn=u,this.spaceWidth=h,this.stopRenderingLineAfter=g,this.renderWhitespace="all"===p?4:"boundary"===p?1:"selection"===p?2:"trailing"===p?3:0,this.renderControlCharacters=m,this.fontLigatures=v,this.selectionsOnLine=y&&y.sort(((e,t)=>e.startOffset<t.startOffset?-1:1));Math.abs(f-h)<Math.abs(d-h)?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=d,this.renderSpaceCharCode=183)}sameSelection(e){if(null===this.selectionsOnLine)return null===e;if(null===e)return!1;if(e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&d2.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}}class y2{constructor(e,t){this.partIndex=e,this.charIndex=t}}class _2{constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._absoluteOffsets=new Uint32Array(this.length)}static getPartIndex(e){return(4294901760&e)>>>16}static getCharIndex(e){return(65535&e)>>>0}setColumnInfo(e,t,n,i){const r=(t<<16|n<<0)>>>0;this._data[e-1]=r,this._absoluteOffsets[e-1]=i+n}getAbsoluteOffset(e){return 0===this._absoluteOffsets.length?0:this._absoluteOffsets[e-1]}charOffsetToPartData(e){return 0===this.length?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),n=_2.getPartIndex(t),i=_2.getCharIndex(t);return new y2(n,i)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,n){if(0===this.length)return 0;let i=(e<<16|n<<0)>>>0,r=0,o=this.length-1;for(;r+1<o;){let e=r+o>>>1,t=this._data[e];if(t===i)return e;t>i?o=e:r=e}if(r===o)return r;let s=this._data[r],a=this._data[o];if(s===i)return r;if(a===i)return o;let l,c=_2.getPartIndex(s),u=_2.getCharIndex(s);return l=c!==_2.getPartIndex(a)?t:_2.getCharIndex(a),n-u<=l-n?r:o}}class b2{constructor(e,t,n){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=n}}function w2(e,t){if(0===e.lineContent.length){if(e.lineDecorations.length>0){t.appendASCIIString("<span>");let n=0,i=0,r=0;for(const s of e.lineDecorations)1!==s.type&&2!==s.type||(t.appendASCIIString('<span class="'),t.appendASCIIString(s.className),t.appendASCIIString('"></span>'),1===s.type&&(r|=1,n++),2===s.type&&(r|=2,i++));t.appendASCIIString("</span>");const o=new _2(1,n+i);return o.setColumnInfo(1,n,0,0),new b2(o,!1,r)}return t.appendASCIIString("<span><span></span></span>"),new b2(new _2(0,0),!1,0)}return function(e,t){const n=e.fontIsMonospace,i=e.canUseHalfwidthRightwardsArrow,r=e.containsForeignElements,o=e.lineContent,s=e.len,a=e.isOverflowing,l=e.parts,c=e.fauxIndentLength,u=e.tabSize,h=e.startVisibleColumn,d=e.containsRTL,f=e.spaceWidth,g=e.renderSpaceCharCode,p=e.renderWhitespace,m=e.renderControlCharacters,v=new _2(s+1,l.length);let y=!1,_=0,b=h,w=0,C=0,S=0,x=0;d?t.appendASCIIString('<span dir="ltr">'):t.appendASCIIString("<span>");for(let E=0,k=l.length;E<k;E++){x+=S;const e=l[E],a=e.endIndex,h=e.type,d=0!==p&&e.isWhitespace(),k=d&&!n&&("mtkw"===h||!r),L=_===a&&e.isPseudoAfter();if(w=0,t.appendASCIIString('<span class="'),t.appendASCIIString(k?"mtkz":h),t.appendASCII(34),d){let e=0;{let t=_,n=b;for(;t<a;t++){const i=0|(9===o.charCodeAt(t)?u-n%u:1);e+=i,t>=c&&(n+=i)}}for(k&&(t.appendASCIIString(' style="width:'),t.appendASCIIString(String(f*e)),t.appendASCIIString('px"')),t.appendASCII(62);_<a;_++){v.setColumnInfo(_+1,E-C,w,x),C=0;let e;if(9===o.charCodeAt(_)){e=u-b%u|0,!i||e>1?t.write1(8594):t.write1(65515);for(let n=2;n<=e;n++)t.write1(160)}else e=1,t.write1(g);w+=e,_>=c&&(b+=e)}S=e}else{let e=0;for(t.appendASCII(62);_<a;_++){v.setColumnInfo(_+1,E-C,w,x),C=0;const n=o.charCodeAt(_);let i=1,r=1;switch(n){case 9:i=u-b%u,r=i;for(let e=1;e<=i;e++)t.write1(160);break;case 32:t.write1(160);break;case 60:t.appendASCIIString("&lt;");break;case 62:t.appendASCIIString("&gt;");break;case 38:t.appendASCIIString("&amp;");break;case 0:m?t.write1(9216):t.appendASCIIString("&#00;");break;case 65279:case 8232:case 8233:case 133:t.write1(65533);break;default:WX(n)&&r++,m&&n<32?t.write1(9216+n):m&&127===n?t.write1(9249):t.write1(n)}w+=i,e+=i,_>=c&&(b+=r)}S=e}L?C++:C=0,_>=s&&!y&&e.isPseudoAfter()&&(y=!0,v.setColumnInfo(_+1,E,w,x)),t.appendASCIIString("</span>")}y||v.setColumnInfo(s+1,l.length-1,w,x);a&&t.appendASCIIString("<span>&hellip;</span>");return t.appendASCIIString("</span>"),new b2(v,d,r)}(function(e){const t=e.lineContent;let n,i;-1!==e.stopRenderingLineAfter&&e.stopRenderingLineAfter<t.length?(n=!0,i=e.stopRenderingLineAfter):(n=!1,i=t.length);let r=function(e,t,n){let i=[],r=0;t>0&&(i[r++]=new p2(t,"",0));for(let o=0,s=e.getCount();o<s;o++){const s=e.getEndOffset(o);if(s<=t)continue;const a=e.getClassName(o);if(s>=n){i[r++]=new p2(n,a,0);break}i[r++]=new p2(s,a,0)}return i}(e.lineTokens,e.fauxIndentLength,i);(4===e.renderWhitespace||1===e.renderWhitespace||2===e.renderWhitespace&&e.selectionsOnLine||3===e.renderWhitespace)&&(r=function(e,t,n,i){const r=e.continuesWithWrappedLine,o=e.fauxIndentLength,s=e.tabSize,a=e.startVisibleColumn,l=e.useMonospaceOptimizations,c=e.selectionsOnLine,u=1===e.renderWhitespace,h=3===e.renderWhitespace,d=e.renderSpaceWidth!==e.spaceWidth;let f=[],g=0,p=0,m=i[p].type,v=i[p].endIndex;const y=i.length;let _,b=!1,w=hX(t);-1===w?(b=!0,w=n,_=n):_=fX(t);let C=!1,S=0,x=c&&c[S],E=a%s;for(let L=o;L<n;L++){const e=t.charCodeAt(L);let r;if(x&&L>=x.endOffset&&(S++,x=c&&c[S]),L<w||L>_)r=!0;else if(9===e)r=!0;else if(32===e)if(u)if(C)r=!0;else{const e=L+1<n?t.charCodeAt(L+1):0;r=32===e||9===e}else r=!0;else r=!1;if(r&&c&&(r=!!x&&x.startOffset<=L&&x.endOffset>L),r&&h&&(r=b||L>_),C){if(!r||!l&&E>=s){if(d){for(let e=(g>0?f[g-1].endIndex:o)+1;e<=L;e++)f[g++]=new p2(e,"mtkw",1)}else f[g++]=new p2(L,"mtkw",1);E%=s}}else(L===v||r&&L>o)&&(f[g++]=new p2(L,m,0),E%=s);for(9===e?E=s:WX(e)?E+=2:E++,C=r;L===v&&(p++,p<y);)m=i[p].type,v=i[p].endIndex}let k=!1;if(C)if(r&&u){let e=n>0?t.charCodeAt(n-1):0,i=n>1?t.charCodeAt(n-2):0;32===e&&32!==i&&9!==i||(k=!0)}else k=!0;if(k)if(d){for(let e=(g>0?f[g-1].endIndex:o)+1;e<=n;e++)f[g++]=new p2(e,"mtkw",1)}else f[g++]=new p2(n,"mtkw",1);else f[g++]=new p2(n,m,0);return f}(e,t,i,r));let o=0;if(e.lineDecorations.length>0){for(let t=0,n=e.lineDecorations.length;t<n;t++){const n=e.lineDecorations[t];3===n.type||1===n.type?o|=1:2===n.type&&(o|=2)}r=function(e,t,n,i){i.sort(d2.compare);const r=class{static normalize(e,t){if(0===t.length)return[];let n=[];const i=new g2;let r=0;for(let o=0,s=t.length;o<s;o++){const s=t[o];let a=s.startColumn,l=s.endColumn;const c=s.className,u=1===s.type?2:2===s.type?4:0;a>1&&kX(e.charCodeAt(a-2))&&a--,l>1&&kX(e.charCodeAt(l-2))&&l--;const h=a-1,d=l-2;r=i.consumeLowerThan(h,r,n),0===i.count&&(r=h),i.insert(d,c,u)}return i.consumeLowerThan(1073741824,r,n),n}}.normalize(e,i),o=r.length;let s=0,a=[],l=0,c=0;for(let h=0,d=n.length;h<d;h++){const e=n[h],t=e.endIndex,i=e.type,u=e.metadata;for(;s<o&&r[s].startOffset<t;){const e=r[s];if(e.startOffset>c&&(c=e.startOffset,a[l++]=new p2(c,i,u)),!(e.endOffset+1<=t)){c=t,a[l++]=new p2(c,i+" "+e.className,u|e.metadata);break}c=e.endOffset+1,a[l++]=new p2(c,i+" "+e.className,u|e.metadata),s++}t>c&&(c=t,a[l++]=new p2(c,i,u))}const u=n[n.length-1].endIndex;if(s<o&&r[s].startOffset===u)for(;s<o&&r[s].startOffset===u;){const e=r[s];a[l++]=new p2(c,e.className,e.metadata),s++}return a}(t,0,r,e.lineDecorations)}e.containsRTL||(r=function(e,t,n){let i=0,r=[],o=0;if(n)for(let s=0,a=t.length;s<a;s++){const n=t[s],a=n.endIndex;if(i+50<a){const t=n.type,s=n.metadata;let l=-1,c=i;for(let n=i;n<a;n++)32===e.charCodeAt(n)&&(l=n),-1!==l&&n-c>=50&&(r[o++]=new p2(l+1,t,s),c=l+1,l=-1);c!==a&&(r[o++]=new p2(a,t,s))}else r[o++]=n;i=a}else for(let s=0,a=t.length;s<a;s++){const e=t[s],n=e.endIndex;let a=n-i;if(a>50){const t=e.type,s=e.metadata,l=Math.ceil(a/50);for(let e=1;e<l;e++){let n=i+50*e;r[o++]=new p2(n,t,s)}r[o++]=new p2(n,t,s)}else r[o++]=e;i=n}return r}(t,r,!e.isBasicASCII||e.fontLigatures));return new x2(e.useMonospaceOptimizations,e.canUseHalfwidthRightwardsArrow,t,i,n,r,o,e.fauxIndentLength,e.tabSize,e.startVisibleColumn,e.containsRTL,e.spaceWidth,e.renderSpaceCharCode,e.renderWhitespace,e.renderControlCharacters)}(e),t)}class C2{constructor(e,t,n,i){this.characterMapping=e,this.html=t,this.containsRTL=n,this.containsForeignElements=i}}function S2(e){let t=E0(1e4),n=w2(e,t);return new C2(n.characterMapping,t.build(),n.containsRTL,n.containsForeignElements)}class x2{constructor(e,t,n,i,r,o,s,a,l,c,u,h,d,f,g){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=n,this.len=i,this.isOverflowing=r,this.parts=o,this.containsForeignElements=s,this.fauxIndentLength=a,this.tabSize=l,this.startVisibleColumn=c,this.containsRTL=u,this.spaceWidth=h,this.renderSpaceCharCode=d,this.renderWhitespace=f,this.renderControlCharacters=g}}class E2{constructor(e,t,n,i){this._viewportBrand=void 0,this.top=0|e,this.left=0|t,this.width=0|n,this.height=0|i}}class k2{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}}class L2{constructor(e,t,n,i,r){this.breakOffsets=e,this.breakOffsetsVisibleColumn=t,this.wrappedTextIndentLength=n,this.injectionTexts=i,this.injectionOffsets=r}getInputOffsetOfOutputPosition(e,t){let n=0;if(n=0===e?t:this.breakOffsets[e-1]+t,null!==this.injectionOffsets)for(let i=0;i<this.injectionOffsets.length&&n>this.injectionOffsets[i];i++)n<this.injectionOffsets[i]+this.injectionTexts[i].length?n=this.injectionOffsets[i]:n-=this.injectionTexts[i].length;return n}getOutputPositionOfInputOffset(e){let t=0;if(null!==this.injectionOffsets)for(let s=0;s<this.injectionOffsets.length&&!(e<this.injectionOffsets[s]);s++)t+=this.injectionTexts[s].length;e+=t;let n=0,i=this.breakOffsets.length-1,r=0,o=0;for(;n<=i;){r=n+(i-n)/2|0;const t=this.breakOffsets[r];if(o=r>0?this.breakOffsets[r-1]:0,e<o)i=r-1;else{if(!(e>=t))break;n=r+1}}return new k2(r,e-o)}}class D2{constructor(e,t){this.tabSize=e,this.data=t}}class N2{constructor(e,t,n,i,r,o){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=n,this.maxColumn=i,this.startVisibleColumn=r,this.tokens=o}}class I2{constructor(e,t,n,i,r,o,s,a,l,c){this.minColumn=e,this.maxColumn=t,this.content=n,this.continuesWithWrappedLine=i,this.isBasicASCII=I2.isBasicASCII(n,o),this.containsRTL=I2.containsRTL(n,this.isBasicASCII,r),this.tokens=s,this.inlineDecorations=a,this.tabSize=l,this.startVisibleColumn=c}static isBasicASCII(e,t){return!t||PX(e)}static containsRTL(e,t,n){return!(t||!n)&&AX(e)}}class T2{constructor(e,t,n){this.range=e,this.inlineClassName=t,this.type=n}}class M2{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}function A2(e){return!function(e){return Array.isArray(e)}(e)}function O2(e){return"string"==typeof e}function R2(e){return!O2(e)}function P2(e){return!e}function F2(e,t){return e.ignoreCase&&t?t.toLowerCase():t}function B2(e){return e.replace(/[&<>'"_]/g,"-")}function W2(e,t){return new Error(`${e.languageId}: ${t}`)}function z2(e,t,n,i,r){let o=null;return t.replace(/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g,(function(t,s,a,l,c,u,h,d,f){return P2(a)?P2(l)?!P2(c)&&c<i.length?F2(e,i[c]):!P2(h)&&e&&"string"==typeof e[h]?e[h]:(null===o&&(o=r.split("."),o.unshift(r)),!P2(u)&&u<o.length?F2(e,o[u]):""):F2(e,n):"$"}))}function V2(e,t){let n=t;for(;n&&n.length>0;){const t=e.tokenizer[n];if(t)return t;const i=n.lastIndexOf(".");n=i<0?null:n.substr(0,i)}return null}class U2{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(null!==e&&e.depth>=this._maxCacheDepth)return new H2(e,t);let n=H2.getStackElementId(e);n.length>0&&(n+="|"),n+=t;let i=this._entries[n];return i||(i=new H2(e,t),this._entries[n]=i,i)}}U2._INSTANCE=new U2(5);class H2{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;null!==e;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;null!==e&&null!==t;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return null===e&&null===t}equals(e){return H2._equals(this,e)}push(e){return U2.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return U2.create(this.parent,e)}}class j2{constructor(e,t){this.modeId=e,this.state=t}equals(e){return this.modeId===e.modeId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new j2(this.modeId,this.state)}}class G2{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(null!==t)return new K2(e,t);if(null!==e&&e.depth>=this._maxCacheDepth)return new K2(e,t);let n=H2.getStackElementId(e),i=this._entries[n];return i||(i=new K2(e,null),this._entries[n]=i,i)}}G2._INSTANCE=new G2(5);class K2{constructor(e,t){this.stack=e,this.embeddedModeData=t}clone(){return(this.embeddedModeData?this.embeddedModeData.clone():null)===this.embeddedModeData?this:G2.create(this.stack,this.embeddedModeData)}equals(e){return e instanceof K2&&(!!this.stack.equals(e.stack)&&(null===this.embeddedModeData&&null===e.embeddedModeData||null!==this.embeddedModeData&&null!==e.embeddedModeData&&this.embeddedModeData.equals(e.embeddedModeData)))}}class q2{constructor(){this._tokens=[],this._language=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterMode(e,t){this._language=t}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._language||(this._lastTokenType=t,this._lastTokenLanguage=this._language,this._tokens.push(new AK(e,t,this._language)))}nestedModeTokenize(e,t,n,i){const r=n.modeId,o=n.state,s=YJ.get(r);if(!s)return this.enterMode(i,r),this.emit(i,""),o;let a=s.tokenize(e,t,o,i);return this._tokens=this._tokens.concat(a.tokens),this._lastTokenType=null,this._lastTokenLanguage=null,this._language=null,a.endState}finalize(e){return new OK(this._tokens,e)}}class $2{constructor(e,t){this._modeService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterMode(e,t){this._currentLanguageId=this._modeService.getLanguageIdentifier(t).id}emit(e,t){let n=this._theme.match(this._currentLanguageId,t);this._lastTokenMetadata!==n&&(this._lastTokenMetadata=n,this._tokens.push(e),this._tokens.push(n))}static _merge(e,t,n){let i=null!==e?e.length:0,r=t.length,o=null!==n?n.length:0;if(0===i&&0===r&&0===o)return new Uint32Array(0);if(0===i&&0===r)return n;if(0===r&&0===o)return e;let s=new Uint32Array(i+r+o);null!==e&&s.set(e);for(let a=0;a<r;a++)s[i+a]=t[a];return null!==n&&s.set(n,i+r),s}nestedModeTokenize(e,t,n,i){const r=n.modeId,o=n.state,s=YJ.get(r);if(!s)return this.enterMode(i,r),this.emit(i,""),o;let a=s.tokenize2(e,t,o,i);return this._prependTokens=$2._merge(this._prependTokens,this._tokens,a.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,a.endState}finalize(e){return new RK($2._merge(this._prependTokens,this._tokens,null),e)}}class Y2{constructor(e,t,n,i){this._modeService=e,this._standaloneThemeService=t,this._modeId=n,this._lexer=i,this._embeddedModes=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let r=!1;this._tokenizationRegistryListener=YJ.onDidChange((e=>{if(r)return;let t=!1;for(let n=0,i=e.changedLanguages.length;n<i;n++){let i=e.changedLanguages[n];if(this._embeddedModes[i]){t=!0;break}}t&&(r=!0,YJ.fire([this._modeId]),r=!1)}))}dispose(){this._tokenizationRegistryListener.dispose()}getLoadStatus(){let e=[];for(let t in this._embeddedModes){const n=YJ.get(t);if(n){if(n instanceof Y2){const t=n.getLoadStatus();!1===t.loaded&&e.push(t.promise)}continue}const i=YJ.getPromise(t);i&&e.push(i)}return 0===e.length?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then((e=>{}))}}getInitialState(){let e=U2.create(null,this._lexer.start);return G2.create(e,null)}tokenize(e,t,n,i){let r=new q2,o=this._tokenize(e,t,n,i,r);return r.finalize(o)}tokenize2(e,t,n,i){let r=new $2(this._modeService,this._standaloneThemeService.getColorTheme().tokenTheme),o=this._tokenize(e,t,n,i,r);return r.finalize(o)}_tokenize(e,t,n,i,r){return n.embeddedModeData?this._nestedTokenize(e,t,n,i,r):this._myTokenize(e,t,n,i,r)}_findLeavingNestedModeOffset(e,t){let n=this._lexer.tokenizer[t.stack.state];if(!n&&(n=V2(this._lexer,t.stack.state),!n))throw W2(this._lexer,"tokenizer state is not defined: "+t.stack.state);let i=-1,r=!1;for(const o of n){if(!R2(o.action)||"@pop"!==o.action.nextEmbedded)continue;r=!0;let t=o.regex,n=o.regex.source;if("^(?:"===n.substr(0,4)&&")"===n.substr(n.length-1,1)){let e=(t.ignoreCase?"i":"")+(t.unicode?"u":"");t=new RegExp(n.substr(4,n.length-5),e)}let s=e.search(t);-1===s||0!==s&&o.matchOnlyAtLineStart||(-1===i||s<i)&&(i=s)}if(!r)throw W2(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return i}_nestedTokenize(e,t,n,i,r){let o=this._findLeavingNestedModeOffset(e,n);if(-1===o){let o=r.nestedModeTokenize(e,t,n.embeddedModeData,i);return G2.create(n.stack,new j2(n.embeddedModeData.modeId,o))}let s=e.substring(0,o);s.length>0&&r.nestedModeTokenize(s,!1,n.embeddedModeData,i);let a=e.substring(o);return this._myTokenize(a,t,n,i+o,r)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,n,i,r){r.enterMode(i,this._modeId);const o=e.length,s=t&&this._lexer.includeLF?e+"\n":e,a=s.length;let l=n.embeddedModeData,c=n.stack,u=0,h=null,d=!0;for(;d||u<a;){const n=u,p=c.depth,m=h?h.groups.length:0,v=c.state;let y=null,_=null,b=null,w=null,C=null;if(h){y=h.matches;const e=h.groups.shift();_=e.matched,b=e.action,w=h.rule,0===h.groups.length&&(h=null)}else{if(!d&&u>=a)break;d=!1;let e=this._lexer.tokenizer[v];if(!e&&(e=V2(this._lexer,v),!e))throw W2(this._lexer,"tokenizer state is not defined: "+v);let t=s.substr(u);for(const n of e)if((0===u||!n.matchOnlyAtLineStart)&&(y=t.match(n.regex),y)){_=y[0],b=n.action;break}}if(y||(y=[""],_=""),b||(u<a&&(y=[s.charAt(u)],_=y[0]),b=this._lexer.defaultToken),null===_)break;for(u+=_.length;A2(b)&&R2(b)&&b.test;)b=b.test(_,y,v,u===a);let S=null;if("string"==typeof b||Array.isArray(b))S=b;else if(b.group)S=b.group;else if(null!==b.token&&void 0!==b.token){if(S=b.tokenSubst?z2(this._lexer,b.token,_,y,v):b.token,b.nextEmbedded)if("@pop"===b.nextEmbedded){if(!l)throw W2(this._lexer,"cannot pop embedded mode if not inside one");l=null}else{if(l)throw W2(this._lexer,"cannot enter embedded mode from within an embedded mode");C=z2(this._lexer,b.nextEmbedded,_,y,v)}if(b.goBack&&(u=Math.max(0,u-b.goBack)),b.switchTo&&"string"==typeof b.switchTo){let e=z2(this._lexer,b.switchTo,_,y,v);if("@"===e[0]&&(e=e.substr(1)),!V2(this._lexer,e))throw W2(this._lexer,"trying to switch to a state '"+e+"' that is undefined in rule: "+this._safeRuleName(w));c=c.switchTo(e)}else{if(b.transform&&"function"==typeof b.transform)throw W2(this._lexer,"action.transform not supported");if(b.next)if("@push"===b.next){if(c.depth>=this._lexer.maxStack)throw W2(this._lexer,"maximum tokenizer stack size reached: ["+c.state+","+c.parent.state+",...]");c=c.push(v)}else if("@pop"===b.next){if(c.depth<=1)throw W2(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(w));c=c.pop()}else if("@popall"===b.next)c=c.popall();else{let e=z2(this._lexer,b.next,_,y,v);if("@"===e[0]&&(e=e.substr(1)),!V2(this._lexer,e))throw W2(this._lexer,"trying to set a next state '"+e+"' that is undefined in rule: "+this._safeRuleName(w));c=c.push(e)}}b.log&&"string"==typeof b.log&&(f=this._lexer,g=this._lexer.languageId+": "+z2(this._lexer,b.log,_,y,v),console.log(`${f.languageId}: ${g}`))}if(null===S)throw W2(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(w));const x=n=>{let o=this._modeService.getModeIdForLanguageName(n);o&&(n=o);const s=this._getNestedEmbeddedModeData(n);if(u<a){const n=e.substr(u);return this._nestedTokenize(n,t,G2.create(c,s),i+u,r)}return G2.create(c,s)};if(Array.isArray(S)){if(h&&h.groups.length>0)throw W2(this._lexer,"groups cannot be nested: "+this._safeRuleName(w));if(y.length!==S.length+1)throw W2(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(w));let e=0;for(let t=1;t<y.length;t++)e+=y[t].length;if(e!==_.length)throw W2(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(w));h={rule:w,matches:y,groups:[]};for(let t=0;t<S.length;t++)h.groups[t]={action:S[t],matched:y[t+1]};u-=_.length}else{{if("@rematch"===S&&(u-=_.length,_="",y=null,S="",null!==C))return x(C);if(0===_.length){if(0===a||p!==c.depth||v!==c.state||(h?h.groups.length:0)!==m)continue;throw W2(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(w))}let e=null;if(O2(S)&&0===S.indexOf("@brackets")){let t=S.substr("@brackets".length),n=X2(this._lexer,_);if(!n)throw W2(this._lexer,"@brackets token returned but no bracket defined as: "+_);e=B2(n.token+t)}else{e=B2(""===S?"":S+this._lexer.tokenPostfix)}n<o&&r.emit(n+i,e)}if(null!==C)return x(C)}}var f,g;return G2.create(c,l)}_getNestedEmbeddedModeData(e){let t=this._locateMode(e);if(t){let e=YJ.get(t);if(e)return new j2(t,e.getInitialState())}return new j2(t||"vs.editor.nullMode",XJ)}_locateMode(e){if(!e||!this._modeService.isRegisteredMode(e))return null;if(e===this._modeId)return e;let t=this._modeService.getModeId(e);return t&&(this._modeService.triggerMode(t),this._embeddedModes[t]=!0),t}}function X2(e,t){if(!t)return null;t=F2(e,t);let n=e.brackets;for(const i of n){if(i.open===t)return{token:i.token,bracketType:1};if(i.close===t)return{token:i.token,bracketType:-1}}return null}var Z2;const Q2=null===(Z2=window.trustedTypes)||void 0===Z2?void 0:Z2.createPolicy("standaloneColorizer",{createHTML:e=>e});class J2{static colorizeElement(e,t,n,i){let r=(i=i||{}).theme||"vs",o=i.mimeType||n.getAttribute("lang")||n.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();e.setTheme(r);let s=n.firstChild?n.firstChild.nodeValue:"";n.className+=" "+r;return this.colorize(t,s||"",o,i).then((e=>{var t;const i=null!==(t=null==Q2?void 0:Q2.createHTML(e))&&void 0!==t?t:e;n.innerHTML=i}),(e=>console.error(e)))}static colorize(e,t,n,i){let r=4;i&&"number"==typeof i.tabSize&&(r=i.tabSize),UX(t)&&(t=t.substr(1));let o=uX(t),s=e.getModeId(n);if(!s)return Promise.resolve(t3(o,r));e.triggerMode(s);const a=YJ.get(s);if(a)return e3(o,r,a);const l=YJ.getPromise(s);return new Promise(l?(e,t)=>{l.then((n=>{e3(o,r,n).then(e,t)}),t)}:(e,t)=>{let n=null,i=null;const a=()=>{n&&(n.dispose(),n=null),i&&(i.dispose(),i=null);const a=YJ.get(s);a?e3(o,r,a).then(e,t):e(t3(o,r))};i=new B$,i.cancelAndSet(a,500),n=YJ.onDidChange((e=>{e.changedLanguages.indexOf(s)>=0&&a()}))})}static colorizeLine(e,t,n,i,r=4){const o=I2.isBasicASCII(e,t),s=I2.containsRTL(e,o,n);return S2(new v2(!1,!0,e,!1,o,s,0,i,[],r,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,n=4){let i=e.getLineContent(t);e.forceTokenization(t);let r=e.getLineTokens(t).inflate();return this.colorizeLine(i,e.mightContainNonBasicASCII(),e.mightContainRTL(),r,n)}}function e3(e,t,n){return new Promise(((i,r)=>{const o=()=>{const s=function(e,t,n){let i=[],r=n.getInitialState();for(let o=0,s=e.length;o<s;o++){let s=e[o],a=n.tokenize2(s,!0,r,0);u2.convertToEndOffset(a.tokens,s.length);let l=new u2(a.tokens,s);const c=I2.isBasicASCII(s,!0),u=I2.containsRTL(s,c,!0);let h=S2(new v2(!1,!0,s,!1,c,u,0,l.inflate(),[],t,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(h.html),i.push("<br/>"),r=a.endState}return i.join("")}(e,t,n);if(n instanceof Y2){const e=n.getLoadStatus();if(!1===e.loaded)return void e.promise.then(o,r)}i(s)};o()}))}function t3(e,t){let n=[];const i=new Uint32Array(2);i[0]=0,i[1]=16793600;for(let r=0,o=e.length;r<o;r++){let o=e[r];i[0]=o.length;const s=new u2(i,o),a=I2.isBasicASCII(o,!0),l=I2.containsRTL(o,a,!0);let c=S2(new v2(!1,!0,o,!1,a,l,0,s,[],t,0,0,0,0,-1,"none",!1,!1,null));n=n.concat(c.html),n.push("<br/>")}return n.join("")}var n3,i3;(i3=n3||(n3={}))[i3.Ignore=0]="Ignore",i3[i3.Info=1]="Info",i3[i3.Warning=2]="Warning",i3[i3.Error=3]="Error",function(e){const t="error",n="warning",i="info";e.fromValue=function(r){return r?wX(t,r)?e.Error:wX(n,r)||wX("warn",r)?e.Warning:wX(i,r)?e.Info:e.Ignore:e.Ignore},e.toString=function(r){switch(r){case e.Error:return t;case e.Warning:return n;case e.Info:return i;default:return"ignore"}}}(n3||(n3={}));var r3=n3;function o3(e){return!(!e||"function"!=typeof e.getEditorType)&&e.getEditorType()===bQ.ICodeEditor}function s3(e){return!(!e||"function"!=typeof e.getEditorType)&&e.getEditorType()===bQ.IDiffEditor}function a3(e){return o3(e)?e:s3(e)?e.getModifiedEditor():null}const l3=i$("IWorkspaceEditService");class c3{constructor(e){this.metadata=e}static convert(e){return e.edits.map((e=>{if(OZ(t=e)&&_K.isUri(t.resource)&&OZ(t.edit))return new u3(e.resource,e.edit,e.modelVersionId,e.metadata);var t;if(function(e){return OZ(e)&&(Boolean(e.newUri)||Boolean(e.oldUri))}(e))return new h3(e.oldUri,e.newUri,e.options,e.metadata);throw new Error("Unsupported edit")}))}}class u3 extends c3{constructor(e,t,n,i){super(i),this.resource=e,this.textEdit=t,this.versionId=n}}class h3 extends c3{constructor(e,t,n,i){super(i),this.oldResource=e,this.newResource=t,this.options=n}}const d3=new class{constructor(){this.data=new Map}add(e,t){sQ(AZ(e)),sQ(OZ(t)),sQ(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}},f3="base.contributions.json";const g3=new class{constructor(){this._onDidChangeSchema=new EG,this.schemasById={}}registerSchema(e,t){var n;this.schemasById[(n=e,n.length>0&&"#"===n.charAt(n.length-1)?n.substring(0,n.length-1):n)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}};d3.add(f3,g3);const p3="base.contributions.configuration",m3={properties:{},patternProperties:{}},v3={properties:{},patternProperties:{}},y3={properties:{},patternProperties:{}},_3={properties:{},patternProperties:{}},b3={properties:{},patternProperties:{}},w3={properties:{},patternProperties:{}},C3=d3.as(f3);const S3=new RegExp("\\[.*\\]$");function x3(e){return e.substring(1,e.length-1)}const E3=new class{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new EG,this._onDidUpdateConfiguration=new EG,this.defaultValues={},this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:GH(0,"Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown editor configuration setting",allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.excludedConfigurationProperties={},C3.registerSchema("vscode://schemas/settings/resourceLanguage",this.resourceLanguageSettingsSchema)}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const n=[];e.forEach((e=>{n.push(...this.validateAndRegisterProperties(e,t,e.extensionInfo)),this.configurationContributors.push(e),this.registerJSONConfiguration(e)})),C3.registerSchema("vscode://schemas/settings/resourceLanguage",this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(n)}registerOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}validateAndRegisterProperties(e,t=!0,n,i=3){var r;i=BZ(e.scope)?i:e.scope;let o=[],s=e.properties;if(s)for(let l in s){if(t&&k3(l)){delete s[l];continue}const e=s[l];this.updatePropertyDefaultValue(l,e),S3.test(l)?e.scope=void 0:(e.scope=BZ(e.scope)?i:e.scope,e.restricted=BZ(e.restricted)?!!(null===(r=null==n?void 0:n.restrictedConfigurations)||void 0===r?void 0:r.includes(l)):e.restricted),!s[l].hasOwnProperty("included")||s[l].included?(this.configurationProperties[l]=s[l],!s[l].deprecationMessage&&s[l].markdownDeprecationMessage&&(s[l].deprecationMessage=s[l].markdownDeprecationMessage),o.push(l)):(this.excludedConfigurationProperties[l]=s[l],delete s[l])}let a=e.allOf;if(a)for(let l of a)o.push(...this.validateAndRegisterProperties(l,t,n,i));return o}getConfigurationProperties(){return this.configurationProperties}registerJSONConfiguration(e){const t=e=>{let n=e.properties;if(n)for(const t in n)this.updateSchema(t,n[t]);let i=e.allOf;i&&i.forEach(t)};t(e)}updateSchema(e,t){switch(m3.properties[e]=t,t.scope){case 1:v3.properties[e]=t;break;case 2:y3.properties[e]=t;break;case 6:_3.properties[e]=t;break;case 3:b3.properties[e]=t;break;case 4:w3.properties[e]=t;break;case 5:w3.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,n={type:"object",description:GH(0,"Configure editor settings to be overridden for a language."),errorMessage:GH(0,"This setting does not support per-language configuration."),$ref:"vscode://schemas/settings/resourceLanguage"};this.updatePropertyDefaultValue(t,n),m3.properties[t]=n,v3.properties[t]=n,y3.properties[t]=n,_3.properties[t]=n,b3.properties[t]=n,w3.properties[t]=n}this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.defaultValues[e];FZ(n)&&(n=t.default),FZ(n)&&(n=function(e){switch(Array.isArray(e)?e[0]:e){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}(t.type)),t.default=n}};function k3(e){return e.trim()?S3.test(e)?GH(0,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",e):void 0!==E3.getConfigurationProperties()[e]?GH(0,"Cannot register '{0}'. This property is already registered.",e):null:GH(0,"Cannot register an empty property")}d3.add(p3,E3);const L3=Object.prototype.hasOwnProperty;class D3{constructor(){this.map=new Map}add(e,t){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(t)}delete(e,t){const n=this.map.get(e);n&&(n.delete(t),0===n.size&&this.map.delete(e))}forEach(e,t){const n=this.map.get(e);n&&n.forEach(t)}}const N3=new class{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new EG,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus!==e&&(this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus))}},I3=Object.hasOwnProperty;class T3{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class M3{constructor(){this._values=[]}_read(e){return this._values[e]}_write(e,t){this._values[e]=t}}class A3{static readOptions(e){const t=e,n=new M3;for(const i of Qj){const e="_never_"===i.name?void 0:t[i.name];n._write(i.id,e)}return n}static validateOptions(e){const t=new Ej;for(const n of Qj)t._write(n.id,n.validate(e._read(n.id)));return t}static computeOptions(e,t){const n=new T3;for(const i of Qj)n._write(i.id,i.compute(t,n,e._read(i.id)));return n}static _deepEquals(e,t){if("object"!=typeof e||"object"!=typeof t)return e===t;if(Array.isArray(e)||Array.isArray(t))return!(!Array.isArray(e)||!Array.isArray(t))&&D1(e,t);for(let n in e)if(!A3._deepEquals(e[n],t[n]))return!1;return!0}static checkEquals(e,t){const n=[];let i=!1;for(const r of Qj){const o=!A3._deepEquals(e._read(r.id),t._read(r.id));n[r.id]=o,o&&(i=!0)}return i?new xj(n):null}}function O3(e){const t=e.wordWrap;!0===t?e.wordWrap="on":!1===t&&(e.wordWrap="off");const n=e.lineNumbers;!0===n?e.lineNumbers="on":!1===n&&(e.lineNumbers="off");!1===e.autoClosingBrackets&&(e.autoClosingBrackets="never",e.autoClosingQuotes="never",e.autoSurround="never");"visible"===e.cursorBlinking&&(e.cursorBlinking="solid");const i=e.renderWhitespace;!0===i?e.renderWhitespace="boundary":!1===i&&(e.renderWhitespace="none");const r=e.renderLineHighlight;!0===r?e.renderLineHighlight="line":!1===r&&(e.renderLineHighlight="none");const o=e.acceptSuggestionOnEnter;!0===o?e.acceptSuggestionOnEnter="on":!1===o&&(e.acceptSuggestionOnEnter="off");const s=e.tabCompletion;!1===s?e.tabCompletion="off":!0===s&&(e.tabCompletion="onlySnippets");const a=e.suggest;if(a&&"object"==typeof a.filteredTypes&&a.filteredTypes){const e={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};(function(e,t){for(let n in e)if(L3.call(e,n)&&!1===t({key:n,value:e[n]},(function(){delete e[n]})))return})(e,(e=>{const t=a.filteredTypes[e.key];!1===t&&(a[e.value]=t)}))}const l=e.hover;!0===l?e.hover={enabled:!0}:!1===l&&(e.hover={enabled:!1});const c=e.parameterHints;!0===c?e.parameterHints={enabled:!0}:!1===c&&(e.parameterHints={enabled:!1});const u=e.autoIndent;!0===u?e.autoIndent="full":!1===u&&(e.autoIndent="advanced");const h=e.matchBrackets;!0===h?e.matchBrackets="always":!1===h&&(e.matchBrackets="never")}function R3(e){const t=aQ(e);return O3(t),t}class P3 extends mG{constructor(e,t){super(),this._onDidChange=this._register(new EG),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new EG),this.onDidChangeFast=this._onDidChangeFast.event,this.isSimpleWidget=e,this._isDominatedByLongLines=!1,this._computeOptionsMemory=new kj,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._rawOptions=R3(t),this._readOptions=A3.readOptions(this._rawOptions),this._validatedOptions=A3.validateOptions(this._readOptions),this._register(mQ.onDidChangeZoomLevel((e=>this._recomputeOptions()))),this._register(N3.onDidChangeTabFocus((e=>this._recomputeOptions())))}observeReferenceElement(e){}updatePixelRatio(){}_recomputeOptions(){const e=this.options,t=this._computeInternalOptions();if(e){const n=A3.checkEquals(e,t);if(null===n)return;this.options=t,this._onDidChangeFast.fire(n),this._onDidChange.fire(n)}else this.options=t}getRawOptions(){return this._rawOptions}_computeInternalOptions(){const e=this._getEnvConfiguration(),t=yQ.createFromValidatedSettings(this._validatedOptions,e.zoomLevel,e.pixelRatio,this.isSimpleWidget),n={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,fontInfo:this.readConfiguration(t),extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:N3.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport};return A3.computeOptions(this._validatedOptions,n)}static _subsetEquals(e,t){for(const n in t)if(I3.call(t,n)){const i=t[n],r=e[n];if(r===i)continue;if(Array.isArray(r)&&Array.isArray(i)){if(!D1(r,i))return!1;continue}if(r&&"object"==typeof r&&i&&"object"==typeof i){if(!this._subsetEquals(r,i))return!1;continue}return!1}return!0}updateOptions(e){if(void 0===e)return;const t=R3(e);P3._subsetEquals(this._rawOptions,t)||(this._rawOptions=hQ(this._rawOptions,t||{}),this._readOptions=A3.readOptions(this._rawOptions),this._validatedOptions=A3.validateOptions(this._readOptions),this._recomputeOptions())}setIsDominatedByLongLines(e){this._isDominatedByLongLines=e,this._recomputeOptions()}setMaxLineNumber(e){const t=P3._digitCount(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}static _digitCount(e){let t=0;for(;e;)e=Math.floor(e/10),t++;return t||1}}const F3=Object.freeze({id:"editor",order:5,type:"object",title:GH(0,"Editor"),scope:5}),B3=d3.as(p3),W3=Object.assign(Object.assign({},F3),{properties:{"editor.tabSize":{type:"number",default:Kj,minimum:1,markdownDescription:GH(0,"The number of spaces a tab is equal to. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.")},"editor.insertSpaces":{type:"boolean",default:$j,markdownDescription:GH(0,"Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.")},"editor.detectIndentation":{type:"boolean",default:Yj,markdownDescription:GH(0,"Controls whether `#editor.tabSize#` and `#editor.insertSpaces#` will be automatically detected when a file is opened based on the file contents.")},"editor.trimAutoWhitespace":{type:"boolean",default:Xj,description:GH(0,"Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:Zj,description:GH(0,"Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{type:"boolean",default:!0,description:GH(0,"Controls whether completions should be computed based on words in the document.")},"editor.wordBasedSuggestionsMode":{enum:["currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[GH(0,"Only suggest words from the active document."),GH(0,"Suggest words from all open documents of the same language."),GH(0,"Suggest words from all open documents.")],description:GH(0,"Controls from which documents word based completions are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[GH(0,"Semantic highlighting enabled for all color themes."),GH(0,"Semantic highlighting disabled for all color themes."),GH(0,"Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:GH(0,"Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:GH(0,"Keep peek editors open even when double clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:GH(0,"Lines above this length will not be tokenized for performance reasons")},"diffEditor.maxComputationTime":{type:"number",default:5e3,description:GH(0,"Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.renderSideBySide":{type:"boolean",default:!0,description:GH(0,"Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:!0,description:GH(0,"When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:!0,description:GH(0,"Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:!1,description:GH(0,"Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:"inherit",markdownEnumDescriptions:[GH(0,"Lines will never wrap."),GH(0,"Lines will wrap at the viewport width."),GH(0,"Lines will wrap according to the `#editor.wordWrap#` setting.")]}}});for(const VWe of Qj){const e=VWe.schema;if(void 0!==e)if(void 0!==(z3=e).type||void 0!==z3.anyOf)W3.properties[`editor.${VWe.name}`]=e;else for(let t in e)I3.call(e,t)&&(W3.properties[t]=e[t])}var z3;let V3=null;function U3(){return null===V3&&(V3=Object.create(null),Object.keys(W3.properties).forEach((e=>{V3[e]=!0}))),V3}B3.registerConfiguration(W3);class H3{static insert(e,t){return{range:new TK(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}const j3=i$("configurationService");function G3(e,t){const n=Object.create(null);for(let i in e)K3(n,i,e[i],t);return n}function K3(e,t,n,i){const r=t.split("."),o=r.pop();let s=e;for(let a=0;a<r.length;a++){let e=r[a],n=s[e];switch(typeof n){case"undefined":n=s[e]=Object.create(null);break;case"object":break;default:return void i(`Ignoring ${t} as ${r.slice(0,a+1).join(".")} is ${JSON.stringify(n)}`)}s=n}if("object"==typeof s&&null!==s)try{s[o]=n}catch(zWe){i(`Ignoring ${t} as ${r.join(".")} is ${JSON.stringify(s)}`)}else i(`Ignoring ${t} as ${r.join(".")} is ${JSON.stringify(s)}`)}function q3(e,t){$3(e,t.split("."))}function $3(e,t){const n=t.shift();if(0!==t.length){if(-1!==Object.keys(e).indexOf(n)){const i=e[n];"object"!=typeof i||Array.isArray(i)||($3(i,t),0===Object.keys(i).length&&delete e[n])}}else delete e[n]}class Y3{constructor(e={},t=[],n=[]){this._contents=e,this._keys=t,this._overrides=n,this.isFrozen=!1}get contents(){return this.checkAndFreeze(this._contents)}get overrides(){return this.checkAndFreeze(this._overrides)}get keys(){return this.checkAndFreeze(this._keys)}isEmpty(){return 0===this._keys.length&&0===Object.keys(this._contents).length&&0===this._overrides.length}getValue(e){return e?function(e,t,n){const i=function(e,t){let n=e;for(const i of t){if("object"!=typeof n||null===n)return;n=n[i]}return n}(e,t.split("."));return void 0===i?n:i}(this.contents,e):this.contents}override(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||"object"!=typeof t||!Object.keys(t).length)return this;let n={};for(const i of P1([...Object.keys(this.contents),...Object.keys(t)])){let e=this.contents[i],r=t[i];r&&("object"==typeof e&&"object"==typeof r?(e=aQ(e),this.mergeContents(e,r)):e=r),n[i]=e}return new Y3(n,this.keys,this.overrides)}merge(...e){const t=aQ(this.contents),n=aQ(this.overrides),i=[...this.keys];for(const r of e){this.mergeContents(t,r.contents);for(const e of r.overrides){const[t]=n.filter((t=>D1(t.identifiers,e.identifiers)));t?this.mergeContents(t.contents,e.contents):n.push(aQ(e))}for(const e of r.keys)-1===i.indexOf(e)&&i.push(e)}return new Y3(t,i,n)}freeze(){return this.isFrozen=!0,this}mergeContents(e,t){for(const n of Object.keys(t))n in e&&OZ(e[n])&&OZ(t[n])?this.mergeContents(e[n],t[n]):e[n]=aQ(t[n])}checkAndFreeze(e){return this.isFrozen&&!Object.isFrozen(e)?function(e){if(!e||"object"!=typeof e)return e;const t=[e];for(;t.length>0;){const e=t.shift();Object.freeze(e);for(const n in e)if(lQ.call(e,n)){const i=e[n];"object"!=typeof i||Object.isFrozen(i)||t.push(i)}}return e}(e):e}getContentsForOverrideIdentifer(e){for(const t of this.overrides)if(-1!==t.identifiers.indexOf(e))return t.contents;return null}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.addKey(e),K3(this.contents,e,t,(e=>{throw new Error(e)}))}removeValue(e){this.removeKey(e)&&q3(this.contents,e)}addKey(e){let t=this.keys.length;for(let n=0;n<t;n++)0===e.indexOf(this.keys[n])&&(t=n);this.keys.splice(t,1,e)}removeKey(e){let t=this.keys.indexOf(e);return-1!==t&&(this.keys.splice(t,1),!0)}}class X3 extends Y3{constructor(){const e=function(){const e=Object.create(null),t=d3.as(p3).getConfigurationProperties();for(let n in t)K3(e,n,t[n].default,(e=>console.error(`Conflict in default settings: ${e}`)));return e}(),t=function(){const e=d3.as(p3).getConfigurationProperties();return Object.keys(e)}(),n=[];for(const i of Object.keys(e))S3.test(i)&&n.push({identifiers:[x3(i).trim()],keys:Object.keys(e[i]),contents:G3(e[i],(e=>console.error(`Conflict in default settings file: ${e}`)))});super(e,t,n)}}class Z3{constructor(e,t,n=new Y3,i=new Y3,r=new rZ,o=new Y3,s=new rZ,a=!0){this._defaultConfiguration=e,this._localUserConfiguration=t,this._remoteUserConfiguration=n,this._workspaceConfiguration=i,this._folderConfigurations=r,this._memoryConfiguration=o,this._memoryConfigurationByResource=s,this._freeze=a,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new rZ,this._userConfiguration=null}getValue(e,t,n){return this.getConsolidateConfigurationModel(t,n).getValue(e)}updateValue(e,t,n={}){let i;n.resource?(i=this._memoryConfigurationByResource.get(n.resource),i||(i=new Y3,this._memoryConfigurationByResource.set(n.resource,i))):i=this._memoryConfiguration,void 0===t?i.removeValue(e):i.setValue(e,t),n.resource||(this._workspaceConsolidatedConfiguration=null)}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration),this._freeze&&this._userConfiguration.freeze()),this._userConfiguration}getConsolidateConfigurationModel(e,t){let n=this.getConsolidatedConfigurationModelForResource(e,t);return e.overrideIdentifier?n.override(e.overrideIdentifier):n}getConsolidatedConfigurationModelForResource({resource:e},t){let n=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const i=t.getFolder(e);i&&(n=this.getFolderConsolidatedConfiguration(i.uri)||n);const r=this._memoryConfigurationByResource.get(e);r&&(n=n.merge(r))}return n}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._freeze&&(this._workspaceConfiguration=this._workspaceConfiguration.freeze())),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const n=this.getWorkspaceConsolidatedConfiguration(),i=this._folderConfigurations.get(e);i?(t=n.merge(i),this._freeze&&(t=t.freeze()),this._foldersConsolidatedConfigurations.set(e,t)):t=n}return t}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce(((e,t)=>{const{contents:n,overrides:i,keys:r}=this._folderConfigurations.get(t);return e.push([t,{contents:n,overrides:i,keys:r}]),e}),[])}}static parse(e){const t=this.parseConfigurationModel(e.defaults),n=this.parseConfigurationModel(e.user),i=this.parseConfigurationModel(e.workspace),r=e.folders.reduce(((e,t)=>(e.set(_K.revive(t[0]),this.parseConfigurationModel(t[1])),e)),new rZ);return new Z3(t,n,new Y3,i,r,new Y3,new rZ,!1)}static parseConfigurationModel(e){return new Y3(e.contents,e.keys,e.overrides).freeze()}}class Q3{constructor(e,t,n,i){this.change=e,this.previous=t,this.currentConfiguraiton=n,this.currentWorkspace=i,this._previousConfiguration=void 0;const r=new Set;e.keys.forEach((e=>r.add(e))),e.overrides.forEach((([,e])=>e.forEach((e=>r.add(e))))),this.affectedKeys=[...r.values()];const o=new Y3;this.affectedKeys.forEach((e=>o.setValue(e,{}))),this.affectedKeysTree=o.contents}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=Z3.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,t){var n;if(this.doesAffectedKeysTreeContains(this.affectedKeysTree,e)){if(t){return!dQ(this.previousConfiguration?this.previousConfiguration.getValue(e,t,null===(n=this.previous)||void 0===n?void 0:n.workspace):void 0,this.currentConfiguraiton.getValue(e,t,this.currentWorkspace))}return!0}return!1}doesAffectedKeysTreeContains(e,t){let n,i=G3({[t]:!0},(()=>{}));for(;"object"==typeof i&&(n=Object.keys(i)[0]);){if(!(e=e[n]))return!1;i=i[n]}return!0}}const J3=/^(cursor|delete)/;class e4 extends mG{constructor(e,t,n,i,r){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=n,this._notificationService=i,this._logService=r,this._onDidUpdateKeybindings=this._register(new EG),this._currentChord=null,this._currentChordChecker=new W$,this._currentChordStatusMessage=null,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new B$,this._logging=!1}get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:SG.None}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const n=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(n)return n.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){const n=this.resolveKeyboardEvent(e);if(n.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),null;const[i]=n.getDispatchParts();if(null===i)return null;const r=this._contextKeyService.getContext(t),o=this._currentChord?this._currentChord.keypress:null;return this._getResolver().resolve(r,o,i)}_enterChordMode(e,t){this._currentChord={keypress:e,label:t},this._currentChordStatusMessage=this._notificationService.status(GH(0,"({0}) was pressed. Waiting for second key of chord...",t));const n=Date.now();this._currentChordChecker.cancelAndSet((()=>{this._documentHasFocus()?Date.now()-n>5e3&&this._leaveChordMode():this._leaveChordMode()}),500)}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChord=null}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const n=this.resolveKeyboardEvent(e),[i]=n.getSingleModifierDispatchParts();return null!==i&&null===this._currentSingleModifier?(this._log(`+ Storing single modifier for possible chord ${i}.`),this._currentSingleModifier=i,this._currentSingleModifierClearTimeout.cancelAndSet((()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null}),300),!1):null!==i&&i===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${i} ${i}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(n,t,!0)):(this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1)}_doDispatch(e,t,n=!1){let i=!1;if(e.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),!1;let r=null,o=null;if(n){const[t]=e.getSingleModifierDispatchParts();r=t,o=t}else[r]=e.getDispatchParts(),o=this._currentChord?this._currentChord.keypress:null;if(null===r)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),i;const s=this._contextKeyService.getContext(t),a=e.getLabel(),l=this._getResolver().resolve(s,o,r);return this._logService.trace("KeybindingService#dispatch",a,null==l?void 0:l.commandId),l&&l.enterChord?(i=!0,this._enterChordMode(r,a),i):(this._currentChord&&(l&&l.commandId||(this._notificationService.status(GH(0,"The key combination ({0}, {1}) is not a command.",this._currentChord.label,a),{hideAfter:1e4}),i=!0)),this._leaveChordMode(),l&&l.commandId&&(l.bubble||(i=!0),void 0===l.commandArgs?this._commandService.executeCommand(l.commandId).then(void 0,(e=>this._notificationService.warn(e))):this._commandService.executeCommand(l.commandId,l.commandArgs).then(void 0,(e=>this._notificationService.warn(e))),J3.test(l.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:l.commandId,from:"keybinding"})),i)}mightProducePrintableCharacter(e){return!e.ctrlKey&&!e.metaKey&&(e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30)}}class t4{constructor(e,t,n){this._log=n,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(let i=0,r=e.length;i<r;i++){const t=e[i].command;t&&this._defaultBoundCommands.set(t,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=t4.combine(e,t);for(let i=0,r=this._keybindings.length;i<r;i++){let e=this._keybindings[i];0!==e.keypressParts.length&&(e.when&&0===e.when.type||this._addKeyPress(e.keypressParts[0],e))}}static _isTargetedForRemoval(e,t,n,i,r){if(e.command!==i)return!1;if(t&&e.keypressParts[0]!==t)return!1;if(n&&e.keypressParts[1]!==n)return!1;if(r){if(!e.when)return!1;if(!r.equals(e.when))return!1}return!0}static combine(e,t){e=e.slice(0);let n=[];for(const i of t){if(!i.command||0===i.command.length||"-"!==i.command.charAt(0)){n.push(i);continue}const t=i.command.substr(1),r=i.keypressParts[0],o=i.keypressParts[1],s=i.when;for(let n=e.length-1;n>=0;n--)this._isTargetedForRemoval(e[n],r,o,t,s)&&e.splice(n,1)}return e.concat(n)}_addKeyPress(e,t){const n=this._map.get(e);if(void 0===n)return this._map.set(e,[t]),void this._addToLookupMap(t);for(let i=n.length-1;i>=0;i--){let e=n[i];if(e.command===t.command)continue;const r=e.keypressParts.length>1,o=t.keypressParts.length>1;r&&o&&e.keypressParts[1]!==t.keypressParts[1]||t4.whenIsEntirelyIncluded(e.when,t.when)&&this._removeFromLookupMap(e)}n.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);void 0===t?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);if(void 0!==t)for(let n=0,i=t.length;n<i;n++)if(t[n]===e)return void t.splice(n,1)}static whenIsEntirelyIncluded(e,t){return!t||1===t.type||!(!e||1===e.type)&&this._implies(e,t)}static _implies(e,t){const n=e=>9===e.type?e.expr:[e];let i=n(e.negate()).concat(n(t));for(let r=0;r<i.length;r++){const e=i[r].negate();for(let t=r+1;t<i.length;t++){const n=i[t];if(e.equals(n))return!0}}return!1}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const n=this._lookupMap.get(e);if(void 0===n||0===n.length)return null;if(1===n.length)return n[0];for(let i=n.length-1;i>=0;i--){const e=n[i];if(t.contextMatchesRules(e.when))return e}return n[n.length-1]}resolve(e,t,n){this._log(`| Resolving ${n}${t?` chorded from ${t}`:""}`);let i=null;if(null!==t){const e=this._map.get(t);if(void 0===e)return this._log("\\ No keybinding entries."),null;i=[];for(let t=0,r=e.length;t<r;t++){let r=e[t];r.keypressParts[1]===n&&i.push(r)}}else{const e=this._map.get(n);if(void 0===e)return this._log("\\ No keybinding entries."),null;i=e}let r=this._findCommand(e,i);return r?null===t&&r.keypressParts.length>1&&null!==r.keypressParts[1]?(this._log(`\\ From ${i.length} keybinding entries, matched chord, when: ${n4(r.when)}, source: ${i4(r)}.`),{enterChord:!0,leaveChord:!1,commandId:null,commandArgs:null,bubble:!1}):(this._log(`\\ From ${i.length} keybinding entries, matched ${r.command}, when: ${n4(r.when)}, source: ${i4(r)}.`),{enterChord:!1,leaveChord:r.keypressParts.length>1,commandId:r.command,commandArgs:r.commandArgs,bubble:r.bubble}):(this._log(`\\ From ${i.length} keybinding entries, no when clauses matched the context.`),null)}_findCommand(e,t){for(let n=t.length-1;n>=0;n--){let i=t[n];if(t4.contextMatchesRules(e,i.when))return i}return null}static contextMatchesRules(e,t){return!t||t.evaluate(e)}}function n4(e){return e?`${e.serialize()}`:"no when condition"}function i4(e){return e.extensionId?e.isBuiltinExtension?`built-in extension ${e.extensionId}`:`user extension ${e.extensionId}`:e.isDefault?"built-in":"user"}class r4{constructor(){this._coreKeybindings=[],this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(1===pj){if(e&&e.win)return e.win}else if(2===pj){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=r4.bindToCurrentPlatform(e);if(t&&t.primary){const n=UG(t.primary,pj);n&&this._registerDefaultKeybinding(n,e.id,e.args,e.weight,0,e.when)}if(t&&Array.isArray(t.secondary))for(let n=0,i=t.secondary.length;n<i;n++){const i=UG(t.secondary[n],pj);i&&this._registerDefaultKeybinding(i,e.id,e.args,e.weight,-n-1,e.when)}}registerCommandAndKeybindingRule(e){this.registerKeybindingRule(e),qZ.registerCommand(e)}static _mightProduceChar(e){return e>=21&&e<=30||(e>=31&&e<=56||(80===e||81===e||82===e||83===e||84===e||85===e||86===e||110===e||111===e||87===e||88===e||89===e||90===e||91===e||92===e))}_assertNoCtrlAlt(e,t){e.ctrlKey&&e.altKey&&!e.metaKey&&r4._mightProduceChar(e.keyCode)&&console.warn("Ctrl+Alt+ keybindings should not be used by default under Windows. Offender: ",e," for ",t)}_registerDefaultKeybinding(e,t,n,i,r,o){1===pj&&this._assertNoCtrlAlt(e.parts[0],t),this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:o,weight1:i,weight2:r,extensionId:null,isBuiltinExtension:!1}),this._cachedMergedKeybindings=null}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=[].concat(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(s4)),this._cachedMergedKeybindings.slice(0)}}const o4=new r4;function s4(e,t){return e.weight1!==t.weight1?e.weight1-t.weight1:e.command<t.command?-1:e.command>t.command?1:e.weight2-t.weight2}d3.add("platform.keybindingsRegistry",o4);class a4{constructor(e,t,n,i,r,o,s){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.keypressParts=e?l4(e.getDispatchParts()):[],e&&0===this.keypressParts.length&&(this.keypressParts=l4(e.getSingleModifierDispatchParts())),this.bubble=!!t&&94===t.charCodeAt(0),this.command=this.bubble?t.substr(1):t,this.commandArgs=n,this.when=i,this.isDefault=r,this.extensionId=o,this.isBuiltinExtension=s}}function l4(e){let t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];if(!i)return t;t.push(i)}return t}class c4{constructor(e,t,n=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=n}toLabel(e,t,n){if(0===t.length)return null;const i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r],s=n(o);if(null===s)return null;i[r]=d4(o,s,this.modifierLabels[e])}return i.join(" ")}}const u4=new c4({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:GH(0,"Ctrl"),shiftKey:GH(0,"Shift"),altKey:GH(0,"Alt"),metaKey:GH(0,"Windows"),separator:"+"},{ctrlKey:GH(0,"Ctrl"),shiftKey:GH(0,"Shift"),altKey:GH(0,"Alt"),metaKey:GH(0,"Super"),separator:"+"}),h4=new c4({ctrlKey:GH(0,"Control"),shiftKey:GH(0,"Shift"),altKey:GH(0,"Alt"),metaKey:GH(0,"Command"),separator:"+"},{ctrlKey:GH(0,"Control"),shiftKey:GH(0,"Shift"),altKey:GH(0,"Alt"),metaKey:GH(0,"Windows"),separator:"+"},{ctrlKey:GH(0,"Control"),shiftKey:GH(0,"Shift"),altKey:GH(0,"Alt"),metaKey:GH(0,"Super"),separator:"+"});function d4(e,t,n){if(null===t)return"";const i=[];return e.ctrlKey&&i.push(n.ctrlKey),e.shiftKey&&i.push(n.shiftKey),e.altKey&&i.push(n.altKey),e.metaKey&&i.push(n.metaKey),""!==t&&i.push(t),i.join(n.separator)}class f4 extends class extends class{}{constructor(e,t){if(super(),0===t.length)throw aG("parts");this._os=e,this._parts=t}getLabel(){return u4.toLabel(this._os,this._parts,(e=>this._getLabel(e)))}getAriaLabel(){return h4.toLabel(this._os,this._parts,(e=>this._getAriaLabel(e)))}isChord(){return this._parts.length>1}getParts(){return this._parts.map((e=>this._getPart(e)))}_getPart(e){return new KG(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchParts(){return this._parts.map((e=>this._getDispatchPart(e)))}getSingleModifierDispatchParts(){return this._parts.map((e=>this._getSingleModifierDispatchPart(e)))}}{constructor(e,t){super(t,e.parts)}_keyCodeToUILabel(e){if(2===this._os)switch(e){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return WG.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":WG.toString(e.keyCode)}_getDispatchPart(e){return f4.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=WG.toString(e.keyCode),t}_getSingleModifierDispatchPart(e){return 5!==e.keyCode||e.shiftKey||e.altKey||e.metaKey?4!==e.keyCode||e.ctrlKey||e.altKey||e.metaKey?6!==e.keyCode||e.ctrlKey||e.shiftKey||e.metaKey?57!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey?null:"meta":"alt":"shift":"ctrl"}}const g4=i$("notificationService");const p4=i$("contextService");class m4{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}var v4,y4,_4,b4,w4,C4,S4,x4,E4,k4,L4,D4,N4;(y4=v4||(v4={})).noSelection=GH(0,"No selection"),y4.singleSelectionRange=GH(0,"Line {0}, Column {1} ({2} selected)"),y4.singleSelection=GH(0,"Line {0}, Column {1}"),y4.multiSelectionRange=GH(0,"{0} selections ({1} characters selected)"),y4.multiSelection=GH(0,"{0} selections"),y4.emergencyConfOn=GH(0,"Now changing the setting `accessibilitySupport` to 'on'."),y4.openingDocs=GH(0,"Now opening the Editor Accessibility documentation page."),y4.readonlyDiffEditor=GH(0," in a read-only pane of a diff editor."),y4.editableDiffEditor=GH(0," in a pane of a diff editor."),y4.readonlyEditor=GH(0," in a read-only code editor"),y4.editableEditor=GH(0," in a code editor"),y4.changeConfigToOnMac=GH(0,"To configure the editor to be optimized for usage with a Screen Reader press Command+E now."),y4.changeConfigToOnWinLinux=GH(0,"To configure the editor to be optimized for usage with a Screen Reader press Control+E now."),y4.auto_on=GH(0,"The editor is configured to be optimized for usage with a Screen Reader."),y4.auto_off=GH(0,"The editor is configured to never be optimized for usage with a Screen Reader, which is not the case at this time."),y4.tabFocusModeOnMsg=GH(0,"Pressing Tab in the current editor will move focus to the next focusable element. Toggle this behavior by pressing {0}."),y4.tabFocusModeOnMsgNoKb=GH(0,"Pressing Tab in the current editor will move focus to the next focusable element. The command {0} is currently not triggerable by a keybinding."),y4.tabFocusModeOffMsg=GH(0,"Pressing Tab in the current editor will insert the tab character. Toggle this behavior by pressing {0}."),y4.tabFocusModeOffMsgNoKb=GH(0,"Pressing Tab in the current editor will insert the tab character. The command {0} is currently not triggerable by a keybinding."),y4.openDocMac=GH(0,"Press Command+H now to open a browser window with more information related to editor accessibility."),y4.openDocWinLinux=GH(0,"Press Control+H now to open a browser window with more information related to editor accessibility."),y4.outroMsg=GH(0,"You can dismiss this tooltip and return to the editor by pressing Escape or Shift+Escape."),y4.showAccessibilityHelpAction=GH(0,"Show Accessibility Help"),(_4||(_4={})).inspectTokensAction=GH(0,"Developer: Inspect Tokens"),(b4||(b4={})).gotoLineActionLabel=GH(0,"Go to Line/Column..."),(w4||(w4={})).helpQuickAccessActionLabel=GH(0,"Show all Quick Access Providers"),(S4=C4||(C4={})).quickCommandActionLabel=GH(0,"Command Palette"),S4.quickCommandHelp=GH(0,"Show And Run Commands"),(E4=x4||(x4={})).quickOutlineActionLabel=GH(0,"Go to Symbol..."),E4.quickOutlineByCategoryActionLabel=GH(0,"Go to Symbol by Category..."),(L4=k4||(k4={})).editorViewAccessibleLabel=GH(0,"Editor content"),L4.accessibilityHelpMessage=GH(0,"Press Alt+F1 for Accessibility Options."),(D4||(D4={})).toggleHighContrast=GH(0,"Toggle High Contrast Theme"),(N4||(N4={})).bulkEditServiceSummary=GH(0,"Made {0} edits in {1} files");var I4=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},T4=function(e,t){return function(n,i){t(n,i,e)}},M4=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class A4{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new EG}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let O4=class{constructor(e){this.modelService=e}setEditor(e){this.editor=e}createModelReference(e){let t=null;var n,i,r;return this.editor&&(n=this.editor,i=t=>this.findModel(t,e),r=t=>this.findModel(t.getOriginalEditor(),e)||this.findModel(t.getModifiedEditor(),e),t=o3(n)?i(n):r(n)),t?Promise.resolve(new yG(new A4(t))):Promise.reject(new Error("Model not found"))}findModel(e,t){let n=this.modelService.getModel(t);return n&&n.uri.toString()!==t.toString()?null:n}};O4=I4([T4(0,iJ)],O4);class R4{show(){return R4.NULL_PROGRESS_RUNNER}showWhile(e,t){return M4(this,void 0,void 0,(function*(){yield e}))}}R4.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class P4{confirm(e){return this.doConfirm(e).then((e=>({confirmed:e,checkboxChecked:!1})))}doConfirm(e){let t=e.message;return e.detail&&(t=t+"\n\n"+e.detail),Promise.resolve(window.confirm(t))}show(e,t,n,i){return Promise.resolve({choice:0})}}class F4{info(e){return this.notify({severity:r3.Info,message:e})}warn(e){return this.notify({severity:r3.Warning,message:e})}error(e){return this.notify({severity:r3.Error,message:e})}notify(e){switch(e.severity){case r3.Error:console.error(e.message);break;case r3.Warning:console.warn(e.message);break;default:console.log(e.message)}return F4.NO_OP}status(e,t){return mG.None}}F4.NO_OP=new class{};class B4{constructor(e){this._onWillExecuteCommand=new EG,this._onDidExecuteCommand=new EG,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const n=qZ.getCommand(e);if(!n)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const i=this._instantiationService.invokeFunction.apply(this._instantiationService,[n.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(i)}catch(i){return Promise.reject(i)}}}class W4 extends e4{constructor(e,t,n,i,r,o){super(e,t,n,i,r),this._cachedResolver=null,this._dynamicKeybindings=[],this._register(Q$(o,RY.KEY_DOWN,(e=>{const t=new C$(e);this._dispatch(t,t.target)&&(t.preventDefault(),t.stopPropagation())}))),this._register(Q$(window,RY.KEY_UP,(e=>{const t=new C$(e);this._singleModifierDispatch(t,t.target)&&t.preventDefault()})))}addDynamicKeybinding(e,t,n,i){const r=UG(t,pj),o=new pG;return r&&(this._dynamicKeybindings.push({keybinding:r,command:e,when:i,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}),o.add(gG((()=>{for(let t=0;t<this._dynamicKeybindings.length;t++){if(this._dynamicKeybindings[t].command===e)return this._dynamicKeybindings.splice(t,1),void this.updateResolver({source:1})}})))),o.add(qZ.registerCommand(e,n)),this.updateResolver({source:1}),o}updateResolver(e){this._cachedResolver=null,this._onDidUpdateKeybindings.fire(e)}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(o4.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new t4(e,t,(e=>this._log(e)))}return this._cachedResolver}_documentHasFocus(){return document.hasFocus()}_toNormalizedKeybindingItems(e,t){let n=[],i=0;for(const r of e){const e=r.when||void 0,o=r.keybinding;if(o){const s=this.resolveKeybinding(o);for(const o of s)n[i++]=new a4(o,r.command,r.commandArgs,e,t,null,!1)}else n[i++]=new a4(void 0,r.command,r.commandArgs,e,t,null,!1)}return n}resolveKeybinding(e){return[new f4(e,pj)]}resolveKeyboardEvent(e){let t=new jG(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode).toChord();return new f4(t,pj)}}function z4(e){return e&&"object"==typeof e&&(!e.overrideIdentifier||"string"==typeof e.overrideIdentifier)&&(!e.resource||e.resource instanceof _K)}class V4{constructor(){this._onDidChangeConfiguration=new EG,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._configuration=new Z3(new X3,new Y3)}getValue(e,t){const n="string"==typeof e?e:void 0,i=z4(e)?e:z4(t)?t:{};return this._configuration.getValue(n,i,void 0)}updateValues(e){const t={data:this._configuration.toData()};let n=[];for(const i of e){const[e,t]=i;this.getValue(e)!==t&&(this._configuration.updateValue(e,t),n.push(e))}if(n.length>0){const e=new Q3({keys:n,overrides:[]},t,this._configuration);e.source=7,e.sourceConfig=null,this._onDidChangeConfiguration.fire(e)}return Promise.resolve()}}class U4{constructor(e){this.configurationService=e,this._onDidChangeConfiguration=new EG,this.configurationService.onDidChangeConfiguration((e=>{this._onDidChangeConfiguration.fire({affectedKeys:e.affectedKeys,affectsConfiguration:(t,n)=>e.affectsConfiguration(n)})}))}getValue(e,t,n){const i=(IK.isIPosition(t)?t:null)?"string"==typeof n?n:void 0:"string"==typeof t?t:void 0;return void 0===i?this.configurationService.getValue():this.configurationService.getValue(i)}}let H4=class{constructor(e){this.configurationService=e}getEOL(e,t){const n=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return n&&"auto"!==n?n:cj||lj?"\n":"\r\n"}};H4=I4([T4(0,j3)],H4);class j4{publicLog(e,t){return Promise.resolve(void 0)}publicLog2(e,t){return this.publicLog(e,t)}}class G4{constructor(){const e=_K.from({scheme:G4.SCHEME,authority:"model",path:"/"});this.workspace={id:"4064f6ec-cb38-4ad0-af64-ee6467e63c82",folders:[new m4({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}}function K4(e,t,n){if(!t)return;if(!(e instanceof V4))return;let i=[];Object.keys(t).forEach((e=>{(function(e){return U3()[`editor.${e}`]||!1})(e)&&i.push([`editor.${e}`,t[e]]),n&&function(e){return U3()[`diffEditor.${e}`]||!1}(e)&&i.push([`diffEditor.${e}`,t[e]])})),i.length>0&&e.updateValues(i)}G4.SCHEME="inmemory";class q4{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}apply(e,t){return M4(this,void 0,void 0,(function*(){const t=new Map;for(let r of e){if(!(r instanceof u3))throw new Error("bad edit - only text edits are supported");const e=this._modelService.getModel(r.resource);if(!e)throw new Error("bad edit - model not found");if("number"==typeof r.versionId&&e.getVersionId()!==r.versionId)throw new Error("bad state - model changed in the meantime");let n=t.get(e);n||(n=[],t.set(e,n)),n.push(H3.replaceMove(TK.lift(r.textEdit.range),r.textEdit.text))}let n=0,i=0;for(const[e,r]of t)e.pushStackElement(),e.pushEditOperations([],r,(()=>[])),e.pushStackElement(),i+=1,n+=r.length;return{ariaSummary:nX(N4.bulkEditServiceSummary,n,i)}}))}}class $4{getUriLabel(e,t){return"file"===e.scheme?e.fsPath:e.path}}class Y4{constructor(e,t){this._codeEditorService=e,this._container=t,this.onDidLayout=SG.None}get dimension(){return this._dimension||(this._dimension=dY(window.document.body)),this._dimension}get container(){return this._container}focus(){var e;null===(e=this._codeEditorService.getFocusedCodeEditor())||void 0===e||e.focus()}}let X4,Z4,Q4,J4,e5;function t5(e){X4&&(Z4.textContent!==e?(Y$(Q4),i5(Z4,e)):(Y$(Z4),i5(Q4,e)))}function n5(e){X4&&(lj?t5(e):J4.textContent!==e?(Y$(e5),i5(J4,e)):(Y$(J4),i5(e5,e)))}function i5(e,t){Y$(e),t.length>2e4&&(t=t.substr(0,2e4)),e.textContent=t,e.style.visibility="hidden",e.style.visibility="visible"}const r5=i$("markerDecorationsService");var o5=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class s5 extends mG{constructor(e,t="",n="",i=!0,r){super(),this._onDidChange=this._register(new EG),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._checked=!1,this._id=e,this._label=t,this._cssClass=n,this._enabled=i,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}run(e,t){return o5(this,void 0,void 0,(function*(){this._actionCallback&&(yield this._actionCallback(e))}))}}class a5 extends mG{constructor(){super(...arguments),this._onBeforeRun=this._register(new EG),this.onBeforeRun=this._onBeforeRun.event,this._onDidRun=this._register(new EG),this.onDidRun=this._onDidRun.event}run(e,t){return o5(this,void 0,void 0,(function*(){if(!e.enabled)return;let n;this._onBeforeRun.fire({action:e});try{yield this.runAction(e,t)}catch(zWe){n=zWe}this._onDidRun.fire({action:e,error:n})}))}runAction(e,t){return o5(this,void 0,void 0,(function*(){yield e.run(t)}))}}class l5 extends s5{constructor(e){super(l5.ID,e,e?"separator text":"separator"),this.checked=!1,this.enabled=!1}}l5.ID="vs.actions.separator";class c5{constructor(e,t,n,i){this.tooltip="",this.enabled=!0,this.checked=!1,this.id=e,this.label=t,this.class=i,this._actions=n}get actions(){return this._actions}dispose(){}run(){return o5(this,void 0,void 0,(function*(){}))}}class u5 extends s5{constructor(){super(u5.ID,GH(0,"(empty)"),void 0,!1)}}u5.ID="vs.actions.empty";let h5=fj||"";const d5=new Map;d5.set("false",!1),d5.set("true",!0),d5.set("isMac",lj),d5.set("isLinux",cj),d5.set("isWindows",aj),d5.set("isWeb",hj),d5.set("isMacNative",lj&&!hj),d5.set("isEdge",h5.indexOf("Edg/")>=0),d5.set("isFirefox",h5.indexOf("Firefox")>=0),d5.set("isChrome",h5.indexOf("Chrome")>=0),d5.set("isSafari",h5.indexOf("Safari")>=0);const f5=Object.prototype.hasOwnProperty;class g5{static has(e){return y5.create(e)}static equals(e,t){return _5.create(e,t)}static regex(e,t){return D5.create(e,t)}static not(e){return S5.create(e)}static and(...e){return I5.create(e)}static or(...e){return T5.create(e)}static deserialize(e,t=!1){if(e)return this._deserializeOrExpression(e,t)}static _deserializeOrExpression(e,t){let n=e.split("||");return T5.create(n.map((e=>this._deserializeAndExpression(e,t))))}static _deserializeAndExpression(e,t){let n=e.split("&&");return I5.create(n.map((e=>this._deserializeOne(e,t))))}static _deserializeOne(e,t){if((e=e.trim()).indexOf("!=")>=0){let n=e.split("!=");return C5.create(n[0].trim(),this._deserializeValue(n[1],t))}if(e.indexOf("==")>=0){let n=e.split("==");return _5.create(n[0].trim(),this._deserializeValue(n[1],t))}if(e.indexOf("=~")>=0){let n=e.split("=~");return D5.create(n[0].trim(),this._deserializeRegexValue(n[1],t))}if(e.indexOf(" in ")>=0){let t=e.split(" in ");return b5.create(t[0].trim(),t[1].trim())}if(/^[^<=>]+>=[^<=>]+$/.test(e)){const t=e.split(">=");return E5.create(t[0].trim(),t[1].trim())}if(/^[^<=>]+>[^<=>]+$/.test(e)){const t=e.split(">");return x5.create(t[0].trim(),t[1].trim())}if(/^[^<=>]+<=[^<=>]+$/.test(e)){const t=e.split("<=");return L5.create(t[0].trim(),t[1].trim())}if(/^[^<=>]+<[^<=>]+$/.test(e)){const t=e.split("<");return k5.create(t[0].trim(),t[1].trim())}return/^\!\s*/.test(e)?S5.create(e.substr(1).trim()):y5.create(e)}static _deserializeValue(e,t){if("true"===(e=e.trim()))return!0;if("false"===e)return!1;let n=/^'([^']*)'$/.exec(e);return n?n[1].trim():e}static _deserializeRegexValue(e,t){if(eX(e)){if(t)throw new Error("missing regexp-value for =~-expression");return console.warn("missing regexp-value for =~-expression"),null}let n=e.indexOf("/"),i=e.lastIndexOf("/");if(n===i||n<0){if(t)throw new Error(`bad regexp-value '${e}', missing /-enclosure`);return console.warn(`bad regexp-value '${e}', missing /-enclosure`),null}let r=e.slice(n+1,i),o="i"===e[i+1]?"i":"";try{return new RegExp(r,o)}catch(zWe){if(t)throw new Error(`bad regexp-value '${e}', parse error: ${zWe}`);return console.warn(`bad regexp-value '${e}', parse error: ${zWe}`),null}}}function p5(e,t){return e.cmp(t)}class m5{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return v5.INSTANCE}}m5.INSTANCE=new m5;class v5{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return m5.INSTANCE}}v5.INSTANCE=new v5;class y5{constructor(e){this.key=e,this.type=2}static create(e){const t=d5.get(e);return"boolean"==typeof t?t?v5.INSTANCE:m5.INSTANCE:new y5(e)}cmp(e){return e.type!==this.type?this.type-e.type:O5(this.key,e.key)}equals(e){return e.type===this.type&&this.key===e.key}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return S5.create(this.key)}}class _5{constructor(e,t){this.key=e,this.value=t,this.type=4}static create(e,t){if("boolean"==typeof t)return t?y5.create(e):S5.create(e);const n=d5.get(e);if("boolean"==typeof n){return t===(n?"true":"false")?v5.INSTANCE:m5.INSTANCE}return new _5(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:R5(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return C5.create(this.key,this.value)}}class b5{constructor(e,t){this.key=e,this.valueKey=t,this.type=10}static create(e,t){return new b5(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:R5(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type&&(this.key===e.key&&this.valueKey===e.valueKey)}evaluate(e){const t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.indexOf(n)>=0:"string"==typeof n&&"object"==typeof t&&null!==t&&f5.call(t,n)}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return w5.create(this)}}class w5{constructor(e){this._actual=e,this.type=11}static create(e){return new w5(e)}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type&&this._actual.equals(e._actual)}evaluate(e){return!this._actual.evaluate(e)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}negate(){return this._actual}}class C5{constructor(e,t){this.key=e,this.value=t,this.type=5}static create(e,t){if("boolean"==typeof t)return t?S5.create(e):y5.create(e);const n=d5.get(e);if("boolean"==typeof n){return t===(n?"true":"false")?m5.INSTANCE:v5.INSTANCE}return new C5(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:R5(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return _5.create(this.key,this.value)}}class S5{constructor(e){this.key=e,this.type=3}static create(e){const t=d5.get(e);return"boolean"==typeof t?t?m5.INSTANCE:v5.INSTANCE:new S5(e)}cmp(e){return e.type!==this.type?this.type-e.type:O5(this.key,e.key)}equals(e){return e.type===this.type&&this.key===e.key}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return y5.create(this.key)}}class x5{constructor(e,t){this.key=e,this.value=t,this.type=12}static create(e,t){return new x5(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:R5(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}evaluate(e){return parseFloat(e.getValue(this.key))>parseFloat(this.value)}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return L5.create(this.key,this.value)}}class E5{constructor(e,t){this.key=e,this.value=t,this.type=13}static create(e,t){return new E5(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:R5(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}evaluate(e){return parseFloat(e.getValue(this.key))>=parseFloat(this.value)}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return k5.create(this.key,this.value)}}class k5{constructor(e,t){this.key=e,this.value=t,this.type=14}static create(e,t){return new k5(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:R5(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}evaluate(e){return parseFloat(e.getValue(this.key))<parseFloat(this.value)}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return E5.create(this.key,this.value)}}class L5{constructor(e,t){this.key=e,this.value=t,this.type=15}static create(e,t){return new L5(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:R5(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}evaluate(e){return parseFloat(e.getValue(this.key))<=parseFloat(this.value)}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return x5.create(this.key,this.value)}}class D5{constructor(e,t){this.key=e,this.regexp=t,this.type=7}static create(e,t){return new D5(e,t)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}evaluate(e){let t=e.getValue(this.key);return!!this.regexp&&this.regexp.test(t)}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.ignoreCase?"i":""}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return N5.create(this)}}class N5{constructor(e){this._actual=e,this.type=8}static create(e){return new N5(e)}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type&&this._actual.equals(e._actual)}evaluate(e){return!this._actual.evaluate(e)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}negate(){return this._actual}}class I5{constructor(e){this.expr=e,this.type=6}static create(e){return I5._normalizeArr(e)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){const n=p5(this.expr[t],e.expr[t]);if(0!==n)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e){const t=[];let n=!1;for(const i of e)if(i)if(1!==i.type){if(0===i.type)return m5.INSTANCE;6!==i.type?t.push(i):t.push(...i.expr)}else n=!0;if(0===t.length&&n)return v5.INSTANCE;if(0!==t.length){if(1===t.length)return t[0];for(t.sort(p5);t.length>1;){const e=t[t.length-1];if(9!==e.type)break;t.pop();const n=t.pop(),i=T5.create(e.expr.map((e=>I5.create([e,n]))));i&&(t.push(i),t.sort(p5))}return 1===t.length?t[0]:new I5(t)}}serialize(){return this.expr.map((e=>e.serialize())).join(" && ")}keys(){const e=[];for(let t of this.expr)e.push(...t.keys());return e}negate(){let e=[];for(let t of this.expr)e.push(t.negate());return T5.create(e)}}class T5{constructor(e){this.expr=e,this.type=9}static create(e){const t=T5._normalizeArr(e);if(0!==t.length)return 1===t.length?t[0]:new T5(t)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){const n=p5(this.expr[t],e.expr[t]);if(0!==n)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e){let t=[],n=!1;if(e){for(let i=0,r=e.length;i<r;i++){const r=e[i];if(r)if(0!==r.type){if(1===r.type)return[v5.INSTANCE];9!==r.type?t.push(r):t=t.concat(r.expr)}else n=!0}if(0===t.length&&n)return[m5.INSTANCE];t.sort(p5)}return t}serialize(){return this.expr.map((e=>e.serialize())).join(" || ")}keys(){const e=[];for(let t of this.expr)e.push(...t.keys());return e}negate(){let e=[];for(let n of this.expr)e.push(n.negate());const t=e=>9===e.type?e.expr:[e];for(;e.length>1;){const n=e.shift(),i=e.shift(),r=[];for(const e of t(n))for(const n of t(i))r.push(g5.and(e,n));e.unshift(g5.or(...r))}return e[0]}}class M5 extends y5{constructor(e,t,n){super(e),this._defaultValue=t,"object"==typeof n?M5._info.push(Object.assign(Object.assign({},n),{key:e})):!0!==n&&M5._info.push({key:e,description:n,type:null!=t?typeof t:void 0})}static all(){return M5._info.values()}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return g5.not(this.key)}isEqualTo(e){return g5.equals(this.key,e)}}M5._info=[];const A5=i$("contextKeyService");function O5(e,t){return e<t?-1:e>t?1:0}function R5(e,t,n,i){return e<n?-1:e>n?1:t<i?-1:t>i?1:0}var P5,F5;(F5=P5||(P5={})).DARK="dark",F5.LIGHT="light",F5.HIGH_CONTRAST="hc";const B5=i$("themeService");var W5,z5;function V5(e){return{id:e}}function U5(e){switch(e){case P5.DARK:return"vs-dark";case P5.HIGH_CONTRAST:return"hc-black";default:return"vs"}}(W5||(W5={})).isThemeColor=function(e){return e&&"object"==typeof e&&"string"==typeof e.id},function(e){e.isThemeIcon=function(e){return e&&"object"==typeof e&&"string"==typeof e.id&&(void 0===e.color||W5.isThemeColor(e.color))};const t=new RegExp(`^\\$\\((${dJ.iconNameExpression}(?:${dJ.iconModifierExpression})?)\\)$`);e.fromString=function(e){const n=t.exec(e);if(!n)return;let[,i]=n;return{id:i}},e.modify=function(e,t){let n=e.id;const i=n.lastIndexOf("~");return-1!==i&&(n=n.substring(0,i)),t&&(n=`${n}~${t}`),{id:n}},e.isEqual=function(e,t){var n,i;return e.id===t.id&&(null===(n=e.color)||void 0===n?void 0:n.id)===(null===(i=t.color)||void 0===i?void 0:i.id)},e.asThemeIcon=function(e){return{id:e.id}},e.asClassNameArray=dJ.asClassNameArray,e.asClassName=dJ.asClassName,e.asCSSSelector=dJ.asCSSSelector}(z5||(z5={}));const H5="base.contributions.theming";let j5=new class{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new EG}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),gG((()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)}))}getThemingParticipants(){return this.themingParticipants}};function G5(e){return j5.onColorThemeChange(e)}d3.add(H5,j5);class K5 extends mG{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange((e=>this.onThemeChange(e))))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}var q5=function(e,t){return function(n,i){t(n,i,e)}};function $5(e){return void 0!==e.command}class Y5{constructor(e){this.id=Y5._idPool++,this._debugName=e}}Y5._idPool=0,Y5.CommandPalette=new Y5("CommandPalette"),Y5.EditorContext=new Y5("EditorContext"),Y5.SimpleEditorContext=new Y5("SimpleEditorContext"),Y5.EditorContextCopy=new Y5("EditorContextCopy"),Y5.EditorContextPeek=new Y5("EditorContextPeek"),Y5.MenubarEditMenu=new Y5("MenubarEditMenu"),Y5.MenubarCopy=new Y5("MenubarCopy"),Y5.MenubarGoMenu=new Y5("MenubarGoMenu"),Y5.MenubarSelectionMenu=new Y5("MenubarSelectionMenu"),Y5.InlineCompletionsActions=new Y5("InlineCompletionsActions");const X5=i$("menuService"),Z5=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new EG,this.onDidChangeMenu=this._onDidChangeMenu.event,this._commandPaletteChangeEvent={has:e=>e===Y5.CommandPalette}}addCommand(e){return this.addCommands(lG.single(e))}addCommands(e){for(const t of e)this._commands.set(t.id,t);return this._onDidChangeMenu.fire(this._commandPaletteChangeEvent),gG((()=>{let t=!1;for(const n of e)t=this._commands.delete(n.id)||t;t&&this._onDidChangeMenu.fire(this._commandPaletteChangeEvent)}))}getCommand(e){return this._commands.get(e)}getCommands(){const e=new Map;return this._commands.forEach(((t,n)=>e.set(n,t))),e}appendMenuItem(e,t){return this.appendMenuItems(lG.single({id:e,item:t}))}appendMenuItems(e){const t=new Set,n=new bG;for(const{id:i,item:r}of e){let e=this._menuItems.get(i);e||(e=new bG,this._menuItems.set(i,e)),n.push(e.push(r)),t.add(i)}return this._onDidChangeMenu.fire(t),gG((()=>{if(n.size>0){for(let e of n)e();this._onDidChangeMenu.fire(t),n.clear()}}))}getMenuItems(e){let t;return t=this._menuItems.has(e)?[...this._menuItems.get(e)]:[],e===Y5.CommandPalette&&this._appendImplicitItems(t),t}_appendImplicitItems(e){const t=new Set;for(const n of e)$5(n)&&(t.add(n.command.id),n.alt&&t.add(n.alt.id));this._commands.forEach(((n,i)=>{t.has(i)||e.push({command:n})}))}};class Q5 extends c5{constructor(e,t,n,i){super(`submenuitem.${e.submenu.id}`,"string"==typeof e.title?e.title:e.title.value,[],"submenu"),this.item=e,this._menuService=t,this._contextKeyService=n,this._options=i}get actions(){const e=[],t=this._menuService.createMenu(this.item.submenu,this._contextKeyService),n=t.getActions(this._options);t.dispose();for(const[,i]of n)i.length>0&&(e.push(...i),e.push(new l5));return e.length&&e.pop(),e}}let J5=class e{constructor(t,n,i,r,o){var s;if(this._commandService=o,this.id=t.id,this.label=(null==i?void 0:i.renderShortTitle)&&t.shortTitle?"string"==typeof t.shortTitle?t.shortTitle:t.shortTitle.value:"string"==typeof t.title?t.title:t.title.value,this.tooltip=null!==(s=t.tooltip)&&void 0!==s?s:"",this.enabled=!t.precondition||r.contextMatchesRules(t.precondition),this.checked=!1,t.toggled){const e=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=r.contextMatchesRules(e.condition),this.checked&&e.tooltip&&(this.tooltip="string"==typeof e.tooltip?e.tooltip:e.tooltip.value),e.title&&(this.label="string"==typeof e.title?e.title:e.title.value)}this.item=t,this.alt=n?new e(n,void 0,i,r,o):void 0,this._options=i,z5.isThemeIcon(t.icon)&&(this.class=dJ.asClassName(t.icon))}dispose(){}run(...e){var t,n;let i=[];return(null===(t=this._options)||void 0===t?void 0:t.arg)&&(i=[...i,this._options.arg]),(null===(n=this._options)||void 0===n?void 0:n.shouldForwardArgs)&&(i=[...i,...e]),this._commandService.executeCommand(this.id,...i)}};J5=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([q5(3,A5),q5(4,KZ)],J5);const e6=i$("telemetryService");class t6{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this._description=e.description}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let e=t.kbExpr;this.precondition&&(e=e?g5.and(e,this.precondition):this.precondition);const n={id:this.id,weight:t.weight,args:t.args,when:e,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};o4.registerKeybindingRule(n)}}qZ.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),description:this._description})}_registerMenuItem(e){Z5.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class n6 extends t6{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,n){return this._implementations.push({priority:e,name:t,implementation:n}),this._implementations.sort(((e,t)=>t.priority-e.priority)),{dispose:()=>{for(let e=0;e<this._implementations.length;e++)if(this._implementations[e].implementation===n)return void this._implementations.splice(e,1)}}}runCommand(e,t){const n=e.get(K1);for(const i of this._implementations){const r=i.implementation(e,t);if(r){if(n.trace(`Command '${this.id}' was handled by '${i.name}'.`),"boolean"==typeof r)return;return r}}}}class i6 extends t6{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class r6 extends t6{static bindToContribution(e){return class extends r6{constructor(e){super(e),this._callback=e.handler}runEditorCommand(t,n,i){e(n)&&this._callback(e(n),i)}}}runCommand(e,t){const n=e.get(o$),i=n.getFocusedCodeEditor()||n.getActiveCodeEditor();if(i)return i.invokeWithinContext((e=>{if(e.get(A5).contextMatchesRules(GZ(this.precondition)))return this.runEditorCommand(e,i,t)}))}}class o6 extends r6{constructor(e){super(o6.convertOptions(e)),this.label=e.label,this.alias=e.alias}static convertOptions(e){let t;function n(t){return t.menuId||(t.menuId=Y5.EditorContext),t.title||(t.title=e.label),t.when=g5.and(e.precondition,t.when),t}return t=Array.isArray(e.menuOpts)?e.menuOpts:e.menuOpts?[e.menuOpts]:[],Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(n)):e.contextMenuOpts&&t.push(n(e.contextMenuOpts)),e.menuOpts=t,e}runEditorCommand(e,t,n){return this.reportTelemetry(e,t),this.run(e,t,n||{})}reportTelemetry(e,t){e.get(e6).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class s6 extends o6{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort(((e,t)=>t[0]-e[0])),{dispose:()=>{for(let e=0;e<this._implementations.length;e++)if(this._implementations[e][1]===t)return void this._implementations.splice(e,1)}}}run(e,t,n){for(const i of this._implementations){const r=i[1](e,t,n);if(r){if("boolean"==typeof r)return;return r}}}}function a6(e,t){qZ.registerCommand(e,(function(e,...n){const[i,r]=n;WZ(_K.isUri(i)),WZ(IK.isIPosition(r));const o=e.get(iJ).getModel(i);if(o){const e=IK.lift(r);return t(o,e,...n.slice(2))}return e.get(n0).createModelReference(i).then((e=>new Promise(((i,o)=>{try{i(t(e.object.textEditorModel,IK.lift(r),n.slice(2)))}catch(s){o(s)}})).finally((()=>{e.dispose()}))))}))}function l6(e){return p6.INSTANCE.registerEditorCommand(e),e}function c6(e){const t=new e;return p6.INSTANCE.registerEditorAction(t),t}function u6(e){return p6.INSTANCE.registerEditorAction(e),e}function h6(e){p6.INSTANCE.registerEditorAction(e)}function d6(e,t){p6.INSTANCE.registerEditorContribution(e,t)}var f6,g6;(g6=f6||(f6={})).getEditorCommand=function(e){return p6.INSTANCE.getEditorCommand(e)},g6.getEditorActions=function(){return p6.INSTANCE.getEditorActions()},g6.getEditorContributions=function(){return p6.INSTANCE.getEditorContributions()},g6.getSomeEditorContributions=function(e){return p6.INSTANCE.getEditorContributions().filter((t=>e.indexOf(t.id)>=0))},g6.getDiffEditorContributions=function(){return p6.INSTANCE.getDiffEditorContributions()};class p6{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t){this.editorContributions.push({id:e,ctor:t})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions.slice(0)}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}}function m6(e){return e.register(),e}p6.INSTANCE=new p6,d3.add("editor.contributions",p6.INSTANCE);const v6=m6(new n6({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:Y5.MenubarEditMenu,group:"1_do",title:GH(0,"&&Undo"),order:1},{menuId:Y5.CommandPalette,group:"",title:GH(0,"Undo"),order:1}]}));m6(new i6(v6,{id:"default:undo",precondition:void 0}));const y6=m6(new n6({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:Y5.MenubarEditMenu,group:"1_do",title:GH(0,"&&Redo"),order:2},{menuId:Y5.CommandPalette,group:"",title:GH(0,"Redo"),order:1}]}));m6(new i6(y6,{id:"default:redo",precondition:void 0}));const _6=m6(new n6({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:Y5.MenubarSelectionMenu,group:"1_basic",title:GH(0,"&&Select All"),order:1},{menuId:Y5.CommandPalette,group:"",title:GH(0,"Select All"),order:1}]}));let b6=class{constructor(e,t){}dispose(){}};var w6,C6;b6.ID="editor.contrib.markerDecorations",b6=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([(w6=1,C6=r5,function(e,t){C6(e,t,w6)})],b6),d6(b6.ID,b6);class S6{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class x6{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(){this._createDomElements(),document.body.appendChild(this._container),this._readFromDomElements(),document.body.removeChild(this._container),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");t.style.fontFamily=this._bareFontInfo.getMassagedFontFamily(),t.style.fontWeight=this._bareFontInfo.fontWeight,t.style.fontSize=this._bareFontInfo.fontSize+"px",t.style.fontFeatureSettings=this._bareFontInfo.fontFeatureSettings,t.style.lineHeight=this._bareFontInfo.lineHeight+"px",t.style.letterSpacing=this._bareFontInfo.letterSpacing+"px",e.appendChild(t);const n=document.createElement("div");n.style.fontFamily=this._bareFontInfo.getMassagedFontFamily(),n.style.fontWeight="bold",n.style.fontSize=this._bareFontInfo.fontSize+"px",n.style.fontFeatureSettings=this._bareFontInfo.fontFeatureSettings,n.style.lineHeight=this._bareFontInfo.lineHeight+"px",n.style.letterSpacing=this._bareFontInfo.letterSpacing+"px",e.appendChild(n);const i=document.createElement("div");i.style.fontFamily=this._bareFontInfo.getMassagedFontFamily(),i.style.fontWeight=this._bareFontInfo.fontWeight,i.style.fontSize=this._bareFontInfo.fontSize+"px",i.style.fontFeatureSettings=this._bareFontInfo.fontFeatureSettings,i.style.lineHeight=this._bareFontInfo.lineHeight+"px",i.style.letterSpacing=this._bareFontInfo.letterSpacing+"px",i.style.fontStyle="italic",e.appendChild(i);const r=[];for(const o of this._requests){let e;0===o.type&&(e=t),2===o.type&&(e=n),1===o.type&&(e=i),e.appendChild(document.createElement("br"));const s=document.createElement("span");x6._render(s,o),e.appendChild(s),r.push(s)}this._container=e,this._testElements=r}static _render(e,t){if(" "===t.chr){let t=" ";for(let e=0;e<8;e++)t+=t;e.innerText=t}else{let n=t.chr;for(let e=0;e<8;e++)n+=n;e.textContent=n}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const t=this._requests[e],n=this._testElements[e];t.fulfill(n.offsetWidth/256)}}}class E6 extends mG{constructor(e,t,n){super(),this.referenceDomElement=e,this.changeCallback=n,this.width=-1,this.height=-1,this.resizeObserver=null,this.measureReferenceDomElementToken=-1,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this.width}getHeight(){return this.height}startObserving(){"undefined"!=typeof ResizeObserver?!this.resizeObserver&&this.referenceDomElement&&(this.resizeObserver=new ResizeObserver((e=>{e&&e[0]&&e[0].contentRect?this.observe({width:e[0].contentRect.width,height:e[0].contentRect.height}):this.observe()})),this.resizeObserver.observe(this.referenceDomElement)):-1===this.measureReferenceDomElementToken&&(this.measureReferenceDomElementToken=setInterval((()=>this.observe()),100))}stopObserving(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),-1!==this.measureReferenceDomElementToken&&(clearInterval(this.measureReferenceDomElementToken),this.measureReferenceDomElementToken=-1)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let n=0,i=0;t?(n=t.width,i=t.height):this.referenceDomElement&&(n=this.referenceDomElement.clientWidth,i=this.referenceDomElement.clientHeight),n=Math.max(5,n),i=Math.max(5,i),this.width===n&&this.height===i||(this.width=n,this.height=i,e&&this.changeCallback())}}class k6{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const n=e.getId();this._keys[n]=e,this._values[n]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map((e=>this._values[e]))}}class L6 extends mG{constructor(){super(),this._onDidChange=this._register(new EG),this.onDidChange=this._onDidChange.event,this._cache=new k6,this._evictUntrustedReadingsTimeout=-1}dispose(){-1!==this._evictUntrustedReadingsTimeout&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearCache(){this._cache=new k6,this._onDidChange.fire()}_writeToCache(e,t){this._cache.put(e,t),t.isTrusted||-1!==this._evictUntrustedReadingsTimeout||(this._evictUntrustedReadingsTimeout=setTimeout((()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings()}),5e3))}_evictUntrustedReadings(){const e=this._cache.getValues();let t=!1;for(const n of e)n.isTrusted||(t=!0,this._cache.remove(n));t&&this._onDidChange.fire()}readConfiguration(e){if(!this._cache.has(e)){let t=L6._actualReadConfiguration(e);(t.typicalHalfwidthCharacterWidth<=2||t.typicalFullwidthCharacterWidth<=2||t.spaceWidth<=2||t.maxDigitWidth<=2)&&(t=new _Q({zoomLevel:a$(),pixelRatio:c$(),fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:t.isMonospace,typicalHalfwidthCharacterWidth:Math.max(t.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(t.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:t.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(t.spaceWidth,5),middotWidth:Math.max(t.middotWidth,5),wsmiddotWidth:Math.max(t.wsmiddotWidth,5),maxDigitWidth:Math.max(t.maxDigitWidth,5)},!1)),this._writeToCache(e,t)}return this._cache.get(e)}static createRequest(e,t,n,i){const r=new S6(e,t);return n.push(r),i&&i.push(r),r}static _actualReadConfiguration(e){const t=[],n=[],i=this.createRequest("n",0,t,n),r=this.createRequest("ｍ",0,t,null),o=this.createRequest(" ",0,t,n),s=this.createRequest("0",0,t,n),a=this.createRequest("1",0,t,n),l=this.createRequest("2",0,t,n),c=this.createRequest("3",0,t,n),u=this.createRequest("4",0,t,n),h=this.createRequest("5",0,t,n),d=this.createRequest("6",0,t,n),f=this.createRequest("7",0,t,n),g=this.createRequest("8",0,t,n),p=this.createRequest("9",0,t,n),m=this.createRequest("→",0,t,n),v=this.createRequest("￫",0,t,null),y=this.createRequest("·",0,t,n),_=this.createRequest(String.fromCharCode(11825),0,t,null);this.createRequest("|",0,t,n),this.createRequest("/",0,t,n),this.createRequest("-",0,t,n),this.createRequest("_",0,t,n),this.createRequest("i",0,t,n),this.createRequest("l",0,t,n),this.createRequest("m",0,t,n),this.createRequest("|",1,t,n),this.createRequest("_",1,t,n),this.createRequest("i",1,t,n),this.createRequest("l",1,t,n),this.createRequest("m",1,t,n),this.createRequest("n",1,t,n),this.createRequest("|",2,t,n),this.createRequest("_",2,t,n),this.createRequest("i",2,t,n),this.createRequest("l",2,t,n),this.createRequest("m",2,t,n),this.createRequest("n",2,t,n),function(e,t){new x6(e,t).read()}(e,t);const b=Math.max(s.width,a.width,l.width,c.width,u.width,h.width,d.width,f.width,g.width,p.width);let w=e.fontFeatureSettings===zj.OFF;const C=n[0].width;for(let E=1,k=n.length;w&&E<k;E++){const e=C-n[E].width;if(e<-.001||e>.001){w=!1;break}}let S=!0;w&&v.width!==C&&(S=!1),v.width>m.width&&(S=!1);const x=s$.INSTANCE.getTimeSinceLastZoomLevelChanged()>2e3;return new _Q({zoomLevel:a$(),pixelRatio:c$(),fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,fontFeatureSettings:e.fontFeatureSettings,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:w,typicalHalfwidthCharacterWidth:i.width,typicalFullwidthCharacterWidth:r.width,canUseHalfwidthRightwardsArrow:S,spaceWidth:o.width,middotWidth:y.width,wsmiddotWidth:_.width,maxDigitWidth:b},x)}}L6.INSTANCE=new L6;class D6 extends P3{constructor(e,t,n=null,i){super(e,t),this.accessibilityService=i,this._elementSizeObserver=this._register(new E6(n,t.dimension,(()=>this._recomputeOptions()))),this._register(L6.INSTANCE.onDidChange((()=>this._recomputeOptions()))),this._validatedOptions.get(10)&&this._elementSizeObserver.startObserving(),this._register(l$((e=>this._recomputeOptions()))),this._register(this.accessibilityService.onDidChangeScreenReaderOptimized((()=>this._recomputeOptions()))),this._recomputeOptions()}static applyFontInfoSlow(e,t){e.style.fontFamily=t.getMassagedFontFamily(),e.style.fontWeight=t.fontWeight,e.style.fontSize=t.fontSize+"px",e.style.fontFeatureSettings=t.fontFeatureSettings,e.style.lineHeight=t.lineHeight+"px",e.style.letterSpacing=t.letterSpacing+"px"}static applyFontInfo(e,t){e.setFontFamily(t.getMassagedFontFamily()),e.setFontWeight(t.fontWeight),e.setFontSize(t.fontSize),e.setFontFeatureSettings(t.fontFeatureSettings),e.setLineHeight(t.lineHeight),e.setLetterSpacing(t.letterSpacing)}observeReferenceElement(e){this._elementSizeObserver.observe(e)}updatePixelRatio(){this._recomputeOptions()}static _getExtraEditorClassName(){let e="";return g$||p$||(e+="no-user-select "),g$&&(e+="no-minimap-shadow "),lj&&(e+="mac "),e}_getEnvConfiguration(){return{extraEditorClassName:D6._getExtraEditorClassName(),outerWidth:this._elementSizeObserver.getWidth(),outerHeight:this._elementSizeObserver.getHeight(),emptySelectionClipboard:d$||h$,pixelRatio:c$(),zoomLevel:a$(),accessibilitySupport:this.accessibilityService.isScreenReaderOptimized()?2:this.accessibilityService.getAccessibilitySupport()}}readConfiguration(e){return L6.INSTANCE.readConfiguration(e)}}class N6{constructor(e){this.domNode=e,this._maxWidth=-1,this._width=-1,this._height=-1,this._top=-1,this._left=-1,this._bottom=-1,this._right=-1,this._fontFamily="",this._fontWeight="",this._fontSize=-1,this._fontFeatureSettings="",this._lineHeight=-1,this._letterSpacing=-100,this._className="",this._display="",this._position="",this._visibility="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.domNode.style.maxWidth=this._maxWidth+"px")}setWidth(e){this._width!==e&&(this._width=e,this.domNode.style.width=this._width+"px")}setHeight(e){this._height!==e&&(this._height=e,this.domNode.style.height=this._height+"px")}setTop(e){this._top!==e&&(this._top=e,this.domNode.style.top=this._top+"px")}unsetTop(){-1!==this._top&&(this._top=-1,this.domNode.style.top="")}setLeft(e){this._left!==e&&(this._left=e,this.domNode.style.left=this._left+"px")}setBottom(e){this._bottom!==e&&(this._bottom=e,this.domNode.style.bottom=this._bottom+"px")}setRight(e){this._right!==e&&(this._right=e,this.domNode.style.right=this._right+"px")}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){this._fontSize!==e&&(this._fontSize=e,this.domNode.style.fontSize=this._fontSize+"px")}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setLineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.domNode.style.lineHeight=this._lineHeight+"px")}setLetterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.domNode.style.letterSpacing=this._letterSpacing+"px")}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function I6(e){return new N6(e)}function T6(e,t,n){let i=null,r=null;if("function"==typeof n.value?(i="value",r=n.value,0!==r.length&&console.warn("Memoize should only be used in functions with zero parameters")):"function"==typeof n.get&&(i="get",r=n.get),!r)throw new Error("not supported");const o=`$memoize$${t}`;n[i]=function(...e){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:r.apply(this,e)}),this[o]}}var M6,A6;(A6=M6||(M6={})).Tap="-monaco-gesturetap",A6.Change="-monaco-gesturechange",A6.Start="-monaco-gesturestart",A6.End="-monaco-gesturesend",A6.Contextmenu="-monaco-gesturecontextmenu";class O6 extends mG{constructor(){super(),this.dispatched=!1,this.activeTouches={},this.handle=null,this.targets=[],this.ignoreTargets=[],this._lastSetTapCountTime=0,this._register(Q$(document,"touchstart",(e=>this.onTouchStart(e)),{passive:!1})),this._register(Q$(document,"touchend",(e=>this.onTouchEnd(e)))),this._register(Q$(document,"touchmove",(e=>this.onTouchMove(e)),{passive:!1}))}static addTarget(e){return O6.isTouchDevice()?(O6.INSTANCE||(O6.INSTANCE=new O6),O6.INSTANCE.targets.push(e),{dispose:()=>{O6.INSTANCE.targets=O6.INSTANCE.targets.filter((t=>t!==e))}}):mG.None}static ignoreTarget(e){return O6.isTouchDevice()?(O6.INSTANCE||(O6.INSTANCE=new O6),O6.INSTANCE.ignoreTargets.push(e),{dispose:()=>{O6.INSTANCE.ignoreTargets=O6.INSTANCE.ignoreTargets.filter((t=>t!==e))}}):mG.None}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||window.navigator.msMaxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,i=e.targetTouches.length;n<i;n++){let i=e.targetTouches.item(n);this.activeTouches[i.identifier]={id:i.identifier,initialTarget:i.target,initialTimeStamp:t,initialPageX:i.pageX,initialPageY:i.pageY,rollingTimestamps:[t],rollingPageX:[i.pageX],rollingPageY:[i.pageY]};let r=this.newGestureEvent(M6.Start,i.target);r.pageX=i.pageX,r.pageY=i.pageY,this.dispatchEvent(r)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e){let t=Date.now(),n=Object.keys(this.activeTouches).length;for(let i=0,r=e.changedTouches.length;i<r;i++){let r=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("move of an UNKNOWN touch",r);continue}let o=this.activeTouches[r.identifier],s=Date.now()-o.initialTimeStamp;if(s<O6.HOLD_DELAY&&Math.abs(o.initialPageX-L1(o.rollingPageX))<30&&Math.abs(o.initialPageY-L1(o.rollingPageY))<30){let e=this.newGestureEvent(M6.Tap,o.initialTarget);e.pageX=L1(o.rollingPageX),e.pageY=L1(o.rollingPageY),this.dispatchEvent(e)}else if(s>=O6.HOLD_DELAY&&Math.abs(o.initialPageX-L1(o.rollingPageX))<30&&Math.abs(o.initialPageY-L1(o.rollingPageY))<30){let e=this.newGestureEvent(M6.Contextmenu,o.initialTarget);e.pageX=L1(o.rollingPageX),e.pageY=L1(o.rollingPageY),this.dispatchEvent(e)}else if(1===n){let e=L1(o.rollingPageX),n=L1(o.rollingPageY),i=L1(o.rollingTimestamps)-o.rollingTimestamps[0],r=e-o.rollingPageX[0],s=n-o.rollingPageY[0];const a=this.targets.filter((e=>o.initialTarget instanceof Node&&e.contains(o.initialTarget)));this.inertia(a,t,Math.abs(r)/i,r>0?1:-1,e,Math.abs(s)/i,s>0?1:-1,n)}this.dispatchEvent(this.newGestureEvent(M6.End,o.initialTarget)),delete this.activeTouches[r.identifier]}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let n=document.createEvent("CustomEvent");return n.initEvent(e,!1,!0),n.initialTarget=t,n.tapCount=0,n}dispatchEvent(e){if(e.type===M6.Tap){const t=(new Date).getTime();let n=0;n=t-this._lastSetTapCountTime>O6.CLEAR_TAP_COUNT_TIME?1:2,this._lastSetTapCountTime=t,e.tapCount=n}else e.type!==M6.Change&&e.type!==M6.Contextmenu||(this._lastSetTapCountTime=0);for(let t=0;t<this.ignoreTargets.length;t++)if(e.initialTarget instanceof Node&&this.ignoreTargets[t].contains(e.initialTarget))return;this.targets.forEach((t=>{e.initialTarget instanceof Node&&t.contains(e.initialTarget)&&(t.dispatchEvent(e),this.dispatched=!0)}))}inertia(e,t,n,i,r,o,s,a){this.handle=oY((()=>{let l=Date.now(),c=l-t,u=0,h=0,d=!0;n+=O6.SCROLL_FRICTION*c,o+=O6.SCROLL_FRICTION*c,n>0&&(d=!1,u=i*n*c),o>0&&(d=!1,h=s*o*c);let f=this.newGestureEvent(M6.Change);f.translationX=u,f.translationY=h,e.forEach((e=>e.dispatchEvent(f))),d||this.inertia(e,l,n,i,r+u,o,s,a+h)}))}onTouchMove(e){let t=Date.now();for(let n=0,i=e.changedTouches.length;n<i;n++){let i=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(i.identifier))){console.warn("end of an UNKNOWN touch",i);continue}let r=this.activeTouches[i.identifier],o=this.newGestureEvent(M6.Change,r.initialTarget);o.translationX=i.pageX-L1(r.rollingPageX),o.translationY=i.pageY-L1(r.rollingPageY),o.pageX=i.pageX,o.pageY=i.pageY,this.dispatchEvent(o),r.rollingPageX.length>3&&(r.rollingPageX.shift(),r.rollingPageY.shift(),r.rollingTimestamps.shift()),r.rollingPageX.push(i.pageX),r.rollingPageY.push(i.pageY),r.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}}function R6(e,t){let n=new L$(t);return n.preventDefault(),{leftButton:n.leftButton,buttons:n.buttons,posx:n.posx,posy:n.posy}}O6.SCROLL_FRICTION=-.005,O6.HOLD_DELAY=700,O6.CLEAR_TAP_COUNT_TIME=400,function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);o>3&&s&&Object.defineProperty(t,n,s)}([T6],O6,"isTouchDevice",null);class P6{constructor(){this._hooks=new pG,this._mouseMoveEventMerger=null,this._mouseMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._mouseMoveEventMerger=null,this._mouseMoveCallback=null;const n=this._onStopCallback;this._onStopCallback=null,e&&n&&n(t)}isMonitoring(){return!!this._mouseMoveEventMerger}startMonitoring(e,t,n,i,r){if(this.isMonitoring())return;this._mouseMoveEventMerger=n,this._mouseMoveCallback=i,this._onStopCallback=r;const o=k$.getSameOriginWindowChain(),s=dj?"pointermove":"mousemove",a=o.map((e=>e.window.document)),l=LY(e);l&&a.unshift(l);for(const c of a)this._hooks.add(uY(c,s,(e=>{e.buttons===t?this._mouseMoveCallback(e):this.stopMonitoring(!0)}),((e,t)=>this._mouseMoveEventMerger(e,t)))),this._hooks.add(Q$(c,"mouseup",(e=>this.stopMonitoring(!0))));if(k$.hasDifferentOriginAncestor()){let e=o[o.length-1];this._hooks.add(Q$(e.window.document,"mouseout",(e=>{"html"===new L$(e).target.tagName.toLowerCase()&&this.stopMonitoring(!0)}))),this._hooks.add(Q$(e.window.document,"mouseover",(e=>{"html"===new L$(e).target.tagName.toLowerCase()&&this.stopMonitoring(!0)}))),this._hooks.add(Q$(e.window.document.body,"mouseleave",(e=>{this.stopMonitoring(!0)})))}}}class F6{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(){return new B6(this.x-vY.scrollX,this.y-vY.scrollY)}}class B6{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(){return new F6(this.clientX+vY.scrollX,this.clientY+vY.scrollY)}}class W6{constructor(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i,this._editorPagePositionBrand=void 0}}function z6(e){const t=mY(e);return new W6(t.left,t.top,t.width,t.height)}class V6 extends L${constructor(e,t){super(e),this._editorMouseEventBrand=void 0,this.pos=new F6(this.posx,this.posy),this.editorPos=z6(t)}}class U6{constructor(e){this._editorViewDomNode=e}_create(e){return new V6(e,this._editorViewDomNode)}onContextMenu(e,t){return Q$(e,"contextmenu",(e=>{t(this._create(e))}))}onMouseUp(e,t){return Q$(e,"mouseup",(e=>{t(this._create(e))}))}onMouseDown(e,t){return Q$(e,"mousedown",(e=>{t(this._create(e))}))}onMouseLeave(e,t){return iY(e,(e=>{t(this._create(e))}))}onMouseMoveThrottled(e,t,n,i){return uY(e,"mousemove",t,((e,t)=>n(e,this._create(t))),i)}}class H6{constructor(e){this._editorViewDomNode=e}_create(e){return new V6(e,this._editorViewDomNode)}onPointerUp(e,t){return Q$(e,"pointerup",(e=>{t(this._create(e))}))}onPointerDown(e,t){return Q$(e,"pointerdown",(e=>{t(this._create(e))}))}onPointerLeave(e,t){return i=e=>{t(this._create(e))},Q$(n=e,"pointerout",(e=>{let t=e.relatedTarget;for(;t&&t!==n;)t=t.parentNode;t!==n&&i(e)}));var n,i}onPointerMoveThrottled(e,t,n,i){return uY(e,"pointermove",t,((e,t)=>n(e,this._create(t))),i)}}class j6 extends mG{constructor(e){super(),this._editorViewDomNode=e,this._globalMouseMoveMonitor=this._register(new P6),this._keydownListener=null}startMonitoring(e,t,n,i,r){this._keydownListener=eY(document,"keydown",(e=>{e.toKeybinding().isModifierKey()||this._globalMouseMoveMonitor.stopMonitoring(!0,e.browserEvent)}),!0);this._globalMouseMoveMonitor.startMonitoring(e,t,((e,t)=>n(e,new V6(t,this._editorViewDomNode))),i,(e=>{this._keydownListener.dispose(),r(e)}))}stopMonitoring(){this._globalMouseMoveMonitor.stopMonitoring(!0)}}class G6 extends mG{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let n=0,i=e.length;n<i;n++){let i=e[n];switch(i.type){case 0:this.onCompositionStart(i)&&(t=!0);break;case 1:this.onCompositionEnd(i)&&(t=!0);break;case 2:this.onConfigurationChanged(i)&&(t=!0);break;case 3:this.onCursorStateChanged(i)&&(t=!0);break;case 4:this.onDecorationsChanged(i)&&(t=!0);break;case 5:this.onFlushed(i)&&(t=!0);break;case 6:this.onFocusChanged(i)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(i)&&(t=!0);break;case 8:this.onLineMappingChanged(i)&&(t=!0);break;case 9:this.onLinesChanged(i)&&(t=!0);break;case 10:this.onLinesDeleted(i)&&(t=!0);break;case 11:this.onLinesInserted(i)&&(t=!0);break;case 12:this.onRevealRangeRequest(i)&&(t=!0);break;case 13:this.onScrollChanged(i)&&(t=!0);break;case 15:this.onTokensChanged(i)&&(t=!0);break;case 14:this.onThemeChanged(i)&&(t=!0);break;case 16:this.onTokensColorsChanged(i)&&(t=!0);break;case 17:this.onZonesChanged(i)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(i)}}t&&(this._shouldRender=!0)}}class K6 extends G6{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class q6{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return null===t?0:parseInt(t,10)}static collect(e,t){let n=[],i=0;for(;e&&e!==document.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(n[i++]=this.read(e)),e=e.parentElement;const r=new Uint8Array(i);for(let o=0;o<i;o++)r[o]=n[i-o-1];return r}}class $6 extends class{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const n=this._viewLayout.getCurrentViewport();this.scrollTop=n.top,this.scrollLeft=n.left,this.viewportWidth=n.width,this.viewportHeight=n.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e){return this._viewLayout.getVerticalOffsetForLineNumber(e)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}{constructor(e,t,n){super(e,t),this._renderingContextBrand=void 0,this._viewLines=n}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class Y6{constructor(e,t,n){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=n}}class X6{constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class Z6{constructor(e,t){this.outsideRenderedLine=e,this.left=Math.round(t)}}class Q6{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class J6{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class e9{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,n,i,r){const o=this._createRange();try{return o.setStart(e,t),o.setEnd(n,i),o.getClientRects()}catch(zWe){return null}finally{this._detachRange(o,r)}}static _mergeAdjacentRanges(e){if(1===e.length)return[new X6(e[0].left,e[0].width)];e.sort(J6.compare);let t=[],n=0,i=e[0].left,r=e[0].width;for(let o=1,s=e.length;o<s;o++){const s=e[o],a=s.left,l=s.width;i+r+.9>=a?r=Math.max(r,a+l-i):(t[n++]=new X6(i,r),i=a,r=l)}return t[n++]=new X6(i,r),t}static _createHorizontalRangesFromClientRects(e,t){if(!e||0===e.length)return null;const n=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];n[i]=new J6(Math.max(0,r.left-t),r.width)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,n,i,r,o,s){const a=e.children.length-1;if(0>a)return null;if((t=Math.min(a,Math.max(0,t)))===(i=Math.min(a,Math.max(0,i)))&&n===r&&0===n&&!e.children[t].firstChild){const n=e.children[t].getClientRects();return this._createHorizontalRangesFromClientRects(n,o)}t!==i&&i>0&&0===r&&(i--,r=1073741824);let l=e.children[t].firstChild,c=e.children[i].firstChild;if(l&&c||(!l&&0===n&&t>0&&(l=e.children[t-1].firstChild,n=1073741824),!c&&0===r&&i>0&&(c=e.children[i-1].firstChild,r=1073741824)),!l||!c)return null;n=Math.min(l.textContent.length,Math.max(0,n)),r=Math.min(c.textContent.length,Math.max(0,r));const u=this._readClientRects(l,n,c,r,s);return this._createHorizontalRangesFromClientRects(u,o)}}const t9=!!uj||!(cj||h$||g$);let n9=!0;class i9{constructor(e,t){this._domNode=e,this._clientRectDeltaLeft=0,this._clientRectDeltaLeftRead=!1,this.endNode=t}get clientRectDeltaLeft(){return this._clientRectDeltaLeftRead||(this._clientRectDeltaLeftRead=!0,this._clientRectDeltaLeft=this._domNode.getBoundingClientRect().left),this._clientRectDeltaLeft}}class r9{constructor(e,t){this.themeType=t;const n=e.options,i=n.get(40);this.renderWhitespace=n.get(86),this.renderControlCharacters=n.get(80),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.useMonospaceOptimizations=i.isMonospace&&!n.get(27),this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=n.get(56),this.stopRenderingLineAfter=n.get(103),this.fontLigatures=n.get(41)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}class o9{constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(!this._renderedViewLine)throw new Error("I have no rendered view line to set the dom node to...");this._renderedViewLine.domNode=I6(e)}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return(this._options.themeType===P5.HIGH_CONTRAST||"selection"===this._options.renderWhitespace)&&(this._isMaybeInvalid=!0,!0)}renderLine(e,t,n,i){if(!1===this._isMaybeInvalid)return!1;this._isMaybeInvalid=!1;const r=n.getViewLineRenderingData(e),o=this._options,s=d2.filter(r.inlineDecorations,e,r.minColumn,r.maxColumn);let a=null;if(o.themeType===P5.HIGH_CONTRAST||"selection"===this._options.renderWhitespace){const t=n.selections;for(const n of t){if(n.endLineNumber<e||n.startLineNumber>e)continue;const t=n.startLineNumber===e?n.startColumn:r.minColumn,i=n.endLineNumber===e?n.endColumn:r.maxColumn;t<i&&(o.themeType===P5.HIGH_CONTRAST||"selection"!==this._options.renderWhitespace?s.push(new d2(t,i,"inline-selected-text",0)):(a||(a=[]),a.push(new m2(t-1,i-1))))}}const l=new v2(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,r.content,r.continuesWithWrappedLine,r.isBasicASCII,r.containsRTL,r.minColumn-1,r.tokens,s,r.tabSize,r.startVisibleColumn,o.spaceWidth,o.middotWidth,o.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==zj.OFF,a);if(this._renderedViewLine&&this._renderedViewLine.input.equals(l))return!1;i.appendASCIIString('<div style="top:'),i.appendASCIIString(String(t)),i.appendASCIIString("px;height:"),i.appendASCIIString(String(this._options.lineHeight)),i.appendASCIIString('px;" class="'),i.appendASCIIString(o9.CLASS_NAME),i.appendASCIIString('">');const c=w2(l,i);i.appendASCIIString("</div>");let u=null;return n9&&t9&&r.isBasicASCII&&o.useMonospaceOptimizations&&0===c.containsForeignElements&&r.content.length<300&&l.lineTokens.getCount()<100&&(u=new s9(this._renderedViewLine?this._renderedViewLine.domNode:null,l,c.characterMapping)),u||(u=c9(this._renderedViewLine?this._renderedViewLine.domNode:null,l,c.characterMapping,c.containsRTL,c.containsForeignElements)),this._renderedViewLine=u,!0}layoutLine(e,t){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(this._options.lineHeight))}getWidth(){return this._renderedViewLine?this._renderedViewLine.getWidth():0}getWidthIsFast(){return!this._renderedViewLine||this._renderedViewLine.getWidthIsFast()}needsMonospaceFontCheck(){return!!this._renderedViewLine&&this._renderedViewLine instanceof s9}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof s9?this._renderedViewLine.monospaceAssumptionsAreValid():n9}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof s9&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,n){if(!this._renderedViewLine)return null;e|=0,t|=0,e=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,e)),t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t));const i=0|this._renderedViewLine.input.stopRenderingLineAfter;let r=!1;-1!==i&&e>i+1&&t>i+1&&(r=!0),-1!==i&&e>i+1&&(e=i+1),-1!==i&&t>i+1&&(t=i+1);const o=this._renderedViewLine.getVisibleRangesForRange(e,t,n);return o&&o.length>0?new Q6(r,o):null}getColumnOfNodeOffset(e,t,n){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t,n):1}}o9.CLASS_NAME="view-line";class s9{constructor(e,t,n){this.domNode=e,this.input=t,this._characterMapping=n,this._charWidth=t.spaceWidth}getWidth(){return this._getCharPosition(this._characterMapping.length)}getWidthIsFast(){return!0}monospaceAssumptionsAreValid(){if(!this.domNode)return n9;const e=this.getWidth(),t=this.domNode.domNode.firstChild.offsetWidth;return Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),n9=!1),n9}toSlowRenderedLine(){return c9(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,n){const i=this._getCharPosition(e),r=this._getCharPosition(t);return[new X6(i,r-i)]}_getCharPosition(e){const t=this._characterMapping.getAbsoluteOffset(e);return Math.round(this._charWidth*t)}getColumnOfNodeOffset(e,t,n){const i=t.textContent.length;let r=-1;for(;t;)t=t.previousSibling,r++;return this._characterMapping.getColumn(new y2(r,n),i)}}class a9{constructor(e,t,n,i,r){if(this.domNode=e,this.input=t,this._characterMapping=n,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!i||0===this._characterMapping.length){this._pixelOffsetCache=new Int32Array(Math.max(2,this._characterMapping.length+1));for(let e=0,t=this._characterMapping.length;e<=t;e++)this._pixelOffsetCache[e]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(){return this.domNode?(-1===this._cachedWidth&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth),this._cachedWidth):0}getWidthIsFast(){return-1!==this._cachedWidth}getVisibleRangesForRange(e,t,n){if(!this.domNode)return null;if(null!==this._pixelOffsetCache){const i=this._readPixelOffset(this.domNode,e,n);if(-1===i)return null;const r=this._readPixelOffset(this.domNode,t,n);return-1===r?null:[new X6(i,r-i)]}return this._readVisibleRangesForRange(this.domNode,e,t,n)}_readVisibleRangesForRange(e,t,n,i){if(t===n){const n=this._readPixelOffset(e,t,i);return-1===n?null:[new X6(n,0)]}return this._readRawVisibleRangesForRange(e,t,n,i)}_readPixelOffset(e,t,n){if(0===this._characterMapping.length){if(0===this._containsForeignElements)return 0;if(2===this._containsForeignElements)return 0;if(1===this._containsForeignElements)return this.getWidth();const t=this._getReadingTarget(e);return t.firstChild?t.firstChild.offsetWidth:0}if(null!==this._pixelOffsetCache){const i=this._pixelOffsetCache[t];if(-1!==i)return i;const r=this._actualReadPixelOffset(e,t,n);return this._pixelOffsetCache[t]=r,r}return this._actualReadPixelOffset(e,t,n)}_actualReadPixelOffset(e,t,n){if(0===this._characterMapping.length){const t=e9.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n.clientRectDeltaLeft,n.endNode);return t&&0!==t.length?t[0].left:-1}if(t===this._characterMapping.length&&this._isWhitespaceOnly&&0===this._containsForeignElements)return this.getWidth();const i=this._characterMapping.getDomPosition(t),r=e9.readHorizontalRanges(this._getReadingTarget(e),i.partIndex,i.charIndex,i.partIndex,i.charIndex,n.clientRectDeltaLeft,n.endNode);if(!r||0===r.length)return-1;const o=r[0].left;if(this.input.isBasicASCII){const e=this._characterMapping.getAbsoluteOffset(t),n=Math.round(this.input.spaceWidth*e);if(Math.abs(n-o)<=1)return n}return o}_readRawVisibleRangesForRange(e,t,n,i){if(1===t&&n===this._characterMapping.length)return[new X6(0,this.getWidth())];const r=this._characterMapping.getDomPosition(t),o=this._characterMapping.getDomPosition(n);return e9.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,o.partIndex,o.charIndex,i.clientRectDeltaLeft,i.endNode)}getColumnOfNodeOffset(e,t,n){const i=t.textContent.length;let r=-1;for(;t;)t=t.previousSibling,r++;return this._characterMapping.getColumn(new y2(r,n),i)}}class l9 extends a9{_readVisibleRangesForRange(e,t,n,i){const r=super._readVisibleRangesForRange(e,t,n,i);if(!r||0===r.length||t===n||1===t&&n===this._characterMapping.length)return r;if(!this.input.containsRTL){const t=this._readPixelOffset(e,n,i);if(-1!==t){const e=r[r.length-1];e.left<t&&(e.width=t-e.left)}}return r}}const c9=d$?u9:h9;function u9(e,t,n,i,r){return new l9(e,t,n,i,r)}function h9(e,t,n,i,r){return new a9(e,t,n,i,r)}function d9(e){return e.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class f9{constructor(e,t,n,i){this.oldPosition=e,this.oldText=t,this.newPosition=n,this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return 0===this.oldText.length?`(insert@${this.oldPosition} "${d9(this.newText)}")`:0===this.newText.length?`(delete@${this.oldPosition} "${d9(this.oldText)}")`:`(replace@${this.oldPosition} "${d9(this.oldText)}" with "${d9(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){const i=t.length;gZ(e,i,n),n+=4;for(let r=0;r<i;r++)dZ(e,t.charCodeAt(r),n),n+=2;return n}static _readString(e,t){const n=fZ(e,t);return k0(e,t+=4,n)}writeSize(){return 8+f9._writeStringSize(this.oldText)+f9._writeStringSize(this.newText)}write(e,t){return gZ(e,this.oldPosition,t),t+=4,gZ(e,this.newPosition,t),t+=4,t=f9._writeString(e,this.oldText,t),t=f9._writeString(e,this.newText,t)}static read(e,t,n){const i=fZ(e,t),r=fZ(e,t+=4);t+=4;const o=f9._readString(e,t);t+=f9._writeStringSize(o);const s=f9._readString(e,t);return t+=f9._writeStringSize(s),n.push(new f9(i,o,r,s)),t}}class g9{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(null===n){this._acceptCurr(i),i=this._getCurr(++t);continue}if(null===i){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){const[e,t]=g9._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(e),i=t;continue}if(n.newPosition<i.oldPosition){const[e,t]=g9._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(e),n=t;continue}let r,o;if(i.oldEnd===n.newEnd)r=n,o=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){const[e,s]=g9._splitPrev(n,i.oldLength);r=e,o=i,n=s,i=this._getCurr(++t)}else{const[t,s]=g9._splitCurr(i,n.newLength);r=n,o=t,n=this._getPrev(++e),i=s}this._result[this._resultLen++]=new f9(r.oldPosition,r.oldText,o.newPosition,o.newText),this._prevDeltaOffset+=r.newLength-r.oldLength,this._currDeltaOffset+=o.newLength-o.oldLength}const r=g9._merge(this._result);return g9._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=g9._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=g9._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new f9(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new f9(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const n=e.newText.substr(0,t),i=e.newText.substr(t);return[new f9(e.oldPosition,e.oldText,e.newPosition,n),new f9(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){const n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new f9(e.oldPosition,n,e.newPosition,e.newText),new f9(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(0===e.length)return e;let t=[],n=0,i=e[0];for(let r=1;r<e.length;r++){const o=e[r];i.oldEnd===o.oldPosition?i=new f9(i.oldPosition,i.oldText+o.oldText,i.newPosition,i.newText+o.newText):(t[n++]=i,i=o)}return t[n++]=i,t}static _removeNoOps(e){if(0===e.length)return e;let t=[],n=0;for(let i=0;i<e.length;i++){const r=e[i];r.oldText!==r.newText&&(t[n++]=r)}return t}}function p9(e){return e.toString()}class m9{constructor(e,t,n,i,r,o,s){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=n,this.afterEOL=i,this.beforeCursorState=r,this.afterCursorState=o,this.changes=s}static create(e,t){const n=e.getAlternativeVersionId(),i=y9(e);return new m9(n,n,i,i,t,t,[])}append(e,t,n,i,r){var o,s;t.length>0&&(this.changes=(o=this.changes,s=t,null===o||0===o.length?s:new g9(o,s).compress())),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+16*(e?e.length:0)}static _writeSelections(e,t,n){if(gZ(e,t?t.length:0,n),n+=4,t)for(const i of t)gZ(e,i.selectionStartLineNumber,n),n+=4,gZ(e,i.selectionStartColumn,n),n+=4,gZ(e,i.positionLineNumber,n),n+=4,gZ(e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){const i=fZ(e,t);t+=4;for(let r=0;r<i;r++){const i=fZ(e,t),r=fZ(e,t+=4),o=fZ(e,t+=4),s=fZ(e,t+=4);t+=4,n.push(new MK(i,r,o,s))}return t}serialize(){let e=10+m9._writeSelectionsSize(this.beforeCursorState)+m9._writeSelectionsSize(this.afterCursorState)+4;for(const i of this.changes)e+=i.writeSize();const t=new Uint8Array(e);let n=0;gZ(t,this.beforeVersionId,n),n+=4,gZ(t,this.afterVersionId,n),n+=4,mZ(t,this.beforeEOL,n),n+=1,mZ(t,this.afterEOL,n),n+=1,n=m9._writeSelections(t,this.beforeCursorState,n),n=m9._writeSelections(t,this.afterCursorState,n),gZ(t,this.changes.length,n),n+=4;for(const i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let n=0;const i=fZ(t,n);n+=4;const r=fZ(t,n);n+=4;const o=pZ(t,n);n+=1;const s=pZ(t,n);n+=1;const a=[];n=m9._readSelections(t,n,a);const l=[];n=m9._readSelections(t,n,l);const c=fZ(t,n);n+=4;const u=[];for(let h=0;h<c;h++)n=f9.read(t,n,u);return new m9(i,r,o,s,a,l,u)}}class v9{constructor(e,t){this.model=e,this._data=m9.create(e,t)}get type(){return 0}get resource(){return _K.isUri(this.model)?this.model:this.model.uri}get label(){return GH(0,"Typing")}toString(){return(this._data instanceof m9?this._data:m9.deserialize(this._data)).changes.map((e=>e.toString())).join(", ")}matchesResource(e){return(_K.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof m9}append(e,t,n,i,r){this._data instanceof m9&&this._data.append(e,t,n,i,r)}close(){this._data instanceof m9&&(this._data=this._data.serialize())}open(){this._data instanceof m9||(this._data=m9.deserialize(this._data))}undo(){if(_K.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof m9&&(this._data=this._data.serialize());const e=m9.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(_K.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof m9&&(this._data=this._data.serialize());const e=m9.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof m9&&(this._data=this._data.serialize()),this._data.byteLength+168}}function y9(e){return"\n"===e.getEOL()?0:1}function _9(e){return!!e&&(e instanceof v9||e instanceof class{constructor(e,t){this.type=1,this.label=e,this._isOpen=!0,this._editStackElementsArr=t.slice(0),this._editStackElementsMap=new Map;for(const n of this._editStackElementsArr){const e=p9(n.resource);this._editStackElementsMap.set(e,n)}this._delegate=null}get resources(){return this._editStackElementsArr.map((e=>e.resource))}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=p9(e);return this._editStackElementsMap.has(t)}setModel(e){const t=p9(_K.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=p9(e.uri);return!!this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).canAppend(e)}append(e,t,n,i,r){const o=p9(e.uri);this._editStackElementsMap.get(o).append(e,t,n,i,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=p9(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(const t of this._editStackElementsArr)e.push(`${EZ(t.resource)}: ${t}`);return`{${e.join(", ")}}`}})}class b9{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);_9(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);_9(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e){const t=this._undoRedoService.getLastElement(this._model.uri);if(_9(t)&&t.canAppend(this._model))return t;const n=new v9(this._model,e);return this._undoRedoService.pushElement(n),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null);this._model.setEOL(e),t.append(this._model,[],y9(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n){const i=this._getOrCreateEditStackElement(e),r=this._model.applyEdits(t,!0),o=b9._computeCursorState(n,r),s=r.map(((e,t)=>({index:t,textChange:e.textChange})));return s.sort(((e,t)=>e.textChange.oldPosition===t.textChange.oldPosition?e.index-t.index:e.textChange.oldPosition-t.textChange.oldPosition)),i.append(this._model,s.map((e=>e.textChange)),y9(this._model),this._model.getAlternativeVersionId(),o),o}static _computeCursorState(e,t){try{return e?e(t):null}catch(zWe){return nG(zWe),null}}}class w9{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function C9(e,t,n,i,r){let o;for(r.spacesDiff=0,r.looksLikeAlignment=!1,o=0;o<t&&o<i;o++){if(e.charCodeAt(o)!==n.charCodeAt(o))break}let s=0,a=0;for(let d=o;d<t;d++){32===e.charCodeAt(d)?s++:a++}let l=0,c=0;for(let d=o;d<i;d++){32===n.charCodeAt(d)?l++:c++}if(s>0&&a>0)return;if(l>0&&c>0)return;let u=Math.abs(a-c),h=Math.abs(s-l);if(0===u)return r.spacesDiff=h,void(h>0&&0<=l-1&&l-1<e.length&&l<n.length&&32!==n.charCodeAt(l)&&32===e.charCodeAt(l-1)&&44===e.charCodeAt(e.length-1)&&(r.looksLikeAlignment=!0));h%u!=0||(r.spacesDiff=h/u)}function S9(e,t,n){const i=Math.min(e.getLineCount(),1e4);let r=0,o=0,s="",a=0;const l=[2,4,6,8,3,5,7];let c=[0,0,0,0,0,0,0,0,0],u=new w9;for(let f=1;f<=i;f++){let i=e.getLineLength(f),l=e.getLineContent(f);const h=i<=65536;let d=!1,g=0,p=0,m=0;for(let t=0,n=i;t<n;t++){let n=h?l.charCodeAt(t):e.getLineCharCode(f,t);if(9===n)m++;else{if(32!==n){d=!0,g=t;break}p++}}if(!d)continue;if(m>0?r++:p>1&&o++,C9(s,a,l,g,u),u.looksLikeAlignment&&(!n||t!==u.spacesDiff))continue;let v=u.spacesDiff;v<=8&&c[v]++,s=l,a=g}let h=n;r!==o&&(h=r<o);let d=t;if(h){let e=h?0:.1*i;l.forEach((t=>{let n=c[t];n>e&&(e=n,d=t)})),4===d&&c[4]>0&&c[2]>0&&c[2]>=c[4]/2&&(d=2)}return{insertSpaces:h,tabSize:d}}function x9(e){return(1&e.metadata)>>>0}function E9(e,t){e.metadata=254&e.metadata|t<<0}function k9(e){return(2&e.metadata)>>>1==1}function L9(e,t){e.metadata=253&e.metadata|(t?1:0)<<1}function D9(e){return(4&e.metadata)>>>2==1}function N9(e,t){e.metadata=251&e.metadata|(t?1:0)<<2}function I9(e,t){e.metadata=231&e.metadata|t<<3}function T9(e,t){e.metadata=223&e.metadata|(t?1:0)<<5}class M9{constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,E9(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,N9(this,!1),I9(this,1),T9(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,L9(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;N9(this,"squiggly-error"===t||"squiggly-warning"===t||"squiggly-info"===t),I9(this,this.options.stickiness),T9(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const A9=new M9(null,0,0);A9.parent=A9,A9.left=A9,A9.right=A9,E9(A9,0);class O9{constructor(){this.root=A9,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,r){return this.root===A9?[]:function(e,t,n,i,r,o){let s=e.root,a=0,l=0,c=0,u=0,h=[],d=0;for(;s!==A9;)if(k9(s))L9(s.left,!1),L9(s.right,!1),s===s.parent.right&&(a-=s.parent.delta),s=s.parent;else{if(!k9(s.left)){if(l=a+s.maxEnd,l<t){L9(s,!0);continue}if(s.left!==A9){s=s.left;continue}}if(c=a+s.start,c>n)L9(s,!0);else{if(u=a+s.end,u>=t){s.setCachedOffsets(c,u,o);let e=!0;i&&s.ownerId&&s.ownerId!==i&&(e=!1),r&&D9(s)&&(e=!1),e&&(h[d++]=s)}L9(s,!0),s.right===A9||k9(s.right)||(a+=s.delta,s=s.right)}}return L9(e.root,!1),h}(this,e,t,n,i,r)}search(e,t,n){return this.root===A9?[]:function(e,t,n,i){let r=e.root,o=0,s=0,a=0,l=[],c=0;for(;r!==A9;){if(k9(r)){L9(r.left,!1),L9(r.right,!1),r===r.parent.right&&(o-=r.parent.delta),r=r.parent;continue}if(r.left!==A9&&!k9(r.left)){r=r.left;continue}s=o+r.start,a=o+r.end,r.setCachedOffsets(s,a,i);let e=!0;t&&r.ownerId&&r.ownerId!==t&&(e=!1),n&&D9(r)&&(e=!1),e&&(l[c++]=r),L9(r,!0),r.right===A9||k9(r.right)||(o+=r.delta,r=r.right)}return L9(e.root,!1),l}(this,e,t,n)}collectNodesFromOwner(e){return function(e,t){let n=e.root,i=[],r=0;for(;n!==A9;)k9(n)?(L9(n.left,!1),L9(n.right,!1),n=n.parent):n.left===A9||k9(n.left)?(n.ownerId===t&&(i[r++]=n),L9(n,!0),n.right===A9||k9(n.right)||(n=n.right)):n=n.left;return L9(e.root,!1),i}(this,e)}collectNodesPostOrder(){return function(e){let t=e.root,n=[],i=0;for(;t!==A9;)k9(t)?(L9(t.left,!1),L9(t.right,!1),t=t.parent):t.left===A9||k9(t.left)?t.right===A9||k9(t.right)?(n[i++]=t,L9(t,!0)):t=t.right:t=t.left;return L9(e.root,!1),n}(this)}insert(e){F9(this,e),this._normalizeDeltaIfNecessary()}delete(e){B9(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const n=e;let i=0;for(;e!==this.root;)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;const r=n.start+i,o=n.end+i;n.setCachedOffsets(r,o,t)}acceptReplace(e,t,n,i){const r=function(e,t,n){let i=e.root,r=0,o=0,s=0,a=0,l=[],c=0;for(;i!==A9;)if(k9(i))L9(i.left,!1),L9(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),i=i.parent;else{if(!k9(i.left)){if(o=r+i.maxEnd,o<t){L9(i,!0);continue}if(i.left!==A9){i=i.left;continue}}s=r+i.start,s>n?L9(i,!0):(a=r+i.end,a>=t&&(i.setCachedOffsets(s,a,0),l[c++]=i),L9(i,!0),i.right===A9||k9(i.right)||(r+=i.delta,i=i.right))}return L9(e.root,!1),l}(this,e,e+t);for(let o=0,s=r.length;o<s;o++){B9(this,r[o])}this._normalizeDeltaIfNecessary(),function(e,t,n,i){let r=e.root,o=0,s=0,a=0;const l=i-(n-t);for(;r!==A9;)if(k9(r))L9(r.left,!1),L9(r.right,!1),r===r.parent.right&&(o-=r.parent.delta),H9(r),r=r.parent;else{if(!k9(r.left)){if(s=o+r.maxEnd,s<t){L9(r,!0);continue}if(r.left!==A9){r=r.left;continue}}a=o+r.start,a>n?(r.start+=l,r.end+=l,r.delta+=l,(r.delta<-1073741824||r.delta>1073741824)&&(e.requestNormalizeDelta=!0),L9(r,!0)):(L9(r,!0),r.right===A9||k9(r.right)||(o+=r.delta,r=r.right))}L9(e.root,!1)}(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let o=0,s=r.length;o<s;o++){const s=r[o];s.start=s.cachedAbsoluteStart,s.end=s.cachedAbsoluteEnd,P9(s,e,e+t,n,i),s.maxEnd=s.end,F9(this,s)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,function(e){let t=e.root,n=0;for(;t!==A9;)t.left===A9||k9(t.left)?t.right===A9||k9(t.right)?(t.start=n+t.start,t.end=n+t.end,t.delta=0,H9(t),L9(t,!0),L9(t.left,!1),L9(t.right,!1),t===t.parent.right&&(n-=t.parent.delta),t=t.parent):(n+=t.delta,t=t.right):t=t.left;L9(e.root,!1)}(this))}}function R9(e,t,n,i){return e<n||!(e>n)&&(1!==i&&(2===i||t))}function P9(e,t,n,i,r){const o=function(e){return(24&e.metadata)>>>3}(e),s=0===o||2===o,a=1===o||2===o,l=n-t,c=i,u=Math.min(l,c),h=e.start;let d=!1;const f=e.end;let g=!1;t<=h&&f<=n&&function(e){return(32&e.metadata)>>>5==1}(e)&&(e.start=t,d=!0,e.end=t,g=!0);{const e=r?1:l>0?2:0;!d&&R9(h,s,t,e)&&(d=!0),!g&&R9(f,a,t,e)&&(g=!0)}if(u>0&&!r){const e=l>c?2:0;!d&&R9(h,s,t+u,e)&&(d=!0),!g&&R9(f,a,t+u,e)&&(g=!0)}{const i=r?1:0;!d&&R9(h,s,n,i)&&(e.start=t+c,d=!0),!g&&R9(f,a,n,i)&&(e.end=t+c,g=!0)}const p=c-l;d||(e.start=Math.max(0,h+p)),g||(e.end=Math.max(0,f+p)),e.start>e.end&&(e.end=e.start)}function F9(e,t){if(e.root===A9)return t.parent=A9,t.left=A9,t.right=A9,E9(t,0),e.root=t,e.root;!function(e,t){let n=0,i=e.root;const r=t.start,o=t.end;for(;;){if(G9(r,o,i.start+n,i.end+n)<0){if(i.left===A9){t.start-=n,t.end-=n,t.maxEnd-=n,i.left=t;break}i=i.left}else{if(i.right===A9){t.start-=n+i.delta,t.end-=n+i.delta,t.maxEnd-=n+i.delta,i.right=t;break}n+=i.delta,i=i.right}}t.parent=i,t.left=A9,t.right=A9,E9(t,1)}(e,t),j9(t.parent);let n=t;for(;n!==e.root&&1===x9(n.parent);)if(n.parent===n.parent.parent.left){const t=n.parent.parent.right;1===x9(t)?(E9(n.parent,0),E9(t,0),E9(n.parent.parent,1),n=n.parent.parent):(n===n.parent.right&&(n=n.parent,z9(e,n)),E9(n.parent,0),E9(n.parent.parent,1),V9(e,n.parent.parent))}else{const t=n.parent.parent.left;1===x9(t)?(E9(n.parent,0),E9(t,0),E9(n.parent.parent,1),n=n.parent.parent):(n===n.parent.left&&(n=n.parent,V9(e,n)),E9(n.parent,0),E9(n.parent.parent,1),z9(e,n.parent.parent))}return E9(e.root,0),t}function B9(e,t){let n,i;if(t.left===A9?(n=t.right,i=t,n.delta+=t.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),n.start+=t.delta,n.end+=t.delta):t.right===A9?(n=t.left,i=t):(i=function(e){for(;e.left!==A9;)e=e.left;return e}(t.right),n=i.right,n.start+=i.delta,n.end+=i.delta,n.delta+=i.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),i.start+=t.delta,i.end+=t.delta,i.delta=t.delta,(i.delta<-1073741824||i.delta>1073741824)&&(e.requestNormalizeDelta=!0)),i===e.root)return e.root=n,E9(n,0),t.detach(),W9(),H9(n),void(e.root.parent=A9);let r,o=1===x9(i);if(i===i.parent.left?i.parent.left=n:i.parent.right=n,i===t?n.parent=i.parent:(i.parent===t?n.parent=i:n.parent=i.parent,i.left=t.left,i.right=t.right,i.parent=t.parent,E9(i,x9(t)),t===e.root?e.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left!==A9&&(i.left.parent=i),i.right!==A9&&(i.right.parent=i)),t.detach(),o)return j9(n.parent),i!==t&&(j9(i),j9(i.parent)),void W9();for(j9(n),j9(n.parent),i!==t&&(j9(i),j9(i.parent));n!==e.root&&0===x9(n);)n===n.parent.left?(r=n.parent.right,1===x9(r)&&(E9(r,0),E9(n.parent,1),z9(e,n.parent),r=n.parent.right),0===x9(r.left)&&0===x9(r.right)?(E9(r,1),n=n.parent):(0===x9(r.right)&&(E9(r.left,0),E9(r,1),V9(e,r),r=n.parent.right),E9(r,x9(n.parent)),E9(n.parent,0),E9(r.right,0),z9(e,n.parent),n=e.root)):(r=n.parent.left,1===x9(r)&&(E9(r,0),E9(n.parent,1),V9(e,n.parent),r=n.parent.left),0===x9(r.left)&&0===x9(r.right)?(E9(r,1),n=n.parent):(0===x9(r.left)&&(E9(r.right,0),E9(r,1),z9(e,r),r=n.parent.left),E9(r,x9(n.parent)),E9(n.parent,0),E9(r.left,0),V9(e,n.parent),n=e.root));E9(n,0),W9()}function W9(){A9.parent=A9,A9.delta=0,A9.start=0,A9.end=0}function z9(e,t){const n=t.right;n.delta+=t.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),n.start+=t.delta,n.end+=t.delta,t.right=n.left,n.left!==A9&&(n.left.parent=t),n.parent=t.parent,t.parent===A9?e.root=n:t===t.parent.left?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n,H9(t),H9(n)}function V9(e,t){const n=t.left;t.delta-=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(e.requestNormalizeDelta=!0),t.start-=n.delta,t.end-=n.delta,t.left=n.right,n.right!==A9&&(n.right.parent=t),n.parent=t.parent,t.parent===A9?e.root=n:t===t.parent.right?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n,H9(t),H9(n)}function U9(e){let t=e.end;if(e.left!==A9){const n=e.left.maxEnd;n>t&&(t=n)}if(e.right!==A9){const n=e.right.maxEnd+e.delta;n>t&&(t=n)}return t}function H9(e){e.maxEnd=U9(e)}function j9(e){for(;e!==A9;){const t=U9(e);if(e.maxEnd===t)return;e.maxEnd=t,e=e.parent}}function G9(e,t,n,i){return e===n?t-i:e-n}class K9{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==q9)return $9(this.right);let e=this;for(;e.parent!==q9&&e.parent.left!==e;)e=e.parent;return e.parent===q9?q9:e.parent}prev(){if(this.left!==q9)return Y9(this.left);let e=this;for(;e.parent!==q9&&e.parent.right!==e;)e=e.parent;return e.parent===q9?q9:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const q9=new K9(null,0);function $9(e){for(;e.left!==q9;)e=e.left;return e}function Y9(e){for(;e.right!==q9;)e=e.right;return e}function X9(e){return e===q9?0:e.size_left+e.piece.length+X9(e.right)}function Z9(e){return e===q9?0:e.lf_left+e.piece.lineFeedCnt+Z9(e.right)}function Q9(){q9.parent=q9}function J9(e,t){let n=t.right;n.size_left+=t.size_left+(t.piece?t.piece.length:0),n.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=n.left,n.left!==q9&&(n.left.parent=t),n.parent=t.parent,t.parent===q9?e.root=n:t.parent.left===t?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n}function e8(e,t){let n=t.left;t.left=n.right,n.right!==q9&&(n.right.parent=t),n.parent=t.parent,t.size_left-=n.size_left+(n.piece?n.piece.length:0),t.lf_left-=n.lf_left+(n.piece?n.piece.lineFeedCnt:0),t.parent===q9?e.root=n:t===t.parent.right?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n}function t8(e,t){let n,i;if(t.left===q9?(i=t,n=i.right):t.right===q9?(i=t,n=i.left):(i=$9(t.right),n=i.right),i===e.root)return e.root=n,n.color=0,t.detach(),Q9(),void(e.root.parent=q9);let r,o=1===i.color;if(i===i.parent.left?i.parent.left=n:i.parent.right=n,i===t?(n.parent=i.parent,r8(e,n)):(i.parent===t?n.parent=i:n.parent=i.parent,r8(e,n),i.left=t.left,i.right=t.right,i.parent=t.parent,i.color=t.color,t===e.root?e.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left!==q9&&(i.left.parent=i),i.right!==q9&&(i.right.parent=i),i.size_left=t.size_left,i.lf_left=t.lf_left,r8(e,i)),t.detach(),n.parent.left===n){let t=X9(n),i=Z9(n);if(t!==n.parent.size_left||i!==n.parent.lf_left){let r=t-n.parent.size_left,o=i-n.parent.lf_left;n.parent.size_left=t,n.parent.lf_left=i,i8(e,n.parent,r,o)}}if(r8(e,n.parent),o)Q9();else{for(;n!==e.root&&0===n.color;)n===n.parent.left?(r=n.parent.right,1===r.color&&(r.color=0,n.parent.color=1,J9(e,n.parent),r=n.parent.right),0===r.left.color&&0===r.right.color?(r.color=1,n=n.parent):(0===r.right.color&&(r.left.color=0,r.color=1,e8(e,r),r=n.parent.right),r.color=n.parent.color,n.parent.color=0,r.right.color=0,J9(e,n.parent),n=e.root)):(r=n.parent.left,1===r.color&&(r.color=0,n.parent.color=1,e8(e,n.parent),r=n.parent.left),0===r.left.color&&0===r.right.color?(r.color=1,n=n.parent):(0===r.left.color&&(r.right.color=0,r.color=1,J9(e,r),r=n.parent.left),r.color=n.parent.color,n.parent.color=0,r.left.color=0,e8(e,n.parent),n=e.root));n.color=0,Q9()}}function n8(e,t){for(r8(e,t);t!==e.root&&1===t.parent.color;)if(t.parent===t.parent.parent.left){const n=t.parent.parent.right;1===n.color?(t.parent.color=0,n.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&J9(e,t=t.parent),t.parent.color=0,t.parent.parent.color=1,e8(e,t.parent.parent))}else{const n=t.parent.parent.left;1===n.color?(t.parent.color=0,n.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&e8(e,t=t.parent),t.parent.color=0,t.parent.parent.color=1,J9(e,t.parent.parent))}e.root.color=0}function i8(e,t,n,i){for(;t!==e.root&&t!==q9;)t.parent.left===t&&(t.parent.size_left+=n,t.parent.lf_left+=i),t=t.parent}function r8(e,t){let n=0,i=0;if(t!==e.root){if(0===n){for(;t!==e.root&&t===t.parent.right;)t=t.parent;if(t===e.root)return;n=X9((t=t.parent).left)-t.size_left,i=Z9(t.left)-t.lf_left,t.size_left+=n,t.lf_left+=i}for(;t!==e.root&&(0!==n||0!==i);)t.parent.left===t&&(t.parent.size_left+=n,t.parent.lf_left+=i),t=t.parent}}q9.parent=q9,q9.left=q9,q9.right=q9,q9.color=0;class o8 extends g1{constructor(e){super(0);for(let t=0,n=e.length;t<n;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}const s8=function(e){let t={};return n=>(t.hasOwnProperty(n)||(t[n]=e(n)),t[n])}((e=>new o8(e)));class a8{constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(""===this.searchString)return null;let e;e=this.isRegex?function(e){if(!e||0===e.length)return!1;for(let t=0,n=e.length;t<n;t++){if(92===e.charCodeAt(t)){if(t++,t>=n)break;const i=e.charCodeAt(t);if(110===i||114===i||87===i||119===i)return!0}}return!1}(this.searchString):this.searchString.indexOf("\n")>=0;let t=null;try{t=lX(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch(i){return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new l8(t,this.wordSeparators?s8(this.wordSeparators):null,n?this.searchString:null)}}class l8{constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}}function c8(e,t,n){if(!n)return new xQ(e,null);let i=[];for(let r=0,o=t.length;r<o;r++)i[r]=t[r];return new xQ(e,i)}class u8{constructor(e){let t=[],n=0;for(let i=0,r=e.length;i<r;i++)10===e.charCodeAt(i)&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let n=0,i=t.length-1;if(-1===i)return 0;if(e<=t[0])return 0;for(;n<i;){const r=n+((i-n)/2>>0);t[r]>=e?i=r-1:t[r+1]>=e?(n=r,i=r):n=r+1}return n+1}}class h8{static findMatches(e,t,n,i,r){const o=t.parseSearchRequest();return o?o.regex.multiline?this._doFindMatchesMultiline(e,n,new f8(o.wordSeparators,o.regex),i,r):this._doFindMatchesLineByLine(e,n,o,i,r):[]}static _getMultilineMatchRange(e,t,n,i,r,o){let s,a,l=0;if(i?(l=i.findLineFeedCountBeforeOffset(r),s=t+r+l):s=t+r,i){let e=i.findLineFeedCountBeforeOffset(r+o.length)-l;a=s+o.length+e}else a=s+o.length;const c=e.getPositionAt(s),u=e.getPositionAt(a);return new TK(c.lineNumber,c.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,n,i,r){const o=e.getOffsetAt(t.getStartPosition()),s=e.getValueInRange(t,1),a="\r\n"===e.getEOL()?new u8(s):null,l=[];let c,u=0;for(n.reset(0);c=n.next(s);)if(l[u++]=c8(this._getMultilineMatchRange(e,o,s,a,c.index,c[0]),c,i),u>=r)return l;return l}static _doFindMatchesLineByLine(e,t,n,i,r){const o=[];let s=0;if(t.startLineNumber===t.endLineNumber){const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return s=this._findMatchesInLine(n,a,t.startLineNumber,t.startColumn-1,s,o,i,r),o}const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);s=this._findMatchesInLine(n,a,t.startLineNumber,t.startColumn-1,s,o,i,r);for(let l=t.startLineNumber+1;l<t.endLineNumber&&s<r;l++)s=this._findMatchesInLine(n,e.getLineContent(l),l,0,s,o,i,r);if(s<r){const a=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);s=this._findMatchesInLine(n,a,t.endLineNumber,0,s,o,i,r)}return o}static _findMatchesInLine(e,t,n,i,r,o,s,a){const l=e.wordSeparators;if(!s&&e.simpleSearch){const s=e.simpleSearch,c=s.length,u=t.length;let h=-c;for(;-1!==(h=t.indexOf(s,h+c));)if((!l||d8(l,t,u,h,c))&&(o[r++]=new xQ(new TK(n,h+1+i,n,h+1+c+i),null),r>=a))return r;return r}const c=new f8(e.wordSeparators,e.regex);let u;c.reset(0);do{if(u=c.next(t),u&&(o[r++]=c8(new TK(n,u.index+1+i,n,u.index+1+u[0].length+i),u,s),r>=a))return r}while(u);return r}static findNextMatch(e,t,n,i){const r=t.parseSearchRequest();if(!r)return null;const o=new f8(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,n,o,i):this._doFindNextMatchLineByLine(e,n,o,i)}static _doFindNextMatchMultiline(e,t,n,i){const r=new IK(t.lineNumber,1),o=e.getOffsetAt(r),s=e.getLineCount(),a=e.getValueInRange(new TK(r.lineNumber,r.column,s,e.getLineMaxColumn(s)),1),l="\r\n"===e.getEOL()?new u8(a):null;n.reset(t.column-1);let c=n.next(a);return c?c8(this._getMultilineMatchRange(e,o,a,l,c.index,c[0]),c,i):1!==t.lineNumber||1!==t.column?this._doFindNextMatchMultiline(e,new IK(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){const r=e.getLineCount(),o=t.lineNumber,s=e.getLineContent(o),a=this._findFirstMatchInLine(n,s,o,t.column,i);if(a)return a;for(let l=1;l<=r;l++){const t=(o+l-1)%r,s=e.getLineContent(t+1),a=this._findFirstMatchInLine(n,s,t+1,1,i);if(a)return a}return null}static _findFirstMatchInLine(e,t,n,i,r){e.reset(i-1);const o=e.next(t);return o?c8(new TK(n,o.index+1,n,o.index+1+o[0].length),o,r):null}static findPreviousMatch(e,t,n,i){const r=t.parseSearchRequest();if(!r)return null;const o=new f8(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,n,o,i):this._doFindPreviousMatchLineByLine(e,n,o,i)}static _doFindPreviousMatchMultiline(e,t,n,i){const r=this._doFindMatchesMultiline(e,new TK(1,1,t.lineNumber,t.column),n,i,9990);if(r.length>0)return r[r.length-1];const o=e.getLineCount();return t.lineNumber!==o||t.column!==e.getLineMaxColumn(o)?this._doFindPreviousMatchMultiline(e,new IK(o,e.getLineMaxColumn(o)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){const r=e.getLineCount(),o=t.lineNumber,s=e.getLineContent(o).substring(0,t.column-1),a=this._findLastMatchInLine(n,s,o,i);if(a)return a;for(let l=1;l<=r;l++){const t=(r+o-l-1)%r,s=e.getLineContent(t+1),a=this._findLastMatchInLine(n,s,t+1,i);if(a)return a}return null}static _findLastMatchInLine(e,t,n,i){let r,o=null;for(e.reset(0);r=e.next(t);)o=c8(new TK(n,r.index+1,n,r.index+1+r[0].length),r,i);return o}}function d8(e,t,n,i,r){return function(e,t,n,i,r){if(0===i)return!0;const o=t.charCodeAt(i-1);if(0!==e.get(o))return!0;if(13===o||10===o)return!0;if(r>0){const n=t.charCodeAt(i);if(0!==e.get(n))return!0}return!1}(e,t,0,i,r)&&function(e,t,n,i,r){if(i+r===n)return!0;const o=t.charCodeAt(i+r);if(0!==e.get(o))return!0;if(13===o||10===o)return!0;if(r>0){const n=t.charCodeAt(i+r-1);if(0!==e.get(n))return!0}return!1}(e,t,n,i,r)}class f8{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t)return null;if(n=this._searchRegex.exec(e),!n)return null;const i=n.index,r=n[0].length;if(i===this._prevMatchStartIndex&&r===this._prevMatchLength){if(0===r){NX(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=i,this._prevMatchLength=r,!this._wordSeparators||d8(this._wordSeparators,e,t,i,r))return n}while(n);return null}}function g8(e){let t;return t=e[e.length-1]<65536?new Uint16Array(e.length):new Uint32Array(e.length),t.set(e,0),t}class p8{constructor(e,t,n,i,r){this.lineStarts=e,this.cr=t,this.lf=n,this.crlf=i,this.isBasicASCII=r}}function m8(e,t=!0){let n=[0],i=1;for(let r=0,o=e.length;r<o;r++){const t=e.charCodeAt(r);13===t?r+1<o&&10===e.charCodeAt(r+1)?(n[i++]=r+2,r++):n[i++]=r+1:10===t&&(n[i++]=r+1)}return t?g8(n):n}class v8{constructor(e,t,n,i,r){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=r}}class y8{constructor(e,t){this.buffer=e,this.lineStarts=t}}class _8{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==q9&&e.iterate(e.root,(e=>(e!==q9&&this._pieces.push(e.piece),!0)))}read(){return 0===this._pieces.length?0===this._index?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:0===this._index?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class b8{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let r=n[i];(null===r.node.parent||r.nodeStartOffset>=e)&&(n[i]=null,t=!0)}if(t){let e=[];for(const t of n)null!==t&&e.push(t);this._cache=e}}}class w8{constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new y8("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=q9,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let r=0,o=e.length;r<o;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=m8(e[r].buffer));let t=new v8(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),i=this.rbInsertRight(i,t)}this._searchCache=new b8(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=65535-Math.floor(21845),n=2*t,i="",r=0,o=[];if(this.iterate(this.root,(s=>{let a=this.getNodeContent(s),l=a.length;if(r<=t||r+l<n)return i+=a,r+=l,!0;let c=i.replace(/\r\n|\r|\n/g,e);return o.push(new y8(c,m8(c))),i=a,r=l,!0})),r>0){let t=i.replace(/\r\n|\r|\n/g,e);o.push(new y8(t,m8(t)))}this.create(o,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new _8(this,e)}getOffsetAt(e,t){let n=0,i=this.root;for(;i!==q9;)if(i.left!==q9&&i.lf_left+1>=e)i=i.left;else{if(i.lf_left+i.piece.lineFeedCnt+1>=e){return n+=i.size_left,n+(this.getAccumulatedValue(i,e-i.lf_left-2)+t-1)}e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right}return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;for(;t!==q9;)if(0!==t.size_left&&t.size_left>=e)t=t.left;else{if(t.size_left+t.piece.length>=e){let r=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+r.index,0===r.index){let e=this.getOffsetAt(n+1,1);return new IK(n+1,i-e+1)}return new IK(n+1,r.remainder+1)}if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===q9){let t=this.getOffsetAt(n+1,1);return new IK(n+1,i-e-t+1)}t=t.right}return new IK(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(n,i);return t?t===this._EOL&&this._EOLNormalized&&t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.substring(r+e.remainder,r+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),o=i.substring(r+e.remainder,r+n.piece.length);for(n=n.next();n!==q9;){let e=this._buffers[n.piece.bufferIndex].buffer,i=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){o+=e.substring(i,i+t.remainder);break}o+=e.substr(i,n.piece.length),n=n.next()}return o}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,(r=>{if(r===q9)return!0;const o=r.piece;let s=o.length;if(0===s)return!0;const a=this._buffers[o.bufferIndex].buffer,l=this._buffers[o.bufferIndex].lineStarts,c=o.start.line,u=o.end.line;let h=l[c]+o.start.column;if(i&&(10===a.charCodeAt(h)&&(h++,s--),e[t++]=n,n="",i=!1,0===s))return!0;if(c===u)return this._EOLNormalized||13!==a.charCodeAt(h+s-1)?n+=a.substr(h,s):(i=!0,n+=a.substr(h,s-1)),!0;n+=this._EOLNormalized?a.substring(h,Math.max(h,l[c+1]-this._EOLLength)):a.substring(h,l[c+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let i=c+1;i<u;i++)n=this._EOLNormalized?a.substring(l[i],l[i+1]-this._EOLLength):a.substring(l[i],l[i+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return this._EOLNormalized||13!==a.charCodeAt(l[u]+o.end.column-1)?n=a.substr(l[u],o.end.column):(i=!0,0===o.end.column?t--:n=a.substr(l[u],o.end.column-1)),!0})),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e||(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,"")),this._lastVisitedLine.value}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}{let t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,n,i,r,o,s,a,l,c,u){let h,d,f,g=this._buffers[e.piece.bufferIndex],p=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),m=this.offsetInBuffer(e.piece.bufferIndex,r),v=this.offsetInBuffer(e.piece.bufferIndex,o),y={line:0,column:0};t._wordSeparators?(d=g.buffer.substring(m,v),f=e=>e+m,t.reset(0)):(d=g.buffer,f=e=>e,t.reset(m));do{if(h=t.next(d),h){if(f(h.index)>=v)return c;this.positionInBuffer(e,f(h.index)-p,y);let t=this.getLineFeedCnt(e.piece.bufferIndex,r,y),o=y.line===r.line?y.column-r.column+i:y.column+1,s=o+h[0].length;if(u[c++]=c8(new TK(n+t,o,n+t,s),h,a),f(h.index)+h[0].length>=v)return c;if(c>=l)return c}}while(h);return c}findMatchesLineByLine(e,t,n,i){const r=[];let o=0;const s=new f8(t.wordSeparators,t.regex);let a=this.nodeAt2(e.startLineNumber,e.startColumn);if(null===a)return[];let l=this.nodeAt2(e.endLineNumber,e.endColumn);if(null===l)return[];let c=this.positionInBuffer(a.node,a.remainder),u=this.positionInBuffer(l.node,l.remainder);if(a.node===l.node)return this.findMatchesInNode(a.node,s,e.startLineNumber,e.startColumn,c,u,t,n,i,o,r),r;let h=e.startLineNumber,d=a.node;for(;d!==l.node;){let l=this.getLineFeedCnt(d.piece.bufferIndex,c,d.piece.end);if(l>=1){let a=this._buffers[d.piece.bufferIndex].lineStarts,u=this.offsetInBuffer(d.piece.bufferIndex,d.piece.start),f=a[c.line+l],g=h===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(d,s,h,g,c,this.positionInBuffer(d,f-u),t,n,i,o,r),o>=i)return r;h+=l}let u=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const a=this.getLineContent(h).substring(u,e.endColumn-1);return o=this._findMatchesInLine(t,s,a,e.endLineNumber,u,o,r,n,i),r}if(o=this._findMatchesInLine(t,s,this.getLineContent(h).substr(u),h,u,o,r,n,i),o>=i)return r;h++,a=this.nodeAt2(h,1),d=a.node,c=this.positionInBuffer(a.node,a.remainder)}if(h===e.endLineNumber){let a=h===e.startLineNumber?e.startColumn-1:0;const l=this.getLineContent(h).substring(a,e.endColumn-1);return o=this._findMatchesInLine(t,s,l,e.endLineNumber,a,o,r,n,i),r}let f=h===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(l.node,s,h,f,c,u,t,n,i,o,r),r}_findMatchesInLine(e,t,n,i,r,o,s,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const t=e.simpleSearch,a=t.length,u=n.length;let h=-a;for(;-1!==(h=n.indexOf(t,h+a));)if((!c||d8(c,n,u,h,a))&&(s[o++]=new xQ(new TK(i,h+1+r,i,h+1+a+r),null),o>=l))return o;return o}let u;t.reset(0);do{if(u=t.next(n),u&&(s[o++]=c8(new TK(i,u.index+1+r,i,u.index+1+u[0].length+r),u,a),o>=l))return o}while(u);return o}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==q9){let{node:n,remainder:i,nodeStartOffset:r}=this.nodeAt(e),o=n.piece,s=o.bufferIndex,a=this.positionInBuffer(n,i);if(0===n.piece.bufferIndex&&o.end.line===this._lastChangeBufferPos.line&&o.end.column===this._lastChangeBufferPos.column&&r+o.length===e&&t.length<65535)return this.appendToNode(n,t),void this.computeBufferMetadata();if(r===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(r+n.piece.length>e){let e=[],r=new v8(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),this.offsetInBuffer(s,o.end)-this.offsetInBuffer(s,a));if(this.shouldCheckCRLF()&&this.endWithCR(t)){if(10===this.nodeCharCodeAt(n,i)){let e={line:r.start.line+1,column:0};r=new v8(r.bufferIndex,e,r.end,this.getLineFeedCnt(r.bufferIndex,e,r.end),r.length-1),t+="\n"}}if(this.shouldCheckCRLF()&&this.startWithLF(t)){if(13===this.nodeCharCodeAt(n,i-1)){let r=this.positionInBuffer(n,i-1);this.deleteNodeTail(n,r),t="\r"+t,0===n.piece.length&&e.push(n)}else this.deleteNodeTail(n,a)}else this.deleteNodeTail(n,a);let l=this.createNewPieces(t);r.length>0&&this.rbInsertRight(n,r);let c=n;for(let t=0;t<l.length;t++)c=this.rbInsertRight(c,l[t]);this.deleteNodes(e)}else this.insertContentToNodeRight(t,n)}else{let e=this.createNewPieces(t),n=this.rbInsertLeft(null,e[0]);for(let t=1;t<e.length;t++)n=this.rbInsertRight(n,e[t])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===q9)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),r=n.node,o=i.node;if(r===o){let o=this.positionInBuffer(r,n.remainder),s=this.positionInBuffer(r,i.remainder);if(n.nodeStartOffset===e){if(t===r.piece.length){let e=r.next();return t8(this,r),this.validateCRLFWithPrevNode(e),void this.computeBufferMetadata()}return this.deleteNodeHead(r,s),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),void this.computeBufferMetadata()}return n.nodeStartOffset+r.piece.length===e+t?(this.deleteNodeTail(r,o),this.validateCRLFWithNextNode(r),void this.computeBufferMetadata()):(this.shrinkNode(r,o,s),void this.computeBufferMetadata())}let s=[],a=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,a),this._searchCache.validate(e),0===r.piece.length&&s.push(r);let l=this.positionInBuffer(o,i.remainder);this.deleteNodeHead(o,l),0===o.piece.length&&s.push(o);for(let u=r.next();u!==q9&&u!==o;u=u.next())s.push(u);let c=0===r.piece.length?r.prev():r;this.deleteNodes(s),this.validateCRLFWithNextNode(c),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let i=t.piece,r={line:i.start.line+1,column:0},o=new v8(i.bufferIndex,r,i.end,this.getLineFeedCnt(i.bufferIndex,r,i.end),i.length-1);t.piece=o,e+="\n",i8(this,t,-1,-1),0===t.piece.length&&n.push(t)}let i=this.createNewPieces(e),r=this.rbInsertLeft(t,i[i.length-1]);for(let o=i.length-2;o>=0;o--)r=this.rbInsertLeft(r,i[o]);this.validateCRLFWithPrevNode(r),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+="\n");let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),r=i;for(let o=1;o<n.length;o++)r=this.rbInsertRight(r,n[o]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,r=e.piece.bufferIndex,o=this._buffers[r].lineStarts,s=o[i.start.line]+i.start.column+t,a=i.start.line,l=i.end.line,c=0,u=0,h=0;for(;a<=l&&(c=a+(l-a)/2|0,h=o[c],c!==l);)if(u=o[c+1],s<h)l=c-1;else{if(!(s>=u))break;a=c+1}return n?(n.line=c,n.column=s-h,null):{line:c,column:s-h}}getLineFeedCnt(e,t,n){if(0===n.column)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let r=i[n.line+1],o=i[n.line]+n.column;if(r>o+1)return n.line-t.line;let s=o-1;return 13===this._buffers[e].buffer.charCodeAt(s)?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)t8(this,e[t])}createNewPieces(e){if(e.length>65535){let t=[];for(;e.length>65535;){const n=e.charCodeAt(65534);let i;13===n||n>=55296&&n<=56319?(i=e.substring(0,65534),e=e.substring(65534)):(i=e.substring(0,65535),e=e.substring(65535));let r=m8(i);t.push(new v8(this._buffers.length,{line:0,column:0},{line:r.length-1,column:i.length-r[r.length-1]},r.length-1,i.length)),this._buffers.push(new y8(i,r))}let n=m8(e);return t.push(new v8(this._buffers.length,{line:0,column:0},{line:n.length-1,column:e.length-n[n.length-1]},n.length-1,e.length)),this._buffers.push(new y8(e,n)),t}let t=this._buffers[0].buffer.length;const n=m8(e,!1);let i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&0!==t&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let e=0;e<n.length;e++)n[e]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(0!==t)for(let e=0;e<n.length;e++)n[e]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}const r=this._buffers[0].buffer.length;let o=this._buffers[0].lineStarts.length-1,s={line:o,column:r-this._buffers[0].lineStarts[o]},a=new v8(0,i,s,this.getLineFeedCnt(0,i,s),r-t);return this._lastChangeBufferPos=s,[a]}getLineRawContent(e,t=0){let n=this.root,i="",r=this._searchCache.get2(e);if(r){n=r.node;let o=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1),s=this._buffers[n.piece.bufferIndex].buffer,a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt!==e){let i=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return s.substring(a+o,a+i-t)}i=s.substring(a+o,a+n.piece.length)}else{let r=0;const o=e;for(;n!==q9;)if(n.left!==q9&&n.lf_left>=e-1)n=n.left;else{if(n.lf_left+n.piece.lineFeedCnt>e-1){let i=this.getAccumulatedValue(n,e-n.lf_left-2),s=this.getAccumulatedValue(n,e-n.lf_left-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return r+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:r,nodeStartLineNumber:o-(e-1-n.lf_left)}),a.substring(l+i,l+s-t)}if(n.lf_left+n.piece.lineFeedCnt===e-1){let t=this.getAccumulatedValue(n,e-n.lf_left-2),r=this._buffers[n.piece.bufferIndex].buffer,o=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=r.substring(o+t,o+n.piece.length);break}e-=n.lf_left+n.piece.lineFeedCnt,r+=n.size_left+n.piece.length,n=n.right}}for(n=n.next();n!==q9;){let e=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let r=this.getAccumulatedValue(n,0),o=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=e.substring(o,o+r-t),i}{let t=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=e.substr(t,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==q9;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),r=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let t=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(t!==r)return{index:t,remainder:0}}return{index:r,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,r=n.start.line+t+1;return r>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[r]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){const n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.end),o=t,s=this.offsetInBuffer(n.bufferIndex,o),a=this.getLineFeedCnt(n.bufferIndex,n.start,o),l=a-i,c=s-r,u=n.length+c;e.piece=new v8(n.bufferIndex,n.start,o,a,u),i8(this,e,c,l)}deleteNodeHead(e,t){const n=e.piece,i=n.lineFeedCnt,r=this.offsetInBuffer(n.bufferIndex,n.start),o=t,s=this.getLineFeedCnt(n.bufferIndex,o,n.end),a=s-i,l=r-this.offsetInBuffer(n.bufferIndex,o),c=n.length+l;e.piece=new v8(n.bufferIndex,o,n.end,s,c),i8(this,e,l,a)}shrinkNode(e,t,n){const i=e.piece,r=i.start,o=i.end,s=i.length,a=i.lineFeedCnt,l=t,c=this.getLineFeedCnt(i.bufferIndex,i.start,l),u=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,r);e.piece=new v8(i.bufferIndex,i.start,l,c,u),i8(this,e,u-s,c-a);let h=new v8(i.bufferIndex,n,o,this.getLineFeedCnt(i.bufferIndex,n,o),this.offsetInBuffer(i.bufferIndex,o)-this.offsetInBuffer(i.bufferIndex,n)),d=this.rbInsertRight(e,h);this.validateCRLFWithPrevNode(d)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+="\n");const n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const r=m8(t,!1);for(let h=0;h<r.length;h++)r[h]+=i;if(n){let e=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-e}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));const o=this._buffers[0].lineStarts.length-1,s={line:o,column:this._buffers[0].buffer.length-this._buffers[0].lineStarts[o]},a=e.piece.length+t.length,l=e.piece.lineFeedCnt,c=this.getLineFeedCnt(0,e.piece.start,s),u=c-l;e.piece=new v8(e.piece.bufferIndex,e.piece.start,s,c,a),this._lastChangeBufferPos=s,i8(this,e,t.length,u)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;for(;t!==q9;)if(t.size_left>e)t=t.left;else{if(t.size_left+t.piece.length>=e){i+=t.size_left;let n={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(n),n}e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right}return null}nodeAt2(e,t){let n=this.root,i=0;for(;n!==q9;)if(n.left!==q9&&n.lf_left>=e-1)n=n.left;else{if(n.lf_left+n.piece.lineFeedCnt>e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2),o=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(r+t-1,o),nodeStartOffset:i}}if(n.lf_left+n.piece.lineFeedCnt===e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+t-1<=n.piece.length)return{node:n,remainder:r+t-1,nodeStartOffset:i};t-=n.piece.length-r;break}e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==q9;){if(n.piece.lineFeedCnt>0){let e=this.getAccumulatedValue(n,0),i=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,e),nodeStartOffset:i}}if(n.piece.length>=t-1){return{node:n,remainder:t-1,nodeStartOffset:this.offsetOfNode(n)}}t-=n.piece.length,n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&"\n"===this._EOL)}startWithLF(e){if("string"==typeof e)return 10===e.charCodeAt(0);if(e===q9||0===e.piece.lineFeedCnt)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,r=n[i]+t.start.column;return i!==n.length-1&&(!(n[i+1]>r+1)&&10===this._buffers[t.bufferIndex].buffer.charCodeAt(r))}endWithCR(e){return"string"==typeof e?13===e.charCodeAt(e.length-1):e!==q9&&0!==e.piece.lineFeedCnt&&13===this.nodeCharCodeAt(e,e.piece.length-1)}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n,i=[],r=this._buffers[e.piece.bufferIndex].lineStarts;n=0===e.piece.end.column?{line:e.piece.end.line-1,column:r[e.piece.end.line]-r[e.piece.end.line-1]-1}:{line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,s=e.piece.lineFeedCnt-1;e.piece=new v8(e.piece.bufferIndex,e.piece.start,n,s,o),i8(this,e,-1,-1),0===e.piece.length&&i.push(e);let a={line:t.piece.start.line+1,column:0};const l=t.piece.length-1,c=this.getLineFeedCnt(t.piece.bufferIndex,a,t.piece.end);t.piece=new v8(t.piece.bufferIndex,a,t.piece.end,c,l),i8(this,t,-1,-1),0===t.piece.length&&i.push(t);let u=this.createNewPieces("\r\n");this.rbInsertRight(e,u[0]);for(let h=0;h<i.length;h++)t8(this,i[h])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+="\n",1===n.piece.length)t8(this,n);else{const e=n.piece,t={line:e.start.line+1,column:0},i=e.length-1,r=this.getLineFeedCnt(e.bufferIndex,t,e.end);n.piece=new v8(e.bufferIndex,t,e.end,r,i),i8(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===q9)return t(q9);let n=this.iterate(e.left,t);return n?t(e)&&this.iterate(e.right,t):n}getNodeContent(e){if(e===q9)return"";let t,n=this._buffers[e.piece.bufferIndex],i=e.piece,r=this.offsetInBuffer(i.bufferIndex,i.start),o=this.offsetInBuffer(i.bufferIndex,i.end);return t=n.buffer.substring(r,o),t}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,i)}rbInsertRight(e,t){let n=new K9(t,1);if(n.left=q9,n.right=q9,n.parent=q9,n.size_left=0,n.lf_left=0,this.root===q9)this.root=n,n.color=0;else if(e.right===q9)e.right=n,n.parent=e;else{let t=$9(e.right);t.left=n,n.parent=t}return n8(this,n),n}rbInsertLeft(e,t){let n=new K9(t,1);if(n.left=q9,n.right=q9,n.parent=q9,n.size_left=0,n.lf_left=0,this.root===q9)this.root=n,n.color=0;else if(e.left===q9)e.left=n,n.parent=e;else{let t=Y9(e.left);t.right=n,n.parent=t}return n8(this,n),n}}function C8(e){let t=0,n=0,i=0,r=0;for(let o=0,s=e.length;o<s;o++){const a=e.charCodeAt(o);13===a?(0===t&&(n=o),t++,o+1<s&&10===e.charCodeAt(o+1)?(r|=2,o++):r|=3,i=o+1):10===a&&(r|=1,0===t&&(n=o),t++,i=o+1)}return 0===t&&(n=e.length),[t,n,e.length-i,r]}function S8(e){return(16384|e<<0|2<<23)>>>0}const x8=new Uint32Array(0).buffer;class E8{constructor(){this.tokens=[]}add(e,t){if(this.tokens.length>0){const n=this.tokens[this.tokens.length-1];if(n.startLineNumber+n.tokens.length-1+1===e)return void n.tokens.push(t)}this.tokens.push(new N8(e,[t]))}}class k8{constructor(e){this._tokens=e,this._tokenCount=e.length/4}toString(e){let t=[];for(let n=0;n<this._tokenCount;n++)t.push(`(${this._getDeltaLine(n)+e},${this._getStartCharacter(n)}-${this._getEndCharacter(n)})`);return`[${t.join(",")}]`}getMaxDeltaLine(){const e=this._getTokenCount();return 0===e?-1:this._getDeltaLine(e-1)}getRange(){const e=this._getTokenCount();if(0===e)return null;const t=this._getStartCharacter(0),n=this._getDeltaLine(e-1),i=this._getEndCharacter(e-1);return new TK(0,t+1,n,i+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(e){return this._tokens[4*e]}_getStartCharacter(e){return this._tokens[4*e+1]}_getEndCharacter(e){return this._tokens[4*e+2]}isEmpty(){return 0===this._getTokenCount()}getLineTokens(e){let t=0,n=this._getTokenCount()-1;for(;t<n;){const i=t+Math.floor((n-t)/2),r=this._getDeltaLine(i);if(r<e)t=i+1;else{if(!(r>e)){let r=i;for(;r>t&&this._getDeltaLine(r-1)===e;)r--;let o=i;for(;o<n&&this._getDeltaLine(o+1)===e;)o++;return new L8(this._tokens.subarray(4*r,4*o+4))}n=i-1}}return this._getDeltaLine(t)===e?new L8(this._tokens.subarray(4*t,4*t+4)):null}clear(){this._tokenCount=0}removeTokens(e,t,n,i){const r=this._tokens,o=this._tokenCount;let s=0,a=!1,l=0;for(let c=0;c<o;c++){const o=4*c,u=r[o],h=r[o+1],d=r[o+2],f=r[o+3];if((u>e||u===e&&d>=t)&&(u<n||u===n&&h<=i))a=!0;else{if(0===s&&(l=u),a){const e=4*s;r[e]=u-l,r[e+1]=h,r[e+2]=d,r[e+3]=f}s++}}return this._tokenCount=s,l}split(e,t,n,i){const r=this._tokens,o=this._tokenCount;let s=[],a=[],l=s,c=0,u=0;for(let h=0;h<o;h++){const o=4*h,s=r[o],d=r[o+1],f=r[o+2],g=r[o+3];if(s>e||s===e&&f>=t){if(s<n||s===n&&d<=i)continue;l!==a&&(l=a,c=0,u=s)}l[c++]=s-u,l[c++]=d,l[c++]=f,l[c++]=g}return[new k8(new Uint32Array(s)),new k8(new Uint32Array(a)),u]}acceptDeleteRange(e,t,n,i,r){const o=this._tokens,s=this._tokenCount,a=i-t;let l=0,c=!1;for(let u=0;u<s;u++){const h=4*u;let d=o[h],f=o[h+1],g=o[h+2];const p=o[h+3];if(d<t||d===t&&g<=n){l++;continue}if(d===t&&f<n)d===i&&g>r?g-=r-n:g=n;else if(d===t&&f===n){if(!(d===i&&g>r)){c=!0;continue}g-=r-n}else if(d<i||d===i&&f<r){if(!(d===i&&g>r)){c=!0;continue}d===t?(f=n,g=f+(g-r)):(f=0,g=f+(g-r))}else if(d>i){if(0===a&&!c){l=s;break}d-=a}else{if(!(d===i&&f>=r))throw new Error("Not possible!");e&&0===d&&(f+=e,g+=e),d-=a,f-=r-n,g-=r-n}const m=4*l;o[m]=d,o[m+1]=f,o[m+2]=g,o[m+3]=p,l++}this._tokenCount=l}acceptInsertText(e,t,n,i,r,o){const s=0===n&&1===i&&(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122),a=this._tokens,l=this._tokenCount;for(let c=0;c<l;c++){const o=4*c;let l=a[o],u=a[o+1],h=a[o+2];if(!(l<e||l===e&&h<t)){if(l===e&&h===t){if(!s)continue;h+=1}else if(l===e&&u<t&&t<h)0===n?h+=i:h=t;else{if(l===e&&u===t&&s)continue;if(l===e)if(l+=n,0===n)u+=i,h+=i;else{const e=h-u;u=r+(u-t),h=u+e}else l+=n}a[o]=l,a[o+1]=u,a[o+2]=h}}}}class L8{constructor(e){this._tokens=e}getCount(){return this._tokens.length/4}getStartCharacter(e){return this._tokens[4*e+1]}getEndCharacter(e){return this._tokens[4*e+2]}getMetadata(e){return this._tokens[4*e+3]}}class D8{constructor(e,t){this.startLineNumber=e,this.tokens=t,this.endLineNumber=this.startLineNumber+this.tokens.getMaxDeltaLine()}toString(){return this.tokens.toString(this.startLineNumber)}_updateEndLineNumber(){this.endLineNumber=this.startLineNumber+this.tokens.getMaxDeltaLine()}isEmpty(){return this.tokens.isEmpty()}getLineTokens(e){return this.startLineNumber<=e&&e<=this.endLineNumber?this.tokens.getLineTokens(e-this.startLineNumber):null}getRange(){const e=this.tokens.getRange();return e?new TK(this.startLineNumber+e.startLineNumber,e.startColumn,this.startLineNumber+e.endLineNumber,e.endColumn):e}removeTokens(e){const t=e.startLineNumber-this.startLineNumber,n=e.endLineNumber-this.startLineNumber;this.startLineNumber+=this.tokens.removeTokens(t,e.startColumn-1,n,e.endColumn-1),this._updateEndLineNumber()}split(e){const t=e.startLineNumber-this.startLineNumber,n=e.endLineNumber-this.startLineNumber,[i,r,o]=this.tokens.split(t,e.startColumn-1,n,e.endColumn-1);return[new D8(this.startLineNumber,i),new D8(this.startLineNumber+o,r)]}applyEdit(e,t){const[n,i,r]=C8(t);this.acceptEdit(e,n,i,r,t.length>0?t.charCodeAt(0):0)}acceptEdit(e,t,n,i,r){this._acceptDeleteRange(e),this._acceptInsertText(new IK(e.startLineNumber,e.startColumn),t,n,i,r),this._updateEndLineNumber()}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;const t=e.startLineNumber-this.startLineNumber,n=e.endLineNumber-this.startLineNumber;if(n<0){const e=n-t;return void(this.startLineNumber-=e)}const i=this.tokens.getMaxDeltaLine();if(!(t>=i+1)){if(t<0&&n>=i+1)return this.startLineNumber=0,void this.tokens.clear();if(t<0){const i=-t;this.startLineNumber-=i,this.tokens.acceptDeleteRange(e.startColumn-1,0,0,n,e.endColumn-1)}else this.tokens.acceptDeleteRange(0,t,e.startColumn-1,n,e.endColumn-1)}}_acceptInsertText(e,t,n,i,r){if(0===t&&0===n)return;const o=e.lineNumber-this.startLineNumber;if(o<0)return void(this.startLineNumber+=t);o>=this.tokens.getMaxDeltaLine()+1||this.tokens.acceptInsertText(o,e.column-1,t,n,i,r)}}class N8{constructor(e,t){this.startLineNumber=e,this.tokens=t}}function I8(e){return e instanceof Uint32Array?e:new Uint32Array(e)}class T8{constructor(){this._pieces=[],this._isComplete=!1}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return 0===this._pieces.length}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){const i=t[0].getRange(),r=t[t.length-1].getRange();if(!i||!r)return e;n=e.plusRange(i).plusRange(r)}let i=null;for(let r=0,o=this._pieces.length;r<o;r++){const e=this._pieces[r];if(e.endLineNumber<n.startLineNumber)continue;if(e.startLineNumber>n.endLineNumber){i=i||{index:r};break}if(e.removeTokens(n),e.isEmpty()){this._pieces.splice(r,1),r--,o--;continue}if(e.endLineNumber<n.startLineNumber)continue;if(e.startLineNumber>n.endLineNumber){i=i||{index:r};continue}const[t,s]=e.split(n);t.isEmpty()?i=i||{index:r}:s.isEmpty()||(this._pieces.splice(r,1,t,s),r++,o++,i=i||{index:r})}return i=i||{index:this._pieces.length},t.length>0&&(this._pieces=V1(this._pieces,i.index,t)),n}isComplete(){return this._isComplete}addSemanticTokens(e,t){const n=this._pieces;if(0===n.length)return t;const i=n[T8._findFirstPieceWithLine(n,e)].getLineTokens(e);if(!i)return t;const r=t.getCount(),o=i.getCount();let s=0,a=[],l=0,c=0;const u=(e,t)=>{e!==c&&(c=e,a[l++]=e,a[l++]=t)};for(let h=0;h<o;h++){const e=i.getStartCharacter(h),n=i.getEndCharacter(h),o=i.getMetadata(h),a=((1&o?2048:0)|(2&o?4096:0)|(4&o?8192:0)|(8&o?8372224:0)|(16&o?4286578688:0))>>>0,l=~a>>>0;for(;s<r&&t.getEndOffset(s)<=e;)u(t.getEndOffset(s),t.getMetadata(s)),s++;for(s<r&&t.getStartOffset(s)<e&&u(e,t.getMetadata(s));s<r&&t.getEndOffset(s)<n;)u(t.getEndOffset(s),t.getMetadata(s)&l|o&a),s++;if(s<r)u(n,t.getMetadata(s)&l|o&a),t.getEndOffset(s)===n&&s++;else{const e=Math.min(Math.max(0,s-1),r-1);u(n,t.getMetadata(e)&l|o&a)}}for(;s<r;)u(t.getEndOffset(s),t.getMetadata(s)),s++;return new u2(new Uint32Array(a),t.getLineContent())}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;for(;n<i;){let r=n+Math.floor((i-n)/2);if(e[r].endLineNumber<t)n=r+1;else{if(!(e[r].startLineNumber>t)){for(;r>n&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}i=r-1}}return n}acceptEdit(e,t,n,i,r){for(const o of this._pieces)o.acceptEdit(e,t,n,i,r)}}class M8{constructor(){this._lineTokens=[],this._len=0}flush(){this._lineTokens=[],this._len=0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),null!==i&&i!==x8)return new u2(I8(i),n);let r=new Uint32Array(2);return r[0]=n.length,r[1]=S8(e),new u2(r,n)}static _massageTokens(e,t,n){const i=n?I8(n):null;if(0===t){let t=!1;if(i&&i.length>1&&(t=pJ.getLanguageId(i[1])!==e),!t)return x8}if(!i||0===i.length){const n=new Uint32Array(2);return n[0]=t,n[1]=S8(e),n.buffer}return i[i.length-2]=t,0===i.byteOffset&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){0!==t&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(0===t)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=V1(this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,r){const o=M8._massageTokens(e,n,i);this._ensureLine(t);const s=this._lineTokens[t];return this._lineTokens[t]=o,!!r&&!M8._equals(s,o)}static _equals(e,t){if(!e||!t)return!e&&!t;const n=I8(e),i=I8(t);if(n.length!==i.length)return!1;for(let r=0,o=n.length;r<o;r++)if(n[r]!==i[r])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new IK(e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;return void(this._lineTokens[t]=M8._delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1))}this._lineTokens[t]=M8._deleteEnding(this._lineTokens[t],e.startColumn-1);const n=e.endLineNumber-1;let i=null;n<this._len&&(i=M8._deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=M8._append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(0===t&&0===n)return;const i=e.lineNumber-1;i>=this._len||(0!==t?(this._lineTokens[i]=M8._deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=M8._insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)):this._lineTokens[i]=M8._insert(this._lineTokens[i],e.column-1,n))}static _deleteBeginning(e,t){return null===e||e===x8?e:M8._delete(e,0,t)}static _deleteEnding(e,t){if(null===e||e===x8)return e;const n=I8(e),i=n[n.length-2];return M8._delete(e,t,i)}static _delete(e,t,n){if(null===e||e===x8||t===n)return e;const i=I8(e),r=i.length>>>1;if(0===t&&i[i.length-2]===n)return x8;const o=u2.findIndexInTokensArray(i,t),s=o>0?i[o-1<<1]:0;if(n<i[o<<1]){const s=n-t;for(let e=o;e<r;e++)i[e<<1]-=s;return e}let a,l;s!==t?(i[o<<1]=t,a=o+1<<1,l=t):(a=o<<1,l=s);const c=n-t;for(let h=o+1;h<r;h++){const e=i[h<<1]-c;e>l&&(i[a++]=e,i[a++]=i[1+(h<<1)],l=e)}if(a===i.length)return e;let u=new Uint32Array(a);return u.set(i.subarray(0,a),0),u.buffer}static _append(e,t){if(t===x8)return e;if(e===x8)return t;if(null===e)return e;if(null===t)return null;const n=I8(e),i=I8(t),r=i.length>>>1;let o=new Uint32Array(n.length+i.length);o.set(n,0);let s=n.length;const a=n[n.length-2];for(let l=0;l<r;l++)o[s++]=i[l<<1]+a,o[s++]=i[1+(l<<1)];return o.buffer}static _insert(e,t,n){if(null===e||e===x8)return e;const i=I8(e),r=i.length>>>1;let o=u2.findIndexInTokensArray(i,t);if(o>0){i[o-1<<1]===t&&o--}for(let s=o;s<r;s++)i[s<<1]+=n;return e}}class A8 extends mG{constructor(e,t,n,i,r,o,s){super(),this._onDidChangeContent=this._register(new EG),this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._pieceTree=new w8(e,n,s)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t;const i=this.getPositionAt(e),r=this.getPositionAt(n);return new TK(i.lineNumber,i.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn);return this.getOffsetAt(e.endLineNumber,e.endColumn)-n}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0;const i=e.startLineNumber,r=e.endLineNumber;for(let t=i;t<=r;t++){const o=this.getLineContent(t),s=t===i?e.startColumn-1:0,a=t===r?e.endColumn-1:o.length;for(let e=s;e<a;e++)kX(o.charCodeAt(e))?(n+=1,e+=1):n+=1}return n+=this._getEndOfLine(t).length*(r-i),n}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=hX(this.getLineContent(e));return-1===t?0:t+1}getLineLastNonWhitespaceColumn(e){const t=fX(this.getLineContent(e));return-1===t?0:t+2}_getEndOfLine(e){switch(e){case 1:return"\n";case 2:return"\r\n";case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,s=!0,a=[];for(let g=0;g<e.length;g++){let t=e[g];s&&t._isTracked&&(s=!1);let n=t.range;if(t.text){let e=!0;o||(e=!PX(t.text),o=e),!i&&e&&(i=AX(t.text)),!r&&e&&(r=BX(t.text))}let l="",c=0,u=0,h=0;if(t.text){let e;[c,u,h,e]=C8(t.text);const n=this.getEOL(),i="\r\n"===n?2:1;l=0===e||e===i?t.text:t.text.replace(/\r\n|\r|\n/g,n)}a[g]={sortIndex:g,identifier:t.identifier||null,range:n,rangeOffset:this.getOffsetAt(n.startLineNumber,n.startColumn),rangeLength:this.getValueLengthInRange(n),text:l,eolCount:c,firstLineLength:u,lastLineLength:h,forceMoveMarkers:Boolean(t.forceMoveMarkers),isAutoWhitespaceEdit:t.isAutoWhitespaceEdit||!1}}a.sort(A8._sortOpsAscending);let l=!1;for(let g=0,p=a.length-1;g<p;g++){let e=a[g].range.getEndPosition(),t=a[g+1].range.getStartPosition();if(t.isBeforeOrEqual(e)){if(t.isBefore(e))throw new Error("Overlapping ranges are not allowed!");l=!0}}s&&(a=this._reduceOperations(a));let c=n||t?A8._getInverseEditRanges(a):[],u=[];if(t)for(let g=0;g<a.length;g++){let e=a[g],t=c[g];if(e.isAutoWhitespaceEdit&&e.range.isEmpty())for(let n=t.startLineNumber;n<=t.endLineNumber;n++){let i="";n===t.startLineNumber&&(i=this.getLineContent(e.range.startLineNumber),-1!==hX(i))||u.push({lineNumber:n,oldContent:i})}}let h=null;if(n){let e=0;h=[];for(let t=0;t<a.length;t++){const n=a[t],i=c[t],r=this.getValueInRange(n.range),o=n.rangeOffset+e;e+=n.text.length-r.length,h[t]={sortIndex:n.sortIndex,identifier:n.identifier,range:i,text:r,textChange:new f9(n.rangeOffset,r,o,n.text)}}l||h.sort(((e,t)=>e.sortIndex-t.sortIndex))}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=o;const d=this._doApplyEdits(a);let f=null;if(t&&u.length>0){u.sort(((e,t)=>t.lineNumber-e.lineNumber)),f=[];for(let e=0,t=u.length;e<t;e++){let t=u[e].lineNumber;if(e>0&&u[e-1].lineNumber===t)continue;let n=u[e].oldContent,i=this.getLineContent(t);0!==i.length&&i!==n&&-1===hX(i)&&f.push(t)}}return this._onDidChangeContent.fire(),new kQ(h,d,f)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const n=e[0].range,i=e[e.length-1].range,r=new TK(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn);let o=n.startLineNumber,s=n.startColumn;const a=[];for(let d=0,f=e.length;d<f;d++){const n=e[d],i=n.range;t=t||n.forceMoveMarkers,a.push(this.getValueInRange(new TK(o,s,i.startLineNumber,i.startColumn))),n.text.length>0&&a.push(n.text),o=i.endLineNumber,s=i.endColumn}const l=a.join(""),[c,u,h]=C8(l);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:l,eolCount:c,firstLineLength:u,lastLineLength:h,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(A8._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n];const r=i.range.startLineNumber,o=i.range.startColumn,s=i.range.endLineNumber,a=i.range.endColumn;if(r===s&&o===a&&0===i.text.length)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);const l=new TK(r,o,s,a);t.push({range:l,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}static _getInverseEditRanges(e){let t=[],n=0,i=0,r=null;for(let o=0,s=e.length;o<s;o++){let s,a,l,c=e[o];if(r?r.range.endLineNumber===c.range.startLineNumber?(s=n,a=i+(c.range.startColumn-r.range.endColumn)):(s=n+(c.range.startLineNumber-r.range.endLineNumber),a=c.range.startColumn):(s=c.range.startLineNumber,a=c.range.startColumn),c.text.length>0){const e=c.eolCount+1;l=1===e?new TK(s,a,s,a+c.firstLineLength):new TK(s,a,s+e-1,c.lastLineLength+1)}else l=new TK(s,a,s,a);n=l.endLineNumber,i=l.endColumn,t.push(l),r=c}return t}static _sortOpsAscending(e,t){let n=TK.compareRangesUsingEnds(e.range,t.range);return 0===n?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=TK.compareRangesUsingEnds(e.range,t.range);return 0===n?t.sortIndex-e.sortIndex:-n}}class O8{constructor(e,t,n,i,r,o,s,a,l){this._chunks=e,this._bom=t,this._cr=n,this._lf=i,this._crlf=r,this._containsRTL=o,this._containsUnusualLineTerminators=s,this._isBasicASCII=a,this._normalizeEOL=l}_getEOL(e){const t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return 0===t?1===e?"\n":"\r\n":n>t/2?"\r\n":"\n"}create(e){const t=this._getEOL(e);let n=this._chunks;if(this._normalizeEOL&&("\r\n"===t&&(this._cr>0||this._lf>0)||"\n"===t&&(this._cr>0||this._crlf>0)))for(let r=0,o=n.length;r<o;r++){let e=n[r].buffer.replace(/\r\n|\r|\n/g,t),i=m8(e);n[r]=new y8(e,i)}const i=new A8(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}}class R8{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(0===e.length)return;0===this.chunks.length&&UX(e)&&(this.BOM=VX,e=e.substr(1));const t=e.charCodeAt(e.length-1);13===t||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){(t||0!==e.length)&&(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=function(e,t){e.length=0,e[0]=0;let n=1,i=0,r=0,o=0,s=!0;for(let l=0,c=t.length;l<c;l++){const a=t.charCodeAt(l);13===a?l+1<c&&10===t.charCodeAt(l+1)?(o++,e[n++]=l+2,l++):(i++,e[n++]=l+1):10===a?(r++,e[n++]=l+1):s&&9!==a&&(a<32||a>126)&&(s=!1)}const a=new p8(g8(e),i,r,o,s);return e.length=0,a}(this._tmpLineStarts,e);this.chunks.push(new y8(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,this.isBasicASCII&&(this.isBasicASCII=t.isBasicASCII),this.isBasicASCII||this.containsRTL||(this.containsRTL=AX(e)),this.isBasicASCII||this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=BX(e))}finish(e=!0){return this._finish(),new O8(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(0===this.chunks.length&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=m8(e.buffer);e.lineStarts=t,13===this._previousChar&&this.cr++}}}class P8{constructor(){this.changeType=1}}class F8{constructor(e,t,n,i,r){this.ownerId=e,this.lineNumber=t,this.column=n,this.order=i,this.text=r}static applyInjectedText(e,t){if(!t||0===t.length)return e;let n="",i=0;for(const r of t)n+=e.substring(i,r.column-1),i=r.column-1,n+=r.text;return n+=e.substring(i),n}static fromDecorations(e){const t=[];for(const n of e)n.options.before&&n.options.before.content.length>0&&t.push(new F8(n.ownerId,n.range.startLineNumber,n.range.startColumn,0,n.options.before.content)),n.options.after&&n.options.after.content.length>0&&t.push(new F8(n.ownerId,n.range.endLineNumber,n.range.endColumn,1,n.options.after.content));return t.sort(((e,t)=>e.lineNumber===t.lineNumber?e.column===t.column?e.order-t.order:e.column-t.column:e.lineNumber-t.lineNumber)),t}}class B8{constructor(e,t,n){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=n}}class W8{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class z8{constructor(e,t,n,i){this.changeType=4,this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}}class V8{constructor(){this.changeType=5}}class U8{constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++){if(this.changes[t].changeType===e)return!0}return!1}static merge(e,t){const n=[].concat(e.changes).concat(t.changes),i=t.versionId,r=e.isUndoing||t.isUndoing,o=e.isRedoing||t.isRedoing;return new U8(n,i,r,o)}}class H8{constructor(e){this.changes=e}}class j8{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=U8.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=j8._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new j8(t,n)}static _mergeChangeEvents(e,t){return{changes:[].concat(e.changes).concat(t.changes),eol:t.eol,versionId:t.versionId,isUndoing:e.isUndoing||t.isUndoing,isRedoing:e.isRedoing||t.isRedoing,isFlush:e.isFlush||t.isFlush}}}class G8{constructor(){this._beginState=[],this._valid=[],this._len=0,this._invalidLineStartIndex=0}_reset(e){this._beginState=[],this._valid=[],this._len=0,this._invalidLineStartIndex=0,e&&this._setBeginState(0,e)}flush(e){this._reset(e)}get invalidLineStartIndex(){return this._invalidLineStartIndex}_invalidateLine(e){e<this._len&&(this._valid[e]=!1),e<this._invalidLineStartIndex&&(this._invalidLineStartIndex=e)}_isValid(e){return e<this._len&&this._valid[e]}getBeginState(e){return e<this._len?this._beginState[e]:null}_ensureLine(e){for(;e>=this._len;)this._beginState[this._len]=null,this._valid[this._len]=!1,this._len++}_deleteLines(e,t){0!==t&&(e+t>this._len&&(t=this._len-e),this._beginState.splice(e,t),this._valid.splice(e,t),this._len-=t)}_insertLines(e,t){if(0===t)return;let n=[],i=[];for(let r=0;r<t;r++)n[r]=null,i[r]=!1;this._beginState=V1(this._beginState,e,n),this._valid=V1(this._valid,e,i),this._len+=t}_setValid(e,t){this._ensureLine(e),this._valid[e]=t}_setBeginState(e,t){this._ensureLine(e),this._beginState[e]=t}setEndState(e,t,n){if(this._setValid(t,!0),this._invalidLineStartIndex=t+1,t===e-1)return;const i=this.getBeginState(t+1);if(null===i||!n.equals(i))return this._setBeginState(t+1,n),void this._invalidateLine(t+1);let r=t+1;for(;r<e&&this._isValid(r);)r++;this._invalidLineStartIndex=r}setFakeTokens(e){this._setValid(e,!1)}applyEdits(e,t){const n=e.endLineNumber-e.startLineNumber,i=t;for(let r=Math.min(n,i);r>=0;r--)this._invalidateLine(e.startLineNumber+r-1);this._acceptDeleteRange(e),this._acceptInsertText(new IK(e.startLineNumber,e.startColumn),t)}_acceptDeleteRange(e){e.startLineNumber-1>=this._len||this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){e.lineNumber-1>=this._len||this._insertLines(e.lineNumber,t)}}class K8 extends mG{constructor(e){super(),this._isDisposed=!1,this._textModel=e,this._tokenizationStateStore=new G8,this._tokenizationSupport=null,this._register(YJ.onDidChange((e=>{const t=this._textModel.getLanguageIdentifier();-1!==e.changedLanguages.indexOf(t.language)&&(this._resetTokenizationState(),this._textModel.clearTokens())}))),this._register(this._textModel.onDidChangeContentFast((e=>{if(e.isFlush)this._resetTokenizationState();else{for(let t=0,n=e.changes.length;t<n;t++){const n=e.changes[t],[i]=C8(n.text);this._tokenizationStateStore.applyEdits(n.range,i)}this._beginBackgroundTokenization()}}))),this._register(this._textModel.onDidChangeAttached((()=>{this._beginBackgroundTokenization()}))),this._register(this._textModel.onDidChangeLanguage((()=>{this._resetTokenizationState(),this._textModel.clearTokens()}))),this._resetTokenizationState()}dispose(){this._isDisposed=!0,super.dispose()}_resetTokenizationState(){const[e,t]=function(e){const t=e.getLanguageIdentifier();let n=e.isTooLargeForTokenization()?null:YJ.get(t.language),i=null;if(n)try{i=n.getInitialState()}catch(zWe){nG(zWe),n=null}return[n,i]}(this._textModel);this._tokenizationSupport=e,this._tokenizationStateStore.flush(t),this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&gj((()=>{this._isDisposed||this._revalidateTokensNow()}))}_revalidateTokensNow(e=this._textModel.getLineCount()){const t=new E8,n=CG.create(!1);for(;this._hasLinesToTokenize()&&!(n.elapsed()>1);){if(this._tokenizeOneInvalidLine(t)>=e)break}this._beginBackgroundTokenization(),this._textModel.setTokens(t.tokens)}tokenizeViewport(e,t){const n=new E8;this._tokenizeViewport(n,e,t),this._textModel.setTokens(n.tokens)}reset(){this._resetTokenizationState(),this._textModel.clearTokens()}forceTokenization(e){const t=new E8;this._updateTokensUntilLine(t,e),this._textModel.setTokens(t.tokens)}isCheapToTokenize(e){if(!this._tokenizationSupport)return!0;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return!(e>t)&&(e<t||this._textModel.getLineLength(e)<2048)}_hasLinesToTokenize(){return!!this._tokenizationSupport&&this._tokenizationStateStore.invalidLineStartIndex<this._textModel.getLineCount()}_tokenizeOneInvalidLine(e){if(!this._hasLinesToTokenize())return this._textModel.getLineCount()+1;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return this._updateTokensUntilLine(e,t),t}_updateTokensUntilLine(e,t){if(!this._tokenizationSupport)return;const n=this._textModel.getLanguageIdentifier(),i=this._textModel.getLineCount(),r=t-1;for(let o=this._tokenizationStateStore.invalidLineStartIndex;o<=r;o++){const t=this._textModel.getLineContent(o+1),r=this._tokenizationStateStore.getBeginState(o),s=q8(n,this._tokenizationSupport,t,!0,r);e.add(o+1,s.tokens),this._tokenizationStateStore.setEndState(i,o,s.endState),o=this._tokenizationStateStore.invalidLineStartIndex-1}}_tokenizeViewport(e,t,n){if(!this._tokenizationSupport)return;if(n<=this._tokenizationStateStore.invalidLineStartIndex)return;if(t<=this._tokenizationStateStore.invalidLineStartIndex)return void this._updateTokensUntilLine(e,n);let i=this._textModel.getLineFirstNonWhitespaceColumn(t),r=[],o=null;for(let l=t-1;i>0&&l>=1;l--){let e=this._textModel.getLineFirstNonWhitespaceColumn(l);if(0!==e&&e<i){if(o=this._tokenizationStateStore.getBeginState(l-1),o)break;r.push(this._textModel.getLineContent(l)),i=e}}o||(o=this._tokenizationSupport.getInitialState());const s=this._textModel.getLanguageIdentifier();let a=o;for(let l=r.length-1;l>=0;l--){a=q8(s,this._tokenizationSupport,r[l],!1,a).endState}for(let l=t;l<=n;l++){let t=this._textModel.getLineContent(l),n=q8(s,this._tokenizationSupport,t,!0,a);e.add(l,n.tokens),this._tokenizationStateStore.setFakeTokens(l-1),a=n.endState}}}function q8(e,t,n,i,r){let o=null;if(t)try{o=t.tokenize2(n,i,r.clone(),0)}catch(zWe){nG(zWe)}return o||(o=JJ(e.id,0,r,0)),u2.convertToEndOffset(o.tokens,n.length),o}function $8(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}class Y8{constructor(e,t,n,i=1){this._rgbaBrand=void 0,this.r=0|Math.min(255,Math.max(0,e)),this.g=0|Math.min(255,Math.max(0,t)),this.b=0|Math.min(255,Math.max(0,n)),this.a=$8(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class X8{constructor(e,t,n,i){this._hslaBrand=void 0,this.h=0|Math.max(Math.min(360,e),0),this.s=$8(Math.max(Math.min(1,t),0),3),this.l=$8(Math.max(Math.min(1,n),0),3),this.a=$8(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,n=e.g/255,i=e.b/255,r=e.a,o=Math.max(t,n,i),s=Math.min(t,n,i);let a=0,l=0;const c=(s+o)/2,u=o-s;if(u>0){switch(l=Math.min(c<=.5?u/(2*c):u/(2-2*c),1),o){case t:a=(n-i)/u+(n<i?6:0);break;case n:a=(i-t)/u+2;break;case i:a=(t-n)/u+4}a*=60,a=Math.round(a)}return new X8(a,l,c,r)}static _hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}static toRGBA(e){const t=e.h/360,{s:n,l:i,a:r}=e;let o,s,a;if(0===n)o=s=a=i;else{const e=i<.5?i*(1+n):i+n-i*n,r=2*i-e;o=X8._hue2rgb(r,e,t+1/3),s=X8._hue2rgb(r,e,t),a=X8._hue2rgb(r,e,t-1/3)}return new Y8(Math.round(255*o),Math.round(255*s),Math.round(255*a),r)}}class Z8{constructor(e,t,n,i){this._hsvaBrand=void 0,this.h=0|Math.max(Math.min(360,e),0),this.s=$8(Math.max(Math.min(1,t),0),3),this.v=$8(Math.max(Math.min(1,n),0),3),this.a=$8(Math.max(Math.min(1,i),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),o=r-Math.min(t,n,i),s=0===r?0:o/r;let a;return a=0===o?0:r===t?((n-i)/o%6+6)%6:r===n?(i-t)/o+2:(t-n)/o+4,new Z8(Math.round(60*a),s,r,e.a)}static toRGBA(e){const{h:t,s:n,v:i,a:r}=e,o=i*n,s=o*(1-Math.abs(t/60%2-1)),a=i-o;let[l,c,u]=[0,0,0];return t<60?(l=o,c=s):t<120?(l=s,c=o):t<180?(c=o,u=s):t<240?(c=s,u=o):t<300?(l=s,u=o):t<=360&&(l=o,u=s),l=Math.round(255*(l+a)),c=Math.round(255*(c+a)),u=Math.round(255*(u+a)),new Y8(l,c,u,r)}}class Q8{constructor(e){if(!e)throw new Error("Color needs a value");if(e instanceof Y8)this.rgba=e;else if(e instanceof X8)this._hsla=e,this.rgba=X8.toRGBA(e);else{if(!(e instanceof Z8))throw new Error("Invalid color ctor argument");this._hsva=e,this.rgba=Z8.toRGBA(e)}}static fromHex(e){return Q8.Format.CSS.parseHex(e)||Q8.red}get hsla(){return this._hsla?this._hsla:X8.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:Z8.fromRGBA(this.rgba)}equals(e){return!!e&&Y8.equals(this.rgba,e.rgba)&&X8.equals(this.hsla,e.hsla)&&Z8.equals(this.hsva,e.hsva)}getRelativeLuminance(){return $8(.2126*Q8._relativeLuminanceForComponent(this.rgba.r)+.7152*Q8._relativeLuminanceForComponent(this.rgba.g)+.0722*Q8._relativeLuminanceForComponent(this.rgba.b),4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3>=128}isLighterThan(e){return this.getRelativeLuminance()>e.getRelativeLuminance()}isDarkerThan(e){return this.getRelativeLuminance()<e.getRelativeLuminance()}lighten(e){return new Q8(new X8(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new Q8(new X8(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:n,b:i,a:r}=this.rgba;return new Q8(new Y8(t,n,i,r*e))}isTransparent(){return 0===this.rgba.a}isOpaque(){return 1===this.rgba.a}opposite(){return new Q8(new Y8(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}toString(){return""+Q8.Format.CSS.format(this)}static getLighterColor(e,t,n){if(e.isLighterThan(t))return e;n=n||.5;const i=e.getRelativeLuminance(),r=t.getRelativeLuminance();return n=n*(r-i)/r,e.lighten(n)}static getDarkerColor(e,t,n){if(e.isDarkerThan(t))return e;n=n||.5;const i=e.getRelativeLuminance();return n=n*(i-t.getRelativeLuminance())/i,e.darken(n)}}var J8,e7;function t7(e){const t=new R8;return t.acceptChunk(e),t.finish()}function n7(e,t){return("string"==typeof e?t7(e):e).create(t)}Q8.white=new Q8(new Y8(255,255,255,1)),Q8.black=new Q8(new Y8(0,0,0,1)),Q8.red=new Q8(new Y8(255,0,0,1)),Q8.blue=new Q8(new Y8(0,0,255,1)),Q8.cyan=new Q8(new Y8(0,255,255,1)),Q8.lightgrey=new Q8(new Y8(211,211,211,1)),Q8.transparent=new Q8(new Y8(0,0,0,0)),J8=Q8||(Q8={}),function(e){function t(e){const t=e.toString(16);return 2!==t.length?"0"+t:t}function n(e){switch(e){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:case 65:return 10;case 98:case 66:return 11;case 99:case 67:return 12;case 100:case 68:return 13;case 101:case 69:return 14;case 102:case 70:return 15}return 0}e.formatRGB=function(e){return 1===e.rgba.a?`rgb(${e.rgba.r}, ${e.rgba.g}, ${e.rgba.b})`:J8.Format.CSS.formatRGBA(e)},e.formatRGBA=function(e){return`rgba(${e.rgba.r}, ${e.rgba.g}, ${e.rgba.b}, ${+e.rgba.a.toFixed(2)})`},e.formatHSL=function(e){return 1===e.hsla.a?`hsl(${e.hsla.h}, ${(100*e.hsla.s).toFixed(2)}%, ${(100*e.hsla.l).toFixed(2)}%)`:J8.Format.CSS.formatHSLA(e)},e.formatHSLA=function(e){return`hsla(${e.hsla.h}, ${(100*e.hsla.s).toFixed(2)}%, ${(100*e.hsla.l).toFixed(2)}%, ${e.hsla.a.toFixed(2)})`},e.formatHex=function(e){return`#${t(e.rgba.r)}${t(e.rgba.g)}${t(e.rgba.b)}`},e.formatHexA=function(e,n=!1){return n&&1===e.rgba.a?J8.Format.CSS.formatHex(e):`#${t(e.rgba.r)}${t(e.rgba.g)}${t(e.rgba.b)}${t(Math.round(255*e.rgba.a))}`},e.format=function(e){return e.isOpaque()?J8.Format.CSS.formatHex(e):J8.Format.CSS.formatRGBA(e)},e.parseHex=function(e){const t=e.length;if(0===t)return null;if(35!==e.charCodeAt(0))return null;if(7===t){const t=16*n(e.charCodeAt(1))+n(e.charCodeAt(2)),i=16*n(e.charCodeAt(3))+n(e.charCodeAt(4)),r=16*n(e.charCodeAt(5))+n(e.charCodeAt(6));return new J8(new Y8(t,i,r,1))}if(9===t){const t=16*n(e.charCodeAt(1))+n(e.charCodeAt(2)),i=16*n(e.charCodeAt(3))+n(e.charCodeAt(4)),r=16*n(e.charCodeAt(5))+n(e.charCodeAt(6)),o=16*n(e.charCodeAt(7))+n(e.charCodeAt(8));return new J8(new Y8(t,i,r,o/255))}if(4===t){const t=n(e.charCodeAt(1)),i=n(e.charCodeAt(2)),r=n(e.charCodeAt(3));return new J8(new Y8(16*t+t,16*i+i,16*r+r))}if(5===t){const t=n(e.charCodeAt(1)),i=n(e.charCodeAt(2)),r=n(e.charCodeAt(3)),o=n(e.charCodeAt(4));return new J8(new Y8(16*t+t,16*i+i,16*r+r,(16*o+o)/255))}return null}}((e7=J8.Format||(J8.Format={})).CSS||(e7.CSS={}));let i7=0;class r7{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;for(;;){let i=this._source.read();if(null===i)return this._eos=!0,0===t?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=65536)return e.join("")}}}const o7=()=>{throw new Error("Invalid change accessor")};class s7{constructor(){this._searchCanceledBrand=void 0}}function a7(e){return e instanceof s7?null:e}s7.INSTANCE=new s7;class l7 extends mG{constructor(e,t,n,i=null,r){super(),this._onWillDispose=this._register(new EG),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new b7((e=>this.handleBeforeFireDecorationsChangedEvent(e)))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeLanguage=this._register(new EG),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new EG),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new EG),this.onDidChangeTokens=this._onDidChangeTokens.event,this._onDidChangeOptions=this._register(new EG),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new EG),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeContentOrInjectedText=this._register(new EG),this.onDidChangeContentOrInjectedText=this._onDidChangeContentOrInjectedText.event,this._eventEmitter=this._register(new w7),this._register(this._eventEmitter.fastEvent((e=>{this._onDidChangeContentOrInjectedText.fire(e.rawContentChangedEvent)}))),i7++,this.id="$model"+i7,this.isForSimpleWidget=t.isForSimpleWidget,this._associatedResource=null==i?_K.parse("inmemory://model/"+i7):i,this._undoRedoService=r,this._attachedEditorCount=0;const{textBuffer:o,disposable:s}=n7(e,t.defaultEOL);this._buffer=o,this._bufferDisposable=s,this._options=l7.resolveOptions(this._buffer,t);const a=this._buffer.getLineCount(),l=this._buffer.getValueLengthInRange(new TK(1,1,a,this._buffer.getLineLength(a)+1),0);t.largeFileOptimizations?this._isTooLargeForTokenization=l>l7.LARGE_FILE_SIZE_THRESHOLD||a>l7.LARGE_FILE_LINE_COUNT_THRESHOLD:this._isTooLargeForTokenization=!1,this._isTooLargeForSyncing=l>l7.MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this._isDisposing=!1,this._languageIdentifier=n||ZJ,this._languageRegistryListener=q0.onDidChange((e=>{e.languageIdentifier.id===this._languageIdentifier.id&&this._onDidChangeLanguageConfiguration.fire({})})),this._instanceId=HX(i7),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new h7,this._commandManager=new b9(this,r),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._tokens=new M8,this._tokens2=new T8,this._tokenization=new K8(this)}static resolveOptions(e,t){if(t.detectIndentation){const n=S9(e,t.tabSize,t.insertSpaces);return new SQ({tabSize:n.tabSize,indentSize:n.tabSize,insertSpaces:n.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL})}return new SQ({tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL})}onDidChangeContentFast(e){return this._eventEmitter.fastEvent((t=>e(t.contentChangedEvent)))}onDidChangeContent(e){return this._eventEmitter.slowEvent((t=>e(t.contentChangedEvent)))}dispose(){this._isDisposing=!0,this._onWillDispose.fire(),this._languageRegistryListener.dispose(),this._tokenization.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this._isDisposing=!1;const e=new A8([],"","\n",!1,!1,!0,!0);e.dispose(),this._buffer=e}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(e,t){this._isDisposing||this._eventEmitter.fire(new j8(e,t))}setValue(e){if(this._assertNotDisposed(),null===e)return;const{textBuffer:t,disposable:n}=n7(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,n)}_createContentChanged2(e,t,n,i,r,o,s){return{changes:[{range:e,rangeOffset:t,rangeLength:n,text:i}],eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:r,isRedoing:o,isFlush:s}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueLengthInRange(n),r=this.getLineCount(),o=this.getLineMaxColumn(r);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._tokens.flush(),this._tokens2.flush(),this._decorations=Object.create(null),this._decorationsTree=new h7,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new U8([new P8],this._versionId,!1,!1),this._createContentChanged2(new TK(1,1,r,o),0,i,this.getValue(),!1,!1,!0))}setEOL(e){this._assertNotDisposed();const t=1===e?"\r\n":"\n";if(this._buffer.getEOL()===t)return;const n=this.getFullModelRange(),i=this.getValueLengthInRange(n),r=this.getLineCount(),o=this.getLineMaxColumn(r);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new U8([new V8],this._versionId,!1,!1),this._createContentChanged2(new TK(1,1,r,o),0,i,this.getValue(),!1,!1,!1))}_onBeforeEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.search(0,!1,!1,e);this._ensureNodesHaveRanges(t)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let n=0,i=t.length;n<i;n++){const i=t[n],r=i.cachedAbsoluteStart-i.start,o=this._buffer.getOffsetAt(i.range.startLineNumber,i.range.startColumn),s=this._buffer.getOffsetAt(i.range.endLineNumber,i.range.endColumn);i.cachedAbsoluteStart=o,i.cachedAbsoluteEnd=s,i.cachedVersionId=e,i.start=o-r,i.end=s-r,H9(i)}}onBeforeAttached(){this._attachedEditorCount++,1===this._attachedEditorCount&&this._onDidChangeAttached.fire(void 0)}onBeforeDetached(){this._attachedEditorCount--,0===this._attachedEditorCount&&this._onDidChangeAttached.fire(void 0)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const n=this._buffer.getLineCount();for(let i=1;i<=n;i++){const n=this._buffer.getLineLength(i);n>=1e4?t+=n:e+=n}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();let t=void 0!==e.tabSize?e.tabSize:this._options.tabSize,n=void 0!==e.indentSize?e.indentSize:this._options.indentSize,i=void 0!==e.insertSpaces?e.insertSpaces:this._options.insertSpaces,r=void 0!==e.trimAutoWhitespace?e.trimAutoWhitespace:this._options.trimAutoWhitespace,o=new SQ({tabSize:t,indentSize:n,insertSpaces:i,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:r});if(this._options.equals(o))return;let s=this._options.createChangeEvent(o);this._options=o,this._onDidChangeOptions.fire(s)}detectIndentation(e,t){this._assertNotDisposed();let n=S9(this._buffer,t,e);this.updateOptions({insertSpaces:n.insertSpaces,tabSize:n.tabSize,indentSize:n.tabSize})}static _normalizeIndentationFromWhitespace(e,t,n){let i=0;for(let o=0;o<e.length;o++)"\t"===e.charAt(o)?i+=t:i++;let r="";if(!n){let e=Math.floor(i/t);i%=t;for(let t=0;t<e;t++)r+="\t"}for(let o=0;o<i;o++)r+=" ";return r}static normalizeIndentation(e,t,n){let i=hX(e);return-1===i&&(i=e.length),l7._normalizeIndentationFromWhitespace(e.substring(0,i),t,n)+e.substring(i)}normalizeIndentation(e){return this._assertNotDisposed(),l7.normalizeIndentation(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(FX.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map((e=>({range:e.range,text:null}))),(()=>null))}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();let t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();let t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueInRange(n,e);return t?this._buffer.getBOM()+i:i}createSnapshot(e=!1){return new r7(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueLengthInRange(n,e);return t?this._buffer.getBOM().length+i:i}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){return this._assertNotDisposed(),this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),"\n"===this._buffer.getEOL()?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),n=e.startLineNumber,i=e.startColumn;let r=Math.floor("number"!=typeof n||isNaN(n)?1:n),o=Math.floor("number"!=typeof i||isNaN(i)?1:i);if(r<1)r=1,o=1;else if(r>t)r=t,o=this.getLineMaxColumn(r);else if(o<=1)o=1;else{const e=this.getLineMaxColumn(r);o>=e&&(o=e)}const s=e.endLineNumber,a=e.endColumn;let l=Math.floor("number"!=typeof s||isNaN(s)?1:s),c=Math.floor("number"!=typeof a||isNaN(a)?1:a);if(l<1)l=1,c=1;else if(l>t)l=t,c=this.getLineMaxColumn(l);else if(c<=1)c=1;else{const e=this.getLineMaxColumn(l);c>=e&&(c=e)}return n===r&&i===o&&s===l&&a===c&&e instanceof TK&&!(e instanceof MK)?e:new TK(r,o,l,c)}_isValidPosition(e,t,n){if("number"!=typeof e||"number"!=typeof t)return!1;if(isNaN(e)||isNaN(t))return!1;if(e<1||t<1)return!1;if((0|e)!==e||(0|t)!==t)return!1;if(e>this._buffer.getLineCount())return!1;if(1===t)return!0;if(t>this.getLineMaxColumn(e))return!1;if(1===n){if(kX(this._buffer.getLineCharCode(e,t-2)))return!1}return!0}_validatePosition(e,t,n){const i=Math.floor("number"!=typeof e||isNaN(e)?1:e),r=Math.floor("number"!=typeof t||isNaN(t)?1:t),o=this._buffer.getLineCount();if(i<1)return new IK(1,1);if(i>o)return new IK(o,this.getLineMaxColumn(o));if(r<=1)return new IK(i,1);const s=this.getLineMaxColumn(i);if(r>=s)return new IK(i,s);if(1===n){if(kX(this._buffer.getLineCharCode(i,r-2)))return new IK(i,r-1)}return new IK(i,r)}validatePosition(e){return this._assertNotDisposed(),e instanceof IK&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,o=e.endColumn;if(!this._isValidPosition(n,i,0))return!1;if(!this._isValidPosition(r,o,0))return!1;if(1===t){const e=i>1?this._buffer.getLineCharCode(n,i-2):0,t=o>1&&o<=this._buffer.getLineLength(r)?this._buffer.getLineCharCode(r,o-2):0,s=kX(e),a=kX(t);return!s&&!a}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof TK&&!(e instanceof MK)&&this._isValidRange(e,1))return e;const t=this._validatePosition(e.startLineNumber,e.startColumn,0),n=this._validatePosition(e.endLineNumber,e.endColumn,0),i=t.lineNumber,r=t.column,o=n.lineNumber,s=n.column;{const e=r>1?this._buffer.getLineCharCode(i,r-2):0,t=s>1&&s<=this._buffer.getLineLength(o)?this._buffer.getLineCharCode(o,s-2):0,n=kX(e),a=kX(t);return n||a?i===o&&r===s?new TK(i,r-1,o,s-1):n&&a?new TK(i,r-1,o,s+1):n?new TK(i,r-1,o,s):new TK(i,r,o,s+1):new TK(i,r,o,s)}}modifyPosition(e,t){this._assertNotDisposed();let n=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,n)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new TK(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,n,i){return this._buffer.findMatchesLineByLine(e,t,n,i)}findMatches(e,t,n,i,r,o,s=999){this._assertNotDisposed();let a=null;null!==t&&(Array.isArray(t)||(t=[t]),t.every((e=>TK.isIRange(e)))&&(a=t.map((e=>this.validateRange(e))))),null===a&&(a=[this.getFullModelRange()]),a=a.sort(((e,t)=>e.startLineNumber-t.startLineNumber||e.startColumn-t.startColumn));const l=[];let c;if(l.push(a.reduce(((e,t)=>TK.areIntersecting(e,t)?e.plusRange(t):(l.push(e),t)))),!n&&e.indexOf("\n")<0){const t=new a8(e,n,i,r).parseSearchRequest();if(!t)return[];c=e=>this.findMatchesLineByLine(e,t,o,s)}else c=t=>h8.findMatches(this,new a8(e,n,i,r),t,o,s);return l.map(c).reduce(((e,t)=>e.concat(t)),[])}findNextMatch(e,t,n,i,r,o){this._assertNotDisposed();const s=this.validatePosition(t);if(!n&&e.indexOf("\n")<0){const t=new a8(e,n,i,r).parseSearchRequest();if(!t)return null;const a=this.getLineCount();let l=new TK(s.lineNumber,s.column,a,this.getLineMaxColumn(a)),c=this.findMatchesLineByLine(l,t,o,1);return h8.findNextMatch(this,new a8(e,n,i,r),s,o),c.length>0?c[0]:(l=new TK(1,1,s.lineNumber,this.getLineMaxColumn(s.lineNumber)),c=this.findMatchesLineByLine(l,t,o,1),c.length>0?c[0]:null)}return h8.findNextMatch(this,new a8(e,n,i,r),s,o)}findPreviousMatch(e,t,n,i,r,o){this._assertNotDisposed();const s=this.validatePosition(t);return h8.findPreviousMatch(this,new a8(e,n,i,r),s,o)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if(("\n"===this.getEOL()?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof EQ?e:new EQ(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this._validateEditOperation(e[n]);return t}pushEditOperations(e,t,n){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,n){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let n=t.map((e=>({range:this.validateRange(e.range),text:e.text}))),i=!0;if(e)for(let t=0,r=e.length;t<r;t++){let r=e[t],o=!1;for(let e=0,t=n.length;e<t;e++){let t=n[e].range,i=t.startLineNumber>r.endLineNumber,s=r.startLineNumber>t.endLineNumber;if(!i&&!s){o=!0;break}}if(!o){i=!1;break}}if(i)for(let e=0,r=this._trimAutoWhitespaceLines.length;e<r;e++){let i=this._trimAutoWhitespaceLines[e],r=this.getLineMaxColumn(i),o=!0;for(let e=0,t=n.length;e<t;e++){let t=n[e].range,s=n[e].text;if(!(i<t.startLineNumber||i>t.endLineNumber)&&!(i===t.startLineNumber&&t.startColumn===r&&t.isEmpty()&&s&&s.length>0&&"\n"===s.charAt(0)||i===t.startLineNumber&&1===t.startColumn&&t.isEmpty()&&s&&s.length>0&&"\n"===s.charAt(s.length-1))){o=!1;break}}if(o){const e=new TK(i,1,i,r);t.push(new EQ(null,e,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,n)}_applyUndo(e,t,n,i){const r=e.map((e=>{const t=this.getPositionAt(e.newPosition),n=this.getPositionAt(e.newEnd);return{range:new TK(t.lineNumber,t.column,n.lineNumber,n.column),text:e.oldText}}));this._applyUndoRedoEdits(r,t,!0,!1,n,i)}_applyRedo(e,t,n,i){const r=e.map((e=>{const t=this.getPositionAt(e.oldPosition),n=this.getPositionAt(e.oldEnd);return{range:new TK(t.lineNumber,t.column,n.lineNumber,n.column),text:e.newText}}));this._applyUndoRedoEdits(r,t,!1,!0,n,i)}_applyUndoRedoEdits(e,t,n,i,r,o){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=n,this._isRedoing=i,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(r)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(o),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const n=this._validateEditOperations(e);return this._doApplyEdits(n,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const n=this._buffer.getLineCount(),i=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),r=this._buffer.getLineCount(),o=i.changes;if(this._trimAutoWhitespaceLines=i.trimAutoWhitespaceLineNumbers,0!==o.length){for(let n=0,i=o.length;n<i;n++){const e=o[n],[t,i,r]=C8(e.text);this._tokens.acceptEdit(e.range,t,i),this._tokens2.acceptEdit(e.range,t,i,r,e.text.length>0?e.text.charCodeAt(0):0),this._decorationsTree.acceptReplace(e.rangeOffset,e.rangeLength,e.text.length,e.forceMoveMarkers)}let e=[];this._increaseVersionId();let t=n;for(let n=0,i=o.length;n<i;n++){const i=o[n],[s]=C8(i.text);this._onDidChangeDecorations.fire();const a=i.range.startLineNumber,l=i.range.endLineNumber,c=l-a,u=s,h=Math.min(c,u),d=u-c,f=r-t-d+a,g=f,p=f+u,m=this._ensureNodesHaveRanges(this._decorationsTree.getInjectedTextInInterval(this.getOffsetAt(new IK(g,1)),this.getOffsetAt(new IK(p,this.getLineMaxColumn(p))),0,this._versionId)),v=F8.fromDecorations(m),y=new G1(v);for(let t=h;t>=0;t--){const n=a+t,i=f+t;y.takeFromEndWhile((e=>e.lineNumber>i));const r=y.takeFromEndWhile((e=>e.lineNumber===i));e.push(new B8(n,this.getLineContent(i),r))}if(h<c){const t=a+h;e.push(new W8(t+1,l))}if(h<u){const n=new G1(v),i=a+h,o=u-h,s=r-t-o+i+1;let l=[],c=[];for(let e=0;e<o;e++){let t=s+e;c[e]=this.getLineContent(t),n.takeWhile((e=>e.lineNumber<t)),l[e]=n.takeWhile((e=>e.lineNumber===t))}e.push(new z8(i+1,a+u,c,l))}t+=d}this._emitContentChangedEvent(new U8(e,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:o,eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return null===i.reverseEdits?void 0:i.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(null===e||0===e.size)return;const t=[...e].map((e=>new B8(e,this.getLineContent(e),this._getInjectedTextInLine(e))));this._onDidChangeContentOrInjectedText.fire(new H8(t))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){let n={addDecoration:(t,n)=>this._deltaDecorationsImpl(e,[],[{range:t,options:n}])[0],changeDecoration:(e,t)=>{this._changeDecorationImpl(e,t)},changeDecorationOptions:(e,t)=>{this._changeDecorationOptionsImpl(e,_7(t))},removeDecoration:t=>{this._deltaDecorationsImpl(e,[t],[])},deltaDecorations:(t,n)=>0===t.length&&0===n.length?[]:this._deltaDecorationsImpl(e,t,n)},i=null;try{i=t(n)}catch(zWe){nG(zWe)}return n.addDecoration=o7,n.changeDecoration=o7,n.changeDecorationOptions=o7,n.removeDecoration=o7,n.deltaDecorations=o7,i}deltaDecorations(e,t,n=0){if(this._assertNotDisposed(),e||(e=[]),0===e.length&&0===t.length)return[];try{return this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(n,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,n){const i=e?this._decorations[e]:null;if(!i)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:y7[n]}])[0]:null;if(!t)return this._decorationsTree.delete(i),delete this._decorations[i.id],null;const r=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),s=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);return this._decorationsTree.delete(i),i.reset(this.getVersionId(),o,s,r),i.setOptions(y7[n]),this._decorationsTree.insert(i),i.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let n=0,i=t.length;n<i;n++){const e=t[n];this._decorationsTree.delete(e),delete this._decorations[e.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._getDecorationRange(t):null}_getDecorationRange(e){const t=this.getVersionId();return e.cachedVersionId!==t&&this._decorationsTree.resolveNode(e,t),null===e.range&&(e.range=this._getRangeAt(e.cachedAbsoluteStart,e.cachedAbsoluteEnd)),e.range}getLineDecorations(e,t=0,n=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,n)}getLinesDecorations(e,t,n=0,i=!1){let r=this.getLineCount(),o=Math.min(r,Math.max(1,e)),s=Math.min(r,Math.max(1,t)),a=this.getLineMaxColumn(s);return this._getDecorationsInRange(new TK(o,1,s,a),n,i)}getDecorationsInRange(e,t=0,n=!1){let i=this.validateRange(e);return this._getDecorationsInRange(i,t,n)}getOverviewRulerDecorations(e=0,t=!1){const n=this.getVersionId(),i=this._decorationsTree.search(e,t,!0,n);return this._ensureNodesHaveRanges(i)}getInjectedTextDecorations(e=0){const t=this.getVersionId(),n=this._decorationsTree.getInjectedText(e,t);return this._ensureNodesHaveRanges(n)}_getInjectedTextInLine(e){const t=this.getVersionId(),n=this._buffer.getOffsetAt(e,1),i=n+this._buffer.getLineLength(e),r=this._decorationsTree.getInjectedTextInInterval(n,i,0,t);return this._ensureNodesHaveRanges(r),F8.fromDecorations(r).filter((t=>t.lineNumber===e))}getAllDecorations(e=0,t=!1){const n=this.getVersionId(),i=this._decorationsTree.search(e,t,!1,n);return this._ensureNodesHaveRanges(i)}_getDecorationsInRange(e,t,n){const i=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),r=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn),o=this.getVersionId(),s=this._decorationsTree.intervalSearch(i,r,t,n,o);return this._ensureNodesHaveRanges(s)}_ensureNodesHaveRanges(e){for(let t=0,n=e.length;t<n;t++){const n=e[t];null===n.range&&(n.range=this._getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd))}return e}_getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const n=this._decorations[e];if(!n)return;if(n.options.after){const t=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.endLineNumber)}if(n.options.before){const t=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.startLineNumber)}const i=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(i.startLineNumber,i.startColumn),o=this._buffer.getOffsetAt(i.endLineNumber,i.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),r,o,i),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(i.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(i.startLineNumber)}_changeDecorationOptionsImpl(e,t){const n=this._decorations[e];if(!n)return;const i=!(!n.options.overviewRuler||!n.options.overviewRuler.color),r=!(!t.overviewRuler||!t.overviewRuler.color);this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(t),(n.options.after||t.after)&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.range.endLineNumber),(n.options.before||t.before)&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.range.startLineNumber),i!==r?(this._decorationsTree.delete(n),n.setOptions(t),this._decorationsTree.insert(n)):n.setOptions(t)}_deltaDecorationsImpl(e,t,n){const i=this.getVersionId(),r=t.length;let o=0;const s=n.length;let a=0,l=new Array(s);for(;o<r||a<s;){let c=null;if(o<r){do{c=this._decorations[t[o++]]}while(!c&&o<r);if(c){if(c.options.after){const e=this._getDecorationRange(c);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.endLineNumber)}if(c.options.before){const e=this._getDecorationRange(c);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.startLineNumber)}this._decorationsTree.delete(c),this._onDidChangeDecorations.checkAffectedAndFire(c.options)}}if(a<s){if(!c){const e=++this._lastDecorationId,t=`${this._instanceId};${e}`;c=new M9(t,0,0),this._decorations[t]=c}const t=n[a],r=this._validateRangeRelaxedNoAllocations(t.range),o=_7(t.options),s=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),u=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);c.ownerId=e,c.reset(i,s,u,r),c.setOptions(o),c.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),c.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber),this._onDidChangeDecorations.checkAffectedAndFire(o),this._decorationsTree.insert(c),l[a]=c.id,a++}else c&&delete this._decorations[c.id]}return l}setTokens(e){if(0===e.length)return;let t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];let r=0,o=0,s=!1;for(let e=0,t=i.tokens.length;e<t;e++){const t=i.startLineNumber+e;if(s)this._tokens.setTokens(this._languageIdentifier.id,t-1,this._buffer.getLineLength(t),i.tokens[e],!1),o=t;else{this._tokens.setTokens(this._languageIdentifier.id,t-1,this._buffer.getLineLength(t),i.tokens[e],!0)&&(s=!0,r=t,o=t)}}s&&t.push({fromLineNumber:r,toLineNumber:o})}t.length>0&&this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!1,ranges:t})}setSemanticTokens(e,t){this._tokens2.set(e,t),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:null!==e,ranges:[{fromLineNumber:1,toLineNumber:this.getLineCount()}]})}hasCompleteSemanticTokens(){return this._tokens2.isComplete()}hasSomeSemanticTokens(){return!this._tokens2.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const n=this._tokens2.setPartial(e,t);this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!0,ranges:[{fromLineNumber:n.startLineNumber,toLineNumber:n.endLineNumber}]})}tokenizeViewport(e,t){e=Math.max(1,e),t=Math.min(this._buffer.getLineCount(),t),this._tokenization.tokenizeViewport(e,t)}clearTokens(){this._tokens.flush(),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!0,semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._buffer.getLineCount()}]})}_emitModelTokensChangedEvent(e){this._isDisposing||this._onDidChangeTokens.fire(e)}resetTokenization(){this._tokenization.reset()}forceTokenization(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");this._tokenization.forceTokenization(e)}isCheapToTokenize(e){return this._tokenization.isCheapToTokenize(e)}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}getLineTokens(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._getLineTokens(e)}_getLineTokens(e){const t=this.getLineContent(e),n=this._tokens.getTokens(this._languageIdentifier.id,e-1,t);return this._tokens2.addSemanticTokens(e,n)}getLanguageIdentifier(){return this._languageIdentifier}getModeId(){return this._languageIdentifier.language}setMode(e){if(this._languageIdentifier.id===e.id)return;let t={oldLanguage:this._languageIdentifier.language,newLanguage:e.language};this._languageIdentifier=e,this._onDidChangeLanguage.fire(t),this._onDidChangeLanguageConfiguration.fire({})}getLanguageIdAtPosition(e,t){const n=this.validatePosition(new IK(e,t)),i=this.getLineTokens(n.lineNumber);return i.getLanguageId(i.findTokenIndexAtOffset(n.column-1))}getWordAtPosition(e){this._assertNotDisposed();const t=this.validatePosition(e),n=this.getLineContent(t.lineNumber),i=this._getLineTokens(t.lineNumber),r=i.findTokenIndexAtOffset(t.column-1),[o,s]=l7._findLanguageBoundaries(i,r),a=Cj(t.column,q0.getWordDefinition(i.getLanguageId(r)),n.substring(o,s),o);if(a&&a.startColumn<=e.column&&e.column<=a.endColumn)return a;if(r>0&&o===t.column-1){const[o,s]=l7._findLanguageBoundaries(i,r-1),a=Cj(t.column,q0.getWordDefinition(i.getLanguageId(r-1)),n.substring(o,s),o);if(a&&a.startColumn<=e.column&&e.column<=a.endColumn)return a}return null}static _findLanguageBoundaries(e,t){const n=e.getLanguageId(t);let i=0;for(let o=t;o>=0&&e.getLanguageId(o)===n;o--)i=e.getStartOffset(o);let r=e.getLineContent().length;for(let o=t,s=e.getCount();o<s&&e.getLanguageId(o)===n;o++)r=e.getEndOffset(o);return[i,r]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}findMatchingBracketUp(e,t){let n=e.toLowerCase(),i=this.validatePosition(t),r=this._getLineTokens(i.lineNumber),o=r.getLanguageId(r.findTokenIndexAtOffset(i.column-1)),s=q0.getBracketsSupport(o);if(!s)return null;let a=s.textIsBracket[n];return a?a7(this._findMatchingBracketUp(a,i,null)):null}matchBracket(e){return this._matchBracket(this.validatePosition(e))}_establishBracketSearchOffsets(e,t,n,i){const r=t.getCount(),o=t.getLanguageId(i);let s=Math.max(0,e.column-1-n.maxBracketLength);for(let l=i-1;l>=0;l--){const e=t.getEndOffset(l);if(e<=s)break;if(v0(t.getStandardTokenType(l))||t.getLanguageId(l)!==o){s=e;break}}let a=Math.min(t.getLineContent().length,e.column-1+n.maxBracketLength);for(let l=i+1;l<r;l++){const e=t.getStartOffset(l);if(e>=a)break;if(v0(t.getStandardTokenType(l))||t.getLanguageId(l)!==o){a=e;break}}return{searchStartOffset:s,searchEndOffset:a}}_matchBracket(e){const t=e.lineNumber,n=this._getLineTokens(t),i=this._buffer.getLineContent(t),r=n.findTokenIndexAtOffset(e.column-1);if(r<0)return null;const o=q0.getBracketsSupport(n.getLanguageId(r));if(o&&!v0(n.getStandardTokenType(r))){let{searchStartOffset:s,searchEndOffset:a}=this._establishBracketSearchOffsets(e,n,o,r),l=null;for(;;){const n=B0.findNextBracketInRange(o.forwardRegex,t,i,s,a);if(!n)break;if(n.startColumn<=e.column&&e.column<=n.endColumn){const e=i.substring(n.startColumn-1,n.endColumn-1).toLowerCase(),t=this._matchFoundBracket(n,o.textIsBracket[e],o.textIsOpenBracket[e],null);if(t){if(t instanceof s7)return null;l=t}}s=n.endColumn-1}if(l)return l}if(r>0&&n.getStartOffset(r)===e.column-1){const o=r-1,s=q0.getBracketsSupport(n.getLanguageId(o));if(s&&!v0(n.getStandardTokenType(o))){let{searchStartOffset:r,searchEndOffset:a}=this._establishBracketSearchOffsets(e,n,s,o);const l=B0.findPrevBracketInRange(s.reversedRegex,t,i,r,a);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn){const e=i.substring(l.startColumn-1,l.endColumn-1).toLowerCase(),t=this._matchFoundBracket(l,s.textIsBracket[e],s.textIsOpenBracket[e],null);if(t)return t instanceof s7?null:t}}}return null}_matchFoundBracket(e,t,n,i){if(!t)return null;const r=n?this._findMatchingBracketDown(t,e.getEndPosition(),i):this._findMatchingBracketUp(t,e.getStartPosition(),i);return r?r instanceof s7?r:[e,r]:null}_findMatchingBracketUp(e,t,n){const i=e.languageIdentifier.id,r=e.reversedRegex;let o=-1,s=0;const a=(t,i,a,l)=>{for(;;){if(n&&++s%100==0&&!n())return s7.INSTANCE;const c=B0.findPrevBracketInRange(r,t,i,a,l);if(!c)break;const u=i.substring(c.startColumn-1,c.endColumn-1).toLowerCase();if(e.isOpen(u)?o++:e.isClose(u)&&o--,0===o)return c;l=c.startColumn-1}return null};for(let l=t.lineNumber;l>=1;l--){const e=this._getLineTokens(l),n=e.getCount(),r=this._buffer.getLineContent(l);let o=n-1,s=r.length,c=r.length;l===t.lineNumber&&(o=e.findTokenIndexAtOffset(t.column-1),s=t.column-1,c=t.column-1);let u=!0;for(;o>=0;o--){const t=e.getLanguageId(o)===i&&!v0(e.getStandardTokenType(o));if(t)u?s=e.getStartOffset(o):(s=e.getStartOffset(o),c=e.getEndOffset(o));else if(u&&s!==c){const e=a(l,r,s,c);if(e)return e}u=t}if(u&&s!==c){const e=a(l,r,s,c);if(e)return e}}return null}_findMatchingBracketDown(e,t,n){const i=e.languageIdentifier.id,r=e.forwardRegex;let o=1,s=0;const a=(t,i,a,l)=>{for(;;){if(n&&++s%100==0&&!n())return s7.INSTANCE;const c=B0.findNextBracketInRange(r,t,i,a,l);if(!c)break;const u=i.substring(c.startColumn-1,c.endColumn-1).toLowerCase();if(e.isOpen(u)?o++:e.isClose(u)&&o--,0===o)return c;a=c.endColumn-1}return null},l=this.getLineCount();for(let c=t.lineNumber;c<=l;c++){const e=this._getLineTokens(c),n=e.getCount(),r=this._buffer.getLineContent(c);let o=0,s=0,l=0;c===t.lineNumber&&(o=e.findTokenIndexAtOffset(t.column-1),s=t.column-1,l=t.column-1);let u=!0;for(;o<n;o++){const t=e.getLanguageId(o)===i&&!v0(e.getStandardTokenType(o));if(t)u||(s=e.getStartOffset(o)),l=e.getEndOffset(o);else if(u&&s!==l){const e=a(c,r,s,l);if(e)return e}u=t}if(u&&s!==l){const e=a(c,r,s,l);if(e)return e}}return null}findPrevBracket(e){const t=this.validatePosition(e);let n=-1,i=null;for(let r=t.lineNumber;r>=1;r--){const e=this._getLineTokens(r),o=e.getCount(),s=this._buffer.getLineContent(r);let a=o-1,l=s.length,c=s.length;if(r===t.lineNumber){a=e.findTokenIndexAtOffset(t.column-1),l=t.column-1,c=t.column-1;const r=e.getLanguageId(a);n!==r&&(n=r,i=q0.getBracketsSupport(n))}let u=!0;for(;a>=0;a--){const t=e.getLanguageId(a);if(n!==t){if(i&&u&&l!==c){const e=B0.findPrevBracketInRange(i.reversedRegex,r,s,l,c);if(e)return this._toFoundBracket(i,e);u=!1}n=t,i=q0.getBracketsSupport(n)}const o=!!i&&!v0(e.getStandardTokenType(a));if(o)u?l=e.getStartOffset(a):(l=e.getStartOffset(a),c=e.getEndOffset(a));else if(i&&u&&l!==c){const e=B0.findPrevBracketInRange(i.reversedRegex,r,s,l,c);if(e)return this._toFoundBracket(i,e)}u=o}if(i&&u&&l!==c){const e=B0.findPrevBracketInRange(i.reversedRegex,r,s,l,c);if(e)return this._toFoundBracket(i,e)}}return null}findNextBracket(e){const t=this.validatePosition(e),n=this.getLineCount();let i=-1,r=null;for(let o=t.lineNumber;o<=n;o++){const e=this._getLineTokens(o),n=e.getCount(),s=this._buffer.getLineContent(o);let a=0,l=0,c=0;if(o===t.lineNumber){a=e.findTokenIndexAtOffset(t.column-1),l=t.column-1,c=t.column-1;const n=e.getLanguageId(a);i!==n&&(i=n,r=q0.getBracketsSupport(i))}let u=!0;for(;a<n;a++){const t=e.getLanguageId(a);if(i!==t){if(r&&u&&l!==c){const e=B0.findNextBracketInRange(r.forwardRegex,o,s,l,c);if(e)return this._toFoundBracket(r,e);u=!1}i=t,r=q0.getBracketsSupport(i)}const n=!!r&&!v0(e.getStandardTokenType(a));if(n)u||(l=e.getStartOffset(a)),c=e.getEndOffset(a);else if(r&&u&&l!==c){const e=B0.findNextBracketInRange(r.forwardRegex,o,s,l,c);if(e)return this._toFoundBracket(r,e)}u=n}if(r&&u&&l!==c){const e=B0.findNextBracketInRange(r.forwardRegex,o,s,l,c);if(e)return this._toFoundBracket(r,e)}}return null}findEnclosingBrackets(e,t){let n;if(void 0===t)n=null;else{const e=Date.now();n=()=>Date.now()-e<=t}const i=this.validatePosition(e),r=this.getLineCount(),o=new Map;let s=[];const a=(e,t)=>{if(!o.has(e)){let n=[];for(let e=0,i=t?t.brackets.length:0;e<i;e++)n[e]=0;o.set(e,n)}s=o.get(e)};let l=0;const c=(e,t,i,r,o)=>{for(;;){if(n&&++l%100==0&&!n())return s7.INSTANCE;const a=B0.findNextBracketInRange(e.forwardRegex,t,i,r,o);if(!a)break;const c=i.substring(a.startColumn-1,a.endColumn-1).toLowerCase(),u=e.textIsBracket[c];if(u&&(u.isOpen(c)?s[u.index]++:u.isClose(c)&&s[u.index]--,-1===s[u.index]))return this._matchFoundBracket(a,u,!1,n);r=a.endColumn-1}return null};let u=-1,h=null;for(let d=i.lineNumber;d<=r;d++){const e=this._getLineTokens(d),t=e.getCount(),n=this._buffer.getLineContent(d);let r=0,o=0,s=0;if(d===i.lineNumber){r=e.findTokenIndexAtOffset(i.column-1),o=i.column-1,s=i.column-1;const t=e.getLanguageId(r);u!==t&&(u=t,h=q0.getBracketsSupport(u),a(u,h))}let l=!0;for(;r<t;r++){const t=e.getLanguageId(r);if(u!==t){if(h&&l&&o!==s){const e=c(h,d,n,o,s);if(e)return a7(e);l=!1}u=t,h=q0.getBracketsSupport(u),a(u,h)}const i=!!h&&!v0(e.getStandardTokenType(r));if(i)l||(o=e.getStartOffset(r)),s=e.getEndOffset(r);else if(h&&l&&o!==s){const e=c(h,d,n,o,s);if(e)return a7(e)}l=i}if(h&&l&&o!==s){const e=c(h,d,n,o,s);if(e)return a7(e)}}return null}_toFoundBracket(e,t){if(!t)return null;let n=this.getValueInRange(t);n=n.toLowerCase();let i=e.textIsBracket[n];return i?{range:t,open:i.open,close:i.close,isOpen:e.textIsOpenBracket[n]}:null}static computeIndentLevel(e,t){let n=0,i=0,r=e.length;for(;i<r;){let r=e.charCodeAt(i);if(32===r)n++;else{if(9!==r)break;n=n-n%t+t}i++}return i===r?-1:n}_computeIndentLevel(e){return l7.computeIndentLevel(this._buffer.getLineContent(e+1),this._options.tabSize)}getActiveIndentGuide(e,t,n){this._assertNotDisposed();const i=this.getLineCount();if(e<1||e>i)throw new Error("Illegal value for lineNumber");const r=q0.getFoldingRules(this._languageIdentifier.id),o=Boolean(r&&r.offSide);let s=-2,a=-1,l=-2,c=-1;const u=e=>{if(-1!==s&&(-2===s||s>e-1)){s=-1,a=-1;for(let t=e-2;t>=0;t--){let e=this._computeIndentLevel(t);if(e>=0){s=t,a=e;break}}}if(-2===l){l=-1,c=-1;for(let t=e;t<i;t++){let e=this._computeIndentLevel(t);if(e>=0){l=t,c=e;break}}}};let h=-2,d=-1,f=-2,g=-1;const p=e=>{if(-2===h){h=-1,d=-1;for(let t=e-2;t>=0;t--){let e=this._computeIndentLevel(t);if(e>=0){h=t,d=e;break}}}if(-1!==f&&(-2===f||f<e-1)){f=-1,g=-1;for(let t=e;t<i;t++){let e=this._computeIndentLevel(t);if(e>=0){f=t,g=e;break}}}};let m=0,v=!0,y=0,_=!0,b=0,w=0;for(let C=0;v||_;C++){const r=e-C,s=e+C;C>1&&(r<1||r<t)&&(v=!1),C>1&&(s>i||s>n)&&(_=!1),C>5e4&&(v=!1,_=!1);let f=-1;if(v){const e=this._computeIndentLevel(r-1);e>=0?(l=r-1,c=e,f=Math.ceil(e/this._options.indentSize)):(u(r),f=this._getIndentLevelForWhitespaceLine(o,a,c))}let S=-1;if(_){const e=this._computeIndentLevel(s-1);e>=0?(h=s-1,d=e,S=Math.ceil(e/this._options.indentSize)):(p(s),S=this._getIndentLevelForWhitespaceLine(o,d,g))}if(0!==C){if(1===C){if(s<=i&&S>=0&&w+1===S){v=!1,m=s,y=s,b=S;continue}if(r>=1&&f>=0&&f-1===w){_=!1,m=r,y=r,b=f;continue}if(m=e,y=e,b=w,0===b)return{startLineNumber:m,endLineNumber:y,indent:b}}v&&(f>=b?m=r:v=!1),_&&(S>=b?y=s:_=!1)}else w=f}return{startLineNumber:m,endLineNumber:y,indent:b}}getLinesIndentGuides(e,t){this._assertNotDisposed();const n=this.getLineCount();if(e<1||e>n)throw new Error("Illegal value for startLineNumber");if(t<1||t>n)throw new Error("Illegal value for endLineNumber");const i=q0.getFoldingRules(this._languageIdentifier.id),r=Boolean(i&&i.offSide);let o=new Array(t-e+1),s=-2,a=-1,l=-2,c=-1;for(let u=e;u<=t;u++){let t=u-e;const i=this._computeIndentLevel(u-1);if(i>=0)s=u-1,a=i,o[t]=Math.ceil(i/this._options.indentSize);else{if(-2===s){s=-1,a=-1;for(let e=u-2;e>=0;e--){let t=this._computeIndentLevel(e);if(t>=0){s=e,a=t;break}}}if(-1!==l&&(-2===l||l<u-1)){l=-1,c=-1;for(let e=u;e<n;e++){let t=this._computeIndentLevel(e);if(t>=0){l=e,c=t;break}}}o[t]=this._getIndentLevelForWhitespaceLine(r,a,c)}}return o}_getIndentLevelForWhitespaceLine(e,t,n){return-1===t||-1===n?0:t<n?1+Math.floor(t/this._options.indentSize):t===n||e?Math.ceil(n/this._options.indentSize):1+Math.floor(n/this._options.indentSize)}normalizePosition(e,t){return e}getLineIndentColumn(e){return function(e){let t=0;for(const n of e){if(" "!==n&&"\t"!==n)break;t++}return t}(this.getLineContent(e))+1}}function c7(e){return!(!e.options.overviewRuler||!e.options.overviewRuler.color)}function u7(e){return!!e.options.after||!!e.options.before}l7.MODEL_SYNC_LIMIT=52428800,l7.LARGE_FILE_SIZE_THRESHOLD=20971520,l7.LARGE_FILE_LINE_COUNT_THRESHOLD=3e5,l7.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Kj,indentSize:qj,insertSpaces:$j,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Xj,largeFileOptimizations:Zj};class h7{constructor(){this._decorationsTree0=new O9,this._decorationsTree1=new O9,this._injectedTextDecorationsTree=new O9}intervalSearch(e,t,n,i,r){const o=this._decorationsTree0.intervalSearch(e,t,n,i,r),s=this._decorationsTree1.intervalSearch(e,t,n,i,r),a=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,r);return o.concat(s).concat(a)}getInjectedTextInInterval(e,t,n,i){return this._injectedTextDecorationsTree.intervalSearch(e,t,n,!1,i)}getInjectedText(e,t){return this._injectedTextDecorationsTree.search(e,!1,t)}search(e,t,n,i){if(n)return this._decorationsTree1.search(e,t,i);{const n=this._decorationsTree0.search(e,t,i),r=this._decorationsTree1.search(e,t,i),o=this._injectedTextDecorationsTree.search(e,t,i);return n.concat(r).concat(o)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){u7(e)?this._injectedTextDecorationsTree.insert(e):c7(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){u7(e)?this._injectedTextDecorationsTree.delete(e):c7(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}resolveNode(e,t){u7(e)?this._injectedTextDecorationsTree.resolveNode(e,t):c7(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}}function d7(e){return e.replace(/[^a-z0-9\-_]/gi," ")}class f7{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class g7 extends f7{constructor(e){super(e),this._resolvedColor=null,this.position="number"==typeof e.position?e.position:wQ.Center}getColor(e){return this._resolvedColor||("light"!==e.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if("string"==typeof e)return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}}class p7 extends f7{constructor(e){super(e),this.position=e.position}getColor(e){return this._resolvedColor||("light"!==e.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return"string"==typeof e?Q8.fromHex(e):t.getColor(e.id)}}class m7{constructor(e){this.content=e||""}}class v7{constructor(e){this.description=e.description,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?d7(e.className):null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new g7(e.overviewRuler):null,this.minimap=e.minimap?new p7(e.minimap):null,this.glyphMarginClassName=e.glyphMarginClassName?d7(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?d7(e.linesDecorationsClassName):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?d7(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?d7(e.marginClassName):null,this.inlineClassName=e.inlineClassName?d7(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?d7(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?d7(e.afterContentClassName):null,this.after=e.after?new m7(e.after.content):null,this.before=e.before?new m7(e.before.content):null}static register(e){return new v7(e)}static createDynamic(e){return new v7(e)}}v7.EMPTY=v7.register({description:"empty"});const y7=[v7.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),v7.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),v7.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),v7.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function _7(e){return e instanceof v7?e:v7.createDynamic(e)}class b7 extends mG{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new EG),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e;if(this._deferredCnt--,0===this._deferredCnt){if(this._shouldFire){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler};this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._actual.fire(e)}null===(e=this._affectedInjectedTextLines)||void 0===e||e.clear(),this._affectedInjectedTextLines=null}}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||(this._affectsMinimap=!(!e.minimap||!e.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!(!e.overviewRuler||!e.overviewRuler.color)),this._shouldFire=!0}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._shouldFire=!0}}class w7 extends mG{constructor(){super(),this._fastEmitter=this._register(new EG),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new EG),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,0===this._deferredCnt&&null!==this._deferredEvent){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){this._deferredCnt>0?this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e:(this._fastEmitter.fire(e),this._slowEmitter.fire(e))}}const C7=()=>!0,S7=()=>!1,x7=e=>" "===e||"\t"===e;class E7{constructor(e,t,n){this._cursorMoveConfigurationBrand=void 0,this._languageIdentifier=e;const i=n.options,r=i.get(128);this.readOnly=i.get(78),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=i.get(102),this.lineHeight=i.get(56),this.pageSize=Math.max(1,Math.floor(r.height/this.lineHeight)-2),this.useTabStops=i.get(113),this.wordSeparators=i.get(114),this.emptySelectionClipboard=i.get(30),this.copyWithSyntaxHighlighting=i.get(19),this.multiCursorMergeOverlapping=i.get(66),this.multiCursorPaste=i.get(68),this.autoClosingBrackets=i.get(5),this.autoClosingQuotes=i.get(8),this.autoClosingDelete=i.get(6),this.autoClosingOvertype=i.get(7),this.autoSurround=i.get(11),this.autoIndent=i.get(9),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:E7._getShouldAutoClose(e,this.autoClosingQuotes),bracket:E7._getShouldAutoClose(e,this.autoClosingBrackets)},this.autoClosingPairs=q0.getAutoClosingPairs(e.id);let o=E7._getSurroundingPairs(e);if(o)for(const s of o)this.surroundingPairs[s.open]=s.close}static shouldRecreate(e){return e.hasChanged(128)||e.hasChanged(114)||e.hasChanged(30)||e.hasChanged(66)||e.hasChanged(68)||e.hasChanged(5)||e.hasChanged(8)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(113)||e.hasChanged(56)||e.hasChanged(78)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=E7._getElectricCharacters(this._languageIdentifier);if(e)for(const t of e)this._electricChars[t]=!0}return this._electricChars}normalizeIndentation(e){return l7.normalizeIndentation(e,this.indentSize,this.insertSpaces)}static _getElectricCharacters(e){try{return q0.getElectricCharacters(e.id)}catch(zWe){return nG(zWe),null}}static _getShouldAutoClose(e,t){switch(t){case"beforeWhitespace":return x7;case"languageDefined":return E7._getLanguageDefinedShouldAutoClose(e);case"always":return C7;case"never":return S7}}static _getLanguageDefinedShouldAutoClose(e){try{const t=q0.getAutoCloseBeforeSet(e.id);return e=>-1!==t.indexOf(e)}catch(zWe){return nG(zWe),S7}}static _getSurroundingPairs(e){try{return q0.getSurroundingPairs(e.id)}catch(zWe){return nG(zWe),null}}}class k7{constructor(e,t,n,i){this._singleCursorStateBrand=void 0,this.selectionStart=e,this.selectionStartLeftoverVisibleColumns=t,this.position=n,this.leftoverVisibleColumns=i,this.selection=k7._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,n,i){return e?new k7(this.selectionStart,this.selectionStartLeftoverVisibleColumns,new IK(t,n),i):new k7(new TK(t,n,t,n),i,new IK(t,n),i)}static _computeSelection(e,t){let n,i,r,o;return e.isEmpty()?(n=e.startLineNumber,i=e.startColumn,r=t.lineNumber,o=t.column):t.isBeforeOrEqual(e.getStartPosition())?(n=e.endLineNumber,i=e.endColumn,r=t.lineNumber,o=t.column):(n=e.startLineNumber,i=e.startColumn,r=t.lineNumber,o=t.column),new MK(n,i,r,o)}}class L7{constructor(e,t,n){this._cursorContextBrand=void 0,this.model=e,this.coordinatesConverter=t,this.cursorConfig=n}}class D7{constructor(e){this.modelState=e,this.viewState=null}}class N7{constructor(e){this.modelState=null,this.viewState=e}}class I7{constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}static fromModelState(e){return new D7(e)}static fromViewState(e){return new N7(e)}static fromModelSelection(e){const t=e.selectionStartLineNumber,n=e.selectionStartColumn,i=e.positionLineNumber,r=e.positionColumn,o=new k7(new TK(t,n,t,n),0,new IK(i,r),0);return I7.fromModelState(o)}static fromModelSelections(e){let t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this.fromModelSelection(e[n]);return t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class T7{constructor(e,t,n){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=n.shouldPushStackElementBefore,this.shouldPushStackElementAfter=n.shouldPushStackElementAfter}}class M7{static visibleColumnFromColumn(e,t,n){const i=e.length,r=t-1<i?t-1:i;let o=0,s=0;for(;s<r;){const t=NX(e,r,s);if(s+=t>=65536?2:1,9===t)o=M7.nextRenderTabStop(o,n);else{let n=jX(t);for(;s<r;){const t=NX(e,r,s),i=jX(t);if(GX(n,i))break;s+=t>=65536?2:1,n=i}WX(t)||zX(t)?o+=2:o+=1}}return o}static visibleColumnsByColumns(e,t){const n=e.length;let i=new Array;i.push(-1);let r=0,o=0;for(;o<n;){const s=NX(e,n,o);if(o+=s>=65536?2:1,i.push(r),s>=65536&&i.push(r),9===s)r=M7.nextRenderTabStop(r,t);else{let t=jX(s);for(;o<n;){const a=NX(e,n,o),l=jX(a);if(GX(t,l))break;o+=a>=65536?2:1,i.push(r),s>=65536&&i.push(r),t=l}WX(s)||zX(s)?r+=2:r+=1}}return i.push(r),i}static visibleColumnFromColumn2(e,t,n){return this.visibleColumnFromColumn(t.getLineContent(n.lineNumber),n.column,e.tabSize)}static columnFromVisibleColumn(e,t,n){if(t<=0)return 1;const i=e.length;let r=0,o=1,s=0;for(;s<i;){const a=NX(e,i,s);let l;if(s+=a>=65536?2:1,9===a)l=M7.nextRenderTabStop(r,n);else{let t=jX(a);for(;s<i;){const n=NX(e,i,s),r=jX(n);if(GX(t,r))break;s+=n>=65536?2:1,t=r}l=WX(a)||zX(a)?r+2:r+1}const c=s+1;if(l>=t){return l-t<t-r?c:o}r=l,o=c}return i+1}static columnFromVisibleColumn2(e,t,n,i){let r=this.columnFromVisibleColumn(t.getLineContent(n),i,e.tabSize),o=t.getLineMinColumn(n);if(r<o)return o;let s=t.getLineMaxColumn(n);return r>s?s:r}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}function A7(e){return"'"===e||'"'===e||"`"===e}class O7{static whitespaceVisibleColumn(e,t,n){const i=e.length;let r=0,o=-1,s=-1;for(let a=0;a<i;a++){if(a===t)return[o,s,r];r%n==0&&(o=a,s=r);switch(e.charCodeAt(a)){case 32:r+=1;break;case 9:r=M7.nextRenderTabStop(r,n);break;default:return[-1,-1,-1]}}return t===i?[o,s,r]:[-1,-1,-1]}static atomicPosition(e,t,n,i){const r=e.length,[o,s,a]=O7.whitespaceVisibleColumn(e,t,n);if(-1===a)return-1;let l;switch(i){case 0:l=!0;break;case 1:l=!1;break;case 2:if(a%n==0)return t;l=a%n<=n/2}if(l){if(-1===o)return-1;let t=s;for(let i=o;i<r;++i){if(t===s+n)return o;switch(e.charCodeAt(i)){case 32:t+=1;break;case 9:t=M7.nextRenderTabStop(t,n);break;default:return-1}}return t===s+n?o:-1}const c=M7.nextRenderTabStop(a,n);let u=a;for(let h=t;h<r;h++){if(u===c)return h;switch(e.charCodeAt(h)){case 32:u+=1;break;case 9:u=M7.nextRenderTabStop(u,n);break;default:return-1}}return u===c?r:-1}}class R7{constructor(e=null){this.hitTarget=e,this.type=0}}class P7{constructor(e,t){this.position=e,this.spanNode=t,this.type=1}}var F7;(F7||(F7={})).createFromDOMInfo=function(e,t,n){const i=e.getPositionFromDOMInfo(t,n);return i?new P7(i,t):new R7(t)};class B7{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class W7{constructor(e,t,n=0,i=null,r=null,o=null){this.element=e,this.type=t,this.mouseColumn=n,this.position=i,!r&&i&&(r=new TK(i.lineNumber,i.column,i.lineNumber,i.column)),this.range=r,this.detail=o}static _typeToString(e){return 1===e?"TEXTAREA":2===e?"GUTTER_GLYPH_MARGIN":3===e?"GUTTER_LINE_NUMBERS":4===e?"GUTTER_LINE_DECORATIONS":5===e?"GUTTER_VIEW_ZONE":6===e?"CONTENT_TEXT":7===e?"CONTENT_EMPTY":8===e?"CONTENT_VIEW_ZONE":9===e?"CONTENT_WIDGET":10===e?"OVERVIEW_RULER":11===e?"SCROLLBAR":12===e?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+e.detail}toString(){return W7.toString(this)}}class z7{static isTextArea(e){return 2===e.length&&3===e[0]&&6===e[1]}static isChildOfViewLines(e){return e.length>=4&&3===e[0]&&7===e[3]}static isStrictChildOfViewLines(e){return e.length>4&&3===e[0]&&7===e[3]}static isChildOfScrollableElement(e){return e.length>=2&&3===e[0]&&5===e[1]}static isChildOfMinimap(e){return e.length>=2&&3===e[0]&&8===e[1]}static isChildOfContentWidgets(e){return e.length>=4&&3===e[0]&&1===e[3]}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&2===e[0]}static isChildOfOverlayWidgets(e){return e.length>=2&&3===e[0]&&4===e[1]}}class V7{constructor(e,t,n){this.model=e.model;const i=e.configuration.options;this.layoutInfo=i.get(128),this.viewDomNode=t.viewDomNode,this.lineHeight=i.get(56),this.stickyTabStops=i.get(102),this.typicalHalfwidthCharacterWidth=i.get(40).typicalHalfwidthCharacterWidth,this.lastRenderData=n,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return V7.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const n=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(n){const i=n.verticalOffset+n.height/2,r=e.model.getLineCount();let o,s=null,a=null;return n.afterLineNumber!==r&&(a=new IK(n.afterLineNumber+1,1)),n.afterLineNumber>0&&(s=new IK(n.afterLineNumber,e.model.getLineMaxColumn(n.afterLineNumber))),o=null===a?s:null===s?a:t<i?s:a,{viewZoneId:n.id,afterLineNumber:n.afterLineNumber,positionBefore:s,positionAfter:a,position:o}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const e=this._context.model.getLineCount(),t=this._context.model.getLineMaxColumn(e);return{range:new TK(e,t,e,t),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.model.getLineMaxColumn(t);return{range:new TK(t,1,t,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return V7._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,n){for(;e&&e!==document.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===n)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class U7 extends class{constructor(e,t,n){this.editorPos=t,this.pos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+n.y-t.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+n.x-t.x-e.layoutInfo.contentLeft,this.isInMarginArea=n.x-t.x<e.layoutInfo.contentLeft&&n.x-t.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,G7._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}{constructor(e,t,n,i){super(e,t,n),this._ctx=e,i?(this.target=i,this.targetPath=q6.collect(i,e.viewDomNode)):(this.target=null,this.targetPath=new Uint8Array(0))}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}\n\ttarget: ${this.target?this.target.outerHTML:null}`}fulfill(e,t=null,n=null,i=null){let r=this.mouseColumn;return t&&t.column<this._ctx.model.getLineMaxColumn(t.lineNumber)&&(r=M7.visibleColumnFromColumn(this._ctx.model.getLineContent(t.lineNumber),t.column,this._ctx.model.getTextModelOptions().tabSize)+1),new W7(this.target,e,r,t,n,i)}withTarget(e){return new U7(this._ctx,this.editorPos,this.pos,e)}}const H7={isAfterLines:!0};function j7(e){return{isAfterLines:!1,horizontalDistanceToText:e}}class G7{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,n=q6.collect(t,this._viewHelper.viewDomNode);return!(!z7.isChildOfContentWidgets(n)&&!z7.isChildOfOverflowingContentWidgets(n))||!!z7.isChildOfOverlayWidgets(n)}createMouseTarget(e,t,n,i){const r=new V7(this._context,this._viewHelper,e),o=new U7(r,t,n,i);try{return G7._createMouseTarget(r,o,!1)}catch(s){return o.fulfill(0)}}static _createMouseTarget(e,t,n){if(null===t.target){if(n)return t.fulfill(0);const i=G7._doHitTest(e,t);return 1===i.type?G7.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position):this._createMouseTarget(e,t.withTarget(i.hitTarget),!0)}const i=t;let r=null;return r=r||G7._hitTestContentWidget(e,i),r=r||G7._hitTestOverlayWidget(e,i),r=r||G7._hitTestMinimap(e,i),r=r||G7._hitTestScrollbarSlider(e,i),r=r||G7._hitTestViewZone(e,i),r=r||G7._hitTestMargin(e,i),r=r||G7._hitTestViewCursor(e,i),r=r||G7._hitTestTextArea(e,i),r=r||G7._hitTestViewLines(e,i,n),r=r||G7._hitTestScrollbar(e,i),r||t.fulfill(0)}static _hitTestContentWidget(e,t){if(z7.isChildOfContentWidgets(t.targetPath)||z7.isChildOfOverflowingContentWidgets(t.targetPath)){const n=e.findAttribute(t.target,"widgetId");return n?t.fulfill(9,null,null,n):t.fulfill(0)}return null}static _hitTestOverlayWidget(e,t){if(z7.isChildOfOverlayWidgets(t.targetPath)){const n=e.findAttribute(t.target,"widgetId");return n?t.fulfill(12,null,null,n):t.fulfill(0)}return null}static _hitTestViewCursor(e,t){if(t.target){const n=e.lastRenderData.lastViewCursorsRenderData;for(const e of n)if(t.target===e.domNode)return t.fulfill(6,e.position,null,{mightBeForeignElement:!1})}if(t.isInContentArea){const n=e.lastRenderData.lastViewCursorsRenderData,i=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(const o of n){if(i<o.contentLeft)continue;if(i>o.contentLeft+o.width)continue;const n=e.getVerticalOffsetForLineNumber(o.position.lineNumber);if(n<=r&&r<=n+o.height)return t.fulfill(6,o.position,null,{mightBeForeignElement:!1})}}return null}static _hitTestViewZone(e,t){const n=e.getZoneAtCoord(t.mouseVerticalOffset);if(n){const e=t.isInContentArea?8:5;return t.fulfill(e,n.position,null,n)}return null}static _hitTestTextArea(e,t){return z7.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfill(6,e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1}):t.fulfill(1,e.lastRenderData.lastTextareaPosition):null}static _hitTestMargin(e,t){if(t.isInMarginArea){const n=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),i=n.range.getStartPosition();let r=Math.abs(t.pos.x-t.editorPos.x);const o={isAfterLines:n.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};return r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth?t.fulfill(2,i,n.range,o):(r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfill(3,i,n.range,o):(r-=e.layoutInfo.lineNumbersWidth,t.fulfill(4,i,n.range,o)))}return null}static _hitTestViewLines(e,t,n){if(!z7.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfill(7,new IK(1,1),null,H7);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return t.fulfill(7,new IK(n,i),null,H7)}if(n){if(z7.isStrictChildOfViewLines(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(0===e.model.getLineLength(n)){const i=e.getLineWidth(n),r=j7(t.mouseContentHorizontalOffset-i);return t.fulfill(7,new IK(n,1),null,r)}const i=e.getLineWidth(n);if(t.mouseContentHorizontalOffset>=i){const r=j7(t.mouseContentHorizontalOffset-i),o=new IK(n,e.model.getLineMaxColumn(n));return t.fulfill(7,o,null,r)}}return t.fulfill(0)}const i=G7._doHitTest(e,t);return 1===i.type?G7.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position):this._createMouseTarget(e,t.withTarget(i.hitTarget),!0)}static _hitTestMinimap(e,t){if(z7.isChildOfMinimap(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.model.getLineMaxColumn(n);return t.fulfill(11,new IK(n,i))}return null}static _hitTestScrollbarSlider(e,t){if(z7.isChildOfScrollableElement(t.targetPath)&&t.target&&1===t.target.nodeType){const n=t.target.className;if(n&&/\b(slider|scrollbar)\b/.test(n)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.model.getLineMaxColumn(n);return t.fulfill(11,new IK(n,i))}}return null}static _hitTestScrollbar(e,t){if(z7.isChildOfScrollableElement(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.model.getLineMaxColumn(n);return t.fulfill(11,new IK(n,i))}return null}getMouseColumn(e,t){const n=this._context.configuration.options,i=n.get(128),r=this._context.viewLayout.getCurrentScrollLeft()+t.x-e.x-i.contentLeft;return G7._getMouseColumn(r,n.get(40).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){if(e<0)return 1;return Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,n,i){const r=i.lineNumber,o=i.column,s=e.getLineWidth(r);if(t.mouseContentHorizontalOffset>s){const e=j7(t.mouseContentHorizontalOffset-s);return t.fulfill(7,i,null,e)}const a=e.visibleRangeForPosition(r,o);if(!a)return t.fulfill(0,i);const l=a.left;if(t.mouseContentHorizontalOffset===l)return t.fulfill(6,i,null,{mightBeForeignElement:!1});const c=[];if(c.push({offset:a.left,column:o}),o>1){const t=e.visibleRangeForPosition(r,o-1);t&&c.push({offset:t.left,column:o-1})}if(o<e.model.getLineMaxColumn(r)){const t=e.visibleRangeForPosition(r,o+1);t&&c.push({offset:t.left,column:o+1})}c.sort(((e,t)=>e.offset-t.offset));const u=t.pos.toClientCoordinates(),h=n.getBoundingClientRect(),d=h.left<=u.clientX&&u.clientX<=h.right;for(let f=1;f<c.length;f++){const e=c[f-1],n=c[f];if(e.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=n.offset){const o=new TK(r,e.column,r,n.column);return t.fulfill(6,i,o,{mightBeForeignElement:!d})}}return t.fulfill(6,i,null,{mightBeForeignElement:!d})}static _doHitTestWithCaretRangeFromPoint(e,t){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),i=e.getVerticalOffsetForLineNumber(n)+Math.floor(e.lineHeight/2);let r=t.pos.y+(i-t.mouseVerticalOffset);r<=t.editorPos.y&&(r=t.editorPos.y+1),r>=t.editorPos.y+e.layoutInfo.height&&(r=t.editorPos.y+e.layoutInfo.height-1);const o=new F6(t.pos.x,r),s=this._actualDoHitTestWithCaretRangeFromPoint(e,o.toClientCoordinates());return 1===s.type?s:this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates())}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const n=LY(e.viewDomNode);let i;if(i=n?void 0===n.caretRangeFromPoint?function(e,t,n){const i=document.createRange();let r=e.elementFromPoint(t,n);if(null!==r){for(;r&&r.firstChild&&r.firstChild.nodeType!==r.firstChild.TEXT_NODE&&r.lastChild&&r.lastChild.firstChild;)r=r.lastChild;const e=r.getBoundingClientRect(),n=window.getComputedStyle(r,null).getPropertyValue("font"),o=r.innerText;let s,a=e.left,l=0;if(t>e.left+e.width)l=o.length;else{const e=K7.getInstance();for(let i=0;i<o.length+1;i++){if(s=e.getCharWidth(o.charAt(i),n)/2,a+=s,t<a){l=i;break}a+=s}}i.setStart(r.firstChild,l),i.setEnd(r.firstChild,l)}return i}(n,t.clientX,t.clientY):n.caretRangeFromPoint(t.clientX,t.clientY):document.caretRangeFromPoint(t.clientX,t.clientY),!i||!i.startContainer)return new R7;const r=i.startContainer;if(r.nodeType===r.TEXT_NODE){const t=r.parentNode,n=t?t.parentNode:null,o=n?n.parentNode:null;return(o&&o.nodeType===o.ELEMENT_NODE?o.className:null)===o9.CLASS_NAME?F7.createFromDOMInfo(e,t,i.startOffset):new R7(r.parentNode)}if(r.nodeType===r.ELEMENT_NODE){const t=r.parentNode,n=t?t.parentNode:null;return(n&&n.nodeType===n.ELEMENT_NODE?n.className:null)===o9.CLASS_NAME?F7.createFromDOMInfo(e,r,r.textContent.length):new R7(r)}return new R7}static _doHitTestWithCaretPositionFromPoint(e,t){const n=document.caretPositionFromPoint(t.clientX,t.clientY);if(n.offsetNode.nodeType===n.offsetNode.TEXT_NODE){const t=n.offsetNode.parentNode,i=t?t.parentNode:null,r=i?i.parentNode:null;return(r&&r.nodeType===r.ELEMENT_NODE?r.className:null)===o9.CLASS_NAME?F7.createFromDOMInfo(e,n.offsetNode.parentNode,n.offset):new R7(n.offsetNode.parentNode)}if(n.offsetNode.nodeType===n.offsetNode.ELEMENT_NODE){const t=n.offsetNode.parentNode,i=t&&t.nodeType===t.ELEMENT_NODE?t.className:null,r=t?t.parentNode:null,o=r&&r.nodeType===r.ELEMENT_NODE?r.className:null;if(i===o9.CLASS_NAME){const t=n.offsetNode.childNodes[Math.min(n.offset,n.offsetNode.childNodes.length-1)];if(t)return F7.createFromDOMInfo(e,t,0)}else if(o===o9.CLASS_NAME)return F7.createFromDOMInfo(e,n.offsetNode,0)}return new R7(n.offsetNode)}static _snapToSoftTabBoundary(e,t){const n=t.getLineContent(e.lineNumber),{tabSize:i}=t.getTextModelOptions(),r=O7.atomicPosition(n,e.column-1,i,2);return-1!==r?new IK(e.lineNumber,r+1):e}static _doHitTest(e,t){let n=new R7;return"function"==typeof document.caretRangeFromPoint?n=this._doHitTestWithCaretRangeFromPoint(e,t):document.caretPositionFromPoint&&(n=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates())),1===n.type&&e.stickyTabStops&&(n=new P7(this._snapToSoftTabBoundary(n.position,e.model),n.spanNode)),n}}class K7{constructor(){this._cache={},this._canvas=document.createElement("canvas")}static getInstance(){return K7._INSTANCE||(K7._INSTANCE=new K7),K7._INSTANCE}getCharWidth(e,t){const n=e+t;if(this._cache[n])return this._cache[n];const i=this._canvas.getContext("2d");i.font=t;const r=i.measureText(e).width;return this._cache[n]=r,r}}function q7(e){return function(t,n){let i=!1;return e&&(i=e.mouseTargetIsWidget(n)),i||n.preventDefault(),n}}K7._INSTANCE=null;class $7 extends G6{constructor(e,t,n){super(),this._context=e,this.viewController=t,this.viewHelper=n,this.mouseTargetFactory=new G7(this._context,n),this._mouseDownOperation=this._register(new Y7(this._context,this.viewController,this.viewHelper,((e,t)=>this._createMouseTarget(e,t)),(e=>this._getMouseColumn(e)))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(128).height;const i=new U6(this.viewHelper.viewDomNode);this._register(i.onContextMenu(this.viewHelper.viewDomNode,(e=>this._onContextMenu(e,!0)))),this._register(i.onMouseMoveThrottled(this.viewHelper.viewDomNode,(e=>this._onMouseMove(e)),q7(this.mouseTargetFactory),$7.MOUSE_MOVE_MINIMUM_TIME)),this._register(i.onMouseUp(this.viewHelper.viewDomNode,(e=>this._onMouseUp(e)))),this._register(i.onMouseLeave(this.viewHelper.viewDomNode,(e=>this._onMouseLeave(e)))),this._register(i.onMouseDown(this.viewHelper.viewDomNode,(e=>this._onMouseDown(e))));this._register(Q$(this.viewHelper.viewDomNode,RY.MOUSE_WHEEL,(e=>{if(this.viewController.emitMouseWheel(e),!this._context.configuration.options.get(65))return;const t=new D$(e);if(lj?(e.metaKey||e.ctrlKey)&&!e.shiftKey&&!e.altKey:e.ctrlKey&&!e.metaKey&&!e.shiftKey&&!e.altKey){const e=mQ.getZoomLevel(),n=t.deltaY>0?1:-1;mQ.setZoomLevel(e+n),t.preventDefault(),t.stopPropagation()}}),{capture:!0,passive:!1})),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(128)){const e=this._context.configuration.options.get(128).height;this._height!==e&&(this._height=e,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}onScrollChanged(e){return this._mouseDownOperation.onScrollChanged(),!1}getTargetAtClientPoint(e,t){const n=new B6(e,t).toPageCoordinates(),i=z6(this.viewHelper.viewDomNode);return n.y<i.y||n.y>i.y+i.height||n.x<i.x||n.x>i.x+i.width?null:this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),i,n,null)}_createMouseTarget(e,t){return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,t?e.target:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.editorPos,e.pos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){if(this._mouseDownOperation.isActive())return;e.timestamp<this.lastMouseLeaveTime||this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this.lastMouseLeaveTime=(new Date).getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e){const t=this._createMouseTarget(e,!0),n=6===t.type||7===t.type,i=2===t.type||3===t.type||4===t.type,r=3===t.type,o=this._context.configuration.options.get(96),s=8===t.type||5===t.type,a=9===t.type;let l=e.leftButton||e.middleButton;lj&&e.leftButton&&e.ctrlKey&&(l=!1);const c=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(l&&(n||r&&o))c(),this._mouseDownOperation.start(t.type,e);else if(i)e.preventDefault();else if(s){const n=t.detail;this.viewHelper.shouldSuppressMouseDownOnViewZone(n.viewZoneId)&&(c(),this._mouseDownOperation.start(t.type,e),e.preventDefault())}else a&&this.viewHelper.shouldSuppressMouseDownOnWidget(t.detail)&&(c(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:t})}}$7.MOUSE_MOVE_MINIMUM_TIME=100;class Y7 extends mG{constructor(e,t,n,i,r){super(),this._context=e,this._viewController=t,this._viewHelper=n,this._createMouseTarget=i,this._getMouseColumn=r,this._mouseMoveMonitor=this._register(new j6(this._viewHelper.viewDomNode)),this._onScrollTimeout=this._register(new B$),this._mouseState=new X7,this._currentSelection=new MK(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!0);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):this._dispatchMouse(t,!0))}start(e,t){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(3===e),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const n=this._findMousePosition(t,!0);if(!n||!n.position)return;this._mouseState.trySetCount(t.detail,n.position),t.detail=this._mouseState.count;const i=this._context.configuration.options;if(!i.get(78)&&i.get(29)&&!i.get(16)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&6===n.type&&n.position&&this._currentSelection.containsPosition(n.position))return this._mouseState.isDragAndDrop=!0,this._isActive=!0,void this._mouseMoveMonitor.startMonitoring(t.target,t.buttons,q7(null),(e=>this._onMouseDownThenMove(e)),(e=>{const t=this._findMousePosition(this._lastMouseEvent,!0);e&&e instanceof KeyboardEvent?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:t?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()}));this._mouseState.isDragAndDrop=!1,this._dispatchMouse(n,t.shiftKey),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(t.target,t.buttons,q7(null),(e=>this._onMouseDownThenMove(e)),(()=>this._stop())))}_stop(){this._isActive=!1,this._onScrollTimeout.cancel()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onScrollChanged(){this._isActive&&this._onScrollTimeout.setIfNotSet((()=>{if(!this._lastMouseEvent)return;const e=this._findMousePosition(this._lastMouseEvent,!1);e&&(this._mouseState.isDragAndDrop||this._dispatchMouse(e,!0))}),10)}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,n=this._context.model,i=this._context.viewLayout,r=this._getMouseColumn(e);if(e.posy<t.y){const n=Math.max(i.getCurrentScrollTop()-(t.y-e.posy),0),o=V7.getZoneAtCoord(this._context,n);if(o){const e=this._helpPositionJumpOverViewZone(o);if(e)return new W7(null,13,r,e)}const s=i.getLineNumberAtVerticalOffset(n);return new W7(null,13,r,new IK(s,1))}if(e.posy>t.y+t.height){const o=i.getCurrentScrollTop()+(e.posy-t.y),s=V7.getZoneAtCoord(this._context,o);if(s){const e=this._helpPositionJumpOverViewZone(s);if(e)return new W7(null,13,r,e)}const a=i.getLineNumberAtVerticalOffset(o);return new W7(null,13,r,new IK(a,n.getLineMaxColumn(a)))}const o=i.getLineNumberAtVerticalOffset(i.getCurrentScrollTop()+(e.posy-t.y));return e.posx<t.x?new W7(null,13,r,new IK(o,1)):e.posx>t.x+t.width?new W7(null,13,r,new IK(o,n.getLineMaxColumn(o))):null}_findMousePosition(e,t){const n=this._getPositionOutsideEditor(e);if(n)return n;const i=this._createMouseTarget(e,t);if(!i.position)return null;if(8===i.type||5===i.type){const e=this._helpPositionJumpOverViewZone(i.detail);if(e)return new W7(i.element,i.type,i.mouseColumn,e,null,i.detail)}return i}_helpPositionJumpOverViewZone(e){const t=new IK(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),n=e.positionBefore,i=e.positionAfter;return n&&i?n.isBefore(t)?n:i:null}_dispatchMouse(e,t){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton})}}class X7{constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const n=(new Date).getTime();n-this._lastSetMouseDownCountTime>X7.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=n,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}}var Z7,Q7;X7.CLEAR_MOUSE_DOWN_COUNT_TIME=400,(Q7=Z7||(Z7={})).text="text/plain",Q7.binary="application/octet-stream",Q7.unknown="application/unknown",Q7.markdown="text/markdown";let J7=[],eee=[],tee=[];function nee(e,t=!1){const n=function(e){return{id:e.id,mime:e.mime,filename:e.filename,extension:e.extension,filepattern:e.filepattern,firstline:e.firstline,userConfigured:e.userConfigured,filenameLowercase:e.filename?e.filename.toLowerCase():void 0,extensionLowercase:e.extension?e.extension.toLowerCase():void 0,filepatternLowercase:e.filepattern?e.filepattern.toLowerCase():void 0,filepatternOnPath:!!e.filepattern&&e.filepattern.indexOf(oK.sep)>=0}}(e);J7.push(n),n.userConfigured?tee.push(n):eee.push(n),t&&!n.userConfigured&&J7.forEach((e=>{e.mime===n.mime||e.userConfigured||(n.extension&&e.extension===n.extension&&console.warn(`Overwriting extension <<${n.extension}>> to now point to mime <<${n.mime}>>`),n.filename&&e.filename===n.filename&&console.warn(`Overwriting filename <<${n.filename}>> to now point to mime <<${n.mime}>>`),n.filepattern&&e.filepattern===n.filepattern&&console.warn(`Overwriting filepattern <<${n.filepattern}>> to now point to mime <<${n.mime}>>`),n.firstline&&e.firstline===n.firstline&&console.warn(`Overwriting firstline <<${n.firstline}>> to now point to mime <<${n.mime}>>`))}))}function iee(e,t){let n;if(e)switch(e.scheme){case j$.file:n=e.fsPath;break;case j$.data:n=IZ.parseMetaData(e).get(IZ.META_DATA_LABEL);break;default:n=e.path}if(!n)return[Z7.unknown];n=n.toLowerCase();const i=uK(n),r=ree(n,i,tee);if(r)return[r,Z7.text];const o=ree(n,i,eee);if(o)return[o,Z7.text];if(t){const e=function(e){UX(e)&&(e=e.substr(1));if(e.length>0)for(let t=J7.length-1;t>=0;t--){const n=J7[t];if(!n.firstline)continue;const i=e.match(n.firstline);if(i&&i.length>0)return n.mime}return null}(t);if(e)return[e,Z7.text]}return[Z7.unknown]}function ree(e,t,n){let i=null,r=null,o=null;for(let s=n.length-1;s>=0;s--){const a=n[s];if(t===a.filenameLowercase){i=a;break}if(a.filepattern&&(!r||a.filepattern.length>r.filepattern.length)){const n=a.filepatternOnPath?e:t;eJ(a.filepatternLowercase,n)&&(r=a)}a.extension&&(!o||a.extension.length>o.extension.length)&&t.endsWith(a.extensionLowercase)&&(o=a)}return i?i.mime:r?r.mime:o?o.mime:null}class oee{constructor(e,t,n,i,r){this.value=e,this.selectionStart=t,this.selectionEnd=n,this.selectionStartPosition=i,this.selectionEndPosition=r}toString(){return"[ <"+this.value+">, selectionStart: "+this.selectionStart+", selectionEnd: "+this.selectionEnd+"]"}static readFromTextArea(e){return new oee(e.getValue(),e.getSelectionStart(),e.getSelectionEnd(),null,null)}collapseSelection(){return new oee(this.value,this.value.length,this.value.length,null,null)}writeToTextArea(e,t,n){t.setValue(e,this.value),n&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){const t=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selectionStartPosition,t,-1)}if(e>=this.selectionEnd){const t=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selectionEndPosition,t,1)}const t=this.value.substring(this.selectionStart,e);if(-1===t.indexOf(String.fromCharCode(8230)))return this._finishDeduceEditorPosition(this.selectionStartPosition,t,1);const n=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selectionEndPosition,n,-1)}_finishDeduceEditorPosition(e,t,n){let i=0,r=-1;for(;-1!==(r=t.indexOf("\n",r+1));)i++;return[e,n*t.length,i]}static selectedText(e){return new oee(e,0,e.length,null,null)}static deduceInput(e,t,n){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};let i=e.value,r=e.selectionStart,o=e.selectionEnd,s=t.value,a=t.selectionStart,l=t.selectionEnd;const c=EX(i.substring(o),s.substring(l));s=s.substring(0,s.length-c),i=i.substring(0,i.length-c);const u=i.substring(0,r),h=xX(u,s.substring(0,a));if(s=s.substring(h),i=i.substring(h),a-=h,r-=h,l-=h,o-=h,n&&a===l&&i.length>0){let e=null;if(a===s.length?s.startsWith(i)&&(e=s.substring(i.length)):s.endsWith(i)&&(e=s.substring(0,s.length-i.length)),null!==e&&e.length>0&&(/\uFE0F/.test(e)||(d=e,OX.test(d))))return{text:e,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}}var d;if(a===l){if(i===s&&0===r&&o===i.length&&a===s.length&&-1===s.indexOf("\n")&&function(e){for(let t=0,n=e.length;t<n;t++)if(WX(e.charCodeAt(t)))return!0;return!1}(s))return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};return{text:s,replacePrevCharCnt:u.length-h,replaceNextCharCnt:0,positionDelta:0}}return{text:s,replacePrevCharCnt:o-r,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const n=Math.min(xX(e.value,t.value),e.selectionEnd),i=Math.min(EX(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(n,e.value.length-i),o=t.value.substring(n,t.value.length-i);e.selectionStart;const s=e.selectionEnd-n;t.selectionStart;const a=t.selectionEnd-n;return{text:o,replacePrevCharCnt:s,replaceNextCharCnt:r.length-s,positionDelta:a-o.length}}}oee.EMPTY=new oee("",0,0,null,null);class see{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const n=e*t;return new TK(n+1,1,n+t+1,1)}static fromEditorSelection(e,t,n,i,r){const o=see._getPageOfLine(n.startLineNumber,i),s=see._getRangeForPage(o,i),a=see._getPageOfLine(n.endLineNumber,i),l=see._getRangeForPage(a,i),c=s.intersectRanges(new TK(1,1,n.startLineNumber,n.startColumn));let u=t.getValueInRange(c,1);const h=t.getLineCount(),d=t.getLineMaxColumn(h),f=l.intersectRanges(new TK(n.endLineNumber,n.endColumn,h,d));let g,p=t.getValueInRange(f,1);if(o===a||o+1===a)g=t.getValueInRange(n,1);else{const e=s.intersectRanges(n),i=l.intersectRanges(n);g=t.getValueInRange(e,1)+String.fromCharCode(8230)+t.getValueInRange(i,1)}if(r){const e=500;u.length>e&&(u=u.substring(u.length-e,u.length)),p.length>e&&(p=p.substring(0,e)),g.length>2*e&&(g=g.substring(0,e)+String.fromCharCode(8230)+g.substring(g.length-e,g.length))}return new oee(u+g+p,u.length,u.length+g.length,new IK(n.startLineNumber,n.startColumn),new IK(n.endLineNumber,n.endColumn))}}var aee;(aee||(aee={})).Tap="-monaco-textarea-synthetic-tap";const lee={forceCopyWithSyntaxHighlighting:!1};class cee{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}}cee.INSTANCE=new cee;class uee extends mG{constructor(e,t){super(),this.textArea=t,this._onFocus=this._register(new EG),this.onFocus=this._onFocus.event,this._onBlur=this._register(new EG),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new EG),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new EG),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new EG),this.onCut=this._onCut.event,this._onPaste=this._register(new EG),this.onPaste=this._onPaste.event,this._onType=this._register(new EG),this.onType=this._onType.event,this._onCompositionStart=this._register(new EG),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new EG),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new EG),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new EG),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._host=e,this._textArea=this._register(new dee(t)),this._asyncTriggerCut=this._register(new z$((()=>this._onCut.fire()),0)),this._asyncFocusGainWriteScreenReaderContent=this._register(new z$((()=>this.writeScreenReaderContent("asyncFocusGain")),0)),this._textAreaState=oee.EMPTY,this._selectionChangeListener=null,this.writeScreenReaderContent("ctor"),this._hasFocus=!1,this._isDoingComposition=!1,this._nextCommand=0;let n=null;this._register(eY(t.domNode,"keydown",(e=>{(109===e.keyCode||this._isDoingComposition&&1===e.keyCode)&&e.stopPropagation(),e.equals(9)&&e.preventDefault(),n=e,this._onKeyDown.fire(e)}))),this._register(eY(t.domNode,"keyup",(e=>{this._onKeyUp.fire(e)}))),this._register(Q$(t.domNode,"compositionstart",(e=>{if(!this._isDoingComposition){if(this._isDoingComposition=!0,lj&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===e.data){if(n&&n.equals(109)&&("ArrowRight"===n.code||"ArrowLeft"===n.code)||h$)return this._textAreaState=new oee(this._textAreaState.value,this._textAreaState.selectionStart-1,this._textAreaState.selectionEnd,this._textAreaState.selectionStartPosition?new IK(this._textAreaState.selectionStartPosition.lineNumber,this._textAreaState.selectionStartPosition.column-1):null,this._textAreaState.selectionEndPosition),void this._onCompositionStart.fire({revealDeltaColumns:-1})}m$?this._onCompositionStart.fire({revealDeltaColumns:-this._textAreaState.selectionStart}):(this._setAndWriteTextAreaState("compositionstart",oee.EMPTY),this._onCompositionStart.fire({revealDeltaColumns:0}))}})));const i=e=>{const t=this._textAreaState,n=oee.readFromTextArea(this._textArea);return[n,oee.deduceInput(t,n,e)]},r=()=>{const e=this._textAreaState,t=oee.readFromTextArea(this._textArea);return[t,oee.deduceAndroidCompositionInput(e,t)]},o=e=>{const t=this._textAreaState,n=oee.selectedText(e);return[n,{text:n.value,replacePrevCharCnt:t.selectionEnd-t.selectionStart,replaceNextCharCnt:0,positionDelta:0}]};this._register(Q$(t.domNode,"compositionupdate",(e=>{if(m$){const[t,n]=r();return this._textAreaState=t,this._onType.fire(n),void this._onCompositionUpdate.fire(e)}const[t,n]=o(e.data||"");this._textAreaState=t,this._onType.fire(n),this._onCompositionUpdate.fire(e)}))),this._register(Q$(t.domNode,"compositionend",(e=>{if(!this._isDoingComposition)return;if(this._isDoingComposition=!1,m$){const[e,t]=r();return this._textAreaState=e,this._onType.fire(t),void this._onCompositionEnd.fire()}const[t,n]=o(e.data||"");this._textAreaState=t,this._onType.fire(n),(f$||h$)&&(this._textAreaState=oee.readFromTextArea(this._textArea)),this._onCompositionEnd.fire()}))),this._register(Q$(t.domNode,"input",(()=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._isDoingComposition)return;const[e,t]=i(lj);0===t.replacePrevCharCnt&&1===t.text.length&&kX(t.text.charCodeAt(0))||(this._textAreaState=e,0===this._nextCommand?""===t.text&&0===t.replacePrevCharCnt||this._onType.fire(t):(""===t.text&&0===t.replacePrevCharCnt||this._firePaste(t.text,null),this._nextCommand=0))}))),this._register(Q$(t.domNode,"cut",(e=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(e),this._asyncTriggerCut.schedule()}))),this._register(Q$(t.domNode,"copy",(e=>{this._ensureClipboardGetsEditorSelection(e)}))),this._register(Q$(t.domNode,"paste",(e=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),hee.canUseTextData(e)){const[t,n]=hee.getTextData(e);""!==t&&this._firePaste(t,n)}else this._textArea.getSelectionStart()!==this._textArea.getSelectionEnd()&&this._setAndWriteTextAreaState("paste",oee.EMPTY),this._nextCommand=1}))),this._register(Q$(t.domNode,"focus",(()=>{const e=this._hasFocus;this._setHasFocus(!0),g$&&!e&&this._hasFocus&&this._asyncFocusGainWriteScreenReaderContent.schedule()}))),this._register(Q$(t.domNode,"blur",(()=>{this._isDoingComposition&&(this._isDoingComposition=!1,this.writeScreenReaderContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)}))),this._register(Q$(t.domNode,aee.Tap,(()=>{m$&&this._isDoingComposition&&(this._isDoingComposition=!1,this.writeScreenReaderContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())})))}_installSelectionChangeListener(){let e=0;return Q$(document,"selectionchange",(t=>{if(!this._hasFocus)return;if(this._isDoingComposition)return;if(!f$)return;const n=Date.now(),i=n-e;if(e=n,i<5)return;const r=n-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),r<100)return;if(!this._textAreaState.selectionStartPosition||!this._textAreaState.selectionEndPosition)return;const o=this._textArea.getValue();if(this._textAreaState.value!==o)return;const s=this._textArea.getSelectionStart(),a=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===s&&this._textAreaState.selectionEnd===a)return;const l=this._textAreaState.deduceEditorPosition(s),c=this._host.deduceModelPosition(l[0],l[1],l[2]),u=this._textAreaState.deduceEditorPosition(a),h=this._host.deduceModelPosition(u[0],u[1],u[2]),d=new MK(c.lineNumber,c.column,h.lineNumber,h.column);this._onSelectionChangeRequest.fire(d)}))}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){const e=LY(this.textArea.domNode);e?this._setHasFocus(e.activeElement===this.textArea.domNode):X$(this.textArea.domNode)?this._setHasFocus(document.activeElement===this.textArea.domNode):this._setHasFocus(!1)}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeScreenReaderContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeScreenReaderContent(e){this._isDoingComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent(this._textAreaState))}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy(hee.canUseTextData(e)),n={version:1,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};cee.INSTANCE.set(h$?t.text.replace(/\r\n/g,"\n"):t.text,n),hee.canUseTextData(e)?hee.setTextData(e,t.text,t.html,n):this._setAndWriteTextAreaState("copy or cut",oee.selectedText(t.text))}_firePaste(e,t){t||(t=cee.INSTANCE.get(e)),this._onPaste.fire({text:e,metadata:t})}}class hee{static canUseTextData(e){return!!e.clipboardData||!!window.clipboardData}static getTextData(e){if(e.clipboardData){e.preventDefault();const n=e.clipboardData.getData(Z7.text);let i=null;const r=e.clipboardData.getData("vscode-editor-data");if("string"==typeof r)try{i=JSON.parse(r),1!==i.version&&(i=null)}catch(t){}return[n,i]}if(window.clipboardData){e.preventDefault();return[window.clipboardData.getData("Text"),null]}throw new Error("ClipboardEventUtils.getTextData: Cannot use text data!")}static setTextData(e,t,n,i){if(e.clipboardData)return e.clipboardData.setData(Z7.text,t),"string"==typeof n&&e.clipboardData.setData("text/html",n),e.clipboardData.setData("vscode-editor-data",JSON.stringify(i)),void e.preventDefault();if(window.clipboardData)return window.clipboardData.setData("Text",t),void e.preventDefault();throw new Error("ClipboardEventUtils.setTextData: Cannot use text data!")}}class dee extends mG{constructor(e){super(),this._actual=e,this._ignoreSelectionChangeTime=0}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.domNode.value}setValue(e,t){const n=this._actual.domNode;n.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),n.value=t)}getSelectionStart(){return"backward"===this._actual.domNode.selectionDirection?this._actual.domNode.selectionEnd:this._actual.domNode.selectionStart}getSelectionEnd(){return"backward"===this._actual.domNode.selectionDirection?this._actual.domNode.selectionStart:this._actual.domNode.selectionEnd}setSelectionRange(e,t,n){const i=this._actual.domNode;let r=null;const o=LY(i);r=o?o.activeElement:document.activeElement;const s=r===i,a=i.selectionStart,l=i.selectionEnd;if(s&&a===t&&l===n)h$&&window.parent!==window&&i.focus();else{if(s)return this.setIgnoreSelectionChangeTime("setSelectionRange"),i.setSelectionRange(t,n),void(h$&&window.parent!==window&&i.focus());try{const e=function(e){let t=[];for(let n=0;e&&e.nodeType===e.ELEMENT_NODE;n++)t[n]=e.scrollTop,e=e.parentNode;return t}(i);this.setIgnoreSelectionChangeTime("setSelectionRange"),i.focus(),i.setSelectionRange(t,n),function(e,t){for(let n=0;e&&e.nodeType===e.ELEMENT_NODE;n++)e.scrollTop!==t[n]&&(e.scrollTop=t[n]),e=e.parentNode}(i,e)}catch(zWe){}}}}class fee extends $7{constructor(e,t,n){super(e,t,n),this._register(O6.addTarget(this.viewHelper.linesContentDomNode)),this._register(Q$(this.viewHelper.linesContentDomNode,M6.Tap,(e=>this.onTap(e)))),this._register(Q$(this.viewHelper.linesContentDomNode,M6.Change,(e=>this.onChange(e)))),this._register(Q$(this.viewHelper.linesContentDomNode,M6.Contextmenu,(e=>this._onContextMenu(new V6(e,this.viewHelper.viewDomNode),!1)))),this._lastPointerType="mouse",this._register(Q$(this.viewHelper.linesContentDomNode,"pointerdown",(e=>{const t=e.pointerType;this._lastPointerType="mouse"!==t?"touch"===t?"touch":"pen":"mouse"})));const i=new H6(this.viewHelper.viewDomNode);this._register(i.onPointerMoveThrottled(this.viewHelper.viewDomNode,(e=>this._onMouseMove(e)),q7(this.mouseTargetFactory),$7.MOUSE_MOVE_MINIMUM_TIME)),this._register(i.onPointerUp(this.viewHelper.viewDomNode,(e=>this._onMouseUp(e)))),this._register(i.onPointerLeave(this.viewHelper.viewDomNode,(e=>this._onMouseLeave(e)))),this._register(i.onPointerDown(this.viewHelper.viewDomNode,(e=>this._onMouseDown(e))))}onTap(e){if(!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget))return;e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new V6(e,this.viewHelper.viewDomNode),!1);t.position&&this.viewController.dispatchMouse({position:t.position,mouseColumn:t.position.column,startedOnLineNumbers:!1,mouseDownCount:e.tapCount,inSelectionMode:!1,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1})}onChange(e){"touch"===this._lastPointerType&&this._context.model.deltaScrollNow(-e.translationX,-e.translationY)}_onMouseDown(e){"touch"!==e.browserEvent.pointerType&&super._onMouseDown(e)}}class gee extends $7{constructor(e,t,n){super(e,t,n),this._register(O6.addTarget(this.viewHelper.linesContentDomNode)),this._register(Q$(this.viewHelper.linesContentDomNode,M6.Tap,(e=>this.onTap(e)))),this._register(Q$(this.viewHelper.linesContentDomNode,M6.Change,(e=>this.onChange(e)))),this._register(Q$(this.viewHelper.linesContentDomNode,M6.Contextmenu,(e=>this._onContextMenu(new V6(e,this.viewHelper.viewDomNode),!1))))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new V6(e,this.viewHelper.viewDomNode),!1);if(t.position){const e=document.createEvent("CustomEvent");e.initEvent(aee.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(e),this.viewController.moveTo(t.position)}}onChange(e){this._context.model.deltaScrollNow(-e.translationX,-e.translationY)}}class pee extends mG{constructor(e,t,n){super(),dj&&$$?this.handler=this._register(new fee(e,t,n)):window.TouchEvent?this.handler=this._register(new gee(e,t,n)):this.handler=this._register(new $7(e,t,n))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}class mee extends G6{}const vee="base.contributions.colors";const yee=new class{constructor(){this._onDidChangeSchema=new EG,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,n,i=!1,r){let o={id:e,description:n,defaults:t,needsTransparency:i,deprecationMessage:r};this.colorsById[e]=o;let s={type:"string",description:n,format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(s.deprecationMessage=r),this.colorSchema.properties[e]=s,this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(n),this._onDidChangeSchema.fire(),e}resolveDefaultColor(e,t){const n=this.colorsById[e];if(n&&n.defaults){return oie(n.defaults[t.type],t)}}getColorSchema(){return this.colorSchema}toString(){return Object.keys(this.colorsById).sort(((e,t)=>{let n=-1===e.indexOf(".")?0:1,i=-1===t.indexOf(".")?0:1;return n!==i?n-i:e.localeCompare(t)})).map((e=>`- \`${e}\`: ${this.colorsById[e].description}`)).join("\n")}};function _ee(e,t,n,i,r){return yee.registerColor(e,t,n,i,r)}d3.add(vee,yee);const bee=_ee("foreground",{dark:"#CCCCCC",light:"#616161",hc:"#FFFFFF"},GH(0,"Overall foreground color. This color is only used if not overridden by a component.")),wee=_ee("errorForeground",{dark:"#F48771",light:"#A1260D",hc:"#F48771"},GH(0,"Overall foreground color for error messages. This color is only used if not overridden by a component.")),Cee=_ee("icon.foreground",{dark:"#C5C5C5",light:"#424242",hc:"#FFFFFF"},GH(0,"The default color for icons in the workbench.")),See=_ee("focusBorder",{dark:"#007FD4",light:"#0090F1",hc:"#F38518"},GH(0,"Overall border color for focused elements. This color is only used if not overridden by a component.")),xee=_ee("contrastBorder",{light:null,dark:null,hc:"#6FC3DF"},GH(0,"An extra border around elements to separate them from others for greater contrast.")),Eee=_ee("contrastActiveBorder",{light:null,dark:null,hc:See},GH(0,"An extra border around active elements to separate them from others for greater contrast.")),kee=_ee("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hc:"#3794FF"},GH(0,"Foreground color for links in text.")),Lee=_ee("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hc:"#3794FF"},GH(0,"Foreground color for links in text when clicked on and on mouse hover.")),Dee=_ee("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hc:Q8.black},GH(0,"Background color for code blocks in text.")),Nee=_ee("widget.shadow",{dark:nie(Q8.black,.36),light:nie(Q8.black,.16),hc:null},GH(0,"Shadow color of widgets such as find/replace inside the editor.")),Iee=_ee("input.background",{dark:"#3C3C3C",light:Q8.white,hc:Q8.black},GH(0,"Input box background.")),Tee=_ee("input.foreground",{dark:bee,light:bee,hc:bee},GH(0,"Input box foreground.")),Mee=_ee("input.border",{dark:null,light:null,hc:xee},GH(0,"Input box border.")),Aee=_ee("inputOption.activeBorder",{dark:"#007ACC00",light:"#007ACC00",hc:xee},GH(0,"Border color of activated options in input fields.")),Oee=_ee("inputOption.activeBackground",{dark:nie(See,.4),light:nie(See,.2),hc:Q8.transparent},GH(0,"Background color of activated options in input fields.")),Ree=_ee("inputOption.activeForeground",{dark:Q8.white,light:Q8.black,hc:null},GH(0,"Foreground color of activated options in input fields.")),Pee=_ee("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hc:Q8.black},GH(0,"Input validation background color for information severity.")),Fee=_ee("inputValidation.infoForeground",{dark:null,light:null,hc:null},GH(0,"Input validation foreground color for information severity.")),Bee=_ee("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hc:xee},GH(0,"Input validation border color for information severity.")),Wee=_ee("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hc:Q8.black},GH(0,"Input validation background color for warning severity.")),zee=_ee("inputValidation.warningForeground",{dark:null,light:null,hc:null},GH(0,"Input validation foreground color for warning severity.")),Vee=_ee("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hc:xee},GH(0,"Input validation border color for warning severity.")),Uee=_ee("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hc:Q8.black},GH(0,"Input validation background color for error severity.")),Hee=_ee("inputValidation.errorForeground",{dark:null,light:null,hc:null},GH(0,"Input validation foreground color for error severity.")),jee=_ee("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hc:xee},GH(0,"Input validation border color for error severity.")),Gee=_ee("dropdown.background",{dark:"#3C3C3C",light:Q8.white,hc:Q8.black},GH(0,"Dropdown background.")),Kee=_ee("dropdown.foreground",{dark:"#F0F0F0",light:null,hc:Q8.white},GH(0,"Dropdown foreground.")),qee=_ee("button.foreground",{dark:Q8.white,light:Q8.white,hc:Q8.white},GH(0,"Button foreground color.")),$ee=_ee("button.background",{dark:"#0E639C",light:"#007ACC",hc:null},GH(0,"Button background color.")),Yee=_ee("button.hoverBackground",{dark:tie($ee,.2),light:eie($ee,.2),hc:null},GH(0,"Button background color when hovering.")),Xee=_ee("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hc:Q8.black},GH(0,"Badge background color. Badges are small information labels, e.g. for search results count.")),Zee=_ee("badge.foreground",{dark:Q8.white,light:"#333",hc:Q8.white},GH(0,"Badge foreground color. Badges are small information labels, e.g. for search results count.")),Qee=_ee("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hc:null},GH(0,"Scrollbar shadow to indicate that the view is scrolled.")),Jee=_ee("scrollbarSlider.background",{dark:Q8.fromHex("#797979").transparent(.4),light:Q8.fromHex("#646464").transparent(.4),hc:nie(xee,.6)},GH(0,"Scrollbar slider background color.")),ete=_ee("scrollbarSlider.hoverBackground",{dark:Q8.fromHex("#646464").transparent(.7),light:Q8.fromHex("#646464").transparent(.7),hc:nie(xee,.8)},GH(0,"Scrollbar slider background color when hovering.")),tte=_ee("scrollbarSlider.activeBackground",{dark:Q8.fromHex("#BFBFBF").transparent(.4),light:Q8.fromHex("#000000").transparent(.6),hc:xee},GH(0,"Scrollbar slider background color when clicked on.")),nte=_ee("progressBar.background",{dark:Q8.fromHex("#0E70C0"),light:Q8.fromHex("#0E70C0"),hc:xee},GH(0,"Background color of the progress bar that can show for long running operations.")),ite=_ee("editorError.background",{dark:null,light:null,hc:null},GH(0,"Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),rte=_ee("editorError.foreground",{dark:"#F48771",light:"#E51400",hc:null},GH(0,"Foreground color of error squigglies in the editor.")),ote=_ee("editorError.border",{dark:null,light:null,hc:Q8.fromHex("#E47777").transparent(.8)},GH(0,"Border color of error boxes in the editor.")),ste=_ee("editorWarning.background",{dark:null,light:null,hc:null},GH(0,"Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),ate=_ee("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hc:null},GH(0,"Foreground color of warning squigglies in the editor.")),lte=_ee("editorWarning.border",{dark:null,light:null,hc:Q8.fromHex("#FFCC00").transparent(.8)},GH(0,"Border color of warning boxes in the editor.")),cte=_ee("editorInfo.background",{dark:null,light:null,hc:null},GH(0,"Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),ute=_ee("editorInfo.foreground",{dark:"#75BEFF",light:"#75BEFF",hc:null},GH(0,"Foreground color of info squigglies in the editor.")),hte=_ee("editorInfo.border",{dark:null,light:null,hc:Q8.fromHex("#75BEFF").transparent(.8)},GH(0,"Border color of info boxes in the editor.")),dte=_ee("editorHint.foreground",{dark:Q8.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hc:null},GH(0,"Foreground color of hint squigglies in the editor.")),fte=_ee("editorHint.border",{dark:null,light:null,hc:Q8.fromHex("#eeeeee").transparent(.8)},GH(0,"Border color of hint boxes in the editor.")),gte=_ee("editor.background",{light:"#fffffe",dark:"#1E1E1E",hc:Q8.black},GH(0,"Editor background color.")),pte=_ee("editor.foreground",{light:"#333333",dark:"#BBBBBB",hc:Q8.white},GH(0,"Editor default foreground color.")),mte=_ee("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hc:"#0C141F"},GH(0,"Background color of editor widgets, such as find/replace.")),vte=_ee("editorWidget.foreground",{dark:bee,light:bee,hc:bee},GH(0,"Foreground color of editor widgets, such as find/replace.")),yte=_ee("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hc:xee},GH(0,"Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),_te=_ee("editorWidget.resizeBorder",{light:null,dark:null,hc:null},GH(0,"Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),bte=_ee("quickInput.background",{dark:mte,light:mte,hc:mte},GH(0,"Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),wte=_ee("quickInput.foreground",{dark:vte,light:vte,hc:vte},GH(0,"Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),Cte=_ee("quickInputTitle.background",{dark:new Q8(new Y8(255,255,255,.105)),light:new Q8(new Y8(0,0,0,.06)),hc:"#000000"},GH(0,"Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),Ste=_ee("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hc:Q8.white},GH(0,"Quick picker color for grouping labels.")),xte=_ee("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hc:Q8.white},GH(0,"Quick picker color for grouping borders.")),Ete=_ee("keybindingLabel.background",{dark:new Q8(new Y8(128,128,128,.17)),light:new Q8(new Y8(221,221,221,.4)),hc:Q8.transparent},GH(0,"Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),kte=_ee("keybindingLabel.foreground",{dark:Q8.fromHex("#CCCCCC"),light:Q8.fromHex("#555555"),hc:Q8.white},GH(0,"Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),Lte=_ee("keybindingLabel.border",{dark:new Q8(new Y8(51,51,51,.6)),light:new Q8(new Y8(204,204,204,.4)),hc:new Q8(new Y8(111,195,223))},GH(0,"Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),Dte=_ee("keybindingLabel.bottomBorder",{dark:new Q8(new Y8(68,68,68,.6)),light:new Q8(new Y8(187,187,187,.4)),hc:new Q8(new Y8(111,195,223))},GH(0,"Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),Nte=_ee("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hc:"#f3f518"},GH(0,"Color of the editor selection.")),Ite=_ee("editor.selectionForeground",{light:null,dark:null,hc:"#000000"},GH(0,"Color of the selected text for high contrast.")),Tte=_ee("editor.inactiveSelectionBackground",{light:nie(Nte,.5),dark:nie(Nte,.5),hc:nie(Nte,.5)},GH(0,"Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),Mte=_ee("editor.selectionHighlightBackground",{light:rie(Nte,gte,.3,.6),dark:rie(Nte,gte,.3,.6),hc:null},GH(0,"Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),Ate=_ee("editor.selectionHighlightBorder",{light:null,dark:null,hc:Eee},GH(0,"Border color for regions with the same content as the selection.")),Ote=_ee("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hc:null},GH(0,"Color of the current search match.")),Rte=_ee("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hc:null},GH(0,"Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),Pte=_ee("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hc:null},GH(0,"Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),Fte=_ee("editor.findMatchBorder",{light:null,dark:null,hc:Eee},GH(0,"Border color of the current search match.")),Bte=_ee("editor.findMatchHighlightBorder",{light:null,dark:null,hc:Eee},GH(0,"Border color of the other search matches.")),Wte=_ee("editor.findRangeHighlightBorder",{dark:null,light:null,hc:nie(Eee,.4)},GH(0,"Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),zte=_ee("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hc:"#ADD6FF26"},GH(0,"Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),Vte=_ee("editorHoverWidget.background",{light:mte,dark:mte,hc:mte},GH(0,"Background color of the editor hover.")),Ute=_ee("editorHoverWidget.foreground",{light:vte,dark:vte,hc:vte},GH(0,"Foreground color of the editor hover.")),Hte=_ee("editorHoverWidget.border",{light:yte,dark:yte,hc:yte},GH(0,"Border color of the editor hover.")),jte=_ee("editorHoverWidget.statusBarBackground",{dark:tie(Vte,.2),light:eie(Vte,.05),hc:mte},GH(0,"Background color of the editor hover status bar.")),Gte=_ee("editorLink.activeForeground",{dark:"#4E94CE",light:Q8.blue,hc:Q8.cyan},GH(0,"Color of active links.")),Kte=_ee("editorInlayHint.foreground",{dark:mte,light:vte,hc:mte},GH(0,"Foreground color of inline hints")),qte=_ee("editorInlayHint.background",{dark:vte,light:mte,hc:vte},GH(0,"Background color of inline hints")),$te=_ee("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hc:"#FFCC00"},GH(0,"The color used for the lightbulb actions icon.")),Yte=_ee("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},GH(0,"The color used for the lightbulb auto fix actions icon.")),Xte=new Q8(new Y8(155,185,85,.2)),Zte=new Q8(new Y8(255,0,0,.2)),Qte=_ee("diffEditor.insertedTextBackground",{dark:Xte,light:Xte,hc:null},GH(0,"Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),Jte=_ee("diffEditor.removedTextBackground",{dark:Zte,light:Zte,hc:null},GH(0,"Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),ene=_ee("diffEditor.insertedTextBorder",{dark:null,light:null,hc:"#33ff2eff"},GH(0,"Outline color for the text that got inserted.")),tne=_ee("diffEditor.removedTextBorder",{dark:null,light:null,hc:"#FF008F"},GH(0,"Outline color for text that got removed.")),nne=_ee("diffEditor.border",{dark:null,light:null,hc:xee},GH(0,"Border color between the two text editors.")),ine=_ee("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hc:null},GH(0,"Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),rne=_ee("list.focusBackground",{dark:null,light:null,hc:null},GH(0,"List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),one=_ee("list.focusForeground",{dark:null,light:null,hc:null},GH(0,"List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),sne=_ee("list.focusOutline",{dark:See,light:See,hc:Eee},GH(0,"List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),ane=_ee("list.activeSelectionBackground",{dark:"#094771",light:"#0060C0",hc:null},GH(0,"List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),lne=_ee("list.activeSelectionForeground",{dark:Q8.white,light:Q8.white,hc:null},GH(0,"List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),cne=_ee("list.activeSelectionIconForeground",{dark:null,light:null,hc:null},GH(0,"List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),une=_ee("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hc:null},GH(0,"List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),hne=_ee("list.inactiveSelectionForeground",{dark:null,light:null,hc:null},GH(0,"List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),dne=_ee("list.inactiveSelectionIconForeground",{dark:null,light:null,hc:null},GH(0,"List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),fne=_ee("list.inactiveFocusBackground",{dark:null,light:null,hc:null},GH(0,"List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),gne=_ee("list.inactiveFocusOutline",{dark:null,light:null,hc:null},GH(0,"List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),pne=_ee("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hc:null},GH(0,"List/Tree background when hovering over items using the mouse.")),mne=_ee("list.hoverForeground",{dark:null,light:null,hc:null},GH(0,"List/Tree foreground when hovering over items using the mouse.")),vne=_ee("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hc:null},GH(0,"List/Tree drag and drop background when moving items around using the mouse.")),yne=_ee("list.highlightForeground",{dark:"#18A3FF",light:"#0066BF",hc:See},GH(0,"List/Tree foreground color of the match highlights when searching inside the list/tree.")),_ne=_ee("list.focusHighlightForeground",{dark:yne,light:yne,hc:yne},GH(0,"List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),bne=_ee("listFilterWidget.background",{light:"#efc1ad",dark:"#653723",hc:Q8.black},GH(0,"Background color of the type filter widget in lists and trees.")),wne=_ee("listFilterWidget.outline",{dark:Q8.transparent,light:Q8.transparent,hc:"#f38518"},GH(0,"Outline color of the type filter widget in lists and trees.")),Cne=_ee("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hc:xee},GH(0,"Outline color of the type filter widget in lists and trees, when there are no matches.")),Sne=_ee("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hc:"#a9a9a9"},GH(0,"Tree stroke color for the indentation guides.")),xne=_ee("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hc:null},GH(0,"Tree stroke color for the indentation guides.")),Ene=_ee("quickInput.list.focusBackground",{dark:null,light:null,hc:null},"",void 0,GH(0,"Please use quickInputList.focusBackground instead")),kne=_ee("quickInputList.focusForeground",{dark:lne,light:lne,hc:lne},GH(0,"Quick picker foreground color for the focused item.")),Lne=_ee("quickInputList.focusIconForeground",{dark:cne,light:cne,hc:cne},GH(0,"Quick picker icon foreground color for the focused item.")),Dne=_ee("quickInputList.focusBackground",{dark:iie(Ene,ane,"#062F4A"),light:iie(Ene,ane,"#D6EBFF"),hc:null},GH(0,"Quick picker background color for the focused item.")),Nne=_ee("menu.border",{dark:null,light:null,hc:xee},GH(0,"Border color of menus.")),Ine=_ee("menu.foreground",{dark:Kee,light:bee,hc:Kee},GH(0,"Foreground color of menu items.")),Tne=_ee("menu.background",{dark:Gee,light:Gee,hc:Gee},GH(0,"Background color of menu items.")),Mne=_ee("menu.selectionForeground",{dark:lne,light:lne,hc:lne},GH(0,"Foreground color of the selected menu item in menus.")),Ane=_ee("menu.selectionBackground",{dark:ane,light:ane,hc:ane},GH(0,"Background color of the selected menu item in menus.")),One=_ee("menu.selectionBorder",{dark:null,light:null,hc:Eee},GH(0,"Border color of the selected menu item in menus.")),Rne=_ee("menu.separatorBackground",{dark:"#BBBBBB",light:"#888888",hc:xee},GH(0,"Color of a separator menu item in menus.")),Pne=_ee("editor.snippetTabstopHighlightBackground",{dark:new Q8(new Y8(124,124,124,.3)),light:new Q8(new Y8(10,50,100,.2)),hc:new Q8(new Y8(124,124,124,.3))},GH(0,"Highlight background color of a snippet tabstop.")),Fne=_ee("editor.snippetTabstopHighlightBorder",{dark:null,light:null,hc:null},GH(0,"Highlight border color of a snippet tabstop.")),Bne=_ee("editor.snippetFinalTabstopHighlightBackground",{dark:null,light:null,hc:null},GH(0,"Highlight background color of the final tabstop of a snippet.")),Wne=_ee("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new Q8(new Y8(10,50,100,.5)),hc:"#525252"},GH(0,"Highlight border color of the final tabstop of a snippet.")),zne=_ee("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hc:"#AB5A00"},GH(0,"Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),Vne=_ee("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hc:"#A0A0A0CC"},GH(0,"Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Une=_ee("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hc:"#AB5A00"},GH(0,"Minimap marker color for find matches."),!0),Hne=_ee("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hc:"#ffffff"},GH(0,"Minimap marker color for the editor selection."),!0),jne=_ee("minimap.errorHighlight",{dark:new Q8(new Y8(255,18,18,.7)),light:new Q8(new Y8(255,18,18,.7)),hc:new Q8(new Y8(255,50,50,1))},GH(0,"Minimap marker color for errors.")),Gne=_ee("minimap.warningHighlight",{dark:ate,light:ate,hc:lte},GH(0,"Minimap marker color for warnings.")),Kne=_ee("minimap.background",{dark:null,light:null,hc:null},GH(0,"Minimap background color.")),qne=_ee("minimapSlider.background",{light:nie(Jee,.5),dark:nie(Jee,.5),hc:nie(Jee,.5)},GH(0,"Minimap slider background color.")),$ne=_ee("minimapSlider.hoverBackground",{light:nie(ete,.5),dark:nie(ete,.5),hc:nie(ete,.5)},GH(0,"Minimap slider background color when hovering.")),Yne=_ee("minimapSlider.activeBackground",{light:nie(tte,.5),dark:nie(tte,.5),hc:nie(tte,.5)},GH(0,"Minimap slider background color when clicked on.")),Xne=_ee("problemsErrorIcon.foreground",{dark:rte,light:rte,hc:rte},GH(0,"The color used for the problems error icon.")),Zne=_ee("problemsWarningIcon.foreground",{dark:ate,light:ate,hc:ate},GH(0,"The color used for the problems warning icon.")),Qne=_ee("problemsInfoIcon.foreground",{dark:ute,light:ute,hc:ute},GH(0,"The color used for the problems info icon."));function Jne(e,t){var n,i,r;switch(e.op){case 0:return null===(n=oie(e.value,t))||void 0===n?void 0:n.darken(e.factor);case 1:return null===(i=oie(e.value,t))||void 0===i?void 0:i.lighten(e.factor);case 2:return null===(r=oie(e.value,t))||void 0===r?void 0:r.transparent(e.factor);case 3:for(const n of e.values){const e=oie(n,t);if(e)return e}return;case 4:const o=oie(e.value,t);if(!o)return;const s=oie(e.background,t);return s?o.isDarkerThan(s)?Q8.getLighterColor(o,s,e.factor).transparent(e.transparency):Q8.getDarkerColor(o,s,e.factor).transparent(e.transparency):o.transparent(e.factor*e.transparency);default:throw function(e){throw new Error("Unreachable")}()}}function eie(e,t){return{op:0,value:e,factor:t}}function tie(e,t){return{op:1,value:e,factor:t}}function nie(e,t){return{op:2,value:e,factor:t}}function iie(...e){return{op:3,values:e}}function rie(e,t,n,i){return{op:4,value:e,background:t,factor:n,transparency:i}}function oie(e,t){if(null!==e)return"string"==typeof e?"#"===e[0]?Q8.fromHex(e):t.getColor(e):e instanceof Q8?e:"object"==typeof e?Jne(e,t):void 0}let sie=d3.as(f3);sie.registerSchema("vscode://schemas/workbench-colors",yee.getColorSchema());const aie=new z$((()=>sie.notifySchemaChanged("vscode://schemas/workbench-colors")),200);yee.onDidChangeSchema((()=>{aie.isScheduled()||aie.schedule()}));const lie=_ee("editor.lineHighlightBackground",{dark:null,light:null,hc:null},GH(0,"Background color for the highlight of line at the cursor position.")),cie=_ee("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hc:"#f38518"},GH(0,"Background color for the border around the line at the cursor position.")),uie=_ee("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hc:null},GH(0,"Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),hie=_ee("editor.rangeHighlightBorder",{dark:null,light:null,hc:Eee},GH(0,"Background color of the border around highlighted ranges."),!0),die=_ee("editor.symbolHighlightBackground",{dark:Rte,light:Rte,hc:null},GH(0,"Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),fie=_ee("editor.symbolHighlightBorder",{dark:null,light:null,hc:Eee},GH(0,"Background color of the border around highlighted symbols."),!0),gie=_ee("editorCursor.foreground",{dark:"#AEAFAD",light:Q8.black,hc:Q8.white},GH(0,"Color of the editor cursor.")),pie=_ee("editorCursor.background",null,GH(0,"The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),mie=_ee("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hc:"#e3e4e229"},GH(0,"Color of whitespace characters in the editor.")),vie=_ee("editorIndentGuide.background",{dark:mie,light:mie,hc:mie},GH(0,"Color of the editor indentation guides.")),yie=_ee("editorIndentGuide.activeBackground",{dark:mie,light:mie,hc:mie},GH(0,"Color of the active editor indentation guides.")),_ie=_ee("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hc:Q8.white},GH(0,"Color of editor line numbers.")),bie=_ee("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hc:Eee},GH(0,"Color of editor active line number"),!1,GH(0,"Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),wie=_ee("editorLineNumber.activeForeground",{dark:bie,light:bie,hc:bie},GH(0,"Color of editor active line number")),Cie=_ee("editorRuler.foreground",{dark:"#5A5A5A",light:Q8.lightgrey,hc:Q8.white},GH(0,"Color of the editor rulers.")),Sie=_ee("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hc:"#999999"},GH(0,"Foreground color of editor CodeLens")),xie=_ee("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hc:"#0064001a"},GH(0,"Background color behind matching brackets")),Eie=_ee("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hc:xee},GH(0,"Color for matching brackets boxes")),kie=_ee("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hc:"#7f7f7f4d"},GH(0,"Color of the overview ruler border.")),Lie=_ee("editorOverviewRuler.background",null,GH(0,"Background color of the editor overview ruler. Only used when the minimap is enabled and placed on the right side of the editor.")),Die=_ee("editorGutter.background",{dark:gte,light:gte,hc:gte},GH(0,"Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),Nie=_ee("editorUnnecessaryCode.border",{dark:null,light:null,hc:Q8.fromHex("#fff").transparent(.8)},GH(0,"Border color of unnecessary (unused) source code in the editor.")),Iie=_ee("editorUnnecessaryCode.opacity",{dark:Q8.fromHex("#000a"),light:Q8.fromHex("#0007"),hc:null},GH(0,"Opacity of unnecessary (unused) source code in the editor. For example, \"#000000c0\" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.")),Tie=_ee("editorGhostText.border",{dark:null,light:null,hc:Q8.fromHex("#fff").transparent(.8)},GH(0,"Border color of ghost text in the editor.")),Mie=_ee("editorGhostText.foreground",{dark:Q8.fromHex("#ffffff56"),light:Q8.fromHex("#0007"),hc:null},GH(0,"Foreground color of the ghost text in the editor.")),Aie=new Q8(new Y8(0,122,204,.6)),Oie=_ee("editorOverviewRuler.rangeHighlightForeground",{dark:Aie,light:Aie,hc:Aie},GH(0,"Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Rie=_ee("editorOverviewRuler.errorForeground",{dark:new Q8(new Y8(255,18,18,.7)),light:new Q8(new Y8(255,18,18,.7)),hc:new Q8(new Y8(255,50,50,1))},GH(0,"Overview ruler marker color for errors.")),Pie=_ee("editorOverviewRuler.warningForeground",{dark:ate,light:ate,hc:lte},GH(0,"Overview ruler marker color for warnings.")),Fie=_ee("editorOverviewRuler.infoForeground",{dark:ute,light:ute,hc:hte},GH(0,"Overview ruler marker color for infos."));G5(((e,t)=>{const n=e.getColor(gte);n&&t.addRule(`.monaco-editor, .monaco-editor-background, .monaco-editor .inputarea.ime-input { background-color: ${n}; }`);const i=e.getColor(pte);i&&t.addRule(`.monaco-editor, .monaco-editor .inputarea.ime-input { color: ${i}; }`);const r=e.getColor(Die);r&&t.addRule(`.monaco-editor .margin { background-color: ${r}; }`);const o=e.getColor(uie);o&&t.addRule(`.monaco-editor .rangeHighlight { background-color: ${o}; }`);const s=e.getColor(hie);s&&t.addRule(`.monaco-editor .rangeHighlight { border: 1px ${"hc"===e.type?"dotted":"solid"} ${s}; }`);const a=e.getColor(die);a&&t.addRule(`.monaco-editor .symbolHighlight { background-color: ${a}; }`);const l=e.getColor(fie);l&&t.addRule(`.monaco-editor .symbolHighlight { border: 1px ${"hc"===e.type?"dotted":"solid"} ${l}; }`);const c=e.getColor(mie);c&&(t.addRule(`.monaco-editor .mtkw { color: ${c} !important; }`),t.addRule(`.monaco-editor .mtkz { color: ${c} !important; }`))}));class Bie extends mee{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new IK(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(56);const t=e.get(57);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(82);const n=e.get(128);this._lineNumbersLeft=n.lineNumbersLeft,this._lineNumbersWidth=n.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(t);let n=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,n=!0),2!==this._renderLineNumbers&&3!==this._renderLineNumbers||(n=!0),n}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getLineRenderLineNumber(e){const t=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new IK(e,1));if(1!==t.column)return"";const n=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n);if(2===this._renderLineNumbers){const e=Math.abs(this._lastCursorModelPosition.lineNumber-n);return 0===e?'<span class="relative-current-line-number">'+n+"</span>":String(e)}return 3===this._renderLineNumbers?this._lastCursorModelPosition.lineNumber===n||n%10==0?String(n):"":String(n)}prepareRender(e){if(0===this._renderLineNumbers)return void(this._renderResult=null);const t=cj?this._lineHeight%2==0?" lh-even":" lh-odd":"",n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r='<div class="'+Bie.CLASS_NAME+t+'" style="left:'+this._lineNumbersLeft+"px;width:"+this._lineNumbersWidth+'px;">',o=this._context.model.getLineCount(),s=[];for(let a=n;a<=i;a++){const e=a-n;if(!this._renderFinalNewline&&a===o&&0===this._context.model.getLineLength(a)){s[e]="";continue}const i=this._getLineRenderLineNumber(a);i?a===this._activeLineNumber?s[e]='<div class="active-line-number '+Bie.CLASS_NAME+t+'" style="left:'+this._lineNumbersLeft+"px;width:"+this._lineNumbersWidth+'px;">'+i+"</div>":s[e]=r+i+"</div>":s[e]=""}this._renderResult=s}render(e,t){if(!this._renderResult)return"";const n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}}Bie.CLASS_NAME="line-numbers",G5(((e,t)=>{const n=e.getColor(_ie);n&&t.addRule(`.monaco-editor .line-numbers { color: ${n}; }`);const i=e.getColor(wie);i&&t.addRule(`.monaco-editor .line-numbers.active-line-number { color: ${i}; }`)}));class Wie extends K6{constructor(e){super(e);const t=this._context.configuration.options,n=t.get(128);this._canUseLayerHinting=!t.get(26),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._domNode=I6(document.createElement("div")),this._domNode.setClassName(Wie.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=I6(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(Wie.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,n=t.get(128);return this._canUseLayerHinting=!t.get(26),this._contentLeft=n.contentLeft,this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const n=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(n),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(n)}}Wie.CLASS_NAME="glyph-margin",Wie.OUTER_CLASS_NAME="margin";class zie{constructor(e,t,n){this._visibleTextAreaBrand=void 0,this.top=e,this.left=t,this.width=n}setWidth(e){return new zie(this.top,this.left,e)}}const Vie=h$;class Uie extends K6{constructor(e,t,n){super(e),this._primaryCursorPosition=new IK(1,1),this._primaryCursorVisibleRange=null,this._viewController=t,this._viewHelper=n,this._scrollLeft=0,this._scrollTop=0;const i=this._context.configuration.options,r=i.get(128);this._setAccessibilityOptions(i),this._contentLeft=r.contentLeft,this._contentWidth=r.contentWidth,this._contentHeight=r.height,this._fontInfo=i.get(40),this._lineHeight=i.get(56),this._emptySelectionClipboard=i.get(30),this._copyWithSyntaxHighlighting=i.get(19),this._visibleTextArea=null,this._selections=[new MK(1,1,1,1)],this._modelSelections=[new MK(1,1,1,1)],this._lastRenderPosition=null,this.textArea=I6(document.createElement("textarea")),q6.write(this.textArea,6),this.textArea.setClassName("inputarea monaco-mouse-cursor-text"),this.textArea.setAttribute("wrap","off"),this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(i)),this.textArea.setAttribute("tabindex",String(i.get(110))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",GH(0,"editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),i.get(28)&&i.get(78)&&this.textArea.setAttribute("readonly","true"),this.textAreaCover=I6(document.createElement("div")),this.textAreaCover.setPosition("absolute");const o={getLineCount:()=>this._context.model.getLineCount(),getLineMaxColumn:e=>this._context.model.getLineMaxColumn(e),getValueInRange:(e,t)=>this._context.model.getValueInRange(e,t)},s={getDataToCopy:e=>{const t=this._context.model.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,aj),n=this._context.model.getEOL(),i=this._emptySelectionClipboard&&1===this._modelSelections.length&&this._modelSelections[0].isEmpty(),r=Array.isArray(t)?t:null,o=Array.isArray(t)?t.join(n):t;let s,a=null;if(e&&(lee.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&o.length<65536)){const e=this._context.model.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);e&&(s=e.html,a=e.mode)}return{isFromEmptySelection:i,multicursorText:r,text:o,html:s,mode:a}},getScreenReaderContent:e=>{if(1===this._accessibilitySupport){if(lj){const e=this._selections[0];if(e.isEmpty()){const t=e.getStartPosition();let n=this._getWordBeforePosition(t);if(0===n.length&&(n=this._getCharacterBeforePosition(t)),n.length>0)return new oee(n,n.length,n.length,t,t)}}return oee.EMPTY}if(m$){const e=this._selections[0];if(e.isEmpty()){const t=e.getStartPosition(),[n,i]=this._getAndroidWordAtPosition(t);if(n.length>0)return new oee(n,i,i,t,t)}return oee.EMPTY}return see.fromEditorSelection(e,o,this._selections[0],this._accessibilityPageSize,0===this._accessibilitySupport)},deduceModelPosition:(e,t,n)=>this._context.model.deduceModelPositionRelativeToViewPosition(e,t,n)};this._textAreaInput=this._register(new uee(s,this.textArea)),this._register(this._textAreaInput.onKeyDown((e=>{this._viewController.emitKeyDown(e)}))),this._register(this._textAreaInput.onKeyUp((e=>{this._viewController.emitKeyUp(e)}))),this._register(this._textAreaInput.onPaste((e=>{let t=!1,n=null,i=null;e.metadata&&(t=this._emptySelectionClipboard&&!!e.metadata.isFromEmptySelection,n=void 0!==e.metadata.multicursorText?e.metadata.multicursorText:null,i=e.metadata.mode),this._viewController.paste(e.text,t,n,i)}))),this._register(this._textAreaInput.onCut((()=>{this._viewController.cut()}))),this._register(this._textAreaInput.onType((e=>{e.replacePrevCharCnt||e.replaceNextCharCnt||e.positionDelta?this._viewController.compositionType(e.text,e.replacePrevCharCnt,e.replaceNextCharCnt,e.positionDelta):this._viewController.type(e.text)}))),this._register(this._textAreaInput.onSelectionChangeRequest((e=>{this._viewController.setSelection(e)}))),this._register(this._textAreaInput.onCompositionStart((e=>{const t=this._selections[0].startLineNumber,n=this._selections[0].startColumn+e.revealDeltaColumns;this._context.model.revealRange("keyboard",!0,new TK(t,n,t,n),0,1);const i=this._viewHelper.visibleRangeForPositionRelativeToEditor(t,n);i&&(this._visibleTextArea=new zie(this._context.viewLayout.getVerticalOffsetForLineNumber(t),i.left,Vie?0:1),this._render()),this.textArea.setClassName("inputarea monaco-mouse-cursor-text ime-input"),this._viewController.compositionStart(),this._context.model.onCompositionStart()}))),this._register(this._textAreaInput.onCompositionUpdate((e=>{this._visibleTextArea&&(this._visibleTextArea=this._visibleTextArea.setWidth(function(e,t){const n=document.createElement("canvas").getContext("2d");n.font=(i=t,r="normal",o=i.fontWeight,s=i.fontSize,a=i.lineHeight,l=i.fontFamily,`${r} normal ${o} ${s}px / ${a}px ${l}`);var i,r,o,s,a,l;const c=n.measureText(e);return h$?c.width+2:c.width}(e.data,this._fontInfo)),this._render())}))),this._register(this._textAreaInput.onCompositionEnd((()=>{this._visibleTextArea=null,this._render(),this.textArea.setClassName("inputarea monaco-mouse-cursor-text"),this._viewController.compositionEnd(),this._context.model.onCompositionEnd()}))),this._register(this._textAreaInput.onFocus((()=>{this._context.model.setHasFocus(!0)}))),this._register(this._textAreaInput.onBlur((()=>{this._context.model.setHasFocus(!1)})))}dispose(){super.dispose()}_getAndroidWordAtPosition(e){const t=this._context.model.getLineContent(e.lineNumber),n=s8('`~!@#$%^&*()-=+[{]}\\|;:",.<>/?');let i=!0,r=e.column,o=!0,s=e.column,a=0;for(;a<50&&(i||o);){if(i&&r<=1&&(i=!1),i){const e=t.charCodeAt(r-2);0!==n.get(e)?i=!1:r--}if(o&&s>t.length&&(o=!1),o){const e=t.charCodeAt(s-1);0!==n.get(e)?o=!1:s++}a++}return[t.substring(r-1,s-1),e.column-r]}_getWordBeforePosition(e){const t=this._context.model.getLineContent(e.lineNumber),n=s8(this._context.configuration.options.get(114));let i=e.column,r=0;for(;i>1;){const o=t.charCodeAt(i-2);if(0!==n.get(o)||r>50)return t.substring(i-1,e.column-1);r++,i--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const t=this._context.model.getLineContent(e.lineNumber).charAt(e.column-2);if(!kX(t.charCodeAt(0)))return t}return""}_getAriaLabel(e){return 1===e.get(2)?GH(0,"The editor is not accessible at this time. Press {0} for options.",cj?"Shift+Alt+F1":"Alt+F1"):e.get(4)}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);2===this._accessibilitySupport&&t===eG.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t}onConfigurationChanged(e){const t=this._context.configuration.options,n=t.get(128);return this._setAccessibilityOptions(t),this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._contentHeight=n.height,this._fontInfo=t.get(40),this._lineHeight=t.get(56),this._emptySelectionClipboard=t.get(30),this._copyWithSyntaxHighlighting=t.get(19),this.textArea.setAttribute("aria-label",this._getAriaLabel(t)),this.textArea.setAttribute("tabindex",String(t.get(110))),(e.hasChanged(28)||e.hasChanged(78))&&(t.get(28)&&t.get(78)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")),e.hasChanged(2)&&this._textAreaInput.writeScreenReaderContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}prepareRender(e){this._primaryCursorPosition=new IK(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition)}render(e){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){if(this._visibleTextArea)return void this._renderInsideEditor(null,this._visibleTextArea.top-this._scrollTop,this._contentLeft+this._visibleTextArea.left-this._scrollLeft,this._visibleTextArea.width,this._lineHeight);if(!this._primaryCursorVisibleRange)return void this._renderAtTopLeft();const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth)return void this._renderAtTopLeft();const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;t<0||t>this._contentHeight?this._renderAtTopLeft():lj?this._renderInsideEditor(this._primaryCursorPosition,t,e,Vie?0:1,this._lineHeight):this._renderInsideEditor(this._primaryCursorPosition,t,e,Vie?0:1,Vie?0:1)}_renderInsideEditor(e,t,n,i,r){this._lastRenderPosition=e;const o=this.textArea,s=this.textAreaCover;D6.applyFontInfo(o,this._fontInfo),o.setTop(t),o.setLeft(n),o.setWidth(i),o.setHeight(r),s.setTop(0),s.setLeft(0),s.setWidth(0),s.setHeight(0)}_renderAtTopLeft(){this._lastRenderPosition=null;const e=this.textArea,t=this.textAreaCover;if(D6.applyFontInfo(e,this._fontInfo),e.setTop(0),e.setLeft(0),t.setTop(0),t.setLeft(0),Vie)return e.setWidth(0),e.setHeight(0),t.setWidth(0),void t.setHeight(0);e.setWidth(1),e.setHeight(1),t.setWidth(1),t.setHeight(1);const n=this._context.configuration.options;n.get(46)?t.setClassName("monaco-editor-background textAreaCover "+Wie.OUTER_CLASS_NAME):0!==n.get(57).renderType?t.setClassName("monaco-editor-background textAreaCover "+Bie.CLASS_NAME):t.setClassName("monaco-editor-background textAreaCover")}}class Hie{static columnSelect(e,t,n,i,r,o){let s=Math.abs(r-n)+1,a=n>r,l=i>o,c=i<o,u=[];for(let h=0;h<s;h++){let r=n+(a?-h:h),s=M7.columnFromVisibleColumn2(e,t,r,i),d=M7.columnFromVisibleColumn2(e,t,r,o),f=M7.visibleColumnFromColumn2(e,t,new IK(r,s)),g=M7.visibleColumnFromColumn2(e,t,new IK(r,d));if(c){if(f>o)continue;if(g<i)continue}if(l){if(g>i)continue;if(f<o)continue}u.push(new k7(new TK(r,s,r,s),0,new IK(r,d),0))}if(0===u.length)for(let h=0;h<s;h++){const e=n+(a?-h:h),i=t.getLineMaxColumn(e);u.push(new k7(new TK(e,i,e,i),0,new IK(e,i),0))}return{viewStates:u,reversed:a,fromLineNumber:n,fromVisualColumn:i,toLineNumber:r,toVisualColumn:o}}static columnSelectLeft(e,t,n){let i=n.toViewVisualColumn;return i>0&&i--,Hie.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,i)}static columnSelectRight(e,t,n){let i=0;const r=Math.min(n.fromViewLineNumber,n.toViewLineNumber),o=Math.max(n.fromViewLineNumber,n.toViewLineNumber);for(let a=r;a<=o;a++){const n=t.getLineMaxColumn(a),r=M7.visibleColumnFromColumn2(e,t,new IK(a,n));i=Math.max(i,r)}let s=n.toViewVisualColumn;return s<i&&s++,this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,n.toViewLineNumber,s)}static columnSelectUp(e,t,n,i){const r=i?e.pageSize:1,o=Math.max(1,n.toViewLineNumber-r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,o,n.toViewVisualColumn)}static columnSelectDown(e,t,n,i){const r=i?e.pageSize:1,o=Math.min(t.getLineCount(),n.toViewLineNumber+r);return this.columnSelect(e,t,n.fromViewLineNumber,n.fromViewVisualColumn,o,n.toViewVisualColumn)}}class jie{constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return new MK(n.endLineNumber,n.endColumn,n.endLineNumber,n.endColumn)}}class Gie{constructor(e,t){this._range=e,this._text=t}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return new MK(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn)}}class Kie{constructor(e,t,n=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=n}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return new MK(n.startLineNumber,n.startColumn,n.startLineNumber,n.startColumn)}}class qie{constructor(e,t,n,i,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=i,this._lineNumberDeltaOffset=n,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return new MK(n.endLineNumber+this._lineNumberDeltaOffset,n.endColumn+this._columnDeltaOffset,n.endLineNumber+this._lineNumberDeltaOffset,n.endColumn+this._columnDeltaOffset)}}class $ie{constructor(e,t,n,i=!1){this._range=e,this._text=t,this._initialSelection=n,this._forceMoveMarkers=i,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class Yie{constructor(e,t,n){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=n}}class Xie{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-function(e,t){const n=KX.getInstance(),i=t,r=IX(e,t);t-=r>=65536?2:1;let o=n.getGraphemeBreakType(r);for(;t>0;){const i=IX(e,t),r=n.getGraphemeBreakType(i);if(GX(r,o))break;t-=i>=65536?2:1,o=r}return i-t}(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const n=t.lineNumber-1;return new IK(n,e.getLineMaxColumn(n))}return t}static leftPositionAtomicSoftTabs(e,t,n){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const i=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),o=O7.atomicPosition(r,t.column-1,n,0);if(-1!==o&&o+1>=i)return new IK(t.lineNumber,o+1)}return this.leftPosition(e,t)}static left(e,t,n){const i=e.stickyTabStops?Xie.leftPositionAtomicSoftTabs(t,n,e.tabSize):Xie.leftPosition(t,n);return new Yie(i.lineNumber,i.column,0)}static moveLeft(e,t,n,i,r){let o,s;if(n.hasSelection()&&!i)o=n.selection.startLineNumber,s=n.selection.startColumn;else{const i=n.position.delta(void 0,-(r-1)),a=t.normalizePosition(Xie.clipPositionColumn(i,t),0),l=Xie.left(e,t,a);o=l.lineNumber,s=l.column}return n.move(i,o,s,0)}static clipPositionColumn(e,t){return new IK(e.lineNumber,Xie.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,n){return e<t?t:e>n?n:e}static rightPosition(e,t,n){return n<e.getLineMaxColumn(t)?n+=TX(e.getLineContent(t),n-1):t<e.getLineCount()&&(t+=1,n=e.getLineMinColumn(t)),new IK(t,n)}static rightPositionAtomicSoftTabs(e,t,n,i,r){if(n<e.getLineIndentColumn(t)){const r=e.getLineContent(t),o=O7.atomicPosition(r,n-1,i,1);if(-1!==o)return new IK(t,o+1)}return this.rightPosition(e,t,n)}static right(e,t,n){const i=e.stickyTabStops?Xie.rightPositionAtomicSoftTabs(t,n.lineNumber,n.column,e.tabSize,e.indentSize):Xie.rightPosition(t,n.lineNumber,n.column);return new Yie(i.lineNumber,i.column,0)}static moveRight(e,t,n,i,r){let o,s;if(n.hasSelection()&&!i)o=n.selection.endLineNumber,s=n.selection.endColumn;else{const i=n.position.delta(void 0,r-1),a=t.normalizePosition(Xie.clipPositionColumn(i,t),1),l=Xie.right(e,t,a);o=l.lineNumber,s=l.column}return n.move(i,o,s,0)}static down(e,t,n,i,r,o,s){const a=M7.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+r,l=t.getLineCount(),c=n===l&&i===t.getLineMaxColumn(n);return(n+=o)>l?(n=l,i=s?t.getLineMaxColumn(n):Math.min(t.getLineMaxColumn(n),i)):i=M7.columnFromVisibleColumn2(e,t,n,a),r=c?0:a-M7.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),new Yie(n,i,r)}static moveDown(e,t,n,i,r){let o,s;n.hasSelection()&&!i?(o=n.selection.endLineNumber,s=n.selection.endColumn):(o=n.position.lineNumber,s=n.position.column);let a=Xie.down(e,t,o,s,n.leftoverVisibleColumns,r,!0);return n.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns)}static translateDown(e,t,n){let i=n.selection,r=Xie.down(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),o=Xie.down(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new k7(new TK(r.lineNumber,r.column,r.lineNumber,r.column),r.leftoverVisibleColumns,new IK(o.lineNumber,o.column),o.leftoverVisibleColumns)}static up(e,t,n,i,r,o,s){const a=M7.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize)+r,l=1===n&&1===i;return(n-=o)<1?(n=1,i=s?t.getLineMinColumn(n):Math.min(t.getLineMaxColumn(n),i)):i=M7.columnFromVisibleColumn2(e,t,n,a),r=l?0:a-M7.visibleColumnFromColumn(t.getLineContent(n),i,e.tabSize),new Yie(n,i,r)}static moveUp(e,t,n,i,r){let o,s;n.hasSelection()&&!i?(o=n.selection.startLineNumber,s=n.selection.startColumn):(o=n.position.lineNumber,s=n.position.column);let a=Xie.up(e,t,o,s,n.leftoverVisibleColumns,r,!0);return n.move(i,a.lineNumber,a.column,a.leftoverVisibleColumns)}static translateUp(e,t,n){let i=n.selection,r=Xie.up(e,t,i.selectionStartLineNumber,i.selectionStartColumn,n.selectionStartLeftoverVisibleColumns,1,!1),o=Xie.up(e,t,i.positionLineNumber,i.positionColumn,n.leftoverVisibleColumns,1,!1);return new k7(new TK(r.lineNumber,r.column,r.lineNumber,r.column),r.leftoverVisibleColumns,new IK(o.lineNumber,o.column),o.leftoverVisibleColumns)}static _isBlankLine(e,t){return 0===e.getLineFirstNonWhitespaceColumn(t)}static moveToPrevBlankLine(e,t,n,i){let r=n.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return n.move(i,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,n,i){const r=t.getLineCount();let o=n.position.lineNumber;for(;o<r&&this._isBlankLine(t,o);)o++;for(;o<r&&!this._isBlankLine(t,o);)o++;return n.move(i,o,t.getLineMinColumn(o),0)}static moveToBeginningOfLine(e,t,n,i){let r,o=n.position.lineNumber,s=t.getLineMinColumn(o),a=t.getLineFirstNonWhitespaceColumn(o)||s;return r=n.position.column===a?s:a,n.move(i,o,r,0)}static moveToEndOfLine(e,t,n,i,r){let o=n.position.lineNumber,s=t.getLineMaxColumn(o);return n.move(i,o,s,r?1073741824-s:0)}static moveToBeginningOfBuffer(e,t,n,i){return n.move(i,1,1,0)}static moveToEndOfBuffer(e,t,n,i){let r=t.getLineCount(),o=t.getLineMaxColumn(r);return n.move(i,r,o,0)}}class Zie{static deleteRight(e,t,n,i){let r=[],o=3!==e;for(let s=0,a=i.length;s<a;s++){const e=i[s];let a=e;if(a.isEmpty()){let i=e.getPosition(),r=Xie.right(t,n,i);a=new TK(r.lineNumber,r.column,i.lineNumber,i.column)}a.isEmpty()?r[s]=null:(a.startLineNumber!==a.endLineNumber&&(o=!0),r[s]=new jie(a,""))}return[o,r]}static isAutoClosingPairDelete(e,t,n,i,r,o,s){if("never"===t&&"never"===n)return!1;if("never"===e)return!1;for(let a=0,l=o.length;a<l;a++){const l=o[a],c=l.getPosition();if(!l.isEmpty())return!1;const u=r.getLineContent(c.lineNumber);if(c.column<2||c.column>=u.length+1)return!1;const h=u.charAt(c.column-2),d=i.get(h);if(!d)return!1;if(A7(h)){if("never"===n)return!1}else if("never"===t)return!1;const f=u.charAt(c.column-1);let g=!1;for(const e of d)e.open===h&&e.close===f&&(g=!0);if(!g)return!1;if("auto"===e){let e=!1;for(let t=0,n=s.length;t<n;t++){const n=s[t];if(c.lineNumber===n.startLineNumber&&c.column===n.startColumn){e=!0;break}}if(!e)return!1}}return!0}static _runAutoClosingPairDelete(e,t,n){let i=[];for(let r=0,o=n.length;r<o;r++){const e=n[r].getPosition(),t=new TK(e.lineNumber,e.column-1,e.lineNumber,e.column+1);i[r]=new jie(t,"")}return[!0,i]}static deleteLeft(e,t,n,i,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,n,i,r))return this._runAutoClosingPairDelete(t,n,i);const o=[];let s=2!==e;for(let a=0,l=i.length;a<l;a++){let e=Zie.getDeleteRange(i[a],n,t);e.isEmpty()?o[a]=null:(e.startLineNumber!==e.endLineNumber&&(s=!0),o[a]=new jie(e,""))}return[s,o]}static getDeleteRange(e,t,n){if(!e.isEmpty())return e;const i=e.getPosition();if(n.useTabStops&&i.column>1){const e=t.getLineContent(i.lineNumber),r=hX(e),o=-1===r?e.length+1:r+1;if(i.column<=o){const e=M7.visibleColumnFromColumn2(n,t,i),r=M7.prevIndentTabStop(e,n.indentSize),o=M7.columnFromVisibleColumn2(n,t,i.lineNumber,r);return new TK(i.lineNumber,o,i.lineNumber,i.column)}}return TK.fromPositions(Zie.getPositionAfterDeleteLeft(i,t),i)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const n=qX(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,n+1)}if(e.lineNumber>1){const n=e.lineNumber-1;return new IK(n,t.getLineMaxColumn(n))}return e}static cut(e,t,n){let i=[];for(let r=0,o=n.length;r<o;r++){const o=n[r];if(o.isEmpty())if(e.emptySelectionClipboard){let e,n,s,a,l=o.getPosition();l.lineNumber<t.getLineCount()?(e=l.lineNumber,n=1,s=l.lineNumber+1,a=1):l.lineNumber>1?(e=l.lineNumber-1,n=t.getLineMaxColumn(l.lineNumber-1),s=l.lineNumber,a=t.getLineMaxColumn(l.lineNumber)):(e=l.lineNumber,n=1,s=l.lineNumber,a=t.getLineMaxColumn(l.lineNumber));let c=new TK(e,n,s,a);c.isEmpty()?i[r]=null:i[r]=new jie(c,"")}else i[r]=null;else i[r]=new jie(o,"")}return new T7(0,i,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class Qie{static _createWord(e,t,n,i,r){return{start:i,end:r,wordType:t,nextCharClass:n}}static _findPreviousWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindPreviousWordOnLine(i,e,n)}static _doFindPreviousWordOnLine(e,t,n){let i=0;for(let r=n.column-2;r>=0;r--){let n=e.charCodeAt(r),o=t.get(n);if(0===o){if(2===i)return this._createWord(e,i,o,r+1,this._findEndOfWord(e,t,i,r+1));i=1}else if(2===o){if(1===i)return this._createWord(e,i,o,r+1,this._findEndOfWord(e,t,i,r+1));i=2}else if(1===o&&0!==i)return this._createWord(e,i,o,r+1,this._findEndOfWord(e,t,i,r+1))}return 0!==i?this._createWord(e,i,1,0,this._findEndOfWord(e,t,i,0)):null}static _findEndOfWord(e,t,n,i){let r=e.length;for(let o=i;o<r;o++){let i=e.charCodeAt(o),r=t.get(i);if(1===r)return o;if(1===n&&2===r)return o;if(2===n&&0===r)return o}return r}static _findNextWordOnLine(e,t,n){let i=t.getLineContent(n.lineNumber);return this._doFindNextWordOnLine(i,e,n)}static _doFindNextWordOnLine(e,t,n){let i=0,r=e.length;for(let o=n.column-1;o<r;o++){let n=e.charCodeAt(o),r=t.get(n);if(0===r){if(2===i)return this._createWord(e,i,r,this._findStartOfWord(e,t,i,o-1),o);i=1}else if(2===r){if(1===i)return this._createWord(e,i,r,this._findStartOfWord(e,t,i,o-1),o);i=2}else if(1===r&&0!==i)return this._createWord(e,i,r,this._findStartOfWord(e,t,i,o-1),o)}return 0!==i?this._createWord(e,i,1,this._findStartOfWord(e,t,i,r-1),r):null}static _findStartOfWord(e,t,n,i){for(let r=i;r>=0;r--){let i=e.charCodeAt(r),o=t.get(i);if(1===o)return r+1;if(1===n&&2===o)return r+1;if(2===n&&0===o)return r+1}return 0}static moveWordLeft(e,t,n,i){let r=n.lineNumber,o=n.column;1===o&&r>1&&(r-=1,o=t.getLineMaxColumn(r));let s=Qie._findPreviousWordOnLine(e,t,new IK(r,o));if(0===i)return new IK(r,s?s.start+1:1);if(1===i)return s&&2===s.wordType&&s.end-s.start==1&&0===s.nextCharClass&&(s=Qie._findPreviousWordOnLine(e,t,new IK(r,s.start+1))),new IK(r,s?s.start+1:1);if(3===i){for(;s&&2===s.wordType;)s=Qie._findPreviousWordOnLine(e,t,new IK(r,s.start+1));return new IK(r,s?s.start+1:1)}return s&&o<=s.end+1&&(s=Qie._findPreviousWordOnLine(e,t,new IK(r,s.start+1))),new IK(r,s?s.end+1:1)}static _moveWordPartLeft(e,t){const n=t.lineNumber,i=e.getLineMaxColumn(n);if(1===t.column)return n>1?new IK(n-1,e.getLineMaxColumn(n-1)):t;const r=e.getLineContent(n);for(let o=t.column-1;o>1;o--){const e=r.charCodeAt(o-2),t=r.charCodeAt(o-1);if(95===e&&95!==t)return new IK(n,o);if(yX(e)&&_X(t))return new IK(n,o);if(_X(e)&&_X(t)&&o+1<i){if(yX(r.charCodeAt(o)))return new IK(n,o)}}return new IK(n,1)}static moveWordRight(e,t,n,i){let r=n.lineNumber,o=n.column,s=!1;o===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(s=!0,r+=1,o=1);let a=Qie._findNextWordOnLine(e,t,new IK(r,o));if(2===i)a&&2===a.wordType&&a.end-a.start==1&&0===a.nextCharClass&&(a=Qie._findNextWordOnLine(e,t,new IK(r,a.end+1))),o=a?a.end+1:t.getLineMaxColumn(r);else if(3===i){for(s&&(o=0);a&&(2===a.wordType||a.start+1<=o);)a=Qie._findNextWordOnLine(e,t,new IK(r,a.end+1));o=a?a.start+1:t.getLineMaxColumn(r)}else a&&!s&&o>=a.start+1&&(a=Qie._findNextWordOnLine(e,t,new IK(r,a.end+1))),o=a?a.start+1:t.getLineMaxColumn(r);return new IK(r,o)}static _moveWordPartRight(e,t){const n=t.lineNumber,i=e.getLineMaxColumn(n);if(t.column===i)return n<e.getLineCount()?new IK(n+1,1):t;const r=e.getLineContent(n);for(let o=t.column+1;o<i;o++){const e=r.charCodeAt(o-2),t=r.charCodeAt(o-1);if(95!==e&&95===t)return new IK(n,o);if(yX(e)&&_X(t))return new IK(n,o);if(_X(e)&&_X(t)&&o+1<i){if(yX(r.charCodeAt(o)))return new IK(n,o)}}return new IK(n,i)}static _deleteWordLeftWhitespace(e,t){const n=e.getLineContent(t.lineNumber),i=t.column-2,r=fX(n,i);return r+1<i?new TK(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const n=e.wordSeparators,i=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(Zie.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const t=e.selection.getPosition();return new TK(t.lineNumber,t.column-1,t.lineNumber,t.column+1)}const s=new IK(r.positionLineNumber,r.positionColumn);let a=s.lineNumber,l=s.column;if(1===a&&1===l)return null;if(o){let e=this._deleteWordLeftWhitespace(i,s);if(e)return e}let c=Qie._findPreviousWordOnLine(n,i,s);return 0===t?c?l=c.start+1:l>1?l=1:(a--,l=i.getLineMaxColumn(a)):(c&&l<=c.end+1&&(c=Qie._findPreviousWordOnLine(n,i,new IK(a,c.start+1))),c?l=c.end+1:l>1?l=1:(a--,l=i.getLineMaxColumn(a))),new TK(a,l,s.lineNumber,s.column)}static deleteInsideWord(e,t,n){if(!n.isEmpty())return n;const i=new IK(n.positionLineNumber,n.positionColumn);let r=this._deleteInsideWordWhitespace(t,i);return r||this._deleteInsideWordDetermineDeleteRange(e,t,i)}static _charAtIsWhitespace(e,t){const n=e.charCodeAt(t);return 32===n||9===n}static _deleteInsideWordWhitespace(e,t){const n=e.getLineContent(t.lineNumber),i=n.length;if(0===i)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(n,r))return null;let o=Math.min(t.column-1,i-1);if(!this._charAtIsWhitespace(n,o))return null;for(;r>0&&this._charAtIsWhitespace(n,r-1);)r--;for(;o+1<i&&this._charAtIsWhitespace(n,o+1);)o++;return new TK(t.lineNumber,r+1,t.lineNumber,o+2)}static _deleteInsideWordDetermineDeleteRange(e,t,n){const i=t.getLineContent(n.lineNumber),r=i.length;if(0===r)return n.lineNumber>1?new TK(n.lineNumber-1,t.getLineMaxColumn(n.lineNumber-1),n.lineNumber,1):n.lineNumber<t.getLineCount()?new TK(n.lineNumber,1,n.lineNumber+1,1):new TK(n.lineNumber,1,n.lineNumber,1);const o=e=>e.start+1<=n.column&&n.column<=e.end+1,s=(e,t)=>(e=Math.min(e,n.column),t=Math.max(t,n.column),new TK(n.lineNumber,e,n.lineNumber,t)),a=e=>{let t=e.start+1,n=e.end+1,o=!1;for(;n-1<r&&this._charAtIsWhitespace(i,n-1);)o=!0,n++;if(!o)for(;t>1&&this._charAtIsWhitespace(i,t-2);)t--;return s(t,n)},l=Qie._findPreviousWordOnLine(e,t,n);if(l&&o(l))return a(l);const c=Qie._findNextWordOnLine(e,t,n);return c&&o(c)?a(c):l&&c?s(l.end+1,c.start+1):l?s(l.start+1,l.end+1):c?s(c.start+1,c.end+1):s(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const n=t.getPosition(),i=Qie._moveWordPartLeft(e,n);return new TK(n.lineNumber,n.column,i.lineNumber,i.column)}static _findFirstNonWhitespaceChar(e,t){let n=e.length;for(let i=t;i<n;i++){let t=e.charAt(i);if(" "!==t&&"\t"!==t)return i}return n}static _deleteWordRightWhitespace(e,t){const n=e.getLineContent(t.lineNumber),i=t.column-1,r=this._findFirstNonWhitespaceChar(n,i);return i+1<r?new TK(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){const n=e.wordSeparators,i=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;const s=new IK(r.positionLineNumber,r.positionColumn);let a=s.lineNumber,l=s.column;const c=i.getLineCount(),u=i.getLineMaxColumn(a);if(a===c&&l===u)return null;if(o){let e=this._deleteWordRightWhitespace(i,s);if(e)return e}let h=Qie._findNextWordOnLine(n,i,s);return 2===t?h?l=h.end+1:l<u||a===c?l=u:(a++,h=Qie._findNextWordOnLine(n,i,new IK(a,1)),l=h?h.start+1:i.getLineMaxColumn(a)):(h&&l>=h.start+1&&(h=Qie._findNextWordOnLine(n,i,new IK(a,h.end+1))),h?l=h.start+1:l<u||a===c?l=u:(a++,h=Qie._findNextWordOnLine(n,i,new IK(a,1)),l=h?h.start+1:i.getLineMaxColumn(a))),new TK(a,l,s.lineNumber,s.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const n=t.getPosition(),i=Qie._moveWordPartRight(e,n);return new TK(n.lineNumber,n.column,i.lineNumber,i.column)}static _createWordAtPosition(e,t,n){const i=new TK(t,n.start+1,t,n.end+1);return{word:e.getValueInRange(i),startColumn:i.startColumn,endColumn:i.endColumn}}static getWordAtPosition(e,t,n){const i=s8(t),r=Qie._findPreviousWordOnLine(i,e,n);if(r&&1===r.wordType&&r.start<=n.column-1&&n.column-1<=r.end)return Qie._createWordAtPosition(e,n.lineNumber,r);const o=Qie._findNextWordOnLine(i,e,n);return o&&1===o.wordType&&o.start<=n.column-1&&n.column-1<=o.end?Qie._createWordAtPosition(e,n.lineNumber,o):null}static word(e,t,n,i,r){const o=s8(e.wordSeparators);let s,a,l=Qie._findPreviousWordOnLine(o,t,r),c=Qie._findNextWordOnLine(o,t,r);if(!i){let e,n;return l&&1===l.wordType&&l.start<=r.column-1&&r.column-1<=l.end?(e=l.start+1,n=l.end+1):c&&1===c.wordType&&c.start<=r.column-1&&r.column-1<=c.end?(e=c.start+1,n=c.end+1):(e=l?l.end+1:1,n=c?c.start+1:t.getLineMaxColumn(r.lineNumber)),new k7(new TK(r.lineNumber,e,r.lineNumber,n),0,new IK(r.lineNumber,n),0)}l&&1===l.wordType&&l.start<r.column-1&&r.column-1<l.end?(s=l.start+1,a=l.end+1):c&&1===c.wordType&&c.start<r.column-1&&r.column-1<c.end?(s=c.start+1,a=c.end+1):(s=r.column,a=r.column);let u,h=r.lineNumber;if(n.selectionStart.containsPosition(r))u=n.selectionStart.endColumn;else if(r.isBeforeOrEqual(n.selectionStart.getStartPosition())){u=s;let e=new IK(h,u);n.selectionStart.containsPosition(e)&&(u=n.selectionStart.endColumn)}else{u=a;let e=new IK(h,u);n.selectionStart.containsPosition(e)&&(u=n.selectionStart.startColumn)}return n.move(!0,h,u,0)}}class Jie extends Qie{static deleteWordPartLeft(e){const t=ere([Qie.deleteWordLeft(e,0),Qie.deleteWordLeft(e,2),Qie._deleteWordPartLeft(e.model,e.selection)]);return t.sort(TK.compareRangesUsingEnds),t[2]}static deleteWordPartRight(e){const t=ere([Qie.deleteWordRight(e,0),Qie.deleteWordRight(e,2),Qie._deleteWordPartRight(e.model,e.selection)]);return t.sort(TK.compareRangesUsingStarts),t[0]}static moveWordPartLeft(e,t,n){const i=ere([Qie.moveWordLeft(e,t,n,0),Qie.moveWordLeft(e,t,n,2),Qie._moveWordPartLeft(t,n)]);return i.sort(IK.compare),i[2]}static moveWordPartRight(e,t,n){const i=ere([Qie.moveWordRight(e,t,n,0),Qie.moveWordRight(e,t,n,2),Qie._moveWordPartRight(t,n)]);return i.sort(IK.compare),i[0]}}function ere(e){return e.filter((e=>Boolean(e)))}class tre{static addCursorDown(e,t,n){let i=[],r=0;for(let o=0,s=t.length;o<s;o++){const s=t[o];i[r++]=new I7(s.modelState,s.viewState),i[r++]=n?I7.fromModelState(Xie.translateDown(e.cursorConfig,e.model,s.modelState)):I7.fromViewState(Xie.translateDown(e.cursorConfig,e,s.viewState))}return i}static addCursorUp(e,t,n){let i=[],r=0;for(let o=0,s=t.length;o<s;o++){const s=t[o];i[r++]=new I7(s.modelState,s.viewState),i[r++]=n?I7.fromModelState(Xie.translateUp(e.cursorConfig,e.model,s.modelState)):I7.fromViewState(Xie.translateUp(e.cursorConfig,e,s.viewState))}return i}static moveToBeginningOfLine(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r];i[r]=this._moveToLineStart(e,o,n)}return i}static _moveToLineStart(e,t,n){const i=t.viewState.position.column,r=i===t.modelState.position.column,o=t.viewState.position.lineNumber,s=e.getLineFirstNonWhitespaceColumn(o);return r||i===s?this._moveToLineStartByModel(e,t,n):this._moveToLineStartByView(e,t,n)}static _moveToLineStartByView(e,t,n){return I7.fromViewState(Xie.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,n))}static _moveToLineStartByModel(e,t,n){return I7.fromModelState(Xie.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,n))}static moveToEndOfLine(e,t,n,i){let r=[];for(let o=0,s=t.length;o<s;o++){const s=t[o];r[o]=this._moveToLineEnd(e,s,n,i)}return r}static _moveToLineEnd(e,t,n,i){const r=t.viewState.position,o=e.getLineMaxColumn(r.lineNumber),s=r.column===o,a=t.modelState.position,l=e.model.getLineMaxColumn(a.lineNumber),c=o-r.column==l-a.column;return s||c?this._moveToLineEndByModel(e,t,n,i):this._moveToLineEndByView(e,t,n,i)}static _moveToLineEndByView(e,t,n,i){return I7.fromViewState(Xie.moveToEndOfLine(e.cursorConfig,e,t.viewState,n,i))}static _moveToLineEndByModel(e,t,n,i){return I7.fromModelState(Xie.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,n,i))}static expandLineSelection(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i],o=r.modelState.selection.startLineNumber,s=e.model.getLineCount();let a,l=r.modelState.selection.endLineNumber;l===s?a=e.model.getLineMaxColumn(s):(l++,a=1),n[i]=I7.fromModelState(new k7(new TK(o,1,o,1),0,new IK(l,a),0))}return n}static moveToBeginningOfBuffer(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r];i[r]=I7.fromModelState(Xie.moveToBeginningOfBuffer(e.cursorConfig,e.model,o.modelState,n))}return i}static moveToEndOfBuffer(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r];i[r]=I7.fromModelState(Xie.moveToEndOfBuffer(e.cursorConfig,e.model,o.modelState,n))}return i}static selectAll(e,t){const n=e.model.getLineCount(),i=e.model.getLineMaxColumn(n);return I7.fromModelState(new k7(new TK(1,1,1,1),0,new IK(n,i),0))}static line(e,t,n,i,r){const o=e.model.validatePosition(i),s=r?e.coordinatesConverter.validateViewPosition(new IK(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);if(!n||!t.modelState.hasSelection()){const t=e.model.getLineCount();let n=o.lineNumber+1,i=1;return n>t&&(n=t,i=e.model.getLineMaxColumn(n)),I7.fromModelState(new k7(new TK(o.lineNumber,1,n,i),0,new IK(n,i),0))}const a=t.modelState.selectionStart.getStartPosition().lineNumber;if(o.lineNumber<a)return I7.fromViewState(t.viewState.move(t.modelState.hasSelection(),s.lineNumber,1,0));if(o.lineNumber>a){const n=e.getLineCount();let i=s.lineNumber+1,r=1;return i>n&&(i=n,r=e.getLineMaxColumn(i)),I7.fromViewState(t.viewState.move(t.modelState.hasSelection(),i,r,0))}{const e=t.modelState.selectionStart.getEndPosition();return I7.fromModelState(t.modelState.move(t.modelState.hasSelection(),e.lineNumber,e.column,0))}}static word(e,t,n,i){const r=e.model.validatePosition(i);return I7.fromModelState(Qie.word(e.cursorConfig,e.model,t.modelState,n,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new I7(t.modelState,t.viewState);const n=t.viewState.position.lineNumber,i=t.viewState.position.column;return I7.fromViewState(new k7(new TK(n,i,n,i),0,new IK(n,i),0))}static moveTo(e,t,n,i,r){const o=e.model.validatePosition(i),s=r?e.coordinatesConverter.validateViewPosition(new IK(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);return I7.fromViewState(t.viewState.move(n,s.lineNumber,s.column,0))}static simpleMove(e,t,n,i,r,o){switch(n){case 0:return 4===o?this._moveHalfLineLeft(e,t,i):this._moveLeft(e,t,i,r);case 1:return 4===o?this._moveHalfLineRight(e,t,i):this._moveRight(e,t,i,r);case 2:return 2===o?this._moveUpByViewLines(e,t,i,r):this._moveUpByModelLines(e,t,i,r);case 3:return 2===o?this._moveDownByViewLines(e,t,i,r):this._moveDownByModelLines(e,t,i,r);case 4:return 2===o?t.map((t=>I7.fromViewState(Xie.moveToPrevBlankLine(e.cursorConfig,e,t.viewState,i)))):t.map((t=>I7.fromModelState(Xie.moveToPrevBlankLine(e.cursorConfig,e.model,t.modelState,i))));case 5:return 2===o?t.map((t=>I7.fromViewState(Xie.moveToNextBlankLine(e.cursorConfig,e,t.viewState,i)))):t.map((t=>I7.fromModelState(Xie.moveToNextBlankLine(e.cursorConfig,e.model,t.modelState,i))));case 6:return this._moveToViewMinColumn(e,t,i);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,i);case 8:return this._moveToViewCenterColumn(e,t,i);case 9:return this._moveToViewMaxColumn(e,t,i);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,i);default:return null}}static viewportMove(e,t,n,i,r){const o=e.getCompletelyVisibleViewRange(),s=e.coordinatesConverter.convertViewRangeToModelRange(o);switch(n){case 11:{const n=this._firstLineNumberInRange(e.model,s,r),o=e.model.getLineFirstNonWhitespaceColumn(n);return[this._moveToModelPosition(e,t[0],i,n,o)]}case 13:{const n=this._lastLineNumberInRange(e.model,s,r),o=e.model.getLineFirstNonWhitespaceColumn(n);return[this._moveToModelPosition(e,t[0],i,n,o)]}case 12:{const n=Math.round((s.startLineNumber+s.endLineNumber)/2),r=e.model.getLineFirstNonWhitespaceColumn(n);return[this._moveToModelPosition(e,t[0],i,n,r)]}case 14:{let n=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];n[r]=this.findPositionInViewportIfOutside(e,s,o,i)}return n}default:return null}}static findPositionInViewportIfOutside(e,t,n,i){let r=t.viewState.position.lineNumber;if(n.startLineNumber<=r&&r<=n.endLineNumber-1)return new I7(t.modelState,t.viewState);{r>n.endLineNumber-1&&(r=n.endLineNumber-1),r<n.startLineNumber&&(r=n.startLineNumber);const o=e.getLineFirstNonWhitespaceColumn(r);return this._moveToViewPosition(e,t,i,r,o)}}static _firstLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.min(t.endLineNumber,i+n-1)}static _lastLineNumberInRange(e,t,n){let i=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(i)&&i++,Math.max(i,t.endLineNumber-n+1)}static _moveLeft(e,t,n,i){return t.map((t=>I7.fromViewState(Xie.moveLeft(e.cursorConfig,e,t.viewState,n,i))))}static _moveHalfLineLeft(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.viewState.position.lineNumber,a=Math.round(e.getLineContent(s).length/2);i[r]=I7.fromViewState(Xie.moveLeft(e.cursorConfig,e,o.viewState,n,a))}return i}static _moveRight(e,t,n,i){return t.map((t=>I7.fromViewState(Xie.moveRight(e.cursorConfig,e,t.viewState,n,i))))}static _moveHalfLineRight(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.viewState.position.lineNumber,a=Math.round(e.getLineContent(s).length/2);i[r]=I7.fromViewState(Xie.moveRight(e.cursorConfig,e,o.viewState,n,a))}return i}static _moveDownByViewLines(e,t,n,i){let r=[];for(let o=0,s=t.length;o<s;o++){const s=t[o];r[o]=I7.fromViewState(Xie.moveDown(e.cursorConfig,e,s.viewState,n,i))}return r}static _moveDownByModelLines(e,t,n,i){let r=[];for(let o=0,s=t.length;o<s;o++){const s=t[o];r[o]=I7.fromModelState(Xie.moveDown(e.cursorConfig,e.model,s.modelState,n,i))}return r}static _moveUpByViewLines(e,t,n,i){let r=[];for(let o=0,s=t.length;o<s;o++){const s=t[o];r[o]=I7.fromViewState(Xie.moveUp(e.cursorConfig,e,s.viewState,n,i))}return r}static _moveUpByModelLines(e,t,n,i){let r=[];for(let o=0,s=t.length;o<s;o++){const s=t[o];r[o]=I7.fromModelState(Xie.moveUp(e.cursorConfig,e.model,s.modelState,n,i))}return r}static _moveToViewPosition(e,t,n,i,r){return I7.fromViewState(t.viewState.move(n,i,r,0))}static _moveToModelPosition(e,t,n,i,r){return I7.fromModelState(t.modelState.move(n,i,r,0))}static _moveToViewMinColumn(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.viewState.position.lineNumber,a=e.getLineMinColumn(s);i[r]=this._moveToViewPosition(e,o,n,s,a)}return i}static _moveToViewFirstNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.viewState.position.lineNumber,a=e.getLineFirstNonWhitespaceColumn(s);i[r]=this._moveToViewPosition(e,o,n,s,a)}return i}static _moveToViewCenterColumn(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.viewState.position.lineNumber,a=Math.round((e.getLineMaxColumn(s)+e.getLineMinColumn(s))/2);i[r]=this._moveToViewPosition(e,o,n,s,a)}return i}static _moveToViewMaxColumn(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.viewState.position.lineNumber,a=e.getLineMaxColumn(s);i[r]=this._moveToViewPosition(e,o,n,s,a)}return i}static _moveToViewLastNonWhitespaceColumn(e,t,n){let i=[];for(let r=0,o=t.length;r<o;r++){const o=t[r],s=o.viewState.position.lineNumber,a=e.getLineLastNonWhitespaceColumn(s);i[r]=this._moveToViewPosition(e,o,n,s,a)}return i}}var nre,ire;(ire=nre||(nre={})).description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory logical position value providing where to move the cursor.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',\n\t\t\t\t\t\t'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'\n\t\t\t\t\t\t'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'\n\t\t\t\t\t\t'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'character', 'halfLine'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'select': If 'true' makes the selection. Default is 'false'.\n\t\t\t\t",constraint:function(e){if(!OZ(e))return!1;let t=e;return!(!AZ(t.to)||!FZ(t.select)&&!PZ(t.select)||!FZ(t.by)&&!AZ(t.by)||!FZ(t.value)&&!RZ(t.value))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},ire.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},ire.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"},ire.parse=function(e){if(!e.to)return null;let t;switch(e.to){case ire.RawDirection.Left:t=0;break;case ire.RawDirection.Right:t=1;break;case ire.RawDirection.Up:t=2;break;case ire.RawDirection.Down:t=3;break;case ire.RawDirection.PrevBlankLine:t=4;break;case ire.RawDirection.NextBlankLine:t=5;break;case ire.RawDirection.WrappedLineStart:t=6;break;case ire.RawDirection.WrappedLineFirstNonWhitespaceCharacter:t=7;break;case ire.RawDirection.WrappedLineColumnCenter:t=8;break;case ire.RawDirection.WrappedLineEnd:t=9;break;case ire.RawDirection.WrappedLineLastNonWhitespaceCharacter:t=10;break;case ire.RawDirection.ViewPortTop:t=11;break;case ire.RawDirection.ViewPortBottom:t=13;break;case ire.RawDirection.ViewPortCenter:t=12;break;case ire.RawDirection.ViewPortIfOutside:t=14;break;default:return null}let n=0;switch(e.by){case ire.RawUnit.Line:n=1;break;case ire.RawUnit.WrappedLine:n=2;break;case ire.RawUnit.Character:n=3;break;case ire.RawUnit.HalfLine:n=4}return{direction:t,unit:n,select:!!e.select,value:e.value||1}};const rre=Object.create(null);function ore(e,t){if(t<=0)return"";rre[e]||(rre[e]=["",e]);const n=rre[e];for(let i=n.length;i<=t;i++)n[i]=n[i-1]+e;return n[t]}class sre{constructor(e,t){this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,n,i,r){const o=M7.visibleColumnFromColumn(e,t,n);if(r){const e=ore(" ",i);return ore(e,M7.prevIndentTabStop(o,i)/i)}return ore("\t",M7.prevRenderTabStop(o,n)/n)}static shiftIndent(e,t,n,i,r){const o=M7.visibleColumnFromColumn(e,t,n);if(r){const e=ore(" ",i);return ore(e,M7.nextIndentTabStop(o,i)/i)}return ore("\t",M7.nextRenderTabStop(o,n)/n)}_addEditOperation(e,t,n){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,n):e.addEditOperation(t,n)}getEditOperations(e,t){const n=this._selection.startLineNumber;let i=this._selection.endLineNumber;1===this._selection.endColumn&&n!==i&&(i-=1);const{tabSize:r,indentSize:o,insertSpaces:s}=this._opts,a=n===i;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0);let l=0,c=0;for(let u=n;u<=i;u++,l=c){c=0;let i,h=e.getLineContent(u),d=hX(h);if((!this._opts.isUnshift||0!==h.length&&0!==d)&&(a||this._opts.isUnshift||0!==h.length)){if(-1===d&&(d=h.length),u>1){if(M7.visibleColumnFromColumn(h,d+1,r)%o!=0&&e.isCheapToTokenize(u-1)){let t=q0.getEnterAction(this._opts.autoIndent,e,new TK(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)));if(t){if(c=l,t.appendText)for(let e=0,n=t.appendText.length;e<n&&c<o&&32===t.appendText.charCodeAt(e);e++)c++;t.removeText&&(c=Math.max(0,c-t.removeText));for(let e=0;e<c&&(0!==d&&32===h.charCodeAt(d-1));e++)d--}}}this._opts.isUnshift&&0===d||(i=this._opts.isUnshift?sre.unshiftIndent(h,d+1,r,o,s):sre.shiftIndent(h,d+1,r,o,s),this._addEditOperation(t,new TK(u,1,u,d+1),i),u!==n||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=this._selection.startColumn<=d+1))}}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&0===e.getLineLength(n)&&(this._useLastEditRangeForCursorEndPosition=!0);const r=s?ore(" ",o):"\t";for(let s=n;s<=i;s++){const i=e.getLineContent(s);let l=hX(i);if((!this._opts.isUnshift||0!==i.length&&0!==l)&&((a||this._opts.isUnshift||0!==i.length)&&(-1===l&&(l=i.length),!this._opts.isUnshift||0!==l)))if(this._opts.isUnshift){l=Math.min(l,o);for(let e=0;e<l;e++){if(9===i.charCodeAt(e)){l=e+1;break}}this._addEditOperation(t,new TK(s,1,s,l+1),"")}else this._addEditOperation(t,new TK(s,1,s,1),r),s!==n||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=1===this._selection.startColumn)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let e=t.getInverseEditOperations()[0];return new MK(e.range.endLineNumber,e.range.endColumn,e.range.endLineNumber,e.range.endColumn)}const n=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let e=this._selection.startColumn;return n.startColumn<=e?n:0===n.getDirection()?new MK(n.startLineNumber,e,n.endLineNumber,n.endColumn):new MK(n.endLineNumber,n.endColumn,n.startLineNumber,e)}return n}}class are{constructor(e,t,n){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=n}getEditOperations(e,t){t.addTrackedEditOperation(new TK(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new TK(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let n=t.getInverseEditOperations(),i=n[0].range,r=n[1].range;return new MK(i.endLineNumber,i.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}}class lre{static indent(e,t,n){if(null===t||null===n)return[];let i=[];for(let r=0,o=n.length;r<o;r++)i[r]=new sre(n[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent});return i}static outdent(e,t,n){let i=[];for(let r=0,o=n.length;r<o;r++)i[r]=new sre(n[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent});return i}static shiftIndent(e,t,n){return n=n||1,sre.shiftIndent(t,t.length+n,e.tabSize,e.indentSize,e.insertSpaces)}static unshiftIndent(e,t,n){return n=n||1,sre.unshiftIndent(t,t.length+n,e.tabSize,e.indentSize,e.insertSpaces)}static _distributedPaste(e,t,n,i){let r=[];for(let o=0,s=n.length;o<s;o++)r[o]=new jie(n[o],i[o]);return new T7(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,n,i,r){let o=[];for(let s=0,a=n.length;s<a;s++){const e=n[s];let t=e.getPosition();if(r&&!e.isEmpty()&&(r=!1),r&&i.indexOf("\n")!==i.length-1&&(r=!1),r){let n=new TK(t.lineNumber,1,t.lineNumber,1);o[s]=new $ie(n,i,e,!0)}else o[s]=new jie(e,i)}return new T7(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(e,t,n,i,r){if(i)return null;if(1===t.length)return null;if(r&&r.length===t.length)return r;if("spread"===e.multiCursorPaste){10===n.charCodeAt(n.length-1)&&(n=n.substr(0,n.length-1)),13===n.charCodeAt(n.length-1)&&(n=n.substr(0,n.length-1));let e=uX(n);if(e.length===t.length)return e}return null}static paste(e,t,n,i,r,o){const s=this._distributePasteToCursors(e,n,i,r,o);return s?(n=n.sort(TK.compareRangesUsingStarts),this._distributedPaste(e,t,n,s)):this._simplePaste(e,t,n,i,r)}static _goodIndentForLine(e,t,n){let i=null,r="";const o=q0.getInheritIndentForLine(e.autoIndent,t,n,!1);if(o)i=o.action,r=o.indentation;else if(n>1){let i;for(i=n-1;i>=1;i--){if(fX(t.getLineContent(i))>=0)break}if(i<1)return null;const o=t.getLineMaxColumn(i),s=q0.getEnterAction(e.autoIndent,t,new TK(i,o,i,o));s&&(r=s.indentation+s.appendText)}return i&&(i===h0.Indent&&(r=lre.shiftIndent(e,r)),i===h0.Outdent&&(r=lre.unshiftIndent(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,n,i){let r="",o=n.getStartPosition();if(e.insertSpaces){let n=M7.visibleColumnFromColumn2(e,t,o),i=e.indentSize,s=i-n%i;for(let e=0;e<s;e++)r+=" "}else r="\t";return new jie(n,r,i)}static tab(e,t,n){let i=[];for(let r=0,o=n.length;r<o;r++){const o=n[r];if(o.isEmpty()){let n=t.getLineContent(o.startLineNumber);if(/^\s*$/.test(n)&&t.isCheapToTokenize(o.startLineNumber)){let s=this._goodIndentForLine(e,t,o.startLineNumber);s=s||"\t";let a=e.normalizeIndentation(s);if(!n.startsWith(a)){i[r]=new jie(new TK(o.startLineNumber,1,o.startLineNumber,n.length+1),a,!0);continue}}i[r]=this._replaceJumpToNextIndent(e,t,o,!0)}else{if(o.startLineNumber===o.endLineNumber){let n=t.getLineMaxColumn(o.startLineNumber);if(1!==o.startColumn||o.endColumn!==n){i[r]=this._replaceJumpToNextIndent(e,t,o,!1);continue}}i[r]=new sre(o,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent})}}return i}static compositionType(e,t,n,i,r,o,s,a){const l=i.map((e=>this._compositionType(n,e,r,o,s,a)));return new T7(4,l,{shouldPushStackElementBefore:hre(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,n,i,r,o){if(!t.isEmpty())return null;const s=t.getPosition(),a=Math.max(1,s.column-i),l=Math.min(e.getLineMaxColumn(s.lineNumber),s.column+r),c=new TK(s.lineNumber,a,s.lineNumber,l);return e.getValueInRange(c)===n&&0===o?null:new qie(c,n,0,o)}static _typeCommand(e,t,n){return n?new Kie(e,t,!0):new jie(e,t,!0)}static _enter(e,t,n,i){if(0===e.autoIndent)return lre._typeCommand(i,"\n",n);if(!t.isCheapToTokenize(i.getStartPosition().lineNumber)||1===e.autoIndent){let r=dX(t.getLineContent(i.startLineNumber)).substring(0,i.startColumn-1);return lre._typeCommand(i,"\n"+e.normalizeIndentation(r),n)}const r=q0.getEnterAction(e.autoIndent,t,i);if(r){if(r.indentAction===h0.None)return lre._typeCommand(i,"\n"+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===h0.Indent)return lre._typeCommand(i,"\n"+e.normalizeIndentation(r.indentation+r.appendText),n);if(r.indentAction===h0.IndentOutdent){const t=e.normalizeIndentation(r.indentation),o=e.normalizeIndentation(r.indentation+r.appendText),s="\n"+o+"\n"+t;return n?new Kie(i,s,!0):new qie(i,s,-1,o.length-t.length,!0)}if(r.indentAction===h0.Outdent){const t=lre.unshiftIndent(e,r.indentation);return lre._typeCommand(i,"\n"+e.normalizeIndentation(t+r.appendText),n)}}const o=dX(t.getLineContent(i.startLineNumber)).substring(0,i.startColumn-1);if(e.autoIndent>=4){const r=q0.getIndentForEnter(e.autoIndent,t,i,{unshiftIndent:t=>lre.unshiftIndent(e,t),shiftIndent:t=>lre.shiftIndent(e,t),normalizeIndentation:t=>e.normalizeIndentation(t)});if(r){let o=M7.visibleColumnFromColumn2(e,t,i.getEndPosition());const s=i.endColumn,a=hX(t.getLineContent(i.endLineNumber));if(i=a>=0?i.setEndPosition(i.endLineNumber,Math.max(i.endColumn,a+1)):i.setEndPosition(i.endLineNumber,t.getLineMaxColumn(i.endLineNumber)),n)return new Kie(i,"\n"+e.normalizeIndentation(r.afterEnter),!0);{let t=0;return s<=a+1&&(e.insertSpaces||(o=Math.ceil(o/e.indentSize)),t=Math.min(o+1-e.normalizeIndentation(r.afterEnter).length-1,0)),new qie(i,"\n"+e.normalizeIndentation(r.afterEnter),0,t,!0)}}}return lre._typeCommand(i,"\n"+e.normalizeIndentation(o),n)}static _isAutoIndentType(e,t,n){if(e.autoIndent<4)return!1;for(let i=0,r=n.length;i<r;i++)if(!t.isCheapToTokenize(n[i].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(e,t,n,i){const r=q0.getIndentationAtPosition(t,n.startLineNumber,n.startColumn),o=q0.getIndentActionForType(e.autoIndent,t,n,i,{shiftIndent:t=>lre.shiftIndent(e,t),unshiftIndent:t=>lre.unshiftIndent(e,t)});if(null===o)return null;if(o!==e.normalizeIndentation(r)){const r=t.getLineFirstNonWhitespaceColumn(n.startLineNumber);return 0===r?lre._typeCommand(new TK(n.startLineNumber,1,n.endLineNumber,n.endColumn),e.normalizeIndentation(o)+i,!1):lre._typeCommand(new TK(n.startLineNumber,1,n.endLineNumber,n.endColumn),e.normalizeIndentation(o)+t.getLineContent(n.startLineNumber).substring(r-1,n.startColumn-1)+i,!1)}return null}static _isAutoClosingOvertype(e,t,n,i,r){if("never"===e.autoClosingOvertype)return!1;if(!e.autoClosingPairs.autoClosingPairsCloseSingleChar.has(r))return!1;for(let o=0,s=n.length;o<s;o++){const s=n[o];if(!s.isEmpty())return!1;const a=s.getPosition(),l=t.getLineContent(a.lineNumber);if(l.charAt(a.column-1)!==r)return!1;const c=A7(r);if(92===(a.column>2?l.charCodeAt(a.column-2):0)&&c)return!1;if("auto"===e.autoClosingOvertype){let e=!1;for(let t=0,n=i.length;t<n;t++){const n=i[t];if(a.lineNumber===n.startLineNumber&&a.column===n.startColumn){e=!0;break}}if(!e)return!1}}return!0}static _runAutoClosingOvertype(e,t,n,i,r){let o=[];for(let s=0,a=i.length;s<a;s++){const e=i[s].getPosition(),t=new TK(e.lineNumber,e.column,e.lineNumber,e.column+1);o[s]=new jie(t,r)}return new T7(4,o,{shouldPushStackElementBefore:hre(e,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(e,t){const n=t.charAt(0),i=e.autoClosingPairs.autoClosingPairsOpenByStart.get(n)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(n)||[],o=i.some((e=>t.startsWith(e.open))),s=r.some((e=>t.startsWith(e.close)));return!o&&s}static _findAutoClosingPairOpen(e,t,n,i){const r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(i);if(!r)return null;let o=null;for(const s of r)if(null===o||s.open.length>o.open.length){let e=!0;for(const r of n){if(t.getValueInRange(new TK(r.lineNumber,r.column-s.open.length+1,r.lineNumber,r.column))+i!==s.open){e=!1;break}}e&&(o=s)}return o}static _findSubAutoClosingPairClose(e,t){if(t.open.length<=1)return"";const n=t.close.charAt(t.close.length-1),i=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(n)||[];let r=null;for(const o of i)o.open!==t.open&&t.open.includes(o.open)&&t.close.endsWith(o.close)&&(!r||o.open.length>r.open.length)&&(r=o);return r?r.close:""}static _getAutoClosingPairClose(e,t,n,i,r){const o=A7(i),s=o?e.autoClosingQuotes:e.autoClosingBrackets;if("never"===s)return null;const a=this._findAutoClosingPairOpen(e,t,n.map((e=>e.getPosition())),i);if(!a)return null;const l=this._findSubAutoClosingPairClose(e,a);let c=!0;const u=o?e.shouldAutoCloseBefore.quote:e.shouldAutoCloseBefore.bracket;for(let h=0,d=n.length;h<d;h++){const i=n[h];if(!i.isEmpty())return null;const d=i.getPosition(),f=t.getLineContent(d.lineNumber),g=f.substring(d.column-1);if(g.startsWith(l)||(c=!1),f.length>d.column-1){const t=f.charAt(d.column-1);if(!lre._isBeforeClosingBrace(e,g)&&!u(t))return null}if(!t.isCheapToTokenize(d.lineNumber))return null;if(1===a.open.length&&o&&"always"!==s){const t=s8(e.wordSeparators);if(r&&d.column>1&&0===t.get(f.charCodeAt(d.column-2)))return null;if(!r&&d.column>2&&0===t.get(f.charCodeAt(d.column-3)))return null}t.forceTokenization(d.lineNumber);const p=t.getLineTokens(d.lineNumber);let m=!1;try{m=q0.shouldAutoClosePair(a,p,r?d.column:d.column-1)}catch(zWe){nG(zWe)}if(!m)return null}return c?a.close.substring(0,a.close.length-l.length):a.close}static _runAutoClosingOpenCharType(e,t,n,i,r,o,s){let a=[];for(let l=0,c=i.length;l<c;l++){const e=i[l];a[l]=new cre(e,r,o,s)}return new T7(4,a,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(e,t){return A7(t)?"quotes"===e.autoSurround||"languageDefined"===e.autoSurround:"brackets"===e.autoSurround||"languageDefined"===e.autoSurround}static _isSurroundSelectionType(e,t,n,i){if(!lre._shouldSurroundChar(e,i)||!e.surroundingPairs.hasOwnProperty(i))return!1;const r=A7(i);for(let o=0,s=n.length;o<s;o++){const e=n[o];if(e.isEmpty())return!1;let i=!0;for(let n=e.startLineNumber;n<=e.endLineNumber;n++){const r=t.getLineContent(n),o=n===e.startLineNumber?e.startColumn-1:0,s=n===e.endLineNumber?e.endColumn-1:r.length,a=r.substring(o,s);if(/[^ \t]/.test(a)){i=!1;break}}if(i)return!1;if(r&&e.startLineNumber===e.endLineNumber&&e.startColumn+1===e.endColumn){if(A7(t.getValueInRange(e)))return!1}}return!0}static _runSurroundSelectionType(e,t,n,i,r){let o=[];for(let s=0,a=i.length;s<a;s++){const e=i[s],n=t.surroundingPairs[r];o[s]=new are(e,r,n)}return new T7(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(e,t,n){return!(1!==n.length||!t.isCheapToTokenize(n[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,n,i,r){if(!t.electricChars.hasOwnProperty(r)||!i.isEmpty())return null;let o=i.getPosition();n.forceTokenization(o.lineNumber);let s,a=n.getLineTokens(o.lineNumber);try{s=q0.onElectricCharacter(r,a,o.column)}catch(zWe){return nG(zWe),null}if(!s)return null;if(s.matchOpenBracket){let i=(a.getLineContent()+r).lastIndexOf(s.matchOpenBracket)+1,l=n.findMatchingBracketUp(s.matchOpenBracket,{lineNumber:o.lineNumber,column:i});if(l){if(l.startLineNumber===o.lineNumber)return null;let i=dX(n.getLineContent(l.startLineNumber)),s=t.normalizeIndentation(i),a=n.getLineContent(o.lineNumber),c=n.getLineFirstNonWhitespaceColumn(o.lineNumber)||o.column,u=s+a.substring(c-1,o.column-1)+r,h=new TK(o.lineNumber,1,o.lineNumber,o.column);const d=new jie(h,u);return new T7(ure(u,e),[d],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(e,t,n,i,r,o){if(!i||MK.selectionsArrEqual(i,r))return null;let s=null;for(const l of r){if(!l.isEmpty())return null;const e=l.getPosition(),t=n.getValueInRange(new TK(e.lineNumber,e.column-1,e.lineNumber,e.column));if(null===s)s=t;else if(s!==t)return null}if(!s)return null;if(this._isAutoClosingOvertype(t,n,r,o,s)){const e=r.map((e=>new jie(new TK(e.positionLineNumber,e.positionColumn,e.positionLineNumber,e.positionColumn+1),"",!1)));return new T7(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const a=this._getAutoClosingPairClose(t,n,r,s,!1);return null!==a?this._runAutoClosingOpenCharType(e,t,n,r,s,!1,a):null}static typeWithInterceptors(e,t,n,i,r,o,s){if(!e&&"\n"===s){let e=[];for(let t=0,o=r.length;t<o;t++)e[t]=lre._enter(n,i,!1,r[t]);return new T7(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoIndentType(n,i,r)){let e=[],t=!1;for(let o=0,a=r.length;o<a;o++)if(e[o]=this._runAutoIndentType(n,i,r[o],s),!e[o]){t=!0;break}if(!t)return new T7(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoClosingOvertype(n,i,r,o,s))return this._runAutoClosingOvertype(t,n,i,r,s);if(!e){const e=this._getAutoClosingPairClose(n,i,r,s,!0);if(e)return this._runAutoClosingOpenCharType(t,n,i,r,s,!0,e)}if(this._isSurroundSelectionType(n,i,r,s))return this._runSurroundSelectionType(t,n,i,r,s);if(!e&&this._isTypeInterceptorElectricChar(n,i,r)){const e=this._typeInterceptorElectricChar(t,n,i,r[0],s);if(e)return e}let a=[];for(let c=0,u=r.length;c<u;c++)a[c]=new jie(r[c],s);const l=ure(s,t);return new T7(l,a,{shouldPushStackElementBefore:hre(t,l),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(e,t,n,i,r){let o=[];for(let a=0,l=i.length;a<l;a++)o[a]=new jie(i[a],r);const s=ure(r,e);return new T7(s,o,{shouldPushStackElementBefore:hre(e,s),shouldPushStackElementAfter:!1})}static lineInsertBefore(e,t,n){if(null===t||null===n)return[];let i=[];for(let r=0,o=n.length;r<o;r++){let o=n[r].positionLineNumber;if(1===o)i[r]=new Kie(new TK(1,1,1,1),"\n");else{o--;let n=t.getLineMaxColumn(o);i[r]=this._enter(e,t,!1,new TK(o,n,o,n))}}return i}static lineInsertAfter(e,t,n){if(null===t||null===n)return[];let i=[];for(let r=0,o=n.length;r<o;r++){const o=n[r].positionLineNumber;let s=t.getLineMaxColumn(o);i[r]=this._enter(e,t,!1,new TK(o,s,o,s))}return i}static lineBreakInsert(e,t,n){let i=[];for(let r=0,o=n.length;r<o;r++)i[r]=this._enter(e,t,!0,n[r]);return i}}class cre extends qie{constructor(e,t,n,i){super(e,(n?t:"")+i,0,-i.length),this._openCharacter=t,this._closeCharacter=i,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return this.closeCharacterRange=new TK(n.startLineNumber,n.endColumn-this._closeCharacter.length,n.endLineNumber,n.endColumn),this.enclosingRange=new TK(n.startLineNumber,n.endColumn-this._openCharacter.length-this._closeCharacter.length,n.endLineNumber,n.endColumn),super.computeCursorState(e,t)}}function ure(e,t){return" "===e?5===t||6===t?6:5:4}function hre(e,t){return!(!fre(e)||fre(t))||5!==e&&dre(e)!==dre(t)}function dre(e){return 6===e||5===e?"space":e}function fre(e){return 4===e||5===e||6===e}var gre,pre;(pre=gre||(gre={})).editorSimpleInput=new M5("editorSimpleInput",!1,!0),pre.editorTextFocus=new M5("editorTextFocus",!1,GH(0,"Whether the editor text has focus (cursor is blinking)")),pre.focus=new M5("editorFocus",!1,GH(0,"Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),pre.textInputFocus=new M5("textInputFocus",!1,GH(0,"Whether an editor or a rich text input has focus (cursor is blinking)")),pre.readOnly=new M5("editorReadonly",!1,GH(0,"Whether the editor is read only")),pre.inDiffEditor=new M5("inDiffEditor",!1,GH(0,"Whether the context is a diff editor")),pre.columnSelection=new M5("editorColumnSelection",!1,GH(0,"Whether `editor.columnSelection` is enabled")),pre.writable=pre.readOnly.toNegated(),pre.hasNonEmptySelection=new M5("editorHasSelection",!1,GH(0,"Whether the editor has text selected")),pre.hasOnlyEmptySelection=pre.hasNonEmptySelection.toNegated(),pre.hasMultipleSelections=new M5("editorHasMultipleSelections",!1,GH(0,"Whether the editor has multiple selections")),pre.hasSingleSelection=pre.hasMultipleSelections.toNegated(),pre.tabMovesFocus=new M5("editorTabMovesFocus",!1,GH(0,"Whether `Tab` will move focus out of the editor")),pre.tabDoesNotMoveFocus=pre.tabMovesFocus.toNegated(),pre.isInWalkThroughSnippet=new M5("isInEmbeddedEditor",!1,!0),pre.canUndo=new M5("canUndo",!1,!0),pre.canRedo=new M5("canRedo",!1,!0),pre.hoverVisible=new M5("editorHoverVisible",!1,GH(0,"Whether the editor hover is visible")),pre.inCompositeEditor=new M5("inCompositeEditor",void 0,GH(0,"Whether the editor is part of a larger editor (e.g. notebooks)")),pre.notInCompositeEditor=pre.inCompositeEditor.toNegated(),pre.languageId=new M5("editorLangId","",GH(0,"The language identifier of the editor")),pre.hasCompletionItemProvider=new M5("editorHasCompletionItemProvider",!1,GH(0,"Whether the editor has a completion item provider")),pre.hasCodeActionsProvider=new M5("editorHasCodeActionsProvider",!1,GH(0,"Whether the editor has a code actions provider")),pre.hasCodeLensProvider=new M5("editorHasCodeLensProvider",!1,GH(0,"Whether the editor has a code lens provider")),pre.hasDefinitionProvider=new M5("editorHasDefinitionProvider",!1,GH(0,"Whether the editor has a definition provider")),pre.hasDeclarationProvider=new M5("editorHasDeclarationProvider",!1,GH(0,"Whether the editor has a declaration provider")),pre.hasImplementationProvider=new M5("editorHasImplementationProvider",!1,GH(0,"Whether the editor has an implementation provider")),pre.hasTypeDefinitionProvider=new M5("editorHasTypeDefinitionProvider",!1,GH(0,"Whether the editor has a type definition provider")),pre.hasHoverProvider=new M5("editorHasHoverProvider",!1,GH(0,"Whether the editor has a hover provider")),pre.hasDocumentHighlightProvider=new M5("editorHasDocumentHighlightProvider",!1,GH(0,"Whether the editor has a document highlight provider")),pre.hasDocumentSymbolProvider=new M5("editorHasDocumentSymbolProvider",!1,GH(0,"Whether the editor has a document symbol provider")),pre.hasReferenceProvider=new M5("editorHasReferenceProvider",!1,GH(0,"Whether the editor has a reference provider")),pre.hasRenameProvider=new M5("editorHasRenameProvider",!1,GH(0,"Whether the editor has a rename provider")),pre.hasSignatureHelpProvider=new M5("editorHasSignatureHelpProvider",!1,GH(0,"Whether the editor has a signature help provider")),pre.hasInlayHintsProvider=new M5("editorHasInlayHintsProvider",!1,GH(0,"Whether the editor has an inline hints provider")),pre.hasDocumentFormattingProvider=new M5("editorHasDocumentFormattingProvider",!1,GH(0,"Whether the editor has a document formatting provider")),pre.hasDocumentSelectionFormattingProvider=new M5("editorHasDocumentSelectionFormattingProvider",!1,GH(0,"Whether the editor has a document selection formatting provider")),pre.hasMultipleDocumentFormattingProvider=new M5("editorHasMultipleDocumentFormattingProvider",!1,GH(0,"Whether the editor has multiple document formatting providers")),pre.hasMultipleDocumentSelectionFormattingProvider=new M5("editorHasMultipleDocumentSelectionFormattingProvider",!1,GH(0,"Whether the editor has multiple document selection formatting providers"));class mre extends r6{runEditorCommand(e,t,n){const i=t._getViewModel();i&&this.runCoreEditorCommand(i,n||{})}}var vre,yre,_re,bre,wre;(yre=vre||(vre={})).description={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory direction value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'up', 'down'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'page', 'halfPage'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n\t\t\t\t",constraint:function(e){if(!OZ(e))return!1;const t=e;return!(!AZ(t.to)||!FZ(t.by)&&!AZ(t.by)||!FZ(t.value)&&!RZ(t.value)||!FZ(t.revealCursor)&&!PZ(t.revealCursor))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},yre.RawDirection={Up:"up",Down:"down"},yre.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage"},yre.parse=function(e){let t,n;switch(e.to){case yre.RawDirection.Up:t=1;break;case yre.RawDirection.Down:t=2;break;default:return null}switch(e.by){case yre.RawUnit.Line:n=1;break;case yre.RawUnit.WrappedLine:n=2;break;case yre.RawUnit.Page:n=3;break;case yre.RawUnit.HalfPage:n=4;break;default:n=2}return{direction:t,unit:n,value:Math.floor(e.value||1),revealCursor:!!e.revealCursor,select:!!e.select}},(bre=_re||(_re={})).description={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'lineNumber': A mandatory line number value.\n\t\t\t\t\t* 'at': Logical position at which line has to be revealed.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'top', 'center', 'bottom'\n\t\t\t\t\t\t```\n\t\t\t\t",constraint:function(e){if(!OZ(e))return!1;const t=e;return!(!RZ(t.lineNumber)&&!AZ(t.lineNumber)||!FZ(t.at)&&!AZ(t.at))},schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},bre.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"};class Cre{constructor(e){e.addImplementation(1e4,"code-editor",((e,t)=>{const n=e.get(o$).getFocusedCodeEditor();return!(!n||!n.hasTextFocus())&&this._runEditorCommand(e,n,t)})),e.addImplementation(1e3,"generic-dom-input-textarea",((e,t)=>{const n=document.activeElement;return!!(n&&["input","textarea"].indexOf(n.tagName.toLowerCase())>=0)&&(this.runDOMCommand(),!0)})),e.addImplementation(0,"generic-dom",((e,t)=>{const n=e.get(o$).getActiveCodeEditor();return!!n&&(n.focus(),this._runEditorCommand(e,n,t))}))}_runEditorCommand(e,t,n){const i=this.runEditorCommand(e,t,n);return i||!0}}!function(e){class t extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[tre.moveTo(e,e.getPrimaryCursorState(),this._inSelectionMode,t.position,t.viewPosition)]),e.revealPrimaryCursor(t.source,!0)}}e.MoveTo=l6(new t({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),e.MoveToSelect=l6(new t({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class n extends mre{runCoreEditorCommand(e,t){e.model.pushStackElement();const n=this._getColumnSelectResult(e,e.getPrimaryCursorState(),e.getCursorColumnSelectData(),t);e.setCursorStates(t.source,3,n.viewStates.map((e=>I7.fromViewState(e)))),e.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:n.fromLineNumber,fromViewVisualColumn:n.fromVisualColumn,toViewLineNumber:n.toLineNumber,toViewVisualColumn:n.toVisualColumn}),n.reversed?e.revealTopMostCursor(t.source):e.revealBottomMostCursor(t.source)}}e.ColumnSelect=l6(new class extends n{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(e,t,n,i){const r=e.model.validatePosition(i.position),o=e.coordinatesConverter.validateViewPosition(new IK(i.viewPosition.lineNumber,i.viewPosition.column),r);let s=i.doColumnSelect?n.fromViewLineNumber:o.lineNumber,a=i.doColumnSelect?n.fromViewVisualColumn:i.mouseColumn-1;return Hie.columnSelect(e.cursorConfig,e,s,a,o.lineNumber,i.mouseColumn-1)}}),e.CursorColumnSelectLeft=l6(new class extends n{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(e,t,n,i){return Hie.columnSelectLeft(e.cursorConfig,e,n)}}),e.CursorColumnSelectRight=l6(new class extends n{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(e,t,n,i){return Hie.columnSelectRight(e.cursorConfig,e,n)}});class i extends n{constructor(e){super(e),this._isPaged=e.isPaged}_getColumnSelectResult(e,t,n,i){return Hie.columnSelectUp(e.cursorConfig,e,n,this._isPaged)}}e.CursorColumnSelectUp=l6(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:3600,linux:{primary:0}}})),e.CursorColumnSelectPageUp=l6(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:3595,linux:{primary:0}}}));class r extends n{constructor(e){super(e),this._isPaged=e.isPaged}_getColumnSelectResult(e,t,n,i){return Hie.columnSelectDown(e.cursorConfig,e,n,this._isPaged)}}e.CursorColumnSelectDown=l6(new r({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:3602,linux:{primary:0}}})),e.CursorColumnSelectPageDown=l6(new r({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:3596,linux:{primary:0}}}));class o extends mre{constructor(){super({id:"cursorMove",precondition:void 0,description:nre.description})}runCoreEditorCommand(e,t){const n=nre.parse(t);n&&this._runCursorMove(e,t.source,n)}_runCursorMove(e,t,n){e.model.pushStackElement(),e.setCursorStates(t,3,o._move(e,e.getCursorStates(),n)),e.revealPrimaryCursor(t,!0)}static _move(e,t,n){const i=n.select,r=n.value;switch(n.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return tre.simpleMove(e,t,n.direction,i,r,n.unit);case 11:case 13:case 12:case 14:return tre.viewportMove(e,t,n.direction,i,r);default:return null}}}e.CursorMoveImpl=o,e.CursorMove=l6(new o);class s extends mre{constructor(e){super(e),this._staticArgs=e.args}runCoreEditorCommand(e,t){let n=this._staticArgs;-1===this._staticArgs.value&&(n={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:e.cursorConfig.pageSize}),e.model.pushStackElement(),e.setCursorStates(t.source,3,tre.simpleMove(e,e.getCursorStates(),n.direction,n.select,n.value,n.unit)),e.revealPrimaryCursor(t.source,!0)}}e.CursorLeft=l6(new s({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),e.CursorLeftSelect=l6(new s({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:1039}})),e.CursorRight=l6(new s({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),e.CursorRightSelect=l6(new s({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:1041}})),e.CursorUp=l6(new s({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),e.CursorUpSelect=l6(new s({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),e.CursorPageUp=l6(new s({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:11}})),e.CursorPageUpSelect=l6(new s({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:1035}})),e.CursorDown=l6(new s({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),e.CursorDownSelect=l6(new s({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),e.CursorPageDown=l6(new s({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:12}})),e.CursorPageDownSelect=l6(new s({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:1036}})),e.CreateCursor=l6(new class extends mre{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(e,t){let n;n=t.wholeLine?tre.line(e,e.getPrimaryCursorState(),!1,t.position,t.viewPosition):tre.moveTo(e,e.getPrimaryCursorState(),!1,t.position,t.viewPosition);const i=e.getCursorStates();if(i.length>1){const r=n.modelState?n.modelState.position:null,o=n.viewState?n.viewState.position:null;for(let n=0,s=i.length;n<s;n++){const s=i[n];if((!r||s.modelState.selection.containsPosition(r))&&(!o||s.viewState.selection.containsPosition(o)))return i.splice(n,1),e.model.pushStackElement(),void e.setCursorStates(t.source,3,i)}}i.push(n),e.model.pushStackElement(),e.setCursorStates(t.source,3,i)}}),e.LastCursorMoveToSelect=l6(new class extends mre{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(e,t){const n=e.getLastAddedCursorIndex(),i=e.getCursorStates(),r=i.slice(0);r[n]=tre.moveTo(e,i[n],!0,t.position,t.viewPosition),e.model.pushStackElement(),e.setCursorStates(t.source,3,r)}});class a extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,tre.moveToBeginningOfLine(e,e.getCursorStates(),this._inSelectionMode)),e.revealPrimaryCursor(t.source,!0)}}e.CursorHome=l6(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),e.CursorHomeSelect=l6(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,this._exec(e.getCursorStates())),e.revealPrimaryCursor(t.source,!0)}_exec(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],r=i.modelState.position.lineNumber;t[n]=I7.fromModelState(i.modelState.move(this._inSelectionMode,r,1,0))}return t}}e.CursorLineStart=l6(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:0,mac:{primary:287}}})),e.CursorLineStartSelect=l6(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,tre.moveToEndOfLine(e,e.getCursorStates(),this._inSelectionMode,t.sticky||!1)),e.revealPrimaryCursor(t.source,!0)}}e.CursorEnd=l6(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:0,kbExpr:gre.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},description:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:GH(0,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),e.CursorEndSelect=l6(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:0,kbExpr:gre.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},description:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:GH(0,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class u extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,this._exec(e,e.getCursorStates())),e.revealPrimaryCursor(t.source,!0)}_exec(e,t){const n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i],o=r.modelState.position.lineNumber,s=e.model.getLineMaxColumn(o);n[i]=I7.fromModelState(r.modelState.move(this._inSelectionMode,o,s,0))}return n}}e.CursorLineEnd=l6(new u({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:0,mac:{primary:291}}})),e.CursorLineEndSelect=l6(new u({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:0,mac:{primary:1315}}}));class h extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,tre.moveToBeginningOfBuffer(e,e.getCursorStates(),this._inSelectionMode)),e.revealPrimaryCursor(t.source,!0)}}e.CursorTop=l6(new h({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:2062,mac:{primary:2064}}})),e.CursorTopSelect=l6(new h({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:3086,mac:{primary:3088}}}));class d extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,tre.moveToEndOfBuffer(e,e.getCursorStates(),this._inSelectionMode)),e.revealPrimaryCursor(t.source,!0)}}e.CursorBottom=l6(new d({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:2061,mac:{primary:2066}}})),e.CursorBottomSelect=l6(new d({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:3085,mac:{primary:3090}}}));class f extends mre{constructor(){super({id:"editorScroll",precondition:void 0,description:vre.description})}runCoreEditorCommand(e,t){const n=vre.parse(t);n&&this._runEditorScroll(e,t.source,n)}_runEditorScroll(e,t,n){const i=this._computeDesiredScrollTop(e,n);if(n.revealCursor){const r=e.getCompletelyVisibleViewRangeAtScrollTop(i);e.setCursorStates(t,3,[tre.findPositionInViewportIfOutside(e,e.getPrimaryCursorState(),r,n.select)])}e.setScrollTop(i,0)}_computeDesiredScrollTop(e,t){if(1===t.unit){const n=e.getCompletelyVisibleViewRange(),i=e.coordinatesConverter.convertViewRangeToModelRange(n);let r;r=1===t.direction?Math.max(1,i.startLineNumber-t.value):Math.min(e.model.getLineCount(),i.startLineNumber+t.value);const o=e.coordinatesConverter.convertModelPositionToViewPosition(new IK(r,1));return e.getVerticalOffsetForLineNumber(o.lineNumber)}let n;n=3===t.unit?e.cursorConfig.pageSize*t.value:4===t.unit?Math.round(e.cursorConfig.pageSize/2)*t.value:t.value;const i=(1===t.direction?-1:1)*n;return e.getScrollTop()+i*e.cursorConfig.lineHeight}}e.EditorScrollImpl=f,e.EditorScroll=l6(new f),e.ScrollLineUp=l6(new class extends mre{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(t,n){e.EditorScroll._runEditorScroll(t,n.source,{direction:1,unit:2,value:1,revealCursor:!1,select:!1})}}),e.ScrollPageUp=l6(new class extends mre{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(t,n){e.EditorScroll._runEditorScroll(t,n.source,{direction:1,unit:3,value:1,revealCursor:!1,select:!1})}}),e.ScrollLineDown=l6(new class extends mre{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(t,n){e.EditorScroll._runEditorScroll(t,n.source,{direction:2,unit:2,value:1,revealCursor:!1,select:!1})}}),e.ScrollPageDown=l6(new class extends mre{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(t,n){e.EditorScroll._runEditorScroll(t,n.source,{direction:2,unit:3,value:1,revealCursor:!1,select:!1})}});class g extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[tre.word(e,e.getPrimaryCursorState(),this._inSelectionMode,t.position)]),e.revealPrimaryCursor(t.source,!0)}}e.WordSelect=l6(new g({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),e.WordSelectDrag=l6(new g({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),e.LastCursorWordSelect=l6(new class extends mre{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(e,t){const n=e.getLastAddedCursorIndex(),i=e.getCursorStates(),r=i.slice(0),o=i[n];r[n]=tre.word(e,o,o.modelState.hasSelection(),t.position),e.model.pushStackElement(),e.setCursorStates(t.source,3,r)}});class p extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[tre.line(e,e.getPrimaryCursorState(),this._inSelectionMode,t.position,t.viewPosition)]),e.revealPrimaryCursor(t.source,!1)}}e.LineSelect=l6(new p({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),e.LineSelectDrag=l6(new p({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class m extends mre{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){const n=e.getLastAddedCursorIndex(),i=e.getCursorStates(),r=i.slice(0);r[n]=tre.line(e,i[n],this._inSelectionMode,t.position,t.viewPosition),e.model.pushStackElement(),e.setCursorStates(t.source,3,r)}}e.LastCursorLineSelect=l6(new m({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),e.LastCursorLineSelectDrag=l6(new m({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),e.ExpandLineSelection=l6(new class extends mre{constructor(){super({id:"expandLineSelection",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:2090}})}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,tre.expandLineSelection(e,e.getCursorStates())),e.revealPrimaryCursor(t.source,!0)}}),e.CancelSelection=l6(new class extends mre{constructor(){super({id:"cancelSelection",precondition:gre.hasNonEmptySelection,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[tre.cancelSelection(e,e.getPrimaryCursorState())]),e.revealPrimaryCursor(t.source,!0)}}),e.RemoveSecondaryCursors=l6(new class extends mre{constructor(){super({id:"removeSecondaryCursors",precondition:gre.hasMultipleSelections,kbOpts:{weight:1,kbExpr:gre.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[e.getPrimaryCursorState()]),e.revealPrimaryCursor(t.source,!0),n5(GH(0,"Removed secondary cursors"))}}),e.RevealLine=l6(new class extends mre{constructor(){super({id:"revealLine",precondition:void 0,description:_re.description})}runCoreEditorCommand(e,t){const n=t,i=n.lineNumber||0;let r="number"==typeof i?i+1:parseInt(i)+1;r<1&&(r=1);const o=e.model.getLineCount();r>o&&(r=o);const s=new TK(r,1,r,e.model.getLineMaxColumn(r));let a=0;if(n.at)switch(n.at){case _re.RawAtArgument.Top:a=3;break;case _re.RawAtArgument.Center:a=1;break;case _re.RawAtArgument.Bottom:a=4}const l=e.coordinatesConverter.convertModelRangeToViewRange(s);e.revealRange(t.source,!1,l,a,0)}}),e.SelectAll=new class extends Cre{constructor(){super(_6)}runDOMCommand(){h$&&(document.activeElement.focus(),document.activeElement.select()),document.execCommand("selectAll")}runEditorCommand(e,t,n){const i=t._getViewModel();i&&this.runCoreEditorCommand(i,n)}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates("keyboard",3,[tre.selectAll(e,e.getPrimaryCursorState())])}},e.SetSelection=l6(new class extends mre{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[I7.fromModelSelection(t.selection)])}})}(wre||(wre={}));const Sre=g5.and(gre.textInputFocus,gre.columnSelection);function xre(e,t){o4.registerKeybindingRule({id:e,primary:t,when:Sre,weight:1})}function Ere(e){return e.register(),e}var kre,Lre;xre(wre.CursorColumnSelectLeft.id,1039),xre(wre.CursorColumnSelectRight.id,1041),xre(wre.CursorColumnSelectUp.id,1040),xre(wre.CursorColumnSelectPageUp.id,1035),xre(wre.CursorColumnSelectDown.id,1042),xre(wre.CursorColumnSelectPageDown.id,1036),function(e){class t extends r6{runEditorCommand(e,t,n){const i=t._getViewModel();i&&this.runCoreEditingCommand(t,i,n||{})}}e.CoreEditingCommand=t,e.LineBreakInsert=l6(new class extends t{constructor(){super({id:"lineBreakInsert",precondition:gre.writable,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(e,t,n){e.pushUndoStop(),e.executeCommands(this.id,lre.lineBreakInsert(t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection))))}}),e.Outdent=l6(new class extends t{constructor(){super({id:"outdent",precondition:gre.writable,kbOpts:{weight:0,kbExpr:g5.and(gre.editorTextFocus,gre.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(e,t,n){e.pushUndoStop(),e.executeCommands(this.id,lre.outdent(t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection)))),e.pushUndoStop()}}),e.Tab=l6(new class extends t{constructor(){super({id:"tab",precondition:gre.writable,kbOpts:{weight:0,kbExpr:g5.and(gre.editorTextFocus,gre.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(e,t,n){e.pushUndoStop(),e.executeCommands(this.id,lre.tab(t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection)))),e.pushUndoStop()}}),e.DeleteLeft=l6(new class extends t{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(e,t,n){const[i,r]=Zie.deleteLeft(t.getPrevEditOperationType(),t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection)),t.getCursorAutoClosedCharacters());i&&e.pushUndoStop(),e.executeCommands(this.id,r),t.setPrevEditOperationType(2)}}),e.DeleteRight=l6(new class extends t{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:0,kbExpr:gre.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(e,t,n){const[i,r]=Zie.deleteRight(t.getPrevEditOperationType(),t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection)));i&&e.pushUndoStop(),e.executeCommands(this.id,r),t.setPrevEditOperationType(3)}}),e.Undo=new class extends Cre{constructor(){super(v6)}runDOMCommand(){document.execCommand("undo")}runEditorCommand(e,t,n){if(t.hasModel()&&!0!==t.getOption(78))return t.getModel().undo()}},e.Redo=new class extends Cre{constructor(){super(y6)}runDOMCommand(){document.execCommand("redo")}runEditorCommand(e,t,n){if(t.hasModel()&&!0!==t.getOption(78))return t.getModel().redo()}}}(kre||(kre={}));class Dre extends t6{constructor(e,t,n){super({id:e,precondition:void 0,description:n}),this._handlerId=t}runCommand(e,t){const n=e.get(o$).getFocusedCodeEditor();n&&n.trigger("keyboard",this._handlerId,t)}}function Nre(e,t){Ere(new Dre("default:"+e,e)),Ere(new Dre(e,e,t))}Nre("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]}),Nre("replacePreviousChar"),Nre("compositionType"),Nre("compositionStart"),Nre("compositionEnd"),Nre("paste"),Nre("cut");class Ire{constructor(e,t,n,i){this.configuration=e,this.viewModel=t,this.userInputEvents=n,this.commandDelegate=i}paste(e,t,n,i){this.commandDelegate.paste(e,t,n,i)}type(e){this.commandDelegate.type(e)}compositionType(e,t,n,i){this.commandDelegate.compositionType(e,t,n,i)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){wre.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new IK(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(67)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(67)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,n=cj&&t.get(94),i=t.get(16);e.middleButton&&!n?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position):this._lineSelect(e.position):e.mouseDownCount>=4?this._selectAll():3===e.mouseDownCount?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position):this._lastCursorLineSelect(e.position):e.inSelectionMode?this._lineSelectDrag(e.position):this._lineSelect(e.position):2===e.mouseDownCount?this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position):e.inSelectionMode?this._wordSelectDrag(e.position):this._wordSelect(e.position):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey||i?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position):this.moveTo(e.position)}_usualArgs(e){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e}}moveTo(e){wre.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_moveToSelect(e){wre.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_columnSelect(e,t,n){e=this._validateViewColumn(e),wre.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:n})}_createCursor(e,t){e=this._validateViewColumn(e),wre.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e){wre.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_wordSelect(e){wre.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_wordSelectDrag(e){wre.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorWordSelect(e){wre.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lineSelect(e){wre.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lineSelectDrag(e){wre.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorLineSelect(e){wre.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorLineSelectDrag(e){wre.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_selectAll(){wre.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class Tre{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown&&this.onKeyDown(e)}emitKeyUp(e){this.onKeyUp&&this.onKeyUp(e)}emitContextMenu(e){this.onContextMenu&&this.onContextMenu(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove&&this.onMouseMove(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave&&this.onMouseLeave(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown&&this.onMouseDown(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp&&this.onMouseUp(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag&&this.onMouseDrag(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop&&this.onMouseDrop(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled&&this.onMouseDropCanceled()}emitMouseWheel(e){this.onMouseWheel&&this.onMouseWheel(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return Tre.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){return new Mre(e.element,e.type,e.mouseColumn,e.position?t.convertViewPositionToModelPosition(e.position):null,e.range?t.convertViewRangeToModelRange(e.range):null,e.detail)}}class Mre{constructor(e,t,n,i,r,o){this.element=e,this.type=t,this.mouseColumn=n,this.position=i,this.range=r,this.detail=o}toString(){return W7.toString(this)}}class Are{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Error("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(0===this.getCount())return null;const n=this.getStartLineNumber(),i=this.getEndLineNumber();if(t<n){const n=t-e+1;return this._rendLineNumberStart-=n,null}if(e>i)return null;let r=0,o=0;for(let s=n;s<=i;s++){const n=s-this._rendLineNumberStart;e<=s&&s<=t&&(0===o?(r=n,o=1):o++)}if(e<n){let i=0;i=t<n?t-e+1:n-e,this._rendLineNumberStart-=i}return this._lines.splice(r,o)}onLinesChanged(e,t){if(0===this.getCount())return!1;const n=this.getStartLineNumber(),i=this.getEndLineNumber();let r=!1;for(let o=e;o<=t;o++)o>=n&&o<=i&&(this._lines[o-this._rendLineNumberStart].onContentChanged(),r=!0);return r}onLinesInserted(e,t){if(0===this.getCount())return null;const n=t-e+1,i=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=i)return this._rendLineNumberStart+=n,null;if(e>r)return null;if(n+e>r){return this._lines.splice(e-this._rendLineNumberStart,r-e+1)}const o=[];for(let u=0;u<n;u++)o[u]=this._createLine();const s=e-this._rendLineNumberStart,a=this._lines.slice(0,s),l=this._lines.slice(s,this._lines.length-n),c=this._lines.slice(this._lines.length-n,this._lines.length);return this._lines=a.concat(o).concat(l),c}onTokensChanged(e){if(0===this.getCount())return!1;const t=this.getStartLineNumber(),n=this.getEndLineNumber();let i=!1;for(let r=0,o=e.length;r<o;r++){const o=e[r];if(o.toLineNumber<t||o.fromLineNumber>n)continue;const s=Math.max(t,o.fromLineNumber),a=Math.min(n,o.toLineNumber);for(let e=s;e<=a;e++){const t=e-this._rendLineNumberStart;this._lines[t].onTokensChanged(),i=!0}}return i}}class Ore{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new Are((()=>this._host.createVisibleLine()))}_createDomNode(){const e=I6(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(128)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++){const e=t[n].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let n=0,i=t.length;n<i;n++){const e=t[n].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),n=new Rre(this.domNode.domNode,this._host,e),i={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=n.render(i,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}}class Rre{constructor(e,t,n){this.domNode=e,this.host=t,this.viewportData=n}render(e,t,n,i){const r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||n<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=n-t+1,r.lines=[];for(let e=t;e<=n;e++)r.lines[e-t]=this.host.createVisibleLine();return this._finishRendering(r,!0,i),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(n-r.rendLineNumberStart,r.linesLength-1),i,t),r.rendLineNumberStart>t){const e=t,o=Math.min(n,r.rendLineNumberStart-1);e<=o&&(this._insertLinesBefore(r,e,o,i,t),r.linesLength+=o-e+1)}else if(r.rendLineNumberStart<t){const e=Math.min(r.linesLength,t-r.rendLineNumberStart);e>0&&(this._removeLinesBefore(r,e),r.linesLength-=e)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<n){const e=r.rendLineNumberStart+r.linesLength,o=n;e<=o&&(this._insertLinesAfter(r,e,o,i,t),r.linesLength+=o-e+1)}else if(r.rendLineNumberStart+r.linesLength-1>n){const e=Math.max(0,n-r.rendLineNumberStart+1),t=r.linesLength-1-e+1;t>0&&(this._removeLinesAfter(r,t),r.linesLength-=t)}return this._finishRendering(r,!1,i),r}_renderUntouchedLines(e,t,n,i,r){const o=e.rendLineNumberStart,s=e.lines;for(let a=t;a<=n;a++){const e=o+a;s[a].layoutLine(e,i[e-r])}}_insertLinesBefore(e,t,n,i,r){const o=[];let s=0;for(let a=t;a<=n;a++)o[s++]=this.host.createVisibleLine();e.lines=o.concat(e.lines)}_removeLinesBefore(e,t){for(let n=0;n<t;n++){const t=e.lines[n].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(0,t)}_insertLinesAfter(e,t,n,i,r){const o=[];let s=0;for(let a=t;a<=n;a++)o[s++]=this.host.createVisibleLine();e.lines=e.lines.concat(o)}_removeLinesAfter(e,t){const n=e.linesLength-t;for(let i=0;i<t;i++){const t=e.lines[n+i].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(n,t)}_finishRenderingNewLines(e,t,n,i){Rre._ttPolicy&&(n=Rre._ttPolicy.createHTML(n));const r=this.domNode.lastChild;t||!r?this.domNode.innerHTML=n:r.insertAdjacentHTML("afterend",n);let o=this.domNode.lastChild;for(let s=e.linesLength-1;s>=0;s--){const t=e.lines[s];i[s]&&(t.setDomNode(o),o=o.previousSibling)}}_finishRenderingInvalidLines(e,t,n){const i=document.createElement("div");Rre._ttPolicy&&(t=Rre._ttPolicy.createHTML(t)),i.innerHTML=t;for(let r=0;r<e.linesLength;r++){const t=e.lines[r];if(n[r]){const e=i.firstChild,n=t.getDomNode();n.parentNode.replaceChild(e,n),t.setDomNode(e)}}}_finishRendering(e,t,n){const i=Rre._sb,r=e.linesLength,o=e.lines,s=e.rendLineNumberStart,a=[];{i.reset();let l=!1;for(let e=0;e<r;e++){const t=o[e];a[e]=!1;if(t.getDomNode())continue;t.renderLine(e+s,n[e],this.viewportData,i)&&(a[e]=!0,l=!0)}l&&this._finishRenderingNewLines(e,t,i.build(),a)}{i.reset();let t=!1;const l=[];for(let e=0;e<r;e++){const r=o[e];if(l[e]=!1,a[e])continue;r.renderLine(e+s,n[e],this.viewportData,i)&&(l[e]=!0,t=!0)}t&&this._finishRenderingInvalidLines(e,i.build(),l)}}}Rre._ttPolicy=null===(Lre=window.trustedTypes)||void 0===Lre?void 0:Lre.createPolicy("editorViewLayer",{createHTML:e=>e}),Rre._sb=E0(1e5);class Pre extends K6{constructor(e){super(e),this._visibleLines=new Ore(this),this.domNode=this._visibleLines.domNode,this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++){if(this._dynamicOverlays[e].shouldRender())return!0}return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++){this._dynamicOverlays[e].dispose()}this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new Fre(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){this._visibleLines.getVisibleLine(i).onConfigurationChanged(e)}return!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter((e=>e.shouldRender()));for(let n=0,i=t.length;n<i;n++){const i=t[n];i.prepareRender(e),i.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class Fre{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.options.get(56),this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=I6(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(56)}renderLine(e,t,n,i){let r="";for(let o=0,s=this._dynamicOverlays.length;o<s;o++){r+=this._dynamicOverlays[o].render(n.startLineNumber,e)}return this._renderedContent!==r&&(this._renderedContent=r,i.appendASCIIString('<div style="position:absolute;top:'),i.appendASCIIString(String(t)),i.appendASCIIString("px;width:100%;height:"),i.appendASCIIString(String(this._lineHeight)),i.appendASCIIString('px;">'),i.appendASCIIString(r),i.appendASCIIString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class Bre extends Pre{constructor(e){super(e);const t=this._context.configuration.options.get(128);this._contentWidth=t.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const t=this._context.configuration.options.get(128);return this._contentWidth=t.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class Wre extends Pre{constructor(e){super(e);const t=this._context.configuration.options,n=t.get(128);this._contentLeft=n.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),D6.applyFontInfo(this.domNode,t.get(40))}onConfigurationChanged(e){const t=this._context.configuration.options;D6.applyFontInfo(this.domNode,t.get(40));const n=t.get(128);return this._contentLeft=n.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class zre{constructor(e,t){this._coordinateBrand=void 0,this.top=e,this.left=t}}class Vre extends K6{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=I6(document.createElement("div")),q6.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=I6(document.createElement("div")),q6.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const n of t)this._widgets[n].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){const t=Object.keys(this._widgets);for(const n of t)this._widgets[n].onLineMappingChanged(e);return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}addWidget(e){const t=new Ure(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,n){this._widgets[e.getId()].setPosition(t,n),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const e=this._widgets[t];delete this._widgets[t];const n=e.domNode.domNode;n.parentNode.removeChild(n),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return!!this._widgets.hasOwnProperty(e)&&this._widgets[e].suppressMouseDown}onBeforeRender(e){const t=Object.keys(this._widgets);for(const n of t)this._widgets[n].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const n of t)this._widgets[n].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const n of t)this._widgets[n].render(e)}}class Ure{constructor(e,t,n){this._context=e,this._viewDomNode=t,this._actual=n,this.domNode=I6(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const i=this._context.configuration.options,r=i.get(128);this._fixedOverflowWidgets=i.get(34),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=i.get(56),this._range=null,this._viewRange=null,this._preference=[],this._cachedDomNodeClientWidth=-1,this._cachedDomNodeClientHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(this._lineHeight=t.get(56),e.hasChanged(128)){const e=t.get(128);this._contentLeft=e.contentLeft,this._contentWidth=e.contentWidth,this._maxWidth=this._getMaxWidth()}}onLineMappingChanged(e){this._setPosition(this._range)}_setPosition(e){if(this._range=e,this._viewRange=null,this._range){const e=this._context.model.validateModelRange(this._range);(this._context.model.coordinatesConverter.modelPositionIsVisible(e.getStartPosition())||this._context.model.coordinatesConverter.modelPositionIsVisible(e.getEndPosition()))&&(this._viewRange=this._context.model.coordinatesConverter.convertModelRangeToViewRange(e))}}_getMaxWidth(){return this.allowEditorOverflow?window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth:this._contentWidth}setPosition(e,t){this._setPosition(e),this._preference=t,this._cachedDomNodeClientWidth=-1,this._cachedDomNodeClientHeight=-1}_layoutBoxInViewport(e,t,n,i,r){const o=e.top,s=o,a=t.top+this._lineHeight,l=o-i,c=s>=i,u=a,h=r.viewportHeight-a>=i;let d=e.left,f=t.left;return d+n>r.scrollLeft+r.viewportWidth&&(d=r.scrollLeft+r.viewportWidth-n),f+n>r.scrollLeft+r.viewportWidth&&(f=r.scrollLeft+r.viewportWidth-n),d<r.scrollLeft&&(d=r.scrollLeft),f<r.scrollLeft&&(f=r.scrollLeft),{fitsAbove:c,aboveTop:l,aboveLeft:d,fitsBelow:h,belowTop:u,belowLeft:f}}_layoutHorizontalSegmentInPage(e,t,n,i){const r=Math.max(0,t.left-i),o=Math.min(t.left+t.width+i,e.width);let s=t.left+n-vY.scrollX;if(s+i>o){const e=s-(o-i);s-=e,n-=e}if(s<r){const e=s-r;s-=e,n-=e}return[n,s]}_layoutBoxInPage(e,t,n,i,r){const o=e.top-i,s=t.top+this._lineHeight,a=mY(this._viewDomNode.domNode),l=a.top+o-vY.scrollY,c=a.top+s-vY.scrollY,u=dY(document.body),[h,d]=this._layoutHorizontalSegmentInPage(u,a,e.left-r.scrollLeft+this._contentLeft,n),[f,g]=this._layoutHorizontalSegmentInPage(u,a,t.left-r.scrollLeft+this._contentLeft,n),p=l>=22,m=c+i<=u.height-22;return this._fixedOverflowWidgets?{fitsAbove:p,aboveTop:Math.max(l,22),aboveLeft:d,fitsBelow:m,belowTop:c,belowLeft:g}:{fitsAbove:p,aboveTop:o,aboveLeft:h,fitsBelow:m,belowTop:s,belowLeft:f}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new zre(e.top,e.left+this._contentLeft)}_getTopAndBottomLeft(e){if(!this._viewRange)return[null,null];const t=e.linesVisibleRangesForRange(this._viewRange,!1);if(!t||0===t.length)return[null,null];let n=t[0],i=t[0];for(const c of t)c.lineNumber<n.lineNumber&&(n=c),c.lineNumber>i.lineNumber&&(i=c);let r=1073741824;for(const c of n.ranges)c.left<r&&(r=c.left);let o=1073741824;for(const c of i.ranges)c.left<o&&(o=c.left);const s=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.scrollTop,a=new zre(s,r),l=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.scrollTop;return[a,new zre(l,o)]}_prepareRenderWidget(e){const[t,n]=this._getTopAndBottomLeft(e);if(!t||!n)return null;if(-1===this._cachedDomNodeClientWidth||-1===this._cachedDomNodeClientHeight){let e=null;if("function"==typeof this._actual.beforeRender&&(e=Hre(this._actual.beforeRender,this._actual)),e)this._cachedDomNodeClientWidth=e.width,this._cachedDomNodeClientHeight=e.height;else{const e=this.domNode.domNode;this._cachedDomNodeClientWidth=e.clientWidth,this._cachedDomNodeClientHeight=e.clientHeight}}let i;if(i=this.allowEditorOverflow?this._layoutBoxInPage(t,n,this._cachedDomNodeClientWidth,this._cachedDomNodeClientHeight,e):this._layoutBoxInViewport(t,n,this._cachedDomNodeClientWidth,this._cachedDomNodeClientHeight,e),this._preference)for(let r=1;r<=2;r++)for(const e of this._preference)if(1===e){if(!i)return null;if(2===r||i.fitsAbove)return{coordinate:new zre(i.aboveTop,i.aboveLeft),position:1}}else{if(2!==e)return this.allowEditorOverflow?{coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(t),position:0}:{coordinate:t,position:0};if(!i)return null;if(2===r||i.fitsBelow)return{coordinate:new zre(i.belowTop,i.belowLeft),position:2}}return null}onBeforeRender(e){this._viewRange&&this._preference&&(this._viewRange.endLineNumber<e.startLineNumber||this._viewRange.startLineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth))}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData)return this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden")),void("function"==typeof this._actual.afterRender&&Hre(this._actual.afterRender,this._actual,null));this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),"function"==typeof this._actual.afterRender&&Hre(this._actual.afterRender,this._actual,this._renderData.position)}}function Hre(e,t,...n){try{return e.call(t,...n)}catch(i){return null}}let jre=!0;class Gre extends mee{constructor(e){super(),this._context=e;const t=this._context.configuration.options,n=t.get(128);this._lineHeight=t.get(56),this._renderLineHighlight=t.get(83),this._renderLineHighlightOnlyWhenFocus=t.get(84),this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new MK(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=jre?this._selections.slice(0,1):this._selections,n=t.map((e=>e.positionLineNumber));n.sort(((e,t)=>e-t)),D1(this._cursorLineNumbers,n)||(this._cursorLineNumbers=n,e=!0);const i=t.every((e=>e.isEmpty()));return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,n=t.get(128);return this._lineHeight=t.get(56),this._renderLineHighlight=t.get(83),this._renderLineHighlightOnlyWhenFocus=t.get(84),this._contentLeft=n.contentLeft,this._contentWidth=n.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return!!this._renderLineHighlightOnlyWhenFocus&&(this._focused=e.isFocused,!0)}prepareRender(e){if(!this._shouldRenderThis())return void(this._renderData=null);const t=this._renderOne(e),n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._cursorLineNumbers.length;let o=0;const s=[];for(let a=n;a<=i;a++){const e=a-n;for(;o<r&&this._cursorLineNumbers[o]<a;)o++;o<r&&this._cursorLineNumbers[o]===a?s[e]=t:s[e]=""}this._renderData=s}render(e,t){if(!this._renderData)return"";const n=t-e;return n>=this._renderData.length?"":this._renderData[n]}}class Kre extends Gre{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderOther()?" current-line-both":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return("line"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderOther(){return("gutter"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class qre extends Gre{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")}" style="width:${this._contentLeft}px; height:${this._lineHeight}px;"></div>`}_shouldRenderMargin(){return("gutter"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderThis(){return!0}_shouldRenderOther(){return("line"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}G5(((e,t)=>{jre=!1;const n=e.getColor(lie);if(n&&(t.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${n}; }`),t.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${n}; border: none; }`)),!n||n.isTransparent()||e.defines(cie)){const n=e.getColor(cie);n&&(jre=!0,t.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${n}; }`),t.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${n}; }`),"hc"===e.type&&(t.addRule(".monaco-editor .view-overlays .current-line { border-width: 1px; }"),t.addRule(".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }")))}}));class $re extends mee{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(56),this._typicalHalfwidthCharacterWidth=t.get(40).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(56),this._typicalHalfwidthCharacterWidth=t.get(40).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let n=[],i=0;for(let a=0,l=t.length;a<l;a++){const e=t[a];e.options.className&&(n[i++]=e)}n=n.sort(((e,t)=>{if(e.options.zIndex<t.options.zIndex)return-1;if(e.options.zIndex>t.options.zIndex)return 1;const n=e.options.className,i=t.options.className;return n<i?-1:n>i?1:TK.compareRangesUsingStarts(e.range,t.range)}));const r=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber,s=[];for(let a=r;a<=o;a++){s[a-r]=""}this._renderWholeLineDecorations(e,n,s),this._renderNormalDecorations(e,n,s),this._renderResult=s}_renderWholeLineDecorations(e,t,n){const i=String(this._lineHeight),r=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){const e=t[s];if(!e.options.isWholeLine)continue;const a='<div class="cdr '+e.options.className+'" style="left:0;width:100%;height:'+i+'px;"></div>',l=Math.max(e.range.startLineNumber,r),c=Math.min(e.range.endLineNumber,o);for(let t=l;t<=c;t++){n[t-r]+=a}}}_renderNormalDecorations(e,t,n){const i=String(this._lineHeight),r=e.visibleRange.startLineNumber;let o=null,s=!1,a=null;for(let l=0,c=t.length;l<c;l++){const c=t[l];if(c.options.isWholeLine)continue;const u=c.options.className,h=Boolean(c.options.showIfCollapsed);let d=c.range;h&&1===d.endColumn&&d.endLineNumber!==d.startLineNumber&&(d=new TK(d.startLineNumber,d.startColumn,d.endLineNumber-1,this._context.model.getLineMaxColumn(d.endLineNumber-1))),o===u&&s===h&&TK.areIntersectingOrTouching(a,d)?a=TK.plusRange(a,d):(null!==o&&this._renderNormalDecoration(e,a,o,s,i,r,n),o=u,s=h,a=d)}null!==o&&this._renderNormalDecoration(e,a,o,s,i,r,n)}_renderNormalDecoration(e,t,n,i,r,o,s){const a=e.linesVisibleRangesForRange(t,"findMatch"===n);if(a)for(let l=0,c=a.length;l<c;l++){const e=a[l];if(e.outsideRenderedLine)continue;const t=e.lineNumber-o;if(i&&1===e.ranges.length){const t=e.ranges[0];0===t.width&&(e.ranges[0]=new X6(t.left,this._typicalHalfwidthCharacterWidth))}for(let i=0,o=e.ranges.length;i<o;i++){const o=e.ranges[i],a='<div class="cdr '+n+'" style="left:'+String(o.left)+"px;width:"+String(o.width)+"px;height:"+r+'px;"></div>';s[t]+=a}}}render(e,t){if(!this._renderResult)return"";const n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}}class Yre extends mG{onclick(e,t){this._register(Q$(e,RY.CLICK,(e=>t(new L$(e)))))}onmousedown(e,t){this._register(Q$(e,RY.MOUSE_DOWN,(e=>t(new L$(e)))))}onmouseover(e,t){this._register(Q$(e,RY.MOUSE_OVER,(e=>t(new L$(e)))))}onnonbubblingmouseout(e,t){this._register(iY(e,(e=>t(new L$(e)))))}onkeydown(e,t){this._register(Q$(e,RY.KEY_DOWN,(e=>t(new C$(e)))))}onkeyup(e,t){this._register(Q$(e,RY.KEY_UP,(e=>t(new C$(e)))))}oninput(e,t){this._register(Q$(e,RY.INPUT,t))}onblur(e,t){this._register(Q$(e,RY.BLUR,t))}onfocus(e,t){this._register(Q$(e,RY.FOCUS,t))}ignoreGesture(e){O6.ignoreTarget(e)}}class Xre extends Yre{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",void 0!==e.top&&(this.bgDomNode.style.top="0px"),void 0!==e.left&&(this.bgDomNode.style.left="0px"),void 0!==e.bottom&&(this.bgDomNode.style.bottom="0px"),void 0!==e.right&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...e.icon.classNamesArray),this.domNode.style.position="absolute",this.domNode.style.width="11px",this.domNode.style.height="11px",void 0!==e.top&&(this.domNode.style.top=e.top+"px"),void 0!==e.left&&(this.domNode.style.left=e.left+"px"),void 0!==e.bottom&&(this.domNode.style.bottom=e.bottom+"px"),void 0!==e.right&&(this.domNode.style.right=e.right+"px"),this._mouseMoveMonitor=this._register(new P6),this.onmousedown(this.bgDomNode,(e=>this._arrowMouseDown(e))),this.onmousedown(this.domNode,(e=>this._arrowMouseDown(e))),this._mousedownRepeatTimer=this._register(new W$),this._mousedownScheduleRepeatTimer=this._register(new B$)}_arrowMouseDown(e){this._onActivate(),this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancelAndSet((()=>{this._mousedownRepeatTimer.cancelAndSet((()=>this._onActivate()),1e3/24)}),200),this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,R6,(e=>{}),(()=>{this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancel()})),e.preventDefault()}}class Zre extends mG{constructor(e,t,n){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=n,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new B$)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return 2!==this._visibility&&(3===this._visibility||this._rawShouldBeVisible)}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){this._isNeeded?this._shouldBeVisible?this._reveal():this._hide(!0):this._hide(!1)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet((()=>{this._domNode&&this._domNode.setClassName(this._visibleClassName)}),0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode&&this._domNode.setClassName(this._invisibleClassName+(e?" fade":"")))}}class Qre extends Yre{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new Zre(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._mouseMoveMonitor=this._register(new P6),this._shouldRender=!0,this.domNode=I6(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this.onmousedown(this.domNode.domNode,(e=>this._domNodeMouseDown(e)))}_createArrow(e){const t=this._register(new Xre(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,n,i){this.slider=I6(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),"number"==typeof n&&this.slider.setWidth(n),"number"==typeof i&&this.slider.setHeight(i),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this.onmousedown(this.slider.domNode,(e=>{e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{})))})),this.onclick(this.slider.domNode,(e=>{e.leftButton&&e.stopPropagation()}))}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodeMouseDown(e){e.target===this.domNode.domNode&&this._onMouseDown(e)}delegateMouseDown(e){const t=this.domNode.domNode.getClientRects()[0].top,n=t+this._scrollbarState.getSliderPosition(),i=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderMousePosition(e);n<=r&&r<=i?e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{}))):this._onMouseDown(e)}_onMouseDown(e){let t,n;if(e.target===this.domNode.domNode&&"number"==typeof e.browserEvent.offsetX&&"number"==typeof e.browserEvent.offsetY)t=e.browserEvent.offsetX,n=e.browserEvent.offsetY;else{const i=mY(this.domNode.domNode);t=e.posx-i.left,n=e.posy-i.top}const i=this._mouseDownRelativePosition(t,n);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(i):this._scrollbarState.getDesiredScrollPositionFromOffset(i)),e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{})))}_sliderMouseDown(e,t){const n=this._sliderMousePosition(e),i=this._sliderOrthogonalMousePosition(e),r=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,R6,(e=>{const t=this._sliderOrthogonalMousePosition(e),o=Math.abs(t-i);if(aj&&o>140)return void this._setDesiredScrollPositionNow(r.getScrollPosition());const s=this._sliderMousePosition(e)-n;this._setDesiredScrollPositionNow(r.getDesiredScrollPositionFromDelta(s))}),(()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd(),t()})),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}class Jre{constructor(e,t,n,i,r,o){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(e),this._visibleSize=i,this._scrollSize=r,this._scrollPosition=o,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new Jre(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t&&(this._visibleSize=t,this._refreshComputedValues(),!0)}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t&&(this._scrollSize=t,this._refreshComputedValues(),!0)}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t&&(this._scrollPosition=t,this._refreshComputedValues(),!0)}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,n,i,r){const o=Math.max(0,n-e),s=Math.max(0,o-2*t),a=i>0&&i>n;if(!a)return{computedAvailableSize:Math.round(o),computedIsNeeded:a,computedSliderSize:Math.round(s),computedSliderRatio:0,computedSliderPosition:0};const l=Math.round(Math.max(20,Math.floor(n*s/i))),c=(s-l)/(i-n),u=r*c;return{computedAvailableSize:Math.round(o),computedIsNeeded:a,computedSliderSize:Math.round(l),computedSliderRatio:c,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){const e=Jre._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let n=this._scrollPosition;return t<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}const eoe=uJ("scrollbar-button-left",hJ.triangleLeft),toe=uJ("scrollbar-button-right",hJ.triangleRight);class noe extends Qre{constructor(e,t,n){const i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Jre(t.horizontalHasArrows?t.arrowSize:0,2===t.horizontal?0:t.horizontalScrollbarSize,2===t.vertical?0:t.verticalScrollbarSize,i.width,i.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const e=(t.arrowSize-11)/2,n=(t.horizontalScrollbarSize-11)/2;this._createArrow({className:"scra",icon:eoe,top:n,left:e,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new D$(null,1,0))}),this._createArrow({className:"scra",icon:toe,top:n,left:void 0,bottom:void 0,right:e,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new D$(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(e,t){return e}_sliderMousePosition(e){return e.posx}_sliderOrthogonalMousePosition(e){return e.posy}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(2===e.horizontal?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(2===e.vertical?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}const ioe=uJ("scrollbar-button-up",hJ.triangleUp),roe=uJ("scrollbar-button-down",hJ.triangleDown);class ooe extends Qre{constructor(e,t,n){const i=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:n,scrollbarState:new Jre(t.verticalHasArrows?t.arrowSize:0,2===t.vertical?0:t.verticalScrollbarSize,0,i.height,i.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const e=(t.arrowSize-11)/2,n=(t.verticalScrollbarSize-11)/2;this._createArrow({className:"scra",icon:ioe,top:e,left:n,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new D$(null,0,1))}),this._createArrow({className:"scra",icon:roe,top:void 0,left:n,bottom:e,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new D$(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(e,t){return t}_sliderMousePosition(e){return e.posy}_sliderOrthogonalMousePosition(e){return e.posx}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(2===e.vertical?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class soe{constructor(e,t,n,i,r,o){this._scrollStateBrand=void 0,e|=0,t|=0,n|=0,i|=0,r|=0,o|=0,this.rawScrollLeft=n,this.rawScrollTop=o,e<0&&(e=0),n+e>t&&(n=t-e),n<0&&(n=0),i<0&&(i=0),o+i>r&&(o=r-i),o<0&&(o=0),this.width=e,this.scrollWidth=t,this.scrollLeft=n,this.height=i,this.scrollHeight=r,this.scrollTop=o}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new soe(void 0!==e.width?e.width:this.width,void 0!==e.scrollWidth?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,void 0!==e.height?e.height:this.height,void 0!==e.scrollHeight?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new soe(this.width,this.scrollWidth,void 0!==e.scrollLeft?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,void 0!==e.scrollTop?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const n=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,o=this.height!==e.height,s=this.scrollHeight!==e.scrollHeight,a=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:i,scrollLeftChanged:r,heightChanged:o,scrollHeightChanged:s,scrollTopChanged:a}}}class aoe extends mG{constructor(e,t){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new EG),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e,this._scheduleAtNextAnimationFrame=t,this._state=new soe(0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){const n=this._state.withScrollDimensions(e,t);this._setState(n,Boolean(this._smoothScrolling)),this._smoothScrolling&&this._smoothScrolling.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(0===this._smoothScrollDuration)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:void 0===e.scrollLeft?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:void 0===e.scrollTop?this._smoothScrolling.to.scrollTop:e.scrollTop};const n=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===n.scrollLeft&&this._smoothScrolling.to.scrollTop===n.scrollTop)return;let i;i=t?new uoe(this._smoothScrolling.from,n,this._smoothScrolling.startTime,this._smoothScrolling.duration):this._smoothScrolling.combine(this._state,n,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=i}else{const t=this._state.withScrollPosition(e);this._smoothScrolling=uoe.start(this._state,t,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);return this._setState(t,!0),this._smoothScrolling?e.isDone?(this._smoothScrolling.dispose(),void(this._smoothScrolling=null)):void(this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))):void 0}_setState(e,t){const n=this._state;n.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(n,t)))}}class loe{constructor(e,t,n){this.scrollLeft=e,this.scrollTop=t,this.isDone=n}}function coe(e,t){const n=t-e;return function(t){return e+n*(1-function(e){return Math.pow(e,3)}(1-t))}}class uoe{constructor(e,t,n,i){this.from=e,this.to=t,this.duration=i,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,n){if(Math.abs(e-t)>2.5*n){let s,a;return e<t?(s=e+.75*n,a=t-.75*n):(s=e-.75*n,a=t+.75*n),i=coe(e,s),r=coe(a,t),o=.33,function(e){return e<o?i(e/o):r((e-o)/(1-o))}}var i,r,o;return coe(e,t)}dispose(){null!==this.animationFrameDisposable&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const e=this.scrollLeft(t),n=this.scrollTop(t);return new loe(e,n,!1)}return new loe(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,n){return uoe.start(e,t,n)}static start(e,t,n){n+=10;const i=Date.now()-10;return new uoe(e,t,i,n)}}class hoe{constructor(e,t,n){this.timestamp=e,this.deltaX=t,this.deltaY=n,this.score=0}}class doe{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(-1===this._front&&-1===this._rear)return!1;let e=1,t=0,n=1,i=this._rear;for(;;){const r=i===this._front?e:Math.pow(2,-n);if(e-=r,t+=this._memory[i].score*r,i===this._front)break;i=(this._capacity+i-1)%this._capacity,n++}return t<=.5}accept(e,t,n){const i=new hoe(e,t,n);i.score=this._computeScore(i),-1===this._front&&-1===this._rear?(this._memory[0]=i,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=i)}_computeScore(e){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let t=.5;return(-1!==this._front||-1!==this._rear)&&this._memory[this._rear],this._isAlmostInt(e.deltaX)&&this._isAlmostInt(e.deltaY)||(t+=.25),Math.min(Math.max(t,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}}doe.INSTANCE=new doe;class foe extends Yre{constructor(e,t,n){super(),this._onScroll=this._register(new EG),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new EG),e.style.overflow="hidden",this._options=function(e){const t={lazyRender:void 0!==e.lazyRender&&e.lazyRender,className:void 0!==e.className?e.className:"",useShadows:void 0===e.useShadows||e.useShadows,handleMouseWheel:void 0===e.handleMouseWheel||e.handleMouseWheel,flipAxes:void 0!==e.flipAxes&&e.flipAxes,consumeMouseWheelIfScrollbarIsNeeded:void 0!==e.consumeMouseWheelIfScrollbarIsNeeded&&e.consumeMouseWheelIfScrollbarIsNeeded,alwaysConsumeMouseWheel:void 0!==e.alwaysConsumeMouseWheel&&e.alwaysConsumeMouseWheel,scrollYToX:void 0!==e.scrollYToX&&e.scrollYToX,mouseWheelScrollSensitivity:void 0!==e.mouseWheelScrollSensitivity?e.mouseWheelScrollSensitivity:1,fastScrollSensitivity:void 0!==e.fastScrollSensitivity?e.fastScrollSensitivity:5,scrollPredominantAxis:void 0===e.scrollPredominantAxis||e.scrollPredominantAxis,mouseWheelSmoothScroll:void 0===e.mouseWheelSmoothScroll||e.mouseWheelSmoothScroll,arrowSize:void 0!==e.arrowSize?e.arrowSize:11,listenOnDomNode:void 0!==e.listenOnDomNode?e.listenOnDomNode:null,horizontal:void 0!==e.horizontal?e.horizontal:1,horizontalScrollbarSize:void 0!==e.horizontalScrollbarSize?e.horizontalScrollbarSize:10,horizontalSliderSize:void 0!==e.horizontalSliderSize?e.horizontalSliderSize:0,horizontalHasArrows:void 0!==e.horizontalHasArrows&&e.horizontalHasArrows,vertical:void 0!==e.vertical?e.vertical:1,verticalScrollbarSize:void 0!==e.verticalScrollbarSize?e.verticalScrollbarSize:10,verticalHasArrows:void 0!==e.verticalHasArrows&&e.verticalHasArrows,verticalSliderSize:void 0!==e.verticalSliderSize?e.verticalSliderSize:0,scrollByPage:void 0!==e.scrollByPage&&e.scrollByPage};t.horizontalSliderSize=void 0!==e.horizontalSliderSize?e.horizontalSliderSize:t.horizontalScrollbarSize,t.verticalSliderSize=void 0!==e.verticalSliderSize?e.verticalSliderSize:t.verticalScrollbarSize,lj&&(t.className+=" mac");return t}(t),this._scrollable=n,this._register(this._scrollable.onScroll((e=>{this._onWillScroll.fire(e),this._onDidScroll(e),this._onScroll.fire(e)})));const i={onMouseWheel:e=>this._onMouseWheel(e),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new ooe(this._scrollable,this._options,i)),this._horizontalScrollbar=this._register(new noe(this._scrollable,this._options,i)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=I6(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=I6(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=I6(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,(e=>this._onMouseOver(e))),this.onnonbubblingmouseout(this._listenOnDomNode,(e=>this._onMouseOut(e))),this._hideTimeout=this._register(new B$),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=dG(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarMouseDown(e){this._verticalScrollbar.delegateMouseDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,lj&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){void 0!==e.handleMouseWheel&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),void 0!==e.mouseWheelScrollSensitivity&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),void 0!==e.fastScrollSensitivity&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),void 0!==e.scrollPredominantAxis&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),void 0!==e.horizontal&&(this._options.horizontal=e.horizontal),void 0!==e.vertical&&(this._options.vertical=e.vertical),void 0!==e.horizontalScrollbarSize&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),void 0!==e.verticalScrollbarSize&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),void 0!==e.scrollByPage&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=dG(this._mouseWheelToDispose),e)){const e=e=>{this._onMouseWheel(new D$(e))};this._mouseWheelToDispose.push(Q$(this._listenOnDomNode,RY.MOUSE_WHEEL,e,{passive:!1}))}}_onMouseWheel(e){const t=doe.INSTANCE;{const n=window.devicePixelRatio/s$.INSTANCE.getZoomFactor();aj||cj?t.accept(Date.now(),e.deltaX/n,e.deltaY/n):t.accept(Date.now(),e.deltaX,e.deltaY)}let n=!1;if(e.deltaY||e.deltaX){let i=e.deltaY*this._options.mouseWheelScrollSensitivity,r=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(Math.abs(i)>=Math.abs(r)?r=0:i=0),this._options.flipAxes&&([i,r]=[r,i]);const o=!lj&&e.browserEvent&&e.browserEvent.shiftKey;!this._options.scrollYToX&&!o||r||(r=i,i=0),e.browserEvent&&e.browserEvent.altKey&&(r*=this._options.fastScrollSensitivity,i*=this._options.fastScrollSensitivity);const s=this._scrollable.getFutureScrollPosition();let a={};if(i){const e=s.scrollTop-50*i;this._verticalScrollbar.writeScrollPosition(a,e)}if(r){const e=s.scrollLeft-50*r;this._horizontalScrollbar.writeScrollPosition(a,e)}if(a=this._scrollable.validateScrollPosition(a),s.scrollLeft!==a.scrollLeft||s.scrollTop!==a.scrollTop){this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(a):this._scrollable.setScrollPositionNow(a),n=!0}}let i=n;!i&&this._options.alwaysConsumeMouseWheel&&(i=!0),!i&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(i=!0),i&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,n=e.scrollLeft>0,i=n?" left":"",r=t?" top":"",o=n||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${i}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${o}${r}${i}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseOut(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){this._mouseIsOver||this._isDragging||(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){this._mouseIsOver||this._isDragging||this._hideTimeout.cancelAndSet((()=>this._hide()),500)}}class goe extends foe{constructor(e,t){(t=t||{}).mouseWheelSmoothScroll=!1;const n=new aoe(0,(e=>oY(e)));super(e,t,n),this._register(n)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class poe extends foe{constructor(e,t,n){super(e,t,n)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class moe extends goe{constructor(e,t){super(e,t),this._element=e,this.onScroll((e=>{e.scrollTopChanged&&(this._element.scrollTop=e.scrollTop),e.scrollLeftChanged&&(this._element.scrollLeft=e.scrollLeft)})),this.scanDomNode()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}class voe extends K6{constructor(e,t,n,i){super(e);const r=this._context.configuration.options,o=r.get(90),s=r.get(64),a=r.get(32),l=r.get(93),c={listenOnDomNode:n.domNode,className:"editor-scrollable "+U5(e.theme.type),useShadows:!1,lazyRender:!0,vertical:o.vertical,horizontal:o.horizontal,verticalHasArrows:o.verticalHasArrows,horizontalHasArrows:o.horizontalHasArrows,verticalScrollbarSize:o.verticalScrollbarSize,verticalSliderSize:o.verticalSliderSize,horizontalScrollbarSize:o.horizontalScrollbarSize,horizontalSliderSize:o.horizontalSliderSize,handleMouseWheel:o.handleMouseWheel,alwaysConsumeMouseWheel:o.alwaysConsumeMouseWheel,arrowSize:o.arrowSize,mouseWheelScrollSensitivity:s,fastScrollSensitivity:a,scrollPredominantAxis:l,scrollByPage:o.scrollByPage};this.scrollbar=this._register(new poe(t.domNode,c,this._context.viewLayout.getScrollable())),q6.write(this.scrollbar.getDomNode(),5),this.scrollbarDomNode=I6(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const u=(e,t,n)=>{const i={};if(t){const t=e.scrollTop;t&&(i.scrollTop=this._context.viewLayout.getCurrentScrollTop()+t,e.scrollTop=0)}if(n){const t=e.scrollLeft;t&&(i.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+t,e.scrollLeft=0)}this._context.model.setScrollPosition(i,1)};this._register(Q$(n.domNode,"scroll",(e=>u(n.domNode,!0,!0)))),this._register(Q$(t.domNode,"scroll",(e=>u(t.domNode,!0,!1)))),this._register(Q$(i.domNode,"scroll",(e=>u(i.domNode,!0,!1)))),this._register(Q$(this.scrollbarDomNode.domNode,"scroll",(e=>u(this.scrollbarDomNode.domNode,!0,!1))))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(128);this.scrollbarDomNode.setLeft(t.contentLeft);"right"===e.get(62).side?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarMouseDown(e){this.scrollbar.delegateVerticalScrollbarMouseDown(e)}onConfigurationChanged(e){if(e.hasChanged(90)||e.hasChanged(64)||e.hasChanged(32)){const e=this._context.configuration.options,t=e.get(90),n=e.get(64),i=e.get(32),r=e.get(93),o={vertical:t.vertical,horizontal:t.horizontal,verticalScrollbarSize:t.verticalScrollbarSize,horizontalScrollbarSize:t.horizontalScrollbarSize,scrollByPage:t.scrollByPage,handleMouseWheel:t.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:i,scrollPredominantAxis:r};this.scrollbar.updateOptions(o)}return e.hasChanged(128)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+U5(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class yoe{constructor(e,t,n){this._decorationToRenderBrand=void 0,this.startLineNumber=+e,this.endLineNumber=+t,this.className=String(n)}}class _oe extends mee{_render(e,t,n){const i=[];for(let s=e;s<=t;s++){i[s-e]=[]}if(0===n.length)return i;n.sort(((e,t)=>e.className===t.className?e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber:e.className<t.className?-1:1));let r=null,o=0;for(let s=0,a=n.length;s<a;s++){const a=n[s],l=a.className;let c=Math.max(a.startLineNumber,e)-e;const u=Math.min(a.endLineNumber,t)-e;r===l?(c=Math.max(o+1,c),o=Math.max(o,u)):(r=l,o=u);for(let e=c;e<=o;e++)i[e].push(r)}return i}}class boe extends _oe{constructor(e){super(),this._context=e;const t=this._context.configuration.options,n=t.get(128);this._lineHeight=t.get(56),this._glyphMargin=t.get(46),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,n=t.get(128);return this._lineHeight=t.get(56),this._glyphMargin=t.get(46),this._glyphMarginLeft=n.glyphMarginLeft,this._glyphMarginWidth=n.glyphMarginWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport();let n=[],i=0;for(let r=0,o=t.length;r<o;r++){const e=t[r],o=e.options.glyphMarginClassName;o&&(n[i++]=new yoe(e.range.startLineNumber,e.range.endLineNumber,o))}return n}prepareRender(e){if(!this._glyphMargin)return void(this._renderResult=null);const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=this._lineHeight.toString(),o='" style="left:'+this._glyphMarginLeft.toString()+"px;width:"+this._glyphMarginWidth.toString()+"px;height:"+r+'px;"></div>',s=[];for(let a=t;a<=n;a++){const e=a-t,n=i[e];0===n.length?s[e]="":s[e]='<div class="cgmr codicon '+n.join(" ")+o}this._renderResult=s}render(e,t){if(!this._renderResult)return"";const n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}}class woe extends mee{constructor(e){super(),this._context=e,this._primaryLineNumber=0;const t=this._context.configuration.options,n=t.get(129),i=t.get(40);this._lineHeight=t.get(56),this._spaceWidth=i.spaceWidth,this._enabled=t.get(81),this._activeIndentEnabled=t.get(49),this._maxIndentLeft=-1===n.wrappingColumn?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,n=t.get(129),i=t.get(40);return this._lineHeight=t.get(56),this._spaceWidth=i.spaceWidth,this._enabled=t.get(81),this._activeIndentEnabled=t.get(49),this._maxIndentLeft=-1===n.wrappingColumn?-1:n.wrappingColumn*i.typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){const t=e.selections[0],n=t.isEmpty()?t.positionLineNumber:0;return this._primaryLineNumber!==n&&(this._primaryLineNumber=n,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._enabled)return void(this._renderResult=null);const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,{indentSize:i}=this._context.model.getTextModelOptions(),r=i*this._spaceWidth,o=e.scrollWidth,s=this._lineHeight,a=this._context.model.getLinesIndentGuides(t,n);let l=0,c=0,u=0;if(this._activeIndentEnabled&&this._primaryLineNumber){const e=this._context.model.getActiveIndentGuide(this._primaryLineNumber,t,n);l=e.startLineNumber,c=e.endLineNumber,u=e.indent}const h=[];for(let d=t;d<=n;d++){const n=l<=d&&d<=c,i=d-t,f=a[i];let g="";if(f>=1){const t=e.visibleRangeForPosition(new IK(d,1));let i=t?t.left:0;for(let e=1;e<=f;e++){if(g+=`<div class="${n&&e===u?"cigra":"cigr"}" style="left:${i}px;height:${s}px;width:${r}px"></div>`,i+=r,i>o||this._maxIndentLeft>0&&i>this._maxIndentLeft)break}}h[i]=g}this._renderResult=h}render(e,t){if(!this._renderResult)return"";const n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}}G5(((e,t)=>{const n=e.getColor(vie);n&&t.addRule(`.monaco-editor .lines-content .cigr { box-shadow: 1px 0 0 0 ${n} inset; }`);const i=e.getColor(yie)||n;i&&t.addRule(`.monaco-editor .lines-content .cigra { box-shadow: 1px 0 0 0 ${i} inset; }`)}));class Coe{constructor(){this._currentVisibleRange=new TK(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class Soe{constructor(e,t,n,i,r,o){this.lineNumber=e,this.startColumn=t,this.endColumn=n,this.startScrollTop=i,this.stopScrollTop=r,this.scrollType=o,this.type="range",this.minLineNumber=e,this.maxLineNumber=e}}class xoe{constructor(e,t,n,i){this.selections=e,this.startScrollTop=t,this.stopScrollTop=n,this.scrollType=i,this.type="selections";let r=e[0].startLineNumber,o=e[0].endLineNumber;for(let s=1,a=e.length;s<a;s++){const t=e[s];r=Math.min(r,t.startLineNumber),o=Math.max(o,t.endLineNumber)}this.minLineNumber=r,this.maxLineNumber=o}}class Eoe extends K6{constructor(e,t){super(e),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Ore(this),this.domNode=this._visibleLines.domNode;const n=this._context.configuration,i=this._context.configuration.options,r=i.get(40),o=i.get(129);this._lineHeight=i.get(56),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=o.isViewportWrapping,this._revealHorizontalRightPadding=i.get(87),this._cursorSurroundingLines=i.get(23),this._cursorSurroundingLinesStyle=i.get(24),this._canUseLayerHinting=!i.get(26),this._viewLineOptions=new r9(n,this._context.theme.type),q6.write(this.domNode,7),this.domNode.setClassName("view-lines monaco-mouse-cursor-text"),D6.applyFontInfo(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new z$((()=>{this._updateLineWidthsSlow()}),200),this._asyncCheckMonospaceFontAssumptions=new z$((()=>{this._checkMonospaceFontAssumptions()}),2e3),this._lastRenderedData=new Coe,this._horizontalRevealRequest=null}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new o9(this._viewLineOptions)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(129)&&(this._maxLineWidth=0);const t=this._context.configuration.options,n=t.get(40),i=t.get(129);return this._lineHeight=t.get(56),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.isViewportWrapping,this._revealHorizontalRightPadding=t.get(87),this._cursorSurroundingLines=t.get(23),this._cursorSurroundingLinesStyle=t.get(24),this._canUseLayerHinting=!t.get(26),D6.applyFontInfo(this.domNode,n),this._onOptionsMaybeChanged(),e.hasChanged(128)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new r9(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const e=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let t=e;t<=n;t++){this._visibleLines.getVisibleLine(t).onOptionsChanged(this._viewLineOptions)}return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();let i=!1;for(let r=t;r<=n;r++)i=this._visibleLines.getVisibleLine(r).onSelectionChanged()||i;return i}onDecorationsChanged(e){{const e=this._visibleLines.getStartLineNumber(),t=this._visibleLines.getEndLineNumber();for(let n=e;n<=t;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.range,e.selections,e.verticalType);if(-1===t)return!1;let n=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?n={scrollTop:n.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new Soe(e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new xoe(e.selections,this._context.viewLayout.getCurrentScrollTop(),n.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const i=Math.abs(this._context.viewLayout.getCurrentScrollTop()-n.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.model.setScrollPosition(n,i),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),n=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>n)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.model.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const n=this._getViewLineDomNode(e);if(null===n)return null;const i=this._getLineNumberFor(n);if(-1===i)return null;if(i<1||i>this._context.model.getLineCount())return null;if(1===this._context.model.getLineMaxColumn(i))return new IK(i,1);const r=this._visibleLines.getStartLineNumber(),o=this._visibleLines.getEndLineNumber();if(i<r||i>o)return null;let s=this._visibleLines.getVisibleLine(i).getColumnOfNodeOffset(i,e,t);const a=this._context.model.getLineMinColumn(i);return s<a&&(s=a),new IK(i,s)}_getViewLineDomNode(e){for(;e&&1===e.nodeType;){if(e.className===o9.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let i=t;i<=n;i++){if(e===this._visibleLines.getVisibleLine(i).getDomNode())return i}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();return e<t||e>n?-1:this._visibleLines.getVisibleLine(e).getWidth()}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const n=e.endLineNumber,i=TK.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!i)return null;let r=[],o=0;const s=new i9(this.domNode.domNode,this._textRangeRestingSpot);let a=0;t&&(a=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new IK(i.startLineNumber,1)).lineNumber);const l=this._visibleLines.getStartLineNumber(),c=this._visibleLines.getEndLineNumber();for(let u=i.startLineNumber;u<=i.endLineNumber;u++){if(u<l||u>c)continue;const e=u===i.startLineNumber?i.startColumn:1,h=u===i.endLineNumber?i.endColumn:this._context.model.getLineMaxColumn(u),d=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(e,h,s);if(d){if(t&&u<n){const e=a;a=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new IK(u+1,1)).lineNumber,e!==a&&(d.ranges[d.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[o++]=new Y6(d.outsideRenderedLine,u,d.ranges)}}return 0===o?null:r}_visibleRangesForLineRange(e,t,n){return this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber()?null:this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(t,n,new i9(this.domNode.domNode,this._textRangeRestingSpot))}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new Z6(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();let i=1,r=!0;for(let o=t;o<=n;o++){const t=this._visibleLines.getVisibleLine(o);!e||t.getWidthIsFast()?i=Math.max(i,t.getWidth()):r=!1}return r&&1===t&&n===this._context.model.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(i),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const n=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=n;r<=i;r++){const n=this._visibleLines.getVisibleLine(r);if(n.needsMonospaceFontCheck()){const i=n.getWidth();i>t&&(t=i,e=r)}}if(-1!==e&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=n;r<=i;r++){this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const t=this._horizontalRevealRequest;if(e.startLineNumber<=t.minLineNumber&&t.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const e=this._computeScrollLeftToReveal(t);e&&(this._isViewportWrapping||this._ensureMaxLineWidth(e.maxHorizontalOffset),this._context.model.setScrollPosition({scrollLeft:e.scrollLeft},t.scrollType))}}if(this._updateLineWidthsFast()||this._asyncUpdateLineWidths.schedule(),cj&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const e=this._visibleLines.getStartLineNumber(),t=this._visibleLines.getEndLineNumber();for(let n=e;n<=t;n++){if(this._visibleLines.getVisibleLine(n).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.model.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,n,i,r){const o=e.top,s=e.height,a=o+s;let l,c,u;if(i&&i.length>0){let e=i[0].startLineNumber,t=i[0].endLineNumber;for(let n=1,r=i.length;n<r;n++){const r=i[n];e=Math.min(e,r.startLineNumber),t=Math.max(t,r.endLineNumber)}l=!1,c=this._context.viewLayout.getVerticalOffsetForLineNumber(e),u=this._context.viewLayout.getVerticalOffsetForLineNumber(t)+this._lineHeight}else{if(!n)return-1;l=!0,c=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),u=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight}if(!("mouse"===t&&"default"===this._cursorSurroundingLinesStyle)){const e=Math.min(s/this._lineHeight/2,this._cursorSurroundingLines);c-=e*this._lineHeight,u+=Math.max(0,e-1)*this._lineHeight}let h;if(0!==r&&4!==r||(u+=this._lineHeight),u-c>s){if(!l)return-1;h=c}else if(5===r||6===r)if(6===r&&o<=c&&u<=a)h=o;else{const e=c-Math.max(5*this._lineHeight,.2*s),t=u-s;h=Math.max(t,e)}else if(1===r||2===r)if(2===r&&o<=c&&u<=a)h=o;else{const e=(c+u)/2;h=Math.max(0,e-s/2)}else h=this._computeMinimumScrolling(o,a,c,u,3===r,4===r);return h}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),n=t.left,i=n+t.width;let r=1073741824,o=0;if("range"===e.type){const t=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!t)return null;for(const e of t.ranges)r=Math.min(r,e.left),o=Math.max(o,e.left+e.width)}else for(const s of e.selections){if(s.startLineNumber!==s.endLineNumber)return null;const e=this._visibleRangesForLineRange(s.startLineNumber,s.startColumn,s.endColumn);if(!e)return null;for(const t of e.ranges)r=Math.min(r,t.left),o=Math.max(o,t.left+t.width)}if(r=Math.max(0,r-Eoe.HORIZONTAL_EXTRA_PX),o+=this._revealHorizontalRightPadding,"selections"===e.type&&o-r>t.width)return null;return{scrollLeft:this._computeMinimumScrolling(n,i,r,o),maxHorizontalOffset:o}}_computeMinimumScrolling(e,t,n,i,r,o){r=!!r,o=!!o;const s=(t|=0)-(e|=0);return(i|=0)-(n|=0)<s?r?n:o?Math.max(0,i-s):n<e?n:i>t?Math.max(0,i-s):e:n}}Eoe.HORIZONTAL_EXTRA_PX=30;class koe extends _oe{constructor(e){super(),this._context=e;const t=this._context.configuration.options.get(128);this._decorationsLeft=t.decorationsLeft,this._decorationsWidth=t.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options.get(128);return this._decorationsLeft=t.decorationsLeft,this._decorationsWidth=t.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport();let n=[],i=0;for(let r=0,o=t.length;r<o;r++){const e=t[r],o=e.options.linesDecorationsClassName;o&&(n[i++]=new yoe(e.range.startLineNumber,e.range.endLineNumber,o));const s=e.options.firstLineDecorationClassName;s&&(n[i++]=new yoe(e.range.startLineNumber,e.range.startLineNumber,s))}return n}prepareRender(e){const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r='" style="left:'+this._decorationsLeft.toString()+"px;width:"+this._decorationsWidth.toString()+'px;"></div>',o=[];for(let s=t;s<=n;s++){const e=s-t,n=i[e];let a="";for(let t=0,i=n.length;t<i;t++)a+='<div class="cldr '+n[t]+r;o[e]=a}this._renderResult=o}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class Loe extends _oe{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport();let n=[],i=0;for(let r=0,o=t.length;r<o;r++){const e=t[r],o=e.options.marginClassName;o&&(n[i++]=new yoe(e.range.startLineNumber,e.range.endLineNumber,o))}return n}prepareRender(e){const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,i=this._render(t,n,this._getDecorations(e)),r=[];for(let o=t;o<=n;o++){const e=o-t,n=i[e];let s="";for(let t=0,i=n.length;t<i;t++)s+='<div class="cmdr '+n[t]+'" style=""></div>';r[e]=s}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class Doe{constructor(e,t,n,i){this._rgba8Brand=void 0,this.r=Doe._clamp(e),this.g=Doe._clamp(t),this.b=Doe._clamp(n),this.a=Doe._clamp(i)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:0|e}}Doe.Empty=new Doe(0,0,0,0);class Noe{constructor(){this._onDidChange=new EG,this.onDidChange=this._onDidChange.event,this._updateColorMap(),YJ.onDidChange((e=>{e.changedColorMap&&this._updateColorMap()}))}static getInstance(){return this._INSTANCE||(this._INSTANCE=new Noe),this._INSTANCE}_updateColorMap(){const e=YJ.getColorMap();if(!e)return this._colors=[Doe.Empty],void(this._backgroundIsLight=!0);this._colors=[Doe.Empty];for(let n=1;n<e.length;n++){const t=e[n].rgba;this._colors[n]=new Doe(t.r,t.g,t.b,Math.round(255*t.a))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}}Noe._INSTANCE=null;const Ioe=(()=>{const e=[];for(let t=32;t<=126;t++)e.push(t);return e.push(65533),e})();class Toe{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=Toe.soften(e,.8),this.charDataLight=Toe.soften(e,50/60)}static soften(e,t){let n=new Uint8ClampedArray(e.length);for(let i=0,r=e.length;i<r;i++)n[i]=u1(e[i]*t);return n}renderChar(e,t,n,i,r,o,s,a,l){const c=1*this.scale,u=2*this.scale,h=l?1:u;if(t+c>e.width||n+h>e.height)return void console.warn("bad render request outside image data");const d=a?this.charDataLight:this.charDataNormal,f=((e,t)=>(e-=32)<0||e>96?t<=2?(e+96)%96:95:e)(i,s),g=4*e.width,p=o.r,m=o.g,v=o.b,y=r.r-p,_=r.g-m,b=r.b-v,w=e.data;let C=f*c*u,S=n*g+4*t;for(let x=0;x<h;x++){let e=S;for(let t=0;t<c;t++){const t=d[C++]/255;w[e++]=p+y*t,w[e++]=m+_*t,w[e++]=v+b*t,e++}S+=g}}blockRenderChar(e,t,n,i,r,o,s){const a=1*this.scale,l=2*this.scale,c=s?1:l;if(t+a>e.width||n+c>e.height)return void console.warn("bad render request outside image data");const u=4*e.width,h=r.r,d=r.g,f=r.b,g=h+.5*(i.r-h),p=d+.5*(i.g-d),m=f+.5*(i.b-f),v=e.data;let y=n*u+4*t;for(let _=0;_<c;_++){let e=y;for(let t=0;t<a;t++)v[e++]=g,v[e++]=p,v[e++]=m,e++;y+=u}}}function Moe(e){const t=this;let n,i=!1;return function(){return i||(i=!0,n=e.apply(t,arguments)),n}}const Aoe={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},Ooe=e=>{const t=new Uint8ClampedArray(e.length/2);for(let n=0;n<e.length;n+=2)t[n>>1]=Aoe[e[n]]<<4|15&Aoe[e[n+1]];return t},Roe={1:Moe((()=>Ooe("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792"))),2:Moe((()=>Ooe("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126")))};class Poe{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let n;return n=Roe[e]?new Toe(Roe[e](),e):Poe.createFromSampleData(Poe.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=n,n}static createSampleData(e){const t=document.createElement("canvas"),n=t.getContext("2d");t.style.height="16px",t.height=16,t.width=960,t.style.width="960px",n.fillStyle="#ffffff",n.font=`bold 16px ${e}`,n.textBaseline="middle";let i=0;for(const r of Ioe)n.fillText(String.fromCharCode(r),i,8),i+=10;return n.getImageData(0,0,960,16)}static createFromSampleData(e,t){if(61440!==e.length)throw new Error("Unexpected source in MinimapCharRenderer");let n=Poe._downsample(e,t);return new Toe(n,t)}static _downsampleChar(e,t,n,i,r){const o=1*r,s=2*r;let a=i,l=0;for(let c=0;c<s;c++){const i=c/s*16,r=(c+1)/s*16;for(let s=0;s<o;s++){const c=s/o*10,u=(s+1)/o*10;let h=0,d=0;for(let n=i;n<r;n++){const i=t+3840*Math.floor(n),r=1-(n-Math.floor(n));for(let t=c;t<u;t++){const n=1-(t-Math.floor(t)),o=i+4*Math.floor(t),s=n*r;d+=s,h+=e[o]*e[o+3]/255*s}}const f=h/d;l=Math.max(l,f),n[a++]=u1(f)}}return l}static _downsample(e,t){const n=2*t*1*t,i=96*n,r=new Uint8ClampedArray(i);let o=0,s=0,a=0;for(let l=0;l<96;l++)a=Math.max(a,this._downsampleChar(e,s,r,o,t)),o+=n,s+=40;if(a>0){const e=255/a;for(let t=0;t<i;t++)r[t]*=e}return r}}class Foe{constructor(e,t,n){const i=e.options,r=i.get(126),o=i.get(128),s=o.minimap,a=i.get(40),l=i.get(62);this.renderMinimap=s.renderMinimap,this.size=l.size,this.minimapHeightIsEditorHeight=s.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=i.get(92),this.showSlider=l.showSlider,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.lineHeight=i.get(56),this.minimapLeft=s.minimapLeft,this.minimapWidth=s.minimapWidth,this.minimapHeight=o.height,this.canvasInnerWidth=s.minimapCanvasInnerWidth,this.canvasInnerHeight=s.minimapCanvasInnerHeight,this.canvasOuterWidth=s.minimapCanvasOuterWidth,this.canvasOuterHeight=s.minimapCanvasOuterHeight,this.isSampling=s.minimapIsSampling,this.editorHeight=o.height,this.fontScale=s.minimapScale,this.minimapLineHeight=s.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.charRenderer=Moe((()=>Poe.create(this.fontScale,a.fontFamily))),this.backgroundColor=Foe._getMinimapBackground(t,n)}static _getMinimapBackground(e,t){const n=e.getColor(Kne);return n?new Doe(n.rgba.r,n.rgba.g,n.rgba.b,n.rgba.a):t.getColor(2)}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.showSlider===e.showSlider&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)}}class Boe{constructor(e,t,n,i,r,o,s,a){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=n,this._computedSliderRatio=i,this.sliderTop=r,this.sliderHeight=o,this.startLineNumber=s,this.endLineNumber=a}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}static create(e,t,n,i,r,o,s,a,l,c,u){const h=e.pixelRatio,d=e.minimapLineHeight,f=Math.floor(e.canvasInnerHeight/d),g=e.lineHeight;if(e.minimapHeightIsEditorHeight){const t=a*e.lineHeight+(e.scrollBeyondLastLine?r-e.lineHeight:0),n=Math.max(1,Math.floor(r*r/t)),i=Math.max(0,e.minimapHeight-n),o=i/(c-r),u=l*o,h=i>0,d=Math.floor(e.canvasInnerHeight/e.minimapLineHeight);return new Boe(l,c,h,o,u,n,1,Math.min(s,d))}let p,m;if(o&&n!==s){const e=n-t+1;p=Math.floor(e*d/h)}else{const e=r/g;p=Math.floor(e*d/h)}m=e.scrollBeyondLastLine?(s-1)*d/h:Math.max(0,s*d/h-p),m=Math.min(e.minimapHeight-p,m);const v=m/(c-r),y=l*v;let _=0;if(e.scrollBeyondLastLine){_=r/g-1}if(f>=s+_){return new Boe(l,c,m>0,v,y,p,1,s)}{let e=Math.max(1,Math.floor(t-y*h/d));u&&u.scrollHeight===c&&(u.scrollTop>l&&(e=Math.min(e,u.startLineNumber)),u.scrollTop<l&&(e=Math.max(e,u.startLineNumber)));const n=Math.min(s,e+f-1);return new Boe(l,c,!0,v,(t-e+(l-i)/g)*d/h,p,e,n)}}}class Woe{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}Woe.INVALID=new Woe(-1);class zoe{constructor(e,t,n){this.renderedLayout=e,this._imageData=t,this._renderedLines=new Are((()=>Woe.INVALID)),this._renderedLines._set(e.startLineNumber,n)}linesEquals(e){if(!this.scrollEquals(e))return!1;const t=this._renderedLines._get().lines;for(let n=0,i=t.length;n<i;n++)if(-1===t[n].dy)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class Voe{constructor(e,t,n,i){this._backgroundFillData=Voe._createBackgroundFillData(t,n,i),this._buffers=[e.createImageData(t,n),e.createImageData(t,n)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,n){const i=n.r,r=n.g,o=n.b,s=new Uint8ClampedArray(e*t*4);let a=0;for(let l=0;l<t;l++)for(let t=0;t<e;t++)s[a]=i,s[a+1]=r,s[a+2]=o,s[a+3]=255,a+=4;return s}}class Uoe{constructor(e,t){this.samplingRatio=e,this.minimapLines=t}static compute(e,t,n){if(0===e.renderMinimap||!e.isSampling)return[null,[]];const i=e.pixelRatio,r=e.lineHeight,o=e.scrollBeyondLastLine,{minimapLineCount:s}=Uj.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:o,height:e.editorHeight,lineHeight:r,pixelRatio:i}),a=t/s,l=a/2;if(!n||0===n.minimapLines.length){let e=[];if(e[0]=1,s>1){for(let t=0,n=s-1;t<n;t++)e[t]=Math.round(t*a+l);e[s-1]=t}return[new Uoe(a,e),[]]}const c=n.minimapLines,u=c.length;let h=[],d=0,f=0,g=1;let p=[],m=null;for(let v=0;v<s;v++){const e=Math.max(g,Math.round(v*a)),n=Math.max(e,Math.round((v+1)*a));for(;d<u&&c[d]<e;){if(p.length<10){const e=d+1+f;m&&"deleted"===m.type&&m._oldIndex===d-1?m.deleteToLineNumber++:(m={type:"deleted",_oldIndex:d,deleteFromLineNumber:e,deleteToLineNumber:e},p.push(m)),f--}d++}let i;if(d<u&&c[d]<=n)i=c[d],d++;else if(i=0===v?1:v+1===s?t:Math.round(v*a+l),p.length<10){const e=d+1+f;m&&"inserted"===m.type&&m._i===v-1?m.insertToLineNumber++:(m={type:"inserted",_i:v,insertFromLineNumber:e,insertToLineNumber:e},p.push(m)),f++}h[v]=i,g=i}if(p.length<10)for(;d<u;){const e=d+1+f;m&&"deleted"===m.type&&m._oldIndex===d-1?m.deleteToLineNumber++:(m={type:"deleted",_oldIndex:d,deleteFromLineNumber:e,deleteToLineNumber:e},p.push(m)),f--,d++}else p=[{type:"flush"}];return[new Uoe(a,h),p]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e)-1;for(;n>0&&this.minimapLines[n-1]>=e;)n--;let i=this.modelLineToMinimapLine(t)-1;for(;i+1<this.minimapLines.length&&this.minimapLines[i+1]<=t;)i++;if(n===i){const i=this.minimapLines[n];if(i<e||i>t)return null}return[n+1,i+1]}decorationLineRangeToMinimapLineRange(e,t){let n=this.modelLineToMinimapLine(e),i=this.modelLineToMinimapLine(t);return e!==t&&i===n&&(i===this.minimapLines.length?n>1&&n--:i++),[n,i]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let n=this.minimapLines.length,i=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),n=Math.min(n,r),i=Math.max(i,r)):this.minimapLines[r]-=t;return[n,i]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let n=this.minimapLines.length-1;n>=0&&!(this.minimapLines[n]<e.fromLineNumber);n--)this.minimapLines[n]+=t}}class Hoe extends K6{constructor(e){super(e),this.tokensColorTracker=Noe.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Foe(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=Uoe.compute(this.options,this._context.model.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new joe(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new Foe(this._context.configuration,this._context.theme,this.tokensColorTracker);return!this.options.equals(e)&&(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return!!e.affectsMinimap&&this._actual.onDecorationsChanged()}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.toLineNumber);return!!t&&this._actual.onLinesChanged(t[0],t[1])}return this._actual.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){if(this._samplingState){const[t,n]=this._samplingState.onLinesDeleted(e);return t<=n&&this._actual.onLinesChanged(t+1,n+1),this._shouldCheckSampling=!0,!0}return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._context.model.invalidateMinimapColorCache(),this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(const n of e.ranges){const e=this._samplingState.modelLineRangeToMinimapLineRange(n.fromLineNumber,n.toLineNumber);e&&t.push({fromLineNumber:e[0],toLineNumber:e[1]})}return!!t.length&&this._actual.onTokensChanged(t)}return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),n=this._samplingState.modelLineToMinimapLine(n));const i={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:n,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(i)}_recreateLineSampling(){this._minimapSelections=null;const e=Boolean(this._samplingState),[t,n]=Uoe.compute(this.options,this._context.model.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const i of n)switch(i.type){case"deleted":this._actual.onLinesDeleted(i.deleteFromLineNumber,i.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(i.insertFromLineNumber,i.insertToLineNumber);break;case"flush":this._actual.onFlushed()}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.model.getLineCount()}getRealLineCount(){return this._context.model.getLineCount()}getLineContent(e){return this._samplingState?this._context.model.getLineContent(this._samplingState.minimapLines[e-1]):this._context.model.getLineContent(e)}getMinimapLinesRenderingData(e,t,n){if(this._samplingState){let i=[];for(let r=0,o=t-e+1;r<o;r++)n[r]?i[r]=this._context.model.getViewLineData(this._samplingState.minimapLines[e+r-1]):i[r]=null;return i}return this._context.model.getMinimapLinesRenderingData(e,t,n).data}getSelections(){if(null===this._minimapSelections)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,n]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new MK(t,e.startColumn,n,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let n;if(this._samplingState){const i=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];n=new TK(i,1,r,this._context.model.getLineMaxColumn(r))}else n=new TK(e,1,t,this._context.model.getLineMaxColumn(t));const i=this._context.model.getDecorationsInViewport(n);if(this._samplingState){let e=[];for(const t of i){if(!t.options.minimap)continue;const n=t.range,i=this._samplingState.modelLineToMinimapLine(n.startLineNumber),r=this._samplingState.modelLineToMinimapLine(n.endLineNumber);e.push(new M2(new TK(i,n.startColumn,r,n.endColumn),t.options))}return e}return i}getOptions(){return this._context.model.getTextModelOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.model.revealRange("mouse",!1,new TK(e,1,e,1),1,0)}setScrollTop(e){this._context.model.setScrollPosition({scrollTop:e},1)}}class joe extends mG{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(Hne),this._domNode=I6(document.createElement("div")),q6.write(this._domNode,8),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=I6(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=I6(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=I6(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=I6(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=I6(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._mouseDownListener=eY(this._domNode.domNode,"mousedown",(e=>{e.preventDefault();if(0===this._model.options.renderMinimap)return;if(!this._lastRenderData)return;if("proportional"!==this._model.options.size){if(e.leftButton&&this._lastRenderData){const t=mY(this._slider.domNode),n=t.top+t.height/2;this._startSliderDragging(e.buttons,e.posx,n,e.posy,this._lastRenderData.renderedLayout)}return}const t=this._model.options.minimapLineHeight,n=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*e.browserEvent.offsetY;let i=Math.floor(n/t)+this._lastRenderData.renderedLayout.startLineNumber;i=Math.min(i,this._model.getLineCount()),this._model.revealLineNumber(i)})),this._sliderMouseMoveMonitor=new P6,this._sliderMouseDownListener=eY(this._slider.domNode,"mousedown",(e=>{e.preventDefault(),e.stopPropagation(),e.leftButton&&this._lastRenderData&&this._startSliderDragging(e.buttons,e.posx,e.posy,e.posy,this._lastRenderData.renderedLayout)})),this._gestureDisposable=O6.addTarget(this._domNode.domNode),this._sliderTouchStartListener=Q$(this._domNode.domNode,M6.Start,(e=>{e.preventDefault(),e.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(e))}),{passive:!1}),this._sliderTouchMoveListener=Q$(this._domNode.domNode,M6.Change,(e=>{e.preventDefault(),e.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(e)}),{passive:!1}),this._sliderTouchEndListener=eY(this._domNode.domNode,M6.End,(e=>{e.preventDefault(),e.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)}))}_startSliderDragging(e,t,n,i,r){this._slider.toggleClassName("active",!0);const o=(e,i)=>{const o=Math.abs(i-t);if(aj&&o>140)return void this._model.setScrollTop(r.scrollTop);const s=e-n;this._model.setScrollTop(r.getDesiredScrollTopFromDelta(s))};i!==n&&o(i,t),this._sliderMouseMoveMonitor.startMonitoring(this._slider.domNode,e,R6,(e=>o(e.posy,e.posx)),(()=>{this._slider.toggleClassName("active",!1)}))}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,n=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(n)}dispose(){this._mouseDownListener.dispose(),this._sliderMouseMoveMonitor.dispose(),this._sliderMouseDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){return"always"===this._model.options.showSlider?"minimap slider-always":"minimap slider-mouseover"}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new Voe(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return!!this._lastRenderData&&this._lastRenderData.onLinesChanged(e,t)}onLinesDeleted(e,t){return this._lastRenderData&&this._lastRenderData.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData&&this._lastRenderData.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(Hne),this._renderDecorations=!0,!0}onTokensChanged(e){return!!this._lastRenderData&&this._lastRenderData.onTokensChanged(e)}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(0===this._model.options.renderMinimap)return this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),void this._sliderHorizontal.setHeight(0);e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const t=Boe.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(t.sliderNeeded?"block":"none"),this._slider.setTop(t.sliderTop),this._slider.setHeight(t.sliderHeight);const n=e.scrollLeft/this._model.options.typicalHalfwidthCharacterWidth,i=Math.min(this._model.options.minimapWidth,Math.round(n*this._model.options.minimapCharWidth/this._model.options.pixelRatio));this._sliderHorizontal.setLeft(i),this._sliderHorizontal.setWidth(this._model.options.minimapWidth-i),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(t.sliderHeight),this.renderDecorations(t),this._lastRenderData=this.renderLines(t)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections(),n=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber),{canvasInnerWidth:i,canvasInnerHeight:r}=this._model.options,o=this._model.options.minimapLineHeight,s=this._model.options.minimapCharWidth,a=this._model.getOptions().tabSize,l=this._decorationsCanvas.domNode.getContext("2d");l.clearRect(0,0,i,r);const c=new Map;for(let u=0;u<t.length;u++){const n=t[u];for(let t=n.startLineNumber;t<=n.endLineNumber;t++)this.renderDecorationOnLine(l,c,n,this._selectionColor,e,t,o,o,a,s)}for(let u=0;u<n.length;u++){const t=n[u];if(!t.options.minimap)continue;const i=t.options.minimap.getColor(this._theme);for(let n=t.range.startLineNumber;n<=t.range.endLineNumber;n++)switch(t.options.minimap.position){case CQ.Inline:this.renderDecorationOnLine(l,c,t.range,i,e,n,o,o,a,s);continue;case CQ.Gutter:const r=(n-e.startLineNumber)*o,u=2;this.renderDecoration(l,i,u,r,2,o);continue}}}}renderDecorationOnLine(e,t,n,i,r,o,s,a,l,c){const u=(o-r.startLineNumber)*a;if(u+s<0||u>this._model.options.canvasInnerHeight)return;let h=t.get(o);const d=!h;if(!h){const e=this._model.getLineContent(o);h=[8];for(let t=1;t<e.length+1;t++){const n=e.charCodeAt(t-1),i=9===n?l*c:WX(n)?2*c:c;h[t]=h[t-1]+i}t.set(o,h)}const{startColumn:f,endColumn:g,startLineNumber:p,endLineNumber:m}=n,v=p===o?h[f-1]:8,y=m>o?h.length-1:g-1;if(y>0){const t=h[y]-v||2;this.renderDecoration(e,i,v,u,t,s)}d&&this.renderLineHighlight(e,i,u,s)}renderLineHighlight(e,t,n,i){e.fillStyle=t&&t.transparent(.5).toString()||"",e.fillRect(8,n,e.canvas.width,i)}renderDecoration(e,t,n,i,r,o){e.fillStyle=t&&t.toString()||"",e.fillRect(n,i,r,o)}renderLines(e){const t=e.startLineNumber,n=e.endLineNumber,i=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const t=this._lastRenderData._get();return new zoe(e,t.imageData,t.lines)}const r=this._getBuffer();if(!r)return null;let[o,s,a]=joe._renderUntouchedLines(r,t,n,i,this._lastRenderData);const l=this._model.getMinimapLinesRenderingData(t,n,a),c=this._model.getOptions().tabSize,u=this._model.options.backgroundColor,h=this._model.tokensColorTracker,d=h.backgroundIsLight(),f=this._model.options.renderMinimap,g=this._model.options.charRenderer(),p=this._model.options.fontScale,m=this._model.options.minimapCharWidth,v=(1===f?2:3)*p,y=i>v?Math.floor((i-v)/2):0;let _=0;const b=[];for(let S=0,x=n-t+1;S<x;S++)a[S]&&joe._renderLine(r,u,d,f,m,h,g,_,y,c,l[S],p,i),b[S]=new Woe(_),_+=i;const w=-1===o?0:o,C=(-1===s?r.height:s)-w;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,w,r.width,C),new zoe(e,r,b)}static _renderUntouchedLines(e,t,n,i,r){const o=[];if(!r){for(let e=0,i=n-t+1;e<i;e++)o[e]=!0;return[-1,-1,o]}const s=r._get(),a=s.imageData.data,l=s.rendLineNumberStart,c=s.lines,u=c.length,h=e.width,d=e.data,f=(n-t+1)*i*h*4;let g=-1,p=-1,m=-1,v=-1,y=-1,_=-1,b=0;for(let w=t;w<=n;w++){const e=w-t,n=w-l,r=n>=0&&n<u?c[n].dy:-1;if(-1===r){o[e]=!0,b+=i;continue}const s=r*h*4,C=(r+i)*h*4,S=b*h*4,x=(b+i)*h*4;v===s&&_===S?(v=C,_=x):(-1!==m&&(d.set(a.subarray(m,v),y),-1===g&&0===m&&m===y&&(g=v),-1===p&&v===f&&m===y&&(p=m)),m=s,v=C,y=S,_=x),o[e]=!1,b+=i}-1!==m&&(d.set(a.subarray(m,v),y),-1===g&&0===m&&m===y&&(g=v),-1===p&&v===f&&m===y&&(p=m));return[-1===g?-1:g/(4*h),-1===p?-1:p/(4*h),o]}static _renderLine(e,t,n,i,r,o,s,a,l,c,u,h,d){const f=u.content,g=u.tokens,p=e.width-r,m=1===d;let v=8,y=0,_=0;for(let b=0,w=g.getCount();b<w;b++){const u=g.getEndOffset(b),d=g.getForeground(b),w=o.getColor(d);for(;y<u;y++){if(v>p)return;const o=f.charCodeAt(y);if(9===o){const e=c-(y+_)%c;_+=e-1,v+=e*r}else if(32===o)v+=r;else{const c=WX(o)?2:1;for(let u=0;u<c;u++)if(2===i?s.blockRenderChar(e,v,a+l,w,t,n,m):s.renderChar(e,v,a+l,o,w,t,h,n,m),v+=r,v>p)return}}}}}G5(((e,t)=>{const n=e.getColor(Kne);n&&t.addRule(`.monaco-editor .minimap > canvas { opacity: ${n.rgba.a}; will-change: opacity; }`);const i=e.getColor(qne);i&&t.addRule(`.monaco-editor .minimap-slider .minimap-slider-horizontal { background: ${i}; }`);const r=e.getColor($ne);r&&t.addRule(`.monaco-editor .minimap-slider:hover .minimap-slider-horizontal { background: ${r}; }`);const o=e.getColor(Yne);o&&t.addRule(`.monaco-editor .minimap-slider.active .minimap-slider-horizontal { background: ${o}; }`);const s=e.getColor(Qee);s&&t.addRule(`.monaco-editor .minimap-shadow-visible { box-shadow: ${s} -6px 0 6px -6px inset; }`)}));class Goe extends K6{constructor(e){super(e);const t=this._context.configuration.options.get(128);this._widgets={},this._verticalScrollbarWidth=t.verticalScrollbarWidth,this._minimapWidth=t.minimap.minimapWidth,this._horizontalScrollbarHeight=t.horizontalScrollbarHeight,this._editorHeight=t.height,this._editorWidth=t.width,this._domNode=I6(document.createElement("div")),q6.write(this._domNode,4),this._domNode.setClassName("overlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options.get(128);return this._verticalScrollbarWidth=t.verticalScrollbarWidth,this._minimapWidth=t.minimap.minimapWidth,this._horizontalScrollbarHeight=t.horizontalScrollbarHeight,this._editorHeight=t.height,this._editorWidth=t.width,!0}addWidget(e){const t=I6(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const n=this._widgets[e.getId()];return n.preference!==t&&(n.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const e=this._widgets[t].domNode.domNode;delete this._widgets[t],e.parentNode.removeChild(e),this.setShouldRender()}}_renderWidget(e){const t=e.domNode;if(null!==e.preference)if(0===e.preference)t.setTop(0),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth);else if(1===e.preference){const e=t.domNode.clientHeight;t.setTop(this._editorHeight-e-2*this._horizontalScrollbarHeight),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else 2===e.preference&&(t.setTop(0),t.domNode.style.right="50%");else t.unsetTop()}prepareRender(e){}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets);for(let n=0,i=t.length;n<i;n++){const e=t[n];this._renderWidget(this._widgets[e])}}}class Koe{constructor(e,t){const n=e.options;this.lineHeight=n.get(56),this.pixelRatio=n.get(126),this.overviewRulerLanes=n.get(71),this.renderBorder=n.get(70);const i=t.getColor(kie);this.borderColor=i?i.toString():null,this.hideCursor=n.get(48);const r=t.getColor(gie);this.cursorColor=r?r.transparent(.7).toString():null,this.themeType=t.type;const o=n.get(62),s=o.enabled,a=o.side,l=s?t.getColor(Lie)||YJ.getDefaultBackground():null;this.backgroundColor=null===l||"left"===a?null:Q8.Format.CSS.formatHex(l);const c=n.get(128).overviewRuler;this.top=c.top,this.right=c.right,this.domWidth=c.width,this.domHeight=c.height,0===this.overviewRulerLanes?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[u,h]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=u,this.w=h}_initLanes(e,t,n){const i=t-e;if(n>=3){const t=Math.floor(i/3),n=Math.floor(i/3),r=i-t-n,o=e+t;return[[0,e,o,e,e+t+r,e,o,e],[0,t,r,t+r,n,t+r+n,r+n,t+r+n]]}if(2===n){const t=Math.floor(i/2),n=i-t;return[[0,e,e,e,e+t,e,e,e],[0,t,t,t,n,t+n,t+n,t+n]]}return[[0,e,e,e,e,e,e,e],[0,i,i,i,i,i,i,i]]}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColor===e.cursorColor&&this.themeType===e.themeType&&this.backgroundColor===e.backgroundColor&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class qoe extends K6{constructor(e){super(e),this._domNode=I6(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=YJ.onDidChange((e=>{e.changedColorMap&&this._updateSettings(!0)})),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new Koe(this._context.configuration,this._context.theme);return(!this._settings||!this._settings.equals(t))&&(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}onConfigurationChanged(e){return this._updateSettings(!1)}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,n=e.selections.length;t<n;t++)this._cursorPositions[t]=e.selections[t].getPosition();return this._cursorPositions.sort(IK.compare),!0}onDecorationsChanged(e){return!!e.affectsOverviewRuler}onFlushed(e){return!0}onScrollChanged(e){return e.scrollHeightChanged}onZonesChanged(e){return!0}onThemeChanged(e){return this._context.model.invalidateOverviewRulerColorCache(),this._updateSettings(!1)}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render()}_render(){if(0===this._settings.overviewRulerLanes)return void this._domNode.setBackgroundColor(this._settings.backgroundColor?this._settings.backgroundColor:"");const e=this._settings.canvasWidth,t=this._settings.canvasHeight,n=this._settings.lineHeight,i=this._context.viewLayout,r=t/this._context.viewLayout.getScrollHeight(),o=this._context.model.getAllOverviewRulerDecorations(this._context.theme),s=6*this._settings.pixelRatio|0,a=s/2|0,l=this._domNode.domNode.getContext("2d");null===this._settings.backgroundColor?l.clearRect(0,0,e,t):(l.fillStyle=this._settings.backgroundColor,l.fillRect(0,0,e,t));const c=this._settings.x,u=this._settings.w,h=Object.keys(o);h.sort();for(let d=0,f=h.length;d<f;d++){const e=h[d],f=o[e];l.fillStyle=e;let g=0,p=0,m=0;for(let o=0,h=f.length;o<h;o++){const e=f[3*o],h=f[3*o+1],d=f[3*o+2];let v=i.getVerticalOffsetForLineNumber(h)*r|0,y=(i.getVerticalOffsetForLineNumber(d)+n)*r|0;if(y-v<s){let e=(v+y)/2|0;e<a?e=a:e+a>t&&(e=t-a),v=e-a,y=e+a}v>m+1||e!==g?(0!==o&&l.fillRect(c[g],p,u[g],m-p),g=e,p=v,m=y):y>m&&(m=y)}l.fillRect(c[g],p,u[g],m-p)}if(!this._settings.hideCursor&&this._settings.cursorColor){const e=2*this._settings.pixelRatio|0,n=e/2|0,o=this._settings.x[7],s=this._settings.w[7];l.fillStyle=this._settings.cursorColor;let a=-100,c=-100;for(let u=0,h=this._cursorPositions.length;u<h;u++){const h=this._cursorPositions[u];let d=i.getVerticalOffsetForLineNumber(h.lineNumber)*r|0;d<n?d=n:d+n>t&&(d=t-n);const f=d-n,g=f+e;f>c+1?(0!==u&&l.fillRect(o,a,s,c-a),a=f,c=g):g>c&&(c=g)}l.fillRect(o,a,s,c-a)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(l.beginPath(),l.lineWidth=1,l.strokeStyle=this._settings.borderColor,l.moveTo(0,0),l.lineTo(0,t),l.stroke(),l.moveTo(0,0),l.lineTo(e,0),l.stroke())}}class $oe{constructor(e,t,n){this._colorZoneBrand=void 0,this.from=0|e,this.to=0|t,this.colorId=0|n}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class Yoe{constructor(e,t,n){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class Xoe{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(Yoe.compare)}setLineHeight(e){return this._lineHeight!==e&&(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth!==e&&(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight!==e&&(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight!==e&&(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),n=Math.floor(this.getCanvasHeight()),i=n/Math.floor(this._outerHeight),r=Math.floor(4*this._pixelRatio/2);let o=[];for(let s=0,a=this._zones.length;s<a;s++){const a=this._zones[s];if(!e){const e=a.getColorZones();if(e){o.push(e);continue}}const l=Math.floor(i*this._getVerticalOffsetForLine(a.startLineNumber)),c=Math.floor(i*(this._getVerticalOffsetForLine(a.endLineNumber)+t));let u=Math.floor((l+c)/2),h=c-u;h<r&&(h=r),u-h<0&&(u=h),u+h>n&&(u=n-h);const d=a.color;let f=this._color2Id[d];f||(f=++this._lastAssignedId,this._color2Id[d]=f,this._id2Color[f]=d);const g=new $oe(u-h,u+h,f);a.setColorZone(g),o.push(g)}return this._colorZonesInvalid=!1,o.sort($oe.compare),o}}class Zoe extends G6{constructor(e,t){super(),this._context=e;const n=this._context.configuration.options;this._domNode=I6(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new Xoe((e=>this._context.viewLayout.getVerticalOffsetForLineNumber(e))),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(n.get(56)),this._zoneManager.setPixelRatio(n.get(126)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(56)&&(this._zoneManager.setLineHeight(t.get(56)),this._render()),e.hasChanged(126)&&(this._zoneManager.setPixelRatio(t.get(126)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(0===this._zoneManager.getOuterHeight())return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),n=this._zoneManager.resolveColorZones(),i=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),n.length>0&&this._renderOneLane(r,n,i,e),!0}_renderOneLane(e,t,n,i){let r=0,o=0,s=0;for(const a of t){const t=a.colorId,l=a.from,c=a.to;t!==r?(e.fillRect(0,o,i,s-o),r=t,e.fillStyle=n[r],o=l,s=c):s>=l?s=Math.max(s,c):(e.fillRect(0,o,i,s-o),o=l,s=c)}e.fillRect(0,o,i,s-o)}}class Qoe extends K6{constructor(e){super(e),this.domNode=I6(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(89),this._typicalHalfwidthCharacterWidth=t.get(40).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(89),this._typicalHalfwidthCharacterWidth=t.get(40).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:n}=this._context.model.getTextModelOptions(),i=n;let r=t-e;for(;r>0;){const e=I6(document.createElement("div"));e.setClassName("view-ruler"),e.setWidth(i),this.domNode.appendChild(e),this._renderedRulers.push(e),r--}return}let n=e-t;for(;n>0;){const e=this._renderedRulers.pop();this.domNode.removeChild(e),n--}}render(e){this._ensureRulersCount();for(let t=0,n=this._rulers.length;t<n;t++){const n=this._renderedRulers[t],i=this._rulers[t];n.setBoxShadow(i.color?`1px 0 0 0 ${i.color} inset`:""),n.setHeight(Math.min(e.scrollHeight,1e6)),n.setLeft(i.column*this._typicalHalfwidthCharacterWidth)}}}G5(((e,t)=>{const n=e.getColor(Cie);n&&t.addRule(`.monaco-editor .view-ruler { box-shadow: 1px 0 0 0 ${n} inset; }`)}));class Joe extends K6{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const t=this._context.configuration.options.get(90);this._useShadows=t.useShadows,this._domNode=I6(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e&&(this._shouldShow=e,!0)}getDomNode(){return this._domNode}_updateWidth(){const e=this._context.configuration.options.get(128);0===e.minimap.renderMinimap||e.minimap.minimapWidth>0&&0===e.minimap.minimapLeft?this._width=e.width:this._width=e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}onConfigurationChanged(e){const t=this._context.configuration.options.get(90);return this._useShadows=t.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}G5(((e,t)=>{const n=e.getColor(Qee);n&&t.addRule(`.monaco-editor .scroll-decoration { box-shadow: ${n} 0 6px 6px -6px inset; }`)}));class ese{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class tse{constructor(e,t){this.lineNumber=e,this.ranges=t}}function nse(e){return new ese(e)}function ise(e){return new tse(e.lineNumber,e.ranges.map(nse))}class rse extends mee{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(56),this._roundedSelection=t.get(88),this._typicalHalfwidthCharacterWidth=t.get(40).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(56),this._roundedSelection=t.get(88),this._typicalHalfwidthCharacterWidth=t.get(40).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,n=e.length;t<n;t++){if(e[t].ranges.length>1)return!0}return!1}_enrichVisibleRangesWithStyle(e,t,n){const i=this._typicalHalfwidthCharacterWidth/4;let r=null,o=null;if(n&&n.length>0&&t.length>0){const i=t[0].lineNumber;if(i===e.startLineNumber)for(let e=0;!r&&e<n.length;e++)n[e].lineNumber===i&&(r=n[e].ranges[0]);const s=t[t.length-1].lineNumber;if(s===e.endLineNumber)for(let e=n.length-1;!o&&e>=0;e--)n[e].lineNumber===s&&(o=n[e].ranges[0]);r&&!r.startStyle&&(r=null),o&&!o.startStyle&&(o=null)}for(let s=0,a=t.length;s<a;s++){const e=t[s].ranges[0],n=e.left,l=e.left+e.width,c={top:0,bottom:0},u={top:0,bottom:0};if(s>0){const e=t[s-1].ranges[0].left,r=t[s-1].ranges[0].left+t[s-1].ranges[0].width;ose(n-e)<i?c.top=2:n>e&&(c.top=1),ose(l-r)<i?u.top=2:e<l&&l<r&&(u.top=1)}else r&&(c.top=r.startStyle.top,u.top=r.endStyle.top);if(s+1<a){const e=t[s+1].ranges[0].left,r=t[s+1].ranges[0].left+t[s+1].ranges[0].width;ose(n-e)<i?c.bottom=2:e<n&&n<r&&(c.bottom=1),ose(l-r)<i?u.bottom=2:l<r&&(u.bottom=1)}else o&&(c.bottom=o.startStyle.bottom,u.bottom=o.endStyle.bottom);e.startStyle=c,e.endStyle=u}}_getVisibleRangesWithStyle(e,t,n){const i=(t.linesVisibleRangesForRange(e,!0)||[]).map(ise);return!this._visibleRangesHaveGaps(i)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,i,n),i}_createSelectionPiece(e,t,n,i,r){return'<div class="cslr '+n+'" style="top:'+e.toString()+"px;left:"+i.toString()+"px;width:"+r.toString()+"px;height:"+t+'px;"></div>'}_actualRenderOneSelection(e,t,n,i){if(0===i.length)return;const r=!!i[0].ranges[0].startStyle,o=this._lineHeight.toString(),s=(this._lineHeight-1).toString(),a=i[0].lineNumber,l=i[i.length-1].lineNumber;for(let c=0,u=i.length;c<u;c++){const u=i[c],h=u.lineNumber,d=h-t,f=n&&(h===l||h===a)?s:o,g=n&&h===a?1:0;let p="",m="";for(let e=0,t=u.ranges.length;e<t;e++){const t=u.ranges[e];if(r){const e=t.startStyle,n=t.endStyle;if(1===e.top||1===e.bottom){p+=this._createSelectionPiece(g,f,rse.SELECTION_CLASS_NAME,t.left-rse.ROUNDED_PIECE_WIDTH,rse.ROUNDED_PIECE_WIDTH);let n=rse.EDITOR_BACKGROUND_CLASS_NAME;1===e.top&&(n+=" "+rse.SELECTION_TOP_RIGHT),1===e.bottom&&(n+=" "+rse.SELECTION_BOTTOM_RIGHT),p+=this._createSelectionPiece(g,f,n,t.left-rse.ROUNDED_PIECE_WIDTH,rse.ROUNDED_PIECE_WIDTH)}if(1===n.top||1===n.bottom){p+=this._createSelectionPiece(g,f,rse.SELECTION_CLASS_NAME,t.left+t.width,rse.ROUNDED_PIECE_WIDTH);let e=rse.EDITOR_BACKGROUND_CLASS_NAME;1===n.top&&(e+=" "+rse.SELECTION_TOP_LEFT),1===n.bottom&&(e+=" "+rse.SELECTION_BOTTOM_LEFT),p+=this._createSelectionPiece(g,f,e,t.left+t.width,rse.ROUNDED_PIECE_WIDTH)}}let n=rse.SELECTION_CLASS_NAME;if(r){const e=t.startStyle,i=t.endStyle;0===e.top&&(n+=" "+rse.SELECTION_TOP_LEFT),0===e.bottom&&(n+=" "+rse.SELECTION_BOTTOM_LEFT),0===i.top&&(n+=" "+rse.SELECTION_TOP_RIGHT),0===i.bottom&&(n+=" "+rse.SELECTION_BOTTOM_RIGHT)}m+=this._createSelectionPiece(g,f,n,t.left,t.width)}e[d][0]+=p,e[d][1]+=m}}prepareRender(e){const t=[],n=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;for(let o=n;o<=i;o++){t[o-n]=["",""]}const r=[];for(let o=0,s=this._selections.length;o<s;o++){const i=this._selections[o];if(i.isEmpty()){r[o]=null;continue}const s=this._getVisibleRangesWithStyle(i,e,this._previousFrameVisibleRangesWithStyle[o]);r[o]=s,this._actualRenderOneSelection(t,n,this._selections.length>1,s)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map((([e,t])=>e+t))}render(e,t){if(!this._renderResult)return"";const n=t-e;return n<0||n>=this._renderResult.length?"":this._renderResult[n]}}function ose(e){return e<0?-e:e}rse.SELECTION_CLASS_NAME="selected-text",rse.SELECTION_TOP_LEFT="top-left-radius",rse.SELECTION_BOTTOM_LEFT="bottom-left-radius",rse.SELECTION_TOP_RIGHT="top-right-radius",rse.SELECTION_BOTTOM_RIGHT="bottom-right-radius",rse.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",rse.ROUNDED_PIECE_WIDTH=10,G5(((e,t)=>{const n=e.getColor(Nte);n&&t.addRule(`.monaco-editor .focused .selected-text { background-color: ${n}; }`);const i=e.getColor(Tte);i&&t.addRule(`.monaco-editor .selected-text { background-color: ${i}; }`);const r=e.getColor(Ite);r&&!r.isTransparent()&&t.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${r}; }`)}));class sse{constructor(e,t,n,i,r,o){this.top=e,this.left=t,this.width=n,this.height=i,this.textContent=r,this.textContentClassName=o}}class ase{constructor(e){this._context=e;const t=this._context.configuration.options,n=t.get(40);this._cursorStyle=t.get(22),this._lineHeight=t.get(56),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(25),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=I6(document.createElement("div")),this._domNode.setClassName("cursor monaco-mouse-cursor-text"),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),D6.applyFontInfo(this._domNode,n),this._domNode.setDisplay("none"),this._position=new IK(1,1),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,n=t.get(40);return this._cursorStyle=t.get(22),this._lineHeight=t.get(56),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(25),this._typicalHalfwidthCharacterWidth),D6.applyFontInfo(this._domNode,n),!0}onCursorPositionChanged(e){return this._position=e,!0}_prepareRender(e){let t="";if(this._cursorStyle===Bj.Line||this._cursorStyle===Bj.LineThin){const n=e.visibleRangeForPosition(this._position);if(!n||n.outsideRenderedLine)return null;let i;if(this._cursorStyle===Bj.Line){if(i=YY(this._lineCursorWidth>0?this._lineCursorWidth:2),i>2){const e=this._context.model.getLineContent(this._position.lineNumber),n=TX(e,this._position.column-1);t=e.substr(this._position.column-1,n)}}else i=YY(1);let r=n.left;i>=2&&r>=1&&(r-=1);const o=e.getVerticalOffsetForLineNumber(this._position.lineNumber)-e.bigNumbersDelta;return new sse(o,r,i,this._lineHeight,t,"")}const n=this._context.model.getLineContent(this._position.lineNumber),i=TX(n,this._position.column-1),r=e.linesVisibleRangesForRange(new TK(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column+i),!1);if(!r||0===r.length)return null;const o=r[0];if(o.outsideRenderedLine||0===o.ranges.length)return null;const s=o.ranges[0],a=s.width<1?this._typicalHalfwidthCharacterWidth:s.width;let l="";if(this._cursorStyle===Bj.Block){const e=this._context.model.getViewLineData(this._position.lineNumber);t=n.substr(this._position.column-1,i);const r=e.tokens.findTokenIndexAtOffset(this._position.column-1);l=e.tokens.getClassName(r)}let c=e.getVerticalOffsetForLineNumber(this._position.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return this._cursorStyle!==Bj.Underline&&this._cursorStyle!==Bj.UnderlineThin||(c+=this._lineHeight-2,u=2),new sse(c,s.left,a,u,t,l)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor monaco-mouse-cursor-text ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class lse extends K6{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(78),this._cursorBlinking=t.get(20),this._cursorStyle=t.get(22),this._cursorSmoothCaretAnimation=t.get(21),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new ase(this._context),this._secondaryCursors=[],this._renderData=[],this._domNode=I6(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new B$,this._cursorFlatBlinkInterval=new W$,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(78),this._cursorBlinking=t.get(20),this._cursorStyle=t.get(22),this._cursorSmoothCaretAnimation=t.get(21),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let n=0,i=this._secondaryCursors.length;n<i;n++)this._secondaryCursors[n].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t){if(this._primaryCursor.onCursorPositionChanged(e),this._updateBlinking(),this._secondaryCursors.length<t.length){const e=t.length-this._secondaryCursors.length;for(let t=0;t<e;t++){const e=new ase(this._context);this._domNode.domNode.insertBefore(e.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(e)}}else if(this._secondaryCursors.length>t.length){const e=this._secondaryCursors.length-t.length;for(let t=0;t<e;t++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let n=0;n<t.length;n++)this._secondaryCursors[n].onCursorPositionChanged(t[n])}onCursorStateChanged(e){const t=[];for(let i=0,r=e.selections.length;i<r;i++)t[i]=e.selections[i].getPosition();this._onCursorPositionChanged(t[0],t.slice(1));const n=e.selections[0].isEmpty();return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=t=>{for(let n=0,i=e.ranges.length;n<i;n++)if(e.ranges[n].fromLineNumber<=t.lineNumber&&t.lineNumber<=e.ranges[n].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const n of this._secondaryCursors)if(t(n.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=0===e,n=5===e;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),t||n||(1===e?this._cursorFlatBlinkInterval.cancelAndSet((()=>{this._isVisible?this._hide():this._show()}),lse.BLINK_INTERVAL):this._startCursorBlinkAnimation.setIfNotSet((()=>{this._blinkingEnabled=!0,this._updateDomClassName()}),lse.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case Bj.Line:e+=" cursor-line-style";break;case Bj.Block:e+=" cursor-block-style";break;case Bj.Underline:e+=" cursor-underline-style";break;case Bj.LineThin:e+=" cursor-line-thin-style";break;case Bj.BlockOutline:e+=" cursor-block-outline-style";break;case Bj.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return this._cursorSmoothCaretAnimation&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,n=this._secondaryCursors.length;t<n;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],n=0;const i=this._primaryCursor.render(e);i&&(t[n++]=i);for(let r=0,o=this._secondaryCursors.length;r<o;r++){const i=this._secondaryCursors[r].render(e);i&&(t[n++]=i)}this._renderData=t}getLastRenderData(){return this._renderData}}lse.BLINK_INTERVAL=500,G5(((e,t)=>{const n=e.getColor(gie);if(n){let i=e.getColor(pie);i||(i=n.opposite()),t.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${n}; border-color: ${n}; color: ${i}; }`),"hc"===e.type&&t.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${i}; border-right: 1px solid ${i}; }`)}}));const cse=()=>{throw new Error("Invalid change accessor")};class use extends K6{constructor(e){super(e);const t=this._context.configuration.options,n=t.get(128);this._lineHeight=t.get(56),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,this.domNode=I6(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=I6(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const i of e)t.set(i.id,i);let n=!1;return this._context.model.changeWhitespace((e=>{const i=Object.keys(this._zones);for(let r=0,o=i.length;r<o;r++){const o=i[r],s=this._zones[o],a=this._computeWhitespaceProps(s.delegate),l=t.get(o);!l||l.afterLineNumber===a.afterViewLineNumber&&l.height===a.heightInPx||(e.changeOneWhitespace(o,a.afterViewLineNumber,a.heightInPx),this._safeCallOnComputedHeight(s.delegate,a.heightInPx),n=!0)}})),n}onConfigurationChanged(e){const t=this._context.configuration.options,n=t.get(128);return this._lineHeight=t.get(56),this._contentWidth=n.contentWidth,this._contentLeft=n.contentLeft,e.hasChanged(56)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return void 0!==e.afterColumn?e.afterColumn:1e4}_computeWhitespaceProps(e){if(0===e.afterLineNumber)return{afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t,n;if(void 0!==e.afterColumn)t=this._context.model.validateModelPosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const n=this._context.model.validateModelPosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new IK(n,this._context.model.getModelLineMaxColumn(n))}n=t.column===this._context.model.getModelLineMaxColumn(t.lineNumber)?this._context.model.validateModelPosition({lineNumber:t.lineNumber+1,column:1}):this._context.model.validateModelPosition({lineNumber:t.lineNumber,column:t.column+1});const i=this._context.model.coordinatesConverter.convertModelPositionToViewPosition(t),r=this._context.model.coordinatesConverter.modelPositionIsVisible(n);return{afterViewLineNumber:i.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.model.changeWhitespace((n=>{const i={addZone:e=>(t=!0,this._addZone(n,e)),removeZone:e=>{e&&(t=this._removeZone(n,e)||t)},layoutZone:e=>{e&&(t=this._layoutZone(n,e)||t)}};!function(e,t){try{e(t)}catch(zWe){nG(zWe)}}(e,i),i.addZone=cse,i.removeZone=cse,i.layoutZone=cse})),t}_addZone(e,t){const n=this._computeWhitespaceProps(t),i={whitespaceId:e.insertWhitespace(n.afterViewLineNumber,this._getZoneOrdinal(t),n.heightInPx,n.minWidthInPx),delegate:t,isVisible:!1,domNode:I6(t.domNode),marginDomNode:t.marginDomNode?I6(t.marginDomNode):null};return this._safeCallOnComputedHeight(i.delegate,n.heightInPx),i.domNode.setPosition("absolute"),i.domNode.domNode.style.width="100%",i.domNode.setDisplay("none"),i.domNode.setAttribute("monaco-view-zone",i.whitespaceId),this.domNode.appendChild(i.domNode),i.marginDomNode&&(i.marginDomNode.setPosition("absolute"),i.marginDomNode.domNode.style.width="100%",i.marginDomNode.setDisplay("none"),i.marginDomNode.setAttribute("monaco-view-zone",i.whitespaceId),this.marginDomNode.appendChild(i.marginDomNode)),this._zones[i.whitespaceId]=i,this.setShouldRender(),i.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const n=this._zones[t];return delete this._zones[t],e.removeWhitespace(n.whitespaceId),n.domNode.removeAttribute("monaco-visible-view-zone"),n.domNode.removeAttribute("monaco-view-zone"),n.domNode.domNode.parentNode.removeChild(n.domNode.domNode),n.marginDomNode&&(n.marginDomNode.removeAttribute("monaco-visible-view-zone"),n.marginDomNode.removeAttribute("monaco-view-zone"),n.marginDomNode.domNode.parentNode.removeChild(n.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const n=this._zones[t],i=this._computeWhitespaceProps(n.delegate);return e.changeOneWhitespace(n.whitespaceId,i.afterViewLineNumber,i.heightInPx),this._safeCallOnComputedHeight(n.delegate,i.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){if(this._zones.hasOwnProperty(e)){const t=this._zones[e];return Boolean(t.delegate.suppressMouseDown)}return!1}_heightInPixels(e){return"number"==typeof e.heightInPx?e.heightInPx:"number"==typeof e.heightInLines?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return"number"==typeof e.minWidthInPx?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if("function"==typeof e.onComputedHeight)try{e.onComputedHeight(t)}catch(zWe){nG(zWe)}}_safeCallOnDomNodeTop(e,t){if("function"==typeof e.onDomNodeTop)try{e.onDomNodeTop(t)}catch(zWe){nG(zWe)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,n={};let i=!1;for(let o=0,s=t.length;o<s;o++)n[t[o].id]=t[o],i=!0;const r=Object.keys(this._zones);for(let o=0,s=r.length;o<s;o++){const t=r[o],i=this._zones[t];let s=0,a=0,l="none";n.hasOwnProperty(t)?(s=n[t].verticalOffset-e.bigNumbersDelta,a=n[t].height,l="block",i.isVisible||(i.domNode.setAttribute("monaco-visible-view-zone","true"),i.isVisible=!0),this._safeCallOnDomNodeTop(i.delegate,e.getScrolledTopFromAbsoluteTop(n[t].verticalOffset))):(i.isVisible&&(i.domNode.removeAttribute("monaco-visible-view-zone"),i.isVisible=!1),this._safeCallOnDomNodeTop(i.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),i.domNode.setTop(s),i.domNode.setHeight(a),i.domNode.setDisplay(l),i.marginDomNode&&(i.marginDomNode.setTop(s),i.marginDomNode.setHeight(a),i.marginDomNode.setDisplay(l))}i&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}class hse{constructor(e){this._theme=e}get type(){return this._theme.type}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class dse{constructor(e,t,n){this.configuration=e,this.theme=new hse(t),this.model=n,this.viewLayout=n.viewLayout}addEventHandler(e){this.model.addViewEventHandler(e)}removeEventHandler(e){this.model.removeViewEventHandler(e)}}class fse{constructor(e,t,n,i){this.selections=e,this.startLineNumber=0|t.startLineNumber,this.endLineNumber=0|t.endLineNumber,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=0|t.bigNumbersDelta,this.whitespaceViewportData=n,this._model=i,this.visibleRange=new TK(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class gse extends G6{constructor(e,t,n,i,r,o){super(),this._selections=[new MK(1,1,1,1)],this._renderAnimationFrame=null;const s=new Ire(t,i,r,e);this._context=new dse(t,n.getColorTheme(),i),this._configPixelRatio=this._context.configuration.options.get(126),this._context.addEventHandler(this),this._register(n.onDidColorThemeChange((e=>{this._context.theme.update(e),this._context.model.onDidColorThemeChange(),this.render(!0,!1)}))),this._viewParts=[],this._textAreaHandler=new Uie(this._context,s,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=I6(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=I6(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=I6(document.createElement("div")),q6.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new voe(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new Eoe(this._context,this._linesContent),this._viewZones=new use(this._context),this._viewParts.push(this._viewZones);const a=new qoe(this._context);this._viewParts.push(a);const l=new Joe(this._context);this._viewParts.push(l);const c=new Bre(this._context);this._viewParts.push(c),c.addDynamicOverlay(new Kre(this._context)),c.addDynamicOverlay(new rse(this._context)),c.addDynamicOverlay(new woe(this._context)),c.addDynamicOverlay(new $re(this._context));const u=new Wre(this._context);this._viewParts.push(u),u.addDynamicOverlay(new qre(this._context)),u.addDynamicOverlay(new boe(this._context)),u.addDynamicOverlay(new Loe(this._context)),u.addDynamicOverlay(new koe(this._context)),u.addDynamicOverlay(new Bie(this._context));const h=new Wie(this._context);h.getDomNode().appendChild(this._viewZones.marginDomNode),h.getDomNode().appendChild(u.getDomNode()),this._viewParts.push(h),this._contentWidgets=new Vre(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new lse(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new Goe(this._context),this._viewParts.push(this._overlayWidgets);const d=new Qoe(this._context);this._viewParts.push(d);const f=new Hoe(this._context);if(this._viewParts.push(f),a){const e=this._scrollbar.getOverviewRulerLayoutInfo();e.parent.insertBefore(a.getDomNode(),e.insertBefore)}this._linesContent.appendChild(c.getDomNode()),this._linesContent.appendChild(d.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(h.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(l.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(f.getDomNode()),this.domNode.appendChild(this._overflowGuardContainer),o?o.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new pee(this._context,s,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){this._renderNow()}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new B7(e,t)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new IK(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPositionRelativeToEditor:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new IK(e,t)))}}_applyLayout(){const e=this._context.configuration.options.get(128);this.domNode.setWidth(e.width),this.domNode.setHeight(e.height),this._overflowGuardContainer.setWidth(e.width),this._overflowGuardContainer.setHeight(e.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(125)+" "+U5(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this._configPixelRatio=this._context.configuration.options.get(126),this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){null!==this._renderAnimationFrame&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){null===this._renderAnimationFrame&&(this._renderAnimationFrame=rY(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){!function(e){try{e()}catch(zWe){nG(zWe)}}((()=>this._actualRender()))}_getViewPartsToRender(){let e=[],t=0;for(const n of this._viewParts)n.shouldRender()&&(e[t++]=n);return e}_actualRender(){if(!X$(this.domNode.domNode))return;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&0===e.length)return;const t=this._context.viewLayout.getLinesViewportData();this._context.model.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const n=new fse(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.model);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(n),this._viewLines.shouldRender()&&(this._viewLines.renderText(n),this._viewLines.onDidRender(),e=this._getViewPartsToRender());const i=new $6(this._context.viewLayout,n,this._viewLines);for(const r of e)r.prepareRender(i);for(const r of e)r.render(i),r.onDidRender();Math.abs(c$()-this._configPixelRatio)>.001&&this._context.configuration.updatePixelRatio()}delegateVerticalScrollbarMouseDown(e){this._scrollbar.delegateVerticalScrollbarMouseDown(e)}restoreState(e){this._context.model.setScrollPosition({scrollTop:e.scrollTop},1),this._context.model.tokenizeViewport(),this._renderNow(),this._viewLines.updateLineWidths(),this._context.model.setScrollPosition({scrollLeft:e.scrollLeft},1)}getOffsetForColumn(e,t){const n=this._context.model.validateModelPosition({lineNumber:e,column:t}),i=this._context.model.coordinatesConverter.convertModelPositionToViewPosition(n);this._flushAccumulatedAndRenderNow();const r=this._viewLines.visibleRangeForPosition(new IK(i.lineNumber,i.column));return r?r.left:-1}getTargetAtClientPoint(e,t){const n=this._pointerHandler.getTargetAtClientPoint(e,t);return n?Tre.convertViewToModelMouseTarget(n,this._context.model.coordinatesConverter):null}createOverviewRuler(e){return new Zoe(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const e of this._viewParts)e.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){let t=e.position&&e.position.range||null;if(null===t){const n=e.position?e.position.position:null;null!==n&&(t=new TK(n.lineNumber,n.column,n.lineNumber,n.column))}const n=e.position?e.position.preference:null;this._contentWidgets.setWidgetPosition(e.widget,t,n),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){const t=e.position?e.position.preference:null;this._overlayWidgets.setWidgetPosition(e.widget,t)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}}class pse{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new k7(new TK(1,1,1,1),0,new IK(1,1),0),new k7(new TK(1,1,1,1),0,new IK(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new I7(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return 0===this.modelState.selection.getDirection()?new MK(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new MK(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,n){this._setState(e,t,n)}_setState(e,t,n){if(t){const n=e.model.validateRange(t.selectionStart),i=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,r=e.model.validatePosition(t.position),o=t.position.equals(r)?t.leftoverVisibleColumns:0;t=new k7(n,i,r,o)}else{if(!n)return;const i=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(n.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(n.position));t=new k7(i,n.selectionStartLeftoverVisibleColumns,r,n.leftoverVisibleColumns)}if(n){const i=e.coordinatesConverter.validateViewRange(n.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(n.position,t.position);n=new k7(i,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{const i=e.coordinatesConverter.convertModelPositionToViewPosition(new IK(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new IK(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),o=new TK(i.lineNumber,i.column,r.lineNumber,r.column),s=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);n=new k7(o,t.selectionStartLeftoverVisibleColumns,s,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=n,this._updateTrackedRange(e)}}class mse{constructor(e){this.context=e,this.primaryCursor=new pse(e),this.secondaryCursors=[],this.lastAddedCursorIndex=0}dispose(){this.primaryCursor.dispose(this.context),this.killSecondaryCursors()}startTrackingSelections(){this.primaryCursor.startTrackingSelection(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].startTrackingSelection(this.context)}stopTrackingSelections(){this.primaryCursor.stopTrackingSelection(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){this.primaryCursor.ensureValidState(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].ensureValidState(this.context)}readSelectionFromMarkers(){let e=[];e[0]=this.primaryCursor.readSelectionFromMarkers(this.context);for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].readSelectionFromMarkers(this.context);return e}getAll(){let e=[];e[0]=this.primaryCursor.asCursorState();for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].asCursorState();return e}getViewPositions(){let e=[];e[0]=this.primaryCursor.viewState.position;for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].viewState.position;return e}getTopMostViewPosition(){let e=this.primaryCursor.viewState.position;for(let t=0,n=this.secondaryCursors.length;t<n;t++){const n=this.secondaryCursors[t].viewState.position;n.isBefore(e)&&(e=n)}return e}getBottomMostViewPosition(){let e=this.primaryCursor.viewState.position;for(let t=0,n=this.secondaryCursors.length;t<n;t++){const n=this.secondaryCursors[t].viewState.position;e.isBeforeOrEqual(n)&&(e=n)}return e}getSelections(){let e=[];e[0]=this.primaryCursor.modelState.selection;for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].modelState.selection;return e}getViewSelections(){let e=[];e[0]=this.primaryCursor.viewState.selection;for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t].viewState.selection;return e}setSelections(e){this.setStates(I7.fromModelSelections(e))}getPrimaryCursor(){return this.primaryCursor.asCursorState()}setStates(e){null!==e&&(this.primaryCursor.setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.secondaryCursors.length,n=e.length;if(t<n){let e=n-t;for(let t=0;t<e;t++)this._addSecondaryCursor()}else if(t>n){let e=t-n;for(let t=0;t<e;t++)this._removeSecondaryCursor(this.secondaryCursors.length-1)}for(let i=0;i<n;i++)this.secondaryCursors[i].setState(this.context,e[i].modelState,e[i].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.secondaryCursors.push(new pse(this.context)),this.lastAddedCursorIndex=this.secondaryCursors.length}getLastAddedCursorIndex(){return 0===this.secondaryCursors.length||0===this.lastAddedCursorIndex?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.secondaryCursors[e].dispose(this.context),this.secondaryCursors.splice(e,1)}_getAll(){let e=[];e[0]=this.primaryCursor;for(let t=0,n=this.secondaryCursors.length;t<n;t++)e[t+1]=this.secondaryCursors[t];return e}normalize(){if(0===this.secondaryCursors.length)return;let e=this._getAll(),t=[];for(let n=0,i=e.length;n<i;n++)t.push({index:n,selection:e[n].modelState.selection});t.sort(((e,t)=>e.selection.startLineNumber===t.selection.startLineNumber?e.selection.startColumn-t.selection.startColumn:e.selection.startLineNumber-t.selection.startLineNumber));for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1],o=i.selection,s=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let a;if(a=s.isEmpty()||o.isEmpty()?s.getStartPosition().isBeforeOrEqual(o.getEndPosition()):s.getStartPosition().isBefore(o.getEndPosition()),a){const o=i.index<r.index?n:n+1,s=i.index<r.index?n+1:n,a=t[s].index,l=t[o].index,c=t[s].selection,u=t[o].selection;if(!c.equalsSelection(u)){const n=c.plusRange(u),i=c.selectionStartLineNumber===c.startLineNumber&&c.selectionStartColumn===c.startColumn,r=u.selectionStartLineNumber===u.startLineNumber&&u.selectionStartColumn===u.startColumn;let s,h;a===this.lastAddedCursorIndex?(s=i,this.lastAddedCursorIndex=l):s=r,h=s?new MK(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn):new MK(n.endLineNumber,n.endColumn,n.startLineNumber,n.startColumn),t[o].selection=h;const d=I7.fromModelSelection(h);e[l].setState(this.context,d.modelState,d.viewState)}for(const e of t)e.index>a&&e.index--;e.splice(a,1),t.splice(s,1),this._removeSecondaryCursor(a-1),n--}}}}class vse{constructor(){this.type=0}}class yse{constructor(){this.type=1}}class _se{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class bse{constructor(e,t){this.type=3,this.selections=e,this.modelSelections=t}}class wse{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0)}}class Cse{constructor(){this.type=5}}class Sse{constructor(e){this.type=6,this.isFocused=e}}class xse{constructor(){this.type=7}}class Ese{constructor(){this.type=8}}class kse{constructor(e,t){this.type=9,this.fromLineNumber=e,this.toLineNumber=t}}class Lse{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class Dse{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class Nse{constructor(e,t,n,i,r,o){this.type=12,this.source=e,this.range=t,this.selections=n,this.verticalType=i,this.revealHorizontal=r,this.scrollType=o}}class Ise{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class Tse{constructor(){this.type=14}}class Mse{constructor(e){this.type=15,this.ranges=e}}class Ase{constructor(){this.type=16}}class Ose{constructor(){this.type=17}}class Rse extends mG{constructor(){super(),this._onEvent=this._register(new EG),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOugoingEvents()}_addOutgoingEvent(e){for(let t=0,n=this._outgoingEvents.length;t<n;t++)if(this._outgoingEvents[t].kind===e.kind)return void(this._outgoingEvents[t]=this._outgoingEvents[t].merge(e));this._outgoingEvents.push(e)}_emitOugoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,n=this._eventHandlers.length;t<n;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,1===this._collectorCnt&&(this._collector=new Pse),this._collector}endEmitViewEvents(){if(this._collectorCnt--,0===this._collectorCnt){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const n of e)this._addOutgoingEvent(n);t.length>0&&this._emitMany(t)}this._emitOugoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const n of t)n.handleEvents(e)}}}class Pse{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class Fse{constructor(e,t,n,i){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=n,this.contentHeight=i,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}merge(e){return 0!==e.kind?this:new Fse(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class Bse{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}merge(e){return 1!==e.kind?this:new Bse(this.oldHasFocus,e.hasFocus)}}class Wse{constructor(e,t,n,i,r,o,s,a){this.kind=2,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=n,this._oldScrollTop=i,this.scrollWidth=r,this.scrollLeft=o,this.scrollHeight=s,this.scrollTop=a,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!(this.scrollWidthChanged||this.scrollLeftChanged||this.scrollHeightChanged||this.scrollTopChanged)}merge(e){return 2!==e.kind?this:new Wse(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class zse{constructor(){this.kind=3}isNoOp(){return!1}merge(e){return this}}class Vse{constructor(e,t,n,i,r,o,s){this.kind=5,this.oldSelections=e,this.selections=t,this.oldModelVersionId=n,this.modelVersionId=i,this.source=r,this.reason=o,this.reachedMaxCursorCount=s}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(!e[i].equalsSelection(t[i]))return!1;return!0}isNoOp(){return Vse._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}merge(e){return 5!==e.kind?this:new Vse(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class Use{constructor(){this.kind=4}isNoOp(){return!1}merge(e){return this}}class Hse{constructor(e,t){this.modelVersionId=e.getVersionId(),this.cursorState=t.getCursorStates()}equals(e){if(!e)return!1;if(this.modelVersionId!==e.modelVersionId)return!1;if(this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,n=this.cursorState.length;t<n;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class jse{constructor(e,t,n){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=n}static getAllAutoClosedCharacters(e){let t=[];for(const n of e)t=t.concat(n.getAutoClosedCharactersRanges());return t}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const n=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);n&&e.push(n)}return e}isValid(e){let t=[];for(let n=0;n<this._autoClosedEnclosingDecorations.length;n++){const e=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[n]);if(e&&(t.push(e),e.startLineNumber!==e.endLineNumber))return!1}t.sort(TK.compareRangesUsingStarts),e.sort(TK.compareRangesUsingStarts);for(let n=0;n<e.length;n++){if(n>=t.length)return!1;if(!t[n].strictContainsRange(e[n]))return!1}return!0}}class Gse extends mG{constructor(e,t,n,i){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=n,this.context=new L7(this._model,this._coordinatesConverter,i),this._cursors=new mse(this.context),this._hasFocus=!1,this._isHandling=!1,this._isDoingComposition=!1,this._selectionsWhenCompositionStarted=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=dG(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new L7(this._model,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const n=this._autoClosedActions[t];n.isValid(e)||(n.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,n,i){let r=!1;null!==i&&i.length>Gse.MAX_CURSOR_COUNT&&(i=i.slice(0,Gse.MAX_CURSOR_COUNT),r=!0);const o=new Hse(this._model,this);return this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,n,o,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealPrimary(e,t,n,i){const r=this._cursors.getViewPositions();if(r.length>1)this._emitCursorRevealRange(e,t,null,this._cursors.getViewSelections(),0,n,i);else{const o=r[0],s=new TK(o.lineNumber,o.column,o.lineNumber,o.column);this._emitCursorRevealRange(e,t,s,null,0,n,i)}}_revealPrimaryCursor(e,t,n,i,r){const o=this._cursors.getViewPositions();if(o.length>1)this._emitCursorRevealRange(e,t,null,this._cursors.getViewSelections(),n,i,r);else{const s=o[0],a=new TK(s.lineNumber,s.column,s.lineNumber,s.column);this._emitCursorRevealRange(e,t,a,null,n,i,r)}}_emitCursorRevealRange(e,t,n,i,r,o,s){e.emitViewEvent(new Nse(t,n,i,r,o,s))}saveState(){let e=[];const t=this._cursors.getSelections();for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push({inSelectionMode:!i.isEmpty(),selectionStart:{lineNumber:i.selectionStartLineNumber,column:i.selectionStartColumn},position:{lineNumber:i.positionLineNumber,column:i.positionColumn}})}return e}restoreState(e,t){let n=[];for(let i=0,r=t.length;i<r;i++){const e=t[i];let r=1,o=1;e.position&&e.position.lineNumber&&(r=e.position.lineNumber),e.position&&e.position.column&&(o=e.position.column);let s=r,a=o;e.selectionStart&&e.selectionStart.lineNumber&&(s=e.selectionStart.lineNumber),e.selectionStart&&e.selectionStart.column&&(a=e.selectionStart.column),n.push({selectionStartLineNumber:s,selectionStartColumn:a,positionLineNumber:r,positionColumn:o})}this.setStates(e,"restoreState",0,I7.fromModelSelections(n)),this.revealPrimary(e,"restoreState",!0,1)}onModelContentChanged(e,t){if(this._knownModelVersionId=t.versionId,this._isHandling)return;const n=t.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new mse(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&t.resultingSelection&&t.resultingSelection.length>0){const n=I7.fromModelSelections(t.resultingSelection);this.setStates(e,"modelChange",t.isUndoing?5:t.isRedoing?6:2,n)&&this._revealPrimaryCursor(e,"modelChange",0,!0,0)}else{const t=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,I7.fromModelSelections(t))}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),n=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:M7.visibleColumnFromColumn2(this.context.cursorConfig,this._viewModel,t),toViewLineNumber:n.lineNumber,toViewVisualColumn:M7.visibleColumnFromColumn2(this.context.cursorConfig,this._viewModel,n)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,n,i){this.setStates(e,t,i,I7.fromModelSelections(n))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let n=[],i=[];for(let s=0,a=e.length;s<a;s++)n.push({range:e[s],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),i.push({range:t[s],options:{description:"auto-closed-enclosing",stickiness:1}});const r=this._model.deltaDecorations([],n),o=this._model.deltaDecorations([],i);this._autoClosedActions.push(new jse(this._model,r,o))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=class{static executeCommands(e,t,n){const i={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(i,n);for(let o=0,s=i.trackedRanges.length;o<s;o++)i.model._setTrackedRange(i.trackedRanges[o],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const n=this._getEditOperations(e,t);if(0===n.operations.length)return null;const i=n.operations,r=this._getLoserCursorMap(i);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let o=[];for(let l=0,c=i.length;l<c;l++)r.hasOwnProperty(i[l].identifier.major.toString())||o.push(i[l]);n.hadTrackedEditOperation&&o.length>0&&(o[0]._isTracked=!0);let s=e.model.pushEditOperations(e.selectionsBefore,o,(n=>{let i=[];for(let t=0;t<e.selectionsBefore.length;t++)i[t]=[];for(const e of n)e.identifier&&i[e.identifier.major].push(e);const r=(e,t)=>e.identifier.minor-t.identifier.minor;let o=[];for(let s=0;s<e.selectionsBefore.length;s++)i[s].length>0?(i[s].sort(r),o[s]=t[s].computeCursorState(e.model,{getInverseEditOperations:()=>i[s],getTrackedSelection:t=>{const n=parseInt(t,10),i=e.model._getTrackedRange(e.trackedRanges[n]);return 0===e.trackedRangesDirection[n]?new MK(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn):new MK(i.endLineNumber,i.endColumn,i.startLineNumber,i.startColumn)}})):o[s]=e.selectionsBefore[s];return o}));s||(s=e.selectionsBefore);let a=[];for(let l in r)r.hasOwnProperty(l)&&a.push(parseInt(l,10));a.sort(((e,t)=>t-e));for(const l of a)s.splice(l,1);return s}static _arrayIsEmpty(e){for(let t=0,n=e.length;t<n;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let n=[],i=!1;for(let r=0,o=t.length;r<o;r++){const o=t[r];if(o){const t=this._getEditOperationsFromCommand(e,r,o);n=n.concat(t.operations),i=i||t.hadTrackedEditOperation}}return{operations:n,hadTrackedEditOperation:i}}static _getEditOperationsFromCommand(e,t,n){let i=[],r=0;const o=(e,o,s=!1)=>{TK.isEmpty(e)&&""===o||i.push({identifier:{major:t,minor:r++},range:e,text:o,forceMoveMarkers:s,isAutoWhitespaceEdit:n.insertsAutoWhitespace})};let s=!1;const a=(e,t,n)=>{s=!0,o(e,t,n)},l={addEditOperation:o,addTrackedEditOperation:a,trackSelection:(t,n)=>{const i=MK.liftSelection(t);let r;if(i.isEmpty())if("boolean"==typeof n)r=n?2:3;else{const t=e.model.getLineMaxColumn(i.startLineNumber);r=i.startColumn===t?2:3}else r=1;const o=e.trackedRanges.length,s=e.model._setTrackedRange(null,i,r);return e.trackedRanges[o]=s,e.trackedRangesDirection[o]=i.getDirection(),o.toString()}};try{n.getEditOperations(e.model,l)}catch(zWe){return nG(zWe),{operations:[],hadTrackedEditOperation:!1}}return{operations:i,hadTrackedEditOperation:s}}static _getLoserCursorMap(e){(e=e.slice(0)).sort(((e,t)=>-TK.compareRangesUsingEnds(e.range,t.range)));let t={};for(let n=1;n<e.length;n++){const i=e[n-1],r=e[n];if(TK.getStartPosition(i.range).isBefore(TK.getEndPosition(r.range))){let o;o=i.identifier.major>r.identifier.major?i.identifier.major:r.identifier.major,t[o.toString()]=!0;for(let t=0;t<e.length;t++)e[t].identifier.major===o&&(e.splice(t,1),t<n&&n--,t--);n>0&&n--}}return t}}.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let n=[],i=[];for(let t=0;t<e.commands.length;t++){const r=e.commands[t];r instanceof cre&&r.enclosingRange&&r.closeCharacterRange&&(n.push(r.closeCharacterRange),i.push(r.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,i),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){e&&0!==e.length||(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,n,i,r){const o=new Hse(this._model,this);if(o.equals(i))return!1;const s=this._cursors.getSelections(),a=this._cursors.getViewSelections();if(e.emitViewEvent(new bse(a,s)),!i||i.cursorState.length!==o.cursorState.length||o.cursorState.some(((e,t)=>!e.modelState.equals(i.cursorState[t].modelState)))){const a=i?i.cursorState.map((e=>e.modelState.selection)):null,l=i?i.modelVersionId:0;e.emitOutgoingEvent(new Vse(a,s,l,o.modelVersionId,t||"keyboard",n,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];if(!i.text||i.text.indexOf("\n")>=0)return null;const r=i.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!r)return null;const o=r[1],s=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(o);if(!s||1!==s.length)return null;const a=s[0].open,l=i.text.length-r[2].length-1,c=i.text.lastIndexOf(a,l-1);if(-1===c)return null;t.push([c,l])}return t}executeEdits(e,t,n,i){let r=null;"snippet"===t&&(r=this._findAutoClosingPairs(n)),r&&(n[0]._isTracked=!0);let o=[],s=[];const a=this._model.pushEditOperations(this.getSelections(),n,(e=>{if(r)for(let n=0,i=r.length;n<i;n++){const[t,i]=r[n],a=e[n],l=a.range.startLineNumber,c=a.range.startColumn-1+t,u=a.range.startColumn-1+i;o.push(new TK(l,u+1,l,u+2)),s.push(new TK(l,c+1,l,u+2))}const t=i(e);return t&&(this._isHandling=!0),t}));a&&(this._isHandling=!1,this.setSelections(e,t,a,0)),o.length>0&&this._pushAutoClosedAction(o,s)}_executeEdit(e,t,n,i=0){if(this.context.cursorConfig.readOnly)return;const r=new Hse(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(o){nG(o)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,n,i,r,!1)&&this._revealPrimaryCursor(t,n,0,!0,0)}setIsDoingComposition(e){this._isDoingComposition=e}getAutoClosedCharacters(){return jse.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._selectionsWhenCompositionStarted=this.getSelections().slice(0)}endComposition(e,t){this._executeEdit((()=>{"keyboard"===t&&(this._executeEditOperation(lre.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this._selectionsWhenCompositionStarted,this.getSelections(),this.getAutoClosedCharacters())),this._selectionsWhenCompositionStarted=null)}),e,t)}type(e,t,n){this._executeEdit((()=>{if("keyboard"===n){const e=t.length;let n=0;for(;n<e;){const e=TX(t,n),i=t.substr(n,e);this._executeEditOperation(lre.typeWithInterceptors(this._isDoingComposition,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),i)),n+=e}}else this._executeEditOperation(lre.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))}),e,n)}compositionType(e,t,n,i,r,o){if(0!==t.length||0!==n||0!==i)this._executeEdit((()=>{this._executeEditOperation(lre.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,n,i,r))}),e,o);else if(0!==r){const t=this.getSelections().map((e=>{const t=e.getPosition();return new MK(t.lineNumber,t.column+r,t.lineNumber,t.column+r)}));this.setSelections(e,o,t,0)}}paste(e,t,n,i,r){this._executeEdit((()=>{this._executeEditOperation(lre.paste(this.context.cursorConfig,this._model,this.getSelections(),t,n,i||[]))}),e,r,4)}cut(e,t){this._executeEdit((()=>{this._executeEditOperation(Zie.cut(this.context.cursorConfig,this._model,this.getSelections()))}),e,t)}executeCommand(e,t,n){this._executeEdit((()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new T7(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}),e,n)}executeCommands(e,t,n){this._executeEdit((()=>{this._executeEditOperation(new T7(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}),e,n)}}Gse.MAX_CURSOR_COUNT=1e4;class Kse{constructor(e,t,n,i,r,o){this.id=e,this.label=t,this.alias=n,this._precondition=i,this._run=r,this._contextKeyService=o}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(){return this.isSupported()?this._run():Promise.resolve(void 0)}}const qse={getInitialState:()=>XJ,tokenize2:(e,t,n,i)=>JJ(0,0,n,i)};function $se(e,t=qse){return function(e,t){let n='<div class="monaco-tokenized-source">',i=uX(e),r=t.getInitialState();for(let o=0,s=i.length;o<s;o++){let e=i[o];o>0&&(n+="<br/>");let s=t.tokenize2(e,!0,r,0);u2.convertToEndOffset(s.tokens,e.length);let a=new u2(s.tokens,e).inflate(),l=0;for(let t=0,i=a.getCount();t<i;t++){const i=a.getClassName(t),r=a.getEndOffset(t);n+=`<span class="${i}">${iX(e.substring(l,r))}</span>`,l=r}r=s.endState}return n+="</div>",n}(e,t||qse)}function Yse(e,t,n,i,r,o,s){let a="<div>",l=i,c=0;for(let u=0,h=t.getCount();u<h;u++){const h=t.getEndOffset(u);if(h<=i)continue;let d="";for(;l<h&&l<r;l++){const t=e.charCodeAt(l);switch(t){case 9:let e=o-(l+c)%o;for(c+=e-1;e>0;)d+=s?"&#160;":" ",e--;break;case 60:d+="&lt;";break;case 62:d+="&gt;";break;case 38:d+="&amp;";break;case 0:d+="&#00;";break;case 65279:case 8232:case 8233:case 133:d+="�";break;case 13:d+="&#8203";break;case 32:d+=s?"&#160;":" ";break;default:d+=String.fromCharCode(t)}}if(a+=`<span style="${t.getInlineStyle(u,n)}">${d}</span>`,h>r||l>=r)break}return a+="</div>",a}class Xse{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;const t=this._inserts,n=this._changes,i=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,n,i)}}class Zse{constructor(e,t,n,i,r){this.id=e,this.afterLineNumber=t,this.ordinal=n,this.height=i,this.minWidth=r,this.prefixSum=0}}class Qse{constructor(e,t,n,i){this._instanceId=HX(++Qse.INSTANCE_COUNT),this._pendingChanges=new Xse,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=n,this._paddingBottom=i}static findInsertionIndex(e,t,n){let i=0,r=e.length;for(;i<r;){const o=i+r>>>1;t===e[o].afterLineNumber?n<e[o].ordinal?r=o:i=o+1:t<e[o].afterLineNumber?r=o:i=o+1}return i}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(e,n,i,r)=>{t=!0,e|=0,n|=0,i|=0,r|=0;const o=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new Zse(o,e,n,i,r)),o},changeOneWhitespace:(e,n,i)=>{t=!0,n|=0,i|=0,this._pendingChanges.change({id:e,newAfterLineNumber:n,newHeight:i})},removeWhitespace:e=>{t=!0,this._pendingChanges.remove({id:e})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,n){if((e.length>0||n.length>0)&&(this._minWidth=-1),e.length+t.length+n.length<=1){for(const t of e)this._insertWhitespace(t);for(const e of t)this._changeOneWhitespace(e.id,e.newAfterLineNumber,e.newHeight);for(const e of n){const t=this._findWhitespaceIndex(e.id);-1!==t&&this._removeWhitespace(t)}return}const i=new Set;for(const a of n)i.add(a.id);const r=new Map;for(const a of t)r.set(a.id,a);const o=e=>{let t=[];for(const n of e)if(!i.has(n.id)){if(r.has(n.id)){const e=r.get(n.id);n.afterLineNumber=e.newAfterLineNumber,n.height=e.newHeight}t.push(n)}return t},s=o(this._arr).concat(o(e));s.sort(((e,t)=>e.afterLineNumber===t.afterLineNumber?e.ordinal-t.ordinal:e.afterLineNumber-t.afterLineNumber)),this._arr=s,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){const t=Qse.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let n=0,i=t.length;n<i;n++)if(t[n].id===e)return n;return-1}_changeOneWhitespace(e,t,n){const i=this._findWhitespaceIndex(e);if(-1!==i&&(this._arr[i].height!==n&&(this._arr[i].height=n,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,i-1)),this._arr[i].afterLineNumber!==t)){const e=this._arr[i];this._removeWhitespace(i),e.afterLineNumber=t,this._insertWhitespace(e)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e|=0,t|=0,this._lineCount-=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){const i=this._arr[n].afterLineNumber;e<=i&&i<=t?this._arr[n].afterLineNumber=e-1:i>t&&(this._arr[n].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e|=0,t|=0,this._lineCount+=t-e+1;for(let n=0,i=this._arr.length;n<i;n++){e<=this._arr[n].afterLineNumber&&(this._arr[n].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),0===this._arr.length?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e|=0;let t=Math.max(0,this._prefixSumValidIndex+1);0===t&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let n=t;n<=e;n++)this._arr[n].prefixSum=this._arr[n-1].prefixSum+this._arr[n].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();return this._lineHeight*this._lineCount+this.getWhitespacesTotalHeight()+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e|=0;const t=this._findLastWhitespaceBeforeLineNumber(e);return-1===t?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e|=0;const t=this._arr;let n=0,i=t.length-1;for(;n<=i;){const r=n+((i-n|0)/2|0)|0;if(t[r].afterLineNumber<e){if(r+1>=t.length||t[r+1].afterLineNumber>=e)return r;n=r+1|0}else i=r-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e|=0;const t=this._findLastWhitespaceBeforeLineNumber(e)+1;return t<this._arr.length?t:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e|=0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e){let t;this._checkPendingChanges(),t=(e|=0)>1?this._lineHeight*(e-1):0;return t+this.getWhitespaceAccumulatedHeightBeforeLineNumber(e)+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),-1===this._minWidth){let e=0;for(let t=0,n=this._arr.length;t<n;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();return e>this.getLinesTotalHeight()}isInTopPadding(e){return 0!==this._paddingTop&&(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(0===this._paddingBottom)return!1;this._checkPendingChanges();return e>=this.getLinesTotalHeight()-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),(e|=0)<0)return 1;const t=0|this._lineCount,n=this._lineHeight;let i=1,r=t;for(;i<r;){const t=(i+r)/2|0,o=0|this.getVerticalOffsetForLineNumber(t);if(e>=o+n)i=t+1;else{if(e>=o)return t;r=t}}return i>t?t:i}getLinesViewportData(e,t){this._checkPendingChanges(),e|=0,t|=0;const n=this._lineHeight,i=0|this.getLineNumberAtOrAfterVerticalOffset(e),r=0|this.getVerticalOffsetForLineNumber(i);let o=0|this._lineCount,s=0|this.getFirstWhitespaceIndexAfterLineNumber(i);const a=0|this.getWhitespacesCount();let l,c;-1===s?(s=a,c=o+1,l=0):(c=0|this.getAfterLineNumberForWhitespaceIndex(s),l=0|this.getHeightForWhitespaceIndex(s));let u=r,h=u;const d=5e5;let f=0;r>=d&&(f=Math.floor(r/d)*d,f=Math.floor(f/n)*n,h-=f);const g=[],p=e+(t-e)/2;let m=-1;for(let b=i;b<=o;b++){if(-1===m){const e=u,t=u+n;(e<=p&&p<t||e>p)&&(m=b)}for(u+=n,g[b-i]=h,h+=n;c===b;)h+=l,u+=l,s++,s>=a?c=o+1:(c=0|this.getAfterLineNumberForWhitespaceIndex(s),l=0|this.getHeightForWhitespaceIndex(s));if(u>=t){o=b;break}}-1===m&&(m=o);const v=0|this.getVerticalOffsetForLineNumber(o);let y=i,_=o;return y<_&&r<e&&y++,y<_&&v+n>t&&_--,{bigNumbersDelta:f,startLineNumber:i,endLineNumber:o,relativeVerticalOffset:g,centeredLineNumber:m,completelyVisibleStartLineNumber:y,completelyVisibleEndLineNumber:_}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e|=0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let n,i;return n=t>=1?this._lineHeight*t:0,i=e>0?this.getWhitespacesAccumulatedHeight(e-1):0,n+i+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e|=0;let t=0,n=this.getWhitespacesCount()-1;if(n<0)return-1;if(e>=this.getVerticalOffsetForWhitespaceIndex(n)+this.getHeightForWhitespaceIndex(n))return-1;for(;t<n;){const i=Math.floor((t+n)/2),r=this.getVerticalOffsetForWhitespaceIndex(i);if(e>=r+this.getHeightForWhitespaceIndex(i))t=i+1;else{if(e>=r)return i;n=i}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e|=0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0)return null;if(t>=this.getWhitespacesCount())return null;const n=this.getVerticalOffsetForWhitespaceIndex(t);if(n>e)return null;const i=this.getHeightForWhitespaceIndex(t);return{id:this.getIdForWhitespaceIndex(t),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(t),verticalOffset:n,height:i}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e|=0,t|=0;const n=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),i=this.getWhitespacesCount()-1;if(n<0)return[];let r=[];for(let o=n;o<=i;o++){const e=this.getVerticalOffsetForWhitespaceIndex(o),n=this.getHeightForWhitespaceIndex(o);if(e>=t)break;r.push({id:this.getIdForWhitespaceIndex(o),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(o),verticalOffset:e,height:n})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e|=0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e|=0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e|=0,this._arr[e].height}}Qse.INSTANCE_COUNT=0;class Jse{constructor(e,t,n,i){(e|=0)<0&&(e=0),(t|=0)<0&&(t=0),(n|=0)<0&&(n=0),(i|=0)<0&&(i=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=n,this.contentHeight=i,this.scrollHeight=Math.max(n,i)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class eae extends mG{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new EG),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new Jse(0,0,0,0),this._scrollable=this._register(new aoe(e,t)),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const n=t.contentWidth!==e.contentWidth,i=t.contentHeight!==e.contentHeight;(n||i)&&this._onDidContentSizeChange.fire(new Fse(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}}class tae extends mG{constructor(e,t,n){super(),this._configuration=e;const i=this._configuration.options,r=i.get(128),o=i.get(72);this._linesLayout=new Qse(t,i.get(56),o.top,o.bottom),this._scrollable=this._register(new eae(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new Jse(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(101)?125:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(56)&&this._linesLayout.setLineHeight(t.get(56)),e.hasChanged(72)){const e=t.get(72);this._linesLayout.setPadding(e.top,e.bottom)}if(e.hasChanged(128)){const e=t.get(128),n=e.contentWidth,i=e.height,r=this._scrollable.getScrollDimensions(),o=r.contentWidth;this._scrollable.setScrollDimensions(new Jse(n,r.contentWidth,i,this._getContentHeight(n,i,o)))}else this._updateHeight();e.hasChanged(101)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const n=this._configuration.options.get(90);return 2===n.horizontal||e>=t?0:n.horizontalScrollbarSize}_getContentHeight(e,t,n){const i=this._configuration.options;let r=this._linesLayout.getLinesTotalHeight();return i.get(92)?r+=Math.max(0,t-i.get(56)-i.get(72).bottom):r+=this._getHorizontalScrollbarHeight(e,n),r}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,n=e.height,i=e.contentWidth;this._scrollable.setScrollDimensions(new Jse(t,e.contentWidth,n,this._getContentHeight(t,n,i)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new E2(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new E2(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(e){const t=this._configuration.options,n=t.get(129),i=t.get(40);if(n.isViewportWrapping){const n=t.get(128),r=t.get(62);return e>n.contentWidth+i.typicalHalfwidthCharacterWidth&&r.enabled&&"right"===r.side?e+n.verticalScrollbarWidth:e}{const n=t.get(91)*i.typicalHalfwidthCharacterWidth,r=this._linesLayout.getWhitespaceMinWidth();return Math.max(e+n,r)}}setMaxLineWidth(e){const t=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new Jse(t.width,this._computeContentWidth(e),t.height,t.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition();let t=e.scrollTop,n=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t);return{scrollTop:t,scrollTopWithoutViewZones:t-this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(n),scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e){return this._linesLayout.getVerticalOffsetForLineNumber(e)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){1===t?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}deltaScrollNow(e,t){const n=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:n.scrollLeft+e,scrollTop:n.scrollTop+t})}}class nae{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column)}convertModelRangeToViewRange(e){return this._lines.convertModelRangeToViewRange(e)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}}class iae{constructor(e){this._counts=e,this._isValid=!1,this._validEndIndex=-1,this._modelToView=[],this._viewToModel=[]}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._counts.length;e<t;e++){const t=this._counts[e],n=e>0?this._modelToView[e-1]:0;this._modelToView[e]=n+t;for(let i=0;i<t;i++)this._viewToModel[n+i]=e}this._modelToView.length=this._counts.length,this._viewToModel.length=this._modelToView[this._modelToView.length-1],this._isValid=!0,this._validEndIndex=this._counts.length-1}}changeValue(e,t){this._counts[e]!==t&&(this._counts[e]=t,this._invalidate(e))}removeValues(e,t){this._counts.splice(e,t),this._invalidate(e)}insertValues(e,t){this._counts=V1(this._counts,e,t),this._invalidate(e)}getTotalValue(){return this._ensureValid(),this._viewToModel.length}getAccumulatedValue(e){return this._ensureValid(),this._modelToView[e]}getIndexOf(e){this._ensureValid();const t=this._viewToModel[e],n=t>0?this._modelToView[t-1]:0;return new d1(t,e-n)}}class rae{constructor(e,t,n,i,r,o,s,a,l){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=n,this._monospaceLineBreaksComputerFactory=i,this.fontInfo=r,this.tabSize=o,this.wrappingStrategy=s,this.wrappingColumn=a,this.wrappingIndent=l,this._constructLines(!0,null)}dispose(){this.hiddenAreasIds=this.model.deltaDecorations(this.hiddenAreasIds,[])}createCoordinatesConverter(){return new nae(this)}_constructLines(e,t){this.lines=[],e&&(this.hiddenAreasIds=[]);const n=this.model.getLinesContent(),i=this.model.getInjectedTextDecorations(this._editorId),r=F8.fromDecorations(i),o=n.length,s=this.createLineBreaksComputer(),a=r.length;let l=0,c=l<a?r[l].lineNumber:o+1;for(let v=0;v<o;v++){let e=null;if(v+1===c)for(e=[];v+1===c&&l<a;)e.push(r[l]),l++,c=l<a?r[l].lineNumber:o+1;s.addRequest(n[v],e,t?t[v]:null)}const u=s.finalize();let h=[],d=this.hiddenAreasIds.map((e=>this.model.getDecorationRange(e))).sort(TK.compareRangesUsingStarts),f=1,g=0,p=-1,m=p+1<d.length?g+1:o+2;for(let v=0;v<o;v++){let e=v+1;e===m&&(p++,f=d[p].startLineNumber,g=d[p].endLineNumber,m=p+1<d.length?g+1:o+2);let t=e>=f&&e<=g,n=hae(u[v],!t);h[v]=n.getViewLineCount(),this.lines[v]=n}this._validModelVersionId=this.model.getVersionId(),this.prefixSumComputer=new iae(h)}getHiddenAreas(){return this.hiddenAreasIds.map((e=>this.model.getDecorationRange(e)))}_reduceRanges(e){if(0===e.length)return[];let t=e.map((e=>this.model.validateRange(e))).sort(TK.compareRangesUsingStarts),n=[],i=t[0].startLineNumber,r=t[0].endLineNumber;for(let o=1,s=t.length;o<s;o++){let e=t[o];e.startLineNumber>r+1?(n.push(new TK(i,1,r,1)),i=e.startLineNumber,r=e.endLineNumber):e.endLineNumber>r&&(r=e.endLineNumber)}return n.push(new TK(i,1,r,1)),n}setHiddenAreas(e){let t=this._reduceRanges(e),n=this.hiddenAreasIds.map((e=>this.model.getDecorationRange(e))).sort(TK.compareRangesUsingStarts);if(t.length===n.length){let e=!1;for(let i=0;i<t.length;i++)if(!t[i].equalsRange(n[i])){e=!0;break}if(!e)return!1}let i=[];for(const u of t)i.push({range:u,options:v7.EMPTY});this.hiddenAreasIds=this.model.deltaDecorations(this.hiddenAreasIds,i);let r=t,o=1,s=0,a=-1,l=a+1<r.length?s+1:this.lines.length+2,c=!1;for(let u=0;u<this.lines.length;u++){let e=u+1;e===l&&(a++,o=r[a].startLineNumber,s=r[a].endLineNumber,l=a+1<r.length?s+1:this.lines.length+2);let t=!1;if(e>=o&&e<=s?this.lines[u].isVisible()&&(this.lines[u]=this.lines[u].setVisible(!1),t=!0):(c=!0,this.lines[u].isVisible()||(this.lines[u]=this.lines[u].setVisible(!0),t=!0)),t){let e=this.lines[u].getViewLineCount();this.prefixSumComputer.changeValue(u,e)}}return c||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return!(e<1||e>this.lines.length)&&this.lines[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.lines.length?1:this.lines[e-1].getViewLineCount()}setTabSize(e){return this.tabSize!==e&&(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,n,i){const r=this.fontInfo.equals(e),o=this.wrappingStrategy===t,s=this.wrappingColumn===n,a=this.wrappingIndent===i;if(r&&o&&s&&a)return!1;const l=r&&o&&!s&&a;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=n,this.wrappingIndent=i;let c=null;if(l){c=[];for(let e=0,t=this.lines.length;e<t;e++)c[e]=this.lines[e].getLineBreakData()}return this._constructLines(!1,c),!0}createLineBreaksComputer(){return("advanced"===this.wrappingStrategy?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,n){if(!e||e<=this._validModelVersionId)return null;let i=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,r=this.prefixSumComputer.getAccumulatedValue(n-1);return this.lines.splice(t-1,n-t+1),this.prefixSumComputer.removeValues(t-1,n-t+1),new Lse(i,r)}onModelLinesInserted(e,t,n,i){if(!e||e<=this._validModelVersionId)return null;const r=t>2&&!this.lines[t-2].isVisible();let o=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,s=0,a=[],l=[];for(let c=0,u=i.length;c<u;c++){let e=hae(i[c],!r);a.push(e);let t=e.getViewLineCount();s+=t,l[c]=t}return this.lines=this.lines.slice(0,t-1).concat(a).concat(this.lines.slice(t-1)),this.prefixSumComputer.insertValues(t-1,l),new Dse(o,o+s-1)}onModelLineChanged(e,t,n){if(null!==e&&e<=this._validModelVersionId)return[!1,null,null,null];let i=t-1,r=this.lines[i].getViewLineCount(),o=hae(n,this.lines[i].isVisible());this.lines[i]=o;let s=this.lines[i].getViewLineCount(),a=!1,l=0,c=-1,u=0,h=-1,d=0,f=-1;r>s?(l=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,c=l+s-1,d=c+1,f=d+(r-s)-1,a=!0):r<s?(l=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,c=l+r-1,u=c+1,h=u+(s-r)-1,a=!0):(l=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,c=l+s-1),this.prefixSumComputer.changeValue(i,s);return[a,l<=c?new kse(l,c):null,u<=h?new Dse(u,h):null,d<=f?new Lse(d,f):null]}acceptVersionId(e){this._validModelVersionId=e,1!==this.lines.length||this.lines[0].isVisible()||this.setHiddenAreas([])}getViewLineCount(){return this.prefixSumComputer.getTotalValue()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:0|e}getActiveIndentGuide(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),n=this._toValidViewLineNumber(n);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),o=this.convertViewPositionToModelPosition(n,this.getViewLineMinColumn(n)),s=this.model.getActiveIndentGuide(i.lineNumber,r.lineNumber,o.lineNumber),a=this.convertModelPositionToViewPosition(s.startLineNumber,1),l=this.convertModelPositionToViewPosition(s.endLineNumber,this.model.getLineMaxColumn(s.endLineNumber));return{startLineNumber:a.lineNumber,endLineNumber:l.lineNumber,indent:s.indent}}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),i=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let r=[],o=[],s=[];const a=n.lineNumber-1,l=i.lineNumber-1;let c=null;for(let f=a;f<=l;f++){const e=this.lines[f];if(e.isVisible()){let t=e.getViewLineNumberOfModelPosition(0,f===a?n.column:1),i=e.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),r=i-t+1,l=0;r>1&&1===e.getViewLineMinColumn(this.model,f+1,i)&&(l=0===t?1:2),o.push(r),s.push(l),null===c&&(c=new IK(f+1,0))}else null!==c&&(r=r.concat(this.model.getLinesIndentGuides(c.lineNumber,f)),c=null)}null!==c&&(r=r.concat(this.model.getLinesIndentGuides(c.lineNumber,i.lineNumber)),c=null);const u=t-e+1;let h=new Array(u),d=0;for(let f=0,g=r.length;f<g;f++){let e,t=r[f],n=Math.min(u-d,o[f]),i=s[f];e=2===i?0:1===i?1:n;for(let r=0;r<n;r++)r===e&&(t=0),h[d++]=t}return h}getViewLineContent(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),n=t.index,i=t.remainder;return this.lines[n].getViewLineContent(this.model,n+1,i)}getViewLineLength(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),n=t.index,i=t.remainder;return this.lines[n].getViewLineLength(this.model,n+1,i)}getViewLineMinColumn(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),n=t.index,i=t.remainder;return this.lines[n].getViewLineMinColumn(this.model,n+1,i)}getViewLineMaxColumn(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),n=t.index,i=t.remainder;return this.lines[n].getViewLineMaxColumn(this.model,n+1,i)}getViewLineData(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),n=t.index,i=t.remainder;return this.lines[n].getViewLineData(this.model,n+1,i)}getViewLinesData(e,t,n){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let i=this.prefixSumComputer.getIndexOf(e-1),r=e,o=i.index,s=i.remainder,a=[];for(let l=o,c=this.model.getLineCount();l<c;l++){let i=this.lines[l];if(!i.isVisible())continue;let c=l===o?s:0,u=i.getViewLineCount()-c,h=!1;r+u>t&&(h=!0,u=t-r+1);let d=c+u;if(i.getViewLinesData(this.model,l+1,c,d,r-e,n,a),r+=u,h)break}return a}validateViewPosition(e,t,n){e=this._toValidViewLineNumber(e);let i=this.prefixSumComputer.getIndexOf(e-1),r=i.index,o=i.remainder,s=this.lines[r],a=s.getViewLineMinColumn(this.model,r+1,o),l=s.getViewLineMaxColumn(this.model,r+1,o);t<a&&(t=a),t>l&&(t=l);let c=s.getModelColumnOfViewPosition(o,t);return this.model.validatePosition(new IK(r+1,c)).equals(n)?new IK(e,t):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}validateViewRange(e,t){const n=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),i=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new TK(n.lineNumber,n.column,i.lineNumber,i.column)}convertViewPositionToModelPosition(e,t){e=this._toValidViewLineNumber(e);let n=this.prefixSumComputer.getIndexOf(e-1),i=n.index,r=n.remainder,o=this.lines[i].getModelColumnOfViewPosition(r,t);return this.model.validatePosition(new IK(i+1,o))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new TK(t.lineNumber,t.column,n.lineNumber,n.column)}convertModelPositionToViewPosition(e,t){const n=this.model.validatePosition(new IK(e,t)),i=n.lineNumber,r=n.column;let o=i-1,s=!1;for(;o>0&&!this.lines[o].isVisible();)o--,s=!0;if(0===o&&!this.lines[o].isVisible())return new IK(1,1);const a=1+(0===o?0:this.prefixSumComputer.getAccumulatedValue(o-1));let l;return l=s?this.lines[o].getViewPositionOfModelPosition(a,this.model.getLineMaxColumn(o+1)):this.lines[i-1].getViewPositionOfModelPosition(a,r),l}convertModelRangeToViewRange(e){let t=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn),n=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn);return e.startLineNumber===e.endLineNumber&&t.lineNumber!==n.lineNumber&&n.column===this.getViewLineMinColumn(n.lineNumber)?new TK(t.lineNumber,t.column,n.lineNumber-1,this.getViewLineMaxColumn(n.lineNumber-1)):new TK(t.lineNumber,t.column,n.lineNumber,n.column)}_getViewLineNumberForModelPosition(e,t){let n=e-1;if(this.lines[n].isVisible()){const e=1+(0===n?0:this.prefixSumComputer.getAccumulatedValue(n-1));return this.lines[n].getViewLineNumberOfModelPosition(e,t)}for(;n>0&&!this.lines[n].isVisible();)n--;if(0===n&&!this.lines[n].isVisible())return 1;const i=1+(0===n?0:this.prefixSumComputer.getAccumulatedValue(n-1));return this.lines[n].getViewLineNumberOfModelPosition(i,this.model.getLineMaxColumn(n+1))}getAllOverviewRulerDecorations(e,t,n){const i=this.model.getOverviewRulerDecorations(e,t),r=new gae;for(const o of i){const e=o.options.overviewRuler,t=e?e.position:0;if(0===t)continue;const i=e.getColor(n),s=this._getViewLineNumberForModelPosition(o.range.startLineNumber,o.range.startColumn),a=this._getViewLineNumberForModelPosition(o.range.endLineNumber,o.range.endColumn);r.accept(i,s,a,t)}return r.result}getDecorationsInRange(e,t,n){const i=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),r=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(r.lineNumber-i.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new TK(i.lineNumber,1,r.lineNumber,r.column),t,n);let o=[];const s=i.lineNumber-1,a=r.lineNumber-1;let l=null;for(let d=s;d<=a;d++){if(this.lines[d].isVisible())null===l&&(l=new IK(d+1,d===s?i.column:1));else if(null!==l){const e=this.model.getLineMaxColumn(d);o=o.concat(this.model.getDecorationsInRange(new TK(l.lineNumber,l.column,d,e),t,n)),l=null}}null!==l&&(o=o.concat(this.model.getDecorationsInRange(new TK(l.lineNumber,l.column,r.lineNumber,r.column),t,n)),l=null),o.sort(((e,t)=>{const n=TK.compareRangesUsingStarts(e.range,t.range);return 0===n?e.id<t.id?-1:e.id>t.id?1:0:n}));let c=[],u=0,h=null;for(const d of o){const e=d.id;h!==e&&(h=e,c[u++]=d)}return c}normalizePosition(e,t){const n=this._toValidViewLineNumber(e.lineNumber),i=this.prefixSumComputer.getIndexOf(n-1),r=i.index,o=i.remainder;return this.lines[r].normalizePosition(this.model,r+1,o,e,t)}getLineIndentColumn(e){const t=this._toValidViewLineNumber(e),n=this.prefixSumComputer.getIndexOf(t-1),i=n.index;return 0===n.remainder?this.model.getLineIndentColumn(i+1):0}}class oae{constructor(){}isVisible(){return!0}setVisible(e){return e?this:sae.INSTANCE}getLineBreakData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,n){return e.getLineContent(t)}getViewLineLength(e,t,n){return e.getLineLength(t)}getViewLineMinColumn(e,t,n){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,n){return e.getLineMaxColumn(t)}getViewLineData(e,t,n){let i=e.getLineTokens(t),r=i.getLineContent();return new N2(r,!1,1,r.length+1,0,i.inflate())}getViewLinesData(e,t,n,i,r,o,s){o[r]?s[r]=this.getViewLineData(e,t,0):s[r]=null}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new IK(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,n,i,r){return i}}oae.INSTANCE=new oae;class sae{constructor(){}isVisible(){return!1}setVisible(e){return e?oae.INSTANCE:this}getLineBreakData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,n){throw new Error("Not supported")}getViewLineLength(e,t,n){throw new Error("Not supported")}getViewLineMinColumn(e,t,n){throw new Error("Not supported")}getViewLineMaxColumn(e,t,n){throw new Error("Not supported")}getViewLineData(e,t,n){throw new Error("Not supported")}getViewLinesData(e,t,n,i,r,o,s){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,n,i,r){throw new Error("Not supported")}}sae.INSTANCE=new sae;class aae{constructor(e,t){this._lineBreakData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getLineBreakData(){return this._lineBreakData}getViewLineCount(){return this._isVisible?this._lineBreakData.breakOffsets.length:0}getInputStartOffsetOfOutputLineIndex(e){return this._lineBreakData.getInputOffsetOfOutputPosition(e,0)}getInputEndOffsetOfOutputLineIndex(e,t,n){return n+1===this._lineBreakData.breakOffsets.length?e.getLineMaxColumn(t)-1:this._lineBreakData.getInputOffsetOfOutputPosition(n+1,0)}getViewLineContent(e,t,n){if(!this._isVisible)throw new Error("Not supported");let i=this.getInputStartOffsetOfOutputLineIndex(n),r=this.getInputEndOffsetOfOutputLineIndex(e,t,n),o=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:r+1});return n>0&&(o=cae(this._lineBreakData.wrappedTextIndentLength)+o),o}getViewLineLength(e,t,n){if(!this._isVisible)throw new Error("Not supported");const i=n>0?this._lineBreakData.breakOffsets[n-1]:0;let r=(n<this._lineBreakData.breakOffsets.length?this._lineBreakData.breakOffsets[n]:this._lineBreakData.breakOffsets[this._lineBreakData.breakOffsets.length-1])-i;return n>0&&(r=this._lineBreakData.wrappedTextIndentLength+r),r}getViewLineMinColumn(e,t,n){if(!this._isVisible)throw new Error("Not supported");return this._getViewLineMinColumn(n)}_getViewLineMinColumn(e){return e>0?this._lineBreakData.wrappedTextIndentLength+1:1}getViewLineMaxColumn(e,t,n){if(!this._isVisible)throw new Error("Not supported");return this.getViewLineLength(e,t,n)+1}getViewLineData(e,t,n){if(!this._isVisible)throw new Error("Not supported");const i=this._lineBreakData,r=n>0?i.wrappedTextIndentLength:0,o=i.injectionOffsets,s=i.injectionTexts;let a,l;if(o){const c=e.getLineTokens(t).withInserted(o.map(((e,t)=>({offset:e,text:s[t],tokenMetadata:u2.defaultTokenMetadata})))),u=n>0?i.breakOffsets[n-1]:0,h=i.breakOffsets[n];a=c.getLineContent().substring(u,h),l=c.sliceAndInflate(u,h,r)}else{const i=this.getInputStartOffsetOfOutputLineIndex(n),o=this.getInputEndOffsetOfOutputLineIndex(e,t,n),s=e.getLineTokens(t);a=e.getValueInRange({startLineNumber:t,startColumn:i+1,endLineNumber:t,endColumn:o+1}),l=s.sliceAndInflate(i,o,r)}n>0&&(a=cae(i.wrappedTextIndentLength)+a);const c=n>0?i.wrappedTextIndentLength+1:1,u=a.length+1,h=n+1<this.getViewLineCount(),d=0===n?0:i.breakOffsetsVisibleColumn[n-1];return new N2(a,h,c,u,d,l)}getViewLinesData(e,t,n,i,r,o,s){if(!this._isVisible)throw new Error("Not supported");for(let a=n;a<i;a++){let i=r+a-n;o[i]?s[i]=this.getViewLineData(e,t,a):s[i]=null}}getModelColumnOfViewPosition(e,t){if(!this._isVisible)throw new Error("Not supported");let n=t-1;return e>0&&(n<this._lineBreakData.wrappedTextIndentLength?n=0:n-=this._lineBreakData.wrappedTextIndentLength),this._lineBreakData.getInputOffsetOfOutputPosition(e,n)+1}getViewPositionOfModelPosition(e,t){if(!this._isVisible)throw new Error("Not supported");let n=this._lineBreakData.getOutputPositionOfInputOffset(t-1),i=n.outputLineIndex,r=n.outputOffset+1;return i>0&&(r+=this._lineBreakData.wrappedTextIndentLength),new IK(e+i,r)}getViewLineNumberOfModelPosition(e,t){if(!this._isVisible)throw new Error("Not supported");return e+this._lineBreakData.getOutputPositionOfInputOffset(t-1).outputLineIndex}normalizePosition(e,t,n,i,r){if(0===r){if(n>0&&i.column===this._getViewLineMinColumn(n))return new IK(i.lineNumber-1,this.getViewLineMaxColumn(e,t,n-1))}else if(1===r){if(n<this.getViewLineCount()-1&&i.column===this.getViewLineMaxColumn(e,t,n))return new IK(i.lineNumber+1,this._getViewLineMinColumn(n+1))}return i}}let lae=[""];function cae(e){if(e>=lae.length)for(let t=1;t<=e;t++)lae[t]=uae(t);return lae[e]}function uae(e){return new Array(e+1).join(" ")}function hae(e,t){return null===e?t?oae.INSTANCE:sae.INSTANCE:new aae(e,t)}class dae{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}}class fae{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new dae(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,n,i){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,n,i)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,n){return new Lse(t,n)}onModelLinesInserted(e,t,n,i){return new Dse(t,n)}onModelLineChanged(e,t,n){return[!1,new kse(t,t),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,n){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesIndentGuides(e,t){const n=t-e+1;let i=new Array(n);for(let r=0;r<n;r++)i[r]=0;return i}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.getLineTokens(e),n=t.getLineContent();return new N2(n,!1,1,n.length+1,0,t.inflate())}getViewLinesData(e,t,n){const i=this.model.getLineCount();e=Math.min(Math.max(1,e),i),t=Math.min(Math.max(1,t),i);let r=[];for(let o=e;o<=t;o++){let t=o-e;n[t]||(r[t]=null),r[t]=this.getViewLineData(o)}return r}getAllOverviewRulerDecorations(e,t,n){const i=this.model.getOverviewRulerDecorations(e,t),r=new gae;for(const o of i){const e=o.options.overviewRuler,t=e?e.position:0;if(0===t)continue;const i=e.getColor(n),s=o.range.startLineNumber,a=o.range.endLineNumber;r.accept(i,s,a,t)}return r.result}getDecorationsInRange(e,t,n){return this.model.getDecorationsInRange(e,t,n)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}}class gae{constructor(){this.result=Object.create(null)}accept(e,t,n,i){let r=this.result[e];if(r){const e=r[r.length-3],o=r[r.length-1];if(e===i&&o+1>=t)return void(n>o&&(r[r.length-1]=n));r.push(i,t,n)}else this.result[e]=[i,t,n]}}class pae{constructor(e,t,n,i,r){this.editorId=e,this.model=t,this.configuration=n,this._linesCollection=i,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let n=this._decorationsCache[t];if(!n){const i=e.range,r=e.options;let o;if(r.isWholeLine){const e=this._coordinatesConverter.convertModelPositionToViewPosition(new IK(i.startLineNumber,1)),t=this._coordinatesConverter.convertModelPositionToViewPosition(new IK(i.endLineNumber,this.model.getLineMaxColumn(i.endLineNumber)));o=new TK(e.lineNumber,e.column,t.lineNumber,t.column)}else o=this._coordinatesConverter.convertModelRangeToViewRange(i);n=new M2(o,r),this._decorationsCache[t]=n}return n}getDecorationsViewportData(e){let t=null!==this._cachedModelDecorationsResolver;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsViewportData(e),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}_getDecorationsViewportData(e){const t=this._linesCollection.getDecorationsInRange(e,this.editorId,Hj(this.configuration.options)),n=e.startLineNumber,i=e.endLineNumber;let r=[],o=0,s=[];for(let a=n;a<=i;a++)s[a-n]=[];for(let a=0,l=t.length;a<l;a++){let e=t[a],l=e.options,c=this._getOrCreateViewModelDecoration(e),u=c.range;if(r[o++]=c,l.inlineClassName){let e=new T2(u,l.inlineClassName,l.inlineClassNameAffectsLetterSpacing?3:0),t=Math.max(n,u.startLineNumber),r=Math.min(i,u.endLineNumber);for(let i=t;i<=r;i++)s[i-n].push(e)}if(l.beforeContentClassName&&n<=u.startLineNumber&&u.startLineNumber<=i){let e=new T2(new TK(u.startLineNumber,u.startColumn,u.startLineNumber,u.startColumn),l.beforeContentClassName,1);s[u.startLineNumber-n].push(e)}if(l.afterContentClassName&&n<=u.endLineNumber&&u.endLineNumber<=i){let e=new T2(new TK(u.endLineNumber,u.endColumn,u.endLineNumber,u.endColumn),l.afterContentClassName,2);s[u.endLineNumber-n].push(e)}}return{decorations:r,inlineDecorations:s}}}class mae extends mG{constructor(e,t,n,i,r,o){if(super(),this._editorId=e,this._configuration=t,this.model=n,this._eventDispatcher=new Rse,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new E7(this.model.getLanguageIdentifier(),this.model.getOptions(),this._configuration),this._tokenizeViewportSoon=this._register(new z$((()=>this.tokenizeViewport()),50)),this._updateConfigurationViewLineCount=this._register(new z$((()=>this._updateConfigurationViewLineCountNow()),0)),this._hasFocus=!1,this._viewportStartLine=-1,this._viewportStartLineTrackedRange=null,this._viewportStartLineDelta=0,this.model.isTooLargeForTokenization())this._lines=new fae(this.model);else{const e=this._configuration.options,t=e.get(40),n=e.get(122),o=e.get(129),s=e.get(121);this._lines=new rae(this._editorId,this.model,i,r,t,this.model.getOptions().tabSize,n,o.wrappingColumn,s)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new Gse(n,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new tae(this._configuration,this.getLineCount(),o)),this._register(this.viewLayout.onDidScroll((e=>{e.scrollTopChanged&&this._tokenizeViewportSoon.schedule(),this._eventDispatcher.emitSingleViewEvent(new Ise(e)),this._eventDispatcher.emitOutgoingEvent(new Wse(e.oldScrollWidth,e.oldScrollLeft,e.oldScrollHeight,e.oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop))}))),this._register(this.viewLayout.onDidContentSizeChange((e=>{this._eventDispatcher.emitOutgoingEvent(e)}))),this._decorations=new pae(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast((e=>{try{const t=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(t,e)}finally{this._eventDispatcher.endEmitViewEvents()}}))),this._register(Noe.getInstance().onDidChange((()=>{this._eventDispatcher.emitSingleViewEvent(new Ase)}))),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this.invalidateMinimapColorCache(),this._viewportStartLineTrackedRange=this.model._setTrackedRange(this._viewportStartLineTrackedRange,null,1),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}tokenizeViewport(){const e=this.viewLayout.getLinesViewportData(),t=this.coordinatesConverter.convertViewPositionToModelPosition(new IK(e.startLineNumber,1)),n=this.coordinatesConverter.convertViewPositionToModelPosition(new IK(e.endLineNumber,1));this.model.tokenizeViewport(t.lineNumber,n.lineNumber)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new Sse(e)),this._eventDispatcher.emitOutgoingEvent(new Bse(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new vse)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new yse)}onDidColorThemeChange(){this._eventDispatcher.emitSingleViewEvent(new Tse)}_onConfigurationChanged(e,t){let n=null;if(-1!==this._viewportStartLine){let e=new IK(this._viewportStartLine,this.getLineMinColumn(this._viewportStartLine));n=this.coordinatesConverter.convertViewPositionToModelPosition(e)}let i=!1;const r=this._configuration.options,o=r.get(40),s=r.get(122),a=r.get(129),l=r.get(121);if(this._lines.setWrappingSettings(o,s,a.wrappingColumn,l)&&(e.emitViewEvent(new Cse),e.emitViewEvent(new Ese),e.emitViewEvent(new wse(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),0!==this.viewLayout.getCurrentScrollTop()&&(i=!0),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(78)&&(this._decorations.reset(),e.emitViewEvent(new wse(null))),e.emitViewEvent(new _se(t)),this.viewLayout.onConfigurationChanged(t),i&&n){const e=this.coordinatesConverter.convertModelPositionToViewPosition(n),t=this.viewLayout.getVerticalOffsetForLineNumber(e.lineNumber);this.viewLayout.setScrollPosition({scrollTop:t+this._viewportStartLineDelta},1)}E7.shouldRecreate(t)&&(this.cursorConfig=new E7(this.model.getLanguageIdentifier(),this.model.getOptions(),this._configuration),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText((e=>{try{const t=this._eventDispatcher.beginEmitViewEvents();let n=!1,i=!1;const r=e.changes,o=e instanceof U8?e.versionId:null,s=this._lines.createLineBreaksComputer();for(const e of r)switch(e.changeType){case 4:for(let t=0;t<e.detail.length;t++){const n=e.detail[t];let i=e.injectedTexts[t];i&&(i=i.filter((e=>!e.ownerId||e.ownerId===this._editorId))),s.addRequest(n,i,null)}break;case 2:{let t=null;e.injectedText&&(t=e.injectedText.filter((e=>!e.ownerId||e.ownerId===this._editorId))),s.addRequest(e.detail,t,null);break}}const a=s.finalize();let l=0;for(const e of r)switch(e.changeType){case 1:this._lines.onModelFlushed(),t.emitViewEvent(new Cse),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),n=!0;break;case 3:{const i=this._lines.onModelLinesDeleted(o,e.fromLineNumber,e.toLineNumber);null!==i&&(t.emitViewEvent(i),this.viewLayout.onLinesDeleted(i.fromLineNumber,i.toLineNumber)),n=!0;break}case 4:{const i=a.slice(l,l+e.detail.length);l+=e.detail.length;const r=this._lines.onModelLinesInserted(o,e.fromLineNumber,e.toLineNumber,i);null!==r&&(t.emitViewEvent(r),this.viewLayout.onLinesInserted(r.fromLineNumber,r.toLineNumber)),n=!0;break}case 2:{const n=a[l];l++;const[r,s,c,u]=this._lines.onModelLineChanged(o,e.lineNumber,n);i=r,s&&t.emitViewEvent(s),c&&(t.emitViewEvent(c),this.viewLayout.onLinesInserted(c.fromLineNumber,c.toLineNumber)),u&&(t.emitViewEvent(u),this.viewLayout.onLinesDeleted(u.fromLineNumber,u.toLineNumber));break}}null!==o&&this._lines.acceptVersionId(o),this.viewLayout.onHeightMaybeChanged(),!n&&i&&(t.emitViewEvent(new Ese),t.emitViewEvent(new wse(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}if(this._viewportStartLine=-1,this._configuration.setMaxLineNumber(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&this._viewportStartLineTrackedRange){const e=this.model._getTrackedRange(this._viewportStartLineTrackedRange);if(e){const t=this.coordinatesConverter.convertModelPositionToViewPosition(e.getStartPosition()),n=this.viewLayout.getVerticalOffsetForLineNumber(t.lineNumber);this.viewLayout.setScrollPosition({scrollTop:n+this._viewportStartLineDelta},1)}}if(e instanceof U8)try{const t=this._eventDispatcher.beginEmitViewEvents();this._cursor.onModelContentChanged(t,e)}finally{this._eventDispatcher.endEmitViewEvents()}}))),this._register(this.model.onDidChangeTokens((e=>{let t=[];for(let n=0,i=e.ranges.length;n<i;n++){const i=e.ranges[n],r=this.coordinatesConverter.convertModelPositionToViewPosition(new IK(i.fromLineNumber,1)).lineNumber,o=this.coordinatesConverter.convertModelPositionToViewPosition(new IK(i.toLineNumber,this.model.getLineMaxColumn(i.toLineNumber))).lineNumber;t[n]={fromLineNumber:r,toLineNumber:o}}this._eventDispatcher.emitSingleViewEvent(new Mse(t)),e.tokenizationSupportChanged&&this._tokenizeViewportSoon.schedule()}))),this._register(this.model.onDidChangeLanguageConfiguration((e=>{this._eventDispatcher.emitSingleViewEvent(new xse),this.cursorConfig=new E7(this.model.getLanguageIdentifier(),this.model.getOptions(),this._configuration),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeLanguage((e=>{this.cursorConfig=new E7(this.model.getLanguageIdentifier(),this.model.getOptions(),this._configuration),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeOptions((e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const e=this._eventDispatcher.beginEmitViewEvents();e.emitViewEvent(new Cse),e.emitViewEvent(new Ese),e.emitViewEvent(new wse(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new E7(this.model.getLanguageIdentifier(),this.model.getOptions(),this._configuration),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeDecorations((e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new wse(e))})))}setHiddenAreas(e){try{const t=this._eventDispatcher.beginEmitViewEvents();this._lines.setHiddenAreas(e)&&(t.emitViewEvent(new Cse),t.emitViewEvent(new Ese),t.emitViewEvent(new wse(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(128),t=this._configuration.options.get(56),n=Math.max(20,Math.round(e.height/t)),i=this.viewLayout.getLinesViewportData(),r=Math.max(1,i.completelyVisibleStartLineNumber-n),o=Math.min(this.getLineCount(),i.completelyVisibleEndLineNumber+n);return this._toModelVisibleRanges(new TK(r,this.getLineMinColumn(r),o,this.getLineMaxColumn(o)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),n=this._lines.getHiddenAreas();if(0===n.length)return[t];let i=[],r=0,o=t.startLineNumber,s=t.startColumn,a=t.endLineNumber,l=t.endColumn;for(let c=0,u=n.length;c<u;c++){const e=n[c].startLineNumber,t=n[c].endLineNumber;t<o||(e>a||(o<e&&(i[r++]=new TK(o,s,e-1,this.model.getLineMaxColumn(e-1))),o=t+1,s=1))}return(o<a||o===a&&s<l)&&(i[r++]=new TK(o,s,a,l)),i}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,n=e.completelyVisibleEndLineNumber;return new TK(t,this.getLineMinColumn(t),n,this.getLineMaxColumn(n))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),n=t.completelyVisibleStartLineNumber,i=t.completelyVisibleEndLineNumber;return new TK(n,this.getLineMinColumn(n),i,this.getLineMaxColumn(i))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,n=this.viewLayout.getLineNumberAtVerticalOffset(t),i=this.coordinatesConverter.convertViewPositionToModelPosition(new IK(n,this.getLineMinColumn(n))),r=this.viewLayout.getVerticalOffsetForLineNumber(n)-t;return{scrollLeft:e.scrollLeft,firstPosition:i,firstPositionDeltaTop:r}}reduceRestoreState(e){if(void 0===e.firstPosition)return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),n=this.coordinatesConverter.convertModelPositionToViewPosition(t),i=this.viewLayout.getVerticalOffsetForLineNumber(n.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:i}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getTextModelOptions(){return this.model.getOptions()}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,n){this._viewportStartLine=e;let i=this.coordinatesConverter.convertViewPositionToModelPosition(new IK(e,this.getLineMinColumn(e)));this._viewportStartLineTrackedRange=this.model._setTrackedRange(this._viewportStartLineTrackedRange,new TK(i.lineNumber,i.column,i.lineNumber,i.column),1);const r=this.viewLayout.getVerticalOffsetForLineNumber(e),o=this.viewLayout.getCurrentScrollTop();this._viewportStartLineDelta=o-r}getActiveIndentGuide(e,t,n){return this._lines.getActiveIndentGuide(e,t,n)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=hX(this.getLineContent(e));return-1===t?0:t+1}getLineLastNonWhitespaceColumn(e){const t=fX(this.getLineContent(e));return-1===t?0:t+2}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getViewLineRenderingData(e,t){let n=this.model.mightContainRTL(),i=this.model.mightContainNonBasicASCII(),r=this.getTabSize(),o=this._lines.getViewLineData(t),s=this._decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber];return new I2(o.minColumn,o.maxColumn,o.content,o.continuesWithWrappedLine,n,i,o.tokens,s,r,o.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,n){let i=this._lines.getViewLinesData(e,t,n);return new D2(this.getTabSize(),i)}getAllOverviewRulerDecorations(e){return this._lines.getAllOverviewRulerDecorations(this._editorId,Hj(this._configuration.options),e)}invalidateOverviewRulerColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const e=t.options.overviewRuler;e&&e.invalidateCachedColor()}}invalidateMinimapColorCache(){const e=this.model.getAllDecorations();for(const t of e){const e=t.options.minimap;e&&e.invalidateCachedColor()}}getValueInRange(e,t){const n=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(n,t)}getModelLineMaxColumn(e){return this.model.getLineMaxColumn(e)}validateModelPosition(e){return this.model.validatePosition(e)}validateModelRange(e){return this.model.validateRange(e)}deduceModelPositionRelativeToViewPosition(e,t,n){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e);2===this.model.getEOL().length&&(t<0?t-=n:t+=n);const r=this.model.getOffsetAt(i)+t;return this.model.getPositionAt(r)}getEOL(){return this.model.getEOL()}getPlainTextToCopy(e,t,n){const i=n?"\r\n":this.model.getEOL();(e=e.slice(0)).sort(TK.compareRangesUsingStarts);let r=!1,o=!1;for(const a of e)a.isEmpty()?r=!0:o=!0;if(!o){if(!t)return"";const n=e.map((e=>e.startLineNumber));let r="";for(let e=0;e<n.length;e++)e>0&&n[e-1]===n[e]||(r+=this.model.getLineContent(n[e])+i);return r}if(r&&t){let t=[],i=0;for(const r of e){const e=r.startLineNumber;r.isEmpty()?e!==i&&t.push(this.model.getLineContent(e)):t.push(this.model.getValueInRange(r,n?2:0)),i=e}return 1===t.length?t[0]:t}let s=[];for(const a of e)a.isEmpty()||s.push(this.model.getValueInRange(a,n?2:0));return 1===s.length?s[0]:s}getRichTextToCopy(e,t){const n=this.model.getLanguageIdentifier();if(1===n.id)return null;if(1!==e.length)return null;let i=e[0];if(i.isEmpty()){if(!t)return null;const e=i.startLineNumber;i=new TK(e,this.model.getLineMinColumn(e),e,this.model.getLineMaxColumn(e))}const r=this._configuration.options.get(40),o=this._getColorMap();let s;if(/[:;\\\/<>]/.test(r.fontFamily)||r.fontFamily===Gj.fontFamily)s=Gj.fontFamily;else{s=r.fontFamily,s=s.replace(/"/g,"'");if(!/[,']/.test(s)){/[+ ]/.test(s)&&(s=`'${s}'`)}s=`${s}, ${Gj.fontFamily}`}return{mode:n.language,html:`<div style="color: ${o[1]};background-color: ${o[2]};font-family: ${s};font-weight: ${r.fontWeight};font-size: ${r.fontSize}px;line-height: ${r.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(i,o)+"</div>"}}_getHTMLToCopy(e,t){const n=e.startLineNumber,i=e.startColumn,r=e.endLineNumber,o=e.endColumn,s=this.getTabSize();let a="";for(let l=n;l<=r;l++){const e=this.model.getLineTokens(l),c=e.getLineContent(),u=l===n?i-1:0,h=l===r?o-1:c.length;a+=""===c?"<br>":Yse(c,e.inflate(),t,u,h,s,aj)}return a}_getColorMap(){let e=YJ.getColorMap(),t=["#000000"];if(e)for(let n=1,i=e.length;n<i;n++)t[n]=Q8.Format.CSS.formatHex(e[n]);return t}pushStackElement(){this.model.pushStackElement()}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,n){this._withViewEventsCollector((i=>this._cursor.setStates(i,e,t,n)))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,n=0){this._withViewEventsCollector((i=>this._cursor.setSelections(i,e,t,n)))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector((t=>this._cursor.restoreState(t,e)))}_executeCursorEdit(e){this._cursor.context.cursorConfig.readOnly?this._eventDispatcher.emitOutgoingEvent(new Use):this._withViewEventsCollector(e)}executeEdits(e,t,n){this._executeCursorEdit((i=>this._cursor.executeEdits(i,e,t,n)))}startComposition(){this._cursor.setIsDoingComposition(!0),this._executeCursorEdit((e=>this._cursor.startComposition(e)))}endComposition(e){this._cursor.setIsDoingComposition(!1),this._executeCursorEdit((t=>this._cursor.endComposition(t,e)))}type(e,t){this._executeCursorEdit((n=>this._cursor.type(n,e,t)))}compositionType(e,t,n,i,r){this._executeCursorEdit((o=>this._cursor.compositionType(o,e,t,n,i,r)))}paste(e,t,n,i){this._executeCursorEdit((r=>this._cursor.paste(r,e,t,n,i)))}cut(e){this._executeCursorEdit((t=>this._cursor.cut(t,e)))}executeCommand(e,t){this._executeCursorEdit((n=>this._cursor.executeCommand(n,e,t)))}executeCommands(e,t){this._executeCursorEdit((n=>this._cursor.executeCommands(n,e,t)))}revealPrimaryCursor(e,t){this._withViewEventsCollector((n=>this._cursor.revealPrimary(n,e,t,0)))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),n=new TK(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector((t=>t.emitViewEvent(new Nse(e,n,null,0,!0,0))))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),n=new TK(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector((t=>t.emitViewEvent(new Nse(e,n,null,0,!0,0))))}revealRange(e,t,n,i,r){this._withViewEventsCollector((o=>o.emitViewEvent(new Nse(e,n,null,i,t,r))))}getVerticalOffsetForLineNumber(e){return this.viewLayout.getVerticalOffsetForLineNumber(e)}getScrollTop(){return this.viewLayout.getCurrentScrollTop()}setScrollTop(e,t){this.viewLayout.setScrollPosition({scrollTop:e},t)}setScrollPosition(e,t){this.viewLayout.setScrollPosition(e,t)}deltaScrollNow(e,t){this.viewLayout.deltaScrollNow(e,t)}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new Ose),this._eventDispatcher.emitOutgoingEvent(new zse))}setMaxLineWidth(e){this.viewLayout.setMaxLineWidth(e)}_withViewEventsCollector(e){try{e(this._eventDispatcher.beginEmitViewEvents())}finally{this._eventDispatcher.endEmitViewEvents()}}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}}class vae{constructor(...e){this._entries=new Map;for(let[t,n]of e)this.set(t,n)}set(e,t){const n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const yae=i$("accessibilityService"),_ae=new M5("accessibilityModeEnabled",!1);class bae extends g1{constructor(e,t){super(0);for(let n=0;n<e.length;n++)this.set(e.charCodeAt(n),1);for(let n=0;n<t.length;n++)this.set(t.charCodeAt(n),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let wae=[],Cae=[];class Sae{constructor(e,t){this.classifier=new bae(e,t)}static create(e){return new Sae(e.get(117),e.get(116))}createLineBreaksComputer(e,t,n,i){t|=0,n=+n;const r=[],o=[],s=[];return{addRequest:(e,t,n)=>{r.push(e),o.push(t),s.push(n)},finalize:()=>{const a=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth;let l=[];for(let e=0,c=r.length;e<c;e++){const c=o[e],u=s[e];!u||u.injectionTexts||c?l[e]=Eae(this.classifier,r[e],c,t,n,a,i):l[e]=xae(this.classifier,u,r[e],t,n,a,i)}return wae.length=0,Cae.length=0,l}}}}function xae(e,t,n,i,r,o,s){if(-1===r)return null;const a=n.length;if(a<=1)return null;const l=t.breakOffsets,c=t.breakOffsetsVisibleColumn,u=Nae(n,i,r,o,s),h=r-u;let d=wae,f=Cae,g=0,p=0,m=0,v=r;const y=l.length;let _=0;if(_>=0){let e=Math.abs(c[_]-v);for(;_+1<y;){const t=Math.abs(c[_+1]-v);if(t>=e)break;e=t,_++}}for(;_<y;){let t=_<0?0:l[_],r=_<0?0:c[_];p>t&&(t=p,r=m);let s=0,u=0,b=0,w=0;if(r<=v){let m=r,y=0===t?0:n.charCodeAt(t-1),_=0===t?0:e.get(y),C=!0;for(let r=t;r<a;r++){const t=r,a=n.charCodeAt(r);let l,c;if(kX(a)?(r++,l=0,c=2):(l=e.get(a),c=kae(a,m,i,o)),t>p&&Dae(y,_,a,l)&&(s=t,u=m),m+=c,m>v){t>p?(b=t,w=m-c):(b=r+1,w=m),m-u>h&&(s=0),C=!1;break}y=a,_=l}if(C){g>0&&(d[g]=l[l.length-1],f[g]=c[l.length-1],g++);break}}if(0===s){let a=r,l=n.charCodeAt(t),c=e.get(l),d=!1;for(let i=t-1;i>=p;i--){const t=i+1,r=n.charCodeAt(i);if(9===r){d=!0;break}let f,g;if(LX(r)?(i--,f=0,g=2):(f=e.get(r),g=WX(r)?o:1),a<=v){if(0===b&&(b=t,w=a),a<=v-h)break;if(Dae(r,f,l,c)){s=t,u=a;break}}a-=g,l=r,c=f}if(0!==s){const e=h-(w-u);if(e<=i){const t=n.charCodeAt(b);let r;r=kX(t)?2:kae(t,w,i,o),e-r<0&&(s=0)}}if(d){_--;continue}}if(0===s&&(s=b,u=w),s<=p){const e=n.charCodeAt(p);kX(e)?(s=p+2,u=m+2):(s=p+1,u=m+kae(e,m,i,o))}for(p=s,d[g]=s,m=u,f[g]=u,g++,v=u+h;_<0||_<y&&c[_]<u;)_++;let C=Math.abs(c[_]-v);for(;_+1<y;){const e=Math.abs(c[_+1]-v);if(e>=C)break;C=e,_++}}return 0===g?null:(d.length=g,f.length=g,wae=t.breakOffsets,Cae=t.breakOffsetsVisibleColumn,t.breakOffsets=d,t.breakOffsetsVisibleColumn=f,t.wrappedTextIndentLength=u,t)}function Eae(e,t,n,i,r,o,s){const a=F8.applyInjectedText(t,n);let l,c;if(n&&n.length>0?(l=n.map((e=>e.text)),c=n.map((e=>e.column-1))):(l=null,c=null),-1===r)return l?new L2([a.length],[],0,l,c):null;const u=a.length;if(u<=1)return l?new L2([a.length],[],0,l,c):null;const h=Nae(a,i,r,o,s),d=r-h;let f=[],g=[],p=0,m=0,v=0,y=r,_=a.charCodeAt(0),b=e.get(_),w=kae(_,0,i,o),C=1;kX(_)&&(w+=1,_=a.charCodeAt(1),b=e.get(_),C++);for(let S=C;S<u;S++){const t=S,n=a.charCodeAt(S);let r,s;kX(n)?(S++,r=0,s=2):(r=e.get(n),s=kae(n,w,i,o)),Dae(_,b,n,r)&&(m=t,v=w),w+=s,w>y&&((0===m||w-v>d)&&(m=t,v=w-s),f[p]=m,g[p]=v,p++,y=v+d,m=0),_=n,b=r}return 0!==p||n&&0!==n.length?(f[p]=u,g[p]=w,new L2(f,g,h,l,c)):null}function kae(e,t,n,i){return 9===e?n-t%n:WX(e)||e<32?i:1}function Lae(e,t){return t-e%t}function Dae(e,t,n,i){return 32!==n&&(2===t||3===t&&2!==i||1===i||3===i&&1!==t)}function Nae(e,t,n,i,r){let o=0;if(0!==r){const s=hX(e);if(-1!==s){for(let n=0;n<s;n++){o+=9===e.charCodeAt(n)?Lae(o,t):1}const a=3===r?2:2===r?1:0;for(let e=0;e<a;e++){o+=Lae(o,t)}o+i>n&&(o=0)}}return o}var Iae;const Tae=null===(Iae=window.trustedTypes)||void 0===Iae?void 0:Iae.createPolicy("domLineBreaksComputer",{createHTML:e=>e});class Mae{static create(){return new Mae}constructor(){}createLineBreaksComputer(e,t,n,i){t|=0,n=+n;let r=[],o=[];return{addRequest:(e,t,n)=>{r.push(e),o.push(t)},finalize:()=>function(e,t,n,i,r,o){var s;function a(t){const n=o[t];if(n){const i=F8.applyInjectedText(e[t],n),r=n.map((e=>e.text)),o=n.map((e=>e.column-1));return new L2([i.length],[],0,r,o)}return null}if(-1===i){const t=[];for(let n=0,i=e.length;n<i;n++)t[n]=a(n);return t}const l=Math.round(i*t.typicalHalfwidthCharacterWidth);2!==r&&3!==r||(r=1);const c=document.createElement("div");D6.applyFontInfoSlow(c,t);const u=E0(1e4),h=[],d=[],f=[],g=[],p=[];for(let w=0;w<e.length;w++){const i=F8.applyInjectedText(e[w],o[w]);let s=0,a=0,c=l;if(0!==r)if(s=hX(i),-1===s)s=0;else{for(let t=0;t<s;t++){a+=9===i.charCodeAt(t)?n-a%n:1}const e=Math.ceil(t.spaceWidth*a);e+t.typicalFullwidthCharacterWidth>l?(s=0,a=0):c=l-e}const m=i.substr(s),v=Aae(m,a,n,c,u);h[w]=s,d[w]=a,f[w]=m,g[w]=v[0],p[w]=v[1]}const m=u.build(),v=null!==(s=null==Tae?void 0:Tae.createHTML(m))&&void 0!==s?s:m;c.innerHTML=v,c.style.position="absolute",c.style.top="10000",c.style.wordWrap="break-word",document.body.appendChild(c);let y=document.createRange();const _=Array.prototype.slice.call(c.children,0);let b=[];for(let w=0;w<e.length;w++){const e=Oae(y,_[w],f[w],g[w]);if(null===e){b[w]=a(w);continue}const t=h[w],n=d[w],i=p[w],r=[];for(let o=0,a=e.length;o<a;o++)r[o]=i[e[o]];if(0!==t)for(let o=0,a=e.length;o<a;o++)e[o]+=t;let s,l;const c=o[w];c?(s=c.map((e=>e.text)),l=c.map((e=>e.column-1))):(s=null,l=null),b[w]=new L2(e,r,n,s,l)}return document.body.removeChild(c),b}(r,e,t,n,i,o)}}}function Aae(e,t,n,i,r){r.appendASCIIString('<div style="width:'),r.appendASCIIString(String(i)),r.appendASCIIString('px;">');const o=e.length;let s=t,a=0,l=[],c=[],u=0<o?e.charCodeAt(0):0;r.appendASCIIString("<span>");for(let h=0;h<o;h++){0!==h&&h%16384==0&&r.appendASCIIString("</span><span>"),l[h]=a,c[h]=s;const t=u;u=h+1<o?e.charCodeAt(h+1):0;let i=1,d=1;switch(t){case 9:i=n-s%n,d=i;for(let e=1;e<=i;e++)e<i?r.write1(160):r.appendASCII(32);break;case 32:32===u?r.write1(160):r.appendASCII(32);break;case 60:r.appendASCIIString("&lt;");break;case 62:r.appendASCIIString("&gt;");break;case 38:r.appendASCIIString("&amp;");break;case 0:r.appendASCIIString("&#00;");break;case 65279:case 8232:case 8233:case 133:r.write1(65533);break;default:WX(t)&&d++,t<32?r.write1(9216+t):r.write1(t)}a+=i,s+=d}return r.appendASCIIString("</span>"),l[e.length]=a,c[e.length]=s,r.appendASCIIString("</div>"),[l,c]}function Oae(e,t,n,i){if(n.length<=1)return null;const r=Array.prototype.slice.call(t.children,0),o=[];try{Rae(e,r,i,0,null,n.length-1,null,o)}catch(s){return console.log(s),null}return 0===o.length?null:(o.push(n.length),o)}function Rae(e,t,n,i,r,o,s,a){if(i===o)return;if(r=r||Pae(e,t,n[i],n[i+1]),s=s||Pae(e,t,n[o],n[o+1]),Math.abs(r[0].top-s[0].top)<=.1)return;if(i+1===o)return void a.push(o);const l=i+(o-i)/2|0,c=Pae(e,t,n[l],n[l+1]);Rae(e,t,n,i,r,l,c,a),Rae(e,t,n,l,c,o,s,a)}function Pae(e,t,n,i){return e.setStart(t[n/16384|0].firstChild,n%16384),e.setEnd(t[i/16384|0].firstChild,i%16384),e.getClientRects()}var Fae=function(e,t){return function(n,i){t(n,i,e)}};let Bae=0;class Wae{constructor(e,t,n,i,r){this.model=e,this.viewModel=t,this.view=n,this.hasRealView=i,this.listenersToRemove=r}dispose(){dG(this.listenersToRemove),this.model.onBeforeDetached(),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}let zae=class e extends mG{constructor(e,t,n,i,r,o,s,a,l,c){super(),this._onDidDispose=this._register(new EG),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new EG),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new EG),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new EG),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new EG),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new EG),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeConfiguration=this._register(new EG),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new EG),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new EG),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new EG),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new EG),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new EG),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new Vae),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new Vae),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new EG),this.onWillType=this._onWillType.event,this._onDidType=this._register(new EG),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new EG),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new EG),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new EG),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new EG),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new EG),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new EG),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new EG),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new EG),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onContextMenu=this._register(new EG),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new EG),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new EG),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new EG),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new EG),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new EG),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new EG),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new EG),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new EG),this.onDidChangeViewZones=this._onDidChangeViewZones.event;const u=Object.assign({},t);let h;this._domElement=e,this._overflowWidgetsDomNode=u.overflowWidgetsDomNode,delete u.overflowWidgetsDomNode,this._id=++Bae,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this.isSimpleWidget=n.isSimpleWidget||!1,this._telemetryData=n.telemetryData,this._configuration=this._register(this._createConfiguration(u,c)),this._register(this._configuration.onDidChange((e=>{this._onDidChangeConfiguration.fire(e);const t=this._configuration.options;if(e.hasChanged(128)){const e=t.get(128);this._onDidLayoutChange.fire(e)}}))),this._contextKeyService=this._register(s.createScoped(this._domElement)),this._notificationService=l,this._codeEditorService=r,this._commandService=o,this._themeService=a,this._register(new Uae(this,this._contextKeyService)),this._register(new Hae(this,this._contextKeyService)),this._instantiationService=i.createChild(new vae([A5,this._contextKeyService])),this._modelData=null,this._contributions={},this._actions={},this._focusTracker=new jae(e),this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},h=Array.isArray(n.contributions)?n.contributions:f6.getEditorContributions();for(const f of h)if(this._contributions[f.id])nG(new Error(`Cannot have two contributions with the same id ${f.id}`));else try{const e=this._instantiationService.createInstance(f.ctor,this);this._contributions[f.id]=e}catch(d){nG(d)}f6.getEditorActions().forEach((e=>{if(this._actions[e.id])return void nG(new Error(`Cannot have two actions with the same id ${e.id}`));const t=new Kse(e.id,e.label,e.alias,GZ(e.precondition),(()=>this._instantiationService.invokeFunction((t=>Promise.resolve(e.runEditorCommand(t,this,null))))),this._contextKeyService);this._actions[t.id]=t})),this._codeEditorService.addCodeEditor(this)}_createConfiguration(e,t){return new D6(this.isSimpleWidget,e,this._domElement,t)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return bQ.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose();const e=Object.keys(this._contributions);for(let t=0,n=e.length;t<n;t++){const n=e[t];this._contributions[n].dispose()}this._contributions={},this._actions={},this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e)}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?Qie.getWordAtPosition(this._modelData.model,this._configuration.options.get(114),e):null}getValue(e=null){if(!this._modelData)return"";const t=!(!e||!e.preserveBOM);let n=0;return e&&e.lineEnding&&"\n"===e.lineEnding?n=1:e&&e.lineEnding&&"\r\n"===e.lineEnding&&(n=2),this._modelData.model.getValue(n,t)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const t=e;if(null===this._modelData&&null===t)return;if(this._modelData&&this._modelData.model===t)return;const n=this.hasTextFocus(),i=this._detachModel();this._attachModel(t),n&&this.hasModel()&&this.focus();const r={oldModelUrl:i?i.uri:null,newModelUrl:t?t.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(r),this._postDetachModelCleanup(i)}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(let n in t)this._removeDecorationType(e+"-"+n)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetForPosition(e,t,n){const i=e.model.validatePosition({lineNumber:t,column:n}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber)}getTopForLineNumber(t){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,t,1):-1}getTopForPosition(t,n){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,t,n):-1}setHiddenAreas(e){this._modelData&&this._modelData.viewModel.setHiddenAreas(e.map((e=>TK.lift(e))))}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),n=this._modelData.model.getOptions().tabSize;return M7.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,n)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e){if(this._modelData){if(!IK.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections("api",[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,n,i){if(!this._modelData)return;if(!TK.isIRange(e))throw new Error("Invalid arguments");const r=this._modelData.model.validateRange(e),o=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(r);this._modelData.viewModel.revealRange("api",n,o,t,i)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,n){if("number"!=typeof e)throw new Error("Invalid arguments");this._sendRevealRange(new TK(e,1,e,1),t,!1,n)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,n,i){if(!IK.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new TK(e.lineNumber,e.column,e.lineNumber,e.column),t,n,i)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e){const t=MK.isISelection(e),n=TK.isIRange(e);if(!t&&!n)throw new Error("Invalid arguments");if(t)this._setSelectionImpl(e);else if(n){const t={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(t)}}_setSelectionImpl(e){if(!this._modelData)return;const t=new MK(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections("api",[t])}revealLines(e,t,n=0){this._revealLines(e,t,0,n)}revealLinesInCenter(e,t,n=0){this._revealLines(e,t,1,n)}revealLinesInCenterIfOutsideViewport(e,t,n=0){this._revealLines(e,t,2,n)}revealLinesNearTop(e,t,n=0){this._revealLines(e,t,5,n)}_revealLines(e,t,n,i){if("number"!=typeof e||"number"!=typeof t)throw new Error("Invalid arguments");this._sendRevealRange(new TK(e,1,t,1),n,!1,i)}revealRange(e,t=0,n=!1,i=!0){this._revealRange(e,n?1:0,i,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,n,i){if(!TK.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(TK.lift(e),t,n,i)}setSelections(e,t="api",n=0){if(this._modelData){if(!e||0===e.length)throw new Error("Invalid arguments");for(let t=0,n=e.length;t<n;t++)if(!MK.isISelection(e[t]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,n)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if("number"!=typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if("number"!=typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.setScrollPosition(e,t)}saveViewState(){if(!this._modelData)return null;const e={},t=Object.keys(this._contributions);for(const n of t){const t=this._contributions[n];"function"==typeof t.saveViewState&&(e[n]=t.saveViewState())}return{cursorState:this._modelData.viewModel.saveCursorState(),viewState:this._modelData.viewModel.saveState(),contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const e=t.cursorState;Array.isArray(e)?this._modelData.viewModel.restoreCursorState(e):this._modelData.viewModel.restoreCursorState([e]);const n=t.contributionsState||{},i=Object.keys(this._contributions);for(let t=0,o=i.length;t<o;t++){const e=i[t],r=this._contributions[e];"function"==typeof r.restoreViewState&&r.restoreViewState(n[e])}const r=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(r)}}getContribution(e){return this._contributions[e]||null}getActions(){const e=[],t=Object.keys(this._actions);for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(this._actions[i])}return e}getSupportedActions(){let e=this.getActions();return e=e.filter((e=>e.isSupported())),e}getAction(e){return this._actions[e]||null}trigger(e,t,n){switch(n=n||{},t){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(e);case"type":{const t=n;return void this._type(e,t.text||"")}case"replacePreviousChar":{const t=n;return void this._compositionType(e,t.text||"",t.replaceCharCnt||0,0,0)}case"compositionType":{const t=n;return void this._compositionType(e,t.text||"",t.replacePrevCharCnt||0,t.replaceNextCharCnt||0,t.positionDelta||0)}case"paste":{const t=n;return void this._paste(e,t.text||"",t.pasteOnNewLine||!1,t.multicursorText||null,t.mode||null)}case"cut":return void this._cut(e)}const i=this.getAction(t);i?Promise.resolve(i.run()).then(void 0,nG):this._modelData&&(this._triggerEditorCommand(e,t,n)||this._triggerCommand(t,n))}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){this._modelData&&0!==t.length&&("keyboard"===e&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),"keyboard"===e&&this._onDidType.fire(t))}_compositionType(e,t,n,i,r){this._modelData&&this._modelData.viewModel.compositionType(t,n,i,r,e)}_paste(e,t,n,i,r){if(!this._modelData||0===t.length)return;const o=this._modelData.viewModel.getSelection().getStartPosition();this._modelData.viewModel.paste(t,n,i,e);const s=this._modelData.viewModel.getSelection().getStartPosition();"keyboard"===e&&this._onDidPaste.fire({range:new TK(o.lineNumber,o.column,s.lineNumber,s.column),mode:r})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,n){const i=f6.getEditorCommand(t);return!!i&&((n=n||{}).source=e,this._instantiationService.invokeFunction((e=>{Promise.resolve(i.runEditorCommand(e,this,n)).then(void 0,nG)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&(!this._configuration.options.get(78)&&(this._modelData.model.pushStackElement(),!0))}popUndoStop(){return!!this._modelData&&(!this._configuration.options.get(78)&&(this._modelData.model.popStackElement(),!0))}executeEdits(e,t,n){if(!this._modelData)return!1;if(this._configuration.options.get(78))return!1;let i;return i=n?Array.isArray(n)?()=>n:n:()=>null,this._modelData.viewModel.executeEdits(e,t,i),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,Hj(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?0===e.length&&0===t.length?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){const t=this._decorationTypeKeysToIds[e];t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(128)}createOverviewRuler(e){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(e):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarMouseDown(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarMouseDown(e)}layout(e){this._configuration.observeReferenceElement(e),this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const n=this._contentWidgets[t];n.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(n)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const e=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(e)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const n=this._overlayWidgets[t];n.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(n)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const e=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(e)}}changeViewZones(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(e,t):null}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;const n=this._modelData.model.validatePosition(t),i=this._configuration.options,r=i.get(128);return{top:e._getVerticalOffsetForPosition(this._modelData,n.lineNumber,n.column)-this.getScrollTop(),left:this._modelData.view.getOffsetForColumn(n.lineNumber,n.column)+r.glyphMarginWidth+r.lineNumbersWidth+r.decorationsWidth-this.getScrollLeft(),height:i.get(56)}}getOffsetForColumn(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(e,t):-1}render(e=!1){this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,e)}setAriaOptions(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(e)}applyFontInfo(e){D6.applyFontInfoSlow(e,this._configuration.options.get(40))}_attachModel(e){if(!e)return void(this._modelData=null);const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageIdentifier().language),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setMaxLineNumber(e.getLineCount()),e.onBeforeAttached();const n=new mae(this._id,this._configuration,e,Mae.create(),Sae.create(this._configuration.options),(e=>oY(e)));t.push(e.onDidChangeDecorations((e=>this._onDidChangeModelDecorations.fire(e)))),t.push(e.onDidChangeLanguage((t=>{this._domElement.setAttribute("data-mode-id",e.getLanguageIdentifier().language),this._onDidChangeModelLanguage.fire(t)}))),t.push(e.onDidChangeLanguageConfiguration((e=>this._onDidChangeModelLanguageConfiguration.fire(e)))),t.push(e.onDidChangeContent((e=>this._onDidChangeModelContent.fire(e)))),t.push(e.onDidChangeOptions((e=>this._onDidChangeModelOptions.fire(e)))),t.push(e.onWillDispose((()=>this.setModel(null)))),t.push(n.onEvent((e=>{switch(e.kind){case 0:this._onDidContentSizeChange.fire(e);break;case 1:this._editorTextFocus.setValue(e.hasFocus);break;case 2:this._onDidScrollChange.fire(e);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidAttemptReadOnlyEdit.fire();break;case 5:{e.reachedMaxCursorCount&&this._notificationService.warn(GH(0,"The number of cursors has been limited to {0}.",Gse.MAX_CURSOR_COUNT));const t=[];for(let r=0,o=e.selections.length;r<o;r++)t[r]=e.selections[r].getPosition();const n={position:t[0],secondaryPositions:t.slice(1),reason:e.reason,source:e.source};this._onDidChangeCursorPosition.fire(n);const i={selection:e.selections[0],secondarySelections:e.selections.slice(1),modelVersionId:e.modelVersionId,oldSelections:e.oldSelections,oldModelVersionId:e.oldModelVersionId,source:e.source,reason:e.reason};this._onDidChangeCursorSelection.fire(i);break}}})));const[i,r]=this._createView(n);if(r){this._domElement.appendChild(i.domNode.domNode);let t=Object.keys(this._contentWidgets);for(let e=0,n=t.length;e<n;e++){const n=t[e];i.addContentWidget(this._contentWidgets[n])}t=Object.keys(this._overlayWidgets);for(let e=0,n=t.length;e<n;e++){const n=t[e];i.addOverlayWidget(this._overlayWidgets[n])}i.render(!1,!0),i.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new Wae(e,n,i,r,t)}_createView(e){let t;t=this.isSimpleWidget?{paste:(e,t,n,i)=>{this._paste("keyboard",e,t,n,i)},type:e=>{this._type("keyboard",e)},compositionType:(e,t,n,i)=>{this._compositionType("keyboard",e,t,n,i)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(e,t,n,i)=>{const r={text:e,pasteOnNewLine:t,multicursorText:n,mode:i};this._commandService.executeCommand("paste",r)},type:e=>{const t={text:e};this._commandService.executeCommand("type",t)},compositionType:(e,t,n,i)=>{if(n||i){const r={text:e,replacePrevCharCnt:t,replaceNextCharCnt:n,positionDelta:i};this._commandService.executeCommand("compositionType",r)}else{const n={text:e,replaceCharCnt:t};this._commandService.executeCommand("replacePreviousChar",n)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const n=new Tre(e.coordinatesConverter);n.onKeyDown=e=>this._onKeyDown.fire(e),n.onKeyUp=e=>this._onKeyUp.fire(e),n.onContextMenu=e=>this._onContextMenu.fire(e),n.onMouseMove=e=>this._onMouseMove.fire(e),n.onMouseLeave=e=>this._onMouseLeave.fire(e),n.onMouseDown=e=>this._onMouseDown.fire(e),n.onMouseUp=e=>this._onMouseUp.fire(e),n.onMouseDrag=e=>this._onMouseDrag.fire(e),n.onMouseDrop=e=>this._onMouseDrop.fire(e),n.onMouseDropCanceled=e=>this._onMouseDropCanceled.fire(e),n.onMouseWheel=e=>this._onMouseWheel.fire(e);return[new gse(t,this._configuration,this._themeService,e,n,this._overflowWidgetsDomNode),!0]}_postDetachModelCleanup(e){e&&e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&this._domElement.removeChild(t),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return null!==this._modelData}};zae=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Fae(3,t$),Fae(4,o$),Fae(5,KZ),Fae(6,A5),Fae(7,B5),Fae(8,g4),Fae(9,yae)],zae);class Vae extends mG{constructor(){super(),this._onDidChangeToTrue=this._register(new EG),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new EG),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,2===this._value?this._onDidChangeToTrue.fire():1===this._value&&this._onDidChangeToFalse.fire())}}class Uae extends mG{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=gre.editorSimpleInput.bindTo(t),this._editorFocus=gre.focus.bindTo(t),this._textInputFocus=gre.textInputFocus.bindTo(t),this._editorTextFocus=gre.editorTextFocus.bindTo(t),this._editorTabMovesFocus=gre.tabMovesFocus.bindTo(t),this._editorReadonly=gre.readOnly.bindTo(t),this._inDiffEditor=gre.inDiffEditor.bindTo(t),this._editorColumnSelection=gre.columnSelection.bindTo(t),this._hasMultipleSelections=gre.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=gre.hasNonEmptySelection.bindTo(t),this._canUndo=gre.canUndo.bindTo(t),this._canRedo=gre.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._editorTabMovesFocus.set(e.get(127)),this._editorReadonly.set(e.get(78)),this._inDiffEditor.set(e.get(51)),this._editorColumnSelection.set(e.get(16))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some((e=>!e.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(Boolean(e&&e.canUndo())),this._canRedo.set(Boolean(e&&e.canRedo()))}}class Hae extends mG{constructor(e,t){super(),this._editor=e,this._contextKeyService=t,this._langId=gre.languageId.bindTo(t),this._hasCompletionItemProvider=gre.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=gre.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=gre.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=gre.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=gre.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=gre.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=gre.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=gre.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=gre.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=gre.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=gre.hasReferenceProvider.bindTo(t),this._hasRenameProvider=gre.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=gre.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=gre.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=gre.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=gre.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=gre.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=gre.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInWalkThrough=gre.isInWalkThroughSnippet.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(kJ.onDidChange(n)),this._register(WJ.onDidChange(n)),this._register(FJ.onDidChange(n)),this._register(AJ.onDidChange(n)),this._register(OJ.onDidChange(n)),this._register(RJ.onDidChange(n)),this._register(PJ.onDidChange(n)),this._register(NJ.onDidChange(n)),this._register(TJ.onDidChange(n)),this._register(IJ.onDidChange(n)),this._register(xJ.onDidChange(n)),this._register(EJ.onDidChange(n)),this._register(zJ.onDidChange(n)),this._register(VJ.onDidChange(n)),this._register(DJ.onDidChange(n)),this._register(BJ.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}))}_update(){const e=this._editor.getModel();e?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(e.getLanguageIdentifier().language),this._hasCompletionItemProvider.set(kJ.has(e)),this._hasCodeActionsProvider.set(WJ.has(e)),this._hasCodeLensProvider.set(FJ.has(e)),this._hasDefinitionProvider.set(AJ.has(e)),this._hasDeclarationProvider.set(OJ.has(e)),this._hasImplementationProvider.set(RJ.has(e)),this._hasTypeDefinitionProvider.set(PJ.has(e)),this._hasHoverProvider.set(NJ.has(e)),this._hasDocumentHighlightProvider.set(TJ.has(e)),this._hasDocumentSymbolProvider.set(IJ.has(e)),this._hasReferenceProvider.set(xJ.has(e)),this._hasRenameProvider.set(EJ.has(e)),this._hasSignatureHelpProvider.set(DJ.has(e)),this._hasInlayHintsProvider.set(BJ.has(e)),this._hasDocumentFormattingProvider.set(zJ.has(e)||VJ.has(e)),this._hasDocumentSelectionFormattingProvider.set(VJ.has(e)),this._hasMultipleDocumentFormattingProvider.set(zJ.all(e).length+VJ.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(VJ.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===j$.walkThroughSnippet)})):this.reset()}}class jae extends mG{constructor(e){super(),this._onChange=this._register(new EG),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(BY(e)),this._register(this._domFocusTracker.onDidFocus((()=>{this._hasFocus=!0,this._onChange.fire(void 0)}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasFocus=!1,this._onChange.fire(void 0)})))}hasFocus(){return this._hasFocus}}const Gae=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),Kae=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function qae(e){return Gae+encodeURIComponent(e.toString())+Kae}const $ae=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),Yae=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');G5(((e,t)=>{const n=e.getColor(ote);n&&t.addRule(`.monaco-editor .squiggly-error { border-bottom: 4px double ${n}; }`);const i=e.getColor(rte);i&&t.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${qae(i)}") repeat-x bottom left; }`);const r=e.getColor(ite);r&&t.addRule(`.monaco-editor .squiggly-error::before { display: block; content: ''; width: 100%; height: 100%; background: ${r}; }`);const o=e.getColor(lte);o&&t.addRule(`.monaco-editor .squiggly-warning { border-bottom: 4px double ${o}; }`);const s=e.getColor(ate);s&&t.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${qae(s)}") repeat-x bottom left; }`);const a=e.getColor(ste);a&&t.addRule(`.monaco-editor .squiggly-warning::before { display: block; content: ''; width: 100%; height: 100%; background: ${a}; }`);const l=e.getColor(hte);l&&t.addRule(`.monaco-editor .squiggly-info { border-bottom: 4px double ${l}; }`);const c=e.getColor(ute);c&&t.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${qae(c)}") repeat-x bottom left; }`);const u=e.getColor(cte);u&&t.addRule(`.monaco-editor .squiggly-info::before { display: block; content: ''; width: 100%; height: 100%; background: ${u}; }`);const h=e.getColor(fte);h&&t.addRule(`.monaco-editor .squiggly-hint { border-bottom: 2px dotted ${h}; }`);const d=e.getColor(dte);var f;d&&t.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${f=d,$ae+encodeURIComponent(f.toString())+Yae}") no-repeat bottom left; }`);const g=e.getColor(Iie);g&&t.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${g.rgba.a}; }`);const p=e.getColor(Nie);p&&t.addRule(`.monaco-editor.showUnused .squiggly-unnecessary { border-bottom: 2px dashed ${p}; }`);const m=e.getColor(pte)||"inherit";t.addRule(`.monaco-editor.showDeprecated .squiggly-inline-deprecated { text-decoration: line-through; text-decoration-color: ${m}}`)}));class Xae{constructor(e,t,n){const i=e=>this.emitter.fire(e);this.emitter=new EG({onFirstListenerAdd:()=>e.addEventListener(t,i,n),onLastListenerRemove:()=>e.removeEventListener(t,i,n)})}get event(){return this.emitter.event}dispose(){this.emitter.dispose()}}function Zae(e){return e.preventDefault(),e.stopPropagation(),e}var Qae=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};var Jae,ele;(ele=Jae||(Jae={})).North="north",ele.South="south",ele.East="east",ele.West="west";const tle=new EG;const nle=new EG;class ile{constructor(){this.disposables=new pG}get onPointerMove(){return this.disposables.add(new Xae(window,"mousemove")).event}get onPointerUp(){return this.disposables.add(new Xae(window,"mouseup")).event}dispose(){this.disposables.dispose()}}Qae([T6],ile.prototype,"onPointerMove",null),Qae([T6],ile.prototype,"onPointerUp",null);class rle{constructor(e){this.el=e,this.disposables=new pG}get onPointerMove(){return this.disposables.add(new Xae(this.el,M6.Change)).event}get onPointerUp(){return this.disposables.add(new Xae(this.el,M6.End)).event}dispose(){this.disposables.dispose()}}Qae([T6],rle.prototype,"onPointerMove",null),Qae([T6],rle.prototype,"onPointerUp",null);class ole{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}}Qae([T6],ole.prototype,"onPointerMove",null),Qae([T6],ole.prototype,"onPointerUp",null);class sle extends mG{constructor(e,t,n){super(),this.hoverDelay=300,this.hoverDelayer=this._register(new A$(this.hoverDelay)),this._state=3,this._onDidEnablementChange=this._register(new EG),this.onDidEnablementChange=this._onDidEnablementChange.event,this._onDidStart=this._register(new EG),this.onDidStart=this._onDidStart.event,this._onDidChange=this._register(new EG),this.onDidChange=this._onDidChange.event,this._onDidReset=this._register(new EG),this.onDidReset=this._onDidReset.event,this._onDidEnd=this._register(new EG),this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.orthogonalStartSashDisposables=this._register(new pG),this.orthogonalStartDragHandleDisposables=this._register(new pG),this.orthogonalEndSashDisposables=this._register(new pG),this.orthogonalEndDragHandleDisposables=this._register(new pG),this.el=WY(e,GY(".monaco-sash")),n.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${n.orthogonalEdge}`),lj&&this.el.classList.add("mac");const i=this._register(new Xae(this.el,"mousedown")).event;this._register(i((e=>this.onPointerStart(e,new ile)),this));const r=this._register(new Xae(this.el,"dblclick")).event;this._register(r(this.onPointerDoublePress,this));const o=this._register(new Xae(this.el,"mouseenter")).event;this._register(o((()=>sle.onMouseEnter(this))));const s=this._register(new Xae(this.el,"mouseleave")).event;this._register(s((()=>sle.onMouseLeave(this)))),this._register(O6.addTarget(this.el));const a=SG.map(this._register(new Xae(this.el,M6.Start)).event,(e=>{var t;return Object.assign(Object.assign({},e),{target:null!==(t=e.initialTarget)&&void 0!==t?t:null})}));this._register(a((e=>this.onPointerStart(e,new rle(this.el))),this));const l=this._register(new Xae(this.el,M6.Tap)).event,c=SG.map(SG.filter(SG.debounce(l,((e,t)=>{var n;return{event:t,count:(null!==(n=null==e?void 0:e.count)&&void 0!==n?n:0)+1}}),250),(({count:e})=>2===e)),(({event:e})=>{var t;return Object.assign(Object.assign({},e),{target:null!==(t=e.initialTarget)&&void 0!==t?t:null})}));this._register(c(this.onPointerDoublePress,this)),"number"==typeof n.size?(this.size=n.size,0===n.orientation?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=4,this._register(tle.event((e=>{this.size=e,this.layout()})))),this._register(nle.event((e=>this.hoverDelay=e))),this.hidden=!1,this.layoutProvider=t,this.orthogonalStartSash=n.orthogonalStartSash,this.orthogonalEndSash=n.orthogonalEndSash,this.orientation=n.orientation||0,1===this.orientation?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",false),this.layout()}get state(){return this._state}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",0===e),this.el.classList.toggle("minimum",1===e),this.el.classList.toggle("maximum",2===e),this._state=e,this._onDidEnablementChange.fire(e))}get orthogonalStartSash(){return this._orthogonalStartSash}set orthogonalStartSash(e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=t=>{this.orthogonalStartDragHandleDisposables.clear(),0!==t&&(this._orthogonalStartDragHandle=WY(this.el,GY(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(gG((()=>this._orthogonalStartDragHandle.remove()))),this.orthogonalStartDragHandleDisposables.add(new Xae(this._orthogonalStartDragHandle,"mouseenter")).event((()=>sle.onMouseEnter(e)),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new Xae(this._orthogonalStartDragHandle,"mouseleave")).event((()=>sle.onMouseLeave(e)),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange(t,this)),t(e.state)}this._orthogonalStartSash=e}get orthogonalEndSash(){return this._orthogonalEndSash}set orthogonalEndSash(e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=t=>{this.orthogonalEndDragHandleDisposables.clear(),0!==t&&(this._orthogonalEndDragHandle=WY(this.el,GY(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(gG((()=>this._orthogonalEndDragHandle.remove()))),this.orthogonalEndDragHandleDisposables.add(new Xae(this._orthogonalEndDragHandle,"mouseenter")).event((()=>sle.onMouseEnter(e)),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new Xae(this._orthogonalEndDragHandle,"mouseleave")).event((()=>sle.onMouseLeave(e)),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange(t,this)),t(e.state)}this._orthogonalEndSash=e}onPointerStart(e,t){PY(e);let n=!1;if(!e.__orthogonalSashEvent){const i=this.getOrthogonalSash(e);i&&(n=!0,e.__orthogonalSashEvent=!0,i.onPointerStart(e,new ole(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new ole(t))),!this.state)return;const i=[...$Y("iframe"),...$Y("webview")];for(const h of i)h.style.pointerEvents="none";const r=e.pageX,o=e.pageY,s=e.altKey,a={startX:r,currentX:r,startY:o,currentY:o,altKey:s};this.el.classList.add("active"),this._onDidStart.fire(a);const l=NY(this.el),c=()=>{let e="";e=n?"all-scroll":1===this.orientation?1===this.state?"s-resize":2===this.state?"n-resize":lj?"row-resize":"ns-resize":1===this.state?"e-resize":2===this.state?"w-resize":lj?"col-resize":"ew-resize",l.textContent=`* { cursor: ${e} !important; }`},u=new pG;c(),n||this.onDidEnablementChange(c,null,u);t.onPointerMove((e=>{PY(e,!1);const t={startX:r,currentX:e.pageX,startY:o,currentY:e.pageY,altKey:s};this._onDidChange.fire(t)}),null,u),t.onPointerUp((e=>{PY(e,!1),this.el.removeChild(l),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(const t of i)t.style.pointerEvents="auto"}),null,u),u.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger((()=>e.el.classList.add("hover")),e.hoverDelay).then(void 0,(()=>{})),!t&&e.linkedSash&&sle.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&sle.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){sle.onMouseLeave(this)}layout(){if(0===this.orientation){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}hide(){this.hidden=!0,this.el.style.display="none",this.el.setAttribute("aria-hidden","true")}getOrthogonalSash(e){if(e.target&&e.target instanceof HTMLElement)return e.target.classList.contains("orthogonal-drag-handle")?e.target.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash:void 0}dispose(){super.dispose(),this.el.remove()}}class ale{constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}}const lle=[];function cle(e,t,n){t instanceof ale||(t=new ale(t,[],n)),lle.push([e,t])}const ule=i$("IEditorCancelService"),hle=new M5("cancellableOperation",!1,GH(0,"Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));cle(ule,class{constructor(){this._tokens=new WeakMap}add(e,t){let n,i=this._tokens.get(e);return i||(i=e.invokeWithinContext((e=>({key:hle.bindTo(e.get(A5)),tokens:new bG}))),this._tokens.set(e,i)),i.key.set(!0),n=i.tokens.push(t),()=>{n&&(n(),i.key.set(!i.tokens.isEmpty()),n=void 0)}}cancel(e){const t=this._tokens.get(e);if(!t)return;const n=t.tokens.pop();n&&(n.cancel(),t.key.set(!t.tokens.isEmpty()))}},!0);class dle extends OG{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext((t=>t.get(ule).add(e,this)))}dispose(){this._unregister(),super.dispose()}}l6(new class extends r6{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:hle})}runEditorCommand(e,t){e.get(ule).cancel(t)}});class fle{constructor(e,t){if(this.flags=t,0!=(1&this.flags)){const t=e.getModel();this.modelVersionId=t?nX("{0}#{1}",t.uri.toString(),t.getVersionId()):null}else this.modelVersionId=null;0!=(4&this.flags)?this.position=e.getPosition():this.position=null,0!=(2&this.flags)?this.selection=e.getSelection():this.selection=null,0!=(8&this.flags)?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof fle))return!1;const t=e;return this.modelVersionId===t.modelVersionId&&(this.scrollLeft===t.scrollLeft&&this.scrollTop===t.scrollTop&&(!(!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position))&&!(!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))))}validate(e){return this._equals(new fle(e,this.flags))}}class gle extends dle{constructor(e,t,n,i){super(e,i),this._listener=new pG,4&t&&this._listener.add(e.onDidChangeCursorPosition((e=>{n&&TK.containsPosition(n,e.position)||this.cancel()}))),2&t&&this._listener.add(e.onDidChangeCursorSelection((e=>{n&&TK.containsRange(n,e.selection)||this.cancel()}))),8&t&&this._listener.add(e.onDidScrollChange((e=>this.cancel()))),1&t&&(this._listener.add(e.onDidChangeModel((e=>this.cancel()))),this._listener.add(e.onDidChangeModelContent((e=>this.cancel()))))}dispose(){this._listener.dispose(),super.dispose()}}class ple extends OG{constructor(e,t){super(t),this._listener=e.onDidChangeContent((()=>this.cancel()))}dispose(){this._listener.dispose(),super.dispose()}}class mle{constructor(e,t,n){this._visiblePosition=e,this._visiblePositionScrollDelta=t,this._cursorPosition=n}static capture(e){let t=null,n=0;if(0!==e.getScrollTop()){const i=e.getVisibleRanges();if(i.length>0){t=i[0].getStartPosition();const r=e.getTopForPosition(t.lineNumber,t.column);n=e.getScrollTop()-r}}return new mle(t,n,e.getPosition())}restore(e){if(this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){const t=e.getPosition();if(!this._cursorPosition||!t)return;const n=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+n)}}const vle={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Z7.text,TERMINALS:"Terminals"};class yle{constructor(e){this.data=e}update(){}getData(){return this.data}}const _le={CurrentDragAndDropData:void 0};class ble extends mG{constructor(e,t,n={}){super(),this.options=n,this._context=e||this,this._action=t,t instanceof s5&&this._register(t.onDidChange((e=>{this.element&&this.handleActionChangeEvent(e)})))}handleActionChangeEvent(e){void 0!==e.enabled&&this.updateEnabled(),void 0!==e.checked&&this.updateChecked(),void 0!==e.class&&this.updateClass(),void 0!==e.label&&(this.updateLabel(),this.updateTooltip()),void 0!==e.tooltip&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new a5)),this._actionRunner}set actionRunner(e){this._actionRunner=e}getAction(){return this._action}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(O6.addTarget(e));const n=this.options&&this.options.draggable;n&&(e.draggable=!0,h$&&this._register(Q$(e,RY.DRAG_START,(e=>{var t;return null===(t=e.dataTransfer)||void 0===t?void 0:t.setData(vle.TEXT,this._action.label)})))),this._register(Q$(t,M6.Tap,(e=>this.onClick(e,!0)))),this._register(Q$(t,RY.MOUSE_DOWN,(e=>{n||PY(e,!0),this._action.enabled&&0===e.button&&t.classList.add("active")}))),lj&&this._register(Q$(t,RY.CONTEXT_MENU,(e=>{0===e.button&&!0===e.ctrlKey&&this.onClick(e)}))),this._register(Q$(t,RY.CLICK,(e=>{PY(e,!0),this.options&&this.options.isMenu||gj((()=>this.onClick(e)))}))),this._register(Q$(t,RY.DBLCLICK,(e=>{PY(e,!0)}))),[RY.MOUSE_UP,RY.MOUSE_OUT].forEach((e=>{this._register(Q$(t,e,(e=>{PY(e),t.classList.remove("active")})))}))}onClick(e,t=!1){var n;PY(e,!0);const i=BZ(this._context)?(null===(n=this.options)||void 0===n?void 0:n.useEventAsContext)?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}updateTooltip(){}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),super.dispose()}}class wle extends ble{constructor(e,t,n={}){super(e,t,n),this.options=n,this.options.icon=void 0!==n.icon&&n.icon,this.options.label=void 0===n.label||n.label,this.cssClass=""}render(e){super.render(e),this.element&&(this.label=WY(this.element,GY("a.action-label"))),this.label&&(this._action.id===l5.ID?this.label.setAttribute("role","presentation"):this.options.isMenu?this.label.setAttribute("role","menuitem"):this.label.setAttribute("role","button")),this.options.label&&this.options.keybinding&&this.element&&(WY(this.element,GY("span.keybinding")).textContent=this.options.keybinding),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.getAction().label)}updateTooltip(){let e=null;this.getAction().tooltip?e=this.getAction().tooltip:!this.options.label&&this.getAction().label&&this.options.icon&&(e=this.getAction().label,this.options.keybinding&&(e=GH(0,"{0} ({1})",e,this.options.keybinding))),e&&this.label&&(this.label.title=e)}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getAction().class,this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label&&this.label.classList.remove("codicon")}updateEnabled(){this.getAction().enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element&&this.element.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element&&this.element.classList.add("disabled"))}updateChecked(){this.label&&(this.getAction().checked?this.label.classList.add("checked"):this.label.classList.remove("checked"))}}var Cle=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Sle extends mG{constructor(e,t={}){var n,i,r,o,s,a;let l,c;switch(super(),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new EG),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new EG({onFirstListenerAdd:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new EG),this.onDidRun=this._onDidRun.event,this._onBeforeRun=this._register(new EG),this.onBeforeRun=this._onBeforeRun.event,this.options=t,this._context=null!==(n=t.context)&&void 0!==n?n:null,this._orientation=null!==(i=this.options.orientation)&&void 0!==i?i:0,this._triggerKeys={keyDown:null!==(o=null===(r=this.options.triggerKeys)||void 0===r?void 0:r.keyDown)&&void 0!==o&&o,keys:null!==(a=null===(s=this.options.triggerKeys)||void 0===s?void 0:s.keys)&&void 0!==a?a:[3,10]},this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new a5,this._register(this._actionRunner)),this._register(this._actionRunner.onDidRun((e=>this._onDidRun.fire(e)))),this._register(this._actionRunner.onBeforeRun((e=>this._onBeforeRun.fire(e)))),this._actionIds=[],this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",!1!==t.animated&&this.domNode.classList.add("animated"),this._orientation){case 0:l=[15],c=[17];break;case 1:l=[16],c=[18],this.domNode.className+=" vertical"}this._register(Q$(this.domNode,RY.KEY_DOWN,(e=>{const t=new C$(e);let n=!0;const i="number"==typeof this.focusedItem?this.viewItems[this.focusedItem]:void 0;l&&(t.equals(l[0])||t.equals(l[1]))?n=this.focusPrevious():c&&(t.equals(c[0])||t.equals(c[1]))?n=this.focusNext():t.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():t.equals(14)?n=this.focusFirst():t.equals(13)?n=this.focusLast():t.equals(2)&&i instanceof ble&&i.trapsArrowNavigation?n=this.focusNext():this.isTriggerKeyEvent(t)?this._triggerKeys.keyDown?this.doTrigger(t):this.triggerKeyDown=!0:n=!1,n&&(t.preventDefault(),t.stopPropagation())}))),this._register(Q$(this.domNode,RY.KEY_UP,(e=>{const t=new C$(e);this.isTriggerKeyEvent(t)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(t)),t.preventDefault(),t.stopPropagation()):(t.equals(2)||t.equals(1026))&&this.updateFocusedItem()}))),this.focusTracker=this._register(BY(this.domNode)),this._register(this.focusTracker.onDidBlur((()=>{DY()!==this.domNode&&CY(DY(),this.domNode)||(this._onDidBlur.fire(),this.focusedItem=void 0,this.triggerKeyDown=!1)}))),this._register(this.focusTracker.onDidFocus((()=>this.updateFocusedItem()))),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.actionsList.setAttribute("role","toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach((n=>{t=t||e.equals(n)})),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){const t=this.actionsList.children[e];if(CY(DY(),t)){this.focusedItem=e;break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach((t=>t.setActionContext(e)))}get actionRunner(){return this._actionRunner}set actionRunner(e){e&&(this._actionRunner=e,this.viewItems.forEach((t=>t.actionRunner=e)))}getContainer(){return this.domNode}push(e,t={}){const n=Array.isArray(e)?e:[e];let i=RZ(t.index)?t.index:null;n.forEach((e=>{const n=document.createElement("li");let r;n.className="action-item",n.setAttribute("role","presentation"),this.options.allowContextMenu||this._register(Q$(n,RY.CONTEXT_MENU,(e=>{PY(e,!0)}))),this.options.actionViewItemProvider&&(r=this.options.actionViewItemProvider(e)),r||(r=new wle(this.context,e,t)),r.actionRunner=this._actionRunner,r.setActionContext(this.context),r.render(n),this.focusable&&r instanceof ble&&0===this.viewItems.length&&r.setFocusable(!0),null===i||i<0||i>=this.actionsList.children.length?(this.actionsList.appendChild(n),this.viewItems.push(r),this._actionIds.push(e.id)):(this.actionsList.insertBefore(n,this.actionsList.children[i]),this.viewItems.splice(i,0,r),this._actionIds.splice(i,0,e.id),i++)})),"number"==typeof this.focusedItem&&this.focus(this.focusedItem)}clear(){dG(this.viewItems),this.viewItems=[],this._actionIds=[],Y$(this.actionsList)}length(){return this.viewItems.length}focus(e){let t,n=!1;if(void 0===e?n=!0:"number"==typeof e?t=e:"boolean"==typeof e&&(n=e),n&&void 0===this.focusedItem){const e=this.viewItems.findIndex((e=>e.isEnabled()));this.focusedItem=-1===e?void 0:e,this.updateFocus()}else void 0!==t&&(this.focusedItem=t),this.updateFocus()}focusFirst(){return this.focusedItem=this.length()>1?1:0,this.focusPrevious()}focusLast(){return this.focusedItem=this.length()<2?0:this.length()-2,this.focusNext()}focusNext(){if(void 0===this.focusedItem)this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const e=this.focusedItem;let t;do{if(this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=e,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,t=this.viewItems[this.focusedItem]}while(this.focusedItem!==e&&this.options.focusOnlyEnabledItems&&!t.isEnabled());return this.updateFocus(),!0}focusPrevious(){if(void 0===this.focusedItem)this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const e=this.focusedItem;let t;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(this.options.preventLoopNavigation)return this.focusedItem=e,!1;this.focusedItem=this.viewItems.length-1}t=this.viewItems[this.focusedItem]}while(this.focusedItem!==e&&this.options.focusOnlyEnabledItems&&!t.isEnabled());return this.updateFocus(!0),!0}updateFocus(e,t){void 0===this.focusedItem&&this.actionsList.focus({preventScroll:t});for(let n=0;n<this.viewItems.length;n++){const i=this.viewItems[n],r=i;if(n===this.focusedItem){let n=!0;VZ(r.focus)||(n=!1),this.options.focusOnlyEnabledItems&&VZ(i.isEnabled)&&!i.isEnabled()&&(n=!1),n?r.focus(e):this.actionsList.focus({preventScroll:t})}else VZ(r.blur)&&r.blur()}}doTrigger(e){if(void 0===this.focusedItem)return;const t=this.viewItems[this.focusedItem];if(t instanceof ble){const n=null===t._context||void 0===t._context?e:t._context;this.run(t._action,n)}}run(e,t){return Cle(this,void 0,void 0,(function*(){yield this._actionRunner.run(e,t)}))}dispose(){dG(this.viewItems),this.viewItems=[],this._actionIds=[],this.getContainer().remove(),super.dispose()}}const xle=new class{constructor(){this._onDidChange=new EG,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:GH(0,"The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:GH(0,"The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${dJ.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,i){const r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;const t=this.iconReferenceSchema.enum.indexOf(e);-1!==t&&(this.iconReferenceSchema.enumDescriptions[t]=n),this._onDidChange.fire()}return r}let o={id:e,description:n,defaults:t,deprecationMessage:i};this.iconsById[e]=o;let s={$ref:"#/definitions/icons"};return i&&(s.deprecationMessage=i),n&&(s.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=s,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map((e=>this.iconsById[e]))}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(e,t)=>e.id.localeCompare(t.id),t=e=>{for(;z5.isThemeIcon(e.defaults);)e=this.iconsById[e.defaults.id];return`codicon codicon-${e?e.id:""}`};let n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const i=Object.keys(this.iconsById).map((e=>this.iconsById[e]));for(const r of i.filter((e=>!!e.description)).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|${z5.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(const r of i.filter((e=>!z5.isThemeIcon(e.defaults))).sort(e))n.push(`|<i class="${t(r)}"></i>|${r.id}|`);return n.join("\n")}};function Ele(e,t,n,i){return xle.registerIcon(e,t,n,i)}d3.add("base.contributions.icons",xle),function(){for(const e of cJ.all)xle.registerIcon(e.id,e.definition,e.description);cJ.onDidRegister((e=>xle.registerIcon(e.id,e.definition,e.description)))}();let kle=d3.as(f3);kle.registerSchema("vscode://schemas/icons",xle.getIconSchema());const Lle=new z$((()=>kle.notifySchemaChanged("vscode://schemas/icons")),200);xle.onDidChange((()=>{Lle.isScheduled()||Lle.schedule()}));const Dle=Ele("widget-close",hJ.close,GH(0,"Icon for the close action in widgets."));var Nle,Ile=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Tle{constructor(e,t,n,i){this.originalLineStart=e,this.originalLineEnd=t,this.modifiedLineStart=n,this.modifiedLineEnd=i}getType(){return 0===this.originalLineStart?1:0===this.modifiedLineStart?2:0}}class Mle{constructor(e){this.entries=e}}const Ale=Ele("diff-review-insert",hJ.add,GH(0,"Icon for 'Insert' in diff review.")),Ole=Ele("diff-review-remove",hJ.remove,GH(0,"Icon for 'Remove' in diff review.")),Rle=Ele("diff-review-close",hJ.close,GH(0,"Icon for 'Close' in diff review."));class Ple extends mG{constructor(e){super(),this._width=0,this._diffEditor=e,this._isVisible=!1,this.shadow=I6(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=I6(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new Sle(this.actionBarContainer.domNode)),this._actionBar.push(new s5("diffreview.close",GH(0,"Close"),"close-diff-review "+z5.asClassName(Rle),!0,(()=>Ile(this,void 0,void 0,(function*(){return this.hide()})))),{label:!1,icon:!0}),this.domNode=I6(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=I6(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new moe(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(e.onDidUpdateDiff((()=>{this._isVisible&&(this._diffs=this._compute(),this._render())}))),this._register(e.getModifiedEditor().onDidChangeCursorPosition((()=>{this._isVisible&&this._render()}))),this._register(eY(this.domNode.domNode,"click",(e=>{e.preventDefault();let t=SY(e.target,"diff-review-row");t&&this._goToRow(t)}))),this._register(eY(this.domNode.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._goToRow(this._getNextRow())),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._goToRow(this._getPrevRow())),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033))&&(e.preventDefault(),this.hide()),(e.equals(10)||e.equals(3))&&(e.preventDefault(),this.accept())}))),this._diffs=[],this._currentDiff=null}prev(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let t=-1;for(let e=0,n=this._diffs.length;e<n;e++)if(this._diffs[e]===this._currentDiff){t=e;break}e=this._diffs.length+t-1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const t=this._diffs[e].entries;this._diffEditor.setPosition(new IK(t[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:t[0].modifiedLineStart,endColumn:1073741824,endLineNumber:t[t.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow())}next(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let t=-1;for(let e=0,n=this._diffs.length;e<n;e++)if(this._diffs[e]===this._currentDiff){t=e;break}e=t+1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const t=this._diffs[e].entries;this._diffEditor.setPosition(new IK(t[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:t[0].modifiedLineStart,endColumn:1073741824,endLineNumber:t[t.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow())}accept(){let e=-1,t=this._getCurrentFocusedRow();if(t){let n=parseInt(t.getAttribute("data-line"),10);isNaN(n)||(e=n)}this.hide(),-1!==e&&(this._diffEditor.setPosition(new IK(e,1)),this._diffEditor.revealPosition(new IK(e,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){let e=this._getCurrentFocusedRow();return e?e.previousElementSibling?e.previousElementSibling:e:this._getFirstRow()}_getNextRow(){let e=this._getCurrentFocusedRow();return e?e.nextElementSibling?e.nextElementSibling:e:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){let e=document.activeElement;return e&&/diff-review-row/.test(e.className)?e:null}_goToRow(e){let t=this._getCurrentFocusedRow();e.tabIndex=0,e.focus(),t&&t!==e&&(t.tabIndex=-1),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(e,t,n){this._width=t,this.shadow.setTop(e-6),this.shadow.setWidth(t),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(e),this.domNode.setWidth(t),this.domNode.setHeight(n),this._content.setHeight(n),this._content.setWidth(t),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const e=this._diffEditor.getLineChanges();if(!e||0===e.length)return[];const t=this._diffEditor.getOriginalEditor().getModel(),n=this._diffEditor.getModifiedEditor().getModel();return t&&n?Ple._mergeAdjacent(e,t.getLineCount(),n.getLineCount()):[]}static _mergeAdjacent(e,t,n){if(!e||0===e.length)return[];let i=[],r=0;for(let l=0,c=e.length;l<c;l++){const o=e[l],s=o.originalStartLineNumber,a=o.originalEndLineNumber,u=o.modifiedStartLineNumber,h=o.modifiedEndLineNumber;let d=[],f=0;{const t=0===a?s:s-1,n=0===h?u:u-1;let i=1,r=1;if(l>0){const t=e[l-1];i=0===t.originalEndLineNumber?t.originalStartLineNumber+1:t.originalEndLineNumber+1,r=0===t.modifiedEndLineNumber?t.modifiedStartLineNumber+1:t.modifiedEndLineNumber+1}let o=t-3+1,c=n-3+1;if(o<i){const e=i-o;o+=e,c+=e}if(c<r){const e=r-c;o+=e,c+=e}d[f++]=new Tle(o,t,c,n)}0!==a&&(d[f++]=new Tle(s,a,0,0)),0!==h&&(d[f++]=new Tle(0,0,u,h));{const i=0===a?s+1:a+1,r=0===h?u+1:h+1;let o=t,g=n;if(l+1<c){const t=e[l+1];o=0===t.originalEndLineNumber?t.originalStartLineNumber:t.originalStartLineNumber-1,g=0===t.modifiedEndLineNumber?t.modifiedStartLineNumber:t.modifiedStartLineNumber-1}let p=i+3-1,m=r+3-1;if(p>o){const e=o-p;p+=e,m+=e}if(m>g){const e=g-m;p+=e,m+=e}d[f++]=new Tle(i,p,r,m)}i[r++]=new Mle(d)}let o=i[0].entries,s=[],a=0;for(let l=1,c=i.length;l<c;l++){const e=i[l].entries,t=o[o.length-1],n=e[0];0===t.getType()&&0===n.getType()&&n.originalLineStart<=t.originalLineEnd?(o[o.length-1]=new Tle(t.originalLineStart,n.originalLineEnd,t.modifiedLineStart,n.modifiedLineEnd),o=o.concat(e.slice(1))):(s[a++]=new Mle(o),o=e)}return s[a++]=new Mle(o),s}_findDiffIndex(e){const t=e.lineNumber;for(let n=0,i=this._diffs.length;n<i;n++){const e=this._diffs[n].entries;if(t<=e[e.length-1].modifiedLineEnd)return n}return 0}_render(){const e=this._diffEditor.getOriginalEditor().getOptions(),t=this._diffEditor.getModifiedEditor().getOptions(),n=this._diffEditor.getOriginalEditor().getModel(),i=this._diffEditor.getModifiedEditor().getModel(),r=n.getOptions(),o=i.getOptions();if(!this._isVisible||!n||!i)return Y$(this._content.domNode),this._currentDiff=null,void this.scrollbar.scanDomNode();this._diffEditor.updateOptions({readOnly:!0});const s=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[s]===this._currentDiff)return;this._currentDiff=this._diffs[s];const a=this._diffs[s].entries;let l=document.createElement("div");l.className="diff-review-table",l.setAttribute("role","list"),l.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),D6.applyFontInfoSlow(l,t.get(40));let c=0,u=0,h=0,d=0;for(let C=0,S=a.length;C<S;C++){const e=a[C],t=e.originalLineStart,n=e.originalLineEnd,i=e.modifiedLineStart,r=e.modifiedLineEnd;0!==t&&(0===c||t<c)&&(c=t),0!==n&&(0===u||n>u)&&(u=n),0!==i&&(0===h||i<h)&&(h=i),0!==r&&(0===d||r>d)&&(d=r)}let f=document.createElement("div");f.className="diff-review-row";let g=document.createElement("div");g.className="diff-review-cell diff-review-summary";const p=u-c+1,m=d-h+1;g.appendChild(document.createTextNode(`${s+1}/${this._diffs.length}: @@ -${c},${p} +${h},${m} @@`)),f.setAttribute("data-line",String(h));const v=e=>0===e?GH(0,"no lines changed"):1===e?GH(0,"1 line changed"):GH(0,"{0} lines changed",e),y=v(p),_=v(m);f.setAttribute("aria-label",GH(0,"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",s+1,this._diffs.length,c,y,h,_)),f.appendChild(g),f.setAttribute("role","listitem"),l.appendChild(f);const b=t.get(56);let w=h;for(let C=0,S=a.length;C<S;C++){const s=a[C];Ple._renderSection(l,s,w,b,this._width,e,n,r,t,i,o),0!==s.modifiedLineStart&&(w=s.modifiedLineEnd)}Y$(this._content.domNode),this._content.domNode.appendChild(l),this.scrollbar.scanDomNode()}static _renderSection(e,t,n,i,r,o,s,a,l,c,u){const h=t.getType();let d="diff-review-row",f="";let g=null;switch(h){case 1:d="diff-review-row line-insert",f=" char-insert",g=Ale;break;case 2:d="diff-review-row line-delete",f=" char-delete",g=Ole}const p=t.originalLineStart,m=t.originalLineEnd,v=t.modifiedLineStart,y=t.modifiedLineEnd,_=Math.max(y-v,m-p),b=o.get(128),w=b.glyphMarginWidth+b.lineNumbersWidth,C=l.get(128),S=10+C.glyphMarginWidth+C.lineNumbersWidth;for(let x=0;x<=_;x++){const t=0===p?0:p+x,m=0===v?0:v+x,y=document.createElement("div");y.style.minWidth=r+"px",y.className=d,y.setAttribute("role","listitem"),0!==m&&(n=m),y.setAttribute("data-line",String(n));let _=document.createElement("div");_.className="diff-review-cell",_.style.height=`${i}px`,y.appendChild(_);const b=document.createElement("span");b.style.width=w+"px",b.style.minWidth=w+"px",b.className="diff-review-line-number"+f,0!==t?b.appendChild(document.createTextNode(String(t))):b.innerText=" ",_.appendChild(b);const C=document.createElement("span");C.style.width=S+"px",C.style.minWidth=S+"px",C.style.paddingRight="10px",C.className="diff-review-line-number"+f,0!==m?C.appendChild(document.createTextNode(String(m))):C.innerText=" ",_.appendChild(C);const E=document.createElement("span");if(E.className="diff-review-spacer",g){const e=document.createElement("span");e.className=z5.asClassName(g),e.innerText="  ",E.appendChild(e)}else E.innerText="  ";let k;if(_.appendChild(E),0!==m){let e=this._renderLine(c,l,u.tabSize,m);Ple._ttPolicy&&(e=Ple._ttPolicy.createHTML(e)),_.insertAdjacentHTML("beforeend",e),k=c.getLineContent(m)}else{let e=this._renderLine(s,o,a.tabSize,t);Ple._ttPolicy&&(e=Ple._ttPolicy.createHTML(e)),_.insertAdjacentHTML("beforeend",e),k=s.getLineContent(t)}0===k.length&&(k=GH(0,"blank"));let L="";switch(h){case 0:L=t===m?GH(0,"{0} unchanged line {1}",k,t):GH(0,"{0} original line {1} modified line {2}",k,t,m);break;case 1:L=GH(0,"+ {0} modified line {1}",k,m);break;case 2:L=GH(0,"- {0} original line {1}",k,t)}y.setAttribute("aria-label",L),e.appendChild(y)}}static _renderLine(e,t,n,i){const r=e.getLineContent(i),o=t.get(40),s=u2.createEmpty(r),a=I2.isBasicASCII(r,e.mightContainNonBasicASCII()),l=I2.containsRTL(r,a,e.mightContainRTL());return S2(new v2(o.isMonospace&&!t.get(27),o.canUseHalfwidthRightwardsArrow,r,!1,a,l,0,s,[],n,0,o.spaceWidth,o.middotWidth,o.wsmiddotWidth,t.get(103),t.get(86),t.get(80),t.get(41)!==zj.OFF,null)).html}}Ple._ttPolicy=null===(Nle=window.trustedTypes)||void 0===Nle?void 0:Nle.createPolicy("diffReview",{createHTML:e=>e}),G5(((e,t)=>{const n=e.getColor(_ie);n&&t.addRule(`.monaco-diff-editor .diff-review-line-number { color: ${n}; }`);const i=e.getColor(Qee);i&&t.addRule(`.monaco-diff-editor .diff-review-shadow { box-shadow: ${i} 0 -6px 6px -6px inset; }`)}));function Fle(e){const t=e.get(o$),n=t.listDiffEditors(),i=t.getActiveCodeEditor();if(!i)return null;for(let r=0,o=n.length;r<o;r++){const e=n[r];if(e.getModifiedEditor().getId()===i.getId()||e.getOriginalEditor().getId()===i.getId())return e}return null}c6(class extends o6{constructor(){super({id:"editor.action.diffReview.next",label:GH(0,"Go to Next Difference"),alias:"Go to Next Difference",precondition:g5.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:65,weight:100}})}run(e,t){const n=Fle(e);n&&n.diffReviewNext()}}),c6(class extends o6{constructor(){super({id:"editor.action.diffReview.prev",label:GH(0,"Go to Previous Difference"),alias:"Go to Previous Difference",precondition:g5.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:1089,weight:100}})}run(e,t){const n=Fle(e);n&&n.diffReviewPrev()}});const Ble=i$("contextViewService"),Wle=i$("contextMenuService");var zle=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Vle extends mG{constructor(e,t,n,i,r,o){super(),this._viewZoneId=e,this._marginDomNode=t,this.editor=n,this.diff=i,this._contextMenuService=r,this._clipboardService=o,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=hJ.lightBulb.classNames+" lightbulb-glyph",this._diffActions.style.position="absolute";const s=n.getOption(56),a=n.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${s}px`,this._diffActions.style.lineHeight=`${s}px`,this._marginDomNode.appendChild(this._diffActions);const l=[];l.push(new s5("diff.clipboard.copyDeletedContent",i.originalEndLineNumber>i.modifiedStartLineNumber?GH(0,"Copy deleted lines"):GH(0,"Copy deleted line"),void 0,!0,(()=>zle(this,void 0,void 0,(function*(){const e=new TK(i.originalStartLineNumber,1,i.originalEndLineNumber+1,1),t=i.originalModel.getValueInRange(e);yield this._clipboardService.writeText(t)})))));let c,u=0;i.originalEndLineNumber>i.modifiedStartLineNumber&&(c=new s5("diff.clipboard.copyDeletedLineContent",GH(0,"Copy deleted line ({0})",i.originalStartLineNumber),void 0,!0,(()=>zle(this,void 0,void 0,(function*(){const e=i.originalModel.getLineContent(i.originalStartLineNumber+u);yield this._clipboardService.writeText(e)})))),l.push(c));n.getOption(78)||l.push(new s5("diff.inline.revertChange",GH(0,"Revert this change"),void 0,!0,(()=>zle(this,void 0,void 0,(function*(){const e=new TK(i.originalStartLineNumber,1,i.originalEndLineNumber,i.originalModel.getLineMaxColumn(i.originalEndLineNumber)),t=i.originalModel.getValueInRange(e);if(0===i.modifiedEndLineNumber){const e=n.getModel().getLineMaxColumn(i.modifiedStartLineNumber);n.executeEdits("diffEditor",[{range:new TK(i.modifiedStartLineNumber,e,i.modifiedStartLineNumber,e),text:a+t}])}else{const e=n.getModel().getLineMaxColumn(i.modifiedEndLineNumber);n.executeEdits("diffEditor",[{range:new TK(i.modifiedStartLineNumber,1,i.modifiedEndLineNumber,e),text:t}])}})))));const h=(e,t)=>{this._contextMenuService.showContextMenu({getAnchor:()=>({x:e,y:t}),getActions:()=>(c&&(c.label=GH(0,"Copy deleted line ({0})",i.originalStartLineNumber+u)),l),autoSelectFirstItem:!0})};this._register(eY(this._diffActions,"mousedown",(e=>{const{top:t,height:n}=mY(this._diffActions);let i=Math.floor(s/3);e.preventDefault(),h(e.posx,t+n+i)}))),this._register(n.onMouseMove((e=>{if(8===e.target.type||5===e.target.type){e.target.detail.viewZoneId===this._viewZoneId?(this.visibility=!0,u=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,s)):this.visibility=!1}else this.visibility=!1}))),this._register(n.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){e.target.detail.viewZoneId===this._viewZoneId&&(e.event.preventDefault(),u=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,s),h(e.event.posx,e.event.posy+s))}})))}get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}_updateLightBulbPosition(e,t,n){const{top:i}=mY(e),r=t-i,o=Math.floor(r/n),s=o*n;if(this._diffActions.style.top=`${s}px`,this.diff.viewLineCounts){let e=0;for(let t=0;t<this.diff.viewLineCounts.length;t++)if(e+=this.diff.viewLineCounts[t],o<e)return t}return o}}const Ule=i$("clipboardService");class Hle{constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}}Hle.None=Object.freeze({report(){}});const jle=i$("editorProgressService");var Gle,Kle=function(e,t){return function(n,i){t(n,i,e)}};class qle{constructor(e,t){this._contextMenuService=e,this._clipboardService=t,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(e){return e.filter((e=>!this._zonesMap[String(e.id)]))}clean(e){this._zones.length>0&&e.changeViewZones((e=>{for(const t of this._zones)e.removeZone(t)})),this._zones=[],this._zonesMap={},this._decorations=e.deltaDecorations(this._decorations,[])}apply(e,t,n,i){const r=i?mle.capture(e):null;e.changeViewZones((t=>{for(const e of this._zones)t.removeZone(e);for(const e of this._inlineDiffMargins)e.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let i=0,r=n.zones.length;i<r;i++){const r=n.zones[i];r.suppressMouseDown=!0;const o=t.addZone(r);this._zones.push(o),this._zonesMap[String(o)]=!0,n.zones[i].diff&&r.marginDomNode&&(r.suppressMouseDown=!1,this._inlineDiffMargins.push(new Vle(o,r.marginDomNode,e,n.zones[i].diff,this._contextMenuService,this._clipboardService)))}})),r&&r.restore(e),this._decorations=e.deltaDecorations(this._decorations,n.decorations),t&&t.setZones(n.overviewZones)}}let $le=0;const Yle=Ele("diff-insert",hJ.add,GH(0,"Line decoration for inserts in the diff editor.")),Xle=Ele("diff-remove",hJ.remove,GH(0,"Line decoration for removals in the diff editor.")),Zle=null===(Gle=window.trustedTypes)||void 0===Gle?void 0:Gle.createPolicy("diffEditorWidget",{createHTML:e=>e});let Qle=class e extends mG{constructor(t,n,i,r,o,s,a,l,c,u,h,d){super(),this._editorProgressService=d,this._onDidDispose=this._register(new EG),this.onDidDispose=this._onDidDispose.event,this._onDidUpdateDiff=this._register(new EG),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new EG),this._lastOriginalWarning=null,this._lastModifiedWarning=null,this._editorWorkerService=o,this._codeEditorService=l,this._contextKeyService=this._register(s.createScoped(t)),this._instantiationService=a.createChild(new vae([A5,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=c,this._notificationService=u,this._id=++$le,this._state=0,this._updatingDiffProgress=null,this._domElement=t,n=n||{},this._renderSideBySide=!0,void 0!==n.renderSideBySide&&(this._renderSideBySide=n.renderSideBySide),this._maxComputationTime=5e3,void 0!==n.maxComputationTime&&(this._maxComputationTime=n.maxComputationTime),this._ignoreTrimWhitespace=!0,void 0!==n.ignoreTrimWhitespace&&(this._ignoreTrimWhitespace=n.ignoreTrimWhitespace),this._renderIndicators=!0,void 0!==n.renderIndicators&&(this._renderIndicators=n.renderIndicators),this._originalIsEditable=Ij(n.originalEditable,!1),this._diffCodeLens=Ij(n.diffCodeLens,!1),this._diffWordWrap=lce(n.diffWordWrap,"inherit"),void 0!==n.isInEmbeddedEditor?this._contextKeyService.createKey("isInEmbeddedDiffEditor",n.isInEmbeddedEditor):this._contextKeyService.createKey("isInEmbeddedDiffEditor",!1),this._renderOverviewRuler=!0,void 0!==n.renderOverviewRuler&&(this._renderOverviewRuler=Boolean(n.renderOverviewRuler)),this._updateDecorationsRunner=this._register(new z$((()=>this._updateDecorations()),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=I6(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(eY(this._overviewDomElement,"mousedown",(e=>{this._modifiedEditor.delegateVerticalScrollbarMouseDown(e)}))),this._renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new qle(h,r),this._modifiedEditorState=new qle(h,r),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new E6(this._containerDomElement,n.dimension,(()=>this._onDidContainerSizeChanged()))),n.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(n,i.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(n,i.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=new Ple(this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._enableSplitViewResizing=!0,void 0!==n.enableSplitViewResizing&&(this._enableSplitViewResizing=n.enableSplitViewResizing),this._renderSideBySide?this._setStrategy(new rce(this._createDataSource(),this._enableSplitViewResizing)):this._setStrategy(new sce(this._createDataSource(),this._enableSplitViewResizing)),this._register(c.onDidColorThemeChange((t=>{this._strategy&&this._strategy.applyColors(t)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._renderSideBySide)})));const f=f6.getDiffEditorContributions();for(const e of f)try{this._register(a.createInstance(e.ctor,this))}catch(g){nG(g)}this._codeEditorService.addDiffEditor(this)}_setState(e){this._state!==e&&(this._state=e,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),1===this._state&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}diffReviewNext(){this._reviewPane.next()}diffReviewPrev(){this._reviewPane.prev()}static _getClassName(e,t){let n="monaco-diff-editor monaco-editor-background ";return t&&(n+="side-by-side "),n+=U5(e.type),n}_recreateOverviewRulers(){this._renderOverviewRuler&&(this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(t,n){const i=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(t),n);this._register(i.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(i.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(i.onDidChangeConfiguration((e=>{i.getModel()&&(e.hasChanged(40)&&this._updateDecorationsRunner.schedule(),e.hasChanged(129)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(i.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})));const r=this._contextKeyService.createKey("isInDiffLeftEditor",i.hasWidgetFocus());return this._register(i.onDidFocusEditorWidget((()=>r.set(!0)))),this._register(i.onDidBlurEditorWidget((()=>r.set(!1)))),this._register(i.onDidContentSizeChange((t=>{const n=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,i=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:i,contentWidth:n,contentHeightChanged:t.contentHeightChanged,contentWidthChanged:t.contentWidthChanged})}))),i}_createRightHandSideEditor(t,n){const i=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(t),n);this._register(i.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(i.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(i.onDidChangeConfiguration((e=>{i.getModel()&&(e.hasChanged(40)&&this._updateDecorationsRunner.schedule(),e.hasChanged(129)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(i.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}))),this._register(i.onDidChangeModelOptions((e=>{e.tabSize&&this._updateDecorationsRunner.schedule()})));const r=this._contextKeyService.createKey("isInDiffRightEditor",i.hasWidgetFocus());return this._register(i.onDidFocusEditorWidget((()=>r.set(!0)))),this._register(i.onDidBlurEditorWidget((()=>r.set(!1)))),this._register(i.onDidContentSizeChange((t=>{const n=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,i=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:i,contentWidth:n,contentHeightChanged:t.contentHeightChanged,contentWidthChanged:t.contentWidthChanged})}))),i}_createInnerEditor(e,t,n,i){return e.createInstance(zae,t,n,i)}dispose(){this._codeEditorService.removeDiffEditor(this),-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return bQ.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(t){let n=!1;void 0!==t.renderSideBySide&&this._renderSideBySide!==t.renderSideBySide&&(this._renderSideBySide=t.renderSideBySide,n=!0),void 0!==t.maxComputationTime&&(this._maxComputationTime=t.maxComputationTime,this._isVisible&&this._beginUpdateDecorationsSoon());let i=!1;void 0!==t.ignoreTrimWhitespace&&this._ignoreTrimWhitespace!==t.ignoreTrimWhitespace&&(this._ignoreTrimWhitespace=t.ignoreTrimWhitespace,i=!0),void 0!==t.renderIndicators&&this._renderIndicators!==t.renderIndicators&&(this._renderIndicators=t.renderIndicators,i=!0),i&&this._beginUpdateDecorations(),this._originalIsEditable=Ij(t.originalEditable,this._originalIsEditable),this._diffCodeLens=Ij(t.diffCodeLens,this._diffCodeLens),this._diffWordWrap=lce(t.diffWordWrap,this._diffWordWrap),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(t)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(t)),void 0!==t.enableSplitViewResizing&&(this._enableSplitViewResizing=t.enableSplitViewResizing),this._strategy.setEnableSplitViewResizing(this._enableSplitViewResizing),n&&(this._renderSideBySide?this._setStrategy(new rce(this._createDataSource(),this._enableSplitViewResizing)):this._setStrategy(new sce(this._createDataSource(),this._enableSplitViewResizing)),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._renderSideBySide)),void 0!==t.renderOverviewRuler&&this._renderOverviewRuler!==t.renderOverviewRuler&&(this._renderOverviewRuler=t.renderOverviewRuler,this._renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}setModel(e){if(e&&(!e.original||!e.modified))throw new Error(e.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._originalEditor.setModel(e?e.original:null),this._modifiedEditor.setModel(e?e.modified:null),this._updateDecorationsRunner.cancel(),e&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),e&&(this._recreateOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport()}getDomNode(){return this._domElement}getVisibleColumnFromPosition(e){return this._modifiedEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(e){this._modifiedEditor.setPosition(e)}revealLine(e,t=0){this._modifiedEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._modifiedEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._modifiedEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._modifiedEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._modifiedEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._modifiedEditor.revealPositionNearTop(e,t)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(e){this._modifiedEditor.setSelection(e)}setSelections(e){this._modifiedEditor.setSelections(e)}revealLines(e,t,n=0){this._modifiedEditor.revealLines(e,t,n)}revealLinesInCenter(e,t,n=0){this._modifiedEditor.revealLinesInCenter(e,t,n)}revealLinesInCenterIfOutsideViewport(e,t,n=0){this._modifiedEditor.revealLinesInCenterIfOutsideViewport(e,t,n)}revealLinesNearTop(e,t,n=0){this._modifiedEditor.revealLinesNearTop(e,t,n)}revealRange(e,t=0,n=!1,i=!0){this._modifiedEditor.revealRange(e,t,n,i)}revealRangeInCenter(e,t=0){this._modifiedEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._modifiedEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._modifiedEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._modifiedEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}saveViewState(){return{original:this._originalEditor.saveViewState(),modified:this._modifiedEditor.saveViewState()}}restoreViewState(e){if(e&&e.original&&e.modified){const t=e;this._originalEditor.restoreViewState(t.original),this._modifiedEditor.restoreViewState(t.modified)}}layout(e){this._elementSizeObserver.observe(e)}focus(){this._modifiedEditor.focus()}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}trigger(e,t,n){this._modifiedEditor.trigger(e,t,n)}changeDecorations(e){return this._modifiedEditor.changeDecorations(e)}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._renderOverviewRuler)return;if(!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const t=this._elementSizeObserver.getHeight(),n=this._getReviewHeight(),i=e.ENTIRE_DIFF_OVERVIEW_WIDTH-2*e.ONE_OVERVIEW_WIDTH;this._modifiedEditor.getLayoutInfo()&&(this._originalOverviewRuler.setLayout({top:0,width:e.ONE_OVERVIEW_WIDTH,right:i+e.ONE_OVERVIEW_WIDTH,height:t-n}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:e.ONE_OVERVIEW_WIDTH,height:t-n}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout((()=>this._beginUpdateDecorations()),e.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(e,t){return!e&&!t||!(!e||!t)&&e.toString()===t.toString()}_beginUpdateDecorations(){this._beginUpdateDecorationsTimeout=-1;const t=this._originalEditor.getModel(),n=this._modifiedEditor.getModel();if(!t||!n)return;this._diffComputationToken++;const i=this._diffComputationToken;this._setState(1),this._editorWorkerService.canComputeDiff(t.uri,n.uri)?this._editorWorkerService.computeDiff(t.uri,n.uri,this._ignoreTrimWhitespace,this._maxComputationTime).then((e=>{i===this._diffComputationToken&&t===this._originalEditor.getModel()&&n===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=e,this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())}),(e=>{i===this._diffComputationToken&&t===this._originalEditor.getModel()&&n===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())})):e._equals(t.uri,this._lastOriginalWarning)&&e._equals(n.uri,this._lastModifiedWarning)||(this._lastOriginalWarning=t.uri,this._lastModifiedWarning=n.uri,this._notificationService.warn(GH(0,"Cannot compare files because one file is too large.")))}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const e=this._diffComputationResult?this._diffComputationResult.changes:[],t=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),n=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),i=this._strategy.getEditorsDiffDecorations(e,this._ignoreTrimWhitespace,this._renderIndicators,t,n);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,i.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,i.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(e){const t=Object.assign({},e);return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar=Object.assign({},t.scrollbar||{}),t.scrollbar.vertical="visible",t.folding=!1,t.codeLens=this._diffCodeLens,t.fixedOverflowWidgets=!0,t.minimap=Object.assign({},t.minimap||{}),t.minimap.enabled=!1,t}_adjustOptionsForLeftHandSide(e){const t=this._adjustOptionsForSubEditor(e);return this._renderSideBySide?t.wordWrapOverride1=this._diffWordWrap:t.wordWrapOverride1="off",e.originalAriaLabel&&(t.ariaLabel=e.originalAriaLabel),t.readOnly=!this._originalIsEditable,t.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},t),{dimension:{height:0,width:0}})}_adjustOptionsForRightHandSide(t){const n=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(n.ariaLabel=t.modifiedAriaLabel),n.wordWrapOverride1=this._diffWordWrap,n.revealHorizontalRightPadding=eG.revealHorizontalRightPadding.defaultValue+e.ENTIRE_DIFF_OVERVIEW_WIDTH,n.scrollbar.verticalHasArrows=!1,n.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},n),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const t=this._elementSizeObserver.getWidth(),n=this._elementSizeObserver.getHeight(),i=this._getReviewHeight(),r=this._strategy.layout();this._originalDomNode.style.width=r+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=t-r+"px",this._modifiedDomNode.style.left=r+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=n-i+"px",this._overviewDomElement.style.width=e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=t-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(e.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:r,height:n-i}),this._modifiedEditor.layout({width:t-r-(this._renderOverviewRuler?e.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:n-i}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(n-i,t,i),this._layoutOverviewViewport()}_layoutOverviewViewport(){const e=this._computeOverviewViewport();e?(this._overviewViewportDomElement.setTop(e.top),this._overviewViewportDomElement.setHeight(e.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const e=this._modifiedEditor.getLayoutInfo();if(!e)return null;const t=this._modifiedEditor.getScrollTop(),n=this._modifiedEditor.getScrollHeight(),i=Math.max(0,e.height),r=Math.max(0,i-0),o=n>0?r/n:0;return{height:Math.max(0,Math.floor(e.height*o)),top:Math.floor(t*o)}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(e){this._strategy&&this._strategy.dispose(),this._strategy=e,e.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}_getLineChangeAtOrBeforeLineNumber(e,t){const n=this._diffComputationResult?this._diffComputationResult.changes:[];if(0===n.length||e<t(n[0]))return null;let i=0,r=n.length-1;for(;i<r;){const o=Math.floor((i+r)/2),s=t(n[o]),a=o+1<=r?t(n[o+1]):1073741824;e<s?r=o-1:e>=a?i=o+1:(i=o,r=o)}return n[i]}_getEquivalentLineForOriginalLineNumber(e){const t=this._getLineChangeAtOrBeforeLineNumber(e,(e=>e.originalStartLineNumber));if(!t)return e;const n=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),i=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),r=t.originalEndLineNumber>0?t.originalEndLineNumber-t.originalStartLineNumber+1:0,o=t.modifiedEndLineNumber>0?t.modifiedEndLineNumber-t.modifiedStartLineNumber+1:0,s=e-n;return s<=r?i+Math.min(s,o):i+o-r+s}_getEquivalentLineForModifiedLineNumber(e){const t=this._getLineChangeAtOrBeforeLineNumber(e,(e=>e.modifiedStartLineNumber));if(!t)return e;const n=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),i=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),r=t.originalEndLineNumber>0?t.originalEndLineNumber-t.originalStartLineNumber+1:0,o=t.modifiedEndLineNumber>0?t.modifiedEndLineNumber-t.modifiedStartLineNumber+1:0,s=e-i;return s<=o?n+Math.min(s,r):n+r-o+s}getDiffLineInformationForOriginal(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForOriginalLineNumber(e)}:null}getDiffLineInformationForModified(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForModifiedLineNumber(e)}:null}};Qle.ONE_OVERVIEW_WIDTH=15,Qle.ENTIRE_DIFF_OVERVIEW_WIDTH=30,Qle.UPDATE_DIFF_DECORATIONS_DELAY=200,Qle=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Kle(3,Ule),Kle(4,e0),Kle(5,A5),Kle(6,t$),Kle(7,o$),Kle(8,B5),Kle(9,g4),Kle(10,Wle),Kle(11,jle)],Qle);class Jle extends mG{constructor(e){super(),this._dataSource=e,this._insertColor=null,this._removeColor=null}applyColors(e){const t=(e.getColor(Qte)||Xte).transparent(2),n=(e.getColor(Jte)||Zte).transparent(2),i=!t.equals(this._insertColor)||!n.equals(this._removeColor);return this._insertColor=t,this._removeColor=n,i}getEditorsDiffDecorations(e,t,n,i,r){r=r.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber)),i=i.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber));const o=this._getViewZones(e,i,r,n),s=this._getOriginalEditorDecorations(e,t,n),a=this._getModifiedEditorDecorations(e,t,n);return{original:{decorations:s.decorations,overviewZones:s.overviewZones,zones:o.original},modified:{decorations:a.decorations,overviewZones:a.overviewZones,zones:o.modified}}}}class ece{constructor(e){this._source=e,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class tce{constructor(e,t,n,i,r){this._lineChanges=e,this._originalForeignVZ=t,this._modifiedForeignVZ=n,this._originalEditor=i,this._modifiedEditor=r}static _getViewLineCount(e,t,n){const i=e.getModel(),r=e._getViewModel();if(i&&r){const e=dce(i,r,t,n);return e.endLineNumber-e.startLineNumber+1}return n-t+1}getViewZones(){const e=this._originalEditor.getOption(56),t=this._modifiedEditor.getOption(56),n=-1!==this._originalEditor.getOption(129).wrappingColumn,i=-1!==this._modifiedEditor.getOption(129).wrappingColumn,r=n||i,o=this._originalEditor.getModel(),s=this._originalEditor._getViewModel().coordinatesConverter,a=this._modifiedEditor._getViewModel().coordinatesConverter,l=[],c=[];let u=0,h=0,d=0,f=0,g=0,p=0;const m=(e,t)=>e.afterLineNumber-t.afterLineNumber,v=(e,t)=>{if(null===t.domNode&&e.length>0){const n=e[e.length-1];if(n.afterLineNumber===t.afterLineNumber&&null===n.domNode)return void(n.heightInLines+=t.heightInLines)}e.push(t)},y=new ece(this._modifiedForeignVZ),_=new ece(this._originalForeignVZ);let b=1,w=1;for(let C=0,S=this._lineChanges.length;C<=S;C++){const n=C<S?this._lineChanges[C]:null;null!==n?(d=n.originalStartLineNumber+(n.originalEndLineNumber>0?-1:0),f=n.modifiedStartLineNumber+(n.modifiedEndLineNumber>0?-1:0),h=n.originalEndLineNumber>0?tce._getViewLineCount(this._originalEditor,n.originalStartLineNumber,n.originalEndLineNumber):0,u=n.modifiedEndLineNumber>0?tce._getViewLineCount(this._modifiedEditor,n.modifiedStartLineNumber,n.modifiedEndLineNumber):0,g=Math.max(n.originalStartLineNumber,n.originalEndLineNumber),p=Math.max(n.modifiedStartLineNumber,n.modifiedEndLineNumber)):(d+=1e7+h,f+=1e7+u,g=d,p=f);let i=[],x=[];if(r){let e;e=n?n.originalEndLineNumber>0?n.originalStartLineNumber-b:n.modifiedStartLineNumber-w:o.getLineCount()-b;for(let t=0;t<e;t++){const e=b+t,n=w+t,r=s.getModelLineViewLineCount(e),o=a.getModelLineViewLineCount(n);r<o?i.push({afterLineNumber:e,heightInLines:o-r,domNode:null,marginDomNode:null}):r>o&&x.push({afterLineNumber:n,heightInLines:r-o,domNode:null,marginDomNode:null})}n&&(b=(n.originalEndLineNumber>0?n.originalEndLineNumber:n.originalStartLineNumber)+1,w=(n.modifiedEndLineNumber>0?n.modifiedEndLineNumber:n.modifiedStartLineNumber)+1)}for(;y.current&&y.current.afterLineNumber<=p;){let e;e=y.current.afterLineNumber<=f?d-f+y.current.afterLineNumber:g;let r=null;n&&n.modifiedStartLineNumber<=y.current.afterLineNumber&&y.current.afterLineNumber<=n.modifiedEndLineNumber&&(r=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),i.push({afterLineNumber:e,heightInLines:y.current.height/t,domNode:null,marginDomNode:r}),y.advance()}for(;_.current&&_.current.afterLineNumber<=g;){let t;t=_.current.afterLineNumber<=d?f-d+_.current.afterLineNumber:p,x.push({afterLineNumber:t,heightInLines:_.current.height/e,domNode:null}),_.advance()}if(null!==n&&cce(n)){const e=this._produceOriginalFromDiff(n,h,u);e&&i.push(e)}if(null!==n&&uce(n)){const e=this._produceModifiedFromDiff(n,h,u);e&&x.push(e)}let E=0,k=0;for(i=i.sort(m),x=x.sort(m);E<i.length&&k<x.length;){const e=i[E],t=x[k],n=e.afterLineNumber-d,r=t.afterLineNumber-f;n<r?(v(l,e),E++):r<n?(v(c,t),k++):e.shouldNotShrink?(v(l,e),E++):t.shouldNotShrink?(v(c,t),k++):e.heightInLines>=t.heightInLines?(e.heightInLines-=t.heightInLines,k++):(t.heightInLines-=e.heightInLines,E++)}for(;E<i.length;)v(l,i[E]),E++;for(;k<x.length;)v(c,x[k]),k++}return{original:tce._ensureDomNodes(l),modified:tce._ensureDomNodes(c)}}static _ensureDomNodes(e){return e.map((e=>(e.domNode||(e.domNode=hce()),e)))}}function nce(e,t,n,i,r){return{range:new TK(e,t,n,i),options:r}}const ice={charDelete:v7.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:v7.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:v7.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:v7.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:v7.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"line-insert",isWholeLine:!0}),lineInsertWithSign:v7.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+z5.asClassName(Yle),marginClassName:"line-insert",isWholeLine:!0}),lineDelete:v7.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"line-delete",isWholeLine:!0}),lineDeleteWithSign:v7.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+z5.asClassName(Xle),marginClassName:"line-delete",isWholeLine:!0}),lineDeleteMargin:v7.register({description:"diff-editor-line-delete-margin",marginClassName:"line-delete"})};class rce extends Jle{constructor(e,t){super(e),this._disableSash=!1===t,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new sle(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart((()=>this._onSashDragStart())),this._sash.onDidChange((e=>this._onSashDrag(e))),this._sash.onDidEnd((()=>this._onSashDragEnd())),this._sash.onDidReset((()=>this._onSashReset()))}setEnableSplitViewResizing(e){const t=!1===e;this._disableSash!==t&&(this._disableSash=t,this._sash.state=this._disableSash?0:3)}layout(e=this._sashRatio){const t=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?Qle.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let n=Math.floor((e||.5)*t);const i=Math.floor(.5*t);return n=this._disableSash?i:n||i,t>2*rce.MINIMUM_EDITOR_WIDTH?(n<rce.MINIMUM_EDITOR_WIDTH&&(n=rce.MINIMUM_EDITOR_WIDTH),n>t-rce.MINIMUM_EDITOR_WIDTH&&(n=t-rce.MINIMUM_EDITOR_WIDTH)):n=i,this._sashPosition!==n&&(this._sashPosition=n,this._sash.layout()),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(e){const t=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?Qle.ENTIRE_DIFF_OVERVIEW_WIDTH:0),n=this.layout((this._startSashPosition+(e.currentX-e.startX))/t);this._sashRatio=n/t,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=.5,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(e){return 0}getVerticalSashLeft(e){return this._sashPosition}getVerticalSashHeight(e){return this._dataSource.getHeight()}_getViewZones(e,t,n){const i=this._dataSource.getOriginalEditor(),r=this._dataSource.getModifiedEditor();return new oce(e,t,n,i,r).getViewZones()}_getOriginalEditorDecorations(e,t,n){const i=this._dataSource.getOriginalEditor(),r=String(this._removeColor),o={decorations:[],overviewZones:[]},s=i.getModel(),a=i._getViewModel();for(const l of e)if(uce(l)){o.decorations.push({range:new TK(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824),options:n?ice.lineDeleteWithSign:ice.lineDelete}),cce(l)&&l.charChanges||o.decorations.push(nce(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824,ice.charDeleteWholeLine));const e=dce(s,a,l.originalStartLineNumber,l.originalEndLineNumber);if(o.overviewZones.push(new Yoe(e.startLineNumber,e.endLineNumber,r)),l.charChanges)for(const n of l.charChanges)if(uce(n))if(t)for(let e=n.originalStartLineNumber;e<=n.originalEndLineNumber;e++){let t,i;t=e===n.originalStartLineNumber?n.originalStartColumn:s.getLineFirstNonWhitespaceColumn(e),i=e===n.originalEndLineNumber?n.originalEndColumn:s.getLineLastNonWhitespaceColumn(e),o.decorations.push(nce(e,t,e,i,ice.charDelete))}else o.decorations.push(nce(n.originalStartLineNumber,n.originalStartColumn,n.originalEndLineNumber,n.originalEndColumn,ice.charDelete))}return o}_getModifiedEditorDecorations(e,t,n){const i=this._dataSource.getModifiedEditor(),r=String(this._insertColor),o={decorations:[],overviewZones:[]},s=i.getModel(),a=i._getViewModel();for(const l of e)if(cce(l)){o.decorations.push({range:new TK(l.modifiedStartLineNumber,1,l.modifiedEndLineNumber,1073741824),options:n?ice.lineInsertWithSign:ice.lineInsert}),uce(l)&&l.charChanges||o.decorations.push(nce(l.modifiedStartLineNumber,1,l.modifiedEndLineNumber,1073741824,ice.charInsertWholeLine));const e=dce(s,a,l.modifiedStartLineNumber,l.modifiedEndLineNumber);if(o.overviewZones.push(new Yoe(e.startLineNumber,e.endLineNumber,r)),l.charChanges)for(const n of l.charChanges)if(cce(n))if(t)for(let e=n.modifiedStartLineNumber;e<=n.modifiedEndLineNumber;e++){let t,i;t=e===n.modifiedStartLineNumber?n.modifiedStartColumn:s.getLineFirstNonWhitespaceColumn(e),i=e===n.modifiedEndLineNumber?n.modifiedEndColumn:s.getLineLastNonWhitespaceColumn(e),o.decorations.push(nce(e,t,e,i,ice.charInsert))}else o.decorations.push(nce(n.modifiedStartLineNumber,n.modifiedStartColumn,n.modifiedEndLineNumber,n.modifiedEndColumn,ice.charInsert))}return o}}rce.MINIMUM_EDITOR_WIDTH=100;class oce extends tce{constructor(e,t,n,i,r){super(e,t,n,i,r)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(e,t,n){return n>t?{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:n-t,domNode:null}:null}_produceModifiedFromDiff(e,t,n){return t>n?{afterLineNumber:Math.max(e.modifiedStartLineNumber,e.modifiedEndLineNumber),heightInLines:t-n,domNode:null}:null}}class sce extends Jle{constructor(e,t){super(e),this._decorationsLeft=e.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(e.getOriginalEditor().onDidLayoutChange((t=>{this._decorationsLeft!==t.decorationsLeft&&(this._decorationsLeft=t.decorationsLeft,e.relayoutEditors())})))}setEnableSplitViewResizing(e){}_getViewZones(e,t,n,i){const r=this._dataSource.getOriginalEditor(),o=this._dataSource.getModifiedEditor();return new ace(e,t,n,r,o,i).getViewZones()}_getOriginalEditorDecorations(e,t,n){const i=String(this._removeColor),r={decorations:[],overviewZones:[]},o=this._dataSource.getOriginalEditor(),s=o.getModel(),a=o._getViewModel();for(const l of e)if(uce(l)){r.decorations.push({range:new TK(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824),options:ice.lineDeleteMargin});const e=dce(s,a,l.originalStartLineNumber,l.originalEndLineNumber);r.overviewZones.push(new Yoe(e.startLineNumber,e.endLineNumber,i))}return r}_getModifiedEditorDecorations(e,t,n){const i=this._dataSource.getModifiedEditor(),r=String(this._insertColor),o={decorations:[],overviewZones:[]},s=i.getModel(),a=i._getViewModel();for(const l of e)if(cce(l)){o.decorations.push({range:new TK(l.modifiedStartLineNumber,1,l.modifiedEndLineNumber,1073741824),options:n?ice.lineInsertWithSign:ice.lineInsert});const e=dce(s,a,l.modifiedStartLineNumber,l.modifiedEndLineNumber);if(o.overviewZones.push(new Yoe(e.startLineNumber,e.endLineNumber,r)),l.charChanges){for(const n of l.charChanges)if(cce(n))if(t)for(let e=n.modifiedStartLineNumber;e<=n.modifiedEndLineNumber;e++){let t,i;t=e===n.modifiedStartLineNumber?n.modifiedStartColumn:s.getLineFirstNonWhitespaceColumn(e),i=e===n.modifiedEndLineNumber?n.modifiedEndColumn:s.getLineLastNonWhitespaceColumn(e),o.decorations.push(nce(e,t,e,i,ice.charInsert))}else o.decorations.push(nce(n.modifiedStartLineNumber,n.modifiedStartColumn,n.modifiedEndLineNumber,n.modifiedEndColumn,ice.charInsert))}else o.decorations.push(nce(l.modifiedStartLineNumber,1,l.modifiedEndLineNumber,1073741824,ice.charInsertWholeLine))}return o}layout(){return Math.max(5,this._decorationsLeft)}}class ace extends tce{constructor(e,t,n,i,r,o){super(e,t,n,i,r),this._originalModel=i.getModel(),this._renderIndicators=o,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const e=super.getViewZones();return this._finalize(e),e}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const e=document.createElement("div");return e.className="inline-added-margin-view-zone",e}_produceOriginalFromDiff(e,t,n){const i=document.createElement("div");return i.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:n,domNode:document.createElement("div"),marginDomNode:i}}_produceModifiedFromDiff(e,t,n){const i=document.createElement("div");i.className="view-lines line-delete monaco-mouse-cursor-text";const r=document.createElement("div");r.className="inline-deleted-margin-view-zone";const o={shouldNotShrink:!0,afterLineNumber:0===e.modifiedEndLineNumber?e.modifiedStartLineNumber:e.modifiedStartLineNumber-1,heightInLines:t,minWidthInPx:0,domNode:i,marginDomNode:r,diff:{originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber,modifiedStartLineNumber:e.modifiedStartLineNumber,modifiedEndLineNumber:e.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let s=e.originalStartLineNumber;s<=e.originalEndLineNumber;s++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(s),null,null);return this._pendingLineChange.push(e),this._pendingViewZones.push(o),o}_finalize(e){const t=this._modifiedEditor.getOptions(),n=this._modifiedEditor.getModel().getOptions().tabSize,i=t.get(40),r=t.get(27),o=i.typicalHalfwidthCharacterWidth,s=t.get(91),a=this._originalModel.mightContainNonBasicASCII(),l=this._originalModel.mightContainRTL(),c=t.get(56),u=t.get(128).decorationsWidth,h=t.get(103),d=t.get(86),f=t.get(80),g=t.get(41),p=this._lineBreaksComputer.finalize();let m=0;for(let v=0;v<this._pendingLineChange.length;v++){const t=this._pendingLineChange[v],y=this._pendingViewZones[v],_=y.domNode;D6.applyFontInfoSlow(_,i);const b=y.marginDomNode;D6.applyFontInfoSlow(b,i);const w=[];if(t.charChanges)for(const e of t.charChanges)uce(e)&&w.push(new T2(new TK(e.originalStartLineNumber,e.originalStartColumn,e.originalEndLineNumber,e.originalEndColumn),"char-delete",0));const C=w.length>0,S=E0(1e4);let x=0,E=0,k=null;for(let o=t.originalStartLineNumber;o<=t.originalEndLineNumber;o++){const s=o-t.originalStartLineNumber,v=this._originalModel.getLineTokens(o),_=v.getLineContent(),L=p[m++],D=d2.filter(w,o,1,_.length+1);if(L){let t=0;for(const e of L.breakOffsets){const o=v.sliceAndInflate(t,e,0),s=_.substring(t,e);x=Math.max(x,this._renderOriginalLine(E++,s,o,d2.extractWrapped(D,t,e),C,a,l,i,r,c,u,h,d,f,g,n,S,b)),t=e}for(k||(k=[]);k.length<s;)k[k.length]=1;k[s]=L.breakOffsets.length,y.heightInLines+=L.breakOffsets.length-1;const p=document.createElement("div");p.className="line-delete",e.original.push({afterLineNumber:o,afterColumn:0,heightInLines:L.breakOffsets.length-1,domNode:hce(),marginDomNode:p})}else x=Math.max(x,this._renderOriginalLine(E++,_,v,D,C,a,l,i,r,c,u,h,d,f,g,n,S,b))}x+=s;const L=S.build(),D=Zle?Zle.createHTML(L):L;if(_.innerHTML=D,y.minWidthInPx=x*o,k){const e=t.originalEndLineNumber-t.originalStartLineNumber;for(;k.length<=e;)k[k.length]=1}y.diff.viewLineCounts=k}e.original.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber))}_renderOriginalLine(e,t,n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v){m.appendASCIIString('<div class="view-line'),r||m.appendASCIIString(" char-delete"),m.appendASCIIString('" style="top:'),m.appendASCIIString(String(e*c)),m.appendASCIIString('px;width:1000000px;">');const y=I2.isBasicASCII(t,o),_=I2.containsRTL(t,y,s),b=w2(new v2(a.isMonospace&&!l,a.canUseHalfwidthRightwardsArrow,t,!1,y,_,0,n,i,p,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,h,d,f,g!==zj.OFF,null),m);if(m.appendASCIIString("</div>"),this._renderIndicators){const t=document.createElement("div");t.className=`delete-sign ${z5.asClassName(Xle)}`,t.setAttribute("style",`position:absolute;top:${e*c}px;width:${u}px;height:${c}px;right:0;`),v.appendChild(t)}return b.characterMapping.getAbsoluteOffset(b.characterMapping.length)}}function lce(e,t){return Rj(e,t,["off","on","inherit"])}function cce(e){return e.modifiedEndLineNumber>0}function uce(e){return e.originalEndLineNumber>0}function hce(){const e=document.createElement("div");return e.className="diagonal-fill",e}function dce(e,t,n,i){const r=e.getLineCount();return n=Math.min(r,Math.max(1,n)),i=Math.min(r,Math.max(1,i)),t.coordinatesConverter.convertModelRangeToViewRange(new TK(n,e.getLineMinColumn(n),i,e.getLineMaxColumn(i)))}G5(((e,t)=>{const n=e.getColor(Qte);n&&(t.addRule(`.monaco-editor .line-insert, .monaco-editor .char-insert { background-color: ${n}; }`),t.addRule(`.monaco-diff-editor .line-insert, .monaco-diff-editor .char-insert { background-color: ${n}; }`),t.addRule(`.monaco-editor .inline-added-margin-view-zone { background-color: ${n}; }`));const i=e.getColor(Jte);i&&(t.addRule(`.monaco-editor .line-delete, .monaco-editor .char-delete { background-color: ${i}; }`),t.addRule(`.monaco-diff-editor .line-delete, .monaco-diff-editor .char-delete { background-color: ${i}; }`),t.addRule(`.monaco-editor .inline-deleted-margin-view-zone { background-color: ${i}; }`));const r=e.getColor(ene);r&&t.addRule(`.monaco-editor .line-insert, .monaco-editor .char-insert { border: 1px ${"hc"===e.type?"dashed":"solid"} ${r}; }`);const o=e.getColor(tne);o&&t.addRule(`.monaco-editor .line-delete, .monaco-editor .char-delete { border: 1px ${"hc"===e.type?"dashed":"solid"} ${o}; }`);const s=e.getColor(Qee);s&&t.addRule(`.monaco-diff-editor.side-by-side .editor.modified { box-shadow: -6px 0 5px -5px ${s}; }`);const a=e.getColor(nne);a&&t.addRule(`.monaco-diff-editor.side-by-side .editor.modified { border-left: 1px solid ${a}; }`);const l=e.getColor(Jee);l&&t.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport {\n\t\t\t\tbackground: ${l};\n\t\t\t}\n\t\t`);const c=e.getColor(ete);c&&t.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport:hover {\n\t\t\t\tbackground: ${c};\n\t\t\t}\n\t\t`);const u=e.getColor(tte);u&&t.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport:active {\n\t\t\t\tbackground: ${u};\n\t\t\t}\n\t\t`);const h=e.getColor(ine);t.addRule(`\n\t.monaco-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t${h} 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t${h} 50%, ${h} 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t`)}));const fce=i$("themeService"),gce=i$("keybindingService");class pce extends mG{constructor(){super(),this._onCodeEditorAdd=this._register(new EG),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new EG),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onDiffEditorAdd=this._register(new EG),this._onDiffEditorRemove=this._register(new EG),this._onDecorationTypeRegistered=this._register(new EG),this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null)}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map((e=>this._codeEditors[e]))}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}removeDiffEditor(e){delete this._diffEditors[e.getId()]&&this._onDiffEditorRemove.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map((e=>this._diffEditors[e]))}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const n of t){if(n.hasTextFocus())return n;n.hasWidgetFocus()&&(e=n)}return e}setModelProperty(e,t,n){const i=e.toString();let r;this._modelProperties.has(i)?r=this._modelProperties.get(i):(r=new Map,this._modelProperties.set(i,r)),r.set(t,n)}getModelProperty(e,t){const n=e.toString();if(this._modelProperties.has(n)){return this._modelProperties.get(n).get(t)}}}class mce{constructor(e,t,n){this._parent=e,this._editorId=t,this._styleSheet=n,this._refCount=0}ref(){this._refCount++}unref(){var e;this._refCount--,0===this._refCount&&(null===(e=this._styleSheet.parentNode)||void 0===e||e.removeChild(this._styleSheet),this._parent._removeEditorStyleSheets(this._editorId))}insertRule(e,t){this._styleSheet.sheet.insertRule(e,t)}removeRulesContainingSelector(e){AY(e,this._styleSheet)}}class vce{constructor(e){this._styleSheet=e}ref(){}unref(){}insertRule(e,t){this._styleSheet.sheet.insertRule(e,t)}removeRulesContainingSelector(e){AY(e,this._styleSheet)}}let yce=class extends pce{constructor(e,t){super(),this._decorationOptionProviders=new Map,this._editorStyleSheets=new Map,this._globalStyleSheet=e||null,this._themeService=t}_getOrCreateGlobalStyleSheet(){return this._globalStyleSheet||(this._globalStyleSheet=new vce(NY())),this._globalStyleSheet}_getOrCreateStyleSheet(e){if(!e)return this._getOrCreateGlobalStyleSheet();const t=e.getContainerDomNode();if(!kY(t))return this._getOrCreateGlobalStyleSheet();const n=e.getId();if(!this._editorStyleSheets.has(n)){const e=new mce(this,n,NY(t));this._editorStyleSheets.set(n,e)}return this._editorStyleSheets.get(n)}_removeEditorStyleSheets(e){this._editorStyleSheets.delete(e)}registerDecorationType(e,t,n,i,r){let o=this._decorationOptionProviders.get(t);if(!o){const s=this._getOrCreateStyleSheet(r),a={styleSheet:s,key:t,parentTypeKey:i,options:n||Object.create(null)};o=i?new _ce(this._themeService,s,a):new bce(e,this._themeService,s,a),this._decorationOptionProviders.set(t,o),this._onDecorationTypeRegistered.fire(t)}o.refCount++}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach((t=>t.removeDecorations(e)))))}resolveDecorationOptions(e,t){const n=this._decorationOptionProviders.get(e);if(!n)throw new Error("Unknown decoration type key: "+e);return n.getOptions(this,t)}};yce=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,B5)],yce);class _ce{constructor(e,t,n){this._styleSheet=t,this._styleSheet.ref(),this._parentTypeKey=n.parentTypeKey,this.refCount=0,this._beforeContentRules=new Cce(3,n,e),this._afterContentRules=new Cce(4,n,e)}getOptions(e,t){const n=e.resolveDecorationOptions(this._parentTypeKey,!0);return this._beforeContentRules&&(n.beforeContentClassName=this._beforeContentRules.className),this._afterContentRules&&(n.afterContentClassName=this._afterContentRules.className),n}dispose(){this._beforeContentRules&&(this._beforeContentRules.dispose(),this._beforeContentRules=null),this._afterContentRules&&(this._afterContentRules.dispose(),this._afterContentRules=null),this._styleSheet.unref()}}class bce{constructor(e,t,n,i){this._disposables=new pG,this.description=e,this._styleSheet=n,this._styleSheet.ref(),this.refCount=0;const r=e=>{const n=new Cce(e,i,t);if(this._disposables.add(n),n.hasContent)return n.className};this.className=r(0);const o=(e=>{const n=new Cce(e,i,t);return this._disposables.add(n),n.hasContent?{className:n.className,hasLetterSpacing:n.hasLetterSpacing}:null})(1);o&&(this.inlineClassName=o.className,this.inlineClassNameAffectsLetterSpacing=o.hasLetterSpacing),this.beforeContentClassName=r(3),this.afterContentClassName=r(4),this.glyphMarginClassName=r(2);const s=i.options;this.isWholeLine=Boolean(s.isWholeLine),this.stickiness=s.rangeBehavior;const a=s.light&&s.light.overviewRulerColor||s.overviewRulerColor,l=s.dark&&s.dark.overviewRulerColor||s.overviewRulerColor;void 0===a&&void 0===l||(this.overviewRuler={color:a||l,darkColor:l||a,position:s.overviewRulerLane||wQ.Center})}getOptions(e,t){return t?{description:this.description,inlineClassName:this.inlineClassName,beforeContentClassName:this.beforeContentClassName,afterContentClassName:this.afterContentClassName,className:this.className,glyphMarginClassName:this.glyphMarginClassName,isWholeLine:this.isWholeLine,overviewRuler:this.overviewRuler,stickiness:this.stickiness}:this}dispose(){this._disposables.dispose(),this._styleSheet.unref()}}const wce={color:"color:{0} !important;",opacity:"opacity:{0};",backgroundColor:"background-color:{0};",outline:"outline:{0};",outlineColor:"outline-color:{0};",outlineStyle:"outline-style:{0};",outlineWidth:"outline-width:{0};",border:"border:{0};",borderColor:"border-color:{0};",borderRadius:"border-radius:{0};",borderSpacing:"border-spacing:{0};",borderStyle:"border-style:{0};",borderWidth:"border-width:{0};",fontStyle:"font-style:{0};",fontWeight:"font-weight:{0};",fontSize:"font-size:{0};",fontFamily:"font-family:{0};",textDecoration:"text-decoration:{0};",cursor:"cursor:{0};",letterSpacing:"letter-spacing:{0};",gutterIconPath:"background:{0} center center no-repeat;",gutterIconSize:"background-size:{0};",contentText:"content:'{0}';",contentIconPath:"content:{0};",margin:"margin:{0};",padding:"padding:{0};",width:"width:{0};",height:"height:{0};"};class Cce{constructor(e,t,n){this._theme=n.getColorTheme(),this._ruleType=e,this._providerArgs=t,this._usesThemeColors=!1,this._hasContent=!1,this._hasLetterSpacing=!1;let i=Sce.getClassName(this._providerArgs.key,e);this._providerArgs.parentTypeKey&&(i=i+" "+Sce.getClassName(this._providerArgs.parentTypeKey,e)),this._className=i,this._unThemedSelector=Sce.getSelector(this._providerArgs.key,this._providerArgs.parentTypeKey,e),this._buildCSS(),this._usesThemeColors?this._themeListener=n.onDidColorThemeChange((e=>{this._theme=n.getColorTheme(),this._removeCSS(),this._buildCSS()})):this._themeListener=null}dispose(){this._hasContent&&(this._removeCSS(),this._hasContent=!1),this._themeListener&&(this._themeListener.dispose(),this._themeListener=null)}get hasContent(){return this._hasContent}get hasLetterSpacing(){return this._hasLetterSpacing}get className(){return this._className}_buildCSS(){const e=this._providerArgs.options;let t,n,i;switch(this._ruleType){case 0:t=this.getCSSTextForModelDecorationClassName(e),n=this.getCSSTextForModelDecorationClassName(e.light),i=this.getCSSTextForModelDecorationClassName(e.dark);break;case 1:t=this.getCSSTextForModelDecorationInlineClassName(e),n=this.getCSSTextForModelDecorationInlineClassName(e.light),i=this.getCSSTextForModelDecorationInlineClassName(e.dark);break;case 2:t=this.getCSSTextForModelDecorationGlyphMarginClassName(e),n=this.getCSSTextForModelDecorationGlyphMarginClassName(e.light),i=this.getCSSTextForModelDecorationGlyphMarginClassName(e.dark);break;case 3:t=this.getCSSTextForModelDecorationContentClassName(e.before),n=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.before),i=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.before);break;case 4:t=this.getCSSTextForModelDecorationContentClassName(e.after),n=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.after),i=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.after);break;default:throw new Error("Unknown rule type: "+this._ruleType)}const r=this._providerArgs.styleSheet;let o=!1;t.length>0&&(r.insertRule(`${this._unThemedSelector} {${t}}`,0),o=!0),n.length>0&&(r.insertRule(`.vs${this._unThemedSelector} {${n}}`,0),o=!0),i.length>0&&(r.insertRule(`.vs-dark${this._unThemedSelector}, .hc-black${this._unThemedSelector} {${i}}`,0),o=!0),this._hasContent=o}_removeCSS(){this._providerArgs.styleSheet.removeRulesContainingSelector(this._unThemedSelector)}getCSSTextForModelDecorationClassName(e){if(!e)return"";const t=[];return this.collectCSSText(e,["backgroundColor"],t),this.collectCSSText(e,["outline","outlineColor","outlineStyle","outlineWidth"],t),this.collectBorderSettingsCSSText(e,t),t.join("")}getCSSTextForModelDecorationInlineClassName(e){if(!e)return"";const t=[];return this.collectCSSText(e,["fontStyle","fontWeight","textDecoration","cursor","color","opacity","letterSpacing"],t),e.letterSpacing&&(this._hasLetterSpacing=!0),t.join("")}getCSSTextForModelDecorationContentClassName(e){if(!e)return"";const t=[];if(void 0!==e){if(this.collectBorderSettingsCSSText(e,t),void 0!==e.contentIconPath&&t.push(nX(wce.contentIconPath,ZY(_K.revive(e.contentIconPath)))),"string"==typeof e.contentText){const n=e.contentText.match(/^.*$/m)[0].replace(/['\\]/g,"\\$&");t.push(nX(wce.contentText,n))}this.collectCSSText(e,["fontStyle","fontWeight","fontSize","fontFamily","textDecoration","color","opacity","backgroundColor","margin","padding"],t),this.collectCSSText(e,["width","height"],t)&&t.push("display:inline-block;")}return t.join("")}getCSSTextForModelDecorationGlyphMarginClassName(e){if(!e)return"";const t=[];return void 0!==e.gutterIconPath&&(t.push(nX(wce.gutterIconPath,ZY(_K.revive(e.gutterIconPath)))),void 0!==e.gutterIconSize&&t.push(nX(wce.gutterIconSize,e.gutterIconSize))),t.join("")}collectBorderSettingsCSSText(e,t){return!!this.collectCSSText(e,["border","borderColor","borderRadius","borderSpacing","borderStyle","borderWidth"],t)&&(t.push(nX("box-sizing: border-box;")),!0)}collectCSSText(e,t,n){const i=n.length;for(let r of t){const t=this.resolveValue(e[r]);"string"==typeof t&&n.push(nX(wce[r],t))}return n.length!==i}resolveValue(e){if((t=e)&&"string"==typeof t.id){this._usesThemeColors=!0;const t=this._theme.getColor(e.id);return t?t.toString():"transparent"}var t;return e}}class Sce{static getClassName(e,t){return"ced-"+e+"-"+t}static getSelector(e,t,n){let i=".monaco-editor ."+this.getClassName(e,n);return t&&(i=i+"."+this.getClassName(t,n)),3===n?i+="::before":4===n&&(i+="::after"),i}}var xce=function(e,t){return function(n,i){t(n,i,e)}};let Ece=class extends yce{constructor(e,t,n){super(e,n),this.onCodeEditorAdd((()=>this._checkContextKey())),this.onCodeEditorRemove((()=>this._checkContextKey())),this._editorIsOpen=t.createKey("editorIsOpen",!1),this._activeCodeEditor=null}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}openCodeEditor(e,t,n){return t?Promise.resolve(this.doOpenEditor(t,e)):Promise.resolve(null)}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const n=t.resource.scheme;if(n===j$.http||n===j$.https)return XY(t.resource.toString()),e}return null}const n=t.options?t.options.selection:null;if(n)if("number"==typeof n.endLineNumber&&"number"==typeof n.endColumn)e.setSelection(n),e.revealRangeInCenter(n,1);else{const t={lineNumber:n.startLineNumber,column:n.startColumn};e.setPosition(t),e.revealPositionInCenter(t,1)}return e}findModel(e,t){const n=e.getModel();return n&&n.uri.toString()!==t.toString()?null:n}};Ece=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([xce(1,A5),xce(2,B5)],Ece);var kce=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Lce=function(e,t){return function(n,i){t(n,i,e)}};let Dce=0,Nce=!1;function Ice(){Nce||(Nce=!0,function(e){X4=document.createElement("div"),X4.className="monaco-aria-container";const t=()=>{const e=document.createElement("div");return e.className="monaco-alert",e.setAttribute("role","alert"),e.setAttribute("aria-atomic","true"),X4.appendChild(e),e};Z4=t(),Q4=t();const n=()=>{const e=document.createElement("div");return e.className="monaco-status",e.setAttribute("role","complementary"),e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),X4.appendChild(e),e};J4=n(),e5=n(),e.appendChild(X4)}(document.body))}let Tce=class extends zae{constructor(e,t,n,i,r,o,s,a,l,c){const u=Object.assign({},t);u.ariaLabel=u.ariaLabel||k4.editorViewAccessibleLabel,u.ariaLabel=u.ariaLabel+";"+k4.accessibilityHelpMessage,super(e,u,{},n,i,r,o,a,l,c),this._standaloneKeybindingService=s instanceof W4?s:null,Ice()}addCommand(e,t,n){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;let i="DYNAMIC_"+ ++Dce,r=g5.deserialize(n);return this._standaloneKeybindingService.addDynamicKeybinding(i,e,t,r),i}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if("string"!=typeof e.id||"string"!=typeof e.label||"function"!=typeof e.run)throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),mG.None;const t=e.id,n=e.label,i=g5.and(g5.equals("editorId",this.getId()),g5.deserialize(e.precondition)),r=e.keybindings,o=g5.and(i,g5.deserialize(e.keybindingContext)),s=e.contextMenuGroupId||null,a=e.contextMenuOrder||0,l=(t,...n)=>Promise.resolve(e.run(this,...n)),c=new pG,u=this.getId()+":"+t;if(c.add(qZ.registerCommand(u,l)),s){let e={command:{id:u,title:n},when:i,group:s,order:a};c.add(Z5.appendMenuItem(Y5.EditorContext,e))}if(Array.isArray(r))for(const d of r)c.add(this._standaloneKeybindingService.addDynamicKeybinding(u,d,l,o));let h=new Kse(u,n,n,i,l,this._contextKeyService);return this._actions[t]=h,c.add(gG((()=>{delete this._actions[t]}))),c}_triggerCommand(e,t){if(this._codeEditorService instanceof Ece)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};Tce=kce([Lce(2,t$),Lce(3,o$),Lce(4,KZ),Lce(5,A5),Lce(6,gce),Lce(7,B5),Lce(8,g4),Lce(9,yae)],Tce);let Mce=class extends Tce{constructor(e,t,n,i,r,o,s,a,l,c,u,h,d,f,g){const p=Object.assign({},t);K4(h,p,!1);const m=c.registerEditorContainer(e);"string"==typeof p.theme&&c.setTheme(p.theme),void 0!==p.autoDetectHighContrast&&c.setAutoDetectHighContrast(Boolean(p.autoDetectHighContrast));let v,y=p.model;if(delete p.model,super(e,p,i,r,o,s,a,c,u,d),this._contextViewService=l,this._configurationService=h,this._standaloneThemeService=c,this._register(n),this._register(m),void 0===y?(v=Oce(f,g,p.value||"",p.language||Z7.text,void 0),this._ownsModel=!0):(v=y,this._ownsModel=!1),this._attachModel(v),v){let e={oldModelUrl:null,newModelUrl:v.uri};this._onDidChangeModel.fire(e)}}dispose(){super.dispose()}updateOptions(e){K4(this._configurationService,e,!1),"string"==typeof e.theme&&this._standaloneThemeService.setTheme(e.theme),void 0!==e.autoDetectHighContrast&&this._standaloneThemeService.setAutoDetectHighContrast(Boolean(e.autoDetectHighContrast)),super.updateOptions(e)}_attachModel(e){super._attachModel(e),this._modelData&&this._contextViewService.setContainer(this._modelData.view.domNode.domNode)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};Mce=kce([Lce(3,t$),Lce(4,o$),Lce(5,KZ),Lce(6,A5),Lce(7,gce),Lce(8,Ble),Lce(9,fce),Lce(10,g4),Lce(11,j3),Lce(12,yae),Lce(13,iJ),Lce(14,t0)],Mce);let Ace=class extends Qle{constructor(e,t,n,i,r,o,s,a,l,c,u,h,d,f,g){const p=Object.assign({},t);K4(h,p,!0);const m=c.registerEditorContainer(e);"string"==typeof p.theme&&c.setTheme(p.theme),void 0!==p.autoDetectHighContrast&&c.setAutoDetectHighContrast(Boolean(p.autoDetectHighContrast)),super(e,p,{},g,a,r,i,l,c,u,d,f),this._contextViewService=s,this._configurationService=h,this._standaloneThemeService=c,this._register(n),this._register(m),this._contextViewService.setContainer(this._containerDomElement)}dispose(){super.dispose()}updateOptions(e){K4(this._configurationService,e,!0),"string"==typeof e.theme&&this._standaloneThemeService.setTheme(e.theme),void 0!==e.autoDetectHighContrast&&this._standaloneThemeService.setAutoDetectHighContrast(Boolean(e.autoDetectHighContrast)),super.updateOptions(e)}_createInnerEditor(e,t,n){return e.createInstance(Tce,t,n)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,n){return this.getModifiedEditor().addCommand(e,t,n)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};function Oce(e,t,n,i,r){if(n=n||"",!i){const i=n.indexOf("\n");let o=n;return-1!==i&&(o=n.substring(0,i)),Rce(e,n,t.createByFilepathOrFirstLine(r||null,o),r)}return Rce(e,n,t.create(i),r)}function Rce(e,t,n,i){return e.createModel(t,n,i)}Ace=kce([Lce(3,t$),Lce(4,A5),Lce(5,gce),Lce(6,Ble),Lce(7,e0),Lce(8,o$),Lce(9,fce),Lce(10,g4),Lce(11,j3),Lce(12,Wle),Lce(13,jle),Lce(14,Ule)],Ace);class Pce{constructor(e){this._languageIdentifier=e}getId(){return this._languageIdentifier.language}}const Fce=new class{constructor(){this._onDidChangeLanguages=new EG,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[],this._dynamicLanguages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e)return void this._languages.splice(t,1)}}}getLanguages(){return[].concat(this._languages).concat(this._dynamicLanguages)}};d3.add("editor.modesRegistry",Fce);const Bce=new gJ("plaintext",1);Fce.registerLanguage({id:"plaintext",extensions:[".txt"],aliases:[GH(0,"Plain Text"),"text"],mimetypes:[Z7.text]}),q0.register(Bce,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],folding:{offSide:!0}},0);const Wce=Object.prototype.hasOwnProperty;class zce extends mG{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new EG),this.onDidChange=this._onDidChange.event,this._warnOnOverwrite=t,this._nextLanguageId2=1,this._languageIdToLanguage=[],this._languageToLanguageId=Object.create(null),this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(Fce.onDidChangeLanguages((e=>this._initializeFromRegistry()))))}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={};const e=Fce.getLanguages();this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach((e=>{let t=this._languages[e];t.name&&(this._nameMap[t.name]=t.identifier),t.aliases.forEach((e=>{this._lowercaseNameMap[e.toLowerCase()]=t.identifier})),t.mimetypes.forEach((e=>{this._mimeTypesMap[e]=t.identifier}))})),d3.as(p3).registerOverrideIdentifiers(Fce.getLanguages().map((e=>e.id))),this._onDidChange.fire()}_getLanguageId(e){if(this._languageToLanguageId[e])return this._languageToLanguageId[e];const t=this._nextLanguageId2++;return this._languageIdToLanguage[t]=e,this._languageToLanguageId[e]=t,t}_registerLanguage(e){const t=e.id;let n;if(Wce.call(this._languages,t))n=this._languages[t];else{const e=this._getLanguageId(t);n={identifier:new gJ(t,e),name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[]},this._languages[t]=n}this._mergeLanguage(n,e)}_mergeLanguage(e,t){const n=t.id;let i=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),i=t.mimetypes[0]),i||(i=`text/x-${n}`,e.mimetypes.push(i)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(let e of t.extensions)nee({id:n,mime:i,extension:e},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(let l of t.filenames)nee({id:n,mime:i,filename:l},this._warnOnOverwrite),e.filenames.push(l);if(Array.isArray(t.filenamePatterns))for(let l of t.filenamePatterns)nee({id:n,mime:i,filepattern:l},this._warnOnOverwrite);if("string"==typeof t.firstLine&&t.firstLine.length>0){let e=t.firstLine;"^"!==e.charAt(0)&&(e="^"+e);try{let t=new RegExp(e);"^"!==(r=t).source&&"^$"!==r.source&&"$"!==r.source&&"^\\s*$"!==r.source&&r.exec("")&&0===r.lastIndex||nee({id:n,mime:i,firstline:t},this._warnOnOverwrite)}catch(a){nG(a)}}var r;e.aliases.push(n);let o=null;if(void 0!==t.aliases&&Array.isArray(t.aliases)&&(o=0===t.aliases.length?[null]:t.aliases),null!==o)for(const l of o)l&&0!==l.length&&e.aliases.push(l);let s=null!==o&&o.length>0;if(s&&null===o[0]);else{let t=(s?o[0]:null)||n;!s&&e.name||(e.name=t)}t.configuration&&e.configurationFiles.push(t.configuration)}isRegisteredMode(e){return!!Wce.call(this._mimeTypesMap,e)||Wce.call(this._languages,e)}getModeIdForLanguageNameLowercase(e){return Wce.call(this._lowercaseNameMap,e)?this._lowercaseNameMap[e].language:null}extractModeIds(e){return e?e.split(",").map((e=>e.trim())).map((e=>Wce.call(this._mimeTypesMap,e)?this._mimeTypesMap[e].language:e)).filter((e=>Wce.call(this._languages,e))):[]}getLanguageIdentifier(e){if("vs.editor.nullMode"===e||0===e)return ZJ;let t;if("string"==typeof e)t=e;else if(t=this._languageIdToLanguage[e],!t)return null;return Wce.call(this._languages,t)?this._languages[t].identifier:null}getModeIdsFromFilepathOrFirstLine(e,t){if(!e&&!t)return[];let n=iee(e,t);return this.extractModeIds(n.join(","))}}class Vce{constructor(e,t){let n;this._selector=t,this.languageIdentifier=this._selector(),this._onDidChange=new EG({onFirstListenerAdd:()=>{n=e((()=>this._evaluate()))},onLastListenerRemove:()=>{n.dispose()}}),this.onDidChange=this._onDidChange.event}_evaluate(){let e=this._selector();e.id!==this.languageIdentifier.id&&(this.languageIdentifier=e,this._onDidChange.fire(this.languageIdentifier))}}class Uce extends mG{constructor(e=!1){super(),this._onDidCreateMode=this._register(new EG),this.onDidCreateMode=this._onDidCreateMode.event,this._onLanguagesMaybeChanged=this._register(new EG({leakWarningThreshold:200})),this.onLanguagesMaybeChanged=this._onLanguagesMaybeChanged.event,this._instantiatedModes={},this._registry=this._register(new zce(!0,e)),this._register(this._registry.onDidChange((()=>this._onLanguagesMaybeChanged.fire())))}isRegisteredMode(e){return this._registry.isRegisteredMode(e)}getModeIdForLanguageName(e){return this._registry.getModeIdForLanguageNameLowercase(e)}getModeIdByFilepathOrFirstLine(e,t){return B1(this._registry.getModeIdsFromFilepathOrFirstLine(e,t),null)}getModeId(e){return B1(this._registry.extractModeIds(e),null)}getLanguageIdentifier(e){return this._registry.getLanguageIdentifier(e)}create(e){return new Vce(this.onLanguagesMaybeChanged,(()=>{const t=this.getModeId(e);return this._createModeAndGetLanguageIdentifier(t)}))}createByFilepathOrFirstLine(e,t){return new Vce(this.onLanguagesMaybeChanged,(()=>{const n=this.getModeIdByFilepathOrFirstLine(e,t);return this._createModeAndGetLanguageIdentifier(n)}))}_createModeAndGetLanguageIdentifier(e){const t=this.getLanguageIdentifier(e||"plaintext")||ZJ;return this._getOrCreateMode(t.language),t}triggerMode(e){const t=this.getModeId(e);this._getOrCreateMode(t||"plaintext")}_getOrCreateMode(e){if(!this._instantiatedModes.hasOwnProperty(e)){let t=this.getLanguageIdentifier(e)||ZJ;this._instantiatedModes[e]=new Pce(t),this._onDidCreateMode.fire(this._instantiatedModes[e])}return this._instantiatedModes[e]}}const Hce=i$("undoRedoService");class jce{constructor(e,t){this.resource=e,this.elements=t}}class Gce{constructor(){this.id=Gce._ID++,this.order=1}nextOrder(){return 0===this.id?0:this.order++}}Gce._ID=0,Gce.None=new Gce;class Kce{constructor(){this.id=Kce._ID++,this.order=1}nextOrder(){return 0===this.id?0:this.order++}}Kce._ID=0,Kce.None=new Kce;class qce{constructor(e,t,n){this._legend=e,this._themeService=t,this._logService=n,this._hashTable=new Xce,this._hasWarnedOverlappingTokens=!1}getMetadata(e,t,n){const i=this._hashTable.get(e,t,n.id);let r;if(i)r=i.metadata,this._logService.getLevel()===q1.Trace&&this._logService.trace(`SemanticTokensProviderStyling [CACHED] ${e} / ${t}: foreground ${pJ.getForeground(r)}, fontStyle ${pJ.getFontStyle(r).toString(2)}`);else{let i=this._legend.tokenTypes[e];const o=[];if(i){let e=t;for(let t=0;e>0&&t<this._legend.tokenModifiers.length;t++)1&e&&o.push(this._legend.tokenModifiers[t]),e>>=1;e>0&&this._logService.getLevel()===q1.Trace&&(this._logService.trace(`SemanticTokensProviderStyling: unknown token modifier index: ${t.toString(2)} for legend: ${JSON.stringify(this._legend.tokenModifiers)}`),o.push("not-in-legend"));const s=this._themeService.getColorTheme().getTokenStyleMetadata(i,o,n.language);if(void 0===s)r=2147483647;else{if(r=0,void 0!==s.italic){r|=1|(s.italic?1:0)<<11}if(void 0!==s.bold){r|=2|(s.bold?2:0)<<11}if(void 0!==s.underline){r|=4|(s.underline?4:0)<<11}if(s.foreground){r|=8|s.foreground<<14}0===r&&(r=2147483647)}}else this._logService.getLevel()===q1.Trace&&this._logService.trace(`SemanticTokensProviderStyling: unknown token type index: ${e} for legend: ${JSON.stringify(this._legend.tokenTypes)}`),r=2147483647,i="not-in-legend";this._hashTable.add(e,t,n.id,r),this._logService.getLevel()===q1.Trace&&this._logService.trace(`SemanticTokensProviderStyling ${e} (${i}) / ${t} (${o.join(" ")}): foreground ${pJ.getForeground(r)}, fontStyle ${pJ.getFontStyle(r).toString(2)}`)}return r}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,console.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}}function $ce(e,t,n){const i=e.data,r=e.data.length/5|0,o=Math.max(Math.ceil(r/1024),400),s=[];let a=0,l=1,c=0;for(;a<r;){const e=a;let u=Math.min(e+o,r);if(u<r){let t=u;for(;t-1>e&&0===i[5*t];)t--;if(t-1===e){let e=u;for(;e+1<r&&0===i[5*e];)e++;u=e}else u=t}let h=new Uint32Array(4*(u-e)),d=0,f=0,g=0,p=0,m=0;for(;a<u;){const e=5*a,r=i[e],o=i[e+1],s=l+r,u=0===r?c+o:o,v=i[e+2],y=i[e+3],_=i[e+4],b=t.getMetadata(y,_,n);2147483647!==b&&(0===f&&(f=s),g===s&&m>u&&(t.warnOverlappingSemanticTokens(s,u+1),p<u?h[d-4+2]=u:d-=4),h[d]=s-f,h[d+1]=u,h[d+2]=u+v,h[d+3]=b,d+=4,g=s,p=u,m=u+v),l=s,c=u,a++}d!==h.length&&(h=h.subarray(0,d));const v=new D8(f,new k8(h));s.push(v)}return s}class Yce{constructor(e,t,n,i){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=n,this.metadata=i,this.next=null}}class Xce{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=Xce._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Xce._SIZES.length?2/3*this._currentLength:0),this._elements=[],Xce._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let n=0;n<t;n++)e[n]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,n){return this._hash2(this._hash2(e,t),n)%this._currentLength}get(e,t,n){const i=this._hashFunc(e,t,n);let r=this._elements[i];for(;r;){if(r.tokenTypeIndex===e&&r.tokenModifierSet===t&&r.languageId===n)return r;r=r.next}return null}add(e,t,n,i){if(this._elementsCount++,0!==this._growCount&&this._elementsCount>=this._growCount){const e=this._elements;this._currentLengthIndex++,this._currentLength=Xce._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Xce._SIZES.length?2/3*this._currentLength:0),this._elements=[],Xce._nullOutEntries(this._elements,this._currentLength);for(const t of e){let e=t;for(;e;){const t=e.next;e.next=null,this._add(e),e=t}}}this._add(new Yce(e,t,n,i))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}}function Zce(e){const t=new Uint32Array(function(e){let t=0;if(t+=2,"full"===e.type)t+=1+e.data.length;else{t+=1,t+=3*e.deltas.length;for(const n of e.deltas)n.data&&(t+=n.data.length)}return t}(e));let n=0;if(t[n++]=e.id,"full"===e.type)t[n++]=1,t[n++]=e.data.length,t.set(e.data,n),n+=e.data.length;else{t[n++]=2,t[n++]=e.deltas.length;for(const i of e.deltas)t[n++]=i.start,t[n++]=i.deleteCount,i.data?(t[n++]=i.data.length,t.set(i.data,n),n+=i.data.length):t[n++]=0}return function(e){const t=new Uint8Array(e.buffer,e.byteOffset,4*e.length);return yj()||function(e){for(let t=0,n=e.length;t<n;t+=4){const n=e[t+0],i=e[t+1],r=e[t+2],o=e[t+3];e[t+0]=o,e[t+1]=r,e[t+2]=i,e[t+3]=n}}(t),uZ.wrap(t)}(t)}Xce._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];var Qce=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function Jce(e){return e&&!!e.data}function eue(e,t,n){const i=tue(e);return i?{provider:i,request:Promise.resolve(i.provideDocumentSemanticTokens(e,t,n))}:null}function tue(e){const t=qJ.ordered(e);return t.length>0?t[0]:null}function nue(e){const t=$J.ordered(e);return t.length>0?t[0]:null}qZ.registerCommand("_provideDocumentSemanticTokensLegend",((e,...t)=>Qce(void 0,void 0,void 0,(function*(){const[n]=t;WZ(n instanceof _K);const i=e.get(iJ).getModel(n);if(!i)return;const r=tue(i);return r?r.getLegend():e.get(KZ).executeCommand("_provideDocumentRangeSemanticTokensLegend",n)})))),qZ.registerCommand("_provideDocumentSemanticTokens",((e,...t)=>Qce(void 0,void 0,void 0,(function*(){const[n]=t;WZ(n instanceof _K);const i=e.get(iJ).getModel(n);if(!i)return;const r=eue(i,null,TG.None);if(!r)return e.get(KZ).executeCommand("_provideDocumentRangeSemanticTokens",n,i.getFullModelRange());const{provider:o,request:s}=r;let a;try{a=yield s}catch(c){return void iG(c)}if(!a||!Jce(a))return;const l=Zce({id:0,type:"full",data:a.data});return a.resultId&&o.releaseDocumentSemanticTokens(a.resultId),l})))),qZ.registerCommand("_provideDocumentRangeSemanticTokensLegend",((e,...t)=>Qce(void 0,void 0,void 0,(function*(){const[n]=t;WZ(n instanceof _K);const i=e.get(iJ).getModel(n);if(!i)return;const r=nue(i);return r?r.getLegend():void 0})))),qZ.registerCommand("_provideDocumentRangeSemanticTokens",((e,...t)=>Qce(void 0,void 0,void 0,(function*(){const[n,i]=t;WZ(n instanceof _K),WZ(TK.isIRange(i));const r=e.get(iJ).getModel(n);if(!r)return;const o=nue(r);if(!o)return;let s;try{s=yield o.provideDocumentRangeSemanticTokens(r,TK.lift(i),TG.None)}catch(a){return void iG(a)}return s&&Jce(s)?Zce({id:0,type:"full",data:s.data}):void 0}))));var iue=function(e,t){return function(n,i){t(n,i,e)}};function rue(e){return e.toString()}function oue(e){const t=new OQ,n=e.createSnapshot();let i;for(;i=n.read();)t.update(i);return t.digest()}class sue{constructor(e,t,n){this._modelEventListeners=new pG,this.model=e,this._languageSelection=null,this._languageSelectionListener=null,this._modelEventListeners.add(e.onWillDispose((()=>t(e)))),this._modelEventListeners.add(e.onDidChangeLanguage((t=>n(e,t))))}_disposeLanguageSelection(){this._languageSelectionListener&&(this._languageSelectionListener.dispose(),this._languageSelectionListener=null)}dispose(){this._modelEventListeners.dispose(),this._disposeLanguageSelection()}setLanguage(e){this._disposeLanguageSelection(),this._languageSelection=e,this._languageSelectionListener=this._languageSelection.onDidChange((()=>this.model.setMode(e.languageIdentifier))),this.model.setMode(e.languageIdentifier)}}const aue=cj||lj?1:2;class lue{constructor(e,t,n,i,r,o,s,a){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=n,this.sharesUndoRedoStack=i,this.heapSize=r,this.sha1=o,this.versionId=s,this.alternativeVersionId=a}}let cue=class e extends mG{constructor(e,t,n,i,r){super(),this._configurationService=e,this._resourcePropertiesService=t,this._themeService=n,this._logService=i,this._undoRedoService=r,this._onModelAdded=this._register(new EG),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new EG),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new EG),this.onModelModeChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._semanticStyling=this._register(new due(this._themeService,this._logService)),this._register(this._configurationService.onDidChangeConfiguration((()=>this._updateModelOptions()))),this._updateModelOptions(),this._register(new hue(this,this._themeService,this._configurationService,this._semanticStyling))}static _readModelOptions(e,t){let n=Kj;if(e.editor&&void 0!==e.editor.tabSize){const t=parseInt(e.editor.tabSize,10);isNaN(t)||(n=t),n<1&&(n=1)}let i=n;if(e.editor&&void 0!==e.editor.indentSize&&"tabSize"!==e.editor.indentSize){const t=parseInt(e.editor.indentSize,10);isNaN(t)||(i=t),i<1&&(i=1)}let r=$j;e.editor&&void 0!==e.editor.insertSpaces&&(r="false"!==e.editor.insertSpaces&&Boolean(e.editor.insertSpaces));let o=aue;const s=e.eol;"\r\n"===s?o=2:"\n"===s&&(o=1);let a=Xj;e.editor&&void 0!==e.editor.trimAutoWhitespace&&(a="false"!==e.editor.trimAutoWhitespace&&Boolean(e.editor.trimAutoWhitespace));let l=Yj;e.editor&&void 0!==e.editor.detectIndentation&&(l="false"!==e.editor.detectIndentation&&Boolean(e.editor.detectIndentation));let c=Zj;return e.editor&&void 0!==e.editor.largeFileOptimizations&&(c="false"!==e.editor.largeFileOptimizations&&Boolean(e.editor.largeFileOptimizations)),{isForSimpleWidget:t,tabSize:n,indentSize:i,insertSpaces:r,detectIndentation:l,defaultEOL:o,trimAutoWhitespace:a,largeFileOptimizations:c}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const n=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return n&&"auto"!==n?n:3===pj||2===pj?"\n":"\r\n"}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return"boolean"!=typeof e||e}getCreationOptions(t,n,i){let r=this._modelCreationOptionsByLanguageAndResource[t+n];if(!r){const o=this._configurationService.getValue("editor",{overrideIdentifier:t,resource:n}),s=this._getEOL(n,t);r=e._readModelOptions({editor:o,eol:s},i),this._modelCreationOptionsByLanguageAndResource[t+n]=r}return r}_updateModelOptions(){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const n=Object.keys(this._models);for(let i=0,r=n.length;i<r;i++){const r=n[i],o=this._models[r],s=o.model.getLanguageIdentifier().language,a=o.model.uri,l=t[s+a],c=this.getCreationOptions(s,a,o.model.isForSimpleWidget);e._setModelOptionsForModel(o.model,c,l)}}static _setModelOptionsForModel(e,t,n){n&&n.defaultEOL!==t.defaultEOL&&1===e.getLineCount()&&e.setEOL(1===t.defaultEOL?0:1),n&&n.detectIndentation===t.detectIndentation&&n.insertSpaces===t.insertSpaces&&n.tabSize===t.tabSize&&n.indentSize===t.indentSize&&n.trimAutoWhitespace===t.trimAutoWhitespace||(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace}))}_insertDisposedModel(e){this._disposedModels.set(rue(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(rue(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(rue(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach((e=>{e.sharesUndoRedoStack||t.push(e)})),t.sort(((e,t)=>e.time-t.time));t.length>0&&this._disposedModelsHeapSize>e;){const e=t.shift();this._removeDisposedModel(e.uri),null!==e.initialUndoRedoSnapshot&&this._undoRedoService.restoreSnapshot(e.initialUndoRedoSnapshot)}}}_createModelData(e,t,n,i){const r=this.getCreationOptions(t.language,n,i),o=new l7(e,r,t,n,this._undoRedoService);if(n&&this._disposedModels.has(rue(n))){const e=this._removeDisposedModel(n),t=this._undoRedoService.getElements(n),i=oue(o)===e.sha1;if(i||e.sharesUndoRedoStack){for(const e of t.past)_9(e)&&e.matchesResource(n)&&e.setModel(o);for(const e of t.future)_9(e)&&e.matchesResource(n)&&e.setModel(o);this._undoRedoService.setElementsValidFlag(n,!0,(e=>_9(e)&&e.matchesResource(n))),i&&(o._overwriteVersionId(e.versionId),o._overwriteAlternativeVersionId(e.alternativeVersionId),o._overwriteInitialUndoRedoSnapshot(e.initialUndoRedoSnapshot))}else null!==e.initialUndoRedoSnapshot&&this._undoRedoService.restoreSnapshot(e.initialUndoRedoSnapshot)}const s=rue(o.uri);if(this._models[s])throw new Error("ModelService: Cannot add model because it already exists!");const a=new sue(o,(e=>this._onWillDispose(e)),((e,t)=>this._onDidChangeLanguage(e,t)));return this._models[s]=a,a}createModel(e,t,n,i=!1){let r;return t?(r=this._createModelData(e,t.languageIdentifier,n,i),this.setMode(r.model,t)):r=this._createModelData(e,Bce,n,i),this._onModelAdded.fire(r.model),r.model}setMode(e,t){if(!t)return;const n=this._models[rue(e.uri)];n&&n.setLanguage(t)}getModels(){const e=[],t=Object.keys(this._models);for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(this._models[i].model)}return e}getModel(e){const t=rue(e),n=this._models[t];return n?n.model:null}getSemanticTokensProviderStyling(e){return this._semanticStyling.get(e)}_onWillDispose(t){const n=rue(t.uri),i=this._models[n],r=this._undoRedoService.getUriComparisonKey(t.uri)!==t.uri.toString();let o=!1,s=0;if(r||this._shouldRestoreUndoStack()&&((a=t.uri).scheme===j$.file||a.scheme===j$.vscodeRemote||a.scheme===j$.userData||"fake-fs"===a.scheme)){const e=this._undoRedoService.getElements(t.uri);if(e.past.length>0||e.future.length>0){for(const n of e.past)_9(n)&&n.matchesResource(t.uri)&&(o=!0,s+=n.heapSize(t.uri),n.setModel(t.uri));for(const n of e.future)_9(n)&&n.matchesResource(t.uri)&&(o=!0,s+=n.heapSize(t.uri),n.setModel(t.uri))}}var a;const l=e.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK;if(o)if(!r&&s>l){const e=i.model.getInitialUndoRedoSnapshot();null!==e&&this._undoRedoService.restoreSnapshot(e)}else this._ensureDisposedModelsHeapSize(l-s),this._undoRedoService.setElementsValidFlag(t.uri,!1,(e=>_9(e)&&e.matchesResource(t.uri))),this._insertDisposedModel(new lue(t.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),r,s,oue(t),t.getVersionId(),t.getAlternativeVersionId()));else if(!r){const e=i.model.getInitialUndoRedoSnapshot();null!==e&&this._undoRedoService.restoreSnapshot(e)}delete this._models[n],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[t.getLanguageIdentifier().language+t.uri],this._onModelRemoved.fire(t)}_onDidChangeLanguage(t,n){const i=n.oldLanguage,r=t.getLanguageIdentifier().language,o=this.getCreationOptions(i,t.uri,t.isForSimpleWidget),s=this.getCreationOptions(r,t.uri,t.isForSimpleWidget);e._setModelOptionsForModel(t,s,o),this._onModelModeChanged.fire({model:t,oldModeId:i})}};cue.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20971520,cue=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([iue(0,j3),iue(1,k1),iue(2,B5),iue(3,K1),iue(4,Hce)],cue);function uue(e,t,n){var i;const r=null===(i=n.getValue("editor.semanticHighlighting",{overrideIdentifier:e.getLanguageIdentifier().language,resource:e.uri}))||void 0===i?void 0:i.enabled;return"boolean"==typeof r?r:t.getColorTheme().semanticHighlighting}class hue extends mG{constructor(e,t,n,i){super(),this._watchers=Object.create(null),this._semanticStyling=i;const r=e=>{this._watchers[e.uri.toString()]=new gue(e,t,this._semanticStyling)},o=(e,t)=>{t.dispose(),delete this._watchers[e.uri.toString()]},s=()=>{for(let i of e.getModels()){const e=this._watchers[i.uri.toString()];uue(i,t,n)?e||r(i):e&&o(i,e)}};this._register(e.onModelAdded((e=>{uue(e,t,n)&&r(e)}))),this._register(e.onModelRemoved((e=>{const t=this._watchers[e.uri.toString()];t&&o(e,t)}))),this._register(n.onDidChangeConfiguration((e=>{e.affectsConfiguration("editor.semanticHighlighting")&&s()}))),this._register(t.onDidColorThemeChange(s))}}class due extends mG{constructor(e,t){super(),this._themeService=e,this._logService=t,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange((()=>{this._caches=new WeakMap})))}get(e){return this._caches.has(e)||this._caches.set(e,new qce(e.getLegend(),this._themeService,this._logService)),this._caches.get(e)}}class fue{constructor(e,t,n){this._provider=e,this.resultId=t,this.data=n}dispose(){this._provider.releaseDocumentSemanticTokens(this.resultId)}}class gue extends mG{constructor(e,t,n){super(),this._isDisposed=!1,this._model=e,this._semanticStyling=n,this._fetchDocumentSemanticTokens=this._register(new z$((()=>this._fetchDocumentSemanticTokensNow()),gue.FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._register(this._model.onDidChangeContent((()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule()}))),this._register(this._model.onDidChangeLanguage((()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)})));const i=()=>{dG(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const t of qJ.all(e))"function"==typeof t.onDidChange&&this._documentProvidersChangeListeners.push(t.onDidChange((()=>this._fetchDocumentSemanticTokens.schedule(0))))};i(),this._register(qJ.onDidChange((()=>{i(),this._fetchDocumentSemanticTokens.schedule()}))),this._register(t.onDidColorThemeChange((e=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule()}))),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;const e=new OG,t=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,n=eue(this._model,t,e.token);if(!n)return void(this._currentDocumentResponse&&this._model.setSemanticTokens(null,!1));const{provider:i,request:r}=n;this._currentDocumentRequestCancellationTokenSource=e;const o=[],s=this._model.onDidChangeContent((e=>{o.push(e)})),a=this._semanticStyling.get(i);r.then((e=>{this._currentDocumentRequestCancellationTokenSource=null,s.dispose(),this._setDocumentSemanticTokens(i,e||null,a,o)}),(e=>{e&&(oG(e)||"string"==typeof e.message&&-1!==e.message.indexOf("busy"))||nG(e),this._currentDocumentRequestCancellationTokenSource=null,s.dispose(),o.length>0&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule())}))}static _copy(e,t,n,i,r){for(let o=0;o<r;o++)n[i+o]=e[t+o]}_setDocumentSemanticTokens(e,t,n,i){const r=this._currentDocumentResponse,o=()=>{i.length>0&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule()};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed)e&&t&&e.releaseDocumentSemanticTokens(t.resultId);else if(e&&n){if(!t)return this._model.setSemanticTokens(null,!0),void o();if((s=t)&&Array.isArray(s.edits)){if(!r)return void this._model.setSemanticTokens(null,!0);if(0===t.edits.length)t={resultId:t.resultId,data:r.data};else{let e=0;for(const r of t.edits)e+=(r.data?r.data.length:0)-r.deleteCount;const n=r.data,i=new Uint32Array(n.length+e);let o=n.length,s=i.length;for(let r=t.edits.length-1;r>=0;r--){const e=t.edits[r],a=o-(e.start+e.deleteCount);a>0&&(gue._copy(n,o-a,i,s-a,a),s-=a),e.data&&(gue._copy(e.data,0,i,s-e.data.length,e.data.length),s-=e.data.length),o=e.start}o>0&&gue._copy(n,0,i,0,o),t={resultId:t.resultId,data:i}}}var s;if(Jce(t)){this._currentDocumentResponse=new fue(e,t.resultId,t.data);const r=$ce(t,n,this._model.getLanguageIdentifier());if(i.length>0)for(const e of i)for(const t of r)for(const n of e.changes)t.applyEdit(n.range,n.text);this._model.setSemanticTokens(r,!0)}else this._model.setSemanticTokens(null,!0);o()}else this._model.setSemanticTokens(null,!1)}}gue.FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY=300;class pue{constructor(e,t,n,i,r){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=n,this.foreground=i,this.background=r}}const mue=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class vue{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(null===e)return 0;const t=e.match(mue);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let n=this._color2id.get(e);return n||(n=++this._lastColorId,this._color2id.set(e,n),this._id2color[n]=Q8.fromHex("#"+e),n)}getColorMap(){return this._id2color.slice(0)}}class yue{constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(function(e){if(!e||!Array.isArray(e))return[];let t=[],n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i],o=-1;if("string"==typeof r.fontStyle){o=0;let e=r.fontStyle.split(" ");for(let t=0,n=e.length;t<n;t++)switch(e[t]){case"italic":o|=1;break;case"bold":o|=2;break;case"underline":o|=4}}let s=null;"string"==typeof r.foreground&&(s=r.foreground);let a=null;"string"==typeof r.background&&(a=r.background),t[n++]=new pue(r.token||"",i,o,s,a)}return t}(e),t)}static createFromParsedTokenTheme(e,t){return function(e,t){e.sort(((e,t)=>{let n=function(e,t){return e<t?-1:e>t?1:0}(e.token,t.token);return 0!==n?n:e.index-t.index}));let n=0,i="000000",r="ffffff";for(;e.length>=1&&""===e[0].token;){let t=e.shift();-1!==t.fontStyle&&(n=t.fontStyle),null!==t.foreground&&(i=t.foreground),null!==t.background&&(r=t.background)}let o=new vue;for(let u of t)o.getId(u);let s=o.getId(i),a=o.getId(r),l=new bue(n,s,a),c=new wue(l);for(let u=0,h=e.length;u<h;u++){let t=e[u];c.insert(t.token,t.fontStyle,o.getId(t.foreground),o.getId(t.background))}return new yue(o,c)}(e,t)}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let n=this._cache.get(t);if(void 0===n){let e=this._match(t),i=function(e){let t=e.match(_ue);if(!t)return 0;switch(t[1]){case"comment":return 1;case"string":return 2;case"regex":case"regexp":return 4}throw new Error("Unexpected match for standard token type!")}(t);n=(e.metadata|i<<8)>>>0,this._cache.set(t,n)}return(n|e<<0)>>>0}}const _ue=/\b(comment|string|regex|regexp)\b/;class bue{constructor(e,t,n){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=n,this.metadata=(this._fontStyle<<11|this._foreground<<14|this._background<<23)>>>0}clone(){return new bue(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,n){-1!==e&&(this._fontStyle=e),0!==t&&(this._foreground=t),0!==n&&(this._background=n),this.metadata=(this._fontStyle<<11|this._foreground<<14|this._background<<23)>>>0}}class wue{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(""===e)return this._mainRule;let t,n,i=e.indexOf(".");-1===i?(t=e,n=""):(t=e.substring(0,i),n=e.substring(i+1));let r=this._children.get(t);return void 0!==r?r.match(n):this._mainRule}insert(e,t,n,i){if(""===e)return void this._mainRule.acceptOverwrite(t,n,i);let r,o,s=e.indexOf(".");-1===s?(r=e,o=""):(r=e.substring(0,s),o=e.substring(s+1));let a=this._children.get(r);void 0===a&&(a=new wue(this._mainRule.clone()),this._children.set(r,a)),a.insert(o,t,n,i)}}const Cue={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[gte]:"#FFFFFE",[pte]:"#000000",[Tte]:"#E5EBF1",[vie]:"#D3D3D3",[yie]:"#939393",[Mte]:"#ADD6FF4D",[_ne]:"#9DDDFF"}},Sue={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[gte]:"#1E1E1E",[pte]:"#D4D4D4",[Tte]:"#3A3D41",[vie]:"#404040",[yie]:"#707070",[Mte]:"#ADD6FF26"}},xue={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[gte]:"#000000",[pte]:"#FFFFFF",[vie]:"#FFFFFF",[yie]:"#FFFFFF"}};function Eue(){const e=new EG,t=xle;return t.onDidChange((()=>e.fire())),{onDidChange:e.event,getCSS(){const e={},n=n=>{let i=n.defaults;for(;z5.isThemeIcon(i);){const e=t.getIcon(i.id);if(!e)return;i=e.defaults}const r=i.fontId;if(r){const o=t.getIconFont(r);if(o)return e[r]=o,`.codicon-${n.id}:before { content: '${i.fontCharacter}'; font-family: ${QY(r)}; }`}return`.codicon-${n.id}:before { content: '${i.fontCharacter}'; }`},i=[];for(let r of t.getIcons()){const e=n(r);e&&i.push(e)}for(let t in e){const n=e[t].definition.src.map((e=>`${ZY(e.location)} format('${e.format}')`)).join(", ");i.push(`@font-face { src: ${n}; font-family: ${QY(t)}; }`)}return i.join("\n")}}}const kue=d3.as(vee),Lue=d3.as(H5);class Due{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;let n=t.base;e.length>0?(Nue(e)?this.id=e:this.id=n+" "+e,this.themeName=e):(this.id=n,this.themeName=n),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(let t in this.themeData.colors)e.set(t,Q8.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){let t=Iue(this.themeData.base);for(let n in t.colors)e.has(n)||e.set(n,Q8.fromHex(t.colors[n]))}this.colors=e}return this.colors}getColor(e,t){const n=this.getColors().get(e);return n||(!1!==t?this.getDefault(e):void 0)}getDefault(e){let t=this.defaultColors[e];return t||(t=kue.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return Object.prototype.hasOwnProperty.call(this.getColors(),e)}get type(){switch(this.base){case"vs":return P5.LIGHT;case"hc-black":return P5.HIGH_CONTRAST;default:return P5.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){let n=Iue(this.themeData.base);e=n.rules,n.encodedTokensColors&&(t=n.encodedTokensColors)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=yue.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,n){const i=this.tokenTheme._match([e].concat(t).join(".")).metadata,r=pJ.getForeground(i),o=pJ.getFontStyle(i);return{foreground:r,italic:Boolean(1&o),bold:Boolean(2&o),underline:Boolean(4&o)}}}function Nue(e){return"vs"===e||"vs-dark"===e||"hc-black"===e}function Iue(e){switch(e){case"vs":return Cue;case"vs-dark":return Sue;case"hc-black":return xue}}function Tue(e){let t=Iue(e);return new Due(e,t)}class Mue extends mG{constructor(){super(),this._onColorThemeChange=this._register(new EG),this.onDidColorThemeChange=this._onColorThemeChange.event,this._environment=Object.create(null),this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set("vs",Tue("vs")),this._knownThemes.set("vs-dark",Tue("vs-dark")),this._knownThemes.set("hc-black",Tue("hc-black"));const e=Eue();this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}\n${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme("vs"),e.onDidChange((()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),function(e,t){const n=window.matchMedia(e);"function"==typeof n.addEventListener?n.addEventListener("change",t):n.addListener(t)}("(forced-colors: active)",(()=>{this._updateActualTheme()}))}registerEditorContainer(e){return kY(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=NY(),this._globalStyleElement.className="monaco-colors",this._globalStyleElement.textContent=this._allCSS,this._styleElements.push(this._globalStyleElement)),mG.None}_registerShadowDomContainer(e){const t=NY(e);return t.className="monaco-colors",t.textContent=this._allCSS,this._styleElements.push(t),{dispose:()=>{for(let e=0;e<this._styleElements.length;e++)if(this._styleElements[e]===t)return void this._styleElements.splice(e,1)}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!Nue(t.base)&&!Nue(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new Due(e,t)),Nue(e)&&this._knownThemes.forEach((t=>{t.base===e&&t.notifyBaseUpdated()})),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;t=this._knownThemes.has(e)?this._knownThemes.get(e):this._knownThemes.get("vs"),this._desiredTheme=t,this._updateActualTheme()}_updateActualTheme(){const e=this._autoDetectHighContrast&&window.matchMedia("(forced-colors: active)").matches?this._knownThemes.get("hc-black"):this._desiredTheme;this._theme!==e&&(this._theme=e,this._updateThemeOrColorMap())}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._updateActualTheme()}_updateThemeOrColorMap(){let e=[],t={},n={addRule:n=>{t[n]||(e.push(n),t[n]=!0)}};Lue.getThemingParticipants().forEach((e=>e(this._theme,n,this._environment)));const i=this._colorMapOverride||this._theme.tokenTheme.getColorMap();n.addRule(function(e){let t=[];for(let n=1,i=e.length;n<i;n++){let i=e[n];t[n]=`.mtk${n} { color: ${i}; }`}return t.push(".mtki { font-style: italic; }"),t.push(".mtkb { font-weight: bold; }"),t.push(".mtku { text-decoration: underline; text-underline-position: under; }"),t.join("\n")}(i)),this._themeCSS=e.join("\n"),this._updateCSS(),YJ.setColorMap(i),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}\n${this._themeCSS}`,this._styleElements.forEach((e=>e.textContent=this._allCSS))}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}}class Aue{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}setValue(e,t){return this._value[e]!==t&&(this._value[e]=t,!0)}removeValue(e){return e in this._value&&(delete this._value[e],!0)}getValue(e){const t=this._value[e];return void 0===t&&this._parent?this._parent.getValue(e):t}}class Oue extends Aue{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}}Oue.INSTANCE=new Oue;class Rue extends Aue{constructor(e,t,n){super(e,null),this._configurationService=t,this._values=iZ.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration((e=>{if(6===e.source){const e=Array.from(lG.map(this._values,(([e])=>e)));this._values.clear(),n.fire(new Bue(e))}else{const t=[];for(const n of e.affectedKeys){const e=`config.${n}`,i=this._values.findSuperstr(e);void 0!==i&&(t.push(...lG.map(i,(([e])=>e))),this._values.deleteSuperstr(e)),this._values.has(e)&&(t.push(e),this._values.delete(e))}n.fire(new Bue(t))}}))}dispose(){this._listener.dispose()}getValue(e){if(0!==e.indexOf(Rue._keyPrefix))return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(Rue._keyPrefix.length),n=this._configurationService.getValue(t);let i;switch(typeof n){case"number":case"boolean":case"string":i=n;break;default:i=Array.isArray(n)?JSON.stringify(n):n}return this._values.set(e,i),i}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}}Rue._keyPrefix="config.";class Pue{constructor(e,t,n){this._service=e,this._key=t,this._defaultValue=n,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){void 0===this._defaultValue?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class Fue{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}}class Bue{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}}class Wue{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}}class zue{constructor(e){this._onDidChangeContext=new kG({merge:e=>new Wue(e)}),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new Pue(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new Uue(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return t4.contextMatchesRules(t,e)}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const n=this.getContextValuesContainer(this._myContextId);n&&n.setValue(e,t)&&this._onDidChangeContext.fire(new Fue(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new Fue(e))}getContext(e){return this._isDisposed?Oue.INSTANCE:this.getContextValuesContainer(function(e){for(;e;){if(e.hasAttribute("data-keybinding-context")){const t=e.getAttribute("data-keybinding-context");return t?parseInt(t,10):NaN}e=e.parentElement}return 0}(e))}}let Vue=class extends zue{constructor(e){super(0),this._contexts=new Map,this._toDispose=new pG,this._lastContextId=0;const t=new Rue(this._myContextId,e,this._onDidChangeContext);this._contexts.set(this._myContextId,t),this._toDispose.add(t)}dispose(){this._onDidChangeContext.dispose(),this._isDisposed=!0,this._toDispose.dispose()}getContextValuesContainer(e){return this._isDisposed?Oue.INSTANCE:this._contexts.get(e)||Oue.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");let t=++this._lastContextId;return this._contexts.set(t,new Aue(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};Vue=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(0,j3)],Vue);class Uue extends zue{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=new vG,this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute("data-keybinding-context")){let e="";this._domNode.classList&&(e=Array.from(this._domNode.classList.values()).join(", ")),console.error("Element already has context attribute"+(e?": "+e:""))}this._domNode.setAttribute("data-keybinding-context",String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(this._onDidChangeContext.fire,this._onDidChangeContext)}dispose(){this._isDisposed||(this._onDidChangeContext.dispose(),this._parent.disposeContext(this._myContextId),this._parentChangeListener.dispose(),this._domNode.removeAttribute("data-keybinding-context"),this._isDisposed=!0)}getContextValuesContainer(e){return this._isDisposed?Oue.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}qZ.registerCommand("setContext",(function(e,t,n){e.get(A5).createKey(String(t),n)})),qZ.registerCommand({id:"getContextKeyInfo",handler:()=>[...M5.all()].sort(((e,t)=>e.key.localeCompare(t.key))),description:{description:GH(0,"A command that returns information about context keys"),args:[]}}),qZ.registerCommand("_generateContextKeyInfo",(function(){const e=[],t=new Set;for(let n of M5.all())t.has(n.key)||(t.add(n.key),e.push(n));e.sort(((e,t)=>e.key.localeCompare(t.key))),console.log(JSON.stringify(e,void 0,2))}));var Hue,jue,Gue;function Kue(e,t,n){const i=n.mode===jue.ALIGN?n.offset:n.offset+n.size,r=n.mode===jue.ALIGN?n.offset+n.size:n.offset;return 0===n.position?t<=e-i?i:t<=r?r-t:Math.max(e-t,0):t<=r?r-t:t<=e-i?i:0}!function(e){function t(e,t){if(e.start>=t.end||t.start>=e.end)return{start:0,end:0};const n=Math.max(e.start,t.start),i=Math.min(e.end,t.end);return i-n<=0?{start:0,end:0}:{start:n,end:i}}function n(e){return e.end-e.start<=0}e.intersect=t,e.isEmpty=n,e.intersects=function(e,i){return!n(t(e,i))},e.relativeComplement=function(e,t){const i=[],r={start:e.start,end:Math.min(t.start,e.end)},o={start:Math.max(t.end,e.start),end:e.end};return n(r)||i.push(r),n(o)||i.push(o),i}}(Hue||(Hue={})),(Gue=jue||(jue={}))[Gue.AVOID=0]="AVOID",Gue[Gue.ALIGN=1]="ALIGN";class que extends mG{constructor(e,t){super(),this.container=null,this.delegate=null,this.toDisposeOnClean=mG.None,this.toDisposeOnSetContainer=mG.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=GY(".context-view"),this.useFixedPosition=!1,this.useShadowDOM=!1,qY(this.view),this.setContainer(e,t),this._register(gG((()=>this.setContainer(null,1))))}setContainer(e,t){var n;if(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,null===(n=this.shadowRootHostElement)||void 0===n||n.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),e){if(this.container=e,this.useFixedPosition=1!==t,this.useShadowDOM=3===t,this.useShadowDOM){this.shadowRootHostElement=GY(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const e=document.createElement("style");e.textContent=$ue,this.shadowRoot.appendChild(e),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(GY("slot"))}else this.container.appendChild(this.view);const n=new pG;que.BUBBLE_UP_EVENTS.forEach((e=>{n.add(eY(this.container,e,(e=>{this.onDOMEvent(e,!1)})))})),que.BUBBLE_DOWN_EVENTS.forEach((e=>{n.add(eY(this.container,e,(e=>{this.onDOMEvent(e,!0)}),!0))})),this.toDisposeOnSetContainer=n}}show(e){this.isVisible()&&this.hide(),Y$(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex="2500",this.view.style.position=this.useFixedPosition?"fixed":"absolute",KY(this.view),this.toDisposeOnClean=e.render(this.view)||mG.None,this.delegate=e,this.doLayout(),this.delegate.focus&&this.delegate.focus()}getViewElement(){return this.view}layout(){this.isVisible()&&(!1!==this.delegate.canRelayout||dj&&$$?(this.delegate.layout&&this.delegate.layout(),this.doLayout()):this.hide())}doLayout(){if(!this.isVisible())return;let e,t=this.delegate.getAnchor();if(OY(t)){let n=mY(t);e={top:n.top,left:n.left,width:n.width,height:n.height}}else e={top:t.y,left:t.x,width:t.width||1,height:t.height||2};const n=yY(this.view),i=wY(this.view),r=this.delegate.anchorPosition||0,o=this.delegate.anchorAlignment||0;let s,a;if(0===(this.delegate.anchorAxisAlignment||0)){const t={offset:e.top-window.pageYOffset,size:e.height,position:0===r?0:1},l={offset:e.left,size:e.width,position:0===o?0:1,mode:jue.ALIGN};s=Kue(window.innerHeight,i,t)+window.pageYOffset,Hue.intersects({start:s,end:s+i},{start:t.offset,end:t.offset+t.size})&&(l.mode=jue.AVOID),a=Kue(window.innerWidth,n,l)}else{const t={offset:e.left,size:e.width,position:0===o?0:1},l={offset:e.top,size:e.height,position:0===r?0:1,mode:jue.ALIGN};a=Kue(window.innerWidth,n,t),Hue.intersects({start:a,end:a+n},{start:t.offset,end:t.offset+t.size})&&(l.mode=jue.AVOID),s=Kue(window.innerHeight,i,l)+window.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(0===r?"bottom":"top"),this.view.classList.add(0===o?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const l=mY(this.container);this.view.style.top=s-(this.useFixedPosition?mY(this.view).top:l.top)+"px",this.view.style.left=a-(this.useFixedPosition?mY(this.view).left:l.left)+"px",this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,(null==t?void 0:t.onHide)&&t.onHide(e),this.toDisposeOnClean.dispose(),qY(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,document.activeElement):t&&!CY(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}que.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],que.BUBBLE_DOWN_EVENTS=["click"];let $ue='\n\t:host {\n\t\tall: initial; /* 1st rule so subsequent properties are reset. */\n\t}\n\n\t@font-face {\n\t\tfont-family: "codicon";\n\t\tsrc: url("./codicon.ttf?5d4d76ab2ce5108968ad644d591a16a6") format("truetype");\n\t}\n\n\t.codicon[class*=\'codicon-\'] {\n\t\tfont: normal normal normal 16px/1 codicon;\n\t\tdisplay: inline-block;\n\t\ttext-decoration: none;\n\t\ttext-rendering: auto;\n\t\ttext-align: center;\n\t\t-webkit-font-smoothing: antialiased;\n\t\t-moz-osx-font-smoothing: grayscale;\n\t\tuser-select: none;\n\t\t-webkit-user-select: none;\n\t\t-ms-user-select: none;\n\t}\n\n\t:host {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;\n\t}\n\n\t:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }\n\t:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }\n\t:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }\n\t:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }\n\t:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }\n\n\t:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }\n\t:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }\n\t:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }\n\t:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }\n\t:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }\n\n\t:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }\n\t:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }\n';function Yue(e){let t=e.definition;for(;t instanceof hJ;)t=t.definition;return`.codicon-${e.id}:before { content: '${t.fontCharacter}'; }`}function Xue(...e){return function(t,n){for(let i=0,r=e.length;i<r;i++){const r=e[i](t,n);if(r)return r}return null}}const Zue=function(e,t,n){if(!n||n.length<t.length)return null;let i;i=e?SX(n,t):0===n.indexOf(t);if(!i)return null;return t.length>0?[{start:0,end:t.length}]:[]}.bind(void 0,!0);function Que(e,t){const n=t.toLowerCase().indexOf(e.toLowerCase());return-1===n?null:[{start:n,end:n+e.length}]}function Jue(e,t,n,i){if(n===e.length)return[];if(i===t.length)return null;if(e[n]===t[i]){let r=null;return(r=Jue(e,t,n+1,i+1))?ahe({start:i,end:i+1},r):null}return Jue(e,t,n,i+1)}function ehe(e){return 97<=e&&e<=122}function the(e){return 65<=e&&e<=90}function nhe(e){return 48<=e&&e<=57}function ihe(e){return 32===e||9===e||10===e||13===e}const rhe=new Set;function ohe(e){return ihe(e)||rhe.has(e)}function she(e){return ehe(e)||the(e)||nhe(e)}function ahe(e,t){return 0===t.length?t=[e]:e.end===t[0].start?t[0].start=e.start:t.unshift(e),t}function lhe(e,t){for(let n=t;n<e.length;n++){const t=e.charCodeAt(n);if(the(t)||nhe(t)||n>0&&!she(e.charCodeAt(n-1)))return n}return e.length}function che(e,t,n,i){if(n===e.length)return[];if(i===t.length)return null;if(e[n]!==t[i].toLowerCase())return null;{let r=null,o=i+1;for(r=che(e,t,n+1,i+1);!r&&(o=lhe(t,o))<t.length;)r=che(e,t,n+1,o),o++;return null===r?null:ahe({start:i,end:i+1},r)}}function uhe(e,t){if(!t)return null;if(0===(t=t.trim()).length)return null;if(!function(e){let t=0,n=0,i=0,r=0;for(let o=0;o<e.length;o++)i=e.charCodeAt(o),the(i)&&t++,ehe(i)&&n++,ihe(i)&&r++;return 0!==t&&0!==n||0!==r?t<=5:e.length<=30}(e))return null;if(t.length>60)return null;const n=function(e){let t=0,n=0,i=0,r=0,o=0;for(let s=0;s<e.length;s++)o=e.charCodeAt(s),the(o)&&t++,ehe(o)&&n++,she(o)&&i++,nhe(o)&&r++;return{upperPercent:t/e.length,lowerPercent:n/e.length,alphaPercent:i/e.length,numericPercent:r/e.length}}(t);if(!function(e){const{upperPercent:t,lowerPercent:n,alphaPercent:i,numericPercent:r}=e;return n>.2&&t<.8&&i>.6&&r<.2}(n)){if(!function(e){const{upperPercent:t,lowerPercent:n}=e;return 0===n&&t>.6}(n))return null;t=t.toLowerCase()}let i=null,r=0;for(e=e.toLowerCase();r<t.length&&null===(i=che(e,t,0,r));)r=lhe(t,r+1);return i}function hhe(e,t,n,i,r){if(n===e.length)return[];if(i===t.length)return null;if(o=e.charCodeAt(n),s=t.charCodeAt(i),o===s||ohe(o)&&ohe(s)){let o=null,s=i+1;if(o=hhe(e,t,n+1,i+1,r),!r)for(;!o&&(s=dhe(t,s))<t.length;)o=hhe(e,t,n+1,s,r),s++;return null===o?null:ahe({start:i,end:i+1},o)}return null;var o,s}function dhe(e,t){for(let n=t;n<e.length;n++)if(ohe(e.charCodeAt(n))||n>0&&ohe(e.charCodeAt(n-1)))return n;return e.length}"`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?".split("").forEach((e=>rhe.add(e.charCodeAt(0))));const fhe=Xue(Zue,uhe,Que),ghe=Xue(Zue,uhe,(function(e,t){return Jue(e.toLowerCase(),t.toLowerCase(),0,0)})),phe=new sZ(1e4);function mhe(e,t,n=!1){if("string"!=typeof e||"string"!=typeof t)return null;let i=phe.get(e);i||(i=new RegExp(e.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*"),"i"),phe.set(e,i));const r=i.exec(t);return r?[{start:r.index,end:r.index+r[0].length}]:n?ghe(e,t):fhe(e,t)}function vhe(e,t,n,i,r,o){const s=Math.min(13,e.length);for(;n<s;n++){const s=The(e,t,n,i,r,o,!1);if(s)return s}return[0,o]}function yhe(e){if(void 0===e)return[];const t=[],n=e[1];for(let i=e.length-1;i>1;i--){const r=e[i]+n,o=t[t.length-1];o&&o.end===r?o.end=r+1:t.push({start:r,end:r+1})}return t}function _he(){const e=[],t=[];for(let n=0;n<=128;n++)t[n]=0;for(let n=0;n<=128;n++)e.push(t.slice(0));return e}function bhe(e){const t=[];for(let n=0;n<=e;n++)t[n]=0;return t}const whe=bhe(256),Che=bhe(256),She=_he(),xhe=_he(),Ehe=_he();function khe(e,t){if(t<0||t>=e.length)return!1;const n=e.codePointAt(t);switch(n){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 40:case 91:return!0;case void 0:return!1;default:return!!zX(n)}}function Lhe(e,t){if(t<0||t>=e.length)return!1;switch(e.charCodeAt(t)){case 32:case 9:return!0;default:return!1}}function Dhe(e,t,n){return t[e]!==n[e]}var Nhe,Ihe;function The(e,t,n,i,r,o,s){const a=e.length>128?128:e.length,l=i.length>128?128:i.length;if(n>=a||o>=l||a-n>l-o)return;if(!function(e,t,n,i,r,o,s=!1){for(;t<n&&r<o;)e[t]===i[r]&&(s&&(whe[t]=r),t+=1),r+=1;return t===n}(t,n,a,r,o,l,!0))return;!function(e,t,n,i,r,o){let s=e-1,a=t-1;for(;s>=n&&a>=i;)r[s]===o[a]&&(Che[s]=a,s--),a--}(a,l,n,o,t,r);let c=1,u=1,h=n,d=o;const f=[!1];for(c=1,h=n;h<a;c++,h++){const s=whe[h],g=Che[h],p=h+1<a?Che[h+1]:l;for(u=s-o+1,d=s;d<p;u++,d++){let a=Number.MIN_SAFE_INTEGER,p=!1;d<=g&&(a=Mhe(e,t,h,n,i,r,d,l,o,0===She[c-1][u-1],f));let m=0;a!==Number.MAX_SAFE_INTEGER&&(p=!0,m=a+xhe[c-1][u-1]);const v=d>s,y=v?xhe[c][u-1]+(She[c][u-1]>0?-5:0):0,_=d>s+1&&She[c][u-1]>0,b=_?xhe[c][u-2]+(She[c][u-2]>0?-5:0):0;if(_&&(!v||b>=y)&&(!p||b>=m))xhe[c][u]=b,Ehe[c][u]=3,She[c][u]=0;else if(v&&(!p||y>=m))xhe[c][u]=y,Ehe[c][u]=2,She[c][u]=0;else{if(!p)throw new Error("not possible");xhe[c][u]=m,Ehe[c][u]=1,She[c][u]=She[c-1][u-1]+1}}}if(!f[0]&&!s)return;c--,u--;const g=[xhe[c][u],o];let p=0,m=0;for(;c>=1;){let e=u;do{const t=Ehe[c][e];if(3===t)e-=2;else{if(2!==t)break;e-=1}}while(e>=1);p>1&&t[n+c-1]===r[o+u-1]&&!Dhe(e+o-1,i,r)&&p+1>She[c][e]&&(e=u),e===u?p++:p=1,m||(m=e),c--,u=e-1,g.push(u)}l===a&&(g[0]+=2);const v=m-a;return g[0]-=v,g}function Mhe(e,t,n,i,r,o,s,a,l,c,u){if(t[n]!==o[s])return Number.MIN_SAFE_INTEGER;let h=1,d=!1;return s===n-i?h=e[n]===r[s]?7:5:!Dhe(s,r,o)||0!==s&&Dhe(s-1,r,o)?!khe(o,s)||0!==s&&khe(o,s-1)?(khe(o,s-1)||Lhe(o,s-1))&&(h=5,d=!0):h=5:(h=e[n]===r[s]?7:5,d=!0),h>1&&n===i&&(u[0]=!0),d||(d=Dhe(s,r,o)||khe(o,s-1)||Lhe(o,s-1)),n===i?s>l&&(h-=d?3:5):h+=c?d?2:0:d?0:1,s+1===a&&(h-=d?3:5),h}function Ahe(e,t,n,i,r,o,s){return function(e,t,n,i,r,o,s,a){let l=The(e,t,n,i,r,o,a);if(l&&!s)return l;if(e.length>=3){const t=Math.min(7,e.length-1);for(let s=n+1;s<t;s++){const t=Ohe(e,s);if(t){const e=The(t,t.toLowerCase(),n,i,r,o,a);e&&(e[0]-=3,(!l||e[0]>l[0])&&(l=e))}}}return l}(e,t,n,i,r,o,!0,s)}function Ohe(e,t){if(t+1>=e.length)return;const n=e[t],i=e[t+1];return n!==i?e.slice(0,t)+i+n+e.slice(t+2):void 0}(Ihe=Nhe||(Nhe={})).Default=[-100,0],Ihe.isDefault=function(e){return!e||2===e.length&&-100===e[0]&&0===e[1]};const Rhe=new RegExp(`\\$\\(${dJ.iconNameExpression}(?:${dJ.iconModifierExpression})?\\)`,"g"),Phe=new RegExp(`(\\\\)?${Rhe.source}`,"g");const Fhe=new RegExp(`\\\\${Rhe.source}`,"g");const Bhe=new RegExp(`(\\s)?(\\\\)?${Rhe.source}(\\s)?`,"g");function Whe(e){return-1===e.indexOf("$(")?e:e.replace(Bhe,((e,t,n,i)=>n?e:t||i||""))}function zhe(e){const t=e.indexOf("$(");return-1===t?{text:e}:function(e,t){const n=[];let i="";function r(e){if(e){i+=e;for(const t of e)n.push(c)}}let o,s,a=-1,l="",c=0,u=t;const h=e.length;r(e.substr(0,t));for(;u<h;){if(o=e[u],s=e[u+1],o==="$("[0]&&s==="$("[1])a=u,r(l),l="$(",u++;else if(")"===o&&-1!==a){c+=u-a+1,a=-1,l=""}else-1!==a?/^[a-z0-9\-]$/i.test(o)?l+=o:(r(l),a=-1,l=""):r(o);u++}return r(l),{text:i,iconOffsets:n}}(e,t)}function Vhe(e,t,n=!1){const{text:i,iconOffsets:r}=t;if(!r||0===r.length)return mhe(e,i,n);const o=sX(i," "),s=i.length-o.length,a=mhe(e,o,n);if(a)for(const l of a){const e=r[l.start+s]+s;l.start+=e,l.end+=e}return a}const Uhe=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,Hhe=/(&amp;)?(&amp;)([^\s&])/g,jhe=uJ("menu-selection",hJ.check),Ghe=uJ("menu-submenu",hJ.chevronRight);var Khe,qhe;(qhe=Khe||(Khe={}))[qhe.Right=0]="Right",qhe[qhe.Left=1]="Left";class $he extends Sle{constructor(e,t,n={}){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const i=document.createElement("div");i.classList.add("monaco-menu"),i.setAttribute("role","presentation"),super(i,{orientation:1,actionViewItemProvider:e=>this.doGetActionViewItem(e,n,r),context:n.context,actionRunner:n.actionRunner,ariaLabel:n.ariaLabel,focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...lj||cj?[10]:[]],keyDown:!0}}),this.menuElement=i,this.actionsList.setAttribute("role","menu"),this.actionsList.tabIndex=0,this.menuDisposables=this._register(new pG),this.initializeStyleSheet(e),Q$(i,RY.KEY_DOWN,(e=>{new C$(e).equals(2)&&e.preventDefault()})),n.enableMnemonics&&this.menuDisposables.add(Q$(i,RY.KEY_DOWN,(e=>{const t=e.key.toLocaleLowerCase();if(this.mnemonics.has(t)){PY(e,!0);const n=this.mnemonics.get(t);if(1===n.length&&(n[0]instanceof Xhe&&n[0].container&&this.focusItemByElement(n[0].container),n[0].onClick(e)),n.length>1){const e=n.shift();e&&e.container&&(this.focusItemByElement(e.container),n.push(e)),this.mnemonics.set(t,n)}}}))),cj&&this._register(Q$(i,RY.KEY_DOWN,(e=>{const t=new C$(e);t.equals(14)||t.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),PY(e,!0)):(t.equals(13)||t.equals(12))&&(this.focusedItem=0,this.focusPrevious(),PY(e,!0))}))),this._register(Q$(this.domNode,RY.MOUSE_OUT,(e=>{CY(e.relatedTarget,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),e.stopPropagation())}))),this._register(Q$(this.actionsList,RY.MOUSE_OVER,(e=>{let t=e.target;if(t&&CY(t,this.actionsList)&&t!==this.actionsList){for(;t.parentElement!==this.actionsList&&null!==t.parentElement;)t=t.parentElement;if(t.classList.contains("action-item")){const e=this.focusedItem;this.setFocusedItem(t),e!==this.focusedItem&&this.updateFocus()}}})));let r={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new moe(i,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const o=this.scrollableElement.getDomNode();o.style.position="",this._register(Q$(o,RY.MOUSE_UP,(e=>{e.preventDefault()}))),i.style.maxHeight=`${Math.max(10,window.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((e=>{var t;return!(null===(t=n.submenuIds)||void 0===t?void 0:t.has(e.id))||(console.warn(`Found submenu cycle: ${e.id}`),!1)})),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter((e=>!(e instanceof Zhe))).forEach(((e,t,n)=>{e.updatePositionInSet(t+1,n.length)}))}initializeStyleSheet(e){kY(e)?(this.styleSheet=NY(e),this.styleSheet.textContent=Qhe):($he.globalStyleSheet||($he.globalStyleSheet=NY(),$he.globalStyleSheet.textContent=Qhe),this.styleSheet=$he.globalStyleSheet)}style(e){const t=this.getContainer(),n=e.foregroundColor?`${e.foregroundColor}`:"",i=e.backgroundColor?`${e.backgroundColor}`:"",r=e.borderColor?`1px solid ${e.borderColor}`:"",o=e.shadowColor?`0 2px 4px ${e.shadowColor}`:"";t.style.border=r,this.domNode.style.color=n,this.domNode.style.backgroundColor=i,t.style.boxShadow=o,this.viewItems&&this.viewItems.forEach((t=>{(t instanceof Yhe||t instanceof Zhe)&&t.style(e)}))}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){if(e===this.actionsList.children[t]){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0),void 0!==this.focusedItem&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,n){if(e instanceof l5)return new Zhe(t.context,e,{icon:!0});if(e instanceof c5){const i=new Xhe(e,e.actions,n,Object.assign(Object.assign({},t),{submenuIds:new Set([...t.submenuIds||[],e.id])}));if(t.enableMnemonics){const e=i.getMnemonic();if(e&&i.isEnabled()){let t=[];this.mnemonics.has(e)&&(t=this.mnemonics.get(e)),t.push(i),this.mnemonics.set(e,t)}}return i}{const n={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const i=t.getKeyBinding(e);if(i){const e=i.getLabel();e&&(n.keybinding=e)}}const i=new Yhe(t.context,e,n);if(t.enableMnemonics){const e=i.getMnemonic();if(e&&i.isEnabled()){let t=[];this.mnemonics.has(e)&&(t=this.mnemonics.get(e)),t.push(i),this.mnemonics.set(e,t)}}return i}}}class Yhe extends ble{constructor(e,t,n={}){if(n.isMenu=!0,super(t,t,n),this.options=n,this.options.icon=void 0!==n.icon&&n.icon,this.options.label=void 0===n.label||n.label,this.cssClass="",this.options.label&&n.enableMnemonics){let e=this.getAction().label;if(e){let t=Uhe.exec(e);t&&(this.mnemonic=(t[1]?t[1]:t[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new z$((()=>{this.element&&(this._register(Q$(this.element,RY.MOUSE_UP,(e=>{if(PY(e,!0),h$){if(new L$(e).rightButton)return;this.onClick(e)}else setTimeout((()=>{this.onClick(e)}),0)}))),this._register(Q$(this.element,RY.CONTEXT_MENU,(e=>{PY(e,!0)}))))}),100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=WY(this.element,GY("a.action-menu-item")),this._action.id===l5.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=WY(this.item,GY("span.menu-item-check"+jhe.cssSelector)),this.check.setAttribute("role","none"),this.label=WY(this.item,GY("span.action-label")),this.options.label&&this.options.keybinding&&(WY(this.item,GY("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item&&this.item.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){if(this.label&&this.options.label){Y$(this.label);let e=Whe(this.getAction().label);if(e){const t=function(e){const t=Uhe,n=t.exec(e);if(!n)return e;const i=!n[1];return e.replace(t,i?"$2$3":"").trim()}(e);this.options.enableMnemonics||(e=t),this.label.setAttribute("aria-label",t.replace(/&&/g,"&"));const n=Uhe.exec(e);if(n){e=iX(e),Hhe.lastIndex=0;let t=Hhe.exec(e);for(;t&&t[1];)t=Hhe.exec(e);const i=e=>e.replace(/&amp;&amp;/g,"&amp;");t?this.label.append(sX(i(e.substr(0,t.index))," "),GY("u",{"aria-hidden":"true"},t[3]),aX(i(e.substr(t.index+t[0].length))," ")):this.label.innerText=i(e).trim(),this.item&&this.item.setAttribute("aria-keyshortcuts",(n[1]?n[1]:n[3]).toLocaleLowerCase())}else this.label.innerText=e.replace(/&&/g,"&").trim()}}}updateTooltip(){let e=null;this.getAction().tooltip?e=this.getAction().tooltip:!this.options.label&&this.getAction().label&&this.options.icon&&(e=this.getAction().label,this.options.keybinding&&(e=GH(0,"{0} ({1})",e,this.options.keybinding))),e&&this.item&&(this.item.title=e)}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.getAction().class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.getAction().enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){this.item&&(this.getAction().checked?(this.item.classList.add("checked"),this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked","true")):(this.item.classList.remove("checked"),this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked","false")))}getMnemonic(){return this.mnemonic}applyStyle(){if(!this.menuStyle)return;const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,n=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,i=e&&this.menuStyle.selectionBorderColor?`thin solid ${this.menuStyle.selectionBorderColor}`:"";this.item&&(this.item.style.color=t?t.toString():"",this.item.style.backgroundColor=n?n.toString():""),this.check&&(this.check.style.color=t?t.toString():""),this.container&&(this.container.style.border=i)}style(e){this.menuStyle=e,this.applyStyle()}}class Xhe extends Yhe{constructor(e,t,n,i){super(e,e,i),this.submenuActions=t,this.parentData=n,this.submenuOptions=i,this.mysubmenu=null,this.submenuDisposables=this._register(new pG),this.mouseOver=!1,this.expandDirection=i&&void 0!==i.expandDirection?i.expandDirection:Khe.Right,this.showScheduler=new z$((()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))}),250),this.hideScheduler=new z$((()=>{this.element&&!CY(DY(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))}),750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=WY(this.item,GY("span.submenu-indicator"+Ghe.cssSelector)),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(Q$(this.element,RY.KEY_UP,(e=>{let t=new C$(e);(t.equals(17)||t.equals(3))&&(PY(e,!0),this.createSubmenu(!0))}))),this._register(Q$(this.element,RY.KEY_DOWN,(e=>{let t=new C$(e);DY()===this.item&&(t.equals(17)||t.equals(3))&&PY(e,!0)}))),this._register(Q$(this.element,RY.MOUSE_OVER,(e=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())}))),this._register(Q$(this.element,RY.MOUSE_LEAVE,(e=>{this.mouseOver=!1}))),this._register(Q$(this.element,RY.FOCUS_OUT,(e=>{this.element&&!CY(DY(),this.element)&&this.hideScheduler.schedule()}))),this._register(this.parentData.parent.onScroll((()=>{this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!1)}))))}updateEnabled(){}onClick(e){PY(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch(t){}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,n,i){const r={top:0,left:0};return r.left=Kue(e.width,t.width,{position:i===Khe.Right?0:1,offset:n.left,size:n.width}),r.left>=n.left&&r.left<n.left+n.width&&(n.left+10+t.width<=e.width&&(r.left=n.left+10),n.top+=10,n.height=0),r.top=Kue(e.height,t.height,{position:0,offset:n.top,size:0}),r.top+t.height===n.top&&r.top+n.height+t.height<=e.height&&(r.top+=n.height),r}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=WY(this.element,GY("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=getComputedStyle(this.parentData.parent.domNode),n=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new $he(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new u5],this.submenuOptions),this.menuStyle&&this.parentData.submenu.style(this.menuStyle);const i=this.element.getBoundingClientRect(),r={top:i.top-n,left:i.left,height:i.height+2*n,width:i.width},o=this.submenuContainer.getBoundingClientRect(),{top:s,left:a}=this.calculateSubmenuMenuLayout(new gY(window.innerWidth,window.innerHeight),gY.lift(o),r,this.expandDirection);this.submenuContainer.style.left=`${a}px`,this.submenuContainer.style.top=`${s}px`,this.submenuDisposables.add(Q$(this.submenuContainer,RY.KEY_UP,(e=>{new C$(e).equals(15)&&(PY(e,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))}))),this.submenuDisposables.add(Q$(this.submenuContainer,RY.KEY_DOWN,(e=>{new C$(e).equals(15)&&PY(e,!0)}))),this.submenuDisposables.add(this.parentData.submenu.onDidCancel((()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)}))),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&(null===(t=this.item)||void 0===t||t.setAttribute("aria-expanded",e))}applyStyle(){if(super.applyStyle(),!this.menuStyle)return;const e=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=e?`${e}`:""),this.parentData.submenu&&this.parentData.submenu.style(this.menuStyle)}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class Zhe extends wle{style(e){this.label&&(this.label.style.borderBottomColor=e.separatorColor?`${e.separatorColor}`:"")}}let Qhe=`\n.monaco-menu {\n\tfont-size: 13px;\n\n}\n\n${Yue(jhe)}\n${Yue(Ghe)}\n\n.monaco-menu .monaco-action-bar {\n\ttext-align: right;\n\toverflow: hidden;\n\twhite-space: nowrap;\n}\n\n.monaco-menu .monaco-action-bar .actions-container {\n\tdisplay: flex;\n\tmargin: 0 auto;\n\tpadding: 0;\n\twidth: 100%;\n\tjustify-content: flex-end;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar.reverse .actions-container {\n\tflex-direction: row-reverse;\n}\n\n.monaco-menu .monaco-action-bar .action-item {\n\tcursor: pointer;\n\tdisplay: inline-block;\n\ttransition: transform 50ms ease;\n\tposition: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled {\n\tcursor: default;\n}\n\n.monaco-menu .monaco-action-bar.animated .action-item.active {\n\ttransform: scale(1.272019649, 1.272019649); /* 1.272019649 = √φ */\n}\n\n.monaco-menu .monaco-action-bar .action-item .icon,\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar .action-label {\n\tfont-size: 11px;\n\tmargin-right: 4px;\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label,\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {\n\topacity: 0.4;\n}\n\n/* Vertical actions */\n\n.monaco-menu .monaco-action-bar.vertical {\n\ttext-align: left;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tdisplay: block;\n\tborder-bottom: 1px solid #bbb;\n\tpadding-top: 1px;\n\tmargin-left: .8em;\n\tmargin-right: .8em;\n}\n\n.monaco-menu .secondary-actions .monaco-action-bar .action-label {\n\tmargin-left: 6px;\n}\n\n/* Action Items */\n.monaco-menu .monaco-action-bar .action-item.select-container {\n\toverflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */\n\tflex: 1;\n\tmax-width: 170px;\n\tmin-width: 60px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 10px;\n}\n\n.monaco-menu .monaco-action-bar.vertical {\n\tmargin-left: 0;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tpadding: 0;\n\ttransform: none;\n\tdisplay: flex;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.active {\n\ttransform: none;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\theight: 2em;\n\talign-items: center;\n\tposition: relative;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label {\n\tflex: 1 1 auto;\n\ttext-decoration: none;\n\tpadding: 0 1em;\n\tbackground: none;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .keybinding,\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tdisplay: inline-block;\n\tflex: 2 1 auto;\n\tpadding: 0 1em;\n\ttext-align: right;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {\n\tfont-size: 16px !important;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {\n\tmargin-left: auto;\n\tmargin-right: -20px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {\n\topacity: 0.4;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tposition: static;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {\n\tposition: absolute;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tpadding: 0.5em 0 0 0;\n\tmargin-bottom: 0.5em;\n\twidth: 100%;\n\theight: 0px !important;\n\tmargin-left: .8em !important;\n\tmargin-right: .8em !important;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {\n\tpadding: 0.7em 1em 0.1em 1em;\n\tfont-weight: bold;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:hover {\n\tcolor: inherit;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tposition: absolute;\n\tvisibility: hidden;\n\twidth: 1em;\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {\n\tvisibility: visible;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n/* Context Menu */\n\n.context-view.monaco-menu-container {\n\toutline: 0;\n\tborder: none;\n\tanimation: fadeIn 0.083s linear;\n\t-webkit-app-region: no-drag;\n}\n\n.context-view.monaco-menu-container :focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {\n\toutline: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tborder: thin solid transparent; /* prevents jumping behaviour on hover or focus */\n}\n\n\n/* High Contrast Theming */\n:host-context(.hc-black) .context-view.monaco-menu-container {\n\tbox-shadow: none;\n}\n\n:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused {\n\tbackground: none;\n}\n\n/* Vertical Action Bar Styles */\n\n.monaco-menu .monaco-action-bar.vertical {\n\tpadding: .5em 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\theight: 1.8em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),\n.monaco-menu .monaco-action-bar.vertical .keybinding {\n\tfont-size: inherit;\n\tpadding: 0 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tfont-size: inherit;\n\twidth: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tfont-size: inherit;\n\tpadding: 0.2em 0 0 0;\n\tmargin-bottom: 0.2em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tfont-size: 60%;\n\tpadding: 0 1.8em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n\tmask-size: 10px 10px;\n\t-webkit-mask-size: 10px 10px;\n}\n\n.monaco-menu .action-item {\n\tcursor: default;\n}\n\n/* Arrows */\n.monaco-scrollable-element > .scrollbar > .scra {\n\tcursor: pointer;\n\tfont-size: 11px !important;\n}\n\n.monaco-scrollable-element > .visible {\n\topacity: 1;\n\n\t/* Background rule added for IE9 - to allow clicks on dom node */\n\tbackground:rgba(0,0,0,0);\n\n\ttransition: opacity 100ms linear;\n}\n.monaco-scrollable-element > .invisible {\n\topacity: 0;\n\tpointer-events: none;\n}\n.monaco-scrollable-element > .invisible.fade {\n\ttransition: opacity 800ms linear;\n}\n\n/* Scrollable Content Inset Shadow */\n.monaco-scrollable-element > .shadow {\n\tposition: absolute;\n\tdisplay: none;\n}\n.monaco-scrollable-element > .shadow.top {\n\tdisplay: block;\n\ttop: 0;\n\tleft: 3px;\n\theight: 3px;\n\twidth: 100%;\n\tbox-shadow: #DDD 0 6px 6px -6px inset;\n}\n.monaco-scrollable-element > .shadow.left {\n\tdisplay: block;\n\ttop: 3px;\n\tleft: 0;\n\theight: 100%;\n\twidth: 3px;\n\tbox-shadow: #DDD 6px 0 6px -6px inset;\n}\n.monaco-scrollable-element > .shadow.top-left-corner {\n\tdisplay: block;\n\ttop: 0;\n\tleft: 0;\n\theight: 3px;\n\twidth: 3px;\n}\n.monaco-scrollable-element > .shadow.top.left {\n\tbox-shadow: #DDD 6px 6px 6px -6px inset;\n}\n\n/* ---------- Default Style ---------- */\n\n:host-context(.vs) .monaco-scrollable-element > .scrollbar > .slider {\n\tbackground: rgba(100, 100, 100, .4);\n}\n:host-context(.vs-dark) .monaco-scrollable-element > .scrollbar > .slider {\n\tbackground: rgba(121, 121, 121, .4);\n}\n:host-context(.hc-black) .monaco-scrollable-element > .scrollbar > .slider {\n\tbackground: rgba(111, 195, 223, .6);\n}\n\n.monaco-scrollable-element > .scrollbar > .slider:hover {\n\tbackground: rgba(100, 100, 100, .7);\n}\n:host-context(.hc-black) .monaco-scrollable-element > .scrollbar > .slider:hover {\n\tbackground: rgba(111, 195, 223, .8);\n}\n\n.monaco-scrollable-element > .scrollbar > .slider.active {\n\tbackground: rgba(0, 0, 0, .6);\n}\n:host-context(.vs-dark) .monaco-scrollable-element > .scrollbar > .slider.active {\n\tbackground: rgba(191, 191, 191, .4);\n}\n:host-context(.hc-black) .monaco-scrollable-element > .scrollbar > .slider.active {\n\tbackground: rgba(111, 195, 223, 1);\n}\n\n:host-context(.vs-dark) .monaco-scrollable-element .shadow.top {\n\tbox-shadow: none;\n}\n\n:host-context(.vs-dark) .monaco-scrollable-element .shadow.left {\n\tbox-shadow: #000 6px 0 6px -6px inset;\n}\n\n:host-context(.vs-dark) .monaco-scrollable-element .shadow.top.left {\n\tbox-shadow: #000 6px 6px 6px -6px inset;\n}\n\n:host-context(.hc-black) .monaco-scrollable-element .shadow.top {\n\tbox-shadow: none;\n}\n\n:host-context(.hc-black) .monaco-scrollable-element .shadow.left {\n\tbox-shadow: none;\n}\n\n:host-context(.hc-black) .monaco-scrollable-element .shadow.top.left {\n\tbox-shadow: none;\n}\n`;function Jhe(e,t){const n=Object.create(null);for(let i in t){const r=t[i];r&&(n[i]=oie(r,e))}return n}function ede(e,t,n){function i(){const i=Jhe(e.getColorTheme(),t);"function"==typeof n?n(i):n.style(i)}return i(),e.onDidColorThemeChange(i)}function tde(e,t,n){return ede(t,Object.assign(Object.assign({},nde),n||{}),e)}const nde={listFocusBackground:rne,listFocusForeground:one,listFocusOutline:sne,listActiveSelectionBackground:ane,listActiveSelectionForeground:lne,listActiveSelectionIconForeground:cne,listFocusAndSelectionBackground:ane,listFocusAndSelectionForeground:lne,listInactiveSelectionBackground:une,listInactiveSelectionIconForeground:dne,listInactiveSelectionForeground:hne,listInactiveFocusBackground:fne,listInactiveFocusOutline:gne,listHoverBackground:pne,listHoverForeground:mne,listDropBackground:vne,listSelectionOutline:Eee,listHoverOutline:Eee,listFilterWidgetBackground:bne,listFilterWidgetOutline:wne,listFilterWidgetNoMatchesOutline:Cne,listMatchesShadow:Nee,treeIndentGuidesStroke:Sne,tableColumnsBorder:xne},ide={shadowColor:Nee,borderColor:Nne,foregroundColor:Ine,backgroundColor:Tne,selectionForegroundColor:Mne,selectionBackgroundColor:Ane,selectionBorderColor:One,separatorColor:Rne};class rde{constructor(e,t,n,i,r){this.contextViewService=e,this.telemetryService=t,this.notificationService=n,this.keybindingService=i,this.themeService=r,this.focusToReturn=null,this.block=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;let n;this.focusToReturn=document.activeElement;let i=OY(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:i=>{let r=e.getMenuClassName?e.getMenuClassName():"";r&&(i.className+=" "+r),this.options.blockMouse&&(this.block=i.appendChild(GY(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",Q$(this.block,RY.MOUSE_DOWN,(e=>e.stopPropagation())));const o=new pG,s=e.actionRunner||new a5;var a,l;return s.onBeforeRun(this.onActionRun,this,o),s.onDidRun(this.onDidActionRun,this,o),n=new $he(i,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:s,getKeyBinding:e.getKeyBinding?e.getKeyBinding:e=>this.keybindingService.lookupKeybinding(e.id)}),o.add((a=n,ede(this.themeService,Object.assign(Object.assign({},ide),l),a))),n.onDidCancel((()=>this.contextViewService.hideContextView(!0)),null,o),n.onDidBlur((()=>this.contextViewService.hideContextView(!0)),null,o),o.add(Q$(window,RY.BLUR,(()=>this.contextViewService.hideContextView(!0)))),o.add(Q$(window,RY.MOUSE_DOWN,(e=>{if(e.defaultPrevented)return;let t=new L$(e),n=t.target;if(!t.rightButton){for(;n;){if(n===i)return;n=n.parentElement}this.contextViewService.hideContextView(!0)}}))),fG(o,n)},focus:()=>{n&&n.focus(!!e.autoSelectFirstItem)},onHide:t=>{e.onHide&&e.onHide(!!t),this.block&&(this.block.remove(),this.block=null),this.focusToReturn&&this.focusToReturn.focus()}},i,!!i)}onActionRun(e){this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1),this.focusToReturn&&this.focusToReturn.focus()}onDidActionRun(e){e.error&&!oG(e.error)&&this.notificationService.error(e.error)}}var ode=function(e,t){return function(n,i){t(n,i,e)}};let sde=class extends mG{constructor(e,t,n,i,r){super(),this.contextMenuHandler=new rde(n,e,t,i,r)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){this.contextMenuHandler.showContextMenu(e),JY.getInstance().resetKeyStatus()}};sde=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ode(0,e6),ode(1,g4),ode(2,Ble),ode(3,gce),ode(4,B5)],sde);const ade=i$("layoutService");let lde=class extends mG{constructor(e){super(),this.layoutService=e,this.currentViewDisposable=mG.None,this.container=e.container,this.contextView=this._register(new que(this.container,1)),this.layout(),this._register(e.onDidLayout((()=>this.layout())))}setContainer(e,t){this.contextView.setContainer(e,t||1)}showContextView(e,t,n){t?t!==this.container&&(this.container=t,this.setContainer(t,n?3:2)):this.container!==this.layoutService.container&&(this.container=this.layoutService.container,this.setContainer(this.container,1)),this.contextView.show(e);const i=gG((()=>{this.currentViewDisposable===i&&this.hideContextView()}));return this.currentViewDisposable=i,i}getContextViewElement(){return this.contextView.getViewElement()}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e)}};lde=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(0,ade)],lde);const cde=i$("dialogService");class ude{constructor(e){this.incoming=new Map,this.outgoing=new Map,this.data=e}}class hde{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(let t of this._nodes.values())0===t.outgoing.size&&e.push(t);return e}insertEdge(e,t){const n=this.lookupOrInsertNode(e),i=this.lookupOrInsertNode(t);n.outgoing.set(this._hashFn(t),i),i.incoming.set(this._hashFn(e),n)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(let n of this._nodes.values())n.outgoing.delete(t),n.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let n=this._nodes.get(t);return n||(n=new ude(e),this._nodes.set(t,n)),n}isEmpty(){return 0===this._nodes.size}toString(){let e=[];for(let[t,n]of this._nodes)e.push(`${t}, (incoming)[${[...n.incoming.keys()].join(", ")}], (outgoing)[${[...n.outgoing.keys()].join(",")}]`);return e.join("\n")}findCycleSlow(){for(let[e,t]of this._nodes){const n=new Set([e]),i=this._findCycle(t,n);if(i)return i}}_findCycle(e,t){for(let[n,i]of e.outgoing){if(t.has(n))return[...t,n].join(" -> ");t.add(n);const e=this._findCycle(i,t);if(e)return e;t.delete(n)}}}class dde extends Error{constructor(e){var t;super("cyclic dependency between services"),this.message=null!==(t=e.findCycleSlow())&&void 0!==t?t:`UNABLE to detect cycle, dumping graph: \n${e.toString()}`}}class fde{constructor(e=new vae,t=!1,n){this._activeInstantiations=new Set,this._services=e,this._strict=t,this._parent=n,this._services.set(t$,this)}createChild(e){return new fde(e,this._strict,this)}invokeFunction(e,...t){let n=gde.traceInvocation(e),i=!1;try{return e({get:(e,t)=>{if(i)throw function(e){return e?new Error(`Illegal state: ${e}`):new Error("Illegal state")}("service accessor is only valid during the invocation of its target method");const r=this._getOrCreateServiceInstance(e,n);if(!r&&t!==r$)throw new Error(`[invokeFunction] unknown service '${e}'`);return r}},...t)}finally{i=!0,n.stop()}}createInstance(e,...t){let n,i;return e instanceof ale?(n=gde.traceCreation(e.ctor),i=this._createInstance(e.ctor,e.staticArguments.concat(t),n)):(n=gde.traceCreation(e),i=this._createInstance(e,t,n)),n.stop(),i}_createInstance(e,t=[],n){let i=Jq.getServiceDependencies(e).sort(((e,t)=>e.index-t.index)),r=[];for(const s of i){let t=this._getOrCreateServiceInstance(s.id,n);if(!t&&this._strict&&!s.optional)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${s.id}.`);r.push(t)}let o=i.length>0?i[0].index:t.length;if(t.length!==o){console.warn(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);let n=o-t.length;t=n>0?t.concat(new Array(n)):t.slice(0,o)}return new e(...[...t,...r])}_setServiceInstance(e,t){if(this._services.get(e)instanceof ale)this._services.set(e,t);else{if(!this._parent)throw new Error("illegalState - setting UNKNOWN service instance");this._parent._setServiceInstance(e,t)}}_getServiceInstanceOrDescriptor(e){let t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){let n=this._getServiceInstanceOrDescriptor(e);return n instanceof ale?this._safeCreateAndCacheServiceInstance(e,n,t.branch(e,!0)):(t.branch(e,!1),n)}_safeCreateAndCacheServiceInstance(e,t,n){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,n){const i=new hde((e=>e.id.toString()));let r=0;const o=[{id:e,desc:t,_trace:n}];for(;o.length;){const t=o.pop();if(i.lookupOrInsertNode(t),r++>1e3)throw new dde(i);for(let n of Jq.getServiceDependencies(t.desc.ctor)){let r=this._getServiceInstanceOrDescriptor(n.id);if(r||n.optional||console.warn(`[createInstance] ${e} depends on ${n.id} which is NOT registered.`),r instanceof ale){const e={id:n.id,desc:r,_trace:t._trace.branch(n.id,!0)};i.insertEdge(t,e),o.push(e)}}}for(;;){const e=i.roots();if(0===e.length){if(!i.isEmpty())throw new dde(i);break}for(const{data:t}of e){if(this._getServiceInstanceOrDescriptor(t.id)instanceof ale){const e=this._createServiceInstanceWithOwner(t.id,t.desc.ctor,t.desc.staticArguments,t.desc.supportsDelayedInstantiation,t._trace);this._setServiceInstance(t.id,e)}i.removeNode(t)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,n=[],i,r){if(this._services.get(e)instanceof ale)return this._createServiceInstance(t,n,i,r);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,n,i,r);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t=[],n,i){if(n){const n=new U$((()=>this._createInstance(e,t,i)));return new Proxy(Object.create(null),{get(e,t){if(t in e)return e[t];let i=n.value,r=i[t];return"function"!=typeof r||(r=r.bind(i),e[t]=r),r},set:(e,t,i)=>(n.value[t]=i,!0)})}return this._createInstance(e,t,i)}}class gde{constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}static traceInvocation(e){return gde._None}static traceCreation(e){return gde._None}branch(e,t){let n=new gde(2,e.toString());return this._dep.push([e,t,n]),n}stop(){let e=Date.now()-this._start;gde._totals+=e;let t=!1;let n=[`${0===this.type?"CREATE":"CALL"} ${this.name}`,`${function e(n,i){let r=[],o=new Array(n+1).join("\t");for(const[s,a,l]of i._dep)if(a&&l){t=!0,r.push(`${o}CREATES -> ${s}`);let i=e(n+1,l);i&&r.push(i)}else r.push(`${o}uses -> ${s}`);return r.join("\n")}(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${gde._totals.toFixed(2)}ms)`];(e>2||t)&&console.log(n.join("\n"))}}gde._None=new class extends gde{constructor(){super(-1,null)}stop(){}branch(){return this}},gde._totals=0;const pde=i$("labelService");class mde extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function vde(e,t){const n=[];for(let i of t){if(e.start>=i.range.end)continue;if(e.end<i.range.start)break;const t=Hue.intersect(e,i.range);Hue.isEmpty(t)||n.push({range:t,size:i.size})}return n}function yde({start:e,end:t},n){return{start:e+n,end:t+n}}class _de{constructor(){this.groups=[],this._size=0}splice(e,t,n=[]){const i=n.length-t,r=vde({start:0,end:e},this.groups),o=vde({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map((e=>({range:yde(e.range,i),size:e.size}))),s=n.map(((t,n)=>({range:{start:e+n,end:e+n+1},size:t.size})));this.groups=function(...e){return function(e){const t=[];let n=null;for(let i of e){const e=i.range.start,r=i.range.end,o=i.size;n&&o===n.size?n.range.end=r:(n={range:{start:e,end:r},size:o},t.push(n))}return t}(e.reduce(((e,t)=>e.concat(t)),[]))}(r,s,o),this._size=this.groups.reduce(((e,t)=>e+t.size*(t.range.end-t.range.start)),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;let t=0,n=0;for(let i of this.groups){const r=i.range.end-i.range.start,o=n+r*i.size;if(e<o)return t+Math.floor((e-n)/i.size);t+=r,n=o}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,n=0;for(let i of this.groups){const r=i.range.end-i.range.start,o=n+r;if(e<o)return t+(e-n)*i.size;t+=r*i.size,n=o}return-1}}class bde{constructor(e){this.renderers=e,this.cache=new Map}alloc(e){let t=this.getTemplateCache(e).pop();if(!t){const n=GY(".monaco-list-row");t={domNode:n,templateId:e,templateData:this.getRenderer(e).renderTemplate(n)}}return t}release(e){e&&this.releaseRow(e)}releaseRow(e){const{domNode:t,templateId:n}=e;t&&(t.classList.remove("scrolling"),function(e){try{e.parentElement&&e.parentElement.removeChild(e)}catch(zWe){}}(t));this.getTemplateCache(n).push(e)}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach(((e,t)=>{for(const n of e){this.getRenderer(t).disposeTemplate(n.templateData),n.templateData=null}})),this.cache.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}var wde=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};const Cde={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements:e=>[e],getDragURI:()=>null,onDragStart(){},onDragOver:()=>!1,drop(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class Sde{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class xde{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class Ede{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const n=e.files.item(t);n&&(n.size||n.type)&&this.files.push(n)}}}getData(){return{types:this.types,files:this.files}}}class kde{constructor(e){(null==e?void 0:e.getSetSize)?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(e,t,n)=>n,(null==e?void 0:e.getPosInSet)?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(e,t)=>t+1,(null==e?void 0:e.getRole)?this.getRole=e.getRole.bind(e):this.getRole=e=>"listitem",(null==e?void 0:e.isChecked)?this.isChecked=e.isChecked.bind(e):this.isChecked=e=>{}}}class Lde{constructor(e,t,n,i=Cde){if(this.virtualDelegate=t,this.domId="list_id_"+ ++Lde.InstanceCount,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new A$(50),this.splicing=!1,this.dragOverAnimationStopDisposable=mG.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=mG.None,this.onDragLeaveTimeout=mG.None,this.disposables=new pG,this._onDidChangeContentHeight=new EG,this._horizontalScrolling=!1,i.horizontalScrolling&&i.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=new _de;for(const r of n)this.renderers.set(r.templateId,r);this.cache=this.disposables.add(new bde(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support","boolean"!=typeof i.mouseSupport||i.mouseSupport),this._horizontalScrolling=fQ(i,(e=>e.horizontalScrolling),Cde.horizontalScrolling),this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.additionalScrollHeight=void 0===i.additionalScrollHeight?0:i.additionalScrollHeight,this.accessibilityProvider=new kde(i.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows";fQ(i,(e=>e.transformOptimization),Cde.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)"),this.disposables.add(O6.addTarget(this.rowsContainer)),this.scrollable=new aoe(fQ(i,(e=>e.smoothScrolling),!1)?125:0,(e=>oY(e))),this.scrollableElement=this.disposables.add(new poe(this.rowsContainer,{alwaysConsumeMouseWheel:fQ(i,(e=>e.alwaysConsumeMouseWheel),Cde.alwaysConsumeMouseWheel),horizontal:1,vertical:fQ(i,(e=>e.verticalScrollMode),Cde.verticalScrollMode),useShadows:fQ(i,(e=>e.useShadows),Cde.useShadows)},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(Q$(this.rowsContainer,M6.Change,(e=>this.onTouchChange(e)))),this.disposables.add(Q$(this.scrollableElement.getDomNode(),"scroll",(e=>e.target.scrollTop=0))),this.disposables.add(Q$(this.domNode,"dragover",(e=>this.onDragOver(this.toDragEvent(e))))),this.disposables.add(Q$(this.domNode,"drop",(e=>this.onDrop(this.toDragEvent(e))))),this.disposables.add(Q$(this.domNode,"dragleave",(e=>this.onDragLeave(this.toDragEvent(e))))),this.disposables.add(Q$(this.domNode,"dragend",(e=>this.onDragEnd(e)))),this.setRowLineHeight=fQ(i,(e=>e.setRowLineHeight),Cde.setRowLineHeight),this.setRowHeight=fQ(i,(e=>e.setRowHeight),Cde.setRowHeight),this.supportDynamicHeights=fQ(i,(e=>e.supportDynamicHeights),Cde.supportDynamicHeights),this.dnd=fQ(i,(e=>e.dnd),Cde.dnd),this.layout()}get contentHeight(){return this.rangeMap.size}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const e of this.items)this.measureItemWidth(e);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:_Y(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){void 0!==e.additionalScrollHeight&&(this.additionalScrollHeight=e.additionalScrollHeight,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),void 0!==e.smoothScrolling&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),void 0!==e.horizontalScrolling&&(this.horizontalScrolling=e.horizontalScrolling)}splice(e,t,n=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,n)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,n=[]){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},o=Hue.intersect(i,r),s=new Map;for(let b=o.start;b<o.end;b++){const e=this.items[b];if(e.dragStartDisposable.dispose(),e.row){let t=s.get(e.templateId);t||(t=[],s.set(e.templateId,t));const n=this.renderers.get(e.templateId);n&&n.disposeElement&&n.disposeElement(e.element,b,e.row.templateData,e.size),t.push(e.row)}e.row=null}const a={start:e+t,end:this.items.length},l=Hue.intersect(a,i),c=Hue.relativeComplement(a,i),u=n.map((e=>({id:String(this.itemId++),element:e,templateId:this.virtualDelegate.getTemplateId(e),size:this.virtualDelegate.getHeight(e),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(e),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:mG.None})));let h;0===e&&t>=this.items.length?(this.rangeMap=new _de,this.rangeMap.splice(0,0,u),h=this.items,this.items=u):(this.rangeMap.splice(e,t,u),h=this.items.splice(e,t,...u));const d=n.length-t,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),g=yde(l,d),p=Hue.intersect(f,g);for(let b=p.start;b<p.end;b++)this.updateItemInDOM(this.items[b],b);const m=Hue.relativeComplement(g,f);for(const b of m)for(let e=b.start;e<b.end;e++)this.removeItemFromDOM(e);const v=c.map((e=>yde(e,d))),y=[{start:e,end:e+n.length},...v].map((e=>Hue.intersect(f,e))),_=this.getNextToLastElement(y);for(const b of y)for(let e=b.start;e<b.end;e++){const t=this.items[e],n=s.get(t.templateId),i=null==n?void 0:n.pop();this.insertItemInDOM(e,_,i)}for(const b of s.values())for(const e of b)this.cache.release(e);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),h.map((e=>e.element))}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=oY((()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null})))}eventuallyUpdateScrollWidth(){this.horizontalScrolling?this.scrollableElementWidthDelayer.trigger((()=>this.updateScrollWidth())):this.scrollableElementWidthDelayer.cancel()}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)void 0!==t.width&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:0===e?0:e+10})}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}element(e){return this.items[e].element}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let n={height:"number"==typeof e?e:bY(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,n.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(n),void 0!==t&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:"number"==typeof t?t:_Y(this.domNode)})}render(e,t,n,i,r,o=!1){const s=this.getRenderRange(t,n),a=Hue.relativeComplement(s,e),l=Hue.relativeComplement(e,s),c=this.getNextToLastElement(a);if(o){const t=Hue.intersect(e,s);for(let e=t.start;e<t.end;e++)this.updateItemInDOM(this.items[e],e)}for(const u of a)for(let e=u.start;e<u.end;e++)this.insertItemInDOM(e,c);for(const u of l)for(let e=u.start;e<u.end;e++)this.removeItemFromDOM(e);void 0!==i&&(this.rowsContainer.style.left=`-${i}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&void 0!==r&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=n}insertItemInDOM(e,t,n){const i=this.items[e];i.row||(i.row=null!=n?n:this.cache.alloc(i.templateId));const r=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",r);const o=this.accessibilityProvider.isChecked(i.element);void 0!==o&&i.row.domNode.setAttribute("aria-checked",String(!!o)),i.row.domNode.parentElement||(t?this.rowsContainer.insertBefore(i.row.domNode,t):this.rowsContainer.appendChild(i.row.domNode)),this.updateItemInDOM(i,e);const s=this.renderers.get(i.templateId);if(!s)throw new Error(`No renderer found for template id ${i.templateId}`);s&&s.renderElement(i.element,e,i.row.templateData,i.size);const a=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!a,a&&(i.dragStartDisposable=Q$(i.row.domNode,"dragstart",(e=>this.onDragStart(i.element,a,e)))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width=h$?"-moz-fit-content":"fit-content",e.width=_Y(e.row.domNode);const t=window.getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){const t=this.items[e];if(t.dragStartDisposable.dispose(),t.row){const n=this.renderers.get(t.templateId);n&&n.disposeElement&&n.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.additionalScrollHeight}get onMouseClick(){return SG.map(this.disposables.add(new Xae(this.domNode,"click")).event,(e=>this.toMouseEvent(e)))}get onMouseDblClick(){return SG.map(this.disposables.add(new Xae(this.domNode,"dblclick")).event,(e=>this.toMouseEvent(e)))}get onMouseMiddleClick(){return SG.filter(SG.map(this.disposables.add(new Xae(this.domNode,"auxclick")).event,(e=>this.toMouseEvent(e))),(e=>1===e.browserEvent.button))}get onMouseDown(){return SG.map(this.disposables.add(new Xae(this.domNode,"mousedown")).event,(e=>this.toMouseEvent(e)))}get onContextMenu(){return SG.any(SG.map(this.disposables.add(new Xae(this.domNode,"contextmenu")).event,(e=>this.toMouseEvent(e))),SG.map(this.disposables.add(new Xae(this.domNode,M6.Contextmenu)).event,(e=>this.toGestureEvent(e))))}get onTouchStart(){return SG.map(this.disposables.add(new Xae(this.domNode,"touchstart")).event,(e=>this.toTouchEvent(e)))}get onTap(){return SG.map(this.disposables.add(new Xae(this.rowsContainer,M6.Tap)).event,(e=>this.toGestureEvent(e)))}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),n=void 0===t?void 0:this.items[t];return{browserEvent:e,index:t,element:n&&n.element}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),n=void 0===t?void 0:this.items[t];return{browserEvent:e,index:t,element:n&&n.element}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),n=void 0===t?void 0:this.items[t];return{browserEvent:e,index:t,element:n&&n.element}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),n=void 0===t?void 0:this.items[t];return{browserEvent:e,index:t,element:n&&n.element}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,n){if(!n.dataTransfer)return;const i=this.dnd.getDragElements(e);if(n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setData(vle.TEXT,t),n.dataTransfer.setDragImage){let e;this.dnd.getDragLabel&&(e=this.dnd.getDragLabel(i,n)),void 0===e&&(e=String(i.length));const t=GY(".monaco-drag-image");t.textContent=e,document.body.appendChild(t),n.dataTransfer.setDragImage(t,-10,-10),setTimeout((()=>document.body.removeChild(t)),0)}this.currentDragData=new Sde(i),_le.CurrentDragAndDropData=new xde(i),this.dnd.onDragStart&&this.dnd.onDragStart(this.currentDragData,n)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),_le.CurrentDragAndDropData&&"vscode-ui"===_le.CurrentDragAndDropData.getData())return!1;if(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer)return!1;if(!this.currentDragData)if(_le.CurrentDragAndDropData)this.currentDragData=_le.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new Ede}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.browserEvent);if(this.canDrop="boolean"==typeof t?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;let n;if(e.browserEvent.dataTransfer.dropEffect="boolean"!=typeof t&&0===t.effect?"copy":"move",n="boolean"!=typeof t&&t.feedback?t.feedback:void 0===e.index?[-1]:[e.index],n=P1(n).filter((e=>e>=-1&&e<this.length)).sort(((e,t)=>e-t)),n=-1===n[0]?[-1]:n,i=this.currentDragFeedback,r=n,Array.isArray(i)&&Array.isArray(r)?D1(i,r):i===r)return!0;var i,r;if(this.currentDragFeedback=n,this.currentDragFeedbackDisposable.dispose(),-1===n[0])this.domNode.classList.add("drop-target"),this.rowsContainer.classList.add("drop-target"),this.currentDragFeedbackDisposable=gG((()=>{this.domNode.classList.remove("drop-target"),this.rowsContainer.classList.remove("drop-target")}));else{for(const e of n){const t=this.items[e];t.dropTarget=!0,t.row&&t.row.domNode.classList.add("drop-target")}this.currentDragFeedbackDisposable=gG((()=>{for(const e of n){const t=this.items[e];t.dropTarget=!1,t.row&&t.row.domNode.classList.remove("drop-target")}}))}return!0}onDragLeave(e){var t,n;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=P$((()=>this.clearDragOverFeedback()),100),this.currentDragData&&(null===(n=(t=this.dnd).onDragLeave)||void 0===n||n.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.currentDragData=void 0,_le.CurrentDragAndDropData=void 0,t&&e.browserEvent.dataTransfer&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.currentDragData=void 0,_le.CurrentDragAndDropData=void 0,this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=mG.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const e=pY(this.domNode).top;this.dragOverAnimationDisposable=function(e){const t=()=>{e(),n=oY(t)};let n=oY(t);return gG((()=>n.dispose()))}(this.animateDragAndDropScrollTop.bind(this,e))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=P$((()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}),1e3),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(void 0===this.dragOverMouseY)return;const t=this.dragOverMouseY-e,n=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>n&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-n))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let n=e;for(;n instanceof HTMLElement&&n!==this.rowsContainer&&t.contains(n);){const e=n.getAttribute("data-index");if(e){const t=Number(e);if(!isNaN(t))return t}n=n.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,n){const i=this.getRenderRange(e,t);let r,o;e===this.elementTop(i.start)?(r=i.start,o=0):i.end-i.start>1&&(r=i.start+1,o=this.elementTop(r)-e);let s=0;for(;;){const a=this.getRenderRange(e,t);let l=!1;for(let e=a.start;e<a.end;e++){const t=this.probeDynamicHeight(e);0!==t&&this.rangeMap.splice(e,1,[this.items[e]]),s+=t,l=l||0!==t}if(!l){0!==s&&this.eventuallyUpdateScrollDimensions();const t=Hue.relativeComplement(i,a);for(const e of t)for(let t=e.start;t<e.end;t++)this.items[t].row&&this.removeItemFromDOM(t);const l=Hue.relativeComplement(a,i);for(const e of l)for(let t=e.start;t<e.end;t++){const e=t+1,n=e<this.items.length?this.items[e].row:null,i=n?n.domNode:null;this.insertItemInDOM(t,i)}for(let e=a.start;e<a.end;e++)this.items[e].row&&this.updateItemInDOM(this.items[e],e);if("number"==typeof r){const t=this.scrollable.getFutureScrollPosition().scrollTop-e,i=this.elementTop(r)-o+t;this.setScrollTop(i,n)}return void this._onDidChangeContentHeight.fire(this.contentHeight)}}}probeDynamicHeight(e){const t=this.items[e];if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth)return 0;if(this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const n=t.size;if(!this.setRowHeight&&t.row){let e=t.row.domNode.offsetHeight;return t.size=e,t.lastDynamicHeightWidth=this.renderWidth,e-n}const i=this.cache.alloc(t.templateId);i.domNode.style.height="",this.rowsContainer.appendChild(i.domNode);const r=this.renderers.get(t.templateId);return r&&(r.renderElement(t.element,e,i.templateData,void 0),r.disposeElement&&r.disposeElement(t.element,e,i.templateData,void 0)),t.size=i.domNode.offsetHeight,this.virtualDelegate.setDynamicHeight&&this.virtualDelegate.setDynamicHeight(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,this.rowsContainer.removeChild(i.domNode),this.cache.release(i),t.size-n}getNextToLastElement(e){const t=e[e.length-1];if(!t)return null;const n=this.items[t.end];return n&&n.row?n.row.domNode:null}getElementDomId(e){return`${this.domId}_${e}`}dispose(){if(this.items){for(const e of this.items)if(e.row){const t=this.renderers.get(e.row.templateId);t&&(t.disposeElement&&t.disposeElement(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[]}this.domNode&&this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),dG(this.disposables)}}Lde.InstanceCount=0,wde([T6],Lde.prototype,"onMouseClick",null),wde([T6],Lde.prototype,"onMouseDblClick",null),wde([T6],Lde.prototype,"onMouseMiddleClick",null),wde([T6],Lde.prototype,"onMouseDown",null),wde([T6],Lde.prototype,"onContextMenu",null),wde([T6],Lde.prototype,"onTouchStart",null),wde([T6],Lde.prototype,"onTap",null);class Dde{constructor(e){this.spliceables=e}splice(e,t,n){this.spliceables.forEach((i=>i.splice(e,t,n)))}}var Nde,Ide,Tde=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Mde=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Ade{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.trait}`}renderTemplate(e){return e}renderElement(e,t,n){const i=this.renderedElements.findIndex((e=>e.templateData===n));if(i>=0){const e=this.renderedElements[i];this.trait.unrender(n),e.index=t}else{const e={index:t,templateData:n};this.renderedElements.push(e)}this.trait.renderIndex(t,n)}splice(e,t,n){const i=[];for(const r of this.renderedElements)r.index<e?i.push(r):r.index>=e+t&&i.push({index:r.index+n-t,templateData:r.templateData});this.renderedElements=i}renderIndexes(e){for(const{index:t,templateData:n}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,n)}disposeTemplate(e){const t=this.renderedElements.findIndex((t=>t.templateData===e));t<0||this.renderedElements.splice(t,1)}}class Ode{constructor(e){this._trait=e,this.length=0,this.indexes=[],this.sortedIndexes=[],this._onChange=new EG,this.onChange=this._onChange.event}get trait(){return this._trait}get renderer(){return new Ade(this)}splice(e,t,n){var i;t=Math.max(0,Math.min(t,this.length-e));const r=n.length-t,o=e+t,s=[...this.sortedIndexes.filter((t=>t<e)),...n.map(((t,n)=>t?n+e:-1)).filter((e=>-1!==e)),...this.sortedIndexes.filter((e=>e>=o)).map((e=>e+r))],a=this.length+r;if(this.sortedIndexes.length>0&&0===s.length&&a>0){const t=null!==(i=this.sortedIndexes.find((t=>t>=e)))&&void 0!==i?i:a-1;s.push(Math.min(t,a-1))}this.renderer.splice(e,t,n.length),this._set(s,s),this.length=a}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(Zde),t)}_set(e,t,n){const i=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const o=Xde(r,e);return this.renderer.renderIndexes(o),this._onChange.fire({indexes:e,browserEvent:n}),i}get(){return this.indexes}contains(e){return N1(this.sortedIndexes,e,Zde)>=0}dispose(){dG(this._onChange)}}Tde([T6],Ode.prototype,"renderer",null);class Rde extends Ode{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class Pde{constructor(e,t,n){this.trait=e,this.view=t,this.identityProvider=n}splice(e,t,n){if(!this.identityProvider)return this.trait.splice(e,t,n.map((()=>!1)));const i=this.trait.get().map((e=>this.identityProvider.getId(this.view.element(e)).toString())),r=n.map((e=>i.indexOf(this.identityProvider.getId(e).toString())>-1));this.trait.splice(e,t,r)}}function Fde(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName}function Bde(e){return!!e.classList.contains("monaco-editor")||!e.classList.contains("monaco-list")&&(!!e.parentElement&&Bde(e.parentElement))}class Wde{constructor(e,t,n){this.list=e,this.view=t,this.disposables=new pG,this.multipleSelectionDisposables=new pG,this.onKeyDown.filter((e=>3===e.keyCode)).on(this.onEnter,this,this.disposables),this.onKeyDown.filter((e=>16===e.keyCode)).on(this.onUpArrow,this,this.disposables),this.onKeyDown.filter((e=>18===e.keyCode)).on(this.onDownArrow,this,this.disposables),this.onKeyDown.filter((e=>11===e.keyCode)).on(this.onPageUpArrow,this,this.disposables),this.onKeyDown.filter((e=>12===e.keyCode)).on(this.onPageDownArrow,this,this.disposables),this.onKeyDown.filter((e=>9===e.keyCode)).on(this.onEscape,this,this.disposables),n.multipleSelectionSupport&&this.onKeyDown.filter((e=>(lj?e.metaKey:e.ctrlKey)&&31===e.keyCode)).on(this.onCtrlA,this,this.multipleSelectionDisposables)}get onKeyDown(){return SG.chain(this.disposables.add(new Xae(this.view.domNode,"keydown")).event).filter((e=>!Fde(e.target))).map((e=>new C$(e)))}updateOptions(e){void 0!==e.multipleSelectionSupport&&(this.multipleSelectionDisposables.clear(),e.multipleSelectionSupport&&this.onKeyDown.filter((e=>(lj?e.metaKey:e.ctrlKey)&&31===e.keyCode)).on(this.onCtrlA,this,this.multipleSelectionDisposables))}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent),this.list.reveal(this.list.getFocus()[0]),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent),this.list.reveal(this.list.getFocus()[0]),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent),this.list.reveal(this.list.getFocus()[0]),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent),this.list.reveal(this.list.getFocus()[0]),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(z1(this.list.length),e.browserEvent),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}Tde([T6],Wde.prototype,"onKeyDown",null),(Ide=Nde||(Nde={}))[Ide.Idle=0]="Idle",Ide[Ide.Typing=1]="Typing";const zde=new class{mightProducePrintableCharacter(e){return!(e.ctrlKey||e.metaKey||e.altKey)&&(e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30||e.keyCode>=93&&e.keyCode<=102||e.keyCode>=80&&e.keyCode<=90)}};class Vde{constructor(e,t,n,i){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=n,this.delegate=i,this.enabled=!1,this.state=Nde.Idle,this.automaticKeyboardNavigation=!0,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new pG,this.disposables=new pG,this.updateOptions(e.options)}updateOptions(e){void 0===e.enableKeyboardNavigation||!!e.enableKeyboardNavigation?this.enable():this.disable(),void 0!==e.automaticKeyboardNavigation&&(this.automaticKeyboardNavigation=e.automaticKeyboardNavigation)}enable(){if(this.enabled)return;const e=SG.chain(this.enabledDisposables.add(new Xae(this.view.domNode,"keydown")).event).filter((e=>!Fde(e.target))).filter((()=>this.automaticKeyboardNavigation||this.triggered)).map((e=>new C$(e))).filter((e=>this.delegate.mightProducePrintableCharacter(e))).forEach((e=>{e.stopPropagation(),e.preventDefault()})).map((e=>e.browserEvent.key)).event,t=SG.debounce(e,(()=>null),800);SG.reduce(SG.any(e,t),((e,t)=>null===t?null:(e||"")+t))(this.onInput,this,this.enabledDisposables),t(this.onClear,this,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var e;const t=this.list.getFocus();if(t.length>0&&t[0]===this.previouslyFocused){const n=null===(e=this.list.options.accessibilityProvider)||void 0===e?void 0:e.getAriaLabel(this.list.element(t[0]));n&&t5(n)}this.previouslyFocused=-1}onInput(e){if(!e)return this.state=Nde.Idle,void(this.triggered=!1);const t=this.list.getFocus(),n=t.length>0?t[0]:0,i=this.state===Nde.Idle?1:0;this.state=Nde.Typing;for(let r=0;r<this.list.length;r++){const t=(n+r+i)%this.list.length,o=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(t)),s=o&&o.toString();if(void 0===s||Zue(e,s))return this.previouslyFocused=n,this.list.setFocus([t]),void this.list.reveal(t)}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class Ude{constructor(e,t){this.list=e,this.view=t,this.disposables=new pG;SG.chain(this.disposables.add(new Xae(t.domNode,"keydown")).event).filter((e=>!Fde(e.target))).map((e=>new C$(e))).filter((e=>!(2!==e.keyCode||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey))).on(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(0===t.length)return;const n=this.view.domElement(t[0]);if(!n)return;const i=n.querySelector("[tabIndex]");if(!(i&&i instanceof HTMLElement&&-1!==i.tabIndex))return;const r=window.getComputedStyle(i);"hidden"!==r.visibility&&"none"!==r.display&&(e.preventDefault(),e.stopPropagation(),i.focus())}dispose(){this.disposables.dispose()}}function Hde(e){return lj?e.browserEvent.metaKey:e.browserEvent.ctrlKey}function jde(e){return e.browserEvent.shiftKey}const Gde={isSelectionSingleChangeEvent:Hde,isSelectionRangeChangeEvent:jde};class Kde{constructor(e){this.list=e,this.disposables=new pG,this._onPointer=new EG,this.onPointer=this._onPointer.event,!1!==e.options.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||Gde),this.mouseSupport=void 0===e.options.mouseSupport||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(O6.addTarget(e.getHTMLElement()))),SG.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){void 0!==e.multipleSelectionSupport&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||Gde))}isSelectionSingleChangeEvent(e){return!!this.multipleSelectionController&&this.multipleSelectionController.isSelectionSingleChangeEvent(e)}isSelectionRangeChangeEvent(e){return!!this.multipleSelectionController&&this.multipleSelectionController.isSelectionRangeChangeEvent(e)}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){Bde(e.browserEvent.target)||document.activeElement!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(Bde(e.browserEvent.target))return;const t=void 0===e.index?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport)return;if(Fde(e.browserEvent.target)||Bde(e.browserEvent.target))return;const t=e.index;return void 0===t?(this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),void this.list.setAnchor(void 0)):this.isSelectionRangeChangeEvent(e)||this.isSelectionChangeEvent(e)?this.changeSelection(e):(this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),(n=e.browserEvent)instanceof MouseEvent&&2===n.button||this.list.setSelection([t],e.browserEvent),void this._onPointer.fire(e));var n}onDoubleClick(e){if(Fde(e.browserEvent.target)||Bde(e.browserEvent.target))return;if(this.isSelectionChangeEvent(e))return;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let n=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){if(void 0===n){const e=this.list.getFocus()[0];n=null!=e?e:t,this.list.setAnchor(n)}const i=z1(Math.min(n,t),Math.max(n,t)+1),r=this.list.getSelection(),o=function(e,t){const n=e.indexOf(t);if(-1===n)return[];const i=[];let r=n-1;for(;r>=0&&e[r]===t-(n-r);)i.push(e[r--]);i.reverse(),r=n;for(;r<e.length&&e[r]===t+(r-n);)i.push(e[r++]);return i}(Xde(r,[n]),n);if(0===o.length)return;const s=Xde(i,function(e,t){const n=[];let i=0,r=0;for(;i<e.length||r<t.length;)if(i>=e.length)n.push(t[r++]);else if(r>=t.length)n.push(e[i++]);else{if(e[i]===t[r]){i++,r++;continue}e[i]<t[r]?n.push(e[i++]):r++}return n}(r,o));this.list.setSelection(s,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const n=this.list.getSelection(),i=n.filter((e=>e!==t));this.list.setFocus([t]),this.list.setAnchor(t),n.length===i.length?this.list.setSelection([...i,t],e.browserEvent):this.list.setSelection(i,e.browserEvent)}}dispose(){this.disposables.dispose()}}class qde{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,n=[];e.listBackground&&(e.listBackground.isOpaque()?n.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`):lj||console.warn(`List with id '${this.selectorSuffix}' was styled with a non-opaque background color. This will break sub-pixel antialiasing.`)),e.listFocusBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(n.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),n.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&n.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&n.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }\n\t\t\t`),e.listFocusAndSelectionForeground&&n.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }\n\t\t\t`),e.listInactiveFocusForeground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&n.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(n.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(n.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),n.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&n.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&n.push(`.monaco-list${t}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&n.push(`.monaco-list${t} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`),e.listSelectionOutline&&n.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listFocusOutline&&n.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`),e.listInactiveFocusOutline&&n.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&n.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropBackground&&n.push(`\n\t\t\t\t.monaco-list${t}.drop-target,\n\t\t\t\t.monaco-list${t} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropBackground} !important; color: inherit !important; }\n\t\t\t`),e.listFilterWidgetBackground&&n.push(`.monaco-list-type-filter { background-color: ${e.listFilterWidgetBackground} }`),e.listFilterWidgetOutline&&n.push(`.monaco-list-type-filter { border: 1px solid ${e.listFilterWidgetOutline}; }`),e.listFilterWidgetNoMatchesOutline&&n.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${e.listFilterWidgetNoMatchesOutline}; }`),e.listMatchesShadow&&n.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${e.listMatchesShadow}; }`),e.tableColumnsBorder&&n.push(`\n\t\t\t\t.monaco-table:hover > .monaco-split-view2,\n\t\t\t\t.monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: ${e.tableColumnsBorder};\n\t\t\t}`),this.styleElement.textContent=n.join("\n")}}const $de={listFocusBackground:Q8.fromHex("#7FB0D0"),listActiveSelectionBackground:Q8.fromHex("#0E639C"),listActiveSelectionForeground:Q8.fromHex("#FFFFFF"),listActiveSelectionIconForeground:Q8.fromHex("#FFFFFF"),listFocusAndSelectionBackground:Q8.fromHex("#094771"),listFocusAndSelectionForeground:Q8.fromHex("#FFFFFF"),listInactiveSelectionBackground:Q8.fromHex("#3F3F46"),listInactiveSelectionIconForeground:Q8.fromHex("#FFFFFF"),listHoverBackground:Q8.fromHex("#2A2D2E"),listDropBackground:Q8.fromHex("#383B3D"),treeIndentGuidesStroke:Q8.fromHex("#a9a9a9"),tableColumnsBorder:Q8.fromHex("#cccccc").transparent(.2)},Yde={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI:()=>null,onDragStart(){},onDragOver:()=>!1,drop(){}}};function Xde(e,t){const n=[];let i=0,r=0;for(;i<e.length||r<t.length;)if(i>=e.length)n.push(t[r++]);else if(r>=t.length)n.push(e[i++]);else{if(e[i]===t[r]){n.push(e[i]),i++,r++;continue}e[i]<t[r]?n.push(e[i++]):n.push(t[r++])}return n}const Zde=(e,t)=>e-t;class Qde{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map((t=>t.renderTemplate(e)))}renderElement(e,t,n,i){let r=0;for(const o of this.renderers)o.renderElement(e,t,n[r++],i)}disposeElement(e,t,n,i){let r=0;for(const o of this.renderers)o.disposeElement&&o.disposeElement(e,t,n[r],i),r+=1}disposeTemplate(e){let t=0;for(const n of this.renderers)n.disposeTemplate(e[t++])}}class Jde{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return e}renderElement(e,t,n){const i=this.accessibilityProvider.getAriaLabel(e);i?n.setAttribute("aria-label",i):n.removeAttribute("aria-label");const r=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);"number"==typeof r?n.setAttribute("aria-level",`${r}`):n.removeAttribute("aria-level")}disposeTemplate(e){}}class efe{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(e,t)}onDragOver(e,t,n,i){return this.dnd.onDragOver(e,t,n,i)}onDragLeave(e,t,n,i){var r,o;null===(o=(r=this.dnd).onDragLeave)||void 0===o||o.call(r,e,t,n,i)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}drop(e,t,n,i){this.dnd.drop(e,t,n,i)}}class tfe{constructor(e,t,n,i,r=Yde){var o;this.user=e,this._options=r,this.focus=new Ode("focused"),this.anchor=new Ode("anchor"),this.eventBufferer=new DG,this._ariaLabel="",this.disposables=new pG,this._onDidDispose=new EG,this.onDidDispose=this._onDidDispose.event;const s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?null===(o=this._options.accessibilityProvider)||void 0===o?void 0:o.getWidgetRole():"list";this.selection=new Rde("listbox"!==s),hQ(r,$de,!1);const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(a.push(new Jde(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant&&this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant,this,this.disposables)),i=i.map((e=>new Qde(e.templateId,[...a,e])));const l=Object.assign(Object.assign({},r),{dnd:r.dnd&&new efe(this,r.dnd)});if(this.view=new Lde(t,n,i,l),this.view.domNode.setAttribute("role",s),r.styleController)this.styleController=r.styleController(this.view.domId);else{const e=NY(this.view.domNode);this.styleController=new qde(e,this.view.domId)}if(this.spliceable=new Dde([new Pde(this.focus,this.view,r.identityProvider),new Pde(this.selection,this.view,r.identityProvider),new Pde(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new Ude(this,this.view)),("boolean"!=typeof r.keyboardSupport||r.keyboardSupport)&&(this.keyboardController=new Wde(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){const e=r.keyboardNavigationDelegate||zde;this.typeLabelController=new Vde(this,this.view,r.keyboardNavigationLabelProvider,e),this.disposables.add(this.typeLabelController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport&&this.view.domNode.setAttribute("aria-multiselectable","true")}get onDidChangeFocus(){return SG.map(this.eventBufferer.wrapEvent(this.focus.onChange),(e=>this.toListEvent(e)))}get onDidChangeSelection(){return SG.map(this.eventBufferer.wrapEvent(this.selection.onChange),(e=>this.toListEvent(e)))}get domId(){return this.view.domId}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=SG.chain(this.disposables.add(new Xae(this.view.domNode,"keydown")).event).map((e=>new C$(e))).filter((t=>e=58===t.keyCode||t.shiftKey&&68===t.keyCode)).map(Zae).filter((()=>!1)).event,n=SG.chain(this.disposables.add(new Xae(this.view.domNode,"keyup")).event).forEach((()=>e=!1)).map((e=>new C$(e))).filter((e=>58===e.keyCode||e.shiftKey&&68===e.keyCode)).map(Zae).map((({browserEvent:e})=>{const t=this.getFocus(),n=t.length?t[0]:void 0;return{index:n,element:void 0!==n?this.view.element(n):void 0,anchor:void 0!==n?this.view.domElement(n):this.view.domNode,browserEvent:e}})).event,i=SG.chain(this.view.onContextMenu).filter((t=>!e)).map((({element:e,index:t,browserEvent:n})=>({element:e,index:t,anchor:{x:n.pageX+1,y:n.pageY},browserEvent:n}))).event;return SG.any(t,n,i)}get onKeyDown(){return this.disposables.add(new Xae(this.view.domNode,"keydown")).event}get onDidFocus(){return SG.signal(this.disposables.add(new Xae(this.view.domNode,"focus",!0)).event)}createMouseController(e){return new Kde(this)}updateOptions(e={}){var t;this._options=Object.assign(Object.assign({},this._options),e),this.typeLabelController&&this.typeLabelController.updateOptions(this._options),void 0!==this._options.multipleSelectionController&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),null===(t=this.keyboardController)||void 0===t||t.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,n=[]){if(e<0||e>this.view.length)throw new mde(this.user,`Invalid start index: ${e}`);if(t<0)throw new mde(this.user,`Invalid delete count: ${t}`);0===t&&0===n.length||this.eventBufferer.bufferEvents((()=>this.spliceable.splice(e,t,n)))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const n of e)if(n<0||n>=this.length)throw new mde(this.user,`Invalid index ${n}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map((e=>this.view.element(e)))}setAnchor(e){if(void 0!==e){if(e<0||e>=this.length)throw new mde(this.user,`Invalid index ${e}`);this.anchor.set([e])}else this.anchor.set([])}getAnchor(){return B1(this.anchor.get(),void 0)}getAnchorElement(){const e=this.getAnchor();return void 0===e?void 0:this.element(e)}setFocus(e,t){for(const n of e)if(n<0||n>=this.length)throw new mde(this.user,`Invalid index ${n}`);this.focus.set(e,t)}focusNext(e=1,t=!1,n,i){if(0===this.length)return;const r=this.focus.get(),o=this.findNextIndex(r.length>0?r[0]+e:0,t,i);o>-1&&this.setFocus([o],n)}focusPrevious(e=1,t=!1,n,i){if(0===this.length)return;const r=this.focus.get(),o=this.findPreviousIndex(r.length>0?r[0]-e:0,t,i);o>-1&&this.setFocus([o],n)}focusNextPage(e,t){return Mde(this,void 0,void 0,(function*(){let n=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);n=0===n?0:n-1;const i=this.view.element(n),r=this.getFocusedElements()[0];if(r!==i){const i=this.findPreviousIndex(n,!1,t);i>-1&&r!==this.view.element(i)?this.setFocus([i],e):this.setFocus([n],e)}else{const i=this.view.getScrollTop();this.view.setScrollTop(i+this.view.renderHeight-this.view.elementHeight(n)),this.view.getScrollTop()!==i&&(this.setFocus([]),yield R$(0),yield this.focusNextPage(e,t))}}))}focusPreviousPage(e,t){return Mde(this,void 0,void 0,(function*(){let n;const i=this.view.getScrollTop();n=0===i?this.view.indexAt(i):this.view.indexAfter(i-1);const r=this.view.element(n),o=this.getFocusedElements()[0];if(o!==r){const i=this.findNextIndex(n,!1,t);i>-1&&o!==this.view.element(i)?this.setFocus([i],e):this.setFocus([n],e)}else{const n=i;this.view.setScrollTop(i-this.view.renderHeight),this.view.getScrollTop()!==n&&(this.setFocus([]),yield R$(0),yield this.focusPreviousPage(e,t))}}))}focusLast(e,t){if(0===this.length)return;const n=this.findPreviousIndex(this.length-1,!1,t);n>-1&&this.setFocus([n],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,n){if(0===this.length)return;const i=this.findNextIndex(e,!1,n);i>-1&&this.setFocus([i],t)}findNextIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e>=this.length&&!t)return-1;if(e%=this.length,!n||n(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,n){for(let i=0;i<this.length;i++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!n||n(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map((e=>this.view.element(e)))}reveal(e,t){if(e<0||e>=this.length)throw new mde(this.user,`Invalid index ${e}`);const n=this.view.getScrollTop(),i=this.view.elementTop(e),r=this.view.elementHeight(e);if(RZ(t)){const e=r-this.view.renderHeight;this.view.setScrollTop(e*RQ(t,0,1)+i)}else{const e=i+r,t=n+this.view.renderHeight;i<n&&e>=t||(i<n||e>=t&&r>=this.view.renderHeight?this.view.setScrollTop(i):e>=t&&this.view.setScrollTop(e-this.view.renderHeight))}}getRelativeTop(e){if(e<0||e>=this.length)throw new mde(this.user,`Invalid index ${e}`);const t=this.view.getScrollTop(),n=this.view.elementTop(e),i=this.view.elementHeight(e);if(n<t||n+i>t+this.view.renderHeight)return null;const r=i-this.view.renderHeight;return Math.abs((t-n)/r)}getHTMLElement(){return this.view.domNode}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map((e=>this.view.element(e))),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var e;const t=this.focus.get();if(t.length>0){let n;(null===(e=this.accessibilityProvider)||void 0===e?void 0:e.getActiveDescendantId)&&(n=this.accessibilityProvider.getActiveDescendantId(this.view.element(t[0]))),this.view.domNode.setAttribute("aria-activedescendant",n||this.view.getElementDomId(t[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",0===e.length),this.view.domNode.classList.toggle("selection-single",1===e.length),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}Tde([T6],tfe.prototype,"onDidChangeFocus",null),Tde([T6],tfe.prototype,"onDidChangeSelection",null),Tde([T6],tfe.prototype,"onContextMenu",null),Tde([T6],tfe.prototype,"onKeyDown",null),Tde([T6],tfe.prototype,"onDidFocus",null);class nfe{constructor(e,t){this.renderer=e,this.modelProvider=t}get templateId(){return this.renderer.templateId}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:mG.None}}renderElement(e,t,n,i){if(n.disposable&&n.disposable.dispose(),!n.data)return;const r=this.modelProvider();if(r.isResolved(e))return this.renderer.renderElement(r.get(e),e,n.data,i);const o=new OG,s=r.resolve(e,o.token);n.disposable={dispose:()=>o.cancel()},this.renderer.renderPlaceholder(e,n.data),s.then((t=>this.renderer.renderElement(t,e,n.data,i)))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class ife{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}const rfe=new M5("isWindows",aj,GH(0,"Whether the operating system is Windows"));var ofe,sfe;(sfe=ofe||(ofe={}))[sfe.Unknown=0]="Unknown",sfe[sfe.Twistie=1]="Twistie",sfe[sfe.Element=2]="Element";class afe extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class lfe{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function cfe(e){return"object"==typeof e&&"visibility"in e&&"data"in e}function ufe(e){switch(e){case!0:return 1;case!1:return 0;default:return e}}function hfe(e){return"boolean"==typeof e.collapsible}class dfe{constructor(e,t,n,i={}){this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new DG,this._onDidChangeCollapseState=new EG,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new EG,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new EG,this.onDidSplice=this._onDidSplice.event,this.collapseByDefault=void 0!==i.collapseByDefault&&i.collapseByDefault,this.filter=i.filter,this.autoExpandSingleChildren=void 0!==i.autoExpandSingleChildren&&i.autoExpandSingleChildren,this.root={parent:void 0,element:n,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,n=lG.empty(),i={}){if(0===e.length)throw new afe(this.user,"Invalid tree location");i.diffIdentityProvider?this.spliceSmart(i.diffIdentityProvider,e,t,n,i):this.spliceSimple(e,t,n,i)}spliceSmart(e,t,n,i,r,o){var s;void 0===i&&(i=lG.empty()),void 0===o&&(o=null!==(s=r.diffDepth)&&void 0!==s?s:0);const{parentNode:a}=this.getParentNodeWithListIndex(t),l=[...i],c=t[t.length-1],u=new e1({getElements:()=>a.children.map((t=>e.getId(t.element).toString()))},{getElements:()=>[...a.children.slice(0,c),...l,...a.children.slice(c+n)].map((t=>e.getId(t.element).toString()))}).ComputeDiff(!1);if(u.quitEarly)return this.spliceSimple(t,n,l,r);const h=t.slice(0,-1),d=(t,n,i)=>{if(o>0)for(let s=0;s<i;s++)t--,n--,this.spliceSmart(e,[...h,t,0],Number.MAX_SAFE_INTEGER,l[n].children,r,o-1)};let f=Math.min(a.children.length,c+n),g=l.length;for(const p of u.changes.sort(((e,t)=>t.originalStart-e.originalStart)))d(f,g,f-(p.originalStart+p.originalLength)),f=p.originalStart,g=p.modifiedStart-c,this.spliceSimple([...h,f],p.originalLength,lG.slice(l,g,g+p.modifiedLength),r);d(f,g,f)}spliceSimple(e,t,n=lG.empty(),{onDidCreateNode:i,onDidDeleteNode:r}){const{parentNode:o,listIndex:s,revealed:a,visible:l}=this.getParentNodeWithListIndex(e),c=[],u=lG.map(n,(e=>this.createTreeNode(e,o,o.visible?1:0,a,c,i))),h=e[e.length-1],d=o.children.length>0;let f=0;for(let w=h;w>=0&&w<o.children.length;w--){const e=o.children[w];if(e.visible){f=e.visibleChildIndex;break}}const g=[];let p=0,m=0;for(const w of u)g.push(w),m+=w.renderNodeCount,w.visible&&(w.visibleChildIndex=f+p++);const v=o.children.splice(h,t,...g);let y=0;for(const w of v)w.visible&&y++;if(0!==y)for(let w=h+g.length;w<o.children.length;w++){const e=o.children[w];e.visible&&(e.visibleChildIndex-=y)}if(o.visibleChildrenCount+=p-y,a&&l){const e=v.reduce(((e,t)=>e+(t.visible?t.renderNodeCount:0)),0);this._updateAncestorsRenderNodeCount(o,m-e),this.list.splice(s,e,c)}if(v.length>0&&r){const e=t=>{r(t),t.children.forEach(e)};v.forEach(e)}const _=o.children.length>0;d!==_&&this.setCollapsible(e.slice(0,-1),_),this._onDidSplice.fire({insertedNodes:g,deletedNodes:v});let b=o;for(;b;){if(2===b.visibility){this.refilter();break}b=b.parent}}rerender(e){if(0===e.length)throw new afe(this.user,"Invalid tree location");const{node:t,listIndex:n,revealed:i}=this.getTreeNodeWithListIndex(e);t.visible&&i&&this.list.splice(n,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:n,revealed:i}=this.getTreeNodeWithListIndex(e);return n&&i?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const n=this.getTreeNode(e);void 0===t&&(t=!n.collapsible);const i={collapsible:t};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(e,i)))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,n){const i=this.getTreeNode(e);void 0===t&&(t=!i.collapsed);const r={collapsed:t,recursive:n||!1};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(e,r)))}_setCollapseState(e,t){const{node:n,listIndex:i,revealed:r}=this.getTreeNodeWithListIndex(e),o=this._setListNodeCollapseState(n,i,r,t);if(n!==this.root&&this.autoExpandSingleChildren&&o&&!hfe(t)&&n.collapsible&&!n.collapsed&&!t.recursive){let i=-1;for(let e=0;e<n.children.length;e++){if(n.children[e].visible){if(i>-1){i=-1;break}i=e}}i>-1&&this._setCollapseState([...e,i],t)}return o}_setListNodeCollapseState(e,t,n,i){const r=this._setNodeCollapseState(e,i,!1);if(!n||!e.visible||!r)return r;const o=e.renderNodeCount,s=this.updateNodeAfterCollapseChange(e),a=o-(-1===t?0:1);return this.list.splice(t+1,a,s.slice(1)),r}_setNodeCollapseState(e,t,n){let i;if(e===this.root?i=!1:(hfe(t)?(i=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(i=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):i=!1,i&&this._onDidChangeCollapseState.fire({node:e,deep:n})),!hfe(t)&&t.recursive)for(const r of e.children)i=this._setNodeCollapseState(r,t,!0)||i;return i}expandTo(e){this.eventBufferer.bufferEvents((()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})}))}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t)}createTreeNode(e,t,n,i,r,o){const s={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:"boolean"==typeof e.collapsible?e.collapsible:void 0!==e.collapsed,collapsed:void 0===e.collapsed?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},a=this._filterNode(s,n);s.visibility=a,i&&r.push(s);const l=e.children||lG.empty(),c=i&&0!==a&&!s.collapsed,u=lG.map(l,(e=>this.createTreeNode(e,s,a,c,r,o)));let h=0,d=1;for(const f of u)s.children.push(f),d+=f.renderNodeCount,f.visible&&(f.visibleChildIndex=h++);return s.collapsible=s.collapsible||s.children.length>0,s.visibleChildrenCount=h,s.visible=2===a?h>0:1===a,s.visible?s.collapsed||(s.renderNodeCount=d):(s.renderNodeCount=0,i&&r.pop()),o&&o(s),s}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,n=[];return this._updateNodeAfterCollapseChange(e,n),this._updateAncestorsRenderNodeCount(e.parent,n.length-t),n}_updateNodeAfterCollapseChange(e,t){if(!1===e.visible)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const n of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(n,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,n=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,n),this._updateAncestorsRenderNodeCount(e.parent,n.length-t),n}_updateNodeAfterFilterChange(e,t,n,i=!0){let r;if(e!==this.root){if(r=this._filterNode(e,t),0===r)return e.visible=!1,e.renderNodeCount=0,!1;i&&n.push(e)}const o=n.length;e.renderNodeCount=e===this.root?0:1;let s=!1;if(e.collapsed&&0===r)e.visibleChildrenCount=0;else{let t=0;for(const o of e.children)s=this._updateNodeAfterFilterChange(o,r,n,i&&!e.collapsed)||s,o.visible&&(o.visibleChildIndex=t++);e.visibleChildrenCount=t}return e!==this.root&&(e.visible=2===r?s:1===r),e.visible?e.collapsed||(e.renderNodeCount+=n.length-o):(e.renderNodeCount=0,i&&n.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(0!==t)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const n=this.filter?this.filter.filter(e.element,t):1;return"boolean"==typeof n?(e.filterData=void 0,n?1:0):cfe(n)?(e.filterData=n.data,ufe(n.visibility)):(e.filterData=void 0,ufe(n))}hasTreeNode(e,t=this.root){if(!e||0===e.length)return!0;const[n,...i]=e;return!(n<0||n>t.children.length)&&this.hasTreeNode(i,t.children[n])}getTreeNode(e,t=this.root){if(!e||0===e.length)return t;const[n,...i]=e;if(n<0||n>t.children.length)throw new afe(this.user,"Invalid tree location");return this.getTreeNode(i,t.children[n])}getTreeNodeWithListIndex(e){if(0===e.length)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:n,revealed:i,visible:r}=this.getParentNodeWithListIndex(e),o=e[e.length-1];if(o<0||o>t.children.length)throw new afe(this.user,"Invalid tree location");const s=t.children[o];return{node:s,listIndex:n,revealed:i,visible:r&&s.visible}}getParentNodeWithListIndex(e,t=this.root,n=0,i=!0,r=!0){const[o,...s]=e;if(o<0||o>t.children.length)throw new afe(this.user,"Invalid tree location");for(let a=0;a<o;a++)n+=t.children[a].renderNodeCount;return i=i&&!t.collapsed,r=r&&t.visible,0===s.length?{parentNode:t,listIndex:n,revealed:i,visible:r}:this.getParentNodeWithListIndex(s,t.children[o],n+1,i,r)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let n=e;for(;n.parent;)t.push(n.parent.children.indexOf(n)),n=n.parent;return t.reverse()}getParentNodeLocation(e){return 0===e.length?void 0:1===e.length?[]:function(e){if(0===e.length)throw new Error("Invalid tail call");return[e.slice(0,e.length-1),e[e.length-1]]}(e)[0]}}const ffe=uJ("tree-item-expanded",hJ.chevronDown),gfe=uJ("tree-filter-on-type-on",hJ.listFilter),pfe=uJ("tree-filter-on-type-off",hJ.listSelection),mfe=uJ("tree-filter-clear",hJ.close),vfe=uJ("tree-item-loading",hJ.loading);class yfe extends Sde{constructor(e){super(e.elements.map((e=>e.element))),this.data=e}}function _fe(e){return e instanceof Sde?new yfe(e):e}class bfe{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=mG.None}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map((e=>e.element)),t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(_fe(e),t)}onDragOver(e,t,n,i,r=!0){const o=this.dnd.onDragOver(_fe(e),t&&t.element,n,i),s=this.autoExpandNode!==t;if(s&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),void 0===t)return o;if(s&&"boolean"!=typeof o&&o.autoExpand&&(this.autoExpandDisposable=P$((()=>{const e=this.modelProvider(),n=e.getNodeLocation(t);e.isCollapsed(n)&&e.setCollapsed(n,!1),this.autoExpandNode=void 0}),500)),"boolean"==typeof o||!o.accept||void 0===o.bubble||o.feedback){if(!r){return{accept:"boolean"==typeof o?o:o.accept,effect:"boolean"==typeof o?void 0:o.effect,feedback:[n]}}return o}if(1===o.bubble){const n=this.modelProvider(),r=n.getNodeLocation(t),o=n.getParentNodeLocation(r),s=n.getNode(o),a=o&&n.getListIndex(o);return this.onDragOver(e,s,a,i,!1)}const a=this.modelProvider(),l=a.getNodeLocation(t),c=a.getListIndex(l),u=a.getListRenderCount(l);return Object.assign(Object.assign({},o),{feedback:z1(c,c+u)})}drop(e,t,n,i){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(_fe(e),t&&t.element,n,i)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}}class wfe{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){this.delegate.setDynamicHeight&&this.delegate.setDynamicHeight(e.element,t)}}var Cfe,Sfe;(Sfe=Cfe||(Cfe={})).None="none",Sfe.OnHover="onHover",Sfe.Always="always";class xfe{constructor(e,t=[]){this._elements=t,this.onDidChange=SG.forEach(e,(e=>this._elements=e))}get elements(){return this._elements}}class Efe{constructor(e,t,n,i,r={}){this.renderer=e,this.modelProvider=t,this.activeNodes=i,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=Efe.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.renderedIndentGuides=new D3,this.activeIndentNodes=new Set,this.indentGuidesDisposable=mG.None,this.disposables=new pG,this.templateId=e.templateId,this.updateOptions(r),SG.map(n,(e=>e.node))(this.onDidChangeNodeTwistieState,this,this.disposables),e.onDidChangeTwistieState&&e.onDidChangeTwistieState(this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(void 0!==e.indent&&(this.indent=RQ(e.indent,0,40)),void 0!==e.renderIndentGuides){const t=e.renderIndentGuides!==Cfe.None;if(t!==this.shouldRenderIndentGuides&&(this.shouldRenderIndentGuides=t,this.indentGuidesDisposable.dispose(),t)){const e=new pG;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,e),this.indentGuidesDisposable=e,this._onDidChangeActiveNodes(this.activeNodes.elements)}}void 0!==e.hideTwistiesOfChildlessElements&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=WY(e,GY(".monaco-tl-row")),n=WY(t,GY(".monaco-tl-indent")),i=WY(t,GY(".monaco-tl-twistie")),r=WY(t,GY(".monaco-tl-contents")),o=this.renderer.renderTemplate(r);return{container:e,indent:n,twistie:i,indentGuidesDisposable:mG.None,templateData:o}}renderElement(e,t,n,i){"number"==typeof i&&(this.renderedNodes.set(e,{templateData:n,height:i}),this.renderedElements.set(e.element,e));const r=Efe.DefaultIndent+(e.depth-1)*this.indent;n.twistie.style.paddingLeft=`${r}px`,n.indent.style.width=r+this.indent-16+"px",this.renderTwistie(e,n),"number"==typeof i&&this.renderIndentGuides(e,n),this.renderer.renderElement(e,t,n.templateData,i)}disposeElement(e,t,n,i){n.indentGuidesDisposable.dispose(),this.renderer.disposeElement&&this.renderer.disposeElement(e,t,n.templateData,i),"number"==typeof i&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this.renderTwistie(e,t.templateData),this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderIndentGuides(e,t.templateData))}renderTwistie(e,t){t.twistie.classList.remove(...ffe.classNamesArray);let n=!1;this.renderer.renderTwistie&&(n=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(n||t.twistie.classList.add(...ffe.classNamesArray),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded")}renderIndentGuides(e,t){if(Y$(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const n=new pG,i=this.modelProvider();let r=e;for(;;){const e=i.getNodeLocation(r),o=i.getParentNodeLocation(e);if(!o)break;const s=i.getNode(o),a=GY(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(s)&&a.classList.add("active"),0===t.indent.childElementCount?t.indent.appendChild(a):t.indent.insertBefore(a,t.indent.firstElementChild),this.renderedIndentGuides.add(s,a),n.add(gG((()=>this.renderedIndentGuides.delete(s,a)))),r=s}t.indentGuidesDisposable=n}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,n=this.modelProvider();e.forEach((e=>{const i=n.getNodeLocation(e);try{const r=n.getParentNodeLocation(i);e.collapsible&&e.children.length>0&&!e.collapsed?t.add(e):r&&t.add(n.getNode(r))}catch(r){}})),this.activeIndentNodes.forEach((e=>{t.has(e)||this.renderedIndentGuides.forEach(e,(e=>e.classList.remove("active")))})),t.forEach((e=>{this.activeIndentNodes.has(e)||this.renderedIndentGuides.forEach(e,(e=>e.classList.add("active")))})),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),dG(this.disposables)}}Efe.DefaultIndent=8;class kfe{constructor(e,t,n){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=n,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new pG,e.onWillRefilter(this.reset,this,this.disposables)}get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}set pattern(e){this._pattern=e,this._lowercasePattern=e.toLowerCase()}filter(e,t){if(this._filter){const n=this._filter.filter(e,t);if(this.tree.options.simpleKeyboardNavigation)return n;let i;if(i="boolean"==typeof n?n?1:0:cfe(n)?ufe(n.visibility):n,0===i)return!1}if(this._totalCount++,this.tree.options.simpleKeyboardNavigation||!this._pattern)return this._matchCount++,{data:Nhe.Default,visibility:!0};const n=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),i=Array.isArray(n)?n:[n];for(const r of i){const e=r&&r.toString();if(void 0===e)return{data:Nhe.Default,visibility:!0};const t=The(this._pattern,this._lowercasePattern,0,e,e.toLowerCase(),0,!0);if(t)return this._matchCount++,1===i.length?{data:t,visibility:!0}:{data:{label:e,score:t},visibility:!0}}return this.tree.options.filterOnType?2:{data:Nhe.Default,visibility:!0}}reset(){this._totalCount=0,this._matchCount=0}dispose(){dG(this.disposables)}}class Lfe{constructor(e,t,n,i,r){this.tree=e,this.view=n,this.filter=i,this.keyboardNavigationDelegate=r,this._enabled=!1,this._pattern="",this._empty=!1,this._onDidChangeEmptyState=new EG,this.positionClassName="ne",this.automaticKeyboardNavigation=!0,this.triggered=!1,this._onDidChangePattern=new EG,this.enabledDisposables=new pG,this.disposables=new pG,this.domNode=GY(`.monaco-list-type-filter.${this.positionClassName}`),this.domNode.draggable=!0,this.disposables.add(Q$(this.domNode,"dragstart",(()=>this.onDragStart()))),this.messageDomNode=WY(n.getHTMLElement(),GY(".monaco-list-type-filter-message")),this.labelDomNode=WY(this.domNode,GY("span.label"));const o=WY(this.domNode,GY(".controls"));this._filterOnType=!!e.options.filterOnType,this.filterOnTypeDomNode=WY(o,GY("input.filter")),this.filterOnTypeDomNode.type="checkbox",this.filterOnTypeDomNode.checked=this._filterOnType,this.filterOnTypeDomNode.tabIndex=-1,this.updateFilterOnTypeTitleAndIcon(),this.disposables.add(Q$(this.filterOnTypeDomNode,"input",(()=>this.onDidChangeFilterOnType()))),this.clearDomNode=WY(o,GY("button.clear"+mfe.cssSelector)),this.clearDomNode.tabIndex=-1,this.clearDomNode.title=GH(0,"Clear"),this.keyboardNavigationEventFilter=e.options.keyboardNavigationEventFilter,t.onDidSplice(this.onDidSpliceModel,this,this.disposables),this.updateOptions(e.options)}get enabled(){return this._enabled}get pattern(){return this._pattern}get filterOnType(){return this._filterOnType}updateOptions(e){e.simpleKeyboardNavigation?this.disable():this.enable(),void 0!==e.filterOnType&&(this._filterOnType=!!e.filterOnType,this.filterOnTypeDomNode.checked=this._filterOnType,this.updateFilterOnTypeTitleAndIcon()),void 0!==e.automaticKeyboardNavigation&&(this.automaticKeyboardNavigation=e.automaticKeyboardNavigation),this.tree.refilter(),this.render(),this.automaticKeyboardNavigation||this.onEventOrInput("")}enable(){if(this._enabled)return;const e=this.enabledDisposables.add(new Xae(this.view.getHTMLElement(),"keydown")),t=SG.chain(e.event).filter((e=>!Fde(e.target)||e.target===this.filterOnTypeDomNode)).filter((e=>"Dead"!==e.key&&!/^Media/.test(e.key))).map((e=>new C$(e))).filter(this.keyboardNavigationEventFilter||(()=>!0)).filter((()=>this.automaticKeyboardNavigation||this.triggered)).filter((e=>this.keyboardNavigationDelegate.mightProducePrintableCharacter(e)&&!(18===e.keyCode||16===e.keyCode||15===e.keyCode||17===e.keyCode)||(this.pattern.length>0||this.triggered)&&(9===e.keyCode||1===e.keyCode)&&!e.altKey&&!e.ctrlKey&&!e.metaKey||1===e.keyCode&&(lj?e.altKey&&!e.metaKey:e.ctrlKey)&&!e.shiftKey)).forEach((e=>{e.stopPropagation(),e.preventDefault()})).event,n=this.enabledDisposables.add(new Xae(this.clearDomNode,"click"));SG.chain(SG.any(t,n.event)).event(this.onEventOrInput,this,this.enabledDisposables),this.filter.pattern="",this.tree.refilter(),this.render(),this._enabled=!0,this.triggered=!1}disable(){this._enabled&&(this.domNode.remove(),this.enabledDisposables.clear(),this.tree.refilter(),this.render(),this._enabled=!1,this.triggered=!1)}onEventOrInput(e){"string"==typeof e?this.onInput(e):e instanceof MouseEvent||9===e.keyCode||1===e.keyCode&&(lj?e.altKey:e.ctrlKey)?this.onInput(""):1===e.keyCode?this.onInput(0===this.pattern.length?"":this.pattern.substr(0,this.pattern.length-1)):this.onInput(this.pattern+e.browserEvent.key)}onInput(e){const t=this.view.getHTMLElement();e&&!this.domNode.parentElement?t.append(this.domNode):!e&&this.domNode.parentElement&&(this.domNode.remove(),this.tree.domFocus()),this._pattern=e,this._onDidChangePattern.fire(e),this.filter.pattern=e,this.tree.refilter(),e&&this.tree.focusNext(0,!0,void 0,(e=>!Nhe.isDefault(e.filterData)));const n=this.tree.getFocus();if(n.length>0){const e=n[0];null===this.tree.getRelativeTop(e)&&this.tree.reveal(e,.5)}this.render(),e||(this.triggered=!1)}onDragStart(){const e=this.view.getHTMLElement(),{left:t}=mY(e),n=e.clientWidth,i=n/2,r=this.domNode.clientWidth,o=new pG;let s=this.positionClassName;const a=()=>{switch(s){case"nw":this.domNode.style.top="4px",this.domNode.style.left="4px";break;case"ne":this.domNode.style.top="4px",this.domNode.style.left=n-r-6+"px"}},l=()=>{this.positionClassName=s,this.domNode.className=`monaco-list-type-filter ${this.positionClassName}`,this.domNode.style.top="",this.domNode.style.left="",dG(o)};a(),this.domNode.classList.remove(s),this.domNode.classList.add("dragging"),o.add(gG((()=>this.domNode.classList.remove("dragging")))),o.add(Q$(document,"dragover",(e=>(e=>{e.preventDefault();const n=e.clientX-t;e.dataTransfer&&(e.dataTransfer.dropEffect="none"),s=n<i?"nw":"ne",a()})(e)))),o.add(Q$(this.domNode,"dragend",(()=>l()))),_le.CurrentDragAndDropData=new yle("vscode-ui"),o.add(gG((()=>_le.CurrentDragAndDropData=void 0)))}onDidSpliceModel(){this._enabled&&0!==this.pattern.length&&(this.tree.refilter(),this.render())}onDidChangeFilterOnType(){this.tree.updateOptions({filterOnType:this.filterOnTypeDomNode.checked}),this.tree.refilter(),this.tree.domFocus(),this.render(),this.updateFilterOnTypeTitleAndIcon()}updateFilterOnTypeTitleAndIcon(){this.filterOnType?(this.filterOnTypeDomNode.classList.remove(...pfe.classNamesArray),this.filterOnTypeDomNode.classList.add(...gfe.classNamesArray),this.filterOnTypeDomNode.title=GH(0,"Disable Filter on Type")):(this.filterOnTypeDomNode.classList.remove(...gfe.classNamesArray),this.filterOnTypeDomNode.classList.add(...pfe.classNamesArray),this.filterOnTypeDomNode.title=GH(0,"Enable Filter on Type"))}render(){const e=this.filter.totalCount>0&&0===this.filter.matchCount;this.pattern&&this.tree.options.filterOnType&&e?(this.messageDomNode.textContent=GH(0,"No elements found"),this._empty=!0):(this.messageDomNode.innerText="",this._empty=!1),this.domNode.classList.toggle("no-matches",e),this.domNode.title=GH(0,"Matched {0} out of {1} elements",this.filter.matchCount,this.filter.totalCount),this.labelDomNode.textContent=this.pattern.length>16?"…"+this.pattern.substr(this.pattern.length-16):this.pattern,this._onDidChangeEmptyState.fire(this._empty)}shouldAllowFocus(e){return!(this.enabled&&this.pattern&&!this.filterOnType)||(this.filter.totalCount>0&&this.filter.matchCount<=1||!Nhe.isDefault(e.filterData))}dispose(){this._enabled&&(this.domNode.remove(),this.enabledDisposables.dispose(),this._enabled=!1,this.triggered=!1),this._onDidChangePattern.dispose(),dG(this.disposables)}}function Dfe(e){let t=ofe.Unknown;return xY(e.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?t=ofe.Twistie:xY(e.browserEvent.target,"monaco-tl-contents","monaco-tl-row")&&(t=ofe.Element),{browserEvent:e.browserEvent,element:e.element?e.element.element:null,target:t}}function Nfe(e,t){t(e),e.children.forEach((e=>Nfe(e,t)))}class Ife{constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new EG,this.onDidChange=this._onDidChange.event}get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(e,t){var n;!(null===(n=t)||void 0===n?void 0:n.__forceEvent)&&D1(this.nodes,e)||this._set(e,!1,t)}_set(e,t,n){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const e=this;this._onDidChange.fire({get elements(){return e.get()},browserEvent:n})}}get(){return this.elements||(this.elements=this.nodes.map((e=>e.element))),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const e=this.createNodeSet(),n=t=>e.delete(t);return t.forEach((e=>Nfe(e,n))),void this.set([...e.values()])}const n=new Set,i=e=>n.add(this.identityProvider.getId(e.element).toString());t.forEach((e=>Nfe(e,i)));const r=new Map,o=e=>r.set(this.identityProvider.getId(e.element).toString(),e);e.forEach((e=>Nfe(e,o)));const s=[];for(const a of this.nodes){const e=this.identityProvider.getId(a.element).toString();if(n.has(e)){const t=r.get(e);t&&s.push(t)}else s.push(a)}if(this.nodes.length>0&&0===s.length){const e=this.getFirstViewElementWithTrait();e&&s.push(e)}this._set(s,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class Tfe extends Kde{constructor(e,t){super(e),this.tree=t}onViewPointer(e){if(Fde(e.browserEvent.target)||Bde(e.browserEvent.target))return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const n=e.browserEvent.target,i=n.classList.contains("monaco-tl-twistie")||n.classList.contains("monaco-icon-label")&&n.classList.contains("folder-icon")&&e.browserEvent.offsetX<16;let r=!1;if(r="function"==typeof this.tree.expandOnlyOnTwistieClick?this.tree.expandOnlyOnTwistieClick(t.element):!!this.tree.expandOnlyOnTwistieClick,r&&!i&&2!==e.browserEvent.detail)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&2===e.browserEvent.detail)return super.onViewPointer(e);if(t.collapsible){const n=this.tree.model,o=n.getNodeLocation(t),s=e.browserEvent.altKey;if(this.tree.setFocus([o]),n.setCollapsed(o,void 0,s),r&&i)return}super.onViewPointer(e)}onDoubleClick(e){!e.browserEvent.target.classList.contains("monaco-tl-twistie")&&this.tree.expandOnDoubleClick&&super.onDoubleClick(e)}}class Mfe extends tfe{constructor(e,t,n,i,r,o,s,a){super(e,t,n,i,a),this.focusTrait=r,this.selectionTrait=o,this.anchorTrait=s}createMouseController(e){return new Tfe(this,e.tree)}splice(e,t,n=[]){if(super.splice(e,t,n),0===n.length)return;const i=[],r=[];let o;n.forEach(((t,n)=>{this.focusTrait.has(t)&&i.push(e+n),this.selectionTrait.has(t)&&r.push(e+n),this.anchorTrait.has(t)&&(o=e+n)})),i.length>0&&super.setFocus(F1([...super.getFocus(),...i])),r.length>0&&super.setSelection(F1([...super.getSelection(),...r])),"number"==typeof o&&super.setAnchor(o)}setFocus(e,t,n=!1){super.setFocus(e,t),n||this.focusTrait.set(e.map((e=>this.element(e))),t)}setSelection(e,t,n=!1){super.setSelection(e,t),n||this.selectionTrait.set(e.map((e=>this.element(e))),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(void 0===e?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class Afe{constructor(e,t,n,i,r={}){this._options=r,this.eventBufferer=new DG,this.disposables=new pG,this._onWillRefilter=new EG,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new EG;const o=new wfe(n),s=new NG,a=new NG,l=new xfe(a.event);this.renderers=i.map((e=>new Efe(e,(()=>this.model),s.event,l,r)));for(let f of this.renderers)this.disposables.add(f);let c;var u,h;r.keyboardNavigationLabelProvider&&(c=new kfe(this,r.keyboardNavigationLabelProvider,r.filter),r=Object.assign(Object.assign({},r),{filter:c}),this.disposables.add(c)),this.focus=new Ife((()=>this.view.getFocusedElements()[0]),r.identityProvider),this.selection=new Ife((()=>this.view.getSelectedElements()[0]),r.identityProvider),this.anchor=new Ife((()=>this.view.getAnchorElement()),r.identityProvider),this.view=new Mfe(e,t,o,this.renderers,this.focus,this.selection,this.anchor,Object.assign(Object.assign({},(u=()=>this.model,(h=r)&&Object.assign(Object.assign({},h),{identityProvider:h.identityProvider&&{getId:e=>h.identityProvider.getId(e.element)},dnd:h.dnd&&new bfe(u,h.dnd),multipleSelectionController:h.multipleSelectionController&&{isSelectionSingleChangeEvent:e=>h.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},e),{element:e.element})),isSelectionRangeChangeEvent:e=>h.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))},accessibilityProvider:h.accessibilityProvider&&Object.assign(Object.assign({},h.accessibilityProvider),{getSetSize(e){const t=u(),n=t.getNodeLocation(e),i=t.getParentNodeLocation(n);return t.getNode(i).visibleChildrenCount},getPosInSet:e=>e.visibleChildIndex+1,isChecked:h.accessibilityProvider&&h.accessibilityProvider.isChecked?e=>h.accessibilityProvider.isChecked(e.element):void 0,getRole:h.accessibilityProvider&&h.accessibilityProvider.getRole?e=>h.accessibilityProvider.getRole(e.element):()=>"treeitem",getAriaLabel:e=>h.accessibilityProvider.getAriaLabel(e.element),getWidgetAriaLabel:()=>h.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:h.accessibilityProvider&&h.accessibilityProvider.getWidgetRole?()=>h.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:h.accessibilityProvider&&h.accessibilityProvider.getAriaLevel?e=>h.accessibilityProvider.getAriaLevel(e.element):e=>e.depth,getActiveDescendantId:h.accessibilityProvider.getActiveDescendantId&&(e=>h.accessibilityProvider.getActiveDescendantId(e.element))}),keyboardNavigationLabelProvider:h.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},h.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel:e=>h.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}),enableKeyboardNavigation:h.simpleKeyboardNavigation}))),{tree:this})),this.model=this.createModel(e,this.view,r),s.input=this.model.onDidChangeCollapseState;const d=SG.forEach(this.model.onDidSplice,(e=>{this.eventBufferer.bufferEvents((()=>{this.focus.onDidModelSplice(e),this.selection.onDidModelSplice(e)}))}));if(d((()=>null),null,this.disposables),a.input=SG.chain(SG.any(d,this.focus.onDidChange,this.selection.onDidChange)).debounce((()=>null),0).map((()=>{const e=new Set;for(const t of this.focus.getNodes())e.add(t);for(const t of this.selection.getNodes())e.add(t);return[...e.values()]})).event,!1!==r.keyboardSupport){const e=SG.chain(this.view.onKeyDown).filter((e=>!Fde(e.target))).map((e=>new C$(e)));e.filter((e=>15===e.keyCode)).on(this.onLeftArrow,this,this.disposables),e.filter((e=>17===e.keyCode)).on(this.onRightArrow,this,this.disposables),e.filter((e=>10===e.keyCode)).on(this.onSpace,this,this.disposables)}if(r.keyboardNavigationLabelProvider){const e=r.keyboardNavigationDelegate||zde;this.typeFilterController=new Lfe(this,this.model,this.view,c,e),this.focusNavigationFilter=e=>this.typeFilterController.shouldAllowFocus(e),this.disposables.add(this.typeFilterController)}this.styleElement=NY(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Cfe.Always)}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return SG.map(this.view.onMouseDblClick,Dfe)}get onPointer(){return SG.map(this.view.onPointer,Dfe)}get onDidFocus(){return this.view.onDidFocus}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get expandOnDoubleClick(){return void 0===this._options.expandOnDoubleClick||this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return void 0===this._options.expandOnlyOnTwistieClick||this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}updateOptions(e={}){this._options=Object.assign(Object.assign({},this._options),e);for(const t of this.renderers)t.updateOptions(e);this.view.updateOptions(Object.assign(Object.assign({},this._options),{enableKeyboardNavigation:this._options.simpleKeyboardNavigation})),this.typeFilterController&&this.typeFilterController.updateOptions(this._options),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Cfe.Always)}get options(){return this._options}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}domFocus(){this.view.domFocus()}layout(e,t){this.view.layout(e,t)}style(e){const t=`.${this.view.domId}`,n=[];e.treeIndentGuidesStroke&&(n.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeIndentGuidesStroke.transparent(.4)}; }`),n.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`)),this.styleElement.textContent=n.join("\n"),this.view.style(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){const n=e.map((e=>this.model.getNode(e)));this.selection.set(n,t);const i=e.map((e=>this.model.getListIndex(e))).filter((e=>e>-1));this.view.setSelection(i,t,!0)}getSelection(){return this.selection.get()}setFocus(e,t){const n=e.map((e=>this.model.getNode(e)));this.focus.set(n,t);const i=e.map((e=>this.model.getListIndex(e))).filter((e=>e>-1));this.view.setFocus(i,t,!0)}focusNext(e=1,t=!1,n,i=this.focusNavigationFilter){this.view.focusNext(e,t,n,i)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const n=this.model.getListIndex(e);-1!==n&&this.view.reveal(n,t)}getRelativeTop(e){const t=this.model.getListIndex(e);return-1===t?null:this.view.getRelativeTop(t)}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const n=t[0],i=this.model.getNodeLocation(n);if(!this.model.setCollapsed(i,!0)){const e=this.model.getParentNodeLocation(i);if(!e)return;const t=this.model.getListIndex(e);this.view.reveal(t),this.view.setFocus([t])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const n=t[0],i=this.model.getNodeLocation(n);if(!this.model.setCollapsed(i,!1)){if(!n.children.some((e=>e.visible)))return;const[e]=this.view.getFocus(),t=e+1;this.view.reveal(t),this.view.setFocus([t])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const n=t[0],i=this.model.getNodeLocation(n),r=e.browserEvent.altKey;this.model.setCollapsed(i,void 0,r)}dispose(){dG(this.disposables),this.view.dispose()}}class Ofe{constructor(e,t,n={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new dfe(e,t,null,n),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,n.sorter&&(this.sorter={compare:(e,t)=>n.sorter.compare(e.element,t.element)}),this.identityProvider=n.identityProvider}setChildren(e,t=lG.empty(),n={}){const i=this.getElementLocation(e);this._setChildren(i,this.preserveCollapseState(t),n)}_setChildren(e,t=lG.empty(),n){const i=new Set,r=new Set;this.model.splice([...e,0],Number.MAX_VALUE,t,Object.assign(Object.assign({},n),{onDidCreateNode:e=>{var t;if(null===e.element)return;const o=e;if(i.add(o.element),this.nodes.set(o.element,o),this.identityProvider){const e=this.identityProvider.getId(o.element).toString();r.add(e),this.nodesByIdentity.set(e,o)}null===(t=n.onDidCreateNode)||void 0===t||t.call(n,o)},onDidDeleteNode:e=>{var t;if(null===e.element)return;const o=e;if(i.has(o.element)||this.nodes.delete(o.element),this.identityProvider){const e=this.identityProvider.getId(o.element).toString();r.has(e)||this.nodesByIdentity.delete(e)}null===(t=n.onDidDeleteNode)||void 0===t||t.call(n,o)}}))}preserveCollapseState(e=lG.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),lG.map(e,(e=>{let t=this.nodes.get(e.element);if(!t&&this.identityProvider){const n=this.identityProvider.getId(e.element).toString();t=this.nodesByIdentity.get(n)}if(!t)return Object.assign(Object.assign({},e),{children:this.preserveCollapseState(e.children)});const n="boolean"==typeof e.collapsible?e.collapsible:t.collapsible,i=void 0!==e.collapsed?e.collapsed:t.collapsed;return Object.assign(Object.assign({},e),{collapsible:n,collapsed:i,children:this.preserveCollapseState(e.children)})}))}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const n=this.getElementLocation(e);return this.model.setCollapsible(n,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,n){const i=this.getElementLocation(e);return this.model.setCollapsed(i,t,n)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(null===e)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new afe(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(null===e)throw new afe(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new afe(this.user,`Tree element not found: ${e}`);const n=this.model.getNodeLocation(t),i=this.model.getParentNodeLocation(n);return this.model.getNode(i).element}getElementLocation(e){if(null===e)return[];const t=this.nodes.get(e);if(!t)throw new afe(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function Rfe(e){return{element:{elements:[e.element],incompressible:e.incompressible||!1},children:lG.map(lG.from(e.children),Rfe),collapsible:e.collapsible,collapsed:e.collapsed}}function Pfe(e){const t=[e.element],n=e.incompressible||!1;let i,r;for(;[r,i]=lG.consume(lG.from(e.children),2),1===r.length&&!r[0].incompressible;)e=r[0],t.push(e.element);return{element:{elements:t,incompressible:n},children:lG.map(lG.concat(r,i),Pfe),collapsible:e.collapsible,collapsed:e.collapsed}}function Ffe(e,t=0){let n;return n=t<e.element.elements.length-1?[Ffe(e,t+1)]:lG.map(lG.from(e.children),(e=>Ffe(e,0))),0===t&&e.element.incompressible?{element:e.element.elements[t],children:n,incompressible:!0,collapsible:e.collapsible,collapsed:e.collapsed}:{element:e.element.elements[t],children:n,collapsible:e.collapsible,collapsed:e.collapsed}}function Bfe(e){return Ffe(e,0)}function Wfe(e,t,n){return e.element===t?Object.assign(Object.assign({},e),{children:n}):Object.assign(Object.assign({},e),{children:lG.map(lG.from(e.children),(e=>Wfe(e,t,n)))})}class zfe{constructor(e,t,n={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new Ofe(e,t,n),this.enabled=void 0===n.compressionEnabled||n.compressionEnabled,this.identityProvider=n.identityProvider}get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}setChildren(e,t=lG.empty(),n){const i=n.diffIdentityProvider&&(r=n.diffIdentityProvider,{getId:e=>e.elements.map((e=>r.getId(e).toString())).join("\0")});var r;if(null===e){const e=lG.map(t,this.enabled?Pfe:Rfe);return void this._setChildren(null,e,{diffIdentityProvider:i,diffDepth:1/0})}const o=this.nodes.get(e);if(!o)throw new Error("Unknown compressed tree node");const s=this.model.getNode(o),a=this.model.getParentNodeLocation(o),l=this.model.getNode(a),c=Wfe(Bfe(s),e,t),u=(this.enabled?Pfe:Rfe)(c),h=l.children.map((e=>e===s?u:e));this._setChildren(l.element,h,{diffIdentityProvider:i,diffDepth:s.depth-l.depth})}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const t=this.model.getNode().children,n=lG.map(t,Bfe),i=lG.map(n,e?Pfe:Rfe);this._setChildren(null,i,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,n){const i=new Set;this.model.setChildren(e,t,Object.assign(Object.assign({},n),{onDidCreateNode:e=>{for(const t of e.element.elements)i.add(t),this.nodes.set(t,e.element)},onDidDeleteNode:e=>{for(const t of e.element.elements)i.has(t)||this.nodes.delete(t)}}))}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(void 0===e)return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return null===t?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),n=this.model.getParentNodeLocation(t);return null===n?null:n.elements[n.elements.length-1]}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const n=this.getCompressedNode(e);return this.model.setCollapsible(n,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,n){const i=this.getCompressedNode(e);return this.model.setCollapsed(i,t,n)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(null===e)return null;const t=this.nodes.get(e);if(!t)throw new afe(this.user,`Tree element not found: ${e}`);return t}}const Vfe=e=>e[e.length-1];class Ufe{constructor(e,t){this.unwrapper=e,this.node=t}get element(){return null===this.node.element?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map((e=>new Ufe(this.unwrapper,e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class Hfe{constructor(e,t,n={}){this.rootRef=null,this.elementMapper=n.elementMapper||Vfe;const i=e=>this.elementMapper(e.elements);this.nodeMapper=new lfe((e=>new Ufe(i,e))),this.model=new zfe(e,function(e,t){return{splice(n,i,r){t.splice(n,i,r.map((t=>e.map(t))))},updateElementHeight(e,n){t.updateElementHeight(e,n)}}}(this.nodeMapper,t),function(e,t){return Object.assign(Object.assign({},t),{identityProvider:t.identityProvider&&{getId:n=>t.identityProvider.getId(e(n))},sorter:t.sorter&&{compare:(e,n)=>t.sorter.compare(e.elements[0],n.elements[0])},filter:t.filter&&{filter:(n,i)=>t.filter.filter(e(n),i)}})}(i,n))}get onDidSplice(){return SG.map(this.model.onDidSplice,(({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map((e=>this.nodeMapper.map(e))),deletedNodes:t.map((e=>this.nodeMapper.map(e)))})))}get onDidChangeCollapseState(){return SG.map(this.model.onDidChangeCollapseState,(({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t})))}get onDidChangeRenderNodeCount(){return SG.map(this.model.onDidChangeRenderNodeCount,(e=>this.nodeMapper.map(e)))}setChildren(e,t=lG.empty(),n={}){this.model.setChildren(e,t,n)}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,n){return this.model.setCollapsed(e,t,n)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}class jfe extends Afe{constructor(e,t,n,i,r={}){super(e,t,n,i,r)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(e,t=lG.empty(),n){this.model.setChildren(e,t,n)}rerender(e){void 0!==e?this.model.rerender(e):this.view.rerender()}hasElement(e){return this.model.has(e)}createModel(e,t,n){return new Ofe(e,t,n)}}class Gfe{constructor(e,t){this._compressedTreeNodeProvider=e,this.renderer=t,this.templateId=t.templateId,t.onDidChangeTwistieState&&(this.onDidChangeTwistieState=t.onDidChangeTwistieState)}get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){const r=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element);1===r.element.elements.length?(n.compressedTreeNode=void 0,this.renderer.renderElement(e,t,n.data,i)):(n.compressedTreeNode=r,this.renderer.renderCompressedElements(r,t,n.data,i))}disposeElement(e,t,n,i){n.compressedTreeNode?this.renderer.disposeCompressedElements&&this.renderer.disposeCompressedElements(n.compressedTreeNode,t,n.data,i):this.renderer.disposeElement&&this.renderer.disposeElement(e,t,n.data,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return!!this.renderer.renderTwistie&&this.renderer.renderTwistie(e,t)}}!function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);o>3&&s&&Object.defineProperty(t,n,s)}([T6],Gfe.prototype,"compressedTreeNodeProvider",null);class Kfe extends jfe{constructor(e,t,n,i,r={}){const o=()=>this;super(e,t,n,i.map((e=>new Gfe(o,e))),function(e,t){return t&&Object.assign(Object.assign({},t),{keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(n){let i;try{i=e().getCompressedTreeNode(n)}catch(r){return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(n)}return 1===i.element.elements.length?t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(n):t.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}})}(o,r))}setChildren(e,t=lG.empty(),n){this.model.setChildren(e,t,n)}createModel(e,t,n){return new Hfe(e,t,n)}updateOptions(e={}){super.updateOptions(e),void 0!==e.compressionEnabled&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}var qfe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function $fe(e){return Object.assign(Object.assign({},e),{children:[],refreshPromise:void 0,stale:!0,slow:!1,collapsedByDefault:void 0})}function Yfe(e,t){return!!t.parent&&(t.parent===e||Yfe(e,t.parent))}class Xfe{constructor(e){this.node=e}get element(){return this.node.element.element}get children(){return this.node.children.map((e=>new Xfe(e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class Zfe{constructor(e,t,n){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=n,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){this.renderer.renderElement(this.nodeMapper.map(e),t,n.templateData,i)}renderTwistie(e,t){return e.slow?(t.classList.add(...vfe.classNamesArray),!0):(t.classList.remove(...vfe.classNamesArray),!1)}disposeElement(e,t,n,i){this.renderer.disposeElement&&this.renderer.disposeElement(this.nodeMapper.map(e),t,n.templateData,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function Qfe(e){return{browserEvent:e.browserEvent,elements:e.elements.map((e=>e.element))}}function Jfe(e){return{browserEvent:e.browserEvent,element:e.element&&e.element.element,target:e.target}}class ege extends Sde{constructor(e){super(e.elements.map((e=>e.element))),this.data=e}}function tge(e){return e instanceof Sde?new ege(e):e}class nge{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map((e=>e.element)),t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(tge(e),t)}onDragOver(e,t,n,i,r=!0){return this.dnd.onDragOver(tge(e),t&&t.element,n,i)}drop(e,t,n,i){this.dnd.drop(tge(e),t&&t.element,n,i)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}}function ige(e){return e&&Object.assign(Object.assign({},e),{collapseByDefault:!0,identityProvider:e.identityProvider&&{getId:t=>e.identityProvider.getId(t.element)},dnd:e.dnd&&new nge(e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent:t=>e.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},t),{element:t.element})),isSelectionRangeChangeEvent:t=>e.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},t),{element:t.element}))},accessibilityProvider:e.accessibilityProvider&&Object.assign(Object.assign({},e.accessibilityProvider),{getPosInSet:void 0,getSetSize:void 0,getRole:e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",isChecked:e.accessibilityProvider.isChecked?t=>{var n;return!!(null===(n=e.accessibilityProvider)||void 0===n?void 0:n.isChecked(t.element))}:void 0,getAriaLabel:t=>e.accessibilityProvider.getAriaLabel(t.element),getWidgetAriaLabel:()=>e.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider.getAriaLevel&&(t=>e.accessibilityProvider.getAriaLevel(t.element)),getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))}),filter:e.filter&&{filter:(t,n)=>e.filter.filter(t.element,n)},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},e.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel:t=>e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}),sorter:void 0,expandOnlyOnTwistieClick:void 0===e.expandOnlyOnTwistieClick?void 0:"function"!=typeof e.expandOnlyOnTwistieClick?e.expandOnlyOnTwistieClick:t=>e.expandOnlyOnTwistieClick(t.element),additionalScrollHeight:e.additionalScrollHeight})}function rge(e,t){t(e),e.children.forEach((e=>rge(e,t)))}class oge{constructor(e,t,n,i,r,o={}){this.user=e,this.dataSource=r,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new EG,this._onDidChangeNodeSlowState=new EG,this.nodeMapper=new lfe((e=>new Xfe(e))),this.disposables=new pG,this.identityProvider=o.identityProvider,this.autoExpandSingleChildren=void 0!==o.autoExpandSingleChildren&&o.autoExpandSingleChildren,this.sorter=o.sorter,this.collapseByDefault=o.collapseByDefault,this.tree=this.createTree(e,t,n,i,o),this.root=$fe({element:void 0,parent:null,hasChildren:!0}),this.identityProvider&&(this.root=Object.assign(Object.assign({},this.root),{id:null})),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}get onDidChangeFocus(){return SG.map(this.tree.onDidChangeFocus,Qfe)}get onDidChangeSelection(){return SG.map(this.tree.onDidChangeSelection,Qfe)}get onMouseDblClick(){return SG.map(this.tree.onMouseDblClick,Jfe)}get onPointer(){return SG.map(this.tree.onPointer,Jfe)}get onDidFocus(){return this.tree.onDidFocus}get onDidDispose(){return this.tree.onDidDispose}createTree(e,t,n,i,r){const o=new wfe(n),s=i.map((e=>new Zfe(e,this.nodeMapper,this._onDidChangeNodeSlowState.event))),a=ige(r)||{};return new jfe(e,t,o,s,a)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}setInput(e,t){return qfe(this,void 0,void 0,(function*(){this.refreshPromises.forEach((e=>e.cancel())),this.refreshPromises.clear(),this.root.element=e;const n=t&&{viewState:t,focus:[],selection:[]};yield this._updateChildren(e,!0,!1,n),n&&(this.tree.setFocus(n.focus),this.tree.setSelection(n.selection)),t&&"number"==typeof t.scrollTop&&(this.scrollTop=t.scrollTop)}))}_updateChildren(e=this.root.element,t=!0,n=!1,i,r){return qfe(this,void 0,void 0,(function*(){if(void 0===this.root.element)throw new afe(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield SG.toPromise(this._onDidRender.event));const o=this.getDataNode(e);if(yield this.refreshAndRenderNode(o,t,i,r),n)try{this.tree.rerender(o)}catch(s){}}))}rerender(e){if(void 0===e||e===this.root.element)return void this.tree.rerender();const t=this.getDataNode(e);this.tree.rerender(t)}collapse(e,t=!1){const n=this.getDataNode(e);return this.tree.collapse(n===this.root?null:n,t)}expand(e,t=!1){return qfe(this,void 0,void 0,(function*(){if(void 0===this.root.element)throw new afe(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield SG.toPromise(this._onDidRender.event));const n=this.getDataNode(e);if(this.tree.hasElement(n)&&!this.tree.isCollapsible(n))return!1;if(n.refreshPromise&&(yield this.root.refreshPromise,yield SG.toPromise(this._onDidRender.event)),n!==this.root&&!n.refreshPromise&&!this.tree.isCollapsed(n))return!1;const i=this.tree.expand(n===this.root?null:n,t);return n.refreshPromise&&(yield this.root.refreshPromise,yield SG.toPromise(this._onDidRender.event)),i}))}setSelection(e,t){const n=e.map((e=>this.getDataNode(e)));this.tree.setSelection(n,t)}getSelection(){return this.tree.getSelection().map((e=>e.element))}setFocus(e,t){const n=e.map((e=>this.getDataNode(e)));this.tree.setFocus(n,t)}getFocus(){return this.tree.getFocus().map((e=>e.element))}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new afe(this.user,`Data tree node not found: ${e}`);return t}refreshAndRenderNode(e,t,n,i){return qfe(this,void 0,void 0,(function*(){yield this.refreshNode(e,t,n),this.render(e,n,i)}))}refreshNode(e,t,n){return qfe(this,void 0,void 0,(function*(){let i;return this.subTreeRefreshPromises.forEach(((r,o)=>{!i&&function(e,t){return e===t||Yfe(e,t)||Yfe(t,e)}(o,e)&&(i=r.then((()=>this.refreshNode(e,t,n))))})),i||this.doRefreshSubTree(e,t,n)}))}doRefreshSubTree(e,t,n){return qfe(this,void 0,void 0,(function*(){let i;e.refreshPromise=new Promise((e=>i=e)),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally((()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)}));try{const r=yield this.doRefreshNode(e,t,n);e.stale=!1,yield H$.settled(r.map((e=>this.doRefreshSubTree(e,t,n))))}finally{i()}}))}doRefreshNode(e,t,n){return qfe(this,void 0,void 0,(function*(){let i;if(e.hasChildren=!!this.dataSource.hasChildren(e.element),e.hasChildren){const t=R$(800);t.then((()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)}),(e=>null)),i=this.doGetChildren(e).finally((()=>t.cancel()))}else i=Promise.resolve(lG.empty());try{const r=yield i;return this.setChildren(e,r,t,n)}catch(r){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),oG(r))return[];throw r}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}))}doGetChildren(e){let t=this.refreshPromises.get(e);return t||(t=I$((()=>qfe(this,void 0,void 0,(function*(){const t=yield this.dataSource.getChildren(e.element);return this.processChildren(t)})))),this.refreshPromises.set(e,t),t.finally((()=>{this.refreshPromises.delete(e)})))}_onDidChangeCollapseState({node:e,deep:t}){null!==e.element&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(nG))}setChildren(e,t,n,i){const r=[...t];if(0===e.children.length&&0===r.length)return[];const o=new Map,s=new Map;for(const c of e.children)if(o.set(c.element,c),this.identityProvider){const e=this.tree.isCollapsed(c);s.set(c.id,{node:c,collapsed:e})}const a=[],l=r.map((t=>{const r=!!this.dataSource.hasChildren(t);if(!this.identityProvider){const n=$fe({element:t,parent:e,hasChildren:r});return r&&this.collapseByDefault&&!this.collapseByDefault(t)&&(n.collapsedByDefault=!1,a.push(n)),n}const l=this.identityProvider.getId(t).toString(),c=s.get(l);if(c){const e=c.node;return o.delete(e.element),this.nodes.delete(e.element),this.nodes.set(t,e),e.element=t,e.hasChildren=r,n?c.collapsed?(e.children.forEach((e=>rge(e,(e=>this.nodes.delete(e.element))))),e.children.splice(0,e.children.length),e.stale=!0):a.push(e):r&&this.collapseByDefault&&!this.collapseByDefault(t)&&(e.collapsedByDefault=!1,a.push(e)),e}const u=$fe({element:t,parent:e,id:l,hasChildren:r});return i&&i.viewState.focus&&i.viewState.focus.indexOf(l)>-1&&i.focus.push(u),i&&i.viewState.selection&&i.viewState.selection.indexOf(l)>-1&&i.selection.push(u),i&&i.viewState.expanded&&i.viewState.expanded.indexOf(l)>-1?a.push(u):r&&this.collapseByDefault&&!this.collapseByDefault(t)&&(u.collapsedByDefault=!1,a.push(u)),u}));for(const c of o.values())rge(c,(e=>this.nodes.delete(e.element)));for(const c of l)this.nodes.set(c.element,c);return e.children.splice(0,e.children.length,...l),e!==this.root&&this.autoExpandSingleChildren&&1===l.length&&0===a.length&&(l[0].collapsedByDefault=!1,a.push(l[0])),a}render(e,t,n){const i=e.children.map((e=>this.asTreeElement(e,t))),r=n&&Object.assign(Object.assign({},n),{diffIdentityProvider:n.diffIdentityProvider&&{getId:e=>n.diffIdentityProvider.getId(e.element)}});this.tree.setChildren(e===this.root?null:e,i,r),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let n;return n=!(t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1)&&e.collapsedByDefault,e.collapsedByDefault=void 0,{element:e,children:e.hasChildren?lG.map(e.children,(e=>this.asTreeElement(e,t))):[],collapsible:e.hasChildren,collapsed:n}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose()}}class sge{constructor(e){this.node=e}get element(){return{elements:this.node.element.elements.map((e=>e.element)),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map((e=>new sge(e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class age{constructor(e,t,n,i){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=n,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,n,i){this.renderer.renderElement(this.nodeMapper.map(e),t,n.templateData,i)}renderCompressedElements(e,t,n,i){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,n.templateData,i)}renderTwistie(e,t){return e.slow?(t.classList.add(...vfe.classNamesArray),!0):(t.classList.remove(...vfe.classNamesArray),!1)}disposeElement(e,t,n,i){this.renderer.disposeElement&&this.renderer.disposeElement(this.nodeMapper.map(e),t,n.templateData,i)}disposeCompressedElements(e,t,n,i){this.renderer.disposeCompressedElements&&this.renderer.disposeCompressedElements(this.compressibleNodeMapperProvider().map(e),t,n.templateData,i)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=dG(this.disposables)}}class lge extends oge{constructor(e,t,n,i,r,o,s={}){super(e,t,n,r,o,s),this.compressionDelegate=i,this.compressibleNodeMapper=new lfe((e=>new sge(e))),this.filter=s.filter}createTree(e,t,n,i,r){const o=new wfe(n),s=i.map((e=>new age(e,this.nodeMapper,(()=>this.compressibleNodeMapper),this._onDidChangeNodeSlowState.event))),a=function(e){const t=e&&ige(e);return t&&Object.assign(Object.assign({},t),{keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},t.keyboardNavigationLabelProvider),{getCompressedNodeKeyboardNavigationLabel:t=>e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map((e=>e.element)))})})}(r)||{};return new Kfe(e,t,o,s,a)}asTreeElement(e,t){return Object.assign({incompressible:this.compressionDelegate.isIncompressible(e.element)},super.asTreeElement(e,t))}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t){if(!this.identityProvider)return super.render(e,t);const n=e=>this.identityProvider.getId(e).toString(),i=e=>{const t=new Set;for(const i of e){const e=this.tree.getCompressedTreeNode(i===this.root?null:i);if(e.element)for(const i of e.element.elements)t.add(n(i.element))}return t},r=i(this.tree.getSelection()),o=i(this.tree.getFocus());super.render(e,t);const s=this.getSelection();let a=!1;const l=this.getFocus();let c=!1;const u=e=>{const t=e.element;if(t)for(let i=0;i<t.elements.length;i++){const e=n(t.elements[i].element),u=t.elements[t.elements.length-1].element;r.has(e)&&-1===s.indexOf(u)&&(s.push(u),a=!0),o.has(e)&&-1===l.indexOf(u)&&(l.push(u),c=!0)}e.children.forEach(u)};u(this.tree.getCompressedTreeNode(e===this.root?null:e)),a&&this.setSelection(s),c&&this.setFocus(l)}processChildren(e){return this.filter&&(e=lG.filter(e,(e=>{const t=this.filter.filter(e,1),n="boolean"==typeof(i=t)?i?1:0:cfe(i)?ufe(i.visibility):ufe(i);var i;if(2===n)throw new Error("Recursive tree visibility not supported in async data compressed trees");return 1===n}))),super.processChildren(e)}}class cge extends Afe{constructor(e,t,n,i,r,o={}){super(e,t,n,i,o),this.user=e,this.dataSource=r,this.identityProvider=o.identityProvider}createModel(e,t,n){return new Ofe(e,t,n)}}const uge={separatorBorder:Q8.transparent};class hge{constructor(e,t,n,i){this.container=e,this.view=t,this.disposable=i,this._cachedVisibleSize=void 0,"number"==typeof n?(this._size=n,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=n.cachedVisibleSize)}set size(e){this._size=e}get size(){return this._size}get visible(){return void 0===this._cachedVisibleSize}setVisible(e,t){e!==this.visible&&(e?(this.size=RQ(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize="number"==typeof t?t:this.size,this.size=0),this.container.classList.toggle("visible",e),this.view.setVisible&&this.view.setVisible(e))}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}layout(e,t){this.layoutContainer(e),this.view.layout(this.size,e,t)}dispose(){return this.disposable.dispose(),this.view}}class dge extends hge{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class fge extends hge{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var gge,pge,mge,vge;(pge=gge||(gge={}))[pge.Idle=0]="Idle",pge[pge.Busy=1]="Busy",(vge=mge||(mge={})).Distribute={type:"distribute"},vge.Split=function(e){return{type:"split",index:e}},vge.Invisible=function(e){return{type:"invisible",cachedVisibleSize:e}};class yge extends mG{constructor(e,t={}){var n,i;super(),this.size=0,this.contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=gge.Idle,this._onDidSashChange=this._register(new EG),this.onDidSashChange=this._onDidSashChange.event,this._onDidSashReset=this._register(new EG),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.orientation=FZ(t.orientation)?0:t.orientation,this.inverseAltBehavior=!!t.inverseAltBehavior,this.proportionalLayout=!!FZ(t.proportionalLayout)||!!t.proportionalLayout,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(0===this.orientation?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=WY(this.el,GY(".sash-container")),this.viewContainer=GY(".split-view-container"),this.scrollable=new aoe(125,oY),this.scrollableElement=this._register(new poe(this.viewContainer,{vertical:0===this.orientation?null!==(n=t.scrollbarVisibility)&&void 0!==n?n:1:2,horizontal:1===this.orientation?null!==(i=t.scrollbarVisibility)&&void 0!==i?i:1:2},this.scrollable)),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll((e=>{this.viewContainer.scrollTop=e.scrollTop,this.viewContainer.scrollLeft=e.scrollLeft}))),WY(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||uge),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach(((e,t)=>{const n=FZ(e.visible)||e.visible?e.size:{type:"invisible",cachedVisibleSize:e.size},i=e.view;this.doAddView(i,n,t,!0)})),this.contentSize=this.viewItems.reduce(((e,t)=>e+t.size),0),this.saveProportions())}get orthogonalStartSash(){return this._orthogonalStartSash}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}get orthogonalEndSash(){return this._orthogonalEndSash}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}get startSnappingEnabled(){return this._startSnappingEnabled}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}get endSnappingEnabled(){return this._endSnappingEnabled}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,n=this.viewItems.length,i){this.doAddView(e,t,n,i)}layout(e,t){const n=Math.max(this.size,this.contentSize);if(this.size=e,this.layoutContext=t,this.proportions)for(let i=0;i<this.viewItems.length;i++){const t=this.viewItems[i];t.size=RQ(Math.round(this.proportions[i]*e),t.minimumSize,t.maximumSize)}else{const t=z1(this.viewItems.length),i=t.filter((e=>1===this.viewItems[e].priority)),r=t.filter((e=>2===this.viewItems[e].priority));this.resize(this.viewItems.length-1,e-n,void 0,i,r)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this.contentSize>0&&(this.proportions=this.viewItems.map((e=>e.size/this.contentSize)))}onSashStart({sash:e,start:t,alt:n}){for(const s of this.viewItems)s.enabled=!1;const i=this.sashItems.findIndex((t=>t.sash===e)),r=fG(Q$(document.body,"keydown",(e=>o(this.sashDragState.current,e.altKey))),Q$(document.body,"keyup",(()=>o(this.sashDragState.current,!1)))),o=(e,t)=>{const n=this.viewItems.map((e=>e.size));let o,s,a=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(t=!t),t){if(i===this.sashItems.length-1){const e=this.viewItems[i];a=(e.minimumSize-e.size)/2,l=(e.maximumSize-e.size)/2}else{const e=this.viewItems[i+1];a=(e.size-e.maximumSize)/2,l=(e.size-e.minimumSize)/2}}if(!t){const e=z1(i,-1),t=z1(i+1,this.viewItems.length),r=e.reduce(((e,t)=>e+(this.viewItems[t].minimumSize-n[t])),0),a=e.reduce(((e,t)=>e+(this.viewItems[t].viewMaximumSize-n[t])),0),l=0===t.length?Number.POSITIVE_INFINITY:t.reduce(((e,t)=>e+(n[t]-this.viewItems[t].minimumSize)),0),c=0===t.length?Number.NEGATIVE_INFINITY:t.reduce(((e,t)=>e+(n[t]-this.viewItems[t].viewMaximumSize)),0),u=Math.max(r,c),h=Math.min(l,a),d=this.findFirstSnapIndex(e),f=this.findFirstSnapIndex(t);if("number"==typeof d){const e=this.viewItems[d],t=Math.floor(e.viewMinimumSize/2);o={index:d,limitDelta:e.visible?u-t:u+t,size:e.size}}if("number"==typeof f){const e=this.viewItems[f],t=Math.floor(e.viewMinimumSize/2);s={index:f,limitDelta:e.visible?h+t:h-t,size:e.size}}}this.sashDragState={start:e,current:e,index:i,sizes:n,minDelta:a,maxDelta:l,alt:t,snapBefore:o,snapAfter:s,disposable:r}};o(t,n)}onSashChange({current:e}){const{index:t,start:n,sizes:i,alt:r,minDelta:o,maxDelta:s,snapBefore:a,snapAfter:l}=this.sashDragState;this.sashDragState.current=e;const c=e-n,u=this.resize(t,c,i,void 0,void 0,o,s,a,l);if(r){const e=t===this.sashItems.length-1,n=this.viewItems.map((e=>e.size)),i=e?t:t+1,r=this.viewItems[i],o=r.size-r.maximumSize,s=r.size-r.minimumSize,a=e?t-1:t+1;this.resize(a,-u,n,void 0,void 0,o,s)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const n=this.viewItems.indexOf(e);n<0||n>=this.viewItems.length||(t=RQ(t="number"==typeof t?t:e.size,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&n>0?(this.resize(n-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([n],void 0)))}resizeView(e,t){if(this.state!==gge.Idle)throw new Error("Cant modify splitview");if(this.state=gge.Busy,e<0||e>=this.viewItems.length)return;const n=z1(this.viewItems.length).filter((t=>t!==e)),i=[...n.filter((e=>1===this.viewItems[e].priority)),e],r=n.filter((e=>2===this.viewItems[e].priority)),o=this.viewItems[e];t=RQ(t=Math.round(t),o.minimumSize,Math.min(o.maximumSize,this.size)),o.size=t,this.relayout(i,r),this.state=gge.Idle}distributeViewSizes(){const e=[];let t=0;for(const s of this.viewItems)s.maximumSize-s.minimumSize>0&&(e.push(s),t+=s.size);const n=Math.floor(t/e.length);for(const s of e)s.size=RQ(n,s.minimumSize,s.maximumSize);const i=z1(this.viewItems.length),r=i.filter((e=>1===this.viewItems[e].priority)),o=i.filter((e=>2===this.viewItems[e].priority));this.relayout(r,o)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,n=this.viewItems.length,i){if(this.state!==gge.Idle)throw new Error("Cant modify splitview");this.state=gge.Busy;const r=GY(".split-view-view");n===this.viewItems.length?this.viewContainer.appendChild(r):this.viewContainer.insertBefore(r,this.viewContainer.children.item(n));const o=fG(e.onDidChange((e=>this.onViewChange(a,e))),gG((()=>this.viewContainer.removeChild(r))));let s;s="number"==typeof t?t:"split"===t.type?this.getViewSize(t.index)/2:"invisible"===t.type?{cachedVisibleSize:t.cachedVisibleSize}:e.minimumSize;const a=0===this.orientation?new dge(r,e,s,o):new fge(r,e,s,o);if(this.viewItems.splice(n,0,a),this.viewItems.length>1){let e={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash};const t=0===this.orientation?new sle(this.sashContainer,{getHorizontalSashTop:e=>this.getSashPosition(e),getHorizontalSashWidth:this.getSashOrthogonalSize},Object.assign(Object.assign({},e),{orientation:1})):new sle(this.sashContainer,{getVerticalSashLeft:e=>this.getSashPosition(e),getVerticalSashHeight:this.getSashOrthogonalSize},Object.assign(Object.assign({},e),{orientation:0})),i=0===this.orientation?e=>({sash:t,start:e.startY,current:e.currentY,alt:e.altKey}):e=>({sash:t,start:e.startX,current:e.currentX,alt:e.altKey}),r=fG(SG.map(t.onDidStart,i)(this.onSashStart,this),SG.map(t.onDidChange,i)(this.onSashChange,this),SG.map(t.onDidEnd,(()=>this.sashItems.findIndex((e=>e.sash===t))))(this.onSashEnd,this),t.onDidReset((()=>{const e=this.sashItems.findIndex((e=>e.sash===t)),n=z1(e,-1),i=z1(e+1,this.viewItems.length),r=this.findFirstSnapIndex(n),o=this.findFirstSnapIndex(i);("number"!=typeof r||this.viewItems[r].visible)&&("number"!=typeof o||this.viewItems[o].visible)&&this._onDidSashReset.fire(e)})),t),o={sash:t,disposable:r};this.sashItems.splice(n-1,0,o)}let l;r.appendChild(e.element),"number"!=typeof t&&"split"===t.type&&(l=[t.index]),i||this.relayout([n],l),this.state=gge.Idle,i||"number"==typeof t||"distribute"!==t.type||this.distributeViewSizes()}relayout(e,t){const n=this.viewItems.reduce(((e,t)=>e+t.size),0);this.resize(this.viewItems.length-1,this.size-n,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,n=this.viewItems.map((e=>e.size)),i,r,o=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY,a,l){if(e<0||e>=this.viewItems.length)return 0;const c=z1(e,-1),u=z1(e+1,this.viewItems.length);if(r)for(const C of r)U1(c,C),U1(u,C);if(i)for(const C of i)H1(c,C),H1(u,C);const h=c.map((e=>this.viewItems[e])),d=c.map((e=>n[e])),f=u.map((e=>this.viewItems[e])),g=u.map((e=>n[e])),p=c.reduce(((e,t)=>e+(this.viewItems[t].minimumSize-n[t])),0),m=c.reduce(((e,t)=>e+(this.viewItems[t].maximumSize-n[t])),0),v=0===u.length?Number.POSITIVE_INFINITY:u.reduce(((e,t)=>e+(n[t]-this.viewItems[t].minimumSize)),0),y=0===u.length?Number.NEGATIVE_INFINITY:u.reduce(((e,t)=>e+(n[t]-this.viewItems[t].maximumSize)),0),_=Math.max(p,y,o),b=Math.min(v,m,s);let w=!1;if(a){const e=this.viewItems[a.index],n=t>=a.limitDelta;w=n!==e.visible,e.setVisible(n,a.size)}if(!w&&l){const e=this.viewItems[l.index],n=t<l.limitDelta;w=n!==e.visible,e.setVisible(n,l.size)}if(w)return this.resize(e,t,n,i,r,o,s);for(let C=0,S=t=RQ(t,_,b);C<h.length;C++){const e=h[C],t=RQ(d[C]+S,e.minimumSize,e.maximumSize);S-=t-d[C],e.size=t}for(let C=0,S=t;C<f.length;C++){const e=f[C],t=RQ(g[C]-S,e.minimumSize,e.maximumSize);S+=t-g[C],e.size=t}return t}distributeEmptySpace(e){const t=this.viewItems.reduce(((e,t)=>e+t.size),0);let n=this.size-t;const i=z1(this.viewItems.length-1,-1),r=i.filter((e=>1===this.viewItems[e].priority)),o=i.filter((e=>2===this.viewItems[e].priority));for(const s of o)U1(i,s);for(const s of r)H1(i,s);"number"==typeof e&&H1(i,e);for(let s=0;0!==n&&s<i.length;s++){const e=this.viewItems[i[s]],t=RQ(e.size+n,e.minimumSize,e.maximumSize);n-=t-e.size,e.size=t}}layoutViews(){this.contentSize=this.viewItems.reduce(((e,t)=>e+t.size),0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach((e=>e.sash.layout())),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){0===this.orientation?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this.contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this.contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map((t=>e=t.size-t.minimumSize>0||e));e=!1;const n=this.viewItems.map((t=>e=t.maximumSize-t.size>0||e)),i=[...this.viewItems].reverse();e=!1;const r=i.map((t=>e=t.size-t.minimumSize>0||e)).reverse();e=!1;const o=i.map((t=>e=t.maximumSize-t.size>0||e)).reverse();let s=0;for(let a=0;a<this.sashItems.length;a++){const{sash:e}=this.sashItems[a];s+=this.viewItems[a].size;const i=!(t[a]&&o[a+1]),l=!(n[a]&&r[a+1]);if(i&&l){const n=z1(a,-1),i=z1(a+1,this.viewItems.length),o=this.findFirstSnapIndex(n),l=this.findFirstSnapIndex(i),c="number"==typeof o&&!this.viewItems[o].visible,u="number"==typeof l&&!this.viewItems[l].visible;c&&r[a]&&(s>0||this.startSnappingEnabled)?e.state=1:u&&t[a]&&(s<this.contentSize||this.endSnappingEnabled)?e.state=2:e.state=0}else e.state=i&&!l?1:!i&&l?2:3}}getSashPosition(e){let t=0;for(let n=0;n<this.sashItems.length;n++)if(t+=this.viewItems[n].size,this.sashItems[n].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const e=this.viewItems[t];if(e.visible&&e.snap)return t}for(const t of e){const e=this.viewItems[t];if(e.visible&&e.maximumSize-e.minimumSize>0)return;if(!e.visible&&e.snap)return t}}dispose(){super.dispose(),this.viewItems.forEach((e=>e.dispose())),this.viewItems=[],this.sashItems.forEach((e=>e.disposable.dispose())),this.sashItems=[]}}class _ge{constructor(e,t,n){this.columns=e,this.getColumnSize=n,this.templateId=_ge.TemplateId,this.renderedTemplates=new Set;const i=new Map(t.map((e=>[e.templateId,e])));this.renderers=[];for(const r of e){const e=i.get(r.templateId);if(!e)throw new Error(`Table cell renderer for template id ${r.templateId} not found.`);this.renderers.push(e)}}renderTemplate(e){const t=WY(e,GY(".monaco-table-tr")),n=[],i=[];for(let o=0;o<this.columns.length;o++){const e=this.renderers[o],r=WY(t,GY(".monaco-table-td",{"data-col-index":o}));r.style.width=`${this.getColumnSize(o)}px`,n.push(r),i.push(e.renderTemplate(r))}const r={container:e,cellContainers:n,cellTemplateData:i};return this.renderedTemplates.add(r),r}renderElement(e,t,n,i){for(let r=0;r<this.columns.length;r++){const o=this.columns[r].project(e);this.renderers[r].renderElement(o,t,n.cellTemplateData[r],i)}}disposeElement(e,t,n,i){for(let r=0;r<this.columns.length;r++){const o=this.renderers[r];if(o.disposeElement){const s=this.columns[r].project(e);o.disposeElement(s,t,n.cellTemplateData[r],i)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++){this.renderers[t].disposeTemplate(e.cellTemplateData[t])}Y$(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:n}of this.renderedTemplates)n[e].style.width=`${t}px`}}_ge.TemplateId="row";class bge{constructor(e,t){this.column=e,this.index=t,this._onDidLayout=new EG,this.onDidLayout=this._onDidLayout.event,this.element=GY(".monaco-table-th",{"data-col-index":t,title:e.tooltip},e.label)}get minimumSize(){var e;return null!==(e=this.column.minimumWidth)&&void 0!==e?e:120}get maximumSize(){var e;return null!==(e=this.column.maximumWidth)&&void 0!==e?e:Number.POSITIVE_INFINITY}get onDidChange(){var e;return null!==(e=this.column.onDidChangeWidthConstraints)&&void 0!==e?e:SG.None}layout(e){this._onDidLayout.fire([this.index,e])}}class wge{constructor(e,t,n,i,r,o){this.virtualDelegate=n,this.domId="table_id_"+ ++wge.InstanceCount,this.cachedHeight=0,this.domNode=WY(t,GY(`.monaco-table.${this.domId}`));const s=i.map(((e,t)=>new bge(e,t))),a={size:s.reduce(((e,t)=>e+t.column.weight),0),views:s.map((e=>({size:e.column.weight,view:e})))};this.splitview=new yge(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:a}),this.splitview.el.style.height=`${n.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${n.headerRowHeight}px`;const l=new _ge(i,r,(e=>this.splitview.getViewSize(e)));var c;this.list=new tfe(e,this.domNode,(c=n,{getHeight:e=>c.getHeight(e),getTemplateId:()=>_ge.TemplateId}),[l],o),this.columnLayoutDisposable=SG.any(...s.map((e=>e.onDidLayout)))((([e,t])=>l.layoutColumn(e,t))),this.styleElement=NY(this.domNode),this.style({})}get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}updateOptions(e){this.list.updateOptions(e)}splice(e,t,n=[]){this.list.splice(e,t,n)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\ttop: ${this.virtualDelegate.headerRowHeight+1}px;\n\t\t\theight: calc(100% - ${this.virtualDelegate.headerRowHeight}px);\n\t\t}`),this.styleElement.textContent=t.join("\n"),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.splitview.dispose(),this.list.dispose(),this.columnLayoutDisposable.dispose()}}wge.InstanceCount=0;var Cge=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Sge=function(e,t){return function(n,i){t(n,i,e)}};const xge=i$("listService");let Ege=class{constructor(e){this._themeService=e,this.disposables=new pG,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}get lastFocusedList(){return this._lastFocusedWidget}register(e,t){if(!this._hasCreatedStyleController){this._hasCreatedStyleController=!0;const e=new qde(NY(),"");this.disposables.add(tde(e,this._themeService))}if(this.lists.some((t=>t.widget===e)))throw new Error("Cannot register the same widget multiple times");const n={widget:e,extraContextKeys:t};return this.lists.push(n),e.getHTMLElement()===document.activeElement&&(this._lastFocusedWidget=e),fG(e.onDidFocus((()=>this._lastFocusedWidget=e)),gG((()=>this.lists.splice(this.lists.indexOf(n),1))),e.onDidDispose((()=>{this.lists=this.lists.filter((e=>e!==n)),this._lastFocusedWidget===e&&(this._lastFocusedWidget=void 0)})))}dispose(){this.disposables.dispose()}};Ege=Cge([Sge(0,B5)],Ege);const kge=new M5("listFocus",!0),Lge=new M5("listSupportsMultiselect",!0),Dge=g5.and(kge,g5.not("inputFocus")),Nge=new M5("listHasSelectionOrFocus",!1),Ige=new M5("listDoubleSelection",!1),Tge=new M5("listMultiSelection",!1),Mge=new M5("listSelectionNavigation",!1),Age=new M5("listSupportsKeyboardNavigation",!0),Oge=new M5("listAutomaticKeyboardNavigation",!0);let Rge=!1;function Pge(e,t){const n=e.createScoped(t.getHTMLElement());return kge.bindTo(n),n}const Fge="workbench.list.horizontalScrolling",Bge="workbench.tree.indent",Wge="workbench.list.smoothScrolling",zge="workbench.tree.expandMode";function Vge(e){return"alt"===e.getValue("workbench.list.multiSelectModifier")}class Uge extends mG{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=Vge(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this.useAltAsMultipleSelectionModifier=Vge(this.configurationService))})))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:Hde(e)}isSelectionRangeChangeEvent(e){return jde(e)}}function Hge(e,t,n){const i=new pG,r=Object.assign({},e);if(!e.multipleSelectionController){const e=new Uge(t);r.multipleSelectionController=e,i.add(e)}return r.keyboardNavigationDelegate={mightProducePrintableCharacter:e=>n.mightProducePrintableCharacter(e)},r.smoothScrolling=Boolean(t.getValue(Wge)),[r,i]}let jge=class extends tfe{constructor(e,t,n,i,r,o,s,a,l,c){const u=void 0!==r.horizontalScrolling?r.horizontalScrolling:Boolean(l.getValue(Fge)),[h,d]=Hge(r,l,c);super(e,t,n,i,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},Jhe(a.getColorTheme(),nde)),h),{horizontalScrolling:u})),this.disposables.add(d),this.contextKeyService=Pge(o,this),this.themeService=a,this.listSupportsMultiSelect=Lge.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!!r.multipleSelectionSupport);Mge.bindTo(this.contextKeyService).set(Boolean(r.selectionNavigation)),this.listHasSelectionOrFocus=Nge.bindTo(this.contextKeyService),this.listDoubleSelection=Ige.bindTo(this.contextKeyService),this.listMultiSelection=Tge.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Vge(l),this.disposables.add(this.contextKeyService),this.disposables.add(s.register(this)),r.overrideStyles&&this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection((()=>{const e=this.getSelection(),t=this.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.listHasSelectionOrFocus.set(e.length>0||t.length>0),this.listMultiSelection.set(e.length>1),this.listDoubleSelection.set(2===e.length)}))}))),this.disposables.add(this.onDidChangeFocus((()=>{const e=this.getSelection(),t=this.getFocus();this.listHasSelectionOrFocus.set(e.length>0||t.length>0)}))),this.disposables.add(l.onDidChangeConfiguration((e=>{e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this._useAltAsMultipleSelectionModifier=Vge(l));let t={};if(e.affectsConfiguration(Fge)&&void 0===this.horizontalScrolling){const e=Boolean(l.getValue(Fge));t=Object.assign(Object.assign({},t),{horizontalScrolling:e})}if(e.affectsConfiguration(Wge)){const e=Boolean(l.getValue(Wge));t=Object.assign(Object.assign({},t),{smoothScrolling:e})}Object.keys(t).length>0&&this.updateOptions(t)}))),this.navigator=new $ge(this,Object.assign({configurationService:l},r)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),void 0!==e.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;null===(t=this._styler)||void 0===t||t.dispose(),this._styler=tde(this,this.themeService,e)}dispose(){var e;null===(e=this._styler)||void 0===e||e.dispose(),super.dispose()}};jge=Cge([Sge(5,A5),Sge(6,xge),Sge(7,B5),Sge(8,j3),Sge(9,gce)],jge);let Gge=class extends class{constructor(e,t,n,i,r={}){const o=()=>this.model,s=i.map((e=>new nfe(e,o)));this.list=new tfe(e,t,n,s,function(e,t){return Object.assign(Object.assign({},t),{accessibilityProvider:t.accessibilityProvider&&new ife(e,t.accessibilityProvider)})}(o,r))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return SG.map(this.list.onMouseDblClick,(({element:e,index:t,browserEvent:n})=>({element:void 0===e?void 0:this._model.get(e),index:t,browserEvent:n})))}get onPointer(){return SG.map(this.list.onPointer,(({element:e,index:t,browserEvent:n})=>({element:void 0===e?void 0:this._model.get(e),index:t,browserEvent:n})))}get onDidChangeSelection(){return SG.map(this.list.onDidChangeSelection,(({elements:e,indexes:t,browserEvent:n})=>({elements:e.map((e=>this._model.get(e))),indexes:t,browserEvent:n})))}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,z1(e.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map((e=>this.model.get(e)))}style(e){this.list.style(e)}dispose(){this.list.dispose()}}{constructor(e,t,n,i,r,o,s,a,l,c){const u=void 0!==r.horizontalScrolling?r.horizontalScrolling:Boolean(l.getValue(Fge)),[h,d]=Hge(r,l,c);super(e,t,n,i,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},Jhe(a.getColorTheme(),nde)),h),{horizontalScrolling:u})),this.disposables=new pG,this.disposables.add(d),this.contextKeyService=Pge(o,this),this.themeService=a,this.horizontalScrolling=r.horizontalScrolling,this.listSupportsMultiSelect=Lge.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!!r.multipleSelectionSupport);Mge.bindTo(this.contextKeyService).set(Boolean(r.selectionNavigation)),this._useAltAsMultipleSelectionModifier=Vge(l),this.disposables.add(this.contextKeyService),this.disposables.add(s.register(this)),r.overrideStyles&&this.updateStyles(r.overrideStyles),r.overrideStyles&&this.disposables.add(tde(this,a,r.overrideStyles)),this.disposables.add(l.onDidChangeConfiguration((e=>{e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this._useAltAsMultipleSelectionModifier=Vge(l));let t={};if(e.affectsConfiguration(Fge)&&void 0===this.horizontalScrolling){const e=Boolean(l.getValue(Fge));t=Object.assign(Object.assign({},t),{horizontalScrolling:e})}if(e.affectsConfiguration(Wge)){const e=Boolean(l.getValue(Wge));t=Object.assign(Object.assign({},t),{smoothScrolling:e})}Object.keys(t).length>0&&this.updateOptions(t)}))),this.navigator=new $ge(this,Object.assign({configurationService:l},r)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),void 0!==e.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;null===(t=this._styler)||void 0===t||t.dispose(),this._styler=tde(this,this.themeService,e)}dispose(){var e;null===(e=this._styler)||void 0===e||e.dispose(),this.disposables.dispose(),super.dispose()}};Gge=Cge([Sge(5,A5),Sge(6,xge),Sge(7,B5),Sge(8,j3),Sge(9,gce)],Gge);let Kge=class extends wge{constructor(e,t,n,i,r,o,s,a,l,c,u){const h=void 0!==o.horizontalScrolling?o.horizontalScrolling:Boolean(c.getValue(Fge)),[d,f]=Hge(o,c,u);super(e,t,n,i,r,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},Jhe(l.getColorTheme(),nde)),d),{horizontalScrolling:h})),this.disposables=new pG,this.disposables.add(f),this.contextKeyService=Pge(s,this),this.themeService=l,this.listSupportsMultiSelect=Lge.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!!o.multipleSelectionSupport);Mge.bindTo(this.contextKeyService).set(Boolean(o.selectionNavigation)),this.listHasSelectionOrFocus=Nge.bindTo(this.contextKeyService),this.listDoubleSelection=Ige.bindTo(this.contextKeyService),this.listMultiSelection=Tge.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Vge(c),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),o.overrideStyles&&this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection((()=>{const e=this.getSelection(),t=this.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.listHasSelectionOrFocus.set(e.length>0||t.length>0),this.listMultiSelection.set(e.length>1),this.listDoubleSelection.set(2===e.length)}))}))),this.disposables.add(this.onDidChangeFocus((()=>{const e=this.getSelection(),t=this.getFocus();this.listHasSelectionOrFocus.set(e.length>0||t.length>0)}))),this.disposables.add(c.onDidChangeConfiguration((e=>{e.affectsConfiguration("workbench.list.multiSelectModifier")&&(this._useAltAsMultipleSelectionModifier=Vge(c));let t={};if(e.affectsConfiguration(Fge)&&void 0===this.horizontalScrolling){const e=Boolean(c.getValue(Fge));t=Object.assign(Object.assign({},t),{horizontalScrolling:e})}if(e.affectsConfiguration(Wge)){const e=Boolean(c.getValue(Wge));t=Object.assign(Object.assign({},t),{smoothScrolling:e})}Object.keys(t).length>0&&this.updateOptions(t)}))),this.navigator=new Yge(this,Object.assign({configurationService:c},o)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),void 0!==e.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;null===(t=this._styler)||void 0===t||t.dispose(),this._styler=tde(this,this.themeService,e)}dispose(){var e;null===(e=this._styler)||void 0===e||e.dispose(),this.disposables.dispose(),super.dispose()}};Kge=Cge([Sge(6,A5),Sge(7,xge),Sge(8,B5),Sge(9,j3),Sge(10,gce)],Kge);class qge extends mG{constructor(e,t){var n;super(),this.widget=e,this._onDidOpen=this._register(new EG),this.onDidOpen=this._onDidOpen.event,this._register(SG.filter(this.widget.onDidChangeSelection,(e=>e.browserEvent instanceof KeyboardEvent))((e=>this.onSelectionFromKeyboard(e)))),this._register(this.widget.onPointer((e=>this.onPointer(e.element,e.browserEvent)))),this._register(this.widget.onMouseDblClick((e=>this.onMouseDblClick(e.element,e.browserEvent)))),"boolean"!=typeof(null==t?void 0:t.openOnSingleClick)&&(null==t?void 0:t.configurationService)?(this.openOnSingleClick="doubleClick"!==(null==t?void 0:t.configurationService.getValue("workbench.list.openMode")),this._register(null==t?void 0:t.configurationService.onDidChangeConfiguration((()=>{this.openOnSingleClick="doubleClick"!==(null==t?void 0:t.configurationService.getValue("workbench.list.openMode"))})))):this.openOnSingleClick=null===(n=null==t?void 0:t.openOnSingleClick)||void 0===n||n}onSelectionFromKeyboard(e){if(1!==e.elements.length)return;const t=e.browserEvent,n="boolean"!=typeof t.preserveFocus||t.preserveFocus,i="boolean"==typeof t.pinned?t.pinned:!n;this._open(this.getSelectedElement(),n,i,!1,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick)return;if(2===t.detail)return;const n=1===t.button,i=t.ctrlKey||t.metaKey||t.altKey;this._open(e,!0,n,i,t)}onMouseDblClick(e,t){if(!t)return;const n=t.target;if(n.classList.contains("monaco-tl-twistie")||n.classList.contains("monaco-icon-label")&&n.classList.contains("folder-icon")&&t.offsetX<16)return;const i=t.ctrlKey||t.metaKey||t.altKey;this._open(e,!1,!0,i,t)}_open(e,t,n,i,r){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:n,revealIfVisible:!0},sideBySide:i,element:e,browserEvent:r})}}class $ge extends qge{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class Yge extends qge{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class Xge extends qge{constructor(e,t){super(e,t)}getSelectedElement(){var e;return null!==(e=this.widget.getSelection()[0])&&void 0!==e?e:void 0}}function Zge(e,t){let n=!1;return i=>{if(n)return n=!1,!1;const r=t.softDispatch(i,e);return r&&r.enterChord?(n=!0,!1):(n=!1,!0)}}let Qge=class extends jfe{constructor(e,t,n,i,r,o,s,a,l,c,u){const{options:h,getAutomaticKeyboardNavigation:d,disposable:f}=ipe(t,r,o,l,c,u);super(e,t,n,i,h),this.disposables.add(f),this.internals=new rpe(this,r,d,r.overrideStyles,o,s,a,l,u),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};Qge=Cge([Sge(5,A5),Sge(6,xge),Sge(7,B5),Sge(8,j3),Sge(9,gce),Sge(10,yae)],Qge);let Jge=class extends Kfe{constructor(e,t,n,i,r,o,s,a,l,c,u){const{options:h,getAutomaticKeyboardNavigation:d,disposable:f}=ipe(t,r,o,l,c,u);super(e,t,n,i,h),this.disposables.add(f),this.internals=new rpe(this,r,d,r.overrideStyles,o,s,a,l,u),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};Jge=Cge([Sge(5,A5),Sge(6,xge),Sge(7,B5),Sge(8,j3),Sge(9,gce),Sge(10,yae)],Jge);let epe=class extends cge{constructor(e,t,n,i,r,o,s,a,l,c,u,h){const{options:d,getAutomaticKeyboardNavigation:f,disposable:g}=ipe(t,o,s,c,u,h);super(e,t,n,i,r,d),this.disposables.add(g),this.internals=new rpe(this,o,f,o.overrideStyles,s,a,l,c,h),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};epe=Cge([Sge(6,A5),Sge(7,xge),Sge(8,B5),Sge(9,j3),Sge(10,gce),Sge(11,yae)],epe);let tpe=class extends oge{constructor(e,t,n,i,r,o,s,a,l,c,u,h){const{options:d,getAutomaticKeyboardNavigation:f,disposable:g}=ipe(t,o,s,c,u,h);super(e,t,n,i,r,d),this.disposables.add(g),this.internals=new rpe(this,o,f,o.overrideStyles,s,a,l,c,h),this.disposables.add(this.internals)}get onDidOpen(){return this.internals.onDidOpen}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};tpe=Cge([Sge(6,A5),Sge(7,xge),Sge(8,B5),Sge(9,j3),Sge(10,gce),Sge(11,yae)],tpe);let npe=class extends lge{constructor(e,t,n,i,r,o,s,a,l,c,u,h,d){const{options:f,getAutomaticKeyboardNavigation:g,disposable:p}=ipe(t,s,a,u,h,d);super(e,t,n,i,r,o,f),this.disposables.add(p),this.internals=new rpe(this,s,g,s.overrideStyles,a,l,c,u,d),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};function ipe(e,t,n,i,r,o){var s;Age.bindTo(n),Rge||(Oge.bindTo(n),Rge=!0);const a=()=>{let e=Boolean(n.getContextKeyValue("listAutomaticKeyboardNavigation"));return e&&(e=Boolean(i.getValue("workbench.list.automaticKeyboardNavigation"))),e},l=o.isScreenReaderOptimized(),c=t.simpleKeyboardNavigation||l?"simple":i.getValue("workbench.list.keyboardNavigation"),u=void 0!==t.horizontalScrolling?t.horizontalScrolling:Boolean(i.getValue(Fge)),[h,d]=Hge(t,i,r),f=t.additionalScrollHeight;return{getAutomaticKeyboardNavigation:a,disposable:d,options:Object.assign(Object.assign({keyboardSupport:!1},h),{indent:i.getValue(Bge),renderIndentGuides:i.getValue("workbench.tree.renderIndentGuides"),smoothScrolling:Boolean(i.getValue(Wge)),automaticKeyboardNavigation:a(),simpleKeyboardNavigation:"simple"===c,filterOnType:"filter"===c,horizontalScrolling:u,keyboardNavigationEventFilter:Zge(e,r),additionalScrollHeight:f,hideTwistiesOfChildlessElements:t.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:null!==(s=t.expandOnlyOnTwistieClick)&&void 0!==s?s:"doubleClick"===i.getValue(zge)})}}npe=Cge([Sge(7,A5),Sge(8,xge),Sge(9,B5),Sge(10,j3),Sge(11,gce),Sge(12,yae)],npe);let rpe=class{constructor(e,t,n,i,r,o,s,a,l){this.tree=e,this.themeService=s,this.disposables=[],this.contextKeyService=Pge(r,e),this.listSupportsMultiSelect=Lge.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!!t.multipleSelectionSupport);Mge.bindTo(this.contextKeyService).set(Boolean(t.selectionNavigation)),this.hasSelectionOrFocus=Nge.bindTo(this.contextKeyService),this.hasDoubleSelection=Ige.bindTo(this.contextKeyService),this.hasMultiSelection=Tge.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=Vge(a);const c=new Set;c.add("listAutomaticKeyboardNavigation");const u=()=>{const t=l.isScreenReaderOptimized()?"simple":a.getValue("workbench.list.keyboardNavigation");e.updateOptions({simpleKeyboardNavigation:"simple"===t,filterOnType:"filter"===t})};this.updateStyleOverrides(i),this.disposables.push(this.contextKeyService,o.register(e),e.onDidChangeSelection((()=>{const t=e.getSelection(),n=e.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.hasSelectionOrFocus.set(t.length>0||n.length>0),this.hasMultiSelection.set(t.length>1),this.hasDoubleSelection.set(2===t.length)}))})),e.onDidChangeFocus((()=>{const t=e.getSelection(),n=e.getFocus();this.hasSelectionOrFocus.set(t.length>0||n.length>0)})),a.onDidChangeConfiguration((i=>{let r={};if(i.affectsConfiguration("workbench.list.multiSelectModifier")&&(this._useAltAsMultipleSelectionModifier=Vge(a)),i.affectsConfiguration(Bge)){const e=a.getValue(Bge);r=Object.assign(Object.assign({},r),{indent:e})}if(i.affectsConfiguration("workbench.tree.renderIndentGuides")){const e=a.getValue("workbench.tree.renderIndentGuides");r=Object.assign(Object.assign({},r),{renderIndentGuides:e})}if(i.affectsConfiguration(Wge)){const e=Boolean(a.getValue(Wge));r=Object.assign(Object.assign({},r),{smoothScrolling:e})}if(i.affectsConfiguration("workbench.list.keyboardNavigation")&&u(),i.affectsConfiguration("workbench.list.automaticKeyboardNavigation")&&(r=Object.assign(Object.assign({},r),{automaticKeyboardNavigation:n()})),i.affectsConfiguration(Fge)&&void 0===t.horizontalScrolling){const e=Boolean(a.getValue(Fge));r=Object.assign(Object.assign({},r),{horizontalScrolling:e})}i.affectsConfiguration(zge)&&void 0===t.expandOnlyOnTwistieClick&&(r=Object.assign(Object.assign({},r),{expandOnlyOnTwistieClick:"doubleClick"===a.getValue(zge)})),Object.keys(r).length>0&&e.updateOptions(r)})),this.contextKeyService.onDidChangeContext((t=>{t.affectsSome(c)&&e.updateOptions({automaticKeyboardNavigation:n()})})),l.onDidChangeScreenReaderOptimized((()=>u()))),this.navigator=new Xge(e,Object.assign({configurationService:a},t)),this.disposables.push(this.navigator)}get onDidOpen(){return this.navigator.onDidOpen}updateOptions(e){void 0!==e.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){dG(this.styler),this.styler=e?tde(this.tree,this.themeService,e):mG.None}dispose(){this.disposables=dG(this.disposables),dG(this.styler),this.styler=void 0}};rpe=Cge([Sge(4,A5),Sge(5,xge),Sge(6,B5),Sge(7,j3),Sge(8,yae)],rpe);var ope,spe;d3.as(p3).registerConfiguration({id:"workbench",order:7,title:GH(0,"Workbench"),type:"object",properties:{"workbench.list.multiSelectModifier":{type:"string",enum:["ctrlCmd","alt"],enumDescriptions:[GH(0,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),GH(0,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:GH(0,"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},"workbench.list.openMode":{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:GH(0,"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Fge]:{type:"boolean",default:!1,description:GH(0,"Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Bge]:{type:"number",default:8,minimum:0,maximum:40,description:GH(0,"Controls tree indentation in pixels.")},"workbench.tree.renderIndentGuides":{type:"string",enum:["none","onHover","always"],default:"onHover",description:GH(0,"Controls whether the tree should render indent guides.")},[Wge]:{type:"boolean",default:!1,description:GH(0,"Controls whether lists and trees have smooth scrolling.")},"workbench.list.keyboardNavigation":{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[GH(0,"Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),GH(0,"Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),GH(0,"Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:GH(0,"Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter.")},"workbench.list.automaticKeyboardNavigation":{type:"boolean",default:!0,markdownDescription:GH(0,"Controls whether keyboard navigation in lists and trees is automatically triggered simply by typing. If set to `false`, keyboard navigation is only triggered when executing the `list.toggleKeyboardNavigation` command, for which you can assign a keyboard shortcut.")},[zge]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:GH(0,"Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")}}}),function(e){e[e.Hint=1]="Hint",e[e.Info=2]="Info",e[e.Warning=4]="Warning",e[e.Error=8]="Error"}(ope||(ope={})),function(e){e.compare=function(e,t){return t-e};const t=Object.create(null);t[e.Error]=GH(0,"Error"),t[e.Warning]=GH(0,"Warning"),t[e.Info]=GH(0,"Info"),e.toString=function(e){return t[e]||""},e.fromSeverity=function(t){switch(t){case r3.Error:return e.Error;case r3.Warning:return e.Warning;case r3.Info:return e.Info;case r3.Ignore:return e.Hint}},e.toSeverity=function(t){switch(t){case e.Error:return r3.Error;case e.Warning:return r3.Warning;case e.Info:return r3.Info;case e.Hint:return r3.Ignore}}}(ope||(ope={})),function(e){const t="";function n(e,n){let i=[t];return e.source?i.push(e.source.replace("¦","\\¦")):i.push(t),e.code?"string"==typeof e.code?i.push(e.code.replace("¦","\\¦")):i.push(e.code.value.replace("¦","\\¦")):i.push(t),void 0!==e.severity&&null!==e.severity?i.push(ope.toString(e.severity)):i.push(t),e.message&&n?i.push(e.message.replace("¦","\\¦")):i.push(t),void 0!==e.startLineNumber&&null!==e.startLineNumber?i.push(e.startLineNumber.toString()):i.push(t),void 0!==e.startColumn&&null!==e.startColumn?i.push(e.startColumn.toString()):i.push(t),void 0!==e.endLineNumber&&null!==e.endLineNumber?i.push(e.endLineNumber.toString()):i.push(t),void 0!==e.endColumn&&null!==e.endColumn?i.push(e.endColumn.toString()):i.push(t),i.push(t),i.join("¦")}e.makeKey=function(e){return n(e,!0)},e.makeKeyOptionalMessage=n}(spe||(spe={}));const ape=i$("markerService");class lpe{constructor(){this._byResource=new rZ,this._byOwner=new Map}set(e,t,n){let i=this._byResource.get(e);i||(i=new Map,this._byResource.set(e,i)),i.set(t,n);let r=this._byOwner.get(t);r||(r=new rZ,this._byOwner.set(t,r)),r.set(e,n)}get(e,t){let n=this._byResource.get(e);return null==n?void 0:n.get(t)}delete(e,t){let n=!1,i=!1,r=this._byResource.get(e);r&&(n=r.delete(t));let o=this._byOwner.get(t);if(o&&(i=o.delete(e)),n!==i)throw new Error("illegal state");return n&&i}values(e){var t,n,i,r;return"string"==typeof e?null!==(n=null===(t=this._byOwner.get(e))||void 0===t?void 0:t.values())&&void 0!==n?n:lG.empty():_K.isUri(e)?null!==(r=null===(i=this._byResource.get(e))||void 0===i?void 0:i.values())&&void 0!==r?r:lG.empty():lG.map(lG.concat(...this._byOwner.values()),(e=>e[1]))}}class cpe{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new rZ,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const e=this._data.get(t);e&&this._substract(e);const n=this._resourceStats(t);this._add(n),this._data.set(t,n)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(e.scheme===j$.inMemory||e.scheme===j$.walkThrough||e.scheme===j$.walkThroughSnippet)return t;for(const{severity:n}of this._service.read({resource:e}))n===ope.Error?t.errors+=1:n===ope.Warning?t.warnings+=1:n===ope.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class upe{constructor(){this._onMarkerChanged=new LG({delay:0,merge:upe._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new lpe,this._stats=new cpe(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const n of t||[])this.changeOne(e,n,[])}changeOne(e,t,n){if(O1(n)){this._data.delete(t,e)&&this._onMarkerChanged.fire([t])}else{const i=[];for(const r of n){const n=upe._toMarker(e,t,r);n&&i.push(n)}this._data.set(t,e,i),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,n){let{code:i,severity:r,message:o,source:s,startLineNumber:a,startColumn:l,endLineNumber:c,endColumn:u,relatedInformation:h,tags:d}=n;if(o)return a=a>0?a:1,l=l>0?l:1,c=c>=a?c:a,u=u>0?u:l,{resource:t,owner:e,code:i,severity:r,message:o,source:s,startLineNumber:a,startColumn:l,endLineNumber:c,endColumn:u,relatedInformation:h,tags:d}}read(e=Object.create(null)){let{owner:t,resource:n,severities:i,take:r}=e;if((!r||r<0)&&(r=-1),t&&n){const e=this._data.get(n,t);if(e){const t=[];for(const n of e)if(upe._accept(n,i)){const e=t.push(n);if(r>0&&e===r)break}return t}return[]}if(t||n){const e=this._data.values(null!=n?n:t),o=[];for(const t of e)for(const e of t)if(upe._accept(e,i)){const t=o.push(e);if(r>0&&t===r)return o}return o}{const e=[];for(let t of this._data.values())for(let n of t)if(upe._accept(n,i)){const t=e.push(n);if(r>0&&t===r)return e}return e}}static _accept(e,t){return void 0===t||(t&e.severity)===e.severity}static _merge(e){const t=new rZ;for(let n of e)for(let e of n)t.set(e,!0);return Array.from(t.keys())}}var hpe,dpe,fpe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};(dpe=hpe||(hpe={}))[dpe.None=0]="None",dpe[dpe.Initialized=1]="Initialized",dpe[dpe.Closed=2]="Closed";class gpe extends mG{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new EG),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=hpe.None,this.cache=new Map,this.flushDelayer=new O$(gpe.DEFAULT_FLUSH_DELAY),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal((e=>this.onDidChangeItemsExternal(e))))}onDidChangeItemsExternal(e){var t,n;null===(t=e.changed)||void 0===t||t.forEach(((e,t)=>this.accept(t,e))),null===(n=e.deleted)||void 0===n||n.forEach((e=>this.accept(e,void 0)))}accept(e,t){if(this.state===hpe.Closed)return;let n=!1;if(BZ(t))n=this.cache.delete(e);else{this.cache.get(e)!==t&&(this.cache.set(e,t),n=!0)}n&&this._onDidChangeStorage.fire(e)}get(e,t){const n=this.cache.get(e);return BZ(n)?t:n}getBoolean(e,t){const n=this.get(e);return BZ(n)?t:"true"===n}getNumber(e,t){const n=this.get(e);return BZ(n)?t:parseInt(n,10)}set(e,t){return fpe(this,void 0,void 0,(function*(){if(this.state===hpe.Closed)return;if(BZ(t))return this.delete(e);const n=String(t);return this.cache.get(e)!==n?(this.cache.set(e,n),this.pendingInserts.set(e,n),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire(e),this.flushDelayer.trigger((()=>this.flushPending()))):void 0}))}delete(e){return fpe(this,void 0,void 0,(function*(){if(this.state===hpe.Closed)return;return this.cache.delete(e)?(this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire(e),this.flushDelayer.trigger((()=>this.flushPending()))):void 0}))}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}flushPending(){return fpe(this,void 0,void 0,(function*(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally((()=>{var e;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)null===(e=this.whenFlushedCallbacks.pop())||void 0===e||e()}))}))}dispose(){this.flushDelayer.dispose(),super.dispose()}}gpe.DEFAULT_FLUSH_DELAY=100;class ppe{constructor(){this.onDidChangeItemsExternal=SG.None,this.items=new Map}updateItems(e){return fpe(this,void 0,void 0,(function*(){e.insert&&e.insert.forEach(((e,t)=>this.items.set(t,e))),e.delete&&e.delete.forEach((e=>this.items.delete(e)))}))}}const mpe="__$__targetStorageMarker",vpe=i$("storageService");var ype,_pe;(_pe=ype||(ype={}))[_pe.NONE=0]="NONE",_pe[_pe.SHUTDOWN=1]="SHUTDOWN";class bpe extends mG{constructor(e={flushInterval:bpe.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new kG),this._onDidChangeTarget=this._register(new kG),this._onWillSaveState=this._register(new EG),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._globalKeyTargets=void 0}emitDidChangeValue(e,t){t===mpe?(0===e?this._globalKeyTargets=void 0:1===e&&(this._workspaceKeyTargets=void 0),this._onDidChangeTarget.fire({scope:e})):this._onDidChangeValue.fire({scope:e,key:t,target:this.getKeyTargets(e)[t]})}get(e,t,n){var i;return null===(i=this.getStorage(t))||void 0===i?void 0:i.get(e,n)}getBoolean(e,t,n){var i;return null===(i=this.getStorage(t))||void 0===i?void 0:i.getBoolean(e,n)}getNumber(e,t,n){var i;return null===(i=this.getStorage(t))||void 0===i?void 0:i.getNumber(e,n)}store(e,t,n,i){BZ(t)?this.remove(e,n):this.withPausedEmitters((()=>{var r;this.updateKeyTarget(e,n,i),null===(r=this.getStorage(n))||void 0===r||r.set(e,t)}))}remove(e,t){this.withPausedEmitters((()=>{var n;this.updateKeyTarget(e,t,void 0),null===(n=this.getStorage(t))||void 0===n||n.delete(e)}))}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,n){var i,r;const o=this.getKeyTargets(t);"number"==typeof n?o[e]!==n&&(o[e]=n,null===(i=this.getStorage(t))||void 0===i||i.set(mpe,JSON.stringify(o))):"number"==typeof o[e]&&(delete o[e],null===(r=this.getStorage(t))||void 0===r||r.set(mpe,JSON.stringify(o)))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get globalKeyTargets(){return this._globalKeyTargets||(this._globalKeyTargets=this.loadKeyTargets(0)),this._globalKeyTargets}getKeyTargets(e){return 0===e?this.globalKeyTargets:this.workspaceKeyTargets}loadKeyTargets(e){const t=this.get(mpe,e);if(t)try{return JSON.parse(t)}catch(n){}return Object.create(null)}}bpe.DEFAULT_FLUSH_INTERVAL=6e4;class wpe extends bpe{constructor(){super(),this.globalStorage=this._register(new gpe(new ppe)),this.workspaceStorage=this._register(new gpe(new ppe)),this._register(this.workspaceStorage.onDidChangeStorage((e=>this.emitDidChangeValue(1,e)))),this._register(this.globalStorage.onDidChangeStorage((e=>this.emitDidChangeValue(0,e))))}getStorage(e){return 0===e?this.globalStorage:this.workspaceStorage}}var Cpe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Spe=function(e,t){return function(n,i){t(n,i,e)}};let xpe=class{constructor(e){this._commandService=e}createMenu(e,t,n=!1){return new Epe(e,n,this._commandService,t,this)}};xpe=Cpe([Spe(0,KZ)],xpe);let Epe=class e{constructor(e,t,n,i,r){this._id=e,this._fireEventsForSubmenuChanges=t,this._commandService=n,this._contextKeyService=i,this._menuService=r,this._disposables=new pG,this._menuGroups=[],this._contextKeys=new Set,this._build();const o=new z$((()=>{this._build(),this._onDidChange.fire(this)}),50);this._disposables.add(o),this._disposables.add(Z5.onDidChangeMenu((t=>{t.has(e)&&o.schedule()})));const s=this._disposables.add(new pG);this._onDidChange=new EG({onFirstListenerAdd:()=>{const e=new z$((()=>this._onDidChange.fire(this)),50);s.add(e),s.add(i.onDidChangeContext((t=>{t.affectsSome(this._contextKeys)&&e.schedule()})))},onLastListenerRemove:s.clear.bind(s)}),this.onDidChange=this._onDidChange.event}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}_build(){this._menuGroups.length=0,this._contextKeys.clear();const t=Z5.getMenuItems(this._id);let n;t.sort(e._compareMenuItems);for(const e of t){const t=e.group||"";n&&n[0]===t||(n=[t,[]],this._menuGroups.push(n)),n[1].push(e),this._collectContextKeys(e)}}_collectContextKeys(t){if(e._fillInKbExprKeys(t.when,this._contextKeys),$5(t)){if(t.command.precondition&&e._fillInKbExprKeys(t.command.precondition,this._contextKeys),t.command.toggled){const n=t.command.toggled.condition||t.command.toggled;e._fillInKbExprKeys(n,this._contextKeys)}}else this._fireEventsForSubmenuChanges&&Z5.getMenuItems(t.submenu).forEach(this._collectContextKeys,this)}getActions(e){const t=[];for(let n of this._menuGroups){const[i,r]=n,o=[];for(const t of r)if(this._contextKeyService.contextMatchesRules(t.when)){const n=$5(t)?new J5(t.command,t.alt,e,this._contextKeyService,this._commandService):new Q5(t,this._menuService,this._contextKeyService,e);o.push(n)}o.length>0&&t.push([i,o])}return t}static _fillInKbExprKeys(e,t){if(e)for(let n of e.keys())t.add(n)}static _compareMenuItems(t,n){let i=t.group,r=n.group;if(i!==r){if(!i)return 1;if(!r)return-1;if("navigation"===i)return-1;if("navigation"===r)return 1;let e=i.localeCompare(r);if(0!==e)return e}let o=t.order||0,s=n.order||0;return o<s?-1:o>s?1:e._compareTitles($5(t)?t.command.title:t.title,$5(n)?n.command.title:n.title)}static _compareTitles(e,t){const n="string"==typeof e?e:e.original,i="string"==typeof t?t:t.original;return n.localeCompare(i)}};Epe=Cpe([Spe(2,KZ),Spe(3,A5),Spe(4,X5)],Epe);var kpe=function(e,t){return function(n,i){t(n,i,e)}};function Lpe(e){return e.toString()}class Dpe extends mG{constructor(e){super(),this.model=e,this._markersData=new Map,this._register(gG((()=>{this.model.deltaDecorations([...this._markersData.keys()],[]),this._markersData.clear()})))}update(e,t){const n=[...this._markersData.keys()];this._markersData.clear();const i=this.model.deltaDecorations(n,t);for(let r=0;r<i.length;r++)this._markersData.set(i[r],e[r]);return 0!==n.length||0!==i.length}getMarker(e){return this._markersData.get(e.id)}}let Npe=class extends mG{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new EG),this._markerDecorations=new Map,e.getModels().forEach((e=>this._onModelAdded(e))),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach((e=>e.dispose())),this._markerDecorations.clear()}getMarker(e,t){const n=this._markerDecorations.get(Lpe(e));return n&&n.getMarker(t)||null}_handleMarkerChange(e){e.forEach((e=>{const t=this._markerDecorations.get(Lpe(e));t&&this._updateDecorations(t)}))}_onModelAdded(e){const t=new Dpe(e);this._markerDecorations.set(Lpe(e.uri),t),this._updateDecorations(t)}_onModelRemoved(e){const t=this._markerDecorations.get(Lpe(e.uri));t&&(t.dispose(),this._markerDecorations.delete(Lpe(e.uri))),e.uri.scheme!==j$.inMemory&&e.uri.scheme!==j$.internal&&e.uri.scheme!==j$.vscode||this._markerService&&this._markerService.read({resource:e.uri}).map((e=>e.owner)).forEach((t=>this._markerService.remove(t,[e.uri])))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500});let n=t.map((t=>({range:this._createDecorationRange(e.model,t),options:this._createDecorationOption(t)})));e.update(t,n)&&this._onDidChangeMarker.fire(e.model)}_createDecorationRange(e,t){let n=TK.lift(t);if(t.severity!==ope.Hint||this._hasMarkerTag(t,1)||this._hasMarkerTag(t,2)||(n=n.setEndPosition(n.startLineNumber,n.startColumn+2)),n=e.validateRange(n),n.isEmpty()){let t=e.getWordAtPosition(n.getStartPosition());if(t)n=new TK(n.startLineNumber,t.startColumn,n.endLineNumber,t.endColumn);else{let t=e.getLineLastNonWhitespaceColumn(n.startLineNumber)||e.getLineMaxColumn(n.startLineNumber);1===t||(n=n.endColumn>=t?new TK(n.startLineNumber,t-1,n.endLineNumber,t):new TK(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn+1))}}else if(t.endColumn===Number.MAX_VALUE&&1===t.startColumn&&n.startLineNumber===n.endLineNumber){let i=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);i<n.endColumn&&(n=new TK(n.startLineNumber,i,n.endLineNumber,n.endColumn),t.startColumn=i)}return n}_createDecorationOption(e){let t,n,i,r,o;switch(e.severity){case ope.Hint:t=this._hasMarkerTag(e,2)?void 0:this._hasMarkerTag(e,1)?"squiggly-unnecessary":"squiggly-hint",i=0;break;case ope.Warning:t="squiggly-warning",n=V5(Pie),i=20,o={color:V5(Gne),position:CQ.Inline};break;case ope.Info:t="squiggly-info",n=V5(Fie),i=10;break;case ope.Error:default:t="squiggly-error",n=V5(Rie),i=30,o={color:V5(jne),position:CQ.Inline}}return e.tags&&(-1!==e.tags.indexOf(1)&&(r="squiggly-inline-unnecessary"),-1!==e.tags.indexOf(2)&&(r="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:n,position:wQ.Right},minimap:o,zIndex:i,inlineClassName:r}}_hasMarkerTag(e,t){return!!e.tags&&e.tags.indexOf(t)>=0}};Npe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([kpe(0,iJ),kpe(1,ape)],Npe);var Ipe=function(e,t){return function(n,i){t(n,i,e)}};let Tpe=class extends mG{constructor(e,t){super(),this._contextKeyService=e,this._configurationService=t,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new EG,this._accessibilityModeEnabledContext=_ae.bindTo(this._contextKeyService);const n=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("editor.accessibilitySupport")&&(n(),this._onDidChangeScreenReaderOptimized.fire())}))),n(),this.onDidChangeScreenReaderOptimized((()=>n()))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return"on"===e||"auto"===e&&2===this._accessibilitySupport}getAccessibilitySupport(){return this._accessibilitySupport}};Tpe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Ipe(0,A5),Ipe(1,j3)],Tpe);var Mpe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Ape{constructor(){this.mapTextToType=new Map,this.findText=""}writeText(e,t){return Mpe(this,void 0,void 0,(function*(){if(t)return void this.mapTextToType.set(t,e);try{return yield navigator.clipboard.writeText(e)}catch(r){console.error(r)}const n=document.activeElement,i=document.body.appendChild(GY("textarea",{"aria-hidden":!0}));i.style.height="1px",i.style.width="1px",i.style.position="absolute",i.value=e,i.focus(),i.select(),document.execCommand("copy"),n instanceof HTMLElement&&n.focus(),document.body.removeChild(i)}))}readText(e){return Mpe(this,void 0,void 0,(function*(){if(e)return this.mapTextToType.get(e)||"";try{return yield navigator.clipboard.readText()}catch(t){return console.error(t),""}}))}readFindText(){return Mpe(this,void 0,void 0,(function*(){return this.findText}))}writeFindText(e){return Mpe(this,void 0,void 0,(function*(){this.findText=e}))}}var Ope=function(e,t){return function(n,i){t(n,i,e)}},Rpe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function Ppe(e){return e.scheme===j$.file?e.fsPath:e.path}let Fpe=0;class Bpe{constructor(e,t,n,i,r,o,s){this.id=++Fpe,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=n,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=i,this.groupOrder=r,this.sourceId=o,this.sourceOrder=s,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Wpe{constructor(e,t){this.resourceLabel=e,this.reason=t}}class zpe{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,i]of this.elements){(0===i.reason?e:t).push(i.resourceLabel)}let n=[];return e.length>0&&n.push(GH(0,"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&n.push(GH(0,"The following files have been modified in an incompatible way: {0}.",t.join(", "))),n.join("\n")}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class Vpe{constructor(e,t,n,i,r,o,s){this.id=++Fpe,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=n,this.groupId=i,this.groupOrder=r,this.sourceId=o,this.sourceOrder=s,this.removedResources=null,this.invalidatedResources=null}canSplit(){return"function"==typeof this.actual.split}removeResource(e,t,n){this.removedResources||(this.removedResources=new zpe),this.removedResources.has(t)||this.removedResources.set(t,new Wpe(e,n))}setValid(e,t,n){n?this.invalidatedResources&&(this.invalidatedResources.delete(t),0===this.invalidatedResources.size&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new zpe),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new Wpe(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Upe{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)1===e.type&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)1===e.type&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){let e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join("\n")}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){1===e.type?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const n of this._past)t(n.actual)&&this._setElementValidFlag(n,e);for(const n of this._future)t(n.actual)&&this._setElementValidFlag(n,e)}pushElement(e){for(const t of this._future)1===t.type&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let n=0,i=this._past.length;n<i;n++)t.push(this._past[n].id);for(let n=this._future.length-1;n>=0;n--)t.push(this._future[n].id);return new jce(e,t)}restoreSnapshot(e){const t=e.elements.length;let n=!0,i=0,r=-1;for(let s=0,a=this._past.length;s<a;s++,i++){const o=this._past[s];n&&(i>=t||o.id!==e.elements[i])&&(n=!1,r=0),n||1!==o.type||o.removeResource(this.resourceLabel,this.strResource,0)}let o=-1;for(let s=this._future.length-1;s>=0;s--,i++){const r=this._future[s];n&&(i>=t||r.id!==e.elements[i])&&(n=!1,o=s),n||1!==r.type||r.removeResource(this.resourceLabel,this.strResource,0)}-1!==r&&(this._past=this._past.slice(0,r)),-1!==o&&(this._future=this._future.slice(o+1)),this.versionId++}getElements(){const e=[],t=[];for(const n of this._past)e.push(n.actual);for(const n of this._future)t.push(n.actual);return{past:e,future:t}}getClosestPastElement(){return 0===this._past.length?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return 0===this._future.length?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let n=this._past.length-1;n>=0;n--)if(this._past[n]===e){t.has(this.strResource)?this._past[n]=t.get(this.strResource):this._past.splice(n,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let n=this._future.length-1;n>=0;n--)if(this._future[n]===e){t.has(this.strResource)?this._future[n]=t.get(this.strResource):this._future.splice(n,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class Hpe{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,n=this.editStacks.length;t<n;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const jpe=new Upe("","");jpe.locked=!0;let Gpe=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);let t=[];for(const n of this._editStacks)t.push(n[1].toString());console.log(t.join("\n"))}pushElement(e,t=Gce.None,n=Kce.None){if(0===e.type){const i=Ppe(e.resource),r=this.getUriComparisonKey(e.resource);this._pushElement(new Bpe(e,i,r,t.id,t.nextOrder(),n.id,n.nextOrder()))}else{const i=new Set,r=[],o=[];for(const t of e.resources){const e=Ppe(t),n=this.getUriComparisonKey(t);i.has(n)||(i.add(n),r.push(e),o.push(n))}1===r.length?this._pushElement(new Bpe(e,r[0],o[0],t.id,t.nextOrder(),n.id,n.nextOrder())):this._pushElement(new Vpe(e,r,o,t.id,t.nextOrder(),n.id,n.nextOrder()))}}_pushElement(e){for(let t=0,n=e.strResources.length;t<n;t++){const n=e.resourceLabels[t],i=e.strResources[t];let r;this._editStacks.has(i)?r=this._editStacks.get(i):(r=new Upe(n,i),this._editStacks.set(i,r)),r.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const e=this._editStacks.get(t);if(e.hasFutureElements())return null;const n=e.getClosestPastElement();return n?n.actual:null}return null}_splitPastWorkspaceElement(e,t){const n=e.actual.split(),i=new Map;for(const r of n){const e=Ppe(r.resource),t=this.getUriComparisonKey(r.resource),n=new Bpe(r,e,t,0,0,0,0);i.set(n.strResource,n)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitPastWorkspaceElement(e,i)}}_splitFutureWorkspaceElement(e,t){const n=e.actual.split(),i=new Map;for(const r of n){const e=Ppe(r.resource),t=this.getUriComparisonKey(r.resource),n=new Bpe(r,e,t,0,0,0,0);i.set(n.strResource,n)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitFutureWorkspaceElement(e,i)}}removeElements(e){const t="string"==typeof e?e:this.getUriComparisonKey(e);if(this._editStacks.has(t)){this._editStacks.get(t).dispose(),this._editStacks.delete(t)}}setElementsValidFlag(e,t,n){const i=this.getUriComparisonKey(e);if(this._editStacks.has(i)){this._editStacks.get(i).setElementsValidFlag(t,n)}}createSnapshot(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){return this._editStacks.get(t).createSnapshot(e)}return new jce(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const n=this._editStacks.get(t);n.restoreSnapshot(e),n.hasPastElements()||n.hasFutureElements()||(n.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){return this._editStacks.get(t).getElements()}return{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,n=null;for(const[i,r]of this._editStacks){const o=r.getClosestPastElement();o&&(o.sourceId===e&&(!t||o.sourceOrder>t.sourceOrder)&&(t=o,n=i))}return[t,n]}canUndo(e){if(e instanceof Kce){const[,t]=this._findClosestUndoElementWithSource(e.id);return!!t}const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){return this._editStacks.get(t).hasPastElements()}return!1}_onError(e,t){nG(e);for(const n of t.strResources)this.removeElements(n);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,n,i,r){const o=this._acquireLocks(n);let s;try{s=t()}catch(a){return o(),i.dispose(),this._onError(a,e)}return s?s.then((()=>(o(),i.dispose(),r())),(t=>(o(),i.dispose(),this._onError(t,e)))):(o(),i.dispose(),r())}_invokeWorkspacePrepare(e){return Rpe(this,void 0,void 0,(function*(){if(void 0===e.actual.prepareUndoRedo)return mG.None;const t=e.actual.prepareUndoRedo();return void 0===t?mG.None:t}))}_invokeResourcePrepare(e,t){if(1!==e.actual.type||void 0===e.actual.prepareUndoRedo)return t(mG.None);const n=e.actual.prepareUndoRedo();return n?hG(n)?t(n):n.then((e=>t(e))):t(mG.None)}_getAffectedEditStacks(e){const t=[];for(const n of e.strResources)t.push(this._editStacks.get(n)||jpe);return new Hpe(t)}_tryToSplitAndUndo(e,t,n,i){if(t.canSplit())return this._splitPastWorkspaceElement(t,n),this._notificationService.warn(i),new Kpe(this._undo(e,0,!0));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(i),new Kpe}_checkWorkspaceUndo(e,t,n,i){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,GH(0,"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(i&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,GH(0,"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const s of n.editStacks)s.getClosestPastElement()!==t&&r.push(s.resourceLabel);if(r.length>0)return this._tryToSplitAndUndo(e,t,null,GH(0,"Could not undo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const s of n.editStacks)s.locked&&o.push(s.resourceLabel);return o.length>0?this._tryToSplitAndUndo(e,t,null,GH(0,"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):n.isValid()?null:this._tryToSplitAndUndo(e,t,null,GH(0,"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,n){const i=this._getAffectedEditStacks(t),r=this._checkWorkspaceUndo(e,t,i,!1);return r?r.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,i,n)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const n=t.getClosestPastElement();if(n){if(n===e){const n=t.getSecondClosestPastElement();if(n&&n.groupId===e.groupId)return!0}if(n.groupId===e.groupId)return!0}}return!1}_confirmAndExecuteWorkspaceUndo(e,t,n,i){return Rpe(this,void 0,void 0,(function*(){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){const r=yield this._dialogService.show(r3.Info,GH(0,"Would you like to undo '{0}' across all files?",t.label),[GH(0,"Undo in {0} Files",n.editStacks.length),GH(0,"Undo this File"),GH(0,"Cancel")],{cancelId:2});if(2===r.choice)return;if(1===r.choice)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const o=this._checkWorkspaceUndo(e,t,n,!1);if(o)return o.returnValue;i=!0}let r;try{r=yield this._invokeWorkspacePrepare(t)}catch(s){return this._onError(s,t)}const o=this._checkWorkspaceUndo(e,t,n,!0);if(o)return r.dispose(),o.returnValue;for(const e of n.editStacks)e.moveBackward(t);return this._safeInvokeWithLocks(t,(()=>t.actual.undo()),n,r,(()=>this._continueUndoInGroup(t.groupId,i)))}))}_resourceUndo(e,t,n){if(t.isValid){if(!e.locked)return this._invokeResourcePrepare(t,(i=>(e.moveBackward(t),this._safeInvokeWithLocks(t,(()=>t.actual.undo()),new Hpe([e]),i,(()=>this._continueUndoInGroup(t.groupId,n))))));{const e=GH(0,"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(e)}}else e.flushAllElements()}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,n=null;for(const[i,r]of this._editStacks){const o=r.getClosestPastElement();o&&(o.groupId===e&&(!t||o.groupOrder>t.groupOrder)&&(t=o,n=i))}return[t,n]}_continueUndoInGroup(e,t){if(!e)return;const[,n]=this._findClosestUndoElementInGroup(e);return n?this._undo(n,0,t):void 0}undo(e){if(e instanceof Kce){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return"string"==typeof e?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,n){if(!this._editStacks.has(e))return;const i=this._editStacks.get(e),r=i.getClosestPastElement();if(!r)return;if(r.groupId){const[e,i]=this._findClosestUndoElementInGroup(r.groupId);if(r!==e&&i)return this._undo(i,t,n)}if((r.sourceId!==t||r.confirmBeforeUndo)&&!n)return this._confirmAndContinueUndo(e,t,r);try{return 1===r.type?this._workspaceUndo(e,r,n):this._resourceUndo(i,r,n)}finally{}}_confirmAndContinueUndo(e,t,n){return Rpe(this,void 0,void 0,(function*(){if(1!==(yield this._dialogService.show(r3.Info,GH(0,"Would you like to undo '{0}'?",n.label),[GH(0,"Yes"),GH(0,"Cancel")],{cancelId:1})).choice)return this._undo(e,t,!0)}))}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,n=null;for(const[i,r]of this._editStacks){const o=r.getClosestFutureElement();o&&(o.sourceId===e&&(!t||o.sourceOrder<t.sourceOrder)&&(t=o,n=i))}return[t,n]}canRedo(e){if(e instanceof Kce){const[,t]=this._findClosestRedoElementWithSource(e.id);return!!t}const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){return this._editStacks.get(t).hasFutureElements()}return!1}_tryToSplitAndRedo(e,t,n,i){if(t.canSplit())return this._splitFutureWorkspaceElement(t,n),this._notificationService.warn(i),new Kpe(this._redo(e));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(i),new Kpe}_checkWorkspaceRedo(e,t,n,i){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,GH(0,"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(i&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,GH(0,"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const s of n.editStacks)s.getClosestFutureElement()!==t&&r.push(s.resourceLabel);if(r.length>0)return this._tryToSplitAndRedo(e,t,null,GH(0,"Could not redo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const s of n.editStacks)s.locked&&o.push(s.resourceLabel);return o.length>0?this._tryToSplitAndRedo(e,t,null,GH(0,"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):n.isValid()?null:this._tryToSplitAndRedo(e,t,null,GH(0,"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const n=this._getAffectedEditStacks(t),i=this._checkWorkspaceRedo(e,t,n,!1);return i?i.returnValue:this._executeWorkspaceRedo(e,t,n)}_executeWorkspaceRedo(e,t,n){return Rpe(this,void 0,void 0,(function*(){let i;try{i=yield this._invokeWorkspacePrepare(t)}catch(o){return this._onError(o,t)}const r=this._checkWorkspaceRedo(e,t,n,!0);if(r)return i.dispose(),r.returnValue;for(const e of n.editStacks)e.moveForward(t);return this._safeInvokeWithLocks(t,(()=>t.actual.redo()),n,i,(()=>this._continueRedoInGroup(t.groupId)))}))}_resourceRedo(e,t){if(t.isValid){if(!e.locked)return this._invokeResourcePrepare(t,(n=>(e.moveForward(t),this._safeInvokeWithLocks(t,(()=>t.actual.redo()),new Hpe([e]),n,(()=>this._continueRedoInGroup(t.groupId))))));{const e=GH(0,"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(e)}}else e.flushAllElements()}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,n=null;for(const[i,r]of this._editStacks){const o=r.getClosestFutureElement();o&&(o.groupId===e&&(!t||o.groupOrder<t.groupOrder)&&(t=o,n=i))}return[t,n]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);return t?this._redo(t):void 0}redo(e){if(e instanceof Kce){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return"string"==typeof e?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),n=t.getClosestFutureElement();if(n){if(n.groupId){const[e,t]=this._findClosestRedoElementInGroup(n.groupId);if(n!==e&&t)return this._redo(t)}try{return 1===n.type?this._workspaceRedo(e,n):this._resourceRedo(t,n)}finally{}}}};Gpe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Ope(0,cde),Ope(1,g4)],Gpe);class Kpe{constructor(e){this.returnValue=e}}cle(Hce,Gpe);const qpe={ctrlCmd:!1,alt:!1};var $pe,Ype,Xpe,Zpe;(Ype=$pe||($pe={}))[Ype.Blur=1]="Blur",Ype[Ype.Gesture=2]="Gesture",Ype[Ype.Other=3]="Other",(Zpe=Xpe||(Xpe={}))[Zpe.NONE=0]="NONE",Zpe[Zpe.FIRST=1]="FIRST",Zpe[Zpe.SECOND=2]="SECOND",Zpe[Zpe.LAST=3]="LAST";const Qpe=new U$((()=>{const e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:e,collatorIsNumeric:e.resolvedOptions().numeric}}));function Jpe(e,t,n){const i=e.toLowerCase(),r=t.toLowerCase(),o=function(e,t,n){const i=e.toLowerCase(),r=t.toLowerCase(),o=i.startsWith(n),s=r.startsWith(n);if(o!==s)return o?-1:1;if(o&&s){if(i.length<r.length)return-1;if(i.length>r.length)return 1}return 0}(e,t,n);if(o)return o;const s=i.endsWith(n);if(s!==r.endsWith(n))return s?-1:1;const a=function(e,t,n=!1){const i=e||"",r=t||"",o=Qpe.value.collator.compare(i,r);return Qpe.value.collatorIsNumeric&&0===o&&i!==r?i<r?-1:1:o}(i,r);return 0!==a?a:i.localeCompare(r)}const eme=new RegExp(`(\\\\)?\\$\\((${dJ.iconNameExpression}(?:${dJ.iconModifierExpression})?)\\)`,"g");function tme(e){const t=new Array;let n,i=0,r=0;for(;null!==(n=eme.exec(e));){r=n.index||0,t.push(e.substring(i,r)),i=(n.index||0)+n[0].length;const[,o,s]=n;t.push(o?`$(${s})`:nme({id:s}))}return i<e.length&&t.push(e.substring(i)),t}function nme(e){const t=GY("span");return t.classList.add(...dJ.asClassNameArray(e)),t}class ime{constructor(e,t){this.supportIcons=t,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.domNode=document.createElement("span"),this.domNode.className="monaco-highlighted-label",e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t=[],n="",i){e||(e=""),i&&(e=ime.escapeNewLines(e,t)),this.didEverRender&&this.text===e&&this.title===n&&dQ(this.highlights,t)||(this.text=e,this.title=n,this.highlights=t,this.render())}render(){const e=[];let t=0;for(const n of this.highlights){if(n.end===n.start)continue;if(t<n.start){const i=this.text.substring(t,n.start);e.push(GY("span",void 0,...this.supportIcons?tme(i):[i])),t=n.end}const i=this.text.substring(n.start,n.end),r=GY("span.highlight",void 0,...this.supportIcons?tme(i):[i]);n.extraClasses&&r.classList.add(n.extraClasses),e.push(r),t=n.end}if(t<this.text.length){const n=this.text.substring(t);e.push(GY("span",void 0,...this.supportIcons?tme(n):[n]))}zY(this.domNode,...e),this.title?this.domNode.title=this.title:this.domNode.removeAttribute("title"),this.didEverRender=!0}static escapeNewLines(e,t){let n=0,i=0;return e.replace(/\r\n|\r|\n/g,((e,r)=>{i="\r\n"===e?-1:0,r+=n;for(const n of t)n.end<=r||(n.start>=r&&(n.start+=i),n.end>=r&&(n.end+=i));return n+=i,"⏎"}))}}var rme=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function ome(e,t,n){if(!n)return;const i=function(e){if(AZ(e))return()=>rme(this,void 0,void 0,(function*(){return e}));if(VZ(e.markdown))return e.markdown;{const t=e.markdown;return()=>rme(this,void 0,void 0,(function*(){return t}))}}(n);let r,o;const s=Q$(t,RY.MOUSE_OVER,(s=>{if(r)return;const a=new OG,l=e=>{const n=e.type===RY.MOUSE_DOWN;n&&(null==o||o.dispose(),o=void 0),(n||e.fromElement===t)&&(null==r||r.dispose(),r=void 0)},c=Q$(t,RY.MOUSE_LEAVE,l,!0),u=Q$(t,RY.MOUSE_DOWN,l,!0),h={targetElements:[t],dispose:()=>{}};let d;if(void 0===e.placement||"mouse"===e.placement){const e=e=>h.x=e.x+10;d=Q$(t,RY.MOUSE_MOVE,e,!0)}const f=new z$((()=>rme(this,void 0,void 0,(function*(){var t;if(r){const s={text:GH(0,"Loading..."),target:h,hoverPosition:2};null==o||o.dispose(),o=e.showHover(s);const l=null!==(t=yield i(a.token))&&void 0!==t?t:AZ(n)?void 0:n.markdownNotSupportedFallback;if(null==o||o.dispose(),o=void 0,l&&r){const t={text:l,target:h,showPointer:"element"===e.placement,hoverPosition:2};o=e.showHover(t)}}null==d||d.dispose()}))),e.delay);f.schedule(),r=gG((()=>{f.dispose(),null==d||d.dispose(),u.dispose(),c.dispose(),a.dispose(!0)}))}),!0);return gG((()=>{s.dispose(),null==r||r.dispose(),null==o||o.dispose()}))}class sme{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set className(e){this.disposed||e===this._className||(this._className=e,this._element.className=e)}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class ame extends mG{constructor(e,t){super(),this.customHovers=new Map,this.domNode=this._register(new sme(WY(e,GY(".monaco-icon-label")))),this.labelContainer=WY(this.domNode.element,GY(".monaco-icon-label-container"));const n=WY(this.labelContainer,GY("span.monaco-icon-name-container"));this.descriptionContainer=this._register(new sme(WY(this.labelContainer,GY("span.monaco-icon-description-container")))),(null==t?void 0:t.supportHighlights)||(null==t?void 0:t.supportIcons)?this.nameNode=new cme(n,!!t.supportIcons):this.nameNode=new lme(n),(null==t?void 0:t.supportDescriptionHighlights)?this.descriptionNodeFactory=()=>new ime(WY(this.descriptionContainer.element,GY("span.label-description")),!!t.supportIcons):this.descriptionNodeFactory=()=>this._register(new sme(WY(this.descriptionContainer.element,GY("span.label-description")))),this.hoverDelegate=null==t?void 0:t.hoverDelegate}setLabel(e,t,n){const i=["monaco-icon-label"];n&&(n.extraClasses&&i.push(...n.extraClasses),n.italic&&i.push("italic"),n.strikethrough&&i.push("strikethrough")),this.domNode.className=i.join(" "),this.setupHover(this.labelContainer,null==n?void 0:n.title),this.nameNode.setLabel(e,n),(t||this.descriptionNode)&&(this.descriptionNode||(this.descriptionNode=this.descriptionNodeFactory()),this.descriptionNode instanceof ime?(this.descriptionNode.set(t||"",n?n.descriptionMatches:void 0),this.setupHover(this.descriptionNode.element,null==n?void 0:n.descriptionTitle)):(this.descriptionNode.textContent=t||"",this.setupHover(this.descriptionNode.element,(null==n?void 0:n.descriptionTitle)||""),this.descriptionNode.empty=!t))}setupHover(e,t){const n=this.customHovers.get(e);if(n&&(n.dispose(),this.customHovers.delete(e)),t)if(this.hoverDelegate){const n=ome(this.hoverDelegate,e,t);n&&this.customHovers.set(e,n)}else!function(e,t){AZ(t)?e.title=t:(null==t?void 0:t.markdownNotSupportedFallback)?e.title=t.markdownNotSupportedFallback:e.removeAttribute("title")}(e,t);else e.removeAttribute("title")}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}}class lme{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(this.label!==e||!dQ(this.options,t))if(this.label=e,this.options=t,"string"==typeof e)this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=WY(this.container,GY("a.label-name",{id:null==t?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let n=0;n<e.length;n++){const i=e[n],r=(null==t?void 0:t.domId)&&`${null==t?void 0:t.domId}_${n}`;WY(this.container,GY("a.label-name",{id:r,"data-icon-label-count":e.length,"data-icon-label-index":n,role:"treeitem"},i)),n<e.length-1&&WY(this.container,GY("span.label-separator",void 0,(null==t?void 0:t.separator)||"/"))}}}}class cme{constructor(e,t){this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(this.label!==e||!dQ(this.options,t))if(this.label=e,this.options=t,"string"==typeof e)this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=new ime(WY(this.container,GY("a.label-name",{id:null==t?void 0:t.domId})),this.supportIcons)),this.singleLabel.set(e,null==t?void 0:t.matches,void 0,null==t?void 0:t.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const n=(null==t?void 0:t.separator)||"/",i=function(e,t,n){if(!n)return;let i=0;return e.map((e=>{const r={start:i,end:i+e.length},o=n.map((e=>Hue.intersect(r,e))).filter((e=>!Hue.isEmpty(e))).map((({start:e,end:t})=>({start:e-i,end:t-i})));return i=r.end+t.length,o}))}(e,n,null==t?void 0:t.matches);for(let r=0;r<e.length;r++){const o=e[r],s=i?i[r]:void 0,a=GY("a.label-name",{id:(null==t?void 0:t.domId)&&`${null==t?void 0:t.domId}_${r}`,"data-icon-label-count":e.length,"data-icon-label-index":r,role:"treeitem"});new ime(WY(this.container,a),this.supportIcons).set(o,s,void 0,null==t?void 0:t.labelEscapeNewLines),r<e.length-1&&WY(a,GY("span.label-separator",void 0,n))}}}}class ume{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const hme=new ume("id#"),dme={},fme=new ume("quick-input-button-icon-");function gme(e){if(!e)return;let t;const n=e.dark.toString();return dme[n]?t=dme[n]:(t=fme.nextId(),MY(`.${t}`,`background-image: ${ZY(e.light||e.dark)}`),MY(`.vs-dark .${t}, .hc-black .${t}`,`background-image: ${ZY(e.dark)}`),dme[n]=t),t}const pme=GY;class mme{constructor(e,t,n){this.os=t,this.keyElements=new Set,this.options=n||Object.create(null),this.labelBackground=this.options.keybindingLabelBackground,this.labelForeground=this.options.keybindingLabelForeground,this.labelBorder=this.options.keybindingLabelBorder,this.labelBottomBorder=this.options.keybindingLabelBottomBorder,this.labelShadow=this.options.keybindingLabelShadow,this.domNode=WY(e,pme(".monaco-keybinding")),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&mme.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){let[e,t]=this.keybinding.getParts();e&&this.renderPart(this.domNode,e,this.matches?this.matches.firstPart:null),t&&(WY(this.domNode,pme("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderPart(this.domNode,t,this.matches?this.matches.chordPart:null)),this.domNode.title=this.keybinding.getAriaLabel()||""}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.applyStyles(),this.didEverRender=!0}clear(){Y$(this.domNode),this.keyElements.clear()}renderPart(e,t,n){const i=u4.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,i.ctrlKey,Boolean(null==n?void 0:n.ctrlKey),i.separator),t.shiftKey&&this.renderKey(e,i.shiftKey,Boolean(null==n?void 0:n.shiftKey),i.separator),t.altKey&&this.renderKey(e,i.altKey,Boolean(null==n?void 0:n.altKey),i.separator),t.metaKey&&this.renderKey(e,i.metaKey,Boolean(null==n?void 0:n.metaKey),i.separator);const r=t.keyLabel;r&&this.renderKey(e,r,Boolean(null==n?void 0:n.keyCode),"")}renderKey(e,t,n,i){WY(e,this.createKeyElement(t,n?".highlight":"")),i&&WY(e,pme("span.monaco-keybinding-key-separator",void 0,i))}renderUnbound(e){WY(e,this.createKeyElement(GH(0,"Unbound")))}createKeyElement(e,t=""){const n=pme("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(n),n}style(e){this.labelBackground=e.keybindingLabelBackground,this.labelForeground=e.keybindingLabelForeground,this.labelBorder=e.keybindingLabelBorder,this.labelBottomBorder=e.keybindingLabelBottomBorder,this.labelShadow=e.keybindingLabelShadow,this.applyStyles()}applyStyles(){var e;if(this.element){for(const t of this.keyElements)this.labelBackground&&(t.style.backgroundColor=null===(e=this.labelBackground)||void 0===e?void 0:e.toString()),this.labelBorder&&(t.style.borderColor=this.labelBorder.toString()),this.labelBottomBorder&&(t.style.borderBottomColor=this.labelBottomBorder.toString()),this.labelShadow&&(t.style.boxShadow=`inset 0 -1px 0 ${this.labelShadow}`);this.labelForeground&&(this.element.style.color=this.labelForeground.toString())}}static areSame(e,t){return e===t||!e&&!t||!!e&&!!t&&dQ(e.firstPart,t.firstPart)&&dQ(e.chordPart,t.chordPart)}}var vme=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},yme=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const _me=GY;class bme{constructor(e){this.hidden=!1,this._onChecked=new EG,this.onChecked=this._onChecked.event,Object.assign(this,e)}get checked(){return!!this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire(e))}dispose(){this._onChecked.dispose()}}class wme{get templateId(){return wme.ID}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=[],t.toDisposeTemplate=[],t.entry=WY(e,_me(".quick-input-list-entry"));const n=WY(t.entry,_me("label.quick-input-list-label"));t.toDisposeTemplate.push(eY(n,RY.CLICK,(e=>{t.checkbox.offsetParent||e.preventDefault()}))),t.checkbox=WY(n,_me("input.quick-input-list-checkbox")),t.checkbox.type="checkbox",t.toDisposeTemplate.push(eY(t.checkbox,RY.CHANGE,(e=>{t.element.checked=t.checkbox.checked})));const i=WY(n,_me(".quick-input-list-rows")),r=WY(i,_me(".quick-input-list-row")),o=WY(i,_me(".quick-input-list-row"));t.label=new ame(r,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0});const s=WY(r,_me(".quick-input-list-entry-keybinding"));t.keybinding=new mme(s,pj);const a=WY(o,_me(".quick-input-list-label-meta"));return t.detail=new ime(a,!0),t.separator=WY(t.entry,_me(".quick-input-list-separator")),t.actionBar=new Sle(t.entry),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.push(t.actionBar),t}renderElement(e,t,n){n.toDisposeElement=dG(n.toDisposeElement),n.element=e,n.checkbox.checked=e.checked,n.toDisposeElement.push(e.onChecked((e=>n.checkbox.checked=e)));const{labelHighlights:i,descriptionHighlights:r,detailHighlights:o}=e,s=Object.create(null);s.matches=i||[],s.descriptionTitle=e.saneDescription,s.descriptionMatches=r||[],s.extraClasses=e.item.iconClasses,s.italic=e.item.italic,s.strikethrough=e.item.strikethrough,n.label.setLabel(e.saneLabel,e.saneDescription,s),n.keybinding.set(e.item.keybinding),n.detail.set(e.saneDetail,o),e.separator&&e.separator.label?(n.separator.textContent=e.separator.label,n.separator.style.display=""):n.separator.style.display="none",n.entry.classList.toggle("quick-input-list-separator-border",!!e.separator),n.actionBar.clear();const a=e.item.buttons;a&&a.length?(n.actionBar.push(a.map(((t,n)=>{let i=t.iconClass||(t.iconPath?gme(t.iconPath):void 0);t.alwaysVisible&&(i=i?`${i} always-visible`:"always-visible");const r=new s5(`id-${n}`,"",i,!0,(()=>yme(this,void 0,void 0,(function*(){e.fireButtonTriggered({button:t,item:e.item})}))));return r.tooltip=t.tooltip||"",r})),{icon:!0,label:!1}),n.entry.classList.add("has-actions")):n.entry.classList.remove("has-actions")}disposeElement(e,t,n){n.toDisposeElement=dG(n.toDisposeElement)}disposeTemplate(e){e.toDisposeElement=dG(e.toDisposeElement),e.toDisposeTemplate=dG(e.toDisposeTemplate)}}wme.ID="listelement";class Cme{getHeight(e){return e.saneDetail?44:22}getTemplateId(e){return wme.ID}}var Sme,xme;(xme=Sme||(Sme={}))[xme.First=1]="First",xme[xme.Second=2]="Second",xme[xme.Last=3]="Last",xme[xme.Next=4]="Next",xme[xme.Previous=5]="Previous",xme[xme.NextPage=6]="NextPage",xme[xme.PreviousPage=7]="PreviousPage";class Eme{constructor(e,t,n){this.parent=e,this.inputElements=[],this.elements=[],this.elementsToIndexes=new Map,this.matchOnDescription=!1,this.matchOnDetail=!1,this.matchOnLabel=!0,this.matchOnMeta=!0,this.sortByLabel=!0,this._onChangedAllVisibleChecked=new EG,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new EG,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new EG,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new EG,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new EG,this.onButtonTriggered=this._onButtonTriggered.event,this._onKeyDown=new EG,this.onKeyDown=this._onKeyDown.event,this._onLeave=new EG,this.onLeave=this._onLeave.event,this._fireCheckedEvents=!0,this.elementDisposables=[],this.disposables=[],this.id=t,this.container=WY(this.parent,_me(".quick-input-list"));const i=new Cme,r=new kme;this.list=n.createList("QuickInput",this.container,i,[new wme],{identityProvider:{getId:e=>e.saneLabel},setRowLineHeight:!1,multipleSelectionSupport:!1,horizontalScrolling:!1,accessibilityProvider:r}),this.list.getHTMLElement().id=t,this.disposables.push(this.list),this.disposables.push(this.list.onKeyDown((e=>{const t=new C$(e);switch(t.keyCode){case 10:this.toggleCheckbox();break;case 31:(lj?e.metaKey:e.ctrlKey)&&this.list.setFocus(z1(this.list.length));break;case 16:const t=this.list.getFocus();1===t.length&&0===t[0]&&this._onLeave.fire();break;case 18:const n=this.list.getFocus();1===n.length&&n[0]===this.list.length-1&&this._onLeave.fire()}this._onKeyDown.fire(t)}))),this.disposables.push(this.list.onMouseDown((e=>{2!==e.browserEvent.button&&e.browserEvent.preventDefault()}))),this.disposables.push(Q$(this.container,RY.CLICK,(e=>{(e.x||e.y)&&this._onLeave.fire()}))),this.disposables.push(this.list.onMouseMiddleClick((e=>{this._onLeave.fire()}))),this.disposables.push(this.list.onContextMenu((e=>{"number"==typeof e.index&&(e.browserEvent.preventDefault(),this.list.setSelection([e.index]))}))),this.disposables.push(this._onChangedAllVisibleChecked,this._onChangedCheckedCount,this._onChangedVisibleCount,this._onChangedCheckedElements,this._onButtonTriggered,this._onLeave,this._onKeyDown)}get onDidChangeFocus(){return SG.map(this.list.onDidChangeFocus,(e=>e.elements.map((e=>e.item))))}get onDidChangeSelection(){return SG.map(this.list.onDidChangeSelection,(e=>({items:e.elements.map((e=>e.item)),event:e.browserEvent})))}getAllVisibleChecked(){return this.allVisibleChecked(this.elements,!1)}allVisibleChecked(e,t=!0){for(let n=0,i=e.length;n<i;n++){const i=e[n];if(!i.hidden){if(!i.checked)return!1;t=!0}}return t}getCheckedCount(){let e=0;const t=this.elements;for(let n=0,i=t.length;n<i;n++)t[n].checked&&e++;return e}getVisibleCount(){let e=0;const t=this.elements;for(let n=0,i=t.length;n<i;n++)t[n].hidden||e++;return e}setAllVisibleChecked(e){try{this._fireCheckedEvents=!1,this.elements.forEach((t=>{t.hidden||(t.checked=e)}))}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}setElements(e){this.elementDisposables=dG(this.elementDisposables);const t=e=>this.fireButtonTriggered(e);this.inputElements=e,this.elements=e.reduce(((n,i,r)=>{var o,s,a;if("separator"!==i.type){const l=r&&e[r-1],c=i.label&&i.label.replace(/\r?\n/g," "),u=i.meta&&i.meta.replace(/\r?\n/g," "),h=i.description&&i.description.replace(/\r?\n/g," "),d=i.detail&&i.detail.replace(/\r?\n/g," "),f=i.ariaLabel||[c,h,d].map((e=>{return(t=e)?t.replace(/\$\((.*?)\)/g,((e,t)=>` ${t} `)).trim():"";var t})).filter((e=>!!e)).join(", ");n.push(new bme({index:r,item:i,saneLabel:c,saneMeta:u,saneAriaLabel:f,saneDescription:h,saneDetail:d,labelHighlights:null===(o=i.highlights)||void 0===o?void 0:o.label,descriptionHighlights:null===(s=i.highlights)||void 0===s?void 0:s.description,detailHighlights:null===(a=i.highlights)||void 0===a?void 0:a.detail,checked:!1,separator:l&&"separator"===l.type?l:void 0,fireButtonTriggered:t}))}return n}),[]),this.elementDisposables.push(...this.elements),this.elementDisposables.push(...this.elements.map((e=>e.onChecked((()=>this.fireCheckedEvents()))))),this.elementsToIndexes=this.elements.reduce(((e,t,n)=>(e.set(t.item,n),e)),new Map),this.list.splice(0,this.list.length),this.list.splice(0,this.list.length,this.elements),this._onChangedVisibleCount.fire(this.elements.length)}getFocusedElements(){return this.list.getFocusedElements().map((e=>e.item))}setFocusedElements(e){if(this.list.setFocus(e.filter((e=>this.elementsToIndexes.has(e))).map((e=>this.elementsToIndexes.get(e)))),e.length>0){const e=this.list.getFocus()[0];"number"==typeof e&&this.list.reveal(e)}}getActiveDescendant(){return this.list.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){this.list.setSelection(e.filter((e=>this.elementsToIndexes.has(e))).map((e=>this.elementsToIndexes.get(e))))}getCheckedElements(){return this.elements.filter((e=>e.checked)).map((e=>e.item))}setCheckedElements(e){try{this._fireCheckedEvents=!1;const t=new Set;for(const n of e)t.add(n);for(const e of this.elements)e.checked=t.has(e.item)}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}set enabled(e){this.list.getHTMLElement().style.pointerEvents=e?"":"none"}focus(e){if(!this.list.length)return;switch(e===Sme.Next&&this.list.getFocus()[0]===this.list.length-1&&(e=Sme.First),e===Sme.Previous&&0===this.list.getFocus()[0]&&(e=Sme.Last),e===Sme.Second&&this.list.length<2&&(e=Sme.First),e){case Sme.First:this.list.focusFirst();break;case Sme.Second:this.list.focusNth(1);break;case Sme.Last:this.list.focusLast();break;case Sme.Next:this.list.focusNext();break;case Sme.Previous:this.list.focusPrevious();break;case Sme.NextPage:this.list.focusNextPage();break;case Sme.PreviousPage:this.list.focusPreviousPage()}const t=this.list.getFocus()[0];"number"==typeof t&&this.list.reveal(t)}clearFocus(){this.list.setFocus([])}domFocus(){this.list.domFocus()}layout(e){this.list.getHTMLElement().style.maxHeight=e?`calc(${44*Math.floor(e/44)}px)`:"",this.list.layout()}filter(e){if(!(this.sortByLabel||this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))return this.list.layout(),!1;if((e=e.trim())&&(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail)){let t;this.elements.forEach((n=>{const i=this.matchOnLabel?GZ(Vhe(e,zhe(n.saneLabel))):void 0,r=this.matchOnDescription?GZ(Vhe(e,zhe(n.saneDescription||""))):void 0,o=this.matchOnDetail?GZ(Vhe(e,zhe(n.saneDetail||""))):void 0,s=this.matchOnMeta?GZ(Vhe(e,zhe(n.saneMeta||""))):void 0;if(i||r||o||s?(n.labelHighlights=i,n.descriptionHighlights=r,n.detailHighlights=o,n.hidden=!1):(n.labelHighlights=void 0,n.descriptionHighlights=void 0,n.detailHighlights=void 0,n.hidden=!n.item.alwaysShow),n.separator=void 0,!this.sortByLabel){const e=n.index&&this.inputElements[n.index-1];t=e&&"separator"===e.type?e:t,t&&!n.hidden&&(n.separator=t,t=void 0)}}))}else this.elements.forEach((e=>{e.labelHighlights=void 0,e.descriptionHighlights=void 0,e.detailHighlights=void 0,e.hidden=!1;const t=e.index&&this.inputElements[e.index-1];e.separator=t&&"separator"===t.type?t:void 0}));const t=this.elements.filter((e=>!e.hidden));if(this.sortByLabel&&e){const n=e.toLowerCase();t.sort(((e,t)=>function(e,t,n){const i=e.labelHighlights||[],r=t.labelHighlights||[];if(i.length&&!r.length)return-1;if(!i.length&&r.length)return 1;if(0===i.length&&0===r.length)return 0;return Jpe(e.saneLabel,t.saneLabel,n)}(e,t,n)))}return this.elementsToIndexes=t.reduce(((e,t,n)=>(e.set(t.item,n),e)),new Map),this.list.splice(0,this.list.length,t),this.list.setFocus([]),this.list.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(t.length),!0}toggleCheckbox(){try{this._fireCheckedEvents=!1;const e=this.list.getFocusedElements(),t=this.allVisibleChecked(e);for(const n of e)n.checked=!t}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}display(e){this.container.style.display=e?"":"none"}isDisplayed(){return"none"!==this.container.style.display}dispose(){this.elementDisposables=dG(this.elementDisposables),this.disposables=dG(this.disposables)}fireCheckedEvents(){this._fireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(e){this._onButtonTriggered.fire(e)}style(e){this.list.style(e)}}vme([T6],Eme.prototype,"onDidChangeFocus",null),vme([T6],Eme.prototype,"onDidChangeSelection",null);class kme{getWidgetAriaLabel(){return GH(0,"Quick Input")}getAriaLabel(e){return e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(){return"option"}}function Lme(e,t={}){const n=Dme(t);return Ime(n,function(e,t){const n={type:1,children:[]};let i=0,r=n;const o=[],s=new Nme(e);for(;!s.eos();){let e=s.next();const n="\\"===e&&0!==Mme(s.peek(),t);if(n&&(e=s.next()),!n&&Tme(e,t)&&e===s.peek()){s.advance(),2===r.type&&(r=o.pop());const n=Mme(e,t);if(r.type===n||5===r.type&&6===n)r=o.pop();else{const e={type:n,children:[]};5===n&&(e.index=i,i++),r.children.push(e),o.push(r),r=e}}else if("\n"===e)2===r.type&&(r=o.pop()),r.children.push({type:8});else if(2!==r.type){const t={type:2,content:e};r.children.push(t),o.push(r),r=t}else r.content+=e}2===r.type&&(r=o.pop());return n}(e,!!t.renderCodeSegements),t.actionHandler,t.renderCodeSegements),n}function Dme(e){const t=e.inline?"span":"div",n=document.createElement(t);return e.className&&(n.className=e.className),n}class Nme{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function Ime(e,t,n,i){let r;if(2===t.type)r=document.createTextNode(t.content||"");else if(3===t.type)r=document.createElement("b");else if(4===t.type)r=document.createElement("i");else if(7===t.type&&i)r=document.createElement("code");else if(5===t.type&&n){const e=document.createElement("a");e.href="#",n.disposeables.add(eY(e,"click",(e=>{n.callback(String(t.index),e)}))),r=e}else 8===t.type?r=document.createElement("br"):1===t.type&&(r=e);r&&e!==r&&e.appendChild(r),r&&Array.isArray(t.children)&&t.children.forEach((e=>{Ime(r,e,n,i)}))}function Tme(e,t){return 0!==Mme(e,t)}function Mme(e,t){switch(e){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return t?7:0;default:return 0}}class Ame{constructor(e,t=0,n=e.length,i=t-1){this.items=e,this.start=t,this.end=n,this.index=i}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class Ome{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._currentPosition()!==this._elements.length-1?this._navigator.next():null}previous(){return 0!==this._currentPosition()?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new Ame(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(const t of e)this._history.add(t)}get _elements(){const e=[];return this._history.forEach((t=>e.push(t))),e}}const Rme=GY,Pme={inputBackground:Q8.fromHex("#3C3C3C"),inputForeground:Q8.fromHex("#CCCCCC"),inputValidationInfoBorder:Q8.fromHex("#55AAFF"),inputValidationInfoBackground:Q8.fromHex("#063B49"),inputValidationWarningBorder:Q8.fromHex("#B89500"),inputValidationWarningBackground:Q8.fromHex("#352A05"),inputValidationErrorBorder:Q8.fromHex("#BE1100"),inputValidationErrorBackground:Q8.fromHex("#5A1D1D")};class Fme extends Yre{constructor(e,t,n){var i;super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new EG),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new EG),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=n||Object.create(null),hQ(this.options,Pme,!1),this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=null!==(i=this.options.tooltip)&&void 0!==i?i:this.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.inputBackground=this.options.inputBackground,this.inputForeground=this.options.inputForeground,this.inputBorder=this.options.inputBorder,this.inputValidationInfoBorder=this.options.inputValidationInfoBorder,this.inputValidationInfoBackground=this.options.inputValidationInfoBackground,this.inputValidationInfoForeground=this.options.inputValidationInfoForeground,this.inputValidationWarningBorder=this.options.inputValidationWarningBorder,this.inputValidationWarningBackground=this.options.inputValidationWarningBackground,this.inputValidationWarningForeground=this.options.inputValidationWarningForeground,this.inputValidationErrorBorder=this.options.inputValidationErrorBorder,this.inputValidationErrorBackground=this.options.inputValidationErrorBackground,this.inputValidationErrorForeground=this.options.inputValidationErrorForeground,this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=WY(e,Rme(".monaco-inputbox.idle"));let r=this.options.flexibleHeight?"textarea":"input",o=WY(this.element,Rme(".ibwrapper"));if(this.input=WY(o,Rme(r+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,(()=>this.element.classList.add("synthetic-focus"))),this.onblur(this.input,(()=>this.element.classList.remove("synthetic-focus"))),this.options.flexibleHeight){this.maxHeight="number"==typeof this.options.flexibleMaxHeight?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=WY(o,Rme("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new goe(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),WY(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll((e=>this.input.scrollTop=e.scrollTop)));const t=this._register(new Xae(document,"selectionchange")),n=SG.filter(t.event,(()=>{const e=document.getSelection();return(null==e?void 0:e.anchorNode)===o}));this._register(n(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,(()=>this.onValueChange())),this.onblur(this.input,(()=>this.onBlur())),this.onfocus(this.input,(()=>this.onFocus())),this.ignoreGesture(this.input),setTimeout((()=>this.updateMirror()),0),this.options.actions&&(this.actionbar=this._register(new Sle(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.input.title=e}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return"number"==typeof this.cachedHeight?this.cachedHeight:wY(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return document.activeElement===this.input}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}get width(){return yY(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){t=(parseFloat(this.mirror.style.paddingLeft||"")||0)+(parseFloat(this.mirror.style.paddingRight||"")||0)}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.options.flexibleHeight&&this.options.flexibleWidth?this.input.style.width=`calc(100% - ${e}px)`:this.input.style.paddingRight=e+"px",this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if("number"!=typeof this.cachedContentHeight||"number"!=typeof this.cachedHeight||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,n=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:n})}showMessage(e,t){this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const n=this.stylesForType(this.message.type);this.element.style.border=n.border?`1px solid ${n.border}`:"",(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),null==e?void 0:e.type}stylesForType(e){switch(e){case 1:return{border:this.inputValidationInfoBorder,background:this.inputValidationInfoBackground,foreground:this.inputValidationInfoForeground};case 2:return{border:this.inputValidationWarningBorder,background:this.inputValidationWarningBackground,foreground:this.inputValidationWarningForeground};default:return{border:this.inputValidationErrorBorder,background:this.inputValidationErrorBackground,foreground:this.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t,n=()=>e.style.width=yY(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:t=>{if(!this.message)return null;e=WY(t,Rme(".monaco-inputbox-container")),n();const i={inline:!0,className:"monaco-inputbox-message"},r=this.message.formatContent?Lme(this.message.content,i):function(e,t={}){const n=Dme(t);return n.textContent=e,n}(this.message.content,i);r.classList.add(this.classForType(this.message.type));const o=this.stylesForType(this.message.type);return r.style.backgroundColor=o.background?o.background.toString():"",r.style.color=o.foreground?o.foreground.toString():"",r.style.border=o.border?`1px solid ${o.border}`:"",WY(e,r),null},onHide:()=>{this.state="closed"},layout:n}),t=3===this.message.type?GH(0,"Error: {0}",this.message.content):2===this.message.type?GH(0,"Warning: {0}",this.message.content):GH(0,"Info: {0}",this.message.content),t5(t),this.state="open"}_hideMessage(){this.contextViewProvider&&("open"===this.state&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),"open"===this.state&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,t=10===e.charCodeAt(e.length-1)?" ":"";e+t?this.mirror.textContent=e+t:this.mirror.innerText=" ",this.layout()}style(e){this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){const e=this.inputBackground?this.inputBackground.toString():"",t=this.inputForeground?this.inputForeground.toString():"",n=this.inputBorder?this.inputBorder.toString():"";this.element.style.backgroundColor=e,this.element.style.color=t,this.input.style.backgroundColor="inherit",this.input.style.color=t,this.element.style.borderWidth=n?"1px":"",this.element.style.borderStyle=n?"solid":"",this.element.style.borderColor=n}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=wY(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,n=t.selectionStart,i=t.selectionEnd,r=t.value;null!==n&&null!==i&&(this.value=r.substr(0,n)+e+r.substr(i),t.setSelectionRange(n+1,n+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar&&this.actionbar.dispose(),super.dispose()}}class Bme extends Fme{constructor(e,t,n){super(e,t,n),this.history=new Ome(n.history,100)}addToHistory(){this.value&&this.value!==this.getCurrentValue()&&this.history.add(this.value)}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),e&&(this.value=e,n5(this.value))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,n5(this.value))}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()||this.history.last()}}const Wme=GY;class zme extends mG{constructor(e){super(),this.parent=e,this.onKeyDown=e=>Q$(this.inputBox.inputElement,RY.KEY_DOWN,(t=>{e(new C$(t))})),this.onMouseDown=e=>Q$(this.inputBox.inputElement,RY.MOUSE_DOWN,(t=>{e(new L$(t))})),this.onDidChange=e=>this.inputBox.onDidChange(e),this.container=WY(this.parent,Wme(".quick-input-box")),this.inputBox=this._register(new Fme(this.container,void 0))}get value(){return this.inputBox.value}set value(e){this.inputBox.value=e}select(e=null){this.inputBox.select(e)}isSelectionAtEnd(){return this.inputBox.isSelectionAtEnd()}get placeholder(){return this.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.inputBox.setPlaceHolder(e)}get ariaLabel(){return this.inputBox.getAriaLabel()}set ariaLabel(e){this.inputBox.setAriaLabel(e)}get password(){return"password"===this.inputBox.inputElement.type}set password(e){this.inputBox.inputElement.type=e?"password":"text"}setAttribute(e,t){this.inputBox.inputElement.setAttribute(e,t)}removeAttribute(e){this.inputBox.inputElement.removeAttribute(e)}showDecoration(e){e===r3.Ignore?this.inputBox.hideMessage():this.inputBox.showMessage({type:e===r3.Info?1:e===r3.Warning?2:3,content:""})}stylesForType(e){return this.inputBox.stylesForType(e===r3.Info?1:e===r3.Warning?2:3)}setFocus(){this.inputBox.focus()}layout(){this.inputBox.layout()}style(e){this.inputBox.style(e)}}const Vme={badgeBackground:Q8.fromHex("#4D4D4D"),badgeForeground:Q8.fromHex("#FFFFFF")};class Ume{constructor(e,t){this.count=0,this.options=t||Object.create(null),hQ(this.options,Vme,!1),this.badgeBackground=this.options.badgeBackground,this.badgeForeground=this.options.badgeForeground,this.badgeBorder=this.options.badgeBorder,this.element=WY(e,GY(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){this.element.textContent=nX(this.countFormat,this.count),this.element.title=nX(this.titleFormat,this.count),this.applyStyles()}style(e){this.badgeBackground=e.badgeBackground,this.badgeForeground=e.badgeForeground,this.badgeBorder=e.badgeBorder,this.applyStyles()}applyStyles(){if(this.element){const e=this.badgeBackground?this.badgeBackground.toString():"",t=this.badgeForeground?this.badgeForeground.toString():"",n=this.badgeBorder?this.badgeBorder.toString():"";this.element.style.backgroundColor=e,this.element.style.color=t,this.element.style.borderWidth=n?"1px":"",this.element.style.borderStyle=n?"solid":"",this.element.style.borderColor=n}}}const Hme={progressBarBackground:Q8.fromHex("#0E70C0")};class jme extends mG{constructor(e,t){super(),this.options=t||Object.create(null),hQ(this.options,Hme,!1),this.workedVal=0,this.progressBarBackground=this.options.progressBarBackground,this._register(this.showDelayedScheduler=new z$((()=>KY(this.element)),0)),this.create(e)}create(e){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.element.appendChild(this.bit),this.applyStyles()}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove("active","infinite","discrete"),this.workedVal=0,this.totalWork=void 0}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add("done"),this.element.classList.contains("infinite")?(this.bit.style.opacity="0",e?setTimeout((()=>this.off()),200):this.off()):(this.bit.style.width="inherit",e?setTimeout((()=>this.off()),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove("discrete","done"),this.element.classList.add("active","infinite"),this}getContainer(){return this.element}style(e){this.progressBarBackground=e.progressBarBackground,this.applyStyles()}applyStyles(){if(this.bit){const e=this.progressBarBackground?this.progressBarBackground.toString():"";this.bit.style.backgroundColor=e}}}const Gme={buttonBackground:Q8.fromHex("#0E639C"),buttonHoverBackground:Q8.fromHex("#006BB3"),buttonForeground:Q8.white};class Kme extends mG{constructor(e,t){super(),this._onDidClick=this._register(new EG),this.options=t||Object.create(null),hQ(this.options,Gme,!1),this.buttonForeground=this.options.buttonForeground,this.buttonBackground=this.options.buttonBackground,this.buttonHoverBackground=this.options.buttonHoverBackground,this.buttonSecondaryForeground=this.options.buttonSecondaryForeground,this.buttonSecondaryBackground=this.options.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=this.options.buttonSecondaryHoverBackground,this.buttonBorder=this.options.buttonBorder,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),e.appendChild(this._element),this._register(O6.addTarget(this._element)),[RY.CLICK,M6.Tap].forEach((e=>{this._register(Q$(this._element,e,(e=>{this.enabled?this._onDidClick.fire(e):PY(e)})))})),this._register(Q$(this._element,RY.KEY_DOWN,(e=>{const t=new C$(e);let n=!1;this.enabled&&(t.equals(3)||t.equals(10))?(this._onDidClick.fire(e),n=!0):t.equals(9)&&(this._element.blur(),n=!0),n&&PY(t,!0)}))),this._register(Q$(this._element,RY.MOUSE_OVER,(e=>{this._element.classList.contains("disabled")||this.setHoverBackground()}))),this._register(Q$(this._element,RY.MOUSE_OUT,(e=>{this.applyStyles()}))),this.focusTracker=this._register(BY(this._element)),this._register(this.focusTracker.onDidFocus((()=>this.setHoverBackground()))),this._register(this.focusTracker.onDidBlur((()=>this.applyStyles()))),this.applyStyles()}get onDidClick(){return this._onDidClick.event}setHoverBackground(){let e;e=this.options.secondary?this.buttonSecondaryHoverBackground?this.buttonSecondaryHoverBackground.toString():null:this.buttonHoverBackground?this.buttonHoverBackground.toString():null,e&&(this._element.style.backgroundColor=e)}style(e){this.buttonForeground=e.buttonForeground,this.buttonBackground=e.buttonBackground,this.buttonHoverBackground=e.buttonHoverBackground,this.buttonSecondaryForeground=e.buttonSecondaryForeground,this.buttonSecondaryBackground=e.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=e.buttonSecondaryHoverBackground,this.buttonBorder=e.buttonBorder,this.applyStyles()}applyStyles(){if(this._element){let e,t;this.options.secondary?(t=this.buttonSecondaryForeground?this.buttonSecondaryForeground.toString():"",e=this.buttonSecondaryBackground?this.buttonSecondaryBackground.toString():""):(t=this.buttonForeground?this.buttonForeground.toString():"",e=this.buttonBackground?this.buttonBackground.toString():"");const n=this.buttonBorder?this.buttonBorder.toString():"";this._element.style.color=t,this._element.style.backgroundColor=e,this._element.style.borderWidth=n?"1px":"",this._element.style.borderStyle=n?"solid":"",this._element.style.borderColor=n}}get element(){return this._element}set label(e){this._element.classList.add("monaco-text-button"),this.options.supportIcons?zY(this._element,...tme(e)):this._element.textContent=e,"string"==typeof this.options.title?this._element.title=this.options.title:this.options.title&&(this._element.title=e)}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}}var qme=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const $me=GY,Yme={iconClass:uJ("quick-input-back",hJ.arrowLeft).classNames,tooltip:GH(0,"Back"),handle:-1};class Xme extends mG{constructor(e){super(),this.ui=e,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.noValidationMessage=Xme.noPromptMessage,this._severity=r3.Ignore,this.buttonsUpdated=!1,this.onDidTriggerButtonEmitter=this._register(new EG),this.onDidHideEmitter=this._register(new EG),this.onDisposeEmitter=this._register(new EG),this.visibleDisposables=this._register(new pG),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!dj;this._ignoreFocusOut=e&&!dj,t&&this.update()}get buttons(){return this._buttons}set buttons(e){this._buttons=e,this.buttonsUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton((e=>{-1!==this.buttons.indexOf(e)&&this.onDidTriggerButtonEmitter.fire(e)}))),this.ui.show(this),this.visible=!0,this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=$pe.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}update(){if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:e||"&nbsp;"===this.ui.title.innerHTML||(this.ui.title.innerText=" ;");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this.busy&&!this.busyDelay&&(this.busyDelay=new B$,this.busyDelay.setIfNotSet((()=>{this.visible&&this.ui.progressBar.infinite()}),800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const e=this.buttons.filter((e=>e===Yme));this.ui.leftActionBar.push(e.map(((e,t)=>{const n=new s5(`id-${t}`,"",e.iconClass||gme(e.iconPath),!0,(()=>qme(this,void 0,void 0,(function*(){this.onDidTriggerButtonEmitter.fire(e)}))));return n.tooltip=e.tooltip||"",n})),{icon:!0,label:!1}),this.ui.rightActionBar.clear();const t=this.buttons.filter((e=>e!==Yme));this.ui.rightActionBar.push(t.map(((e,t)=>{const n=new s5(`id-${t}`,"",e.iconClass||gme(e.iconPath),!0,(()=>qme(this,void 0,void 0,(function*(){this.onDidTriggerButtonEmitter.fire(e)}))));return n.tooltip=e.tooltip||"",n})),{icon:!0,label:!1})}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const n=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==n&&(this._lastValidationMessage=n,zY(this.ui.message,...tme(n))),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?GH(0,"{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==r3.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.paddingBottom="4px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.paddingBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}Xme.noPromptMessage=GH(0,"Press 'Enter' to confirm your input or 'Escape' to cancel");class Zme extends Xme{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new EG),this.onWillAcceptEmitter=this._register(new EG),this.onDidAcceptEmitter=this._register(new EG),this.onDidCustomEmitter=this._register(new EG),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._sortByLabel=!0,this._autoFocusOnList=!0,this._itemActivation=this.ui.isScreenReaderOptimized()?Xpe.NONE:Xpe.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new EG),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new EG),this.onDidTriggerItemButtonEmitter=this._register(new EG),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e||"",this.update(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get autoFocusOnList(){return this._autoFocusOnList}set autoFocusOnList(e){this._autoFocusOnList=e,this.update()}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?qpe:this.ui.keyMods}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.autoFocusOnList&&(this.canSelectMany||this.ui.list.focus(Sme.First))}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange((e=>{if(e===this.value)return;this._value=e;this.ui.list.filter(this.filterValue(this.ui.inputBox.value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(e)}))),this.visibleDisposables.add(this.ui.inputBox.onMouseDown((e=>{this.autoFocusOnList||this.ui.list.clearFocus()}))),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown((e=>{switch(e.keyCode){case 18:this.ui.list.focus(Sme.Next),this.canSelectMany&&this.ui.list.domFocus(),PY(e,!0);break;case 16:this.ui.list.getFocusedElements().length?this.ui.list.focus(Sme.Previous):this.ui.list.focus(Sme.Last),this.canSelectMany&&this.ui.list.domFocus(),PY(e,!0);break;case 12:this.ui.list.focus(Sme.NextPage),this.canSelectMany&&this.ui.list.domFocus(),PY(e,!0);break;case 11:this.ui.list.focus(Sme.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),PY(e,!0);break;case 17:if(!this._canAcceptInBackground)return;if(!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:!e.ctrlKey&&!e.metaKey||e.shiftKey||e.altKey||(this.ui.list.focus(Sme.First),PY(e,!0));break;case 13:!e.ctrlKey&&!e.metaKey||e.shiftKey||e.altKey||(this.ui.list.focus(Sme.Last),PY(e,!0))}}))),this.visibleDisposables.add(this.ui.onDidAccept((()=>{!this.canSelectMany&&this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)}))),this.visibleDisposables.add(this.ui.onDidCustom((()=>{this.onDidCustomEmitter.fire()}))),this.visibleDisposables.add(this.ui.list.onDidChangeFocus((e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&D1(e,this._activeItems,((e,t)=>e===t))||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))}))),this.visibleDisposables.add(this.ui.list.onDidChangeSelection((({items:e,event:t})=>{this.canSelectMany?e.length&&this.ui.list.setSelectedElements([]):this.selectedItemsToConfirm!==this._selectedItems&&D1(e,this._selectedItems,((e,t)=>e===t))||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(t instanceof MouseEvent&&1===t.button))}))),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements((e=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&D1(e,this._selectedItems,((e,t)=>e===t))||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e)))}))),this.visibleDisposables.add(this.ui.list.onButtonTriggered((e=>this.onDidTriggerItemButtonEmitter.fire(e)))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return Q$(this.ui.container,RY.KEY_UP,(e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new C$(e),n=t.keyCode;this._quickNavigate.keybindings.some((e=>{const[i,r]=e.getParts();return!r&&(i.shiftKey&&4===n?!(t.ctrlKey||t.altKey||t.metaKey):!(!i.altKey||6!==n)||(!(!i.ctrlKey||5!==n)||!(!i.metaKey||57!==n)))}))&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)}))}update(){if(!this.visible)return;const e=!!this._hideInput&&this._items.length>0;this.ui.container.classList.toggle("hidden-input",e&&!this.description);const t={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!e,progressBar:!e,visibleCount:!0,count:this.canSelectMany,ok:"default"===this.ok?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(t),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");const n=this.ariaLabel||this.placeholder||Zme.DEFAULT_ARIA_LABEL;if(this.ui.inputBox.ariaLabel!==n&&(this.ui.inputBox.ariaLabel=n),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated)switch(this.itemsUpdated=!1,this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case Xpe.NONE:this._itemActivation=Xpe.FIRST;break;case Xpe.SECOND:this.ui.list.focus(Sme.Second),this._itemActivation=Xpe.FIRST;break;case Xpe.LAST:this.ui.list.focus(Sme.Last),this._itemActivation=Xpe.FIRST;break;default:this.trySelectFirst()}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",this.ui.setComboboxAccessibility(!0),t.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(Sme.First))}}Zme.DEFAULT_ARIA_LABEL=GH(0,"Type to narrow down results.");class Qme extends mG{constructor(e){super(),this.options=e,this.comboboxAccessibility=!1,this.enabled=!0,this.onDidAcceptEmitter=this._register(new EG),this.onDidCustomEmitter=this._register(new EG),this.onDidTriggerButtonEmitter=this._register(new EG),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new EG),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new EG),this.onHide=this.onHideEmitter.event,this.idPrefix=e.idPrefix,this.parentElement=e.container,this.styles=e.styles,this.registerKeyModsListeners()}registerKeyModsListeners(){const e=e=>{this.keyMods.ctrlCmd=e.ctrlKey||e.metaKey,this.keyMods.alt=e.altKey};this._register(Q$(window,RY.KEY_DOWN,e,!0)),this._register(Q$(window,RY.KEY_UP,e,!0)),this._register(Q$(window,RY.MOUSE_DOWN,e,!0))}getUI(){if(this.ui)return this.ui;const e=WY(this.parentElement,$me(".quick-input-widget.show-file-icons"));e.tabIndex=-1,e.style.display="none";const t=NY(e),n=WY(e,$me(".quick-input-titlebar")),i=this._register(new Sle(n));i.domNode.classList.add("quick-input-left-action-bar");const r=WY(n,$me(".quick-input-title")),o=this._register(new Sle(n));o.domNode.classList.add("quick-input-right-action-bar");const s=WY(e,$me(".quick-input-description")),a=WY(e,$me(".quick-input-header")),l=WY(a,$me("input.quick-input-check-all"));l.type="checkbox",this._register(eY(l,RY.CHANGE,(e=>{const t=l.checked;C.setAllVisibleChecked(t)}))),this._register(Q$(l,RY.CLICK,(e=>{(e.x||e.y)&&d.setFocus()})));const c=WY(a,$me(".quick-input-description")),u=WY(a,$me(".quick-input-and-message")),h=WY(u,$me(".quick-input-filter")),d=this._register(new zme(h));d.setAttribute("aria-describedby",`${this.idPrefix}message`);const f=WY(h,$me(".quick-input-visible-count"));f.setAttribute("aria-live","polite"),f.setAttribute("aria-atomic","true");const g=new Ume(f,{countFormat:GH(0,"{0} Results")}),p=WY(h,$me(".quick-input-count"));p.setAttribute("aria-live","polite");const m=new Ume(p,{countFormat:GH(0,"{0} Selected")}),v=WY(a,$me(".quick-input-action")),y=new Kme(v);y.label=GH(0,"OK"),this._register(y.onDidClick((e=>{this.onDidAcceptEmitter.fire()})));const _=WY(a,$me(".quick-input-action")),b=new Kme(_);b.label=GH(0,"Custom"),this._register(b.onDidClick((e=>{this.onDidCustomEmitter.fire()})));const w=WY(u,$me(`#${this.idPrefix}message.quick-input-message`)),C=this._register(new Eme(e,this.idPrefix+"list",this.options));this._register(C.onChangedAllVisibleChecked((e=>{l.checked=e}))),this._register(C.onChangedVisibleCount((e=>{g.setCount(e)}))),this._register(C.onChangedCheckedCount((e=>{m.setCount(e)}))),this._register(C.onLeave((()=>{setTimeout((()=>{d.setFocus(),this.controller instanceof Zme&&this.controller.canSelectMany&&C.clearFocus()}),0)}))),this._register(C.onDidChangeFocus((()=>{this.comboboxAccessibility&&this.getUI().inputBox.setAttribute("aria-activedescendant",this.getUI().list.getActiveDescendant()||"")})));const S=new jme(e);S.getContainer().classList.add("quick-input-progress");const x=BY(e);return this._register(x),this._register(Q$(e,RY.FOCUS,(e=>{this.previousFocusElement=e.relatedTarget instanceof HTMLElement?e.relatedTarget:void 0}),!0)),this._register(x.onDidBlur((()=>{this.getUI().ignoreFocusOut||this.options.ignoreFocusOut()||this.hide($pe.Blur),this.previousFocusElement=void 0}))),this._register(Q$(e,RY.FOCUS,(e=>{d.setFocus()}))),this._register(Q$(e,RY.KEY_DOWN,(t=>{const n=new C$(t);switch(n.keyCode){case 3:PY(t,!0),this.onDidAcceptEmitter.fire();break;case 9:PY(t,!0),this.hide($pe.Gesture);break;case 2:if(!n.altKey&&!n.ctrlKey&&!n.metaKey){const i=[".action-label.codicon"];e.classList.contains("show-checkboxes")?i.push("input"):i.push("input[type=text]"),this.getUI().list.isDisplayed()&&i.push(".monaco-list");const r=e.querySelectorAll(i.join(", "));n.shiftKey&&n.target===r[0]?(PY(t,!0),r[r.length-1].focus()):n.shiftKey||n.target!==r[r.length-1]||(PY(t,!0),r[0].focus())}}}))),this.ui={container:e,styleSheet:t,leftActionBar:i,titleBar:n,title:r,description1:s,description2:c,rightActionBar:o,checkAll:l,filterContainer:h,inputBox:d,visibleCountContainer:f,visibleCount:g,countContainer:p,count:m,okContainer:v,ok:y,message:w,customButtonContainer:_,customButton:b,list:C,progressBar:S,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,isScreenReaderOptimized:()=>this.options.isScreenReaderOptimized(),show:e=>this.show(e),hide:()=>this.hide(),setVisibilities:e=>this.setVisibilities(e),setComboboxAccessibility:e=>this.setComboboxAccessibility(e),setEnabled:e=>this.setEnabled(e),setContextKey:e=>this.options.setContextKey(e)},this.updateStyles(),this.ui}pick(e,t={},n=TG.None){return new Promise(((i,r)=>{let o=e=>{o=i,t.onKeyMods&&t.onKeyMods(s.keyMods),i(e)};if(n.isCancellationRequested)return void o(void 0);const s=this.createQuickPick();let a;const l=[s,s.onDidAccept((()=>{if(s.canSelectMany)o(s.selectedItems.slice()),s.hide();else{const e=s.activeItems[0];e&&(o(e),s.hide())}})),s.onDidChangeActive((e=>{const n=e[0];n&&t.onDidFocus&&t.onDidFocus(n)})),s.onDidChangeSelection((e=>{if(!s.canSelectMany){const t=e[0];t&&(o(t),s.hide())}})),s.onDidTriggerItemButton((e=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton(Object.assign(Object.assign({},e),{removeItem:()=>{const t=s.items.indexOf(e.item);if(-1!==t){const e=s.items.slice(),n=e.splice(t,1),i=s.activeItems.filter((e=>e!==n[0]));s.items=e,i&&(s.activeItems=i)}}})))),s.onDidChangeValue((e=>{!a||e||1===s.activeItems.length&&s.activeItems[0]===a||(s.activeItems=[a])})),n.onCancellationRequested((()=>{s.hide()})),s.onDidHide((()=>{dG(l),o(void 0)}))];s.title=t.title,s.canSelectMany=!!t.canPickMany,s.placeholder=t.placeHolder,s.ignoreFocusOut=!!t.ignoreFocusLost,s.matchOnDescription=!!t.matchOnDescription,s.matchOnDetail=!!t.matchOnDetail,s.matchOnLabel=void 0===t.matchOnLabel||t.matchOnLabel,s.autoFocusOnList=void 0===t.autoFocusOnList||t.autoFocusOnList,s.quickNavigate=t.quickNavigate,s.contextKey=t.contextKey,s.busy=!0,Promise.all([e,t.activeItem]).then((([e,t])=>{a=t,s.busy=!1,s.items=e,s.canSelectMany&&(s.selectedItems=e.filter((e=>"separator"!==e.type&&e.picked))),a&&(s.activeItems=[a])})),s.show(),Promise.resolve(e).then(void 0,(e=>{r(e),s.hide()}))}))}createQuickPick(){const e=this.getUI();return new Zme(e)}show(e){const t=this.getUI();this.onShowEmitter.fire();const n=this.controller;this.controller=e,n&&n.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",t.rightActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(r3.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),zY(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,this.setComboboxAccessibility(!1),t.inputBox.ariaLabel="";const i=this.options.backKeybindingLabel();Yme.tooltip=i?GH(0,"Back ({0})",i):GH(0,"Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus()}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=!e.description||e.inputBox||e.checkAll?"none":"",t.checkAll.style.display=e.checkAll?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.display(!!e.list),t.container.classList[e.checkBox?"add":"remove"]("show-checkboxes"),this.updateLayout()}setComboboxAccessibility(e){if(e!==this.comboboxAccessibility){const t=this.getUI();this.comboboxAccessibility=e,this.comboboxAccessibility?(t.inputBox.setAttribute("role","combobox"),t.inputBox.setAttribute("aria-haspopup","true"),t.inputBox.setAttribute("aria-autocomplete","list"),t.inputBox.setAttribute("aria-activedescendant",t.list.getActiveDescendant()||"")):(t.inputBox.removeAttribute("role"),t.inputBox.removeAttribute("aria-haspopup"),t.inputBox.removeAttribute("aria-autocomplete"),t.inputBox.removeAttribute("aria-activedescendant"))}}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.getAction().enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.getAction().enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){var t;const n=this.controller;if(n){const i=!(null===(t=this.ui)||void 0===t?void 0:t.container.contains(document.activeElement));this.controller=null,this.onHideEmitter.fire(),this.getUI().container.style.display="none",i||(this.previousFocusElement&&this.previousFocusElement.offsetParent?(this.previousFocusElement.focus(),this.previousFocusElement=void 0):this.options.returnFocus()),n.didHide(e)}}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(.62*this.dimension.width,Qme.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&.4*this.dimension.height)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:n,contrastBorder:i,widgetShadow:r}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e?e.toString():"",this.ui.container.style.backgroundColor=t?t.toString():"",this.ui.container.style.color=n?n.toString():"",this.ui.container.style.border=i?`1px solid ${i}`:"",this.ui.container.style.boxShadow=r?`0 0 8px 2px ${r}`:"",this.ui.inputBox.style(this.styles.inputBox),this.ui.count.style(this.styles.countBadge),this.ui.ok.style(this.styles.button),this.ui.customButton.style(this.styles.button),this.ui.progressBar.style(this.styles.progressBar),this.ui.list.style(this.styles.list);const o=[];this.styles.list.pickerGroupBorder&&o.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.list.pickerGroupBorder}; }`),this.styles.list.pickerGroupForeground&&o.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.list.pickerGroupForeground}; }`),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(o.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&o.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&o.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&o.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&o.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&o.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),o.push("}"));const s=o.join("\n");s!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=s)}}}Qme.MAX_WIDTH=600;const Jme=i$("quickInputService");var eve,tve;(tve=eve||(eve={}))[tve.PRESERVE=0]="PRESERVE",tve[tve.LAST=1]="LAST";const nve="workbench.contributions.quickaccess";d3.add(nve,new class{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return 0===e.prefix.length?this.defaultProvider=e:this.providers.push(e),this.providers.sort(((e,t)=>t.prefix.length-e.prefix.length)),gG((()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)}))}getQuickAccessProviders(){return A1([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find((t=>e.startsWith(t.prefix)))||void 0||this.defaultProvider}});var ive=function(e,t){return function(n,i){t(n,i,e)}};let rve=class extends mG{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=d3.as(nve),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,n){var i;const[r,o]=this.getOrInstantiateProvider(e),s=this.visibleQuickAccess,a=null==s?void 0:s.descriptor;if(s&&o&&a===o)return e===o.prefix||(null==n?void 0:n.preserveValue)||(s.picker.value=e),void this.adjustValueSelection(s.picker,o,n);if(o&&!(null==n?void 0:n.preserveValue)){let t;if(s&&a&&a!==o){const e=s.value.substr(a.prefix.length);e&&(t=`${o.prefix}${e}`)}if(!t){const e=null==r?void 0:r.defaultFilterValue;e===eve.LAST?t=this.lastAcceptedPickerValues.get(o):"string"==typeof e&&(t=`${o.prefix}${e}`)}"string"==typeof t&&(e=t)}const l=new pG,c=l.add(this.quickInputService.createQuickPick());let u,h;c.value=e,this.adjustValueSelection(c,o,n),c.placeholder=null==o?void 0:o.placeholder,c.quickNavigate=null==n?void 0:n.quickNavigateConfiguration,c.hideInput=!!c.quickNavigate&&!s,("number"==typeof(null==n?void 0:n.itemActivation)||(null==n?void 0:n.quickNavigateConfiguration))&&(c.itemActivation=null!==(i=null==n?void 0:n.itemActivation)&&void 0!==i?i:Xpe.SECOND),c.contextKey=null==o?void 0:o.contextKey,c.filterValue=e=>e.substring(o?o.prefix.length:0),(null==o?void 0:o.placeholder)&&(c.ariaLabel=null==o?void 0:o.placeholder),t&&(u=new Promise((e=>h=e)),l.add(Moe(c.onWillAccept)((e=>{e.veto(),c.hide()})))),l.add(this.registerPickerListeners(c,r,o,e));const d=l.add(new OG);return r&&l.add(r.provide(c,d.token)),Moe(c.onDidHide)((()=>{0===c.selectedItems.length&&d.cancel(),l.dispose(),null==h||h(c.selectedItems)})),c.show(),t?u:void 0}adjustValueSelection(e,t,n){var i;let r;r=(null==n?void 0:n.preserveValue)?[e.value.length,e.value.length]:[null!==(i=null==t?void 0:t.prefix.length)&&void 0!==i?i:0,e.value.length],e.valueSelection=r}registerPickerListeners(e,t,n,i){const r=new pG,o=this.visibleQuickAccess={picker:e,descriptor:n,value:i};return r.add(gG((()=>{o===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)}))),r.add(e.onDidChangeValue((e=>{const[n]=this.getOrInstantiateProvider(e);n!==t?this.show(e,{preserveValue:!0}):o.value=e}))),n&&r.add(e.onDidAccept((()=>{this.lastAcceptedPickerValues.set(n,e.value)}))),r}getOrInstantiateProvider(e){const t=this.registry.getQuickAccessProvider(e);if(!t)return[void 0,void 0];let n=this.mapProviderToDescriptor.get(t);return n||(n=this.instantiationService.createInstance(t.ctor),this.mapProviderToDescriptor.set(t,n)),[n,t]}};rve=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ive(0,Jme),ive(1,t$)],rve);var ove=function(e,t){return function(n,i){t(n,i,e)}};let sve=class extends K5{constructor(e,t,n,i,r){super(n),this.instantiationService=e,this.contextKeyService=t,this.accessibilityService=i,this.layoutService=r,this.contexts=new Map}get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(rve))),this._quickAccess}createController(e=this.layoutService,t){var n,i;const r={idPrefix:"quickInput_",container:e.container,ignoreFocusOut:()=>!1,isScreenReaderOptimized:()=>this.accessibilityService.isScreenReaderOptimized(),backKeybindingLabel:()=>{},setContextKey:e=>this.setContextKey(e),returnFocus:()=>e.focus(),createList:(e,t,n,i,r)=>this.instantiationService.createInstance(jge,e,t,n,i,r),styles:this.computeStyles()},o=this._register(new Qme(Object.assign(Object.assign({},r),t)));return o.layout(e.dimension,null!==(i=null===(n=e.offset)||void 0===n?void 0:n.top)&&void 0!==i?i:0),this._register(e.onDidLayout((t=>{var n,i;return o.layout(t,null!==(i=null===(n=e.offset)||void 0===n?void 0:n.top)&&void 0!==i?i:0)}))),this._register(o.onShow((()=>this.resetContextKeys()))),this._register(o.onHide((()=>this.resetContextKeys()))),o}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new M5(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),t&&t.get()||(this.resetContextKeys(),t&&t.set(!0))}resetContextKeys(){this.contexts.forEach((e=>{e.get()&&e.reset()}))}pick(e,t={},n=TG.None){return this.controller.pick(e,t,n)}createQuickPick(){return this.controller.createQuickPick()}updateStyles(){this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:Object.assign({},Jhe(this.theme,{quickInputBackground:bte,quickInputForeground:wte,quickInputTitleBackground:Cte,contrastBorder:xee,widgetShadow:Nee})),inputBox:Jhe(this.theme,{inputForeground:Tee,inputBackground:Iee,inputBorder:Mee,inputValidationInfoBackground:Pee,inputValidationInfoForeground:Fee,inputValidationInfoBorder:Bee,inputValidationWarningBackground:Wee,inputValidationWarningForeground:zee,inputValidationWarningBorder:Vee,inputValidationErrorBackground:Uee,inputValidationErrorForeground:Hee,inputValidationErrorBorder:jee}),countBadge:Jhe(this.theme,{badgeBackground:Xee,badgeForeground:Zee,badgeBorder:xee}),button:Jhe(this.theme,{buttonForeground:qee,buttonBackground:$ee,buttonHoverBackground:Yee,buttonBorder:xee}),progressBar:Jhe(this.theme,{progressBarBackground:nte}),keybindingLabel:Jhe(this.theme,{keybindingLabelBackground:Ete,keybindingLabelForeground:kte,keybindingLabelBorder:Lte,keybindingLabelBottomBorder:Dte,keybindingLabelShadow:Nee}),list:Jhe(this.theme,{listBackground:bte,listInactiveFocusForeground:kne,listInactiveSelectionIconForeground:Lne,listInactiveFocusBackground:Dne,listFocusOutline:Eee,listInactiveFocusOutline:Eee,pickerGroupBorder:xte,pickerGroupForeground:Ste})}}};sve=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ove(0,t$),ove(1,A5),ove(2,B5),ove(3,yae),ove(4,ade)],sve);var ave=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},lve=function(e,t){return function(n,i){t(n,i,e)}};let cve=class extends sve{constructor(e,t,n,i,r,o){super(t,n,i,r,o),this.host=void 0;const s=hve.get(e);this.host={_serviceBrand:void 0,get container(){return s.widget.getDomNode()},get dimension(){return e.getLayoutInfo()},get onDidLayout(){return e.onDidLayoutChange},focus:()=>e.focus()}}createController(){return super.createController(this.host)}};cve=ave([lve(1,t$),lve(2,A5),lve(3,B5),lve(4,yae),lve(5,ade)],cve);let uve=class{constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const n=t=this.instantiationService.createInstance(cve,e);this.mapEditorToService.set(e,t),Moe(e.onDidDispose)((()=>{n.dispose(),this.mapEditorToService.delete(e)}))}return t}get quickAccess(){return this.activeService.quickAccess}pick(e,t={},n=TG.None){return this.activeService.pick(e,t,n)}createQuickPick(){return this.activeService.createQuickPick()}};uve=ave([lve(0,t$),lve(1,o$)],uve);class hve{constructor(e){this.editor=e,this.widget=new dve(this.editor)}static get(e){return e.getContribution(hve.ID)}dispose(){this.widget.dispose()}}hve.ID="editor.controller.quickInput";class dve{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return dve.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}var fve;dve.ID="editor.contrib.quickInputWidget",d6(hve.ID,hve),function(e){const t=new vae;class n{constructor(e,t){this._serviceId=e,this._factory=t,this._value=null}get id(){return this._serviceId}get(e){if(!this._value){if(e&&(this._value=e[this._serviceId.toString()]),this._value||(this._value=this._factory(e)),!this._value)throw new Error("Service "+this._serviceId+" is missing!");t.set(this._serviceId,this._value)}return this._value}}e.LazyStaticService=n;let i=[];function r(e,t){let r=new n(e,t);return i.push(r),r}e.init=function(e){let t=new vae;for(const[i,r]of lle)t.set(i,r);for(let i in e)e.hasOwnProperty(i)&&t.set(i$(i),e[i]);i.forEach((n=>t.set(n.id,n.get(e))));let n=new fde(t,!0);return t.set(t$,n),[t,n]},e.instantiationService=r(t$,(()=>new fde(t,!0)));const o=new V4;e.configurationService=r(j3,(()=>o)),e.resourceConfigurationService=r(E1,(()=>new U4(o))),e.resourcePropertiesService=r(k1,(()=>new H4(o))),e.contextService=r(p4,(()=>new G4)),e.labelService=r(pde,(()=>new $4)),e.telemetryService=r(e6,(()=>new j4)),e.dialogService=r(cde,(()=>new P4)),e.notificationService=r(g4,(()=>new F4)),e.markerService=r(ape,(()=>new upe)),e.modeService=r(t0,(e=>new Uce)),e.standaloneThemeService=r(fce,(()=>new Mue)),e.logService=r(K1,(()=>new Q1(new Z1))),e.undoRedoService=r(Hce,(t=>new Gpe(e.dialogService.get(t),e.notificationService.get(t)))),e.modelService=r(iJ,(t=>new cue(e.configurationService.get(t),e.resourcePropertiesService.get(t),e.standaloneThemeService.get(t),e.logService.get(t),e.undoRedoService.get(t)))),e.markerDecorationsService=r(r5,(t=>new Npe(e.modelService.get(t),e.markerService.get(t)))),e.contextKeyService=r(A5,(t=>new Vue(e.configurationService.get(t)))),e.codeEditorService=r(o$,(t=>new Ece(null,e.contextKeyService.get(t),e.standaloneThemeService.get(t)))),e.editorProgressService=r(jle,(()=>new R4)),e.storageService=r(vpe,(()=>new wpe)),e.editorWorkerService=r(e0,(t=>new n2(e.modelService.get(t),e.resourceConfigurationService.get(t),e.logService.get(t))))}(fve||(fve={}));class gve extends mG{constructor(e,t){super();const[n,i]=fve.init(t);this._serviceCollection=n,this._instantiationService=i;const r=this.get(j3),o=this.get(g4),s=this.get(e6),a=this.get(B5),l=this.get(K1),c=this.get(A5);let u=(e,n)=>{let i=null;return t&&(i=t[e.toString()]),i||(i=n()),this._serviceCollection.set(e,i),i};u(yae,(()=>new Tpe(c,r))),u(xge,(()=>new Ege(a)));let h=u(KZ,(()=>new B4(this._instantiationService))),d=u(gce,(()=>this._register(new W4(c,h,s,o,l,e)))),f=u(ade,(()=>new Y4(fve.codeEditorService.get(o$),e)));u(Jme,(()=>new uve(i,fve.codeEditorService.get(o$))));let g=u(Ble,(()=>this._register(new lde(f))));u(Ule,(()=>new Ape)),u(Wle,(()=>{const e=new sde(s,o,g,d,a);return e.configure({blockMouse:!1}),this._register(e)})),u(X5,(()=>new xpe(h))),u(l3,(()=>new q4(fve.modelService.get(iJ))))}get(e){let t=this._serviceCollection.get(e);if(!t)throw new Error("Missing service "+e);return t}set(e,t){this._serviceCollection.set(e,t)}has(e){return this._serviceCollection.has(e)}}function pve(e,t,n){let i=new gve(e,t),r=null;i.has(n0)||(r=new O4(fve.modelService.get()),i.set(n0,r)),i.has(ZZ)||i.set(ZZ,new oQ(i.get(o$),i.get(KZ)));let o=n(i);return r&&r.setEditor(o),o}function mve(e,t,n){return pve(e,n||{},(n=>new Mce(e,t,n,n.get(t$),n.get(o$),n.get(KZ),n.get(A5),n.get(gce),n.get(Ble),n.get(fce),n.get(g4),n.get(j3),n.get(yae),n.get(iJ),n.get(t0))))}function vve(e){return fve.codeEditorService.get().onCodeEditorAdd((t=>{e(t)}))}function yve(e,t,n){return pve(e,n||{},(n=>new Ace(e,t,n,n.get(t$),n.get(A5),n.get(gce),n.get(Ble),n.get(e0),n.get(o$),n.get(fce),n.get(g4),n.get(j3),n.get(Wle),n.get(jle),n.get(Ule))))}function _ve(e,t){return new pQ(e,t)}function bve(e,t,n){return Oce(fve.modelService.get(),fve.modeService.get(),e,t,n)}function wve(e,t){fve.modelService.get().setMode(e,fve.modeService.get().create(t))}function Cve(e,t,n){e&&fve.markerService.get().changeOne(t,e.uri,n)}function Sve(e){return fve.markerService.get().read(e)}function xve(e){return fve.markerService.get().onMarkerChanged(e)}function Eve(e){return fve.modelService.get().getModel(e)}function kve(){return fve.modelService.get().getModels()}function Lve(e){return fve.modelService.get().onModelAdded(e)}function Dve(e){return fve.modelService.get().onModelRemoved(e)}function Nve(e){return fve.modelService.get().onModelModeChanged((t=>{e({model:t.model,oldLanguage:t.oldModeId})}))}function Ive(e){return function(e,t){return new c2(e,t)}(fve.modelService.get(),e)}function Tve(e,t){const n=fve.standaloneThemeService.get();return n.registerEditorContainer(e),J2.colorizeElement(n,fve.modeService.get(),e,t)}function Mve(e,t,n){return fve.standaloneThemeService.get().registerEditorContainer(document.body),J2.colorize(fve.modeService.get(),e,t,n)}function Ave(e,t,n=4){return fve.standaloneThemeService.get().registerEditorContainer(document.body),J2.colorizeModelLine(e,t,n)}function Ove(e,t){fve.modeService.get().triggerMode(t);let n=(i=t,YJ.get(i)||{getInitialState:()=>XJ,tokenize:(e,t,n,r)=>QJ(i,0,n,r)});var i;let r=uX(e),o=[],s=n.getInitialState();for(let a=0,l=r.length;a<l;a++){let e=r[a],t=n.tokenize(e,!0,s,0);o[a]=t.tokens,s=t.endState}return o}function Rve(e,t){fve.standaloneThemeService.get().defineTheme(e,t)}function Pve(e){fve.standaloneThemeService.get().setTheme(e)}function Fve(){L6.INSTANCE.clearCache()}function Bve(e,t){return qZ.registerCommand({id:e,handler:t})}function Wve(e,t){return"boolean"==typeof e?e:t}function zve(e,t){return"string"==typeof e?e:t}function Vve(e,t=!1){t&&(e=e.map((function(e){return e.toLowerCase()})));const n=function(e){const t={};for(const n of e)t[n]=!0;return t}(e);return t?function(e){return void 0!==n[e.toLowerCase()]&&n.hasOwnProperty(e.toLowerCase())}:function(e){return void 0!==n[e]&&n.hasOwnProperty(e)}}function Uve(e,t){t=t.replace(/@@/g,"");let n,i=0;do{n=!1,t=t.replace(/@(\w+)/g,(function(i,r){n=!0;let o="";if("string"==typeof e[r])o=e[r];else{if(!(e[r]&&e[r]instanceof RegExp))throw void 0===e[r]?W2(e,"language definition does not contain attribute '"+r+"', used at: "+t):W2(e,"attribute reference '"+r+"' must be a string, used at: "+t);o=e[r].source}return P2(o)?"":"(?:"+o+")"})),i++}while(n&&i<5);t=t.replace(/\x01/g,"@");let r=(e.ignoreCase?"i":"")+(e.unicode?"u":"");return new RegExp(t,r)}function Hve(e,t,n,i){let r=-1,o=n,s=n.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);s&&(s[3]&&(r=parseInt(s[3]),s[2]&&(r+=100)),o=s[4]);let a,l="~",c=o;if(o&&0!==o.length?/^\w*$/.test(c)?l="==":(s=o.match(/^(@|!@|~|!~|==|!=)(.*)$/),s&&(l=s[1],c=s[2])):(l="!=",c=""),"~"!==l&&"!~"!==l||!/^(\w|\|)*$/.test(c))if("@"===l||"!@"===l){let n=e[c];if(!n)throw W2(e,"the @ match target '"+c+"' is not defined, in rule: "+t);if(!function(e,t){if(!t)return!1;if(!Array.isArray(t))return!1;for(const n of t)if(!e(n))return!1;return!0}((function(e){return"string"==typeof e}),n))throw W2(e,"the @ match target '"+c+"' must be an array of strings, in rule: "+t);let i=Vve(n,e.ignoreCase);a=function(e){return"@"===l?i(e):!i(e)}}else if("~"===l||"!~"===l)if(c.indexOf("$")<0){let t=Uve(e,"^"+c+"$");a=function(e){return"~"===l?t.test(e):!t.test(e)}}else a=function(t,n,i,r){return Uve(e,"^"+z2(e,c,n,i,r)+"$").test(t)};else if(c.indexOf("$")<0){let t=F2(e,c);a=function(e){return"=="===l?e===t:e!==t}}else{let t=F2(e,c);a=function(n,i,r,o,s){let a=z2(e,t,i,r,o);return"=="===l?n===a:n!==a}}else{let t=Vve(c.split("|"),e.ignoreCase);a=function(e){return"~"===l?t(e):!t(e)}}return-1===r?{name:n,value:i,test:function(e,t,n,i){return a(e,e,t,n,i)}}:{name:n,value:i,test:function(e,t,n,i){let o=function(e,t,n,i){if(i<0)return e;if(i<t.length)return t[i];if(i>=100){i-=100;let e=n.split(".");if(e.unshift(n),i<e.length)return e[i]}return null}(e,t,n,r);return a(o||"",e,t,n,i)}}}function jve(e,t,n){if(n){if("string"==typeof n)return n;if(n.token||""===n.token){if("string"!=typeof n.token)throw W2(e,"a 'token' attribute must be of type string, in rule: "+t);{let i={token:n.token};if(n.token.indexOf("$")>=0&&(i.tokenSubst=!0),"string"==typeof n.bracket)if("@open"===n.bracket)i.bracket=1;else{if("@close"!==n.bracket)throw W2(e,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+t);i.bracket=-1}if(n.next){if("string"!=typeof n.next)throw W2(e,"the next state must be a string value in rule: "+t);{let r=n.next;if(!/^(@pop|@push|@popall)$/.test(r)&&("@"===r[0]&&(r=r.substr(1)),r.indexOf("$")<0&&!function(e,t){let n=t;for(;n&&n.length>0;){if(e.stateNames[n])return!0;const t=n.lastIndexOf(".");n=t<0?null:n.substr(0,t)}return!1}(e,z2(e,r,"",[],""))))throw W2(e,"the next state '"+n.next+"' is not defined in rule: "+t);i.next=r}}return"number"==typeof n.goBack&&(i.goBack=n.goBack),"string"==typeof n.switchTo&&(i.switchTo=n.switchTo),"string"==typeof n.log&&(i.log=n.log),"string"==typeof n.nextEmbedded&&(i.nextEmbedded=n.nextEmbedded,e.usesEmbedded=!0),i}}if(Array.isArray(n)){let i=[];for(let r=0,o=n.length;r<o;r++)i[r]=jve(e,t,n[r]);return{group:i}}if(n.cases){let i=[];for(let o in n.cases)if(n.cases.hasOwnProperty(o)){const r=jve(e,t,n.cases[o]);"@default"===o||"@"===o||""===o?i.push({test:void 0,value:r,name:o}):"@eos"===o?i.push({test:function(e,t,n,i){return i},value:r,name:o}):i.push(Hve(e,t,o,r))}const r=e.defaultToken;return{test:function(e,t,n,o){for(const r of i){if(!r.test||r.test(e,t,n,o))return r.value}return r}}}throw W2(e,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+t)}return{token:""}}class Gve{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let n;if("string"==typeof t)n=t;else{if(!(t instanceof RegExp))throw W2(e,"rules must start with a match string or regular expression: "+this.name);n=t.source}this.matchOnlyAtLineStart=n.length>0&&"^"===n[0],this.name=this.name+": "+n,this.regex=Uve(e,"^(?:"+(this.matchOnlyAtLineStart?n.substr(1):n)+")")}setAction(e,t){this.action=jve(e,this.name,t)}}function Kve(e){Fce.registerLanguage(e)}function qve(){let e=[];return e=e.concat(Fce.getLanguages()),e}function $ve(e){let t=fve.modeService.get().getLanguageIdentifier(e);return t?t.id:0}function Yve(e,t){let n=fve.modeService.get().onDidCreateMode((i=>{i.getId()===e&&(n.dispose(),t())}));return n}function Xve(e,t){let n=fve.modeService.get().getLanguageIdentifier(e);if(!n)throw new Error(`Cannot set configuration for unknown language ${e}`);return q0.register(n,t,100)}class Zve{constructor(e,t){this._languageIdentifier=e,this._actual=t}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,n,i){if("function"==typeof this._actual.tokenize)return Qve.adaptTokenize(this._languageIdentifier.language,this._actual,e,n,i);throw new Error("Not supported!")}tokenize2(e,t,n){let i=this._actual.tokenizeEncoded(e,n);return new RK(i.tokens,i.endState)}}class Qve{constructor(e,t,n){this._standaloneThemeService=e,this._languageIdentifier=t,this._actual=n}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t,n){let i=[],r=0;for(let o=0,s=e.length;o<s;o++){const s=e[o];let a=s.startIndex;0===o?a=0:a<r&&(a=r),i[o]=new AK(a+n,s.scopes,t),r=a}return i}static adaptTokenize(e,t,n,i,r){let o,s=t.tokenize(n,i),a=Qve._toClassicTokens(s.tokens,e,r);return o=s.endState.equals(i)?i:s.endState,new OK(a,o)}tokenize(e,t,n,i){return Qve.adaptTokenize(this._languageIdentifier.language,this._actual,e,n,i)}_toBinaryTokens(e,t){const n=this._languageIdentifier.id,i=this._standaloneThemeService.getColorTheme().tokenTheme;let r=[],o=0,s=0;for(let l=0,c=e.length;l<c;l++){const a=e[l],c=i.match(n,a.scopes);if(o>0&&r[o-1]===c)continue;let u=a.startIndex;0===l?u=0:u<s&&(u=s),r[o++]=u+t,r[o++]=c,s=u}let a=new Uint32Array(o);for(let l=0;l<o;l++)a[l]=r[l];return a}tokenize2(e,t,n,i){let r,o=this._actual.tokenize(e,n),s=this._toBinaryTokens(o.tokens,i);return r=o.endState.equals(n)?n:o.endState,new RK(s,r)}}function Jve(e){return e&&"function"==typeof e.then}function eye(e){if(e){const t=[null];for(let n=1,i=e.length;n<i;n++)t[n]=Q8.fromHex(e[n]);fve.standaloneThemeService.get().setColorMapOverride(t)}else fve.standaloneThemeService.get().setColorMapOverride(null)}function tye(e,t){let n=fve.modeService.get().getLanguageIdentifier(e);if(!n)throw new Error(`Cannot set tokens provider for unknown language ${e}`);const i=e=>function(e){return"tokenizeEncoded"in e}(e)?new Zve(n,e):new Qve(fve.standaloneThemeService.get(),n,e);return Jve(t)?YJ.registerPromise(e,t.then((e=>i(e)))):YJ.register(e,i(t))}function nye(e,t){const n=t=>{return n=fve.modeService.get(),i=fve.standaloneThemeService.get(),r=e,o=function(e,t){if(!t||"object"!=typeof t)throw new Error("Monarch: expecting a language definition object");let n={};n.languageId=e,n.includeLF=Wve(t.includeLF,!1),n.noThrow=!1,n.maxStack=100,n.start="string"==typeof t.start?t.start:null,n.ignoreCase=Wve(t.ignoreCase,!1),n.unicode=Wve(t.unicode,!1),n.tokenPostfix=zve(t.tokenPostfix,"."+n.languageId),n.defaultToken=zve(t.defaultToken,"source"),n.usesEmbedded=!1;let i=t;function r(e,o,s){for(const a of s){let s=a.include;if(s){if("string"!=typeof s)throw W2(n,"an 'include' attribute must be a string at: "+e);if("@"===s[0]&&(s=s.substr(1)),!t.tokenizer[s])throw W2(n,"include target '"+s+"' is not defined at: "+e);r(e+"."+s,o,t.tokenizer[s])}else{const t=new Gve(e);if(Array.isArray(a)&&a.length>=1&&a.length<=3)if(t.setRegex(i,a[0]),a.length>=3)if("string"==typeof a[1])t.setAction(i,{token:a[1],next:a[2]});else{if("object"!=typeof a[1])throw W2(n,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+e);{const e=a[1];e.next=a[2],t.setAction(i,e)}}else t.setAction(i,a[1]);else{if(!a.regex)throw W2(n,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+e);a.name&&"string"==typeof a.name&&(t.name=a.name),a.matchOnlyAtStart&&(t.matchOnlyAtLineStart=Wve(a.matchOnlyAtLineStart,!1)),t.setRegex(i,a.regex),t.setAction(i,a.action)}o.push(t)}}}if(i.languageId=e,i.includeLF=n.includeLF,i.ignoreCase=n.ignoreCase,i.unicode=n.unicode,i.noThrow=n.noThrow,i.usesEmbedded=n.usesEmbedded,i.stateNames=t.tokenizer,i.defaultToken=n.defaultToken,!t.tokenizer||"object"!=typeof t.tokenizer)throw W2(n,"a language definition must define the 'tokenizer' attribute as an object");n.tokenizer=[];for(let s in t.tokenizer)if(t.tokenizer.hasOwnProperty(s)){n.start||(n.start=s);const e=t.tokenizer[s];n.tokenizer[s]=new Array,r("tokenizer."+s,n.tokenizer[s],e)}if(n.usesEmbedded=i.usesEmbedded,t.brackets){if(!Array.isArray(t.brackets))throw W2(n,"the 'brackets' attribute must be defined as an array")}else t.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];let o=[];for(let s of t.brackets){let e=s;if(e&&Array.isArray(e)&&3===e.length&&(e={token:e[2],open:e[0],close:e[1]}),e.open===e.close)throw W2(n,"open and close brackets in a 'brackets' attribute must be different: "+e.open+"\n hint: use the 'bracket' attribute if matching on equal brackets is required.");if("string"!=typeof e.open||"string"!=typeof e.token||"string"!=typeof e.close)throw W2(n,"every element in the 'brackets' array must be a '{open,close,token}' object or array");o.push({token:e.token+n.tokenPostfix,open:F2(n,e.open),close:F2(n,e.close)})}return n.brackets=o,n.noThrow=!0,n}(e,t),new Y2(n,i,r,o);var n,i,r,o};return Jve(t)?YJ.registerPromise(e,t.then((e=>n(e)))):YJ.register(e,n(t))}function iye(e,t){return xJ.register(e,t)}function rye(e,t){return EJ.register(e,t)}function oye(e,t){return DJ.register(e,t)}function sye(e,t){return NJ.register(e,{provideHover:(e,n,i)=>{let r=e.getWordAtPosition(n);return Promise.resolve(t.provideHover(e,n,i)).then((e=>{if(e)return!e.range&&r&&(e.range=new TK(n.lineNumber,r.startColumn,n.lineNumber,r.endColumn)),e.range||(e.range=new TK(n.lineNumber,n.column,n.lineNumber,n.column)),e}))}})}function aye(e,t){return IJ.register(e,t)}function lye(e,t){return TJ.register(e,t)}function cye(e,t){return MJ.register(e,t)}function uye(e,t){return AJ.register(e,t)}function hye(e,t){return RJ.register(e,t)}function dye(e,t){return PJ.register(e,t)}function fye(e,t){return FJ.register(e,t)}function gye(e,t){return WJ.register(e,{provideCodeActions:(e,n,i,r)=>{let o=fve.markerService.get().read({resource:e.uri}).filter((e=>TK.areIntersectingOrTouching(e,n)));return t.provideCodeActions(e,n,{markers:o,only:i.only},r)}})}function pye(e,t){return zJ.register(e,t)}function mye(e,t){return VJ.register(e,t)}function vye(e,t){return UJ.register(e,t)}function yye(e,t){return HJ.register(e,t)}function _ye(e,t){return kJ.register(e,t)}function bye(e,t){return jJ.register(e,t)}function wye(e,t){return KJ.register(e,t)}function Cye(e,t){return OJ.register(e,t)}function Sye(e,t){return GJ.register(e,t)}function xye(e,t){return qJ.register(e,t)}function Eye(e,t){return $J.register(e,t)}function kye(e,t){return LJ.register(e,t)}function Lye(e,t){return BJ.register(e,t)}class Dye{static _handleEolEdits(e,t){let n,i=[];for(let r of t)"number"==typeof r.eol&&(n=r.eol),r.range&&"string"==typeof r.text&&i.push(r);return"number"==typeof n&&e.hasModel()&&e.getModel().pushEOL(n),i}static _isFullModelReplaceEdit(e,t){if(!e.hasModel())return!1;const n=e.getModel(),i=n.validateRange(t.range);return n.getFullModelRange().equalsRange(i)}static execute(e,t,n){n&&e.pushUndoStop();const i=Dye._handleEolEdits(e,t);1===i.length&&Dye._isFullModelReplaceEdit(e,i[0])?e.executeEdits("formatEditsCommand",i.map((e=>H3.replace(TK.lift(e.range),e.text)))):e.executeEdits("formatEditsCommand",i.map((e=>H3.replaceMove(TK.lift(e.range),e.text)))),n&&e.pushUndoStop()}}class Nye{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return"string"==typeof e?e.toLowerCase():e._lower}}var Iye,Tye=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function Mye(e){if(!(e=e.filter((e=>e.range))).length)return;let{range:t}=e[0];for(let r=1;r<e.length;r++)t=TK.plusRange(t,e[r].range);const{startLineNumber:n,endLineNumber:i}=t;n===i?1===e.length?t5(GH(0,"Made 1 formatting edit on line {0}",n)):t5(GH(0,"Made {0} formatting edits on line {1}",e.length,n)):1===e.length?t5(GH(0,"Made 1 formatting edit between lines {0} and {1}",n,i)):t5(GH(0,"Made {0} formatting edits between lines {1} and {2}",e.length,n,i))}function Aye(e){const t=[],n=new Set,i=zJ.ordered(e);for(const o of i)t.push(o),o.extensionId&&n.add(Nye.toKey(o.extensionId));const r=VJ.ordered(e);for(const o of r){if(o.extensionId){if(n.has(Nye.toKey(o.extensionId)))continue;n.add(Nye.toKey(o.extensionId))}t.push({displayName:o.displayName,extensionId:o.extensionId,provideDocumentFormattingEdits:(e,t,n)=>o.provideDocumentRangeFormattingEdits(e,e.getFullModelRange(),t,n)})}return t}class Oye{static setFormatterSelector(e){return{dispose:Oye._selectors.unshift(e)}}static select(e,t,n){return Tye(this,void 0,void 0,(function*(){if(0===e.length)return;const i=lG.first(Oye._selectors);return i?yield i(e,t,n):void 0}))}}function Rye(e,t,n,i,r,o){return Tye(this,void 0,void 0,(function*(){const s=e.get(t$),a=o3(t)?t.getModel():t,l=VJ.ordered(a),c=yield Oye.select(l,a,i);c&&(r.report(c),yield s.invokeFunction(Pye,c,t,n,o))}))}function Pye(e,t,n,i,r){return Tye(this,void 0,void 0,(function*(){const o=e.get(e0);let s,a;o3(n)?(s=n.getModel(),a=new gle(n,5,void 0,r)):(s=n,a=new ple(n,r));let l=[],c=0;for(let e of j1(i).sort(TK.compareRangesUsingStarts))c>0&&TK.areIntersectingOrTouching(l[c-1],e)?l[c-1]=TK.fromPositions(l[c-1].getStartPosition(),e.getEndPosition()):c=l.push(e);const u=e=>Tye(this,void 0,void 0,(function*(){return(yield t.provideDocumentRangeFormattingEdits(s,e,s.getFormattingOptions(),a.token))||[]})),h=(e,t)=>{if(!e.length||!t.length)return!1;const n=e.reduce(((e,t)=>TK.plusRange(e,t.range)),e[0].range);if(!t.some((e=>TK.intersectRanges(n,e.range))))return!1;for(let i of e)for(let e of t)if(TK.intersectRanges(i.range,e.range))return!0;return!1},d=[],f=[];try{for(let e of l){if(a.token.isCancellationRequested)return!0;f.push(yield u(e))}for(let e=0;e<l.length;++e)for(let t=e+1;t<l.length;++t){if(a.token.isCancellationRequested)return!0;if(h(f[e],f[t])){const n=TK.plusRange(l[e],l[t]),i=yield u(n);l.splice(t,1),l.splice(e,1),l.push(n),f.splice(t,1),f.splice(e,1),f.push(i),e=0,t=0}}for(let e of f){if(a.token.isCancellationRequested)return!0;const t=yield o.computeMoreMinimalEdits(s.uri,e);t&&d.push(...t)}}finally{a.dispose()}if(0===d.length)return!1;if(o3(n))Dye.execute(n,d,!0),Mye(d),n.revealPositionInCenterIfOutsideViewport(n.getPosition(),1);else{const[{range:e}]=d,t=new MK(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);s.pushEditOperations([t],d.map((e=>({text:e.text,range:TK.lift(e.range),forceMoveMarkers:!0}))),(e=>{for(const{range:n}of e)if(TK.areIntersectingOrTouching(n,t))return[new MK(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn)];return null}))}return!0}))}function Fye(e,t,n,i,r){return Tye(this,void 0,void 0,(function*(){const o=e.get(t$),s=o3(t)?t.getModel():t,a=Aye(s),l=yield Oye.select(a,s,n);l&&(i.report(l),yield o.invokeFunction(Bye,l,t,n,r))}))}function Bye(e,t,n,i,r){return Tye(this,void 0,void 0,(function*(){const o=e.get(e0);let s,a,l;o3(n)?(s=n.getModel(),a=new gle(n,5,void 0,r)):(s=n,a=new ple(n,r));try{const e=yield t.provideDocumentFormattingEdits(s,s.getFormattingOptions(),a.token);if(l=yield o.computeMoreMinimalEdits(s.uri,e),a.token.isCancellationRequested)return!0}finally{a.dispose()}if(!l||0===l.length)return!1;if(o3(n))Dye.execute(n,l,2!==i),2!==i&&(Mye(l),n.revealPositionInCenterIfOutsideViewport(n.getPosition(),1));else{const[{range:e}]=l,t=new MK(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);s.pushEditOperations([t],l.map((e=>({text:e.text,range:TK.lift(e.range),forceMoveMarkers:!0}))),(e=>{for(const{range:n}of e)if(TK.areIntersectingOrTouching(n,t))return[new MK(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn)];return null}))}return!0}))}function Wye(e,t,n,i,r){const o=UJ.ordered(t);return 0===o.length||o[0].autoFormatTriggerCharacters.indexOf(i)<0?Promise.resolve(void 0):Promise.resolve(o[0].provideOnTypeFormattingEdits(t,n,i,r,TG.None)).catch(iG).then((n=>e.computeMoreMinimalEdits(t.uri,n)))}Oye._selectors=new bG,qZ.registerCommand("_executeFormatRangeProvider",(function(e,...t){const[n,i,r]=t;WZ(_K.isUri(n)),WZ(TK.isIRange(i));const o=e.get(iJ).getModel(n);if(!o)throw aG("resource");return function(e,t,n,i,r){return Tye(this,void 0,void 0,(function*(){const o=VJ.ordered(t);for(const s of o){let o=yield Promise.resolve(s.provideDocumentRangeFormattingEdits(t,n,i,r)).catch(iG);if(R1(o))return yield e.computeMoreMinimalEdits(t.uri,o)}}))}(e.get(e0),o,TK.lift(i),r,TG.None)})),qZ.registerCommand("_executeFormatDocumentProvider",(function(e,...t){const[n,i]=t;WZ(_K.isUri(n));const r=e.get(iJ).getModel(n);if(!r)throw aG("resource");return function(e,t,n,i){return Tye(this,void 0,void 0,(function*(){const r=Aye(t);for(const o of r){let r=yield Promise.resolve(o.provideDocumentFormattingEdits(t,n,i)).catch(iG);if(R1(r))return yield e.computeMoreMinimalEdits(t.uri,r)}}))}(e.get(e0),r,i,TG.None)})),qZ.registerCommand("_executeFormatOnTypeProvider",(function(e,...t){const[n,i,r,o]=t;WZ(_K.isUri(n)),WZ(IK.isIPosition(i)),WZ("string"==typeof r);const s=e.get(iJ).getModel(n);if(!s)throw aG("resource");return Wye(e.get(e0),s,IK.lift(i),r,o)})),eG.wrappingIndent.defaultValue=0,eG.glyphMargin.defaultValue=!1,eG.autoIndent.defaultValue=3,eG.overviewRulerLanes.defaultValue=2,Oye.setFormatterSelector(((e,t,n)=>Promise.resolve(e[0])));const zye=Qq();zye.editor={create:mve,onDidCreateEditor:vve,createDiffEditor:yve,createDiffNavigator:_ve,createModel:bve,setModelLanguage:wve,setModelMarkers:Cve,getModelMarkers:Sve,onDidChangeMarkers:xve,getModels:kve,getModel:Eve,onDidCreateModel:Lve,onWillDisposeModel:Dve,onDidChangeModelLanguage:Nve,createWebWorker:Ive,colorizeElement:Tve,colorize:Mve,colorizeModelLine:Ave,tokenize:Ove,defineTheme:Rve,setTheme:Pve,remeasureFonts:Fve,registerCommand:Bve,AccessibilitySupport:PK,ContentWidgetPositionPreference:KK,CursorChangeReason:$K,DefaultEndOfLine:XK,EditorAutoIndentStrategy:eq,EditorOption:nq,EndOfLinePreference:rq,EndOfLineSequence:sq,MinimapPosition:bq,MouseTargetType:Cq,OverlayWidgetPositionPreference:xq,OverviewRulerLane:kq,RenderLineNumbersType:Dq,RenderMinimap:Iq,ScrollbarVisibility:Oq,ScrollType:Mq,TextEditorCursorBlinkingStyle:jq,TextEditorCursorStyle:Kq,TrackedRangeStickiness:qq,WrappingIndent:Yq,ConfigurationChangedEvent:xj,BareFontInfo:yQ,FontInfo:_Q,TextModelResolvedOptions:SQ,FindMatch:xQ,EditorType:bQ,EditorOptions:eG},zye.languages={register:Kve,getLanguages:qve,onLanguage:Yve,getEncodedLanguageId:$ve,setLanguageConfiguration:Xve,setColorMap:eye,setTokensProvider:tye,setMonarchTokensProvider:nye,registerReferenceProvider:iye,registerRenameProvider:rye,registerCompletionItemProvider:_ye,registerSignatureHelpProvider:oye,registerHoverProvider:sye,registerDocumentSymbolProvider:aye,registerDocumentHighlightProvider:lye,registerLinkedEditingRangeProvider:cye,registerDefinitionProvider:uye,registerImplementationProvider:hye,registerTypeDefinitionProvider:dye,registerCodeLensProvider:fye,registerCodeActionProvider:gye,registerDocumentFormattingEditProvider:pye,registerDocumentRangeFormattingEditProvider:mye,registerOnTypeFormattingEditProvider:vye,registerLinkProvider:yye,registerColorProvider:bye,registerFoldingRangeProvider:wye,registerDeclarationProvider:Cye,registerSelectionRangeProvider:Sye,registerDocumentSemanticTokensProvider:xye,registerDocumentRangeSemanticTokensProvider:Eye,registerInlineCompletionsProvider:kye,registerInlayHintsProvider:Lye,DocumentHighlightKind:QK,CompletionItemKind:zK,CompletionItemTag:UK,CompletionItemInsertTextRule:BK,SymbolKind:zq,SymbolTag:Uq,IndentAction:lq,CompletionTriggerKind:jK,SignatureHelpTriggerKind:Bq,InlayHintKind:uq,InlineCompletionTriggerKind:dq,FoldingRangeKind:SJ};const Vye=zye.CancellationTokenSource,Uye=zye.Emitter,Hye=zye.KeyCode,jye=zye.KeyMod,Gye=zye.Position,Kye=zye.Range,qye=zye.Selection,$ye=zye.SelectionDirection,Yye=zye.MarkerSeverity,Xye=zye.MarkerTag,Zye=zye.Uri,Qye=zye.Token,Jye=zye.editor,e_e=zye.languages;((null===(Iye=nj.MonacoEnvironment)||void 0===Iye?void 0:Iye.globalAPI)||"function"==typeof define&&define.amd)&&(self.monaco=zye),void 0!==self.require&&"function"==typeof self.require.config&&self.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});var t_e,n_e,i_e,r_e,o_e,s_e,a_e,l_e,c_e,u_e;(n_e=t_e||(t_e={}))[n_e.None=0]="None",n_e[n_e.CommonJS=1]="CommonJS",n_e[n_e.AMD=2]="AMD",n_e[n_e.UMD=3]="UMD",n_e[n_e.System=4]="System",n_e[n_e.ES2015=5]="ES2015",n_e[n_e.ESNext=99]="ESNext",(r_e=i_e||(i_e={}))[r_e.None=0]="None",r_e[r_e.Preserve=1]="Preserve",r_e[r_e.React=2]="React",r_e[r_e.ReactNative=3]="ReactNative",r_e[r_e.ReactJSX=4]="ReactJSX",r_e[r_e.ReactJSXDev=5]="ReactJSXDev",(s_e=o_e||(o_e={}))[s_e.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",s_e[s_e.LineFeed=1]="LineFeed",(l_e=a_e||(a_e={}))[l_e.ES3=0]="ES3",l_e[l_e.ES5=1]="ES5",l_e[l_e.ES2015=2]="ES2015",l_e[l_e.ES2016=3]="ES2016",l_e[l_e.ES2017=4]="ES2017",l_e[l_e.ES2018=5]="ES2018",l_e[l_e.ES2019=6]="ES2019",l_e[l_e.ES2020=7]="ES2020",l_e[l_e.ESNext=99]="ESNext",l_e[l_e.JSON=100]="JSON",l_e[l_e.Latest=99]="Latest",(u_e=c_e||(c_e={}))[u_e.Classic=1]="Classic",u_e[u_e.NodeJs=2]="NodeJs";var h_e=function(){function e(e,t,n){this._onDidChange=new Uye,this._onDidExtraLibsChange=new Uye,this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(e),this.setDiagnosticsOptions(t),this.setWorkerOptions(n),this._onDidExtraLibsChangeTimeout=-1}return Object.defineProperty(e.prototype,"onDidChange",{get:function(){return this._onDidChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDidExtraLibsChange",{get:function(){return this._onDidExtraLibsChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"workerOptions",{get:function(){return this._workerOptions},enumerable:!1,configurable:!0}),e.prototype.getExtraLibs=function(){return this._extraLibs},e.prototype.addExtraLib=function(e,t){var n,i=this;if(n=void 0===t?"ts:extralib-"+Math.random().toString(36).substring(2,15):t,this._extraLibs[n]&&this._extraLibs[n].content===e)return{dispose:function(){}};var r=1;return this._removedExtraLibs[n]&&(r=this._removedExtraLibs[n]+1),this._extraLibs[n]&&(r=this._extraLibs[n].version+1),this._extraLibs[n]={content:e,version:r},this._fireOnDidExtraLibsChangeSoon(),{dispose:function(){var e=i._extraLibs[n];e&&e.version===r&&(delete i._extraLibs[n],i._removedExtraLibs[n]=r,i._fireOnDidExtraLibsChangeSoon())}}},e.prototype.setExtraLibs=function(e){for(var t in this._extraLibs)this._removedExtraLibs[t]=this._extraLibs[t].version;if(this._extraLibs=Object.create(null),e&&e.length>0)for(var n=0,i=e;n<i.length;n++){var r=i[n],o=(t=r.filePath||"ts:extralib-"+Math.random().toString(36).substring(2,15),r.content),s=1;this._removedExtraLibs[t]&&(s=this._removedExtraLibs[t]+1),this._extraLibs[t]={content:o,version:s}}this._fireOnDidExtraLibsChangeSoon()},e.prototype._fireOnDidExtraLibsChangeSoon=function(){var e=this;-1===this._onDidExtraLibsChangeTimeout&&(this._onDidExtraLibsChangeTimeout=setTimeout((function(){e._onDidExtraLibsChangeTimeout=-1,e._onDidExtraLibsChange.fire(void 0)}),0))},e.prototype.getCompilerOptions=function(){return this._compilerOptions},e.prototype.setCompilerOptions=function(e){this._compilerOptions=e||Object.create(null),this._onDidChange.fire(void 0)},e.prototype.getDiagnosticsOptions=function(){return this._diagnosticsOptions},e.prototype.setDiagnosticsOptions=function(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(void 0)},e.prototype.setWorkerOptions=function(e){this._workerOptions=e||Object.create(null),this._onDidChange.fire(void 0)},e.prototype.setMaximumWorkerIdleTime=function(e){},e.prototype.setEagerModelSync=function(e){this._eagerModelSync=e},e.prototype.getEagerModelSync=function(){return this._eagerModelSync},e}(),d_e=new h_e({allowNonTsExtensions:!0,target:a_e.Latest},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{}),f_e=new h_e({allowNonTsExtensions:!0,allowJs:!0,target:a_e.Latest},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{});function g_e(){return import("./tsMode.f13cf3b2.js")}e_e.typescript={ModuleKind:t_e,JsxEmit:i_e,NewLineKind:o_e,ScriptTarget:a_e,ModuleResolutionKind:c_e,typescriptVersion:"4.3.2",typescriptDefaults:d_e,javascriptDefaults:f_e,getTypeScriptWorker:function(){return g_e().then((function(e){return e.getTypeScriptWorker()}))},getJavaScriptWorker:function(){return g_e().then((function(e){return e.getJavaScriptWorker()}))}},e_e.onLanguage("typescript",(function(){return g_e().then((function(e){return e.setupTypeScript(d_e)}))})),e_e.onLanguage("javascript",(function(){return g_e().then((function(e){return e.setupJavaScript(f_e)}))}));var p_e=function(){function e(e,t,n){this._onDidChange=new Uye,this._languageId=e,this.setOptions(t),this.setModeConfiguration(n)}return Object.defineProperty(e.prototype,"onDidChange",{get:function(){return this._onDidChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modeConfiguration",{get:function(){return this._modeConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnosticsOptions",{get:function(){return this.options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),e.prototype.setOptions=function(e){this._options=e||Object.create(null),this._onDidChange.fire(this)},e.prototype.setDiagnosticsOptions=function(e){this.setOptions(e)},e.prototype.setModeConfiguration=function(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)},e}(),m_e={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"},data:{useDefaultDataProvider:!0}},v_e={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},y_e=new p_e("css",m_e,v_e),__e=new p_e("scss",m_e,v_e),b_e=new p_e("less",m_e,v_e);function w_e(){return import("./cssMode.d272c311.js")}e_e.css={cssDefaults:y_e,lessDefaults:b_e,scssDefaults:__e},e_e.onLanguage("less",(function(){w_e().then((function(e){return e.setupMode(b_e)}))})),e_e.onLanguage("scss",(function(){w_e().then((function(e){return e.setupMode(__e)}))})),e_e.onLanguage("css",(function(){w_e().then((function(e){return e.setupMode(y_e)}))}));var C_e=new(function(){function e(e,t,n){this._onDidChange=new Uye,this._languageId=e,this.setDiagnosticsOptions(t),this.setModeConfiguration(n)}return Object.defineProperty(e.prototype,"onDidChange",{get:function(){return this._onDidChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modeConfiguration",{get:function(){return this._modeConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnosticsOptions",{get:function(){return this._diagnosticsOptions},enumerable:!1,configurable:!0}),e.prototype.setDiagnosticsOptions=function(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)},e.prototype.setModeConfiguration=function(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)},e}())("json",{validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning"},{documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0});e_e.json={jsonDefaults:C_e},e_e.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]}),e_e.onLanguage("json",(function(){import("./jsonMode.de9ecdfb.js").then((function(e){return e.setupMode(C_e)}))}));var S_e=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},x_e=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(zWe){o=[6,zWe],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},E_e=function(){function e(e,t,n){this._onDidChange=new Uye,this._languageId=e,this.setOptions(t),this.setModeConfiguration(n)}return Object.defineProperty(e.prototype,"onDidChange",{get:function(){return this._onDidChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modeConfiguration",{get:function(){return this._modeConfiguration},enumerable:!1,configurable:!0}),e.prototype.setOptions=function(e){this._options=e||Object.create(null),this._onDidChange.fire(this)},e.prototype.setModeConfiguration=function(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)},e}(),k_e={format:{tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:null,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},suggest:{},data:{useDefaultDataProvider:!0}};function L_e(e){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:e===D_e,documentFormattingEdits:e===D_e,documentRangeFormattingEdits:e===D_e}}var D_e="html",N_e=R_e(D_e,k_e,L_e(D_e)),I_e=N_e.defaults,T_e=R_e("handlebars",k_e,L_e("handlebars")),M_e=T_e.defaults,A_e=R_e("razor",k_e,L_e("razor")),O_e=A_e.defaults;function R_e(e,t,n){var i=this;void 0===t&&(t=k_e),void 0===n&&(n=L_e(e));var r,o=new E_e(e,t,n),s=e_e.onLanguage(e,(function(){return S_e(i,void 0,void 0,(function(){return x_e(this,(function(e){switch(e.label){case 0:return[4,import("./htmlMode.36e07090.js")];case 1:return r=e.sent().setupMode(o),[2]}}))}))}));return{defaults:o,dispose:function(){s.dispose(),null==r||r.dispose(),r=void 0}}}e_e.html={htmlDefaults:I_e,razorDefaults:O_e,handlebarDefaults:M_e,htmlLanguageService:N_e,handlebarLanguageService:T_e,razorLanguageService:A_e,registerHTMLLanguageService:R_e};var P_e={},F_e={},B_e=function(){function e(e){var t=this;this._languageId=e,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise((function(e,n){t._lazyLoadPromiseResolve=e,t._lazyLoadPromiseReject=n}))}return e.getOrCreate=function(t){return F_e[t]||(F_e[t]=new e(t)),F_e[t]},e.prototype.whenLoaded=function(){return this._lazyLoadPromise},e.prototype.load=function(){var e=this;return this._loadingTriggered||(this._loadingTriggered=!0,P_e[this._languageId].loader().then((function(t){return e._lazyLoadPromiseResolve(t)}),(function(t){return e._lazyLoadPromiseReject(t)}))),this._lazyLoadPromise},e}();function W_e(e){var t=e.id;P_e[t]=e,e_e.register(e);var n=B_e.getOrCreate(t);e_e.setMonarchTokensProvider(t,n.whenLoaded().then((function(e){return e.language}))),e_e.onLanguage(t,(function(){n.load().then((function(e){e_e.setLanguageConfiguration(t,e.conf)}))}))}W_e({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:function(){return import("./abap.62219aee.js")}}),W_e({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:function(){return import("./apex.114e4f26.js")}}),W_e({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:function(){return import("./azcli.39cf3971.js")}}),W_e({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:function(){return import("./bat.10d3c5a9.js")}}),W_e({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:function(){return import("./bicep.8b08c8a3.js")}}),W_e({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:function(){return import("./cameligo.57b123f2.js")}}),W_e({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:function(){return import("./clojure.a2cfc2f5.js")}}),W_e({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:function(){return import("./coffee.3929bdcd.js")}}),W_e({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:function(){return import("./cpp.d1baa157.js")}}),W_e({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:function(){return import("./cpp.d1baa157.js")}}),W_e({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:function(){return import("./csharp.559a8868.js")}}),W_e({id:"csp",extensions:[],aliases:["CSP","csp"],loader:function(){return import("./csp.3ea698d4.js")}}),W_e({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:function(){return import("./css.6bc87648.js")}}),W_e({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:function(){return import("./dart.546dc1a0.js")}}),W_e({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:function(){return import("./dockerfile.f692e688.js")}}),W_e({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:function(){return import("./ecl.6fbf9abb.js")}}),W_e({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:function(){return import("./elixir.4e4f4657.js")}}),W_e({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:function(){return import("./fsharp.73288c0b.js")}}),W_e({id:"go",extensions:[".go"],aliases:["Go"],loader:function(){return import("./go.feccdc48.js")}}),W_e({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:function(){return import("./graphql.a3667f60.js")}}),W_e({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:function(){return import("./handlebars.ef255e03.js")}}),W_e({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:function(){return import("./hcl.96a9154b.js")}}),W_e({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:function(){return import("./html.cc56c82b.js")}}),W_e({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:function(){return import("./ini.31297445.js")}}),W_e({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:function(){return import("./java.4f2072ed.js")}}),W_e({id:"javascript",extensions:[".js",".es6",".jsx",".mjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:function(){return import("./javascript.1794eeda.js")}}),W_e({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:function(){return import("./julia.de89f772.js")}}),W_e({id:"kotlin",extensions:[".kt"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:function(){return import("./kotlin.4c4351d6.js")}}),W_e({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:function(){return import("./less.f8ab1dd4.js")}}),W_e({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:function(){return import("./lexon.d3235956.js")}}),W_e({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:function(){return import("./lua.20d183c7.js")}}),W_e({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:function(){return import("./liquid.19518ae8.js")}}),W_e({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:function(){return import("./m3.65c8f277.js")}}),W_e({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:function(){return import("./markdown.52436a38.js")}}),W_e({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:function(){return import("./mips.b2466724.js")}}),W_e({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:function(){return import("./msdax.deec975d.js")}}),W_e({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:function(){return import("./mysql.63899ed3.js")}}),W_e({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:function(){return import("./objective-c.b9fbb06a.js")}}),W_e({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:function(){return import("./pascal.e3102ca6.js")}}),W_e({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:function(){return import("./pascaligo.1833bdd3.js")}}),W_e({id:"perl",extensions:[".pl"],aliases:["Perl","pl"],loader:function(){return import("./perl.62cd4b40.js")}}),W_e({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:function(){return import("./pgsql.b40e0af8.js")}}),W_e({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:function(){return import("./php.34a80821.js")}}),W_e({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:function(){return import("./postiats.200ec613.js")}}),W_e({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:function(){return import("./powerquery.9c10aa26.js")}}),W_e({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:function(){return import("./powershell.5bd5bb03.js")}}),W_e({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:function(){return import("./pug.5203432d.js")}}),W_e({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:function(){return import("./python.f468b8f0.js")}}),W_e({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:function(){return import("./qsharp.2b67fdad.js")}}),W_e({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:function(){return import("./r.faf74254.js")}}),W_e({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:function(){return import("./razor.3f25f175.js")}}),W_e({id:"redis",extensions:[".redis"],aliases:["redis"],loader:function(){return import("./redis.a3df2303.js")}}),W_e({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:function(){return import("./redshift.1fe23054.js")}}),W_e({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:function(){return import("./restructuredtext.eb2390cd.js")}}),W_e({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:function(){return import("./ruby.be714018.js")}}),W_e({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:function(){return import("./rust.4e744df3.js")}}),W_e({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:function(){return import("./sb.31116916.js")}}),W_e({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:function(){return import("./scala.c9d07798.js")}}),W_e({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:function(){return import("./scheme.e75f20c2.js")}}),W_e({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:function(){return import("./scss.f055b458.js")}}),W_e({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:function(){return import("./shell.5008b9bc.js")}}),W_e({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:function(){return import("./solidity.6c96fb67.js")}}),W_e({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:function(){return import("./sophia.f2df0d56.js")}}),W_e({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:function(){return import("./sparql.15b9a4c7.js")}}),W_e({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:function(){return import("./sql.dc588919.js")}}),W_e({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib"],aliases:["StructuredText","scl","stl"],loader:function(){return import("./st.8224e97e.js")}}),W_e({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:function(){return import("./swift.babf82d5.js")}}),W_e({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:function(){return import("./systemverilog.6665294d.js")}}),W_e({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:function(){return import("./systemverilog.6665294d.js")}}),W_e({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:function(){return import("./tcl.30e8a8fb.js")}}),W_e({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:function(){return import("./twig.77d17752.js")}}),W_e({id:"typescript",extensions:[".ts",".tsx"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:function(){return import("./typescript.b6f261f0.js")}}),W_e({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:function(){return import("./vb.8b22ef8f.js")}}),W_e({id:"xml",extensions:[".xml",".dtd",".ascx",".csproj",".config",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:function(){return import("./xml.ca5f6c6e.js")}}),W_e({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:function(){return import("./yaml.e2cf931f.js")}});class z_e{constructor(e="",t=!1){var n,i;if(this.value=e,"string"!=typeof this.value)throw aG("value");"boolean"==typeof t?(this.isTrusted=t,this.supportThemeIcons=!1):(this.isTrusted=null!==(n=t.isTrusted)&&void 0!==n?n:void 0,this.supportThemeIcons=null!==(i=t.supportThemeIcons)&&void 0!==i&&i)}appendText(e,t=0){var n;return this.value+=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}(this.supportThemeIcons?(n=e,n.replace(Phe,((e,t)=>t?e:`\\${e}`))):e).replace(/([ \t]+)/g,((e,t)=>"&nbsp;".repeat(t.length))).replace(/^>/gm,"\\>").replace(/\n/g,1===t?"\\\n":"\n\n"),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+="\n```",this.value+=e,this.value+="\n",this.value+=t,this.value+="\n```\n",this}}function V_e(e){return function(e){if(e instanceof z_e)return!0;if(e&&"object"==typeof e)return!("string"!=typeof e.value||"boolean"!=typeof e.isTrusted&&void 0!==e.isTrusted||"boolean"!=typeof e.supportThemeIcons&&void 0!==e.supportThemeIcons);return!1}(e)?!e.value:!Array.isArray(e)||e.every(V_e)}function U_e(e){return e?e.replace(/\\([\\`*_{}[\]()#+\-.!])/g,"$1"):e}var H_e=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const j_e=new M5("selectionAnchorSet",!1);let G_e=class e{constructor(e,t){this.editor=e,this.selectionAnchorSetContextKey=j_e.bindTo(t),this.modelChangeListener=e.onDidChangeModel((()=>this.selectionAnchorSetContextKey.reset()))}static get(t){return t.getContribution(e.ID)}setSelectionAnchor(){if(this.editor.hasModel()){const e=this.editor.getPosition(),t=this.decorationId?[this.decorationId]:[],n=this.editor.deltaDecorations(t,[{range:MK.fromPositions(e,e),options:{description:"selection-anchor",stickiness:1,hoverMessage:(new z_e).appendText(GH(0,"Selection Anchor")),className:"selection-anchor"}}]);this.decorationId=n[0],this.selectionAnchorSetContextKey.set(!!this.decorationId),t5(GH(0,"Anchor set at {0}:{1}",e.lineNumber,e.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);e&&this.editor.setPosition(e.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);if(e){const t=this.editor.getPosition();this.editor.setSelection(MK.fromPositions(e.getStartPosition(),t)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){this.decorationId&&(this.editor.deltaDecorations([this.decorationId],[]),this.decorationId=void 0,this.selectionAnchorSetContextKey.set(!1))}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}};G_e.ID="editor.contrib.selectionAnchorController",G_e=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,A5)],G_e);d6(G_e.ID,G_e),c6(class extends o6{constructor(){super({id:"editor.action.setSelectionAnchor",label:GH(0,"Set Selection Anchor"),alias:"Set Selection Anchor",precondition:void 0,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2080),weight:100}})}run(e,t){return H_e(this,void 0,void 0,(function*(){G_e.get(t).setSelectionAnchor()}))}}),c6(class extends o6{constructor(){super({id:"editor.action.goToSelectionAnchor",label:GH(0,"Go to Selection Anchor"),alias:"Go to Selection Anchor",precondition:j_e})}run(e,t){return H_e(this,void 0,void 0,(function*(){G_e.get(t).goToSelectionAnchor()}))}}),c6(class extends o6{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:GH(0,"Select from Anchor to Cursor"),alias:"Select from Anchor to Cursor",precondition:j_e,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2089),weight:100}})}run(e,t){return H_e(this,void 0,void 0,(function*(){G_e.get(t).selectFromAnchorToCursor()}))}}),c6(class extends o6{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:GH(0,"Cancel Selection Anchor"),alias:"Cancel Selection Anchor",precondition:j_e,kbOpts:{kbExpr:gre.editorTextFocus,primary:9,weight:100}})}run(e,t){return H_e(this,void 0,void 0,(function*(){G_e.get(t).cancelSelectionAnchor()}))}});const K_e=_ee("editorOverviewRuler.bracketMatchForeground",{dark:"#A0A0A0",light:"#A0A0A0",hc:"#A0A0A0"},GH(0,"Overview ruler marker color for matching brackets."));class q_e{constructor(e,t,n){this.position=e,this.brackets=t,this.options=n}}class $_e extends mG{constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=[],this._updateBracketsSoon=this._register(new z$((()=>this._updateBrackets()),50)),this._matchBrackets=this._editor.getOption(61),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition((e=>{"never"!==this._matchBrackets&&this._updateBracketsSoon.schedule()}))),this._register(e.onDidChangeModelContent((e=>{this._updateBracketsSoon.schedule()}))),this._register(e.onDidChangeModel((e=>{this._lastBracketsData=[],this._decorations=[],this._updateBracketsSoon.schedule()}))),this._register(e.onDidChangeModelLanguageConfiguration((e=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()}))),this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(61)&&(this._matchBrackets=this._editor.getOption(61),this._decorations=this._editor.deltaDecorations(this._decorations,[]),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})))}static get(e){return e.getContribution($_e.ID)}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map((t=>{const n=t.getStartPosition(),i=e.matchBracket(n);let r=null;if(i)i[0].containsPosition(n)?r=i[1].getStartPosition():i[1].containsPosition(n)&&(r=i[0].getStartPosition());else{const t=e.findEnclosingBrackets(n);if(t)r=t[0].getStartPosition();else{const t=e.findNextBracket(n);t&&t.range&&(r=t.range.getStartPosition())}}return r?new MK(r.lineNumber,r.column,r.lineNumber,r.column):new MK(n.lineNumber,n.column,n.lineNumber,n.column)}));this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),n=[];this._editor.getSelections().forEach((i=>{const r=i.getStartPosition();let o=t.matchBracket(r);if(!o&&(o=t.findEnclosingBrackets(r),!o)){const e=t.findNextBracket(r);e&&e.range&&(o=t.matchBracket(e.range.getStartPosition()))}let s=null,a=null;if(o){o.sort(TK.compareRangesUsingStarts);const[t,n]=o;s=e?t.getStartPosition():t.getEndPosition(),a=e?n.getEndPosition():n.getStartPosition()}s&&a&&n.push(new MK(s.lineNumber,s.column,a.lineNumber,a.column))})),n.length>0&&(this._editor.setSelections(n),this._editor.revealRange(n[0]))}_updateBrackets(){if("never"===this._matchBrackets)return;this._recomputeBrackets();let e=[],t=0;for(const n of this._lastBracketsData){let i=n.brackets;i&&(e[t++]={range:i[0],options:n.options},e[t++]={range:i[1],options:n.options})}this._decorations=this._editor.deltaDecorations(this._decorations,e)}_recomputeBrackets(){if(!this._editor.hasModel())return this._lastBracketsData=[],void(this._lastVersionId=0);const e=this._editor.getSelections();if(e.length>100)return this._lastBracketsData=[],void(this._lastVersionId=0);const t=this._editor.getModel(),n=t.getVersionId();let i=[];this._lastVersionId===n&&(i=this._lastBracketsData);let r=[],o=0;for(let u=0,h=e.length;u<h;u++){let t=e[u];t.isEmpty()&&(r[o++]=t.getStartPosition())}r.length>1&&r.sort(IK.compare);let s=[],a=0,l=0,c=i.length;for(let u=0,h=r.length;u<h;u++){let e=r[u];for(;l<c&&i[l].position.isBefore(e);)l++;if(l<c&&i[l].position.equals(e))s[a++]=i[l];else{let n=t.matchBracket(e),i=$_e._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;n||"always"!==this._matchBrackets||(n=t.findEnclosingBrackets(e,20),i=$_e._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),s[a++]=new q_e(e,n,i)}}this._lastBracketsData=s,this._lastVersionId=n}}$_e.ID="editor.contrib.bracketMatchingController",$_e._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=v7.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:V5(K_e),position:wQ.Center}}),$_e._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=v7.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"}),d6($_e.ID,$_e),c6(class extends o6{constructor(){super({id:"editor.action.selectToBracket",label:GH(0,"Select to Bracket"),alias:"Select to Bracket",precondition:void 0,description:{description:"Select to Bracket",args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,n){const i=$_e.get(t);if(!i)return;let r=!0;n&&!1===n.selectBrackets&&(r=!1),i.selectToBracket(r)}}),c6(class extends o6{constructor(){super({id:"editor.action.jumpToBracket",label:GH(0,"Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:gre.editorTextFocus,primary:3160,weight:100}})}run(e,t){let n=$_e.get(t);n&&n.jumpToBracket()}}),G5(((e,t)=>{const n=e.getColor(xie);n&&t.addRule(`.monaco-editor .bracket-match { background-color: ${n}; }`);const i=e.getColor(Eie);i&&t.addRule(`.monaco-editor .bracket-match { border: 1px solid ${i}; }`)})),Z5.appendMenuItem(Y5.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:GH(0,"Go to &&Bracket")},order:2});class Y_e{constructor(e,t){this._selection=e,this._isMovingLeft=t}getEditOperations(e,t){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const n=this._selection.startLineNumber,i=this._selection.startColumn,r=this._selection.endColumn;if((!this._isMovingLeft||1!==i)&&(this._isMovingLeft||r!==e.getLineMaxColumn(n)))if(this._isMovingLeft){const o=new TK(n,i-1,n,i),s=e.getValueInRange(o);t.addEditOperation(o,null),t.addEditOperation(new TK(n,r,n,r),s)}else{const o=new TK(n,r,n,r+1),s=e.getValueInRange(o);t.addEditOperation(o,null),t.addEditOperation(new TK(n,i,n,i),s)}}computeCursorState(e,t){return this._isMovingLeft?new MK(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new MK(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}class X_e extends o6{constructor(e,t){super(t),this.left=e}run(e,t){if(!t.hasModel())return;let n=[],i=t.getSelections();for(const r of i)n.push(new Y_e(r,this.left));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}c6(class extends X_e{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:GH(0,"Move Selected Text Left"),alias:"Move Selected Text Left",precondition:gre.writable})}}),c6(class extends X_e{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:GH(0,"Move Selected Text Right"),alias:"Move Selected Text Right",precondition:gre.writable})}});c6(class extends o6{constructor(){super({id:"editor.action.transposeLetters",label:GH(0,"Transpose Letters"),alias:"Transpose Letters",precondition:gre.writable,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(e,t){if(!t.hasModel())return;let n=t.getModel(),i=[],r=t.getSelections();for(let o of r){if(!o.isEmpty())continue;let e=o.startLineNumber,t=o.startColumn,r=n.getLineMaxColumn(e);if(1===e&&(1===t||2===t&&2===r))continue;let s=t===r?o.getPosition():Xie.rightPosition(n,o.getPosition().lineNumber,o.getPosition().column),a=Xie.leftPosition(n,s),l=Xie.leftPosition(n,a),c=n.getValueInRange(TK.fromPositions(l,a)),u=n.getValueInRange(TK.fromPositions(a,s)),h=TK.fromPositions(l,s);i.push(new jie(h,u+c))}i.length>0&&(t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop())}});var Z_e=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const Q_e=uj||document.queryCommandSupported("cut"),J_e=uj||document.queryCommandSupported("copy"),ebe=void 0!==navigator.clipboard&&!h$||document.queryCommandSupported("paste");function tbe(e){return e.register(),e}const nbe=Q_e?tbe(new n6({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:uj?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:Y5.MenubarEditMenu,group:"2_ccp",title:GH(0,"Cu&&t"),order:1},{menuId:Y5.EditorContext,group:"9_cutcopypaste",title:GH(0,"Cut"),when:gre.writable,order:1},{menuId:Y5.CommandPalette,group:"",title:GH(0,"Cut"),order:1},{menuId:Y5.SimpleEditorContext,group:"9_cutcopypaste",title:GH(0,"Cut"),when:gre.writable,order:1}]})):void 0,ibe=J_e?tbe(new n6({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:uj?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:Y5.MenubarEditMenu,group:"2_ccp",title:GH(0,"&&Copy"),order:2},{menuId:Y5.EditorContext,group:"9_cutcopypaste",title:GH(0,"Copy"),order:2},{menuId:Y5.CommandPalette,group:"",title:GH(0,"Copy"),order:1},{menuId:Y5.SimpleEditorContext,group:"9_cutcopypaste",title:GH(0,"Copy"),order:2}]})):void 0;Z5.appendMenuItem(Y5.MenubarEditMenu,{submenu:Y5.MenubarCopy,title:{value:GH(0,"Copy As"),original:"Copy As"},group:"2_ccp",order:3}),Z5.appendMenuItem(Y5.EditorContext,{submenu:Y5.EditorContextCopy,title:{value:GH(0,"Copy As"),original:"Copy As"},group:"9_cutcopypaste",order:3});const rbe=ebe?tbe(new n6({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:uj?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:Y5.MenubarEditMenu,group:"2_ccp",title:GH(0,"&&Paste"),order:4},{menuId:Y5.EditorContext,group:"9_cutcopypaste",title:GH(0,"Paste"),when:gre.writable,order:4},{menuId:Y5.CommandPalette,group:"",title:GH(0,"Paste"),order:1},{menuId:Y5.SimpleEditorContext,group:"9_cutcopypaste",title:GH(0,"Paste"),when:gre.writable,order:4}]})):void 0;class obe extends o6{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:GH(0,"Copy With Syntax Highlighting"),alias:"Copy With Syntax Highlighting",precondition:void 0,kbOpts:{kbExpr:gre.textInputFocus,primary:0,weight:100}})}run(e,t){if(!t.hasModel())return;!t.getOption(30)&&t.getSelection().isEmpty()||(lee.forceCopyWithSyntaxHighlighting=!0,t.focus(),document.execCommand("copy"),lee.forceCopyWithSyntaxHighlighting=!1)}}function sbe(e,t){e&&(e.addImplementation(1e4,"code-editor",((e,n)=>{const i=e.get(o$).getFocusedCodeEditor();if(i&&i.hasTextFocus()){const e=i.getOption(30),n=i.getSelection();return n&&n.isEmpty()&&!e||document.execCommand(t),!0}return!1})),e.addImplementation(0,"generic-dom",((e,n)=>(document.execCommand(t),!0))))}sbe(nbe,"cut"),sbe(ibe,"copy"),rbe&&(rbe.addImplementation(1e4,"code-editor",((e,t)=>{const n=e.get(o$),i=e.get(Ule),r=n.getFocusedCodeEditor();if(r&&r.hasTextFocus()){return!(!document.execCommand("paste")&&hj)||(Z_e(void 0,void 0,void 0,(function*(){const e=yield i.readText();if(""!==e){const t=cee.INSTANCE.get(e);let n=!1,i=null,o=null;t&&(n=r.getOption(30)&&!!t.isFromEmptySelection,i=void 0!==t.multicursorText?t.multicursorText:null,o=t.mode),r.trigger("keyboard","paste",{text:e,pasteOnNewLine:n,multicursorText:i,mode:o})}})),!0)}return!1})),rbe.addImplementation(0,"generic-dom",((e,t)=>(document.execCommand("paste"),!0)))),J_e&&c6(obe);class abe{constructor(e){this.executor=e,this._didRun=!1}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}class lbe{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||""===this.value||e.value.startsWith(this.value+lbe.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(e){return new lbe(this.value+lbe.sep+e)}}function cbe(e,t,n){return!!t.contains(e)&&(!n||!t.contains(n))}lbe.sep=".",lbe.None=new lbe("@@none@@"),lbe.Empty=new lbe(""),lbe.QuickFix=new lbe("quickfix"),lbe.Refactor=new lbe("refactor"),lbe.Source=new lbe("source"),lbe.SourceOrganizeImports=lbe.Source.append("organizeImports"),lbe.SourceFixAll=lbe.Source.append("fixAll");class ube{constructor(e,t,n){this.kind=e,this.apply=t,this.preferred=n}static fromUser(e,t){return e&&"object"==typeof e?new ube(ube.getKindFromUser(e,t.kind),ube.getApplyFromUser(e,t.apply),ube.getPreferredUser(e)):new ube(t.kind,t.apply,!1)}static getApplyFromUser(e,t){switch("string"==typeof e.apply?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return"string"==typeof e.kind?new lbe(e.kind):t}static getPreferredUser(e){return"boolean"==typeof e.preferred&&e.preferred}}var hbe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class dbe{constructor(e,t){this.action=e,this.provider=t}resolve(e){var t;return hbe(this,void 0,void 0,(function*(){if((null===(t=this.provider)||void 0===t?void 0:t.resolveCodeAction)&&!this.action.edit){let t;try{t=yield this.provider.resolveCodeAction(this.action,e)}catch(n){iG(n)}t&&(this.action.edit=t.edit)}return this}))}}class fbe extends mG{constructor(e,t,n){super(),this.documentation=t,this._register(n),this.allActions=[...e].sort(fbe.codeActionsComparator),this.validActions=this.allActions.filter((({action:e})=>!e.disabled))}static codeActionsComparator({action:e},{action:t}){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:R1(e.diagnostics)?R1(t.diagnostics)?e.diagnostics[0].message.localeCompare(t.diagnostics[0].message):-1:R1(t.diagnostics)?1:0}get hasAutoFix(){return this.validActions.some((({action:e})=>!!e.kind&&lbe.QuickFix.contains(new lbe(e.kind))&&!!e.isPreferred))}}const gbe={actions:[],documentation:void 0};function pbe(e,t,n,i,r){var o;const s=n.filter||{},a={only:null===(o=s.include)||void 0===o?void 0:o.value,trigger:n.type},l=new ple(e,r),c=function(e,t){return WJ.all(e).filter((e=>!e.providedCodeActionKinds||e.providedCodeActionKinds.some((e=>function(e,t){return!(e.include&&!e.include.intersects(t)||e.excludes&&e.excludes.some((n=>cbe(t,n,e.include)))||!e.includeSourceActions&&lbe.Source.contains(t))}(t,new lbe(e))))))}(e,s),u=new pG,h=c.map((n=>hbe(this,void 0,void 0,(function*(){try{i.report(n);const r=yield n.provideCodeActions(e,t,a,l.token);if(r&&u.add(r),l.token.isCancellationRequested)return gbe;const o=((null==r?void 0:r.actions)||[]).filter((e=>e&&function(e,t){const n=t.kind?new lbe(t.kind):void 0;return!(!(!e.include||n&&e.include.contains(n))||e.excludes&&n&&e.excludes.some((t=>cbe(n,t,e.include)))||!e.includeSourceActions&&n&&lbe.Source.contains(n)||e.onlyIncludePreferredActions&&!t.isPreferred)}(s,e))),c=function(e,t,n){if(!e.documentation)return;const i=e.documentation.map((e=>({kind:new lbe(e.kind),command:e.command})));if(n){let e;for(const t of i)t.kind.contains(n)&&(e?e.kind.contains(t.kind)&&(e=t):e=t);if(e)return null==e?void 0:e.command}for(const r of t)if(r.kind)for(const e of i)if(e.kind.contains(new lbe(r.kind)))return e.command;return}(n,o,s.include);return{actions:o.map((e=>new dbe(e,n))),documentation:c}}catch(r){if(oG(r))throw r;return iG(r),gbe}})))),d=WJ.onDidChange((()=>{D1(WJ.all(e),c)||l.cancel()}));return Promise.all(h).then((e=>{const t=W1(e.map((e=>e.actions))),n=A1(e.map((e=>e.documentation)));return new fbe(t,n,u)})).finally((()=>{d.dispose(),l.dispose()}))}qZ.registerCommand("_executeCodeActionProvider",(function(e,t,n,i,r){return hbe(this,void 0,void 0,(function*(){if(!(t instanceof _K))throw aG();const o=e.get(iJ).getModel(t);if(!o)throw aG();const s=MK.isISelection(n)?MK.liftSelection(n):TK.isIRange(n)?o.validateRange(n):void 0;if(!s)throw aG();const a="string"==typeof i?new lbe(i):void 0,l=yield pbe(o,s,{type:1,filter:{includeSourceActions:!0,include:a}},Hle.None,TG.None),c=[],u=Math.min(l.validActions.length,"number"==typeof r?r:0);for(let e=0;e<u;e++)c.push(l.validActions[e].resolve(TG.None));try{return yield Promise.all(c),l.validActions.map((e=>e.action))}finally{setTimeout((()=>l.dispose()),100)}}))}));let mbe=class e{constructor(t,n){this._messageWidget=new vG,this._messageListeners=new pG,this._editor=t,this._visible=e.MESSAGE_VISIBLE.bindTo(n),this._editorListener=this._editor.onDidAttemptReadOnlyEdit((()=>this._onDidAttemptReadOnlyEdit()))}static get(t){return t.getContribution(e.ID)}dispose(){this._editorListener.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){let n;t5(e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._messageWidget.value=new vbe(this._editor,t,e),this._messageListeners.add(this._editor.onDidBlurEditorText((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeCursorPosition((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidDispose((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeModel((()=>this.closeMessage()))),this._messageListeners.add(new B$((()=>this.closeMessage()),3e3)),this._messageListeners.add(this._editor.onMouseMove((e=>{e.target.position&&(n?n.containsPosition(e.target.position)||this.closeMessage():n=new TK(t.lineNumber-3,1,e.target.position.lineNumber+3,1))})))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(vbe.fadeOut(this._messageWidget.value))}_onDidAttemptReadOnlyEdit(){this._editor.hasModel()&&this.showMessage(GH(0,"Cannot edit in read-only editor"),this._editor.getPosition())}};mbe.ID="editor.contrib.messageController",mbe.MESSAGE_VISIBLE=new M5("messageVisible",!1,GH(0,"Whether the editor is currently showing an inline message")),mbe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,A5)],mbe);l6(new(r6.bindToContribution(mbe.get))({id:"leaveEditorMessage",precondition:mbe.MESSAGE_VISIBLE,handler:e=>e.closeMessage(),kbOpts:{weight:130,primary:9}}));class vbe{constructor(e,{lineNumber:t,column:n},i){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:n-1},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage");const r=document.createElement("div");r.classList.add("anchor","top"),this._domNode.appendChild(r);const o=document.createElement("div");o.classList.add("message"),o.textContent=i,this._domNode.appendChild(o);const s=document.createElement("div");s.classList.add("anchor","below"),this._domNode.appendChild(s),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}static fadeOut(e){let t;const n=()=>{e.dispose(),clearTimeout(t),e.getDomNode().removeEventListener("animationend",n)};return t=setTimeout(n,110),e.getDomNode().addEventListener("animationend",n),e.getDomNode().classList.add("fadeOut"),{dispose:n}}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2]}}afterRender(e){this._domNode.classList.toggle("below",2===e)}}d6(mbe.ID,mbe),G5(((e,t)=>{const n=e.getColor(Bee);if(n){let i=e.type===P5.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.below { border-top-color: ${n}; }`),t.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.top { border-bottom-color: ${n}; }`),t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { border: ${i}px solid ${n}; }`)}const i=e.getColor(Pee);i&&t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { background-color: ${i}; }`);const r=e.getColor(Fee);r&&t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { color: ${r}; }`)}));var ybe=function(e,t){return function(n,i){t(n,i,e)}},_be=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class bbe extends s5{constructor(e,t){super(e.command?e.command.id:e.title,e.title.replace(/\r\n|\r|\n/g," "),void 0,!e.disabled,t),this.action=e}}let wbe=class extends mG{constructor(e,t,n,i){super(),this._editor=e,this._delegate=t,this._contextMenuService=n,this._visible=!1,this._showingActions=this._register(new vG),this._keybindingResolver=new Cbe({getKeybindings:()=>i.getKeybindings()})}get isVisible(){return this._visible}show(e,t,n,i){return _be(this,void 0,void 0,(function*(){const r=i.includeDisabledActions?t.allActions:t.validActions;if(!r.length)return void(this._visible=!1);if(!this._editor.getDomNode())throw this._visible=!1,sG();this._visible=!0,this._showingActions.value=t;const o=this.getMenuActions(e,r,t.documentation),s=IK.isIPosition(n)?this._toCoords(n):n||{x:0,y:0},a=this._keybindingResolver.getResolver(),l=this._editor.getOption(112);this._contextMenuService.showContextMenu({domForShadowRoot:l?this._editor.getDomNode():void 0,getAnchor:()=>s,getActions:()=>o,onHide:()=>{this._visible=!1,this._editor.focus()},autoSelectFirstItem:!0,getKeyBinding:e=>e instanceof bbe?a(e.action):void 0})}))}getMenuActions(e,t,n){var i,r;const o=e=>new bbe(e.action,(()=>this._delegate.onSelectCodeAction(e))),s=t.map(o),a=[...n],l=this._editor.getModel();if(l&&s.length)for(const c of WJ.all(l))c._getAdditionalMenuItems&&a.push(...c._getAdditionalMenuItems({trigger:e.type,only:null===(r=null===(i=e.filter)||void 0===i?void 0:i.include)||void 0===r?void 0:r.value},t.map((e=>e.action))));return a.length&&s.push(new l5,...a.map((e=>o(new dbe({title:e.title,command:e},void 0))))),s}_toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),n=mY(this._editor.getDomNode());return{x:n.left+t.left,y:n.top+t.top+t.height}}};wbe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ybe(2,Wle),ybe(3,gce)],wbe);class Cbe{constructor(e){this._keybindingProvider=e}getResolver(){const e=new abe((()=>this._keybindingProvider.getKeybindings().filter((e=>Cbe.codeActionCommands.indexOf(e.command)>=0)).filter((e=>e.resolvedKeybinding)).map((e=>{let t=e.commandArgs;return"editor.action.organizeImports"===e.command?t={kind:lbe.SourceOrganizeImports.value}:"editor.action.fixAll"===e.command&&(t={kind:lbe.SourceFixAll.value}),Object.assign({resolvedKeybinding:e.resolvedKeybinding},ube.fromUser(t,{kind:lbe.None,apply:"never"}))}))));return t=>{if(t.kind){const n=this.bestKeybindingForCodeAction(t,e.getValue());return null==n?void 0:n.resolvedKeybinding}}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const n=new lbe(e.kind);return t.filter((e=>e.kind.contains(n))).filter((t=>!t.preferred||e.isPreferred)).reduceRight(((e,t)=>e?e.kind.contains(t.kind)?t:e:t),void 0)}}Cbe.codeActionCommands=["editor.action.refactor","editor.action.codeAction","editor.action.sourceAction","editor.action.organizeImports","editor.action.fixAll"];var Sbe;!function(e){e.Hidden={type:0};e.Showing=class{constructor(e,t,n,i){this.actions=e,this.trigger=t,this.editorPosition=n,this.widgetPosition=i,this.type=1}}}(Sbe||(Sbe={}));let xbe=class e extends mG{constructor(e,t,n,i){var r;super(),this._editor=e,this._quickFixActionId=t,this._preferredFixActionId=n,this._keybindingService=i,this._onClick=this._register(new EG),this.onClick=this._onClick.event,this._state=Sbe.Hidden,this._domNode=document.createElement("div"),this._domNode.className=hJ.lightBulb.classNames,this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent((e=>{const t=this._editor.getModel();(1!==this.state.type||!t||this.state.editorPosition.lineNumber>=t.getLineCount())&&this.hide()}))),O6.ignoreTarget(this._domNode),this._register(tY(this._domNode,J$((e=>{if(1!==this.state.type)return;this._editor.focus(),e.preventDefault();const{top:t,height:n}=mY(this._domNode),i=this._editor.getOption(56);let r=Math.floor(i/3);null!==this.state.widgetPosition.position&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(r+=i),this._onClick.fire({x:e.posx,y:t+n+r,actions:this.state.actions,trigger:this.state.trigger})})),r)),this._register(Q$(this._domNode,"mouseenter",(e=>{if(1!=(1&e.buttons))return;this.hide();const t=new P6;t.startMonitoring(e.target,e.buttons,R6,(()=>{}),(()=>{t.dispose()}))}))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(54)&&!this._editor.getOption(54).enabled&&this.hide()}))),this._updateLightBulbTitleAndIcon(),this._register(this._keybindingService.onDidUpdateKeybindings(this._updateLightBulbTitleAndIcon,this))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return 1===this._state.type?this._state.widgetPosition:null}update(t,n,i){if(t.validActions.length<=0)return this.hide();const r=this._editor.getOptions();if(!r.get(54).enabled)return this.hide();const o=this._editor.getModel();if(!o)return this.hide();const{lineNumber:s,column:a}=o.validatePosition(i),l=o.getOptions().tabSize,c=r.get(40),u=o.getLineContent(s),h=l7.computeIndentLevel(u,l),d=e=>e>2&&this._editor.getTopForLineNumber(e)===this._editor.getTopForLineNumber(e-1);let f=s;if(!(c.spaceWidth*h>22))if(s>1&&!d(s-1))f-=1;else if(d(s+1)){if(a*c.spaceWidth<22)return this.hide()}else f+=1;this.state=new Sbe.Showing(t,n,i,{position:{lineNumber:f,column:1},preference:e._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state=Sbe.Hidden,this._editor.layoutContentWidget(this)}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(1===this.state.type&&this.state.actions.hasAutoFix){this._domNode.classList.remove(...hJ.lightBulb.classNamesArray),this._domNode.classList.add(...hJ.lightbulbAutofix.classNamesArray);const e=this._keybindingService.lookupKeybinding(this._preferredFixActionId);if(e)return void(this.title=GH(0,"Show Fixes. Preferred Fix Available ({0})",e.getLabel()))}this._domNode.classList.remove(...hJ.lightbulbAutofix.classNamesArray),this._domNode.classList.add(...hJ.lightBulb.classNamesArray);const e=this._keybindingService.lookupKeybinding(this._quickFixActionId);this.title=e?GH(0,"Show Fixes ({0})",e.getLabel()):GH(0,"Show Fixes")}set title(e){this._domNode.title=e}};xbe._posPref=[0],xbe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(3,gce)],xbe),G5(((e,t)=>{var n;const i=null===(n=e.getColor(gte))||void 0===n?void 0:n.transparent(.7),r=e.getColor($te);r&&t.addRule(`\n\t\t.monaco-editor .contentWidgets ${hJ.lightBulb.cssSelector} {\n\t\t\tcolor: ${r};\n\t\t\tbackground-color: ${i};\n\t\t}`);const o=e.getColor(Yte);o&&t.addRule(`\n\t\t.monaco-editor .contentWidgets ${hJ.lightbulbAutofix.cssSelector} {\n\t\t\tcolor: ${o};\n\t\t\tbackground-color: ${i};\n\t\t}`)}));var Ebe,kbe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let Lbe=class extends mG{constructor(e,t,n,i,r){super(),this._editor=e,this.delegate=i,this._activeCodeActions=this._register(new vG),Ebe.set(this,!1),this._codeActionWidget=new abe((()=>this._register(r.createInstance(wbe,this._editor,{onSelectCodeAction:e=>kbe(this,void 0,void 0,(function*(){this.delegate.applyCodeAction(e,!0)}))})))),this._lightBulbWidget=new abe((()=>{const e=this._register(r.createInstance(xbe,this._editor,t,n));return this._register(e.onClick((e=>this.showCodeActionList(e.trigger,e.actions,e,{includeDisabledActions:!1})))),e}))}dispose(){!function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,Ebe,!0,"f"),super.dispose()}update(e){var t,n,i;return kbe(this,void 0,void 0,(function*(){if(1!==e.type)return void(null===(t=this._lightBulbWidget.rawValue)||void 0===t||t.hide());let r;try{r=yield e.actions}catch(zWe){return void nG(zWe)}if(!function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}(this,Ebe,"f"))if(this._lightBulbWidget.getValue().update(r,e.trigger,e.position),1===e.trigger.type){if(null===(n=e.trigger.filter)||void 0===n?void 0:n.include){const t=this.tryGetValidActionToApply(e.trigger,r);if(t){try{yield this.delegate.applyCodeAction(t,!1)}finally{r.dispose()}return}if(e.trigger.context){const t=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,r);if(t&&t.action.disabled)return mbe.get(this._editor).showMessage(t.action.disabled,e.trigger.context.position),void r.dispose()}}const t=!!(null===(i=e.trigger.filter)||void 0===i?void 0:i.include);if(e.trigger.context&&(!r.allActions.length||!t&&!r.validActions.length))return mbe.get(this._editor).showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=r,void r.dispose();this._activeCodeActions.value=r,this._codeActionWidget.getValue().show(e.trigger,r,e.position,{includeDisabledActions:t})}else this._codeActionWidget.getValue().isVisible?r.dispose():this._activeCodeActions.value=r}))}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length)return"first"===e.autoApply&&0===t.validActions.length||"ifSingle"===e.autoApply&&1===t.allActions.length?t.allActions.find((({action:e})=>e.disabled)):void 0}tryGetValidActionToApply(e,t){if(t.validActions.length)return"first"===e.autoApply&&t.validActions.length>0||"ifSingle"===e.autoApply&&1===t.validActions.length?t.validActions[0]:void 0}showCodeActionList(e,t,n,i){return kbe(this,void 0,void 0,(function*(){this._codeActionWidget.getValue().show(e,t,n,i)}))}};Ebe=new WeakMap,Lbe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(4,t$)],Lbe);var Dbe,Nbe=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};const Ibe=new M5("supportedCodeAction","");class Tbe extends mG{constructor(e,t,n,i=250){super(),this._editor=e,this._markerService=t,this._signalChange=n,this._delay=i,this._autoTriggerTimer=this._register(new B$),this._register(this._markerService.onMarkerChanged((e=>this._onMarkerChanges(e)))),this._register(this._editor.onDidChangeCursorPosition((()=>this._onCursorChange())))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);return this._createEventAndSignalChange(e,t)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some((e=>SZ(e,t.uri)))&&this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2})}),this._delay)}_onCursorChange(){this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2})}),this._delay)}_getRangeOfMarker(e){const t=this._editor.getModel();if(t)for(const n of this._markerService.read({resource:t.uri})){const i=t.validateRange(n);if(TK.intersectRanges(i,e))return TK.lift(i)}}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),n=this._editor.getSelection();if(n.isEmpty()&&2===e.type){const{lineNumber:e,column:i}=n.getPosition(),r=t.getLineContent(e);if(0===r.length)return;if(1===i){if(/\s/.test(r[0]))return}else if(i===t.getLineMaxColumn(e)){if(/\s/.test(r[r.length-1]))return}else if(/\s/.test(r[i-2])&&/\s/.test(r[i-1]))return}return n}_createEventAndSignalChange(e,t){const n=this._editor.getModel();if(!t||!n)return void this._signalChange(void 0);const i=this._getRangeOfMarker(t),r=i?i.getStartPosition():t.getStartPosition(),o={trigger:e,selection:t,position:r};return this._signalChange(o),o}}var Mbe;!function(e){e.Empty={type:0};e.Triggered=class{constructor(e,t,n,i){this.trigger=e,this.rangeOrSelection=t,this.position=n,this._cancellablePromise=i,this.type=1,this.actions=i.catch((e=>{if(oG(e))return Abe;throw e}))}cancel(){this._cancellablePromise.cancel()}}}(Mbe||(Mbe={}));const Abe={allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1};class Obe extends mG{constructor(e,t,n,i){super(),this._editor=e,this._markerService=t,this._progressService=i,this._codeActionOracle=this._register(new vG),this._state=Mbe.Empty,this._onDidChangeState=this._register(new EG),this.onDidChangeState=this._onDidChangeState.event,Dbe.set(this,!1),this._supportedCodeActions=Ibe.bindTo(n),this._register(this._editor.onDidChangeModel((()=>this._update()))),this._register(this._editor.onDidChangeModelLanguage((()=>this._update()))),this._register(WJ.onDidChange((()=>this._update()))),this._update()}dispose(){Nbe(this,Dbe,"f")||(!function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?r.call(e,n):r?r.value=n:t.set(e,n)}(this,Dbe,!0,"f"),super.dispose(),this.setState(Mbe.Empty,!0))}_update(){if(Nbe(this,Dbe,"f"))return;this._codeActionOracle.value=void 0,this.setState(Mbe.Empty);const e=this._editor.getModel();if(e&&WJ.has(e)&&!this._editor.getOption(78)){const t=[];for(const n of WJ.all(e))Array.isArray(n.providedCodeActionKinds)&&t.push(...n.providedCodeActionKinds);this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new Tbe(this._editor,this._markerService,(t=>{var n;if(!t)return void this.setState(Mbe.Empty);const i=I$((n=>pbe(e,t.selection,t.trigger,Hle.None,n)));1===t.trigger.type&&(null===(n=this._progressService)||void 0===n||n.showWhile(i,250)),this.setState(new Mbe.Triggered(t.trigger,t.selection,t.position,i))}),void 0),this._codeActionOracle.value.trigger({type:2})}else this._supportedCodeActions.reset()}trigger(e){this._codeActionOracle.value&&this._codeActionOracle.value.trigger(e)}setState(e,t){e!==this._state&&(1===this._state.type&&this._state.cancel(),this._state=e,t||Nbe(this,Dbe,"f")||this._onDidChangeState.fire(e))}}Dbe=new WeakMap;var Rbe=function(e,t){return function(n,i){t(n,i,e)}},Pbe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function Fbe(e){return g5.regex(Ibe.keys()[0],new RegExp("(\\s|^)"+rX(e.value)+"\\b"))}const Bbe={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:GH(0,"Kind of the code action to run.")},apply:{type:"string",description:GH(0,"Controls when the returned actions are applied."),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[GH(0,"Always apply the first returned code action."),GH(0,"Apply the first returned code action if it is the only one."),GH(0,"Do not apply the returned code actions.")]},preferred:{type:"boolean",default:!1,description:GH(0,"Controls if only preferred code actions should be returned.")}}};let Wbe=class e extends mG{constructor(e,t,n,i,r){super(),this._instantiationService=r,this._editor=e,this._model=this._register(new Obe(this._editor,t,n,i)),this._register(this._model.onDidChangeState((e=>this.update(e)))),this._ui=new abe((()=>this._register(new Lbe(e,Ube.Id,Hbe.Id,{applyCodeAction:(e,t)=>Pbe(this,void 0,void 0,(function*(){try{yield this._applyCodeAction(e)}finally{t&&this._trigger({type:2,filter:{}})}}))},this._instantiationService))))}static get(t){return t.getContribution(e.ID)}update(e){this._ui.getValue().update(e)}showCodeActions(e,t,n){return this._ui.getValue().showCodeActionList(e,t,n,{includeDisabledActions:!1})}manualTriggerAtCurrentPosition(e,t,n){if(!this._editor.hasModel())return;mbe.get(this._editor).closeMessage();const i=this._editor.getPosition();this._trigger({type:1,filter:t,autoApply:n,context:{notAvailableMessage:e,position:i}})}_trigger(e){return this._model.trigger(e)}_applyCodeAction(e){return this._instantiationService.invokeFunction(zbe,e,this._editor)}};function zbe(e,t,n){return Pbe(this,void 0,void 0,(function*(){const i=e.get(l3),r=e.get(KZ),o=e.get(e6),s=e.get(g4);if(o.publicLog2("codeAction.applyCodeAction",{codeActionTitle:t.action.title,codeActionKind:t.action.kind,codeActionIsPreferred:!!t.action.isPreferred}),yield t.resolve(TG.None),t.action.edit&&(yield i.apply(c3.convert(t.action.edit),{editor:n,label:t.action.title})),t.action.command)try{yield r.executeCommand(t.action.command.id,...t.action.command.arguments||[])}catch(a){const e=function(e){return"string"==typeof e?e:e instanceof Error&&"string"==typeof e.message?e.message:void 0}(a);s.error("string"==typeof e?e:GH(0,"An unknown error occurred while applying the code action"))}}))}function Vbe(e,t,n,i){if(e.hasModel()){const r=Wbe.get(e);r&&r.manualTriggerAtCurrentPosition(t,n,i)}}Wbe.ID="editor.contrib.quickFixController",Wbe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Rbe(1,ape),Rbe(2,A5),Rbe(3,jle),Rbe(4,t$)],Wbe);class Ube extends o6{constructor(){super({id:Ube.Id,label:GH(0,"Quick Fix..."),alias:"Quick Fix...",precondition:g5.and(gre.writable,gre.hasCodeActionsProvider),kbOpts:{kbExpr:gre.editorTextFocus,primary:2132,weight:100}})}run(e,t){return Vbe(t,GH(0,"No code actions available"),void 0,void 0)}}Ube.Id="editor.action.quickFix";class Hbe extends o6{constructor(){super({id:Hbe.Id,label:GH(0,"Auto Fix..."),alias:"Auto Fix...",precondition:g5.and(gre.writable,Fbe(lbe.QuickFix)),kbOpts:{kbExpr:gre.editorTextFocus,primary:1620,mac:{primary:2644},weight:100}})}run(e,t){return Vbe(t,GH(0,"No auto fixes available"),{include:lbe.QuickFix,onlyIncludePreferredActions:!0},"ifSingle")}}Hbe.Id="editor.action.autoFix",d6(Wbe.ID,Wbe),c6(Ube),c6(class extends o6{constructor(){super({id:"editor.action.refactor",label:GH(0,"Refactor..."),alias:"Refactor...",precondition:g5.and(gre.writable,gre.hasCodeActionsProvider),kbOpts:{kbExpr:gre.editorTextFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:g5.and(gre.writable,Fbe(lbe.Refactor))},description:{description:"Refactor...",args:[{name:"args",schema:Bbe}]}})}run(e,t,n){const i=ube.fromUser(n,{kind:lbe.Refactor,apply:"never"});return Vbe(t,"string"==typeof(null==n?void 0:n.kind)?i.preferred?GH(0,"No preferred refactorings for '{0}' available",n.kind):GH(0,"No refactorings for '{0}' available",n.kind):i.preferred?GH(0,"No preferred refactorings available"):GH(0,"No refactorings available"),{include:lbe.Refactor.contains(i.kind)?i.kind:lbe.None,onlyIncludePreferredActions:i.preferred},i.apply)}}),c6(class extends o6{constructor(){super({id:"editor.action.sourceAction",label:GH(0,"Source Action..."),alias:"Source Action...",precondition:g5.and(gre.writable,gre.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:g5.and(gre.writable,Fbe(lbe.Source))},description:{description:"Source Action...",args:[{name:"args",schema:Bbe}]}})}run(e,t,n){const i=ube.fromUser(n,{kind:lbe.Source,apply:"never"});return Vbe(t,"string"==typeof(null==n?void 0:n.kind)?i.preferred?GH(0,"No preferred source actions for '{0}' available",n.kind):GH(0,"No source actions for '{0}' available",n.kind):i.preferred?GH(0,"No preferred source actions available"):GH(0,"No source actions available"),{include:lbe.Source.contains(i.kind)?i.kind:lbe.None,includeSourceActions:!0,onlyIncludePreferredActions:i.preferred},i.apply)}}),c6(class extends o6{constructor(){super({id:"editor.action.organizeImports",label:GH(0,"Organize Imports"),alias:"Organize Imports",precondition:g5.and(gre.writable,Fbe(lbe.SourceOrganizeImports)),kbOpts:{kbExpr:gre.editorTextFocus,primary:1581,weight:100}})}run(e,t){return Vbe(t,GH(0,"No organize imports action available"),{include:lbe.SourceOrganizeImports,includeSourceActions:!0},"ifSingle")}}),c6(Hbe),c6(class extends o6{constructor(){super({id:"editor.action.fixAll",label:GH(0,"Fix All"),alias:"Fix All",precondition:g5.and(gre.writable,Fbe(lbe.SourceFixAll))})}run(e,t){return Vbe(t,GH(0,"No fix all action available"),{include:lbe.SourceFixAll,includeSourceActions:!0},"ifSingle")}}),l6(new class extends r6{constructor(){super({id:"editor.action.codeAction",precondition:g5.and(gre.writable,gre.hasCodeActionsProvider),description:{description:"Trigger a code action",args:[{name:"args",schema:Bbe}]}})}runEditorCommand(e,t,n){const i=ube.fromUser(n,{kind:lbe.Empty,apply:"ifSingle"});return Vbe(t,"string"==typeof(null==n?void 0:n.kind)?i.preferred?GH(0,"No preferred code actions for '{0}' available",n.kind):GH(0,"No code actions for '{0}' available",n.kind):i.preferred?GH(0,"No preferred code actions available"):GH(0,"No code actions available"),{include:i.kind,includeSourceActions:!0,onlyIncludePreferredActions:i.preferred},i.apply)}});var jbe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Gbe{constructor(){this.lenses=[],this._disposables=new pG}dispose(){this._disposables.dispose()}add(e,t){this._disposables.add(e);for(const n of e.lenses)this.lenses.push({symbol:n,provider:t})}}function Kbe(e,t){return jbe(this,void 0,void 0,(function*(){const n=FJ.ordered(e),i=new Map,r=new Gbe,o=n.map(((n,o)=>jbe(this,void 0,void 0,(function*(){i.set(n,o);try{const i=yield Promise.resolve(n.provideCodeLenses(e,t));i&&r.add(i,n)}catch(s){iG(s)}}))));return yield Promise.all(o),r.lenses=r.lenses.sort(((e,t)=>e.symbol.range.startLineNumber<t.symbol.range.startLineNumber?-1:e.symbol.range.startLineNumber>t.symbol.range.startLineNumber?1:i.get(e.provider)<i.get(t.provider)?-1:i.get(e.provider)>i.get(t.provider)?1:e.symbol.range.startColumn<t.symbol.range.startColumn?-1:e.symbol.range.startColumn>t.symbol.range.startColumn?1:0)),r}))}qZ.registerCommand("_executeCodeLensProvider",(function(e,...t){let[n,i]=t;WZ(_K.isUri(n)),WZ("number"==typeof i||!i);const r=e.get(iJ).getModel(n);if(!r)throw aG();const o=[],s=new pG;return Kbe(r,TG.None).then((e=>{s.add(e);let t=[];for(const n of e.lenses)null==i||Boolean(n.symbol.command)?o.push(n.symbol):i-- >0&&n.provider.resolveCodeLens&&t.push(Promise.resolve(n.provider.resolveCodeLens(r,n.symbol,TG.None)).then((e=>o.push(e||n.symbol))));return Promise.all(t)})).then((()=>o)).finally((()=>{setTimeout((()=>s.dispose()),100)}))}));class qbe{constructor(e,t,n){this.afterLineNumber=e,this.heightInPx=t,this._onHeight=n,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(e){void 0===this._lastHeight?this._lastHeight=e:this._lastHeight!==e&&(this._lastHeight=e,this._onHeight())}}class $be{constructor(e,t,n){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=e,this._id="codelens.widget-"+$be._idPool++,this.updatePosition(n),this._domNode=document.createElement("span"),this._domNode.className=`codelens-decoration ${t}`}withCommands(e,t){this._commands.clear();let n=[],i=!1;for(let r=0;r<e.length;r++){const t=e[r];if(t&&(i=!0,t.command)){const i=tme(t.command.title.trim());t.command.id?(n.push(GY("a",{id:String(r),title:t.command.tooltip},...i)),this._commands.set(String(r),t.command)):n.push(GY("span",{title:t.command.tooltip},...i)),r+1<e.length&&n.push(GY("span",void 0," | "))}}i?(zY(this._domNode,...n),this._isEmpty&&t&&this._domNode.classList.add("fadein"),this._isEmpty=!1):zY(this._domNode,GY("span",void 0,"no commands"))}getCommand(e){return e.parentElement===this._domNode?this._commands.get(e.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(e){const t=this._editor.getModel().getLineFirstNonWhitespaceColumn(e);this._widgetPosition={position:{lineNumber:e,column:t},preference:[1]}}getPosition(){return this._widgetPosition||null}}$be._idPool=0;class Ybe{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(e,t){this._addDecorations.push(e),this._addDecorationsCallbacks.push(t)}removeDecoration(e){this._removeDecorations.push(e)}commit(e){let t=e.deltaDecorations(this._removeDecorations,this._addDecorations);for(let n=0,i=t.length;n<i;n++)this._addDecorationsCallbacks[n](t[n])}}class Xbe{constructor(e,t,n,i,r,o,s){let a;this._isDisposed=!1,this._editor=t,this._className=n,this._data=e,this._decorationIds=[];let l=[];this._data.forEach(((e,t)=>{e.symbol.command&&l.push(e.symbol),i.addDecoration({range:e.symbol.range,options:v7.EMPTY},(e=>this._decorationIds[t]=e)),a=a?TK.plusRange(a,e.symbol.range):TK.lift(e.symbol.range)})),this._viewZone=new qbe(a.startLineNumber-1,o,s),this._viewZoneId=r.addZone(this._viewZone),l.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(l,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new $be(this._editor,this._className,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(e,t){this._decorationIds.forEach(e.removeDecoration,e),this._decorationIds=[],t&&t.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some(((e,t)=>{const n=this._editor.getModel().getDecorationRange(e),i=this._data[t].symbol;return!(!n||TK.isEmpty(i.range)!==n.isEmpty())}))}updateCodeLensSymbols(e,t){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],this._data=e,this._data.forEach(((e,n)=>{t.addDecoration({range:e.symbol.range,options:v7.EMPTY},(e=>this._decorationIds[n]=e))}))}updateHeight(e,t){this._viewZone.heightInPx=e,t.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(e){if(!this._viewZone.domNode.hasAttribute("monaco-visible-view-zone"))return null;for(let t=0;t<this._decorationIds.length;t++){const n=e.getDecorationRange(this._decorationIds[t]);n&&(this._data[t].symbol.range=n)}return this._data}updateCommands(e){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(e,!0);for(let t=0;t<this._data.length;t++){const n=e[t];if(n){const{symbol:e}=this._data[t];e.command=n.command||e.command}}}getCommand(e){var t;return null===(t=this._contentWidget)||void 0===t?void 0:t.getCommand(e)}getLineNumber(){const e=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return e?e.startLineNumber:-1}update(e){if(this.isValid()){const t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);t&&(this._viewZone.afterLineNumber=t.startLineNumber-1,e.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(t.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}getItems(){return this._data}}G5(((e,t)=>{const n=e.getColor(Sie);n&&(t.addRule(`.monaco-editor .codelens-decoration { color: ${n}; }`),t.addRule(`.monaco-editor .codelens-decoration .codicon { color: ${n}; }`));const i=e.getColor(Gte);i&&(t.addRule(`.monaco-editor .codelens-decoration > a:hover { color: ${i} !important; }`),t.addRule(`.monaco-editor .codelens-decoration > a:hover .codicon { color: ${i} !important; }`))}));const Zbe=i$("ICodeLensCache");class Qbe{constructor(e,t){this.lineCount=e,this.data=t}}let Jbe=class{constructor(e){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new sZ(20,.75);V$((()=>e.remove("codelens/cache",1)));const t="codelens/cache2",n=e.get(t,1,"{}");this._deserialize(n),Moe(e.onWillSaveState)((n=>{n.reason===ype.SHUTDOWN&&e.store(t,this._serialize(),1,1)}))}put(e,t){const n=t.lenses.map((e=>{var t;return{range:e.symbol.range,command:e.symbol.command&&{id:"",title:null===(t=e.symbol.command)||void 0===t?void 0:t.title}}})),i=new Gbe;i.add({lenses:n,dispose:()=>{}},this._fakeProvider);const r=new Qbe(e.getLineCount(),i);this._cache.set(e.uri.toString(),r)}get(e){const t=this._cache.get(e.uri.toString());return t&&t.lineCount===e.getLineCount()?t.data:void 0}delete(e){this._cache.delete(e.uri.toString())}_serialize(){const e=Object.create(null);for(const[t,n]of this._cache){const i=new Set;for(const e of n.data.lenses)i.add(e.symbol.range.startLineNumber);e[t]={lineCount:n.lineCount,lines:[...i.values()]}}return JSON.stringify(e)}_deserialize(e){try{const t=JSON.parse(e);for(const e in t){const n=t[e],i=[];for(const e of n.lines)i.push({range:new TK(e,1,e,11)});const r=new Gbe;r.add({lenses:i,dispose(){}},this._fakeProvider),this._cache.set(e,new Qbe(n.lineCount,r))}}catch(t){}}};Jbe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(0,vpe)],Jbe),cle(Zbe,Jbe);var ewe=function(e,t){return function(n,i){t(n,i,e)}},twe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let nwe=class{constructor(e,t,n,i){this._editor=e,this._commandService=t,this._notificationService=n,this._codeLensCache=i,this._disposables=new pG,this._localToDispose=new pG,this._lenses=[],this._getCodeLensModelDelays=new aJ(FJ,250,2500),this._oldCodeLensModels=new pG,this._resolveCodeLensesDelays=new aJ(FJ,250,2500),this._resolveCodeLensesScheduler=new z$((()=>this._resolveCodeLensesInViewport()),this._resolveCodeLensesDelays.min),this._disposables.add(this._editor.onDidChangeModel((()=>this._onModelChange()))),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>this._onModelChange()))),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(40)||e.hasChanged(14)||e.hasChanged(13))&&this._updateLensStyle(),e.hasChanged(12)&&this._onModelChange()}))),this._disposables.add(FJ.onDidChange(this._onModelChange,this)),this._onModelChange(),this._styleClassName="_"+LQ(this._editor.getId()).toString(16),this._styleElement=NY(kY(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0),this._updateLensStyle()}dispose(){var e;this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),null===(e=this._currentCodeLensModel)||void 0===e||e.dispose(),this._styleElement.remove()}_getLayoutInfo(){let e,t=this._editor.getOption(14);return!t||t<5?(t=.9*this._editor.getOption(42)|0,e=this._editor.getOption(56)):e=t*Math.max(1.3,this._editor.getOption(56)/this._editor.getOption(42))|0,{codeLensHeight:e,fontSize:t}}_updateLensStyle(){const{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),n=this._editor.getOption(13),i=this._editor.getOption(40),r=`--codelens-font-family${this._styleClassName}`,o=`--codelens-font-features${this._styleClassName}`;let s=`\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} { line-height: ${e}px; font-size: ${t}px; padding-right: ${Math.round(.5*t)}px; font-feature-settings: var(${o}) }\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} span.codicon { line-height: ${e}px; font-size: ${t}px; }\n\t\t`;n&&(s+=`.monaco-editor .codelens-decoration.${this._styleClassName} { font-family: var(${r})}`),this._styleElement.textContent=s,this._editor.getContainerDomNode().style.setProperty(r,null!=n?n:"inherit"),this._editor.getContainerDomNode().style.setProperty(o,i.fontFeatureSettings),this._editor.changeViewZones((t=>{for(let n of this._lenses)n.updateHeight(e,t)}))}_localDispose(){var e,t,n;null===(e=this._getCodeLensModelPromise)||void 0===e||e.cancel(),this._getCodeLensModelPromise=void 0,null===(t=this._resolveCodeLensesPromise)||void 0===t||t.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),null===(n=this._currentCodeLensModel)||void 0===n||n.dispose()}_onModelChange(){this._localDispose();const e=this._editor.getModel();if(!e)return;if(!this._editor.getOption(12))return;const t=this._codeLensCache.get(e);if(t&&this._renderCodeLensSymbols(t),!FJ.has(e))return void(t&&this._localToDispose.add(P$((()=>{const n=this._codeLensCache.get(e);t===n&&(this._codeLensCache.delete(e),this._onModelChange())}),3e4)));for(const i of FJ.all(e))if("function"==typeof i.onDidChange){let e=i.onDidChange((()=>n.schedule()));this._localToDispose.add(e)}const n=new z$((()=>{var t;const i=Date.now();null===(t=this._getCodeLensModelPromise)||void 0===t||t.cancel(),this._getCodeLensModelPromise=I$((t=>Kbe(e,t))),this._getCodeLensModelPromise.then((t=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=t,this._codeLensCache.put(e,t);const r=this._getCodeLensModelDelays.update(e,Date.now()-i);n.delay=r,this._renderCodeLensSymbols(t),this._resolveCodeLensesInViewport()}),nG)}),this._getCodeLensModelDelays.get(e));this._localToDispose.add(n),this._localToDispose.add(gG((()=>this._resolveCodeLensesScheduler.cancel()))),this._localToDispose.add(this._editor.onDidChangeModelContent((()=>{this._editor.changeDecorations((e=>{this._editor.changeViewZones((t=>{let n=[],i=-1;this._lenses.forEach((e=>{e.isValid()&&i!==e.getLineNumber()?(e.update(t),i=e.getLineNumber()):n.push(e)}));let r=new Ybe;n.forEach((e=>{e.dispose(r,t),this._lenses.splice(this._lenses.indexOf(e),1)})),r.commit(e)}))})),n.schedule()}))),this._localToDispose.add(this._editor.onDidFocusEditorWidget((()=>{n.schedule()}))),this._localToDispose.add(this._editor.onDidScrollChange((e=>{e.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()}))),this._localToDispose.add(this._editor.onDidLayoutChange((()=>{this._resolveCodeLensesInViewportSoon()}))),this._localToDispose.add(gG((()=>{if(this._editor.getModel()){const e=mle.capture(this._editor);this._editor.changeDecorations((e=>{this._editor.changeViewZones((t=>{this._disposeAllLenses(e,t)}))})),e.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)}))),this._localToDispose.add(this._editor.onMouseDown((e=>{if(9!==e.target.type)return;let t=e.target.element;if("SPAN"===(null==t?void 0:t.tagName)&&(t=t.parentElement),"A"===(null==t?void 0:t.tagName))for(const n of this._lenses){let e=n.getCommand(t);if(e){this._commandService.executeCommand(e.id,...e.arguments||[]).catch((e=>this._notificationService.error(e)));break}}}))),n.schedule()}_disposeAllLenses(e,t){const n=new Ybe;for(const i of this._lenses)i.dispose(n,t);e&&n.commit(e),this._lenses.length=0}_renderCodeLensSymbols(e){if(!this._editor.hasModel())return;let t,n=this._editor.getModel().getLineCount(),i=[];for(let s of e.lenses){let e=s.symbol.range.startLineNumber;e<1||e>n||(t&&t[t.length-1].symbol.range.startLineNumber===e?t.push(s):(t=[s],i.push(t)))}const r=mle.capture(this._editor),o=this._getLayoutInfo();this._editor.changeDecorations((e=>{this._editor.changeViewZones((t=>{const n=new Ybe;let r=0,s=0;for(;s<i.length&&r<this._lenses.length;){let e=i[s][0].symbol.range.startLineNumber,a=this._lenses[r].getLineNumber();a<e?(this._lenses[r].dispose(n,t),this._lenses.splice(r,1)):a===e?(this._lenses[r].updateCodeLensSymbols(i[s],n),s++,r++):(this._lenses.splice(r,0,new Xbe(i[s],this._editor,this._styleClassName,n,t,o.codeLensHeight,(()=>this._resolveCodeLensesInViewportSoon()))),r++,s++)}for(;r<this._lenses.length;)this._lenses[r].dispose(n,t),this._lenses.splice(r,1);for(;s<i.length;)this._lenses.push(new Xbe(i[s],this._editor,this._styleClassName,n,t,o.codeLensHeight,(()=>this._resolveCodeLensesInViewportSoon()))),s++;n.commit(e)}))})),r.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){var e;null===(e=this._resolveCodeLensesPromise)||void 0===e||e.cancel(),this._resolveCodeLensesPromise=void 0;const t=this._editor.getModel();if(!t)return;const n=[],i=[];if(this._lenses.forEach((e=>{const r=e.computeIfNecessary(t);r&&(n.push(r),i.push(e))})),0===n.length)return;const r=Date.now(),o=I$((e=>{const r=n.map(((n,r)=>{const o=new Array(n.length),s=n.map(((n,i)=>n.symbol.command||"function"!=typeof n.provider.resolveCodeLens?(o[i]=n.symbol,Promise.resolve(void 0)):Promise.resolve(n.provider.resolveCodeLens(t,n.symbol,e)).then((e=>{o[i]=e}),iG)));return Promise.all(s).then((()=>{e.isCancellationRequested||i[r].isDisposed()||i[r].updateCommands(o)}))}));return Promise.all(r)}));this._resolveCodeLensesPromise=o,this._resolveCodeLensesPromise.then((()=>{const e=this._resolveCodeLensesDelays.update(t,Date.now()-r);this._resolveCodeLensesScheduler.delay=e,this._currentCodeLensModel&&this._codeLensCache.put(t,this._currentCodeLensModel),this._oldCodeLensModels.clear(),o===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)}),(e=>{nG(e),o===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)}))}getLenses(){return this._lenses}};function iwe(e,t,n,i){return Promise.resolve(n.provideColorPresentations(e,t,i))}nwe.ID="css.editor.codeLens",nwe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ewe(1,KZ),ewe(2,g4),ewe(3,Zbe)],nwe),d6(nwe.ID,nwe),c6(class extends o6{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:gre.hasCodeLensProvider,label:GH(0,"Show CodeLens Commands For Current Line"),alias:"Show CodeLens Commands For Current Line"})}run(e,t){return twe(this,void 0,void 0,(function*(){if(!t.hasModel())return;const n=e.get(Jme),i=e.get(KZ),r=e.get(g4),o=t.getSelection().positionLineNumber,s=t.getContribution(nwe.ID),a=[];for(let e of s.getLenses())if(e.getLineNumber()===o)for(let t of e.getItems()){const{command:e}=t.symbol;e&&a.push({label:e.title,command:e})}if(0===a.length)return;const l=yield n.pick(a,{canPickMany:!1});if(l)try{yield i.executeCommand(l.command.id,...l.command.arguments||[])}catch(c){r.error(c)}}))}}),qZ.registerCommand("_executeDocumentColorProvider",(function(e,...t){const[n]=t;if(!(n instanceof _K))throw aG();const i=e.get(iJ).getModel(n);if(!i)throw aG();const r=[],o=jJ.ordered(i).reverse().map((e=>Promise.resolve(e.provideDocumentColors(i,TG.None)).then((e=>{if(Array.isArray(e))for(let t of e)r.push({range:t.range,color:[t.color.red,t.color.green,t.color.blue,t.color.alpha]})}))));return Promise.all(o).then((()=>r))})),qZ.registerCommand("_executeColorPresentationProvider",(function(e,...t){const[n,i]=t,{uri:r,range:o}=i;if(!(r instanceof _K&&Array.isArray(n)&&4===n.length&&TK.isIRange(o)))throw aG();const[s,a,l,c]=n,u=e.get(iJ).getModel(r);if(!u)throw aG();const h={range:o,color:{red:s,green:a,blue:l,alpha:c}},d=[],f=jJ.ordered(u).reverse().map((e=>Promise.resolve(e.provideColorPresentations(u,h,TG.None)).then((e=>{Array.isArray(e)&&d.push(...e)}))));return Promise.all(f).then((()=>d))}));var rwe=function(e,t){return function(n,i){t(n,i,e)}};let owe=class e extends mG{constructor(e,t,n){super(),this._editor=e,this._codeEditorService=t,this._configurationService=n,this._localToDispose=this._register(new pG),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=[],this._decorationsTypes=new Set,this._register(e.onDidChangeModel((()=>{this._isEnabled=this.isEnabled(),this.onModelChanged()}))),this._register(e.onDidChangeModelLanguage((()=>this.onModelChanged()))),this._register(jJ.onDidChange((()=>this.onModelChanged()))),this._register(e.onDidChangeConfiguration((()=>{let e=this._isEnabled;this._isEnabled=this.isEnabled(),e!==this._isEnabled&&(this._isEnabled?this.onModelChanged():this.removeAllDecorations())}))),this._timeoutTimer=null,this._computePromise=null,this._isEnabled=this.isEnabled(),this.onModelChanged()}isEnabled(){const e=this._editor.getModel();if(!e)return!1;const t=e.getLanguageIdentifier(),n=this._configurationService.getValue(t.language);if(n){const e=n.colorDecorators;if(e&&void 0!==e.enable&&!e.enable)return e.enable}return this._editor.getOption(15)}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}onModelChanged(){if(this.stop(),!this._isEnabled)return;const t=this._editor.getModel();t&&jJ.has(t)&&(this._localToDispose.add(this._editor.onDidChangeModelContent((()=>{this._timeoutTimer||(this._timeoutTimer=new B$,this._timeoutTimer.cancelAndSet((()=>{this._timeoutTimer=null,this.beginCompute()}),e.RECOMPUTE_TIME))}))),this.beginCompute())}beginCompute(){this._computePromise=I$((e=>{const t=this._editor.getModel();return t?function(e,t){const n=[],i=jJ.ordered(e).reverse().map((i=>Promise.resolve(i.provideDocumentColors(e,t)).then((e=>{if(Array.isArray(e))for(let t of e)n.push({colorInfo:t,provider:i})}))));return Promise.all(i).then((()=>n))}(t,e):Promise.resolve([])})),this._computePromise.then((e=>{this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null}),nG)}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(e){const t=e.map((e=>({range:{startLineNumber:e.colorInfo.range.startLineNumber,startColumn:e.colorInfo.range.startColumn,endLineNumber:e.colorInfo.range.endLineNumber,endColumn:e.colorInfo.range.endColumn},options:v7.EMPTY})));this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach(((t,n)=>this._colorDatas.set(t,e[n])))}updateColorDecorators(e){let t=[],n={};for(let i=0;i<e.length&&t.length<500;i++){const{red:r,green:o,blue:s,alpha:a}=e[i].colorInfo.color,l=new Y8(Math.round(255*r),Math.round(255*o),Math.round(255*s),a);let c=LQ(`rgba(${l.r},${l.g},${l.b},${l.a})`).toString(16),u=`rgba(${l.r}, ${l.g}, ${l.b}, ${l.a})`,h="colorBox-"+c;this._decorationsTypes.has(h)||n[h]||this._codeEditorService.registerDecorationType("color-detector-color",h,{before:{contentText:" ",border:"solid 0.1em #000",margin:"0.1em 0.2em 0 0.2em",width:"0.8em",height:"0.8em",backgroundColor:u},dark:{before:{border:"solid 0.1em #eee"}}},void 0,this._editor),n[h]=!0,t.push({range:{startLineNumber:e[i].colorInfo.range.startLineNumber,startColumn:e[i].colorInfo.range.startColumn,endLineNumber:e[i].colorInfo.range.endLineNumber,endColumn:e[i].colorInfo.range.endColumn},options:this._codeEditorService.resolveDecorationOptions(h,!0)})}this._decorationsTypes.forEach((e=>{n[e]||this._codeEditorService.removeDecorationType(e)})),this._colorDecoratorIds=this._editor.deltaDecorations(this._colorDecoratorIds,t)}removeAllDecorations(){this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,[]),this._colorDecoratorIds=this._editor.deltaDecorations(this._colorDecoratorIds,[]),this._decorationsTypes.forEach((e=>{this._codeEditorService.removeDecorationType(e)}))}getColorData(e){const t=this._editor.getModel();if(!t)return null;const n=t.getDecorationsInRange(TK.fromPositions(e,e)).filter((e=>this._colorDatas.has(e.id)));return 0===n.length?null:this._colorDatas.get(n[0].id)}};owe.ID="editor.contrib.colorDetector",owe.RECOMPUTE_TIME=1e3,owe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([rwe(1,o$),rwe(2,j3)],owe),d6(owe.ID,owe);class swe{constructor(e,t,n,i,r){this._computer=e,this._state=0,this._hoverTime=r,this._firstWaitScheduler=new z$((()=>this._triggerAsyncComputation()),0),this._secondWaitScheduler=new z$((()=>this._triggerSyncComputation()),0),this._loadingMessageScheduler=new z$((()=>this._showLoadingMessage()),0),this._asyncComputationPromise=null,this._asyncComputationPromiseDone=!1,this._completeCallback=t,this._errorCallback=n,this._progressCallback=i}setHoverTime(e){this._hoverTime=e}_firstWaitTime(){return this._hoverTime/2}_secondWaitTime(){return this._hoverTime/2}_loadingMessageTime(){return 3*this._hoverTime}_triggerAsyncComputation(){this._state=2,this._secondWaitScheduler.schedule(this._secondWaitTime()),this._computer.computeAsync?(this._asyncComputationPromiseDone=!1,this._asyncComputationPromise=I$((e=>this._computer.computeAsync(e))),this._asyncComputationPromise.then((e=>{this._asyncComputationPromiseDone=!0,this._withAsyncResult(e)}),(e=>this._onError(e)))):this._asyncComputationPromiseDone=!0}_triggerSyncComputation(){this._computer.computeSync&&this._computer.onResult(this._computer.computeSync(),!0),this._asyncComputationPromiseDone?(this._state=0,this._onComplete(this._computer.getResult())):(this._state=3,this._onProgress(this._computer.getResult()))}_showLoadingMessage(){3===this._state&&this._onProgress(this._computer.getResultWithLoadingMessage())}_withAsyncResult(e){e&&this._computer.onResult(e,!1),3===this._state&&(this._state=0,this._onComplete(this._computer.getResult()))}_onComplete(e){this._completeCallback(e)}_onError(e){this._errorCallback?this._errorCallback(e):nG(e)}_onProgress(e){this._progressCallback(e)}start(e){if(0===e)0===this._state&&(this._state=1,this._firstWaitScheduler.schedule(this._firstWaitTime()),this._loadingMessageScheduler.schedule(this._loadingMessageTime()));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation()}}cancel(){this._loadingMessageScheduler.cancel(),1===this._state&&this._firstWaitScheduler.cancel(),2===this._state&&(this._secondWaitScheduler.cancel(),this._asyncComputationPromise&&(this._asyncComputationPromise.cancel(),this._asyncComputationPromise=null)),3===this._state&&this._asyncComputationPromise&&(this._asyncComputationPromise.cancel(),this._asyncComputationPromise=null),this._state=0}}const awe=GY;class lwe extends mG{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this._scrollbar=this._register(new moe(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this._scrollbar.getDomNode())}onContentsChanged(){this._scrollbar.scanDomNode()}}class cwe extends mG{constructor(e,t,n){super(),this.actionContainer=WY(e,awe("div.action-container")),this.action=WY(this.actionContainer,awe("a.action")),this.action.setAttribute("href","#"),this.action.setAttribute("role","button"),t.iconClass&&WY(this.action,awe(`span.icon.${t.iconClass}`));WY(this.action,awe("span")).textContent=n?`${t.label} (${n})`:t.label,this._register(Q$(this.actionContainer,RY.CLICK,(e=>{e.stopPropagation(),e.preventDefault(),t.run(this.actionContainer)}))),this.setEnabled(!0)}static render(e,t,n){return new cwe(e,t,n)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function uwe(e){if(!e)return;"string"==typeof e&&(e=_K.file(e));const t=EZ(e)||(e.scheme===j$.file?e.fsPath:e.path);return aj&&function(e){const t=sK(e);return aj?!(e.length>3)&&bZ(t)&&(2===e.length||92===t.charCodeAt(2)):t===oK.sep}(t)?hwe(t):t}function hwe(e){return bZ(e)?e.charAt(0).toUpperCase()+e.slice(1):e}var dwe=function(e,t){return function(n,i){t(n,i,e)}};let fwe=class extends zae{constructor(e,t,n,i,r,o,s,a,l,c){super(e,Object.assign(Object.assign({},n.getRawOptions()),{overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()}),{},i,r,o,s,a,l,c),this._parentEditor=n,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration((e=>this._onParentConfigurationChanged(e))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){hQ(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};fwe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([dwe(3,t$),dwe(4,o$),dwe(5,KZ),dwe(6,A5),dwe(7,B5),dwe(8,g4),dwe(9,yae)],fwe);const gwe=new Q8(new Y8(0,122,204)),pwe={showArrow:!0,showFrame:!0,className:"",frameColor:gwe,arrowColor:gwe,keepEditorSelection:!1};class mwe{constructor(e,t,n,i,r,o){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=n,this.heightInLines=i,this._onDomNodeTop=r,this._onComputedHeight=o}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class vwe{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class ywe{constructor(e){this._editor=e,this._ruleName=ywe._IdGenerator.nextId(),this._decorations=[],this._color=null,this._height=-1}dispose(){this.hide(),AY(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){AY(this._ruleName),MY(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(e){this._decorations=this._editor.deltaDecorations(this._decorations,[{range:TK.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._editor.deltaDecorations(this._decorations,[])}}ywe._IdGenerator=new ume(".arrow-decoration-");class _we extends a5{constructor(e,t){super(),this._onDidChangeVisibility=new EG,this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=WY(e,GY(".monaco-dropdown")),this._label=WY(this._element,GY(".dropdown-label"));let n=t.labelRenderer;n||(n=e=>(e.textContent=t.label||"",null));for(const r of[RY.CLICK,RY.MOUSE_DOWN,M6.Tap])this._register(Q$(this.element,r,(e=>PY(e,!0))));for(const r of[RY.MOUSE_DOWN,M6.Tap])this._register(Q$(this._label,r,(e=>{e instanceof MouseEvent&&e.detail>1||(this.visible?this.hide():this.show())})));this._register(Q$(this._label,RY.KEY_UP,(e=>{const t=new C$(e);(t.equals(3)||t.equals(10))&&(PY(e,!0),this.visible?this.hide():this.show())})));const i=n(this._label);i&&this._register(i),this._register(O6.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class bwe extends _we{constructor(e,t){super(e,t),this._actions=[],this._contextMenuProvider=t.contextMenuProvider,this.actions=t.actions||[],this.actionProvider=t.actionProvider,this.menuClassName=t.menuClassName||"",this.menuAsChild=!!t.menuAsChild}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this.actionProvider?this.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:e=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this.menuClassName,onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this.menuAsChild?this.element:void 0})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class wwe extends ble{constructor(e,t,n,i=Object.create(null)){super(null,e,i),this.actionItem=null,this._onDidChangeVisibility=this._register(new EG),this.menuActionsOrProvider=t,this.contextMenuProvider=n,this.options=i,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:e=>{this.element=WY(e,GY("a.action-label"));let t=[];return"string"==typeof this.options.classNames?t=this.options.classNames.split(/\s+/g).filter((e=>!!e)):this.options.classNames&&(t=this.options.classNames),t.find((e=>"icon"===e))||t.push("codicon"),this.element.classList.add(...t),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this.element.title=this._action.label||"",null},menuAsChild:this.options.menuAsChild,actions:t?this.menuActionsOrProvider:void 0,actionProvider:t?void 0:this.menuActionsOrProvider};if(this.dropdownMenu=this._register(new bwe(e,n)),this._register(this.dropdownMenu.onDidChangeVisibility((e=>{var t;null===(t=this.element)||void 0===t||t.setAttribute("aria-expanded",`${e}`),this._onDidChangeVisibility.fire(e)}))),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const e=this;this.dropdownMenu.menuOptions=Object.assign(Object.assign({},this.dropdownMenu.menuOptions),{get anchorAlignment(){return e.options.anchorAlignmentProvider()}})}this.updateEnabled()}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}updateEnabled(){var e,t;const n=!this.getAction().enabled;null===(e=this.actionItem)||void 0===e||e.classList.toggle("disabled",n),null===(t=this.element)||void 0===t||t.classList.toggle("disabled",n)}}var Cwe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Swe=function(e,t){return function(n,i){t(n,i,e)}},xwe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function Ewe(e,t,n,i,r,o,s){const a=e.getActions(t);return function(e,t,n,i=(e=>"navigation"===e),r=Number.MAX_SAFE_INTEGER,o=(()=>!1),s=!1){let a,l;Array.isArray(t)?(a=t,l=t):(a=t.primary,l=t.secondary);const c=new Set;for(const[u,h]of e){let e;i(u)?(e=a,e.length>0&&s&&e.push(new l5)):(e=l,e.length>0&&e.push(new l5));for(let t of h){n&&(t=t instanceof J5&&t.alt?t.alt:t);const i=e.push(t);t instanceof c5&&c.add({group:u,action:t,index:i-1})}}for(const{group:u,action:h,index:d}of c){const e=i(u)?a:l,t=h.actions;(t.length<=1||e.length+t.length-2<=r)&&o(h,u,e.length)&&e.splice(d,1,...t)}if(a!==l&&a.length>r){const e=a.splice(r,a.length-r);l.unshift(...e,new l5)}}(a,n,!1,"string"==typeof i?e=>e===i:i,r,o,s),function(e){const t=new pG;for(const[,n]of e)for(const e of n)t.add(e);return t}(a)}let kwe=class extends wle{constructor(e,t,n,i,r){super(void 0,e,{icon:!(!e.class&&!e.item.icon),label:!e.class&&!e.item.icon,draggable:null==t?void 0:t.draggable}),this._keybindingService=n,this._notificationService=i,this._contextKeyService=r,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new vG),this._altKey=JY.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}onClick(e){return xwe(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();try{yield this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}))}render(e){super.render(e),e.classList.add("menu-entry"),this._updateItemClass(this._menuItemAction.item);let t=!1,n=this._altKey.keyStatus.altKey||(aj||cj)&&this._altKey.keyStatus.shiftKey;const i=()=>{const e=t&&n;e!==this._wantsAltCommand&&(this._wantsAltCommand=e,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._menuItemAction.alt&&this._register(this._altKey.event((e=>{n=e.altKey||(aj||cj)&&e.shiftKey,i()}))),this._register(Q$(e,"mouseleave",(e=>{t=!1,i()}))),this._register(Q$(e,"mouseenter",(e=>{t=!0,i()})))}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}updateTooltip(){if(this.label){const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),n=this._commandAction.tooltip||this._commandAction.label;let i=t?GH(0,"{0} ({1})",n,t):n;if(!this._wantsAltCommand&&this._menuItemAction.alt){const e=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,t=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),n=t&&t.getLabel(),r=n?GH(0,"{0} ({1})",e,n):e;i+=`\n[${u4.modifierLabels[pj].altKey}] ${r}`}this.label.title=i}}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){var t;this._itemClassDispose.value=void 0;const{element:n,label:i}=this;if(!n||!i)return;const r=this._commandAction.checked&&(null===(t=e.toggled)||void 0===t?void 0:t.icon)?e.toggled.icon:e.icon;if(r)if(z5.isThemeIcon(r)){const e=z5.asClassNameArray(r);i.classList.add(...e),this._itemClassDispose.value=gG((()=>{i.classList.remove(...e)}))}else r.light&&i.style.setProperty("--menu-entry-icon-light",ZY(r.light)),r.dark&&i.style.setProperty("--menu-entry-icon-dark",ZY(r.dark)),i.classList.add("icon"),this._itemClassDispose.value=gG((()=>{i.classList.remove("icon"),i.style.removeProperty("--menu-entry-icon-light"),i.style.removeProperty("--menu-entry-icon-dark")}))}};kwe=Cwe([Swe(2,gce),Swe(3,g4),Swe(4,A5)],kwe);let Lwe=class extends wwe{constructor(e,t){super(e,{getActions:()=>e.actions},t,{menuAsChild:!0,classNames:z5.isThemeIcon(e.item.icon)?z5.asClassName(e.item.icon):void 0})}render(e){if(super.render(e),this.element){e.classList.add("menu-entry");const{icon:t}=this._action.item;t&&!z5.isThemeIcon(t)&&(this.element.classList.add("icon"),t.light&&this.element.style.setProperty("--menu-entry-icon-light",ZY(t.light)),t.dark&&this.element.style.setProperty("--menu-entry-icon-dark",ZY(t.dark)))}}};function Dwe(e,t){return t instanceof J5?e.createInstance(kwe,t,void 0):t instanceof Q5?e.createInstance(Lwe,t):void 0}Lwe=Cwe([Swe(1,Wle)],Lwe);var Nwe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Iwe=function(e,t){return function(n,i){t(n,i,e)}};const Twe=i$("IPeekViewService");var Mwe,Awe;cle(Twe,class{constructor(){this._widgets=new Map}addExclusiveWidget(e,t){const n=this._widgets.get(e);n&&(n.listener.dispose(),n.widget.dispose());this._widgets.set(e,{widget:t,listener:t.onDidClose((()=>{const n=this._widgets.get(e);n&&n.widget===t&&(n.listener.dispose(),this._widgets.delete(e))}))})}}),(Awe=Mwe||(Mwe={})).inPeekEditor=new M5("inReferenceSearchEditor",!0,GH(0,"Whether the current code editor is embedded inside peek")),Awe.notInPeekEditor=Awe.inPeekEditor.toNegated();let Owe=class{constructor(e,t){e instanceof fwe&&Mwe.inPeekEditor.bindTo(t)}dispose(){}};Owe.ID="editor.contrib.referenceController",Owe=Nwe([Iwe(1,A5)],Owe),d6(Owe.ID,Owe);const Rwe={headerBackgroundColor:Q8.white,primaryHeadingColor:Q8.fromHex("#333333"),secondaryHeadingColor:Q8.fromHex("#6c6c6cb3")};let Pwe=class extends class{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._positionMarkerId=[],this._viewZone=null,this._disposables=new pG,this.container=null,this._isShowing=!1,this.editor=e,this.options=aQ(t),hQ(this.options,pwe,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange((e=>{const t=this._getWidth(e);this.domNode.style.width=t+"px",this.domNode.style.left=this._getLeft(e)+"px",this._onWidth(t)})))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones((e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null})),this.editor.deltaDecorations(this._positionMarkerId,[]),this._positionMarkerId=[],this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new ywe(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){let e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){let e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&0===e.minimap.minimapLeft?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){if(this.domNode.style.height=`${e}px`,this.container){let t=e-this._decoratingElementsHeight();this.container.style.height=`${t}px`;const n=this.editor.getLayoutInfo();this._doLayout(t,this._getWidth(n))}this._resizeSash&&this._resizeSash.layout()}get position(){const[e]=this._positionMarkerId;if(!e)return;const t=this.editor.getModel();if(!t)return;const n=t.getDecorationRange(e);return n?n.getStartPosition():void 0}show(e,t){const n=TK.isIRange(e)?TK.lift(e):TK.fromPositions(e);this._isShowing=!0,this._showImpl(n,t),this._isShowing=!1,this._positionMarkerId=this.editor.deltaDecorations(this._positionMarkerId,[{range:n,options:v7.EMPTY}])}hide(){this._viewZone&&(this.editor.changeViewZones((e=>{this._viewZone&&e.removeZone(this._viewZone.id)})),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._arrow&&this._arrow.hide()}_decoratingElementsHeight(){let e=this.editor.getOption(56),t=0;if(this.options.showArrow){t+=2*Math.round(e/3)}if(this.options.showFrame){t+=2*Math.round(e/9)}return t}_showImpl(e,t){const n=e.getStartPosition(),i=this.editor.getLayoutInfo(),r=this._getWidth(i);this.domNode.style.width=`${r}px`,this.domNode.style.left=this._getLeft(i)+"px";const o=document.createElement("div");o.style.overflow="hidden";const s=this.editor.getOption(56),a=Math.max(12,this.editor.getLayoutInfo().height/s*.8);t=Math.min(t,a);let l=0,c=0;if(this._arrow&&this.options.showArrow&&(l=Math.round(s/3),this._arrow.height=l,this._arrow.show(n)),this.options.showFrame&&(c=Math.round(s/9)),this.editor.changeViewZones((e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new mwe(o,n.lineNumber,n.column,t,(e=>this._onViewZoneTop(e)),(e=>this._onViewZoneHeight(e))),this._viewZone.id=e.addZone(this._viewZone),this._overlayWidget=new vwe("vs.editor.contrib.zoneWidget"+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)})),this.container&&this.options.showFrame){const e=this.options.frameWidth?this.options.frameWidth:c;this.container.style.borderTopWidth=e+"px",this.container.style.borderBottomWidth=e+"px"}let u=t*s-this._decoratingElementsHeight();this.container&&(this.container.style.top=l+"px",this.container.style.height=u+"px",this.container.style.overflow="hidden"),this._doLayout(u,r),this.options.keepEditorSelection||this.editor.setSelection(e);const h=this.editor.getModel();if(h){const t=e.endLineNumber+1;t<=h.getLineCount()?this.revealLine(t,!1):this.revealLine(h.getLineCount(),!0)}}revealLine(e,t){t?this.editor.revealLineInCenter(e,0):this.editor.revealLine(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones((t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))}))}_initSash(){if(this._resizeSash)return;let e;this._resizeSash=this._disposables.add(new sle(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.hide(),this._resizeSash.state=0),this._disposables.add(this._resizeSash.onDidStart((t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})}))),this._disposables.add(this._resizeSash.onDidEnd((()=>{e=void 0}))),this._disposables.add(this._resizeSash.onDidChange((t=>{if(e){let n=(t.currentY-e.startY)/this.editor.getOption(56),i=n<0?Math.ceil(n):Math.floor(n),r=e.heightInLines+i;r>5&&r<35&&this._relayout(r)}})))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(null===this.domNode.style.height?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}{constructor(e,t,n){super(e,t),this.instantiationService=n,this._onDidClose=new EG,this.onDidClose=this._onDidClose.event,hQ(this.options,Rwe,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){let t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();let e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=GY(".head"),this._bodyElement=GY(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){const n=GY(".peekview-title");WY(this._headElement,n),eY(n,"click",(e=>this._onTitleClick(e))),this._fillTitleIcon(n),this._primaryHeading=GY("span.filename"),this._secondaryHeading=GY("span.dirname"),this._metaHeading=GY("span.meta"),WY(n,this._primaryHeading,this._secondaryHeading,this._metaHeading);const i=GY(".peekview-actions");WY(this._headElement,i);const r=this._getActionBarOptions();this._actionbarWidget=new Sle(i,r),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new s5("peekview.close",GH(0,"Close"),hJ.close.classNames,!0,(()=>(this.dispose(),Promise.resolve()))),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:Dwe.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:Y$(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,KY(this._metaHeading)):qY(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0)return void this.dispose();const n=Math.ceil(1.2*this.editor.getOption(56)),i=Math.round(e-(n+2));this._doLayoutHead(n,t),this._doLayoutBody(i,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};Pwe=Nwe([Iwe(2,t$)],Pwe);const Fwe=_ee("peekViewTitle.background",{dark:"#1E1E1E",light:"#FFFFFF",hc:"#0C141F"},GH(0,"Background color of the peek view title area.")),Bwe=_ee("peekViewTitleLabel.foreground",{dark:"#FFFFFF",light:"#333333",hc:"#FFFFFF"},GH(0,"Color of the peek view title.")),Wwe=_ee("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161e6",hc:"#FFFFFF99"},GH(0,"Color of the peek view title info.")),zwe=_ee("peekView.border",{dark:"#007acc",light:"#007acc",hc:xee},GH(0,"Color of the peek view borders and arrow.")),Vwe=_ee("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hc:Q8.black},GH(0,"Background color of the peek view result list.")),Uwe=_ee("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hc:Q8.white},GH(0,"Foreground color for line nodes in the peek view result list.")),Hwe=_ee("peekViewResult.fileForeground",{dark:Q8.white,light:"#1E1E1E",hc:Q8.white},GH(0,"Foreground color for file nodes in the peek view result list.")),jwe=_ee("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hc:null},GH(0,"Background color of the selected entry in the peek view result list.")),Gwe=_ee("peekViewResult.selectionForeground",{dark:Q8.white,light:"#6C6C6C",hc:Q8.white},GH(0,"Foreground color of the selected entry in the peek view result list.")),Kwe=_ee("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hc:Q8.black},GH(0,"Background color of the peek view editor.")),qwe=_ee("peekViewEditorGutter.background",{dark:Kwe,light:Kwe,hc:Kwe},GH(0,"Background color of the gutter in the peek view editor.")),$we=_ee("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hc:null},GH(0,"Match highlight color in the peek view result list.")),Ywe=_ee("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hc:null},GH(0,"Match highlight color in the peek view editor.")),Xwe=_ee("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hc:Eee},GH(0,"Match highlight border in the peek view editor."));var Zwe;(Zwe||(Zwe={})).className=function(e){switch(e){case r3.Ignore:return"severity-ignore "+hJ.info.classNames;case r3.Info:return hJ.info.classNames;case r3.Warning:return hJ.warning.classNames;case r3.Error:return hJ.error.classNames;default:return""}},G5(((e,t)=>{const n=e.getColor(Xne);if(n){const e=hJ.error.cssSelector;t.addRule(`\n\t\t\t.monaco-editor .zone-widget ${e},\n\t\t\t.markers-panel .marker-icon${e},\n\t\t\t.text-search-provider-messages .providerMessage ${e},\n\t\t\t.extensions-viewlet > .extensions ${e} {\n\t\t\t\tcolor: ${n};\n\t\t\t}\n\t\t`)}const i=e.getColor(Zne);if(i){const e=hJ.warning.cssSelector;t.addRule(`\n\t\t\t.monaco-editor .zone-widget ${e},\n\t\t\t.markers-panel .marker-icon${e},\n\t\t\t.extensions-viewlet > .extensions ${e},\n\t\t\t.extension-editor ${e},\n\t\t\t.text-search-provider-messages .providerMessage ${e},\n\t\t\t.preferences-editor ${e} {\n\t\t\t\tcolor: ${i};\n\t\t\t}\n\t\t`)}const r=e.getColor(Qne);if(r){const e=hJ.info.cssSelector;t.addRule(`\n\t\t\t.monaco-editor .zone-widget ${e},\n\t\t\t.markers-panel .marker-icon${e},\n\t\t\t.extensions-viewlet > .extensions ${e},\n\t\t\t.text-search-provider-messages .providerMessage ${e},\n\t\t\t.extension-editor ${e} {\n\t\t\t\tcolor: ${r};\n\t\t\t}\n\t\t`)}}));var Qwe=function(e,t){return function(n,i){t(n,i,e)}};class Jwe{constructor(e,t,n,i,r){this._openerService=i,this._labelService=r,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new pG,this._editor=t;const o=document.createElement("div");o.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),o.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),o.appendChild(this._relatedBlock),this._disposables.add(eY(this._relatedBlock,"click",(e=>{e.preventDefault();const t=this._relatedDiagnostics.get(e.target);t&&n(t)}))),this._scrollable=new goe(o,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:3,verticalScrollbarSize:3}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll((e=>{o.style.left=`-${e.scrollLeft}px`,o.style.top=`-${e.scrollTop}px`}))),this._disposables.add(this._scrollable)}dispose(){dG(this._disposables)}update(e){const{source:t,message:n,relatedInformation:i,code:r}=e;let o=((null==t?void 0:t.length)||0)+"()".length;r&&(o+="string"==typeof r?r.length:r.value.length);const s=uX(n);this._lines=s.length,this._longestLineLength=0;for(const h of s)this._longestLineLength=Math.max(h.length+o,this._longestLineLength);Y$(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let a=this._messageBlock;for(const h of s)a=document.createElement("div"),a.innerText=h,""===h&&(a.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(a);if(t||r){const e=document.createElement("span");if(e.classList.add("details"),a.appendChild(e),t){const n=document.createElement("span");n.innerText=t,n.classList.add("source"),e.appendChild(n)}if(r)if("string"==typeof r){const t=document.createElement("span");t.innerText=`(${r})`,t.classList.add("code"),e.appendChild(t)}else{this._codeLink=GY("a.code-link"),this._codeLink.setAttribute("href",`${r.target.toString()}`),this._codeLink.onclick=e=>{this._openerService.open(r.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()};WY(this._codeLink,GY("span")).innerText=r.value,e.appendChild(this._codeLink)}}if(Y$(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),R1(i)){const e=this._relatedBlock.appendChild(document.createElement("div"));e.style.paddingTop=`${Math.floor(.66*this._editor.getOption(56))}px`,this._lines+=1;for(const t of i){let n=document.createElement("div"),i=document.createElement("a");i.classList.add("filename"),i.innerText=`${uwe(t.resource)}(${t.startLineNumber}, ${t.startColumn}): `,i.title=this._labelService.getUriLabel(t.resource),this._relatedDiagnostics.set(i,t);let r=document.createElement("span");r.innerText=t.message,n.appendChild(i),n.appendChild(r),this._lines+=1,e.appendChild(n)}}const l=this._editor.getOption(40),c=Math.ceil(l.typicalFullwidthCharacterWidth*this._longestLineLength*.75),u=l.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:c,scrollHeight:u})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case ope.Error:t=GH(0,"Error");break;case ope.Warning:t=GH(0,"Warning");break;case ope.Info:t=GH(0,"Info");break;case ope.Hint:t=GH(0,"Hint")}let n=GH(0,"{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const i=this._editor.getModel();if(i&&e.startLineNumber<=i.getLineCount()&&e.startLineNumber>=1){n=`${i.getLineContent(e.startLineNumber)}, ${n}`}return n}}let eCe=class e extends Pwe{constructor(e,t,n,i,r,o,s){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0},r),this._themeService=t,this._openerService=n,this._menuService=i,this._contextKeyService=o,this._labelService=s,this._callOnDispose=new pG,this._onDidSelectRelatedInformation=new EG,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=ope.Warning,this._backgroundColor=Q8.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(aCe);let t=rCe;this._severity===ope.Warning?t=oCe:this._severity===ope.Info&&(t=sCe);const n=e.getColor(t);this.style({arrowColor:n,frameColor:n,headerBackgroundColor:this._backgroundColor,primaryHeadingColor:e.getColor(Bwe),secondaryHeadingColor:e.getColor(Wwe)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(t){super._fillHead(t),this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun((e=>this.editor.focus())));const n=[],i=this._menuService.createMenu(e.TitleMenu,this._contextKeyService);Ewe(i,void 0,n),this._actionbarWidget.push(n,{label:!1,icon:!0,index:0}),i.dispose()}_fillTitleIcon(e){this._icon=WY(e,GY(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new Jwe(this._container,this.editor,(e=>this._onDidSelectRelatedInformation.fire(e)),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,n){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());let i=TK.lift(e);const r=this.editor.getPosition();let o=r&&i.containsPosition(r)?r:i.getStartPosition();super.show(o,this.computeRequiredHeight());const s=this.editor.getModel();if(s){const e=GH(0,n>1?"{0} of {1} problems":"{0} of {1} problem",t,n);this.setTitle(EZ(s.uri),e)}this._icon.className=`codicon ${Zwe.className(ope.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(o,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};eCe.TitleMenu=new Y5("gotoErrorTitleMenu"),eCe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Qwe(1,B5),Qwe(2,ZZ),Qwe(3,X5),Qwe(4,t$),Qwe(5,A5),Qwe(6,pde)],eCe);let tCe=iie(rte,ote),nCe=iie(ate,lte),iCe=iie(ute,hte);const rCe=_ee("editorMarkerNavigationError.background",{dark:tCe,light:tCe,hc:tCe},GH(0,"Editor marker navigation widget error color.")),oCe=_ee("editorMarkerNavigationWarning.background",{dark:nCe,light:nCe,hc:nCe},GH(0,"Editor marker navigation widget warning color.")),sCe=_ee("editorMarkerNavigationInfo.background",{dark:iCe,light:iCe,hc:iCe},GH(0,"Editor marker navigation widget info color.")),aCe=_ee("editorMarkerNavigation.background",{dark:"#2D2D30",light:Q8.white,hc:"#0C141F"},GH(0,"Editor marker navigation widget background."));G5(((e,t)=>{const n=e.getColor(kee);n&&(t.addRule(`.monaco-editor .marker-widget a { color: ${n}; }`),t.addRule(`.monaco-editor .marker-widget a.code-link span:hover { color: ${n}; }`))}));var lCe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},cCe=function(e,t){return function(n,i){t(n,i,e)}};class uCe{constructor(e,t,n){this.marker=e,this.index=t,this.total=n}}let hCe=class e{constructor(t,n){this._markerService=n,this._onDidChange=new EG,this.onDidChange=this._onDidChange.event,this._dispoables=new pG,this._markers=[],this._nextIdx=-1,_K.isUri(t)?this._resourceFilter=e=>e.toString()===t.toString():t&&(this._resourceFilter=t);const i=()=>{this._markers=this._markerService.read({resource:_K.isUri(t)?t:void 0,severities:ope.Error|ope.Warning|ope.Info}),"function"==typeof t&&(this._markers=this._markers.filter((e=>this._resourceFilter(e.resource)))),this._markers.sort(e._compareMarker)};i(),this._dispoables.add(n.onMarkerChanged((e=>{this._resourceFilter&&!e.some((e=>this._resourceFilter(e)))||(i(),this._nextIdx=-1,this._onDidChange.fire())})))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e||!(!this._resourceFilter||!e)&&this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new uCe(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,n){let i=!1,r=this._markers.findIndex((t=>t.resource.toString()===e.uri.toString()));r<0&&(r=N1(this._markers,{resource:e.uri},((e,t)=>gX(e.resource.toString(),t.resource.toString()))),r<0&&(r=~r));for(let o=r;o<this._markers.length;o++){let n=TK.lift(this._markers[o]);if(n.isEmpty()){const t=e.getWordAtPosition(n.getStartPosition());t&&(n=new TK(n.startLineNumber,t.startColumn,n.startLineNumber,t.endColumn))}if(t&&(n.containsPosition(t)||t.isBeforeOrEqual(n.getStartPosition()))){this._nextIdx=o,i=!0;break}if(this._markers[o].resource.toString()!==e.uri.toString())break}i||(this._nextIdx=n?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,n){if(0===this._markers.length)return!1;let i=this._nextIdx;return-1===this._nextIdx?this._initIdx(t,n,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),i!==this._nextIdx}find(e,t){let n=this._markers.findIndex((t=>t.resource.toString()===e.toString()));if(!(n<0))for(;n<this._markers.length;n++)if(TK.containsPosition(this._markers[n],t))return new uCe(this._markers[n],n+1,this._markers.length)}static _compareMarker(e,t){let n=gX(e.resource.toString(),t.resource.toString());return 0===n&&(n=ope.compare(e.severity,t.severity)),0===n&&(n=TK.compareRangesUsingStarts(e,t)),n}};hCe=lCe([cCe(1,ape)],hCe);const dCe=i$("IMarkerNavigationService");let fCe=class{constructor(e){this._markerService=e,this._provider=new bG}getMarkerList(e){for(let t of this._provider){const n=t.getMarkerList(e);if(n)return n}return new hCe(e,this._markerService)}};fCe=lCe([cCe(0,ape)],fCe),cle(dCe,fCe,!0);var gCe=function(e,t){return function(n,i){t(n,i,e)}},pCe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let mCe=class e{constructor(e,t,n,i,r){this._markerNavigationService=t,this._contextKeyService=n,this._editorService=i,this._instantiationService=r,this._sessionDispoables=new pG,this._editor=e,this._widgetVisible=bCe.bindTo(this._contextKeyService)}static get(t){return t.getContribution(e.ID)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(eCe,this._editor),this._widget.onDidClose((()=>this.close()),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition((e=>{var t,n,i;(null===(t=this._model)||void 0===t?void 0:t.selected)&&TK.containsPosition(null===(n=this._model)||void 0===n?void 0:n.selected.marker,e.position)||null===(i=this._model)||void 0===i||i.resetIndex()}))),this._sessionDispoables.add(this._model.onDidChange((()=>{if(!this._widget||!this._widget.position||!this._model)return;const e=this._model.find(this._editor.getModel().uri,this._widget.position);e?this._widget.updateMarker(e.marker):this._widget.showStale()}))),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation((e=>{this._editorService.openCodeEditor({resource:e.resource,options:{pinned:!0,revealIfOpened:!0,selection:TK.lift(e).collapseToStart()}},this._editor),this.close(!1)}))),this._sessionDispoables.add(this._editor.onDidChangeModel((()=>this._cleanUp()))),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new IK(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(t,n){return pCe(this,void 0,void 0,(function*(){if(this._editor.hasModel()){const i=this._getOrCreateModel(n?void 0:this._editor.getModel().uri);if(i.move(t,this._editor.getModel(),this._editor.getPosition()),!i.selected)return;if(i.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const r=yield this._editorService.openCodeEditor({resource:i.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:i.selected.marker}},this._editor);r&&(e.get(r).close(),e.get(r).nagivate(t,n))}else this._widget.showAtMarker(i.selected.marker,i.selected.index,i.selected.total)}}))}};mCe.ID="editor.contrib.markerController",mCe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([gCe(1,dCe),gCe(2,A5),gCe(3,o$),gCe(4,t$)],mCe);class vCe extends o6{constructor(e,t,n){super(n),this._next=e,this._multiFile=t}run(e,t){return pCe(this,void 0,void 0,(function*(){t.hasModel()&&mCe.get(t).nagivate(this._next,this._multiFile)}))}}class yCe extends vCe{constructor(){super(!0,!1,{id:yCe.ID,label:yCe.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:578,weight:100},menuOpts:{menuId:eCe.TitleMenu,title:yCe.LABEL,icon:Ele("marker-navigation-next",hJ.chevronDown,GH(0,"Icon for goto next marker.")),group:"navigation",order:1}})}}yCe.ID="editor.action.marker.next",yCe.LABEL=GH(0,"Go to Next Problem (Error, Warning, Info)");class _Ce extends vCe{constructor(){super(!1,!1,{id:_Ce.ID,label:_Ce.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:1602,weight:100},menuOpts:{menuId:eCe.TitleMenu,title:yCe.LABEL,icon:Ele("marker-navigation-previous",hJ.chevronUp,GH(0,"Icon for goto previous marker.")),group:"navigation",order:2}})}}_Ce.ID="editor.action.marker.prev",_Ce.LABEL=GH(0,"Go to Previous Problem (Error, Warning, Info)");d6(mCe.ID,mCe),c6(yCe),c6(_Ce),c6(class extends vCe{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:GH(0,"Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:66,weight:100},menuOpts:{menuId:Y5.MenubarGoMenu,title:GH(0,"Next &&Problem"),group:"6_problem_nav",order:1}})}}),c6(class extends vCe{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:GH(0,"Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:1090,weight:100},menuOpts:{menuId:Y5.MenubarGoMenu,title:GH(0,"Previous &&Problem"),group:"6_problem_nav",order:2}})}});const bCe=new M5("markersNavigationVisible",!1);l6(new(r6.bindToContribution(mCe.get))({id:"closeMarkersNavigation",precondition:bCe,handler:e=>e.close(),kbOpts:{weight:150,kbExpr:gre.focus,primary:9,secondary:[1033]}}));var wCe=function(e,t){return function(n,i){t(n,i,e)}};const CCe=GY;class SCe{constructor(e,t,n){this.owner=e,this.range=t,this.marker=n}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const xCe={type:1,filter:{include:lbe.QuickFix}};let ECe=class{constructor(e,t,n,i){this._editor=e,this._hover=t,this._markerDecorationsService=n,this._openerService=i,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type)return[];const n=this._editor.getModel(),i=e.range.startLineNumber,r=n.getLineMaxColumn(i),o=[];for(const s of t){const t=s.range.startLineNumber===i?s.range.startColumn:1,a=s.range.endLineNumber===i?s.range.endColumn:r,l=this._markerDecorationsService.getMarker(n.uri,s);if(!l)continue;const c=new TK(e.range.startLineNumber,t,e.range.startLineNumber,a);o.push(new SCe(this,c,l))}return o}renderHoverParts(e,t,n){if(!e.length)return mG.None;const i=new pG;e.forEach((e=>t.appendChild(this.renderMarkerHover(e,i))));const r=1===e.length?e[0]:e.sort(((e,t)=>ope.compare(e.marker.severity,t.marker.severity)))[0];return this.renderMarkerStatusbar(r,n,i),i}renderMarkerHover(e,t){const n=CCe("div.hover-row"),i=WY(n,CCe("div.marker.hover-contents")),{source:r,message:o,code:s,relatedInformation:a}=e.marker;this._editor.applyFontInfo(i);const l=WY(i,CCe("span"));if(l.style.whiteSpace="pre-wrap",l.innerText=o,r||s)if(s&&"string"!=typeof s){const e=CCe("span");if(r){WY(e,CCe("span")).innerText=r}const n=WY(e,CCe("a.code-link"));n.setAttribute("href",s.target.toString()),t.add(Q$(n,"click",(e=>{this._openerService.open(s.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()})));WY(n,CCe("span")).innerText=s.value;const o=WY(i,e);o.style.opacity="0.6",o.style.paddingLeft="6px"}else{const e=WY(i,CCe("span"));e.style.opacity="0.6",e.style.paddingLeft="6px",e.innerText=r&&s?`${r}(${s})`:r||`(${s})`}if(R1(a))for(const{message:c,resource:u,startLineNumber:h,startColumn:d}of a){const e=WY(i,CCe("div"));e.style.marginTop="8px";const n=WY(e,CCe("a"));n.innerText=`${EZ(u)}(${h}, ${d}): `,n.style.cursor="pointer",t.add(Q$(n,"click",(e=>{e.stopPropagation(),e.preventDefault(),this._openerService&&this._openerService.open(u,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:h,startColumn:d}}}).catch(nG)})));const r=WY(e,CCe("span"));r.innerText=c,this._editor.applyFontInfo(r)}return n}renderMarkerStatusbar(e,t,n){if(e.marker.severity!==ope.Error&&e.marker.severity!==ope.Warning&&e.marker.severity!==ope.Info||t.addAction({label:GH(0,"View Problem"),commandId:yCe.ID,run:()=>{this._hover.hide(),mCe.get(this._editor).showAtMarker(e.marker),this._editor.focus()}}),!this._editor.getOption(78)){const i=t.append(CCe("div"));this.recentMarkerCodeActionsInfo&&(spe.makeKey(this.recentMarkerCodeActionsInfo.marker)===spe.makeKey(e.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(i.textContent=GH(0,"No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const r=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?mG.None:n.add(P$((()=>i.textContent=GH(0,"Checking for quick fixes...")),200));i.textContent||(i.textContent=String.fromCharCode(160));const o=this.getCodeActions(e.marker);n.add(gG((()=>o.cancel()))),o.then((o=>{if(r.dispose(),this.recentMarkerCodeActionsInfo={marker:e.marker,hasCodeActions:o.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions)return o.dispose(),void(i.textContent=GH(0,"No quick fixes available"));i.style.display="none";let s=!1;n.add(gG((()=>{s||o.dispose()}))),t.addAction({label:GH(0,"Quick Fix..."),commandId:Ube.Id,run:e=>{s=!0;const t=Wbe.get(this._editor),n=mY(e);this._hover.hide(),t.showCodeActions(xCe,o,{x:n.left+6,y:n.top+n.height+6})}})}))}}getCodeActions(e){return I$((t=>pbe(this._editor.getModel(),new TK(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),xCe,Hle.None,t)))}};ECe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([wCe(2,r5),wCe(3,ZZ)],ECe);var kCe={exports:{}};let LCe;kCe.exports=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function r(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=e[Symbol.iterator]()).next.bind(i)}function o(e){var t={exports:{}};return e(t,t.exports),t.exports}var s=o((function(e){function t(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function n(t){e.exports.defaults=t}e.exports={defaults:t(),getDefaults:t,changeDefaults:n}})),a=/[&<>"']/,l=/[&<>"']/g,c=/[<>"']|&(?!#?\w+;)/,u=/[<>"']|&(?!#?\w+;)/g,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=function(e){return h[e]};function f(e,t){if(t){if(a.test(e))return e.replace(l,d)}else if(c.test(e))return e.replace(u,d);return e}var g=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function p(e){return e.replace(g,(function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}var m=/(^|[^\[])\^/g;function v(e,t){e=e.source||e,t=t||"";var n={replace:function(t,i){return i=(i=i.source||i).replace(m,"$1"),e=e.replace(t,i),n},getRegex:function(){return new RegExp(e,t)}};return n}var y=/[^\w:]/g,_=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function b(e,t,n){if(e){var i;try{i=decodeURIComponent(p(n)).replace(y,"").toLowerCase()}catch(zWe){return null}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:")||0===i.indexOf("data:"))return null}t&&!_.test(n)&&(n=E(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(zWe){return null}return n}var w={},C=/^[^:]+:\/*[^/]*$/,S=/^([^:]+:)[\s\S]*$/,x=/^([^:]+:\/*[^/]*)[\s\S]*$/;function E(e,t){w[" "+e]||(C.test(e)?w[" "+e]=e+"/":w[" "+e]=D(e,"/",!0));var n=-1===(e=w[" "+e]).indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(S,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(x,"$1")+t:e+t}function k(e){for(var t,n,i=1;i<arguments.length;i++)for(n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function L(e,t){var n=e.replace(/\|/g,(function(e,t,n){for(var i=!1,r=t;--r>=0&&"\\"===n[r];)i=!i;return i?"|":" |"})).split(/ \|/),i=0;if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}function D(e,t,n){var i=e.length;if(0===i)return"";for(var r=0;r<i;){var o=e.charAt(i-r-1);if(o!==t||n){if(o===t||!n)break;r++}else r++}return e.substr(0,i-r)}function N(e,t){if(-1===e.indexOf(t[1]))return-1;for(var n=e.length,i=0,r=0;r<n;r++)if("\\"===e[r])r++;else if(e[r]===t[0])i++;else if(e[r]===t[1]&&--i<0)return r;return-1}function I(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function T(e,t){if(t<1)return"";for(var n="";t>1;)1&t&&(n+=e),t>>=1,e+=e;return n+e}var M={escape:f,unescape:p,edit:v,cleanUrl:b,resolveUrl:E,noopTest:{exec:function(){}},merge:k,splitCells:L,rtrim:D,findClosingBracket:N,checkSanitizeDeprecation:I,repeatString:T},A=s.defaults,O=M.rtrim,R=M.splitCells,P=M.escape,F=M.findClosingBracket;function B(e,t,n){var i=t.href,r=t.title?P(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");return"!"!==e[0].charAt(0)?{type:"link",raw:n,href:i,title:r,text:o}:{type:"image",raw:n,href:i,title:r,text:P(o)}}function W(e,t){var n=e.match(/^(\s+)(?:```)/);if(null===n)return t;var i=n[1];return t.split("\n").map((function(e){var t=e.match(/^\s+/);return null===t?e:t[0].length>=i.length?e.slice(i.length):e})).join("\n")}var z=function(){function e(e){this.options=e||A}var t=e.prototype;return t.space=function(e){var t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}},t.code=function(e){var t=this.rules.block.code.exec(e);if(t){var n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:O(n,"\n")}}},t.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var n=t[0],i=W(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim():t[2],text:i}}},t.heading=function(e){var t=this.rules.block.heading.exec(e);if(t){var n=t[2].trim();if(/#$/.test(n)){var i=O(n,"#");this.options.pedantic?n=i.trim():i&&!/ $/.test(i)||(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n}}},t.nptable=function(e){var t=this.rules.block.nptable.exec(e);if(t){var n={type:"table",header:R(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[],raw:t[0]};if(n.header.length===n.align.length){var i,r=n.align.length;for(i=0;i<r;i++)/^ *-+: *$/.test(n.align[i])?n.align[i]="right":/^ *:-+: *$/.test(n.align[i])?n.align[i]="center":/^ *:-+ *$/.test(n.align[i])?n.align[i]="left":n.align[i]=null;for(r=n.cells.length,i=0;i<r;i++)n.cells[i]=R(n.cells[i],n.header.length);return n}}},t.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},t.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var n=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],text:n}}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){var n,i,r,o,s,a,l,c,u=t[0],h=t[2],d=h.length>1,f={type:"list",raw:u,ordered:d,start:d?+h.slice(0,-1):"",loose:!1,items:[]},g=t[0].match(this.rules.block.item),p=!1,m=g.length;r=this.rules.block.listItemStart.exec(g[0]);for(var v=0;v<m;v++){if(u=n=g[v],v!==m-1){if(o=this.rules.block.listItemStart.exec(g[v+1]),this.options.pedantic?o[1].length>r[1].length:o[1].length>r[0].length||o[1].length>3){g.splice(v,2,g[v]+"\n"+g[v+1]),v--,m--;continue}(!this.options.pedantic||this.options.smartLists?o[2][o[2].length-1]!==h[h.length-1]:d===(1===o[2].length))&&(s=g.slice(v+1).join("\n"),f.raw=f.raw.substring(0,f.raw.length-s.length),v=m-1),r=o}i=n.length,~(n=n.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(i-=n.length,n=this.options.pedantic?n.replace(/^ {1,4}/gm,""):n.replace(new RegExp("^ {1,"+i+"}","gm"),"")),a=p||/\n\n(?!\s*$)/.test(n),v!==m-1&&(p="\n"===n.charAt(n.length-1),a||(a=p)),a&&(f.loose=!0),this.options.gfm&&(c=void 0,(l=/^\[[ xX]\] /.test(n))&&(c=" "!==n[1],n=n.replace(/^\[[ xX]\] +/,""))),f.items.push({type:"list_item",raw:u,task:l,checked:c,loose:a,text:n})}return f}},t.html=function(e){var t=this.rules.block.html.exec(e);if(t)return{type:this.options.sanitize?"paragraph":"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):P(t[0]):t[0]}},t.def=function(e){var t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}},t.table=function(e){var t=this.rules.block.table.exec(e);if(t){var n={type:"table",header:R(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=t[0];var i,r=n.align.length;for(i=0;i<r;i++)/^ *-+: *$/.test(n.align[i])?n.align[i]="right":/^ *:-+: *$/.test(n.align[i])?n.align[i]="center":/^ *:-+ *$/.test(n.align[i])?n.align[i]="left":n.align[i]=null;for(r=n.cells.length,i=0;i<r;i++)n.cells[i]=R(n.cells[i].replace(/^ *\| *| *\| *$/g,""),n.header.length);return n}}},t.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1]}},t.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t)return{type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1]}},t.text=function(e){var t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0]}},t.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:P(t[1])}},t.tag=function(e,t,n){var i=this.rules.inline.tag.exec(e);if(i)return!t&&/^<a /i.test(i[0])?t=!0:t&&/^<\/a>/i.test(i[0])&&(t=!1),!n&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])?n=!0:n&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])&&(n=!1),{type:this.options.sanitize?"text":"html",raw:i[0],inLink:t,inRawBlock:n,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):P(i[0]):i[0]}},t.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;var i=O(n.slice(0,-1),"\\");if((n.length-i.length)%2==0)return}else{var r=F(t[2],"()");if(r>-1){var o=(0===t[0].indexOf("!")?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,o).trim(),t[3]=""}}var s=t[2],a="";if(this.options.pedantic){var l=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);l&&(s=l[1],a=l[3])}else a=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(n)?s.slice(1):s.slice(1,-1)),B(t,{href:s?s.replace(this.rules.inline._escapes,"$1"):s,title:a?a.replace(this.rules.inline._escapes,"$1"):a},t[0])}},t.reflink=function(e,t){var n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){var i=(n[2]||n[1]).replace(/\s+/g," ");if(!(i=t[i.toLowerCase()])||!i.href){var r=n[0].charAt(0);return{type:"text",raw:r,text:r}}return B(n,i,n[0])}},t.emStrong=function(e,t,n){void 0===n&&(n="");var i=this.rules.inline.emStrong.lDelim.exec(e);if(i&&(!i[3]||!n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var r=i[1]||i[2]||"";if(!r||r&&(""===n||this.rules.inline.punctuation.exec(n))){var o,s,a=i[0].length-1,l=a,c=0,u="*"===i[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+a);null!=(i=u.exec(t));)if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6])if(s=o.length,i[3]||i[4])l+=s;else if(!((i[5]||i[6])&&a%3)||(a+s)%3){if(!((l-=s)>0)){if(l+c-s<=0&&!t.slice(u.lastIndex).match(u)&&(s=Math.min(s,s+l+c)),Math.min(a,s)%2)return{type:"em",raw:e.slice(0,a+i.index+s+1),text:e.slice(1,a+i.index+s)};if(Math.min(a,s)%2==0)return{type:"strong",raw:e.slice(0,a+i.index+s+1),text:e.slice(2,a+i.index+s-1)}}}else c+=s}}},t.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var n=t[2].replace(/\n/g," "),i=/[^ ]/.test(n),r=/^ /.test(n)&&/ $/.test(n);return i&&r&&(n=n.substring(1,n.length-1)),n=P(n,!0),{type:"codespan",raw:t[0],text:n}}},t.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}},t.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2]}},t.autolink=function(e,t){var n,i,r=this.rules.inline.autolink.exec(e);if(r)return i="@"===r[2]?"mailto:"+(n=P(this.options.mangle?t(r[1]):r[1])):n=P(r[1]),{type:"link",raw:r[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}},t.url=function(e,t){var n;if(n=this.rules.inline.url.exec(e)){var i,r;if("@"===n[2])r="mailto:"+(i=P(this.options.mangle?t(n[0]):n[0]));else{var o;do{o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(o!==n[0]);i=P(n[0]),r="www."===n[1]?"http://"+i:i}return{type:"link",raw:n[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}},t.inlineText=function(e,t,n){var i,r=this.rules.inline.text.exec(e);if(r)return i=t?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):P(r[0]):r[0]:P(this.options.smartypants?n(r[0]):r[0]),{type:"text",raw:r[0],text:i}},e}(),V=M.noopTest,U=M.edit,H=M.merge,j={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:V,table:V,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};j.def=U(j.def).replace("label",j._label).replace("title",j._title).getRegex(),j.bullet=/(?:[*+-]|\d{1,9}[.)])/,j.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,j.item=U(j.item,"gm").replace(/bull/g,j.bullet).getRegex(),j.listItemStart=U(/^( *)(bull)/).replace("bull",j.bullet).getRegex(),j.list=U(j.list).replace(/bull/g,j.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+j.def.source+")").getRegex(),j._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",j._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,j.html=U(j.html,"i").replace("comment",j._comment).replace("tag",j._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),j.paragraph=U(j._paragraph).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",j._tag).getRegex(),j.blockquote=U(j.blockquote).replace("paragraph",j.paragraph).getRegex(),j.normal=H({},j),j.gfm=H({},j.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),j.gfm.nptable=U(j.gfm.nptable).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",j._tag).getRegex(),j.gfm.table=U(j.gfm.table).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",j._tag).getRegex(),j.pedantic=H({},j.normal,{html:U("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",j._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:V,paragraph:U(j.normal._paragraph).replace("hr",j.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",j.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var G={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:V,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_]*?\*[^_]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^*]*?\_[^*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:V,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};G.punctuation=U(G.punctuation).replace(/punctuation/g,G._punctuation).getRegex(),G.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,G.escapedEmSt=/\\\*|\\_/g,G._comment=U(j._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),G.emStrong.lDelim=U(G.emStrong.lDelim).replace(/punct/g,G._punctuation).getRegex(),G.emStrong.rDelimAst=U(G.emStrong.rDelimAst,"g").replace(/punct/g,G._punctuation).getRegex(),G.emStrong.rDelimUnd=U(G.emStrong.rDelimUnd,"g").replace(/punct/g,G._punctuation).getRegex(),G._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,G._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,G._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,G.autolink=U(G.autolink).replace("scheme",G._scheme).replace("email",G._email).getRegex(),G._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,G.tag=U(G.tag).replace("comment",G._comment).replace("attribute",G._attribute).getRegex(),G._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,G._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,G._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,G.link=U(G.link).replace("label",G._label).replace("href",G._href).replace("title",G._title).getRegex(),G.reflink=U(G.reflink).replace("label",G._label).getRegex(),G.reflinkSearch=U(G.reflinkSearch,"g").replace("reflink",G.reflink).replace("nolink",G.nolink).getRegex(),G.normal=H({},G),G.pedantic=H({},G.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:U(/^!?\[(label)\]\((.*?)\)/).replace("label",G._label).getRegex(),reflink:U(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",G._label).getRegex()}),G.gfm=H({},G.normal,{escape:U(G.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),G.gfm.url=U(G.gfm.url,"i").replace("email",G.gfm._extended_email).getRegex(),G.breaks=H({},G.gfm,{br:U(G.br).replace("{2,}","*").getRegex(),text:U(G.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var K={block:j,inline:G},q=s.defaults,$=K.block,Y=K.inline,X=M.repeatString;function Z(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function Q(e){var t,n,i="",r=e.length;for(t=0;t<r;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),i+="&#"+n+";";return i}var J=function(){function e(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||q,this.options.tokenizer=this.options.tokenizer||new z,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var t={block:$.normal,inline:Y.normal};this.options.pedantic?(t.block=$.pedantic,t.inline=Y.pedantic):this.options.gfm&&(t.block=$.gfm,this.options.breaks?t.inline=Y.breaks:t.inline=Y.gfm),this.tokenizer.rules=t}e.lex=function(t,n){return new e(n).lex(t)},e.lexInline=function(t,n){return new e(n).inlineTokens(t)};var n=e.prototype;return n.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens,!0),this.inline(this.tokens),this.tokens},n.blockTokens=function(e,t,n){var i,r,o,s;for(void 0===t&&(t=[]),void 0===n&&(n=!0),this.options.pedantic&&(e=e.replace(/^ +$/gm,""));e;)if(i=this.tokenizer.space(e))e=e.substring(i.raw.length),i.type&&t.push(i);else if(i=this.tokenizer.code(e))e=e.substring(i.raw.length),(s=t[t.length-1])&&"paragraph"===s.type?(s.raw+="\n"+i.raw,s.text+="\n"+i.text):t.push(i);else if(i=this.tokenizer.fences(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.heading(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.nptable(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.hr(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.blockquote(e))e=e.substring(i.raw.length),i.tokens=this.blockTokens(i.text,[],n),t.push(i);else if(i=this.tokenizer.list(e)){for(e=e.substring(i.raw.length),o=i.items.length,r=0;r<o;r++)i.items[r].tokens=this.blockTokens(i.items[r].text,[],!1);t.push(i)}else if(i=this.tokenizer.html(e))e=e.substring(i.raw.length),t.push(i);else if(n&&(i=this.tokenizer.def(e)))e=e.substring(i.raw.length),this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});else if(i=this.tokenizer.table(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.lheading(e))e=e.substring(i.raw.length),t.push(i);else if(n&&(i=this.tokenizer.paragraph(e)))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.text(e))e=e.substring(i.raw.length),(s=t[t.length-1])&&"text"===s.type?(s.raw+="\n"+i.raw,s.text+="\n"+i.text):t.push(i);else if(e){var a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}throw new Error(a)}return t},n.inline=function(e){var t,n,i,r,o,s,a=e.length;for(t=0;t<a;t++)switch((s=e[t]).type){case"paragraph":case"text":case"heading":s.tokens=[],this.inlineTokens(s.text,s.tokens);break;case"table":for(s.tokens={header:[],cells:[]},r=s.header.length,n=0;n<r;n++)s.tokens.header[n]=[],this.inlineTokens(s.header[n],s.tokens.header[n]);for(r=s.cells.length,n=0;n<r;n++)for(o=s.cells[n],s.tokens.cells[n]=[],i=0;i<o.length;i++)s.tokens.cells[n][i]=[],this.inlineTokens(o[i],s.tokens.cells[n][i]);break;case"blockquote":this.inline(s.tokens);break;case"list":for(r=s.items.length,n=0;n<r;n++)this.inline(s.items[n].tokens)}return e},n.inlineTokens=function(e,t,n,i){var r,o;void 0===t&&(t=[]),void 0===n&&(n=!1),void 0===i&&(i=!1);var s,a,l,c=e;if(this.tokens.links){var u=Object.keys(this.tokens.links);if(u.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(c));)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,s.index)+"["+X("a",s[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(c));)c=c.slice(0,s.index)+"["+X("a",s[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.escapedEmSt.exec(c));)c=c.slice(0,s.index)+"++"+c.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(a||(l=""),a=!1,r=this.tokenizer.escape(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.tag(e,n,i)){e=e.substring(r.raw.length),n=r.inLink,i=r.inRawBlock;var h=t[t.length-1];h&&"text"===r.type&&"text"===h.type?(h.raw+=r.raw,h.text+=r.text):t.push(r)}else if(r=this.tokenizer.link(e))e=e.substring(r.raw.length),"link"===r.type&&(r.tokens=this.inlineTokens(r.text,[],!0,i)),t.push(r);else if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length);var d=t[t.length-1];"link"===r.type?(r.tokens=this.inlineTokens(r.text,[],!0,i),t.push(r)):d&&"text"===r.type&&"text"===d.type?(d.raw+=r.raw,d.text+=r.text):t.push(r)}else if(r=this.tokenizer.emStrong(e,c,l))e=e.substring(r.raw.length),r.tokens=this.inlineTokens(r.text,[],n,i),t.push(r);else if(r=this.tokenizer.codespan(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.br(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.del(e))e=e.substring(r.raw.length),r.tokens=this.inlineTokens(r.text,[],n,i),t.push(r);else if(r=this.tokenizer.autolink(e,Q))e=e.substring(r.raw.length),t.push(r);else if(n||!(r=this.tokenizer.url(e,Q))){if(r=this.tokenizer.inlineText(e,i,Z))e=e.substring(r.raw.length),"_"!==r.raw.slice(-1)&&(l=r.raw.slice(-1)),a=!0,(o=t[t.length-1])&&"text"===o.type?(o.raw+=r.raw,o.text+=r.text):t.push(r);else if(e){var f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}throw new Error(f)}}else e=e.substring(r.raw.length),t.push(r);return t},t(e,null,[{key:"rules",get:function(){return{block:$,inline:Y}}}]),e}(),ee=s.defaults,te=M.cleanUrl,ne=M.escape,ie=function(){function e(e){this.options=e||ee}var t=e.prototype;return t.code=function(e,t,n){var i=(t||"").match(/\S*/)[0];if(this.options.highlight){var r=this.options.highlight(e,i);null!=r&&r!==e&&(n=!0,e=r)}return e=e.replace(/\n$/,"")+"\n",i?'<pre><code class="'+this.options.langPrefix+ne(i,!0)+'">'+(n?e:ne(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:ne(e,!0))+"</code></pre>\n"},t.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},t.html=function(e){return e},t.heading=function(e,t,n,i){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+i.slug(n)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},t.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},t.list=function(e,t,n){var i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+i+">\n"},t.listitem=function(e){return"<li>"+e+"</li>\n"},t.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},t.paragraph=function(e){return"<p>"+e+"</p>\n"},t.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},t.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},t.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},t.strong=function(e){return"<strong>"+e+"</strong>"},t.em=function(e){return"<em>"+e+"</em>"},t.codespan=function(e){return"<code>"+e+"</code>"},t.br=function(){return this.options.xhtml?"<br/>":"<br>"},t.del=function(e){return"<del>"+e+"</del>"},t.link=function(e,t,n){if(null===(e=te(this.options.sanitize,this.options.baseUrl,e)))return n;var i='<a href="'+ne(e)+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>"},t.image=function(e,t,n){if(null===(e=te(this.options.sanitize,this.options.baseUrl,e)))return n;var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},t.text=function(e){return e},e}(),re=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,n){return""+n},t.image=function(e,t,n){return""+n},t.br=function(){return""},e}(),oe=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},t.getNextSafeSlug=function(e,t){var n=e,i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[e];do{n=e+"-"+ ++i}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=i,this.seen[n]=0),n},t.slug=function(e,t){void 0===t&&(t={});var n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)},e}(),se=s.defaults,ae=M.unescape,le=function(){function e(e){this.options=e||se,this.options.renderer=this.options.renderer||new ie,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new re,this.slugger=new oe}e.parse=function(t,n){return new e(n).parse(t)},e.parseInline=function(t,n){return new e(n).parseInline(t)};var t=e.prototype;return t.parse=function(e,t){void 0===t&&(t=!0);var n,i,r,o,s,a,l,c,u,h,d,f,g,p,m,v,y,_,b="",w=e.length;for(n=0;n<w;n++)switch((h=e[n]).type){case"space":continue;case"hr":b+=this.renderer.hr();continue;case"heading":b+=this.renderer.heading(this.parseInline(h.tokens),h.depth,ae(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue;case"code":b+=this.renderer.code(h.text,h.lang,h.escaped);continue;case"table":for(c="",l="",o=h.header.length,i=0;i<o;i++)l+=this.renderer.tablecell(this.parseInline(h.tokens.header[i]),{header:!0,align:h.align[i]});for(c+=this.renderer.tablerow(l),u="",o=h.cells.length,i=0;i<o;i++){for(l="",s=(a=h.tokens.cells[i]).length,r=0;r<s;r++)l+=this.renderer.tablecell(this.parseInline(a[r]),{header:!1,align:h.align[r]});u+=this.renderer.tablerow(l)}b+=this.renderer.table(c,u);continue;case"blockquote":u=this.parse(h.tokens),b+=this.renderer.blockquote(u);continue;case"list":for(d=h.ordered,f=h.start,g=h.loose,o=h.items.length,u="",i=0;i<o;i++)v=(m=h.items[i]).checked,y=m.task,p="",m.task&&(_=this.renderer.checkbox(v),g?m.tokens.length>0&&"text"===m.tokens[0].type?(m.tokens[0].text=_+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=_+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:_}):p+=_),p+=this.parse(m.tokens,g),u+=this.renderer.listitem(p,y,v);b+=this.renderer.list(u,d,f);continue;case"html":b+=this.renderer.html(h.text);continue;case"paragraph":b+=this.renderer.paragraph(this.parseInline(h.tokens));continue;case"text":for(u=h.tokens?this.parseInline(h.tokens):h.text;n+1<w&&"text"===e[n+1].type;)u+="\n"+((h=e[++n]).tokens?this.parseInline(h.tokens):h.text);b+=t?this.renderer.paragraph(u):u;continue;default:var C='Token with "'+h.type+'" type was not found.';if(this.options.silent)return void console.error(C);throw new Error(C)}return b},t.parseInline=function(e,t){t=t||this.renderer;var n,i,r="",o=e.length;for(n=0;n<o;n++)switch((i=e[n]).type){case"escape":r+=t.text(i.text);break;case"html":r+=t.html(i.text);break;case"link":r+=t.link(i.href,i.title,this.parseInline(i.tokens,t));break;case"image":r+=t.image(i.href,i.title,i.text);break;case"strong":r+=t.strong(this.parseInline(i.tokens,t));break;case"em":r+=t.em(this.parseInline(i.tokens,t));break;case"codespan":r+=t.codespan(i.text);break;case"br":r+=t.br();break;case"del":r+=t.del(this.parseInline(i.tokens,t));break;case"text":r+=t.text(i.text);break;default:var s='Token with "'+i.type+'" type was not found.';if(this.options.silent)return void console.error(s);throw new Error(s)}return r},e}(),ce=M.merge,ue=M.checkSanitizeDeprecation,he=M.escape,de=s.getDefaults,fe=s.changeDefaults,ge=s.defaults;function pe(e,t,n){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(n=t,t=null),t=ce({},pe.defaults,t||{}),ue(t),n){var i,r=t.highlight;try{i=J.lex(e,t)}catch(zWe){return n(zWe)}var o=function(e){var o;if(!e)try{o=le.parse(i,t)}catch(zWe){e=zWe}return t.highlight=r,e?n(e):n(null,o)};if(!r||r.length<3)return o();if(delete t.highlight,!i.length)return o();var s=0;return pe.walkTokens(i,(function(e){"code"===e.type&&(s++,setTimeout((function(){r(e.text,e.lang,(function(t,n){if(t)return o(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),0==--s&&o()}))}),0))})),void(0===s&&o())}try{var a=J.lex(e,t);return t.walkTokens&&pe.walkTokens(a,t.walkTokens),le.parse(a,t)}catch(zWe){if(zWe.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+he(zWe.message+"",!0)+"</pre>";throw zWe}}return pe.options=pe.setOptions=function(e){return ce(pe.defaults,e),fe(pe.defaults),pe},pe.getDefaults=de,pe.defaults=ge,pe.use=function(e){var t=ce({},e);if(e.renderer&&function(){var n=pe.defaults.renderer||new ie,i=function(t){var i=n[t];n[t]=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];var a=e.renderer[t].apply(n,o);return!1===a&&(a=i.apply(n,o)),a}};for(var r in e.renderer)i(r);t.renderer=n}(),e.tokenizer&&function(){var n=pe.defaults.tokenizer||new z,i=function(t){var i=n[t];n[t]=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];var a=e.tokenizer[t].apply(n,o);return!1===a&&(a=i.apply(n,o)),a}};for(var r in e.tokenizer)i(r);t.tokenizer=n}(),e.walkTokens){var n=pe.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens(t),n&&n(t)}}pe.setOptions(t)},pe.walkTokens=function(e,t){for(var n,i=r(e);!(n=i()).done;){var o=n.value;switch(t(o),o.type){case"table":for(var s,a=r(o.tokens.header);!(s=a()).done;){var l=s.value;pe.walkTokens(l,t)}for(var c,u=r(o.tokens.cells);!(c=u()).done;)for(var h,d=r(c.value);!(h=d()).done;){var f=h.value;pe.walkTokens(f,t)}break;case"list":pe.walkTokens(o.items,t);break;default:o.tokens&&pe.walkTokens(o.tokens,t)}}},pe.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=ce({},pe.defaults,t||{}),ue(t);try{var n=J.lexInline(e,t);return t.walkTokens&&pe.walkTokens(n,t.walkTokens),le.parseInline(n,t)}catch(zWe){if(zWe.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+he(zWe.message+"",!0)+"</pre>";throw zWe}},pe.Parser=le,pe.parser=le.parse,pe.Renderer=ie,pe.TextRenderer=re,pe.Lexer=J,pe.lexer=J.lex,pe.Tokenizer=z,pe.Slugger=oe,pe.parse=pe,pe}(),function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){return r(t[s][1][e]||e)}),u,u.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){var i=e("./toMap");t.exports={uris:i(["background","base","cite","href","longdesc","src","usemap"])}},{"./toMap":10}],2:[function(e,t,n){t.exports={allowedAttributes:{"*":["title","accesskey"],a:["href","name","target","aria-label"],iframe:["allowfullscreen","frameborder","src"],img:["src","alt","title","aria-label"]},allowedClasses:{},allowedSchemes:["http","https","mailto"],allowedTags:["a","abbr","article","b","blockquote","br","caption","code","del","details","div","em","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","li","main","mark","ol","p","pre","section","span","strike","strong","sub","summary","sup","table","tbody","td","th","thead","tr","u","ul"],filter:null}},{}],3:[function(e,t,n){var i=e("./toMap");t.exports={voids:i(["area","br","col","hr","img","wbr","input","base","basefont","link","meta"])}},{"./toMap":10}],4:[function(e,t,n){e("he");var i=e("assignment"),r=e("./parser"),o=e("./sanitizer"),s=e("./defaults");function a(e,t,n){var a=[],l=!0===n?t:i({},s,t),c=o(a,l);return r(e,c),a.join("")}a.defaults=s,t.exports=a,LCe=a},{"./defaults":2,"./parser":7,"./sanitizer":8,assignment:6,he:9}],5:[function(e,t,n){t.exports=function(e){return"string"==typeof e?e.toLowerCase():e}},{}],6:[function(e,t,n){t.exports=function e(t){for(var n,i,r=Array.prototype.slice.call(arguments,1);r.length;)for(i in n=r.shift())n.hasOwnProperty(i)&&("[object Object]"===Object.prototype.toString.call(t[i])?t[i]=e(t[i],n[i]):t[i]=n[i]);return t}},{}],7:[function(e,t,n){var i=e("he"),r=e("./lowercase");e("./attributes");var o=e("./elements"),s=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,a=/^<\s*\/\s*([\w:-]+)[^>]*>/,l=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,c=/^</,u=/^<\s*\//;t.exports=function(e,t){for(var n,h=function(){var e=[];return e.lastItem=function(){return e[e.length-1]},e}(),d=e;e;)f();function f(){n=!0,function(){"\x3c!--"===e.substr(0,4)?(i=e.indexOf("--\x3e"))>=0&&(t.comment&&t.comment(e.substring(4,i)),e=e.substring(i+3),n=!1):u.test(e)?g(a,m):c.test(e)&&g(s,p);var i;!function(){if(!n)return;var i,r=e.indexOf("<");r>=0?(i=e.substring(0,r),e=e.substring(r)):(i=e,e="");t.chars&&t.chars(i)}()}();var i=e===d;d=e,i&&(e="")}function g(t,i){var r=e.match(t);r&&(e=e.substring(r[0].length),r[0].replace(t,i),n=!1)}function p(e,n,s,a){var c={},u=r(n),d=o.voids[u]||!!a;s.replace(l,(function(e,t,n,r,o){c[t]=void 0===n&&void 0===r&&void 0===o?void 0:i.decode(n||r||o||"")})),d||h.push(u),t.start&&t.start(u,c,d)}function m(e,n){var i,o=0,s=r(n);if(s)for(o=h.length-1;o>=0&&h[o]!==s;o--);if(o>=0){for(i=h.length-1;i>=o;i--)t.end&&t.end(h[i]);h.length=o}}m()}},{"./attributes":1,"./elements":3,"./lowercase":5,he:9}],8:[function(e,t,n){var i=e("he"),r=e("./lowercase"),o=e("./attributes"),s=e("./elements");t.exports=function(e,t){var n,a=t||{};return h(),{start:function(e,t,s){var u=r(e);if(n.ignoring)return void c(u);if(-1===(a.allowedTags||[]).indexOf(u))return void c(u);if(a.filter&&!a.filter({tag:u,attrs:t}))return void c(u);l("<"),l(u),Object.keys(t).forEach((function(e){var n=t[e],s=(a.allowedClasses||{})[u]||[],c=(a.allowedAttributes||{})[u]||[];c=c.concat((a.allowedAttributes||{})["*"]||[]);var h=r(e);("class"===h&&-1===c.indexOf(h)?(n=n.split(" ").filter((function(e){return s&&-1!==s.indexOf(e)})).join(" ").trim()).length:-1!==c.indexOf(h)&&(!0!==o.uris[h]||function(e){var t=e[0];if("#"===t||"/"===t)return!0;var n=e.indexOf(":");if(-1===n)return!0;var i=e.indexOf("?");if(-1!==i&&n>i)return!0;var r=e.indexOf("#");return-1!==r&&n>r||a.allowedSchemes.some(o);function o(t){return 0===e.indexOf(t+":")}}(n)))&&(l(" "),l(e),"string"==typeof n&&(l('="'),l(i.encode(n)),l('"')))})),l(s?"/>":">")},end:function(e){var t=r(e);-1!==(a.allowedTags||[]).indexOf(t)&&!1===n.ignoring?(l("</"),l(t),l(">")):u(t)},chars:function(e){!1===n.ignoring&&l(a.transformText?a.transformText(e):e)}};function l(t){e.push(t)}function c(e){s.voids[e]||(!1===n.ignoring?n={ignoring:e,depth:1}:n.ignoring===e&&n.depth++)}function u(e){n.ignoring===e&&--n.depth<=0&&h()}function h(){n={ignoring:!1,depth:0}}}},{"./attributes":1,"./elements":3,"./lowercase":5,he:9}],9:[function(e,t,n){var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},o=/(&amp;|&lt;|&gt;|&quot;|&#39;)/g,s=/[&<>"']/g;function a(e){return i[e]}function l(e){return r[e]}function c(e){return null==e?"":String(e).replace(s,a)}function u(e){return null==e?"":String(e).replace(o,l)}c.options=u.options={},t.exports={encode:c,escape:c,decode:u,unescape:u,version:"1.0.0-browser"}},{}],10:[function(e,t,n){function i(e,t){return e[t]=!0,e}t.exports=function(e){return e.reduce(i,{})}},{}]},{},[4]);var DCe,NCe=LCe;const ICe=null===(DCe=window.trustedTypes)||void 0===DCe?void 0:DCe.createPolicy("insane",{createHTML:(e,t)=>NCe(e,t)});function TCe(e,t={},n={}){var i;const r=Dme(t),o=function(t){let n;try{n=vZ(decodeURIComponent(t))}catch(zWe){}return n?(n=cQ(n,(t=>e.uris&&e.uris[t]?_K.revive(e.uris[t]):void 0)),encodeURIComponent(JSON.stringify(n))):t},s=function(t,n){const i=e.uris&&e.uris[t];if(!i)return t;let r=_K.revive(i);return _K.parse(t).toString()===r.toString()?t:n?q$.asBrowserUri(r).toString(!0):(r.query&&(r=r.with({query:o(r.query)})),r.toString())};let a;const l=new Promise((e=>a=e)),c=new kCe.exports.Renderer;if(c.image=(e,n,i)=>{let r=[],o=[];if(e){({href:e,dimensions:r}=function(e){const t=[],n=e.split("|").map((e=>e.trim()));e=n[0];const i=n[1];if(i){const e=/height=(\d+)/.exec(i),n=/width=(\d+)/.exec(i),r=e?e[1]:"",o=n?n[1]:"",s=isFinite(parseInt(o)),a=isFinite(parseInt(r));s&&t.push(`width="${o}"`),a&&t.push(`height="${r}"`)}return{href:e,dimensions:t}}(e)),e=s(e,!0);try{const n=_K.parse(e);t.baseUrl&&n.scheme===j$.file&&(e=NZ(t.baseUrl,e).toString())}catch(a){}o.push(`src="${e}"`)}return i&&o.push(`alt="${i}"`),n&&o.push(`title="${n}"`),r.length&&(o=o.concat(r)),"<img "+o.join(" ")+">"},c.link=(n,i,r)=>{if(n===r&&(r=U_e(r)),n=s(n,!1),t.baseUrl){/^\w[\w\d+.-]*:/.test(n)||(n=NZ(t.baseUrl,n).toString())}return i=U_e(i),!(n=U_e(n))||n.match(/^data:|javascript:/i)||n.match(/^command:/i)&&!e.isTrusted||n.match(/^command:(\/\/\/)?_workbench\.downloadResource/i)?r:`<a href="#" data-href="${n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}" title="${i||n}">${r}</a>`},c.paragraph=t=>{if(e.supportThemeIcons){t=tme(t).map((e=>"string"==typeof e?e:e.outerHTML)).join("")}return`<p>${t}</p>`},t.codeBlockRenderer&&(c.code=(e,n)=>{const i=t.codeBlockRenderer(n,e),o=hme.nextId(),s=Promise.all([i,l]).then((e=>{const t=r.querySelector(`div[data-code="${o}"]`);t&&zY(t,e[0])})).catch((e=>{}));return t.asyncRenderCallback&&s.then(t.asyncRenderCallback),`<div class="code" data-code="${o}">${iX(e)}</div>`}),t.actionHandler){const e=t.actionHandler.disposeables.add(new Xae(r,"click")),n=t.actionHandler.disposeables.add(new Xae(r,"auxclick"));t.actionHandler.disposeables.add(SG.any(e.event,n.event)((e=>{const n=new L$(e);if(!n.leftButton&&!n.middleButton)return;let i=n.target;if("A"===i.tagName||(i=i.parentElement,i&&"A"===i.tagName))try{const e=i.dataset.href;e&&t.actionHandler.callback(e,n)}catch(r){nG(r)}finally{n.preventDefault()}})))}n.sanitizer=t=>(e.isTrusted?t.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?t:"",n.sanitize=!0,n.silent=!0,n.renderer=c;let u=null!==(i=e.value)&&void 0!==i?i:"";u.length>1e5&&(u=`${u.substr(0,1e5)}…`),e.supportThemeIcons&&(u=u.replace(Fhe,(e=>`\\${e}`)));const h=kCe.exports.parse(u,n);if(r.innerHTML=function(e,t){var n;const i=function(e){const t=[j$.http,j$.https,j$.mailto,j$.data,j$.file,j$.vscodeRemote,j$.vscodeRemoteResource];e.isTrusted&&t.push(j$.command);return{allowedSchemes:t,allowedTags:["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"],allowedAttributes:{a:["href","name","target","data-href"],img:["src","title","alt","width","height"],div:["class","data-code"],span:["class","style"],th:["align"],td:["align"]},filter:t=>"span"!==t.tag||!e.isTrusted||(t.attrs.style&&1===Object.keys(t.attrs).length?!!t.attrs.style.match(/^(color\:#[0-9a-fA-F]+;)?(background-color\:#[0-9a-fA-F]+;)?$/):!!t.attrs.class&&!!t.attrs.class.match(/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/))}}(e);return null!==(n=null==ICe?void 0:ICe.createHTML(t,i))&&void 0!==n?n:NCe(t,i)}(e,h),a(),t.asyncRenderCallback)for(const d of r.getElementsByTagName("img")){const e=Q$(d,"load",(()=>{e.dispose(),t.asyncRenderCallback()}))}return r}var MCe,ACe=function(e,t){return function(n,i){t(n,i,e)}},OCe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let RCe=class e{constructor(e,t,n){this._options=e,this._modeService=t,this._openerService=n,this._onDidRenderAsync=new EG,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,n){const i=new pG;let r;return r=e?TCe(e,Object.assign(Object.assign({},this._getRenderOptions(e,i)),t),n):document.createElement("span"),{element:r,dispose:()=>i.dispose()}}_getRenderOptions(t,n){return{baseUrl:this._options.baseUrl,codeBlockRenderer:(t,n)=>OCe(this,void 0,void 0,(function*(){var i,r,o,s;let a;t?a=this._modeService.getModeIdForLanguageName(t):this._options.editor&&(a=null===(i=this._options.editor.getModel())||void 0===i?void 0:i.getLanguageIdentifier().language),a||(a="plaintext"),this._modeService.triggerMode(a);const l=null!==(r=yield YJ.getPromise(a))&&void 0!==r?r:void 0,c=document.createElement("span");c.innerHTML=null!==(s=null===(o=e._ttpTokenizer)||void 0===o?void 0:o.createHTML(n,l))&&void 0!==s?s:$se(n,l);let u=this._options.codeBlockFontFamily;return this._options.editor&&(u=this._options.editor.getOption(40).fontFamily),u&&(c.style.fontFamily=u),c})),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:e=>this._openerService.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:t.isTrusted}).catch(nG),disposeables:n}}}};function PCe(e,t,n){const i=NJ.ordered(e).map((i=>Promise.resolve(i.provideHover(e,t,n)).then((e=>e&&function(e){const t=void 0!==e.range,n=void 0!==e.contents&&e.contents&&e.contents.length>0;return t&&n}(e)?e:void 0),(e=>{iG(e)}))));return Promise.all(i).then(A1)}RCe._ttpTokenizer=null===(MCe=window.trustedTypes)||void 0===MCe?void 0:MCe.createPolicy("tokenizeToString",{createHTML:(e,t)=>$se(e,t)}),RCe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ACe(1,t0),ACe(2,ZZ)],RCe),a6("_executeHoverProvider",((e,t)=>PCe(e,t,TG.None)));var FCe=function(e,t){return function(n,i){t(n,i,e)}},BCe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const WCe=GY;class zCe{constructor(e,t,n){this.owner=e,this.range=t,this.contents=n}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let VCe=class{constructor(e,t,n,i,r){this._editor=e,this._hover=t,this._modeService=n,this._openerService=i,this._configurationService=r}createLoadingMessage(e){return new zCe(this,e.range,[(new z_e).appendText(GH(0,"Loading..."))])}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type)return[];const n=this._editor.getModel(),i=e.range.startLineNumber,r=n.getLineMaxColumn(i),o=[];for(const a of t){const t=a.range.startLineNumber===i?a.range.startColumn:1,n=a.range.endLineNumber===i?a.range.endColumn:r,s=a.options.hoverMessage;if(!s||V_e(s))continue;const l=new TK(e.range.startLineNumber,t,e.range.startLineNumber,n);o.push(new zCe(this,l,j1(s)))}const s=this._editor.getModel().getLineLength(i);return s>=this._configurationService.getValue("editor.maxTokenizationLineLength")&&o.push(new zCe(this,new TK(i,1,i,s+1),[{value:GH(0,"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}])),o}computeAsync(e,t,n){return BCe(this,void 0,void 0,(function*(){if(!this._editor.hasModel()||1!==e.type)return Promise.resolve([]);const t=this._editor.getModel();if(!NJ.has(t))return Promise.resolve([]);const i=yield PCe(t,new IK(e.range.startLineNumber,e.range.startColumn),n),r=[];for(const n of i){if(V_e(n.contents))continue;const t=n.range?TK.lift(n.range):e.range;r.push(new zCe(this,t,n.contents))}return r}))}renderHoverParts(e,t,n){const i=new pG;for(const r of e)for(const e of r.contents){if(V_e(e))continue;const n=WCe("div.hover-row.markdown-hover"),r=WY(n,WCe("div.hover-contents")),o=i.add(new RCe({editor:this._editor},this._modeService,this._openerService));i.add(o.onDidRenderAsync((()=>{r.className="hover-contents code-hover-contents",this._hover.onContentsChanged()})));const s=i.add(o.render(e));r.appendChild(s.element),t.appendChild(n)}return i}};VCe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([FCe(2,t0),FCe(3,ZZ),FCe(4,j3)],VCe);class UCe{constructor(e,t){this.priority=e,this.range=t,this.type=1}equals(e){return 1===e.type&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return 1===e.type&&t.lineNumber===this.range.startLineNumber}}class HCe{constructor(e,t,n){this.priority=e,this.owner=t,this.range=n,this.type=2}equals(e){return 2===e.type&&this.owner===e.owner}canAdoptVisibleHover(e,t){return 2===e.type&&this.owner===e.owner}}var jCe,GCe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},KCe=function(e,t){return function(n,i){t(n,i,e)}};const qCe=null===(jCe=window.trustedTypes)||void 0===jCe?void 0:jCe.createPolicy("editorGhostText",{createHTML:e=>e});let $Ce=class extends mG{constructor(e,t,n,i){super(),this.editor=e,this.model=t,this.codeEditorService=n,this.themeService=i,this.disposed=!1,this.partsWidget=this._register(new YCe(this.editor,this.codeEditorService,this.themeService)),this.additionalLinesWidget=this._register(new ZCe(this.editor)),this.viewMoreContentWidget=void 0,this._register(this.editor.onDidChangeConfiguration((e=>{(e.hasChanged(27)||e.hasChanged(103)||e.hasChanged(86)||e.hasChanged(80)||e.hasChanged(41)||e.hasChanged(40)||e.hasChanged(56))&&this.update()}))),this._register(gG((()=>{var e;this.disposed=!0,this.update(),null===(e=this.viewMoreContentWidget)||void 0===e||e.dispose(),this.viewMoreContentWidget=void 0}))),this._register(t.onDidChange((()=>{this.update()}))),this.update()}shouldShowHoverAtViewZone(e){return this.additionalLinesWidget.viewZoneId===e}update(){var e;const t=this.model.ghostText;if(!this.editor.hasModel()||!t||this.disposed)return this.partsWidget.clear(),void this.additionalLinesWidget.clear();const n=new Array,i=new Array;function r(e,t){if(i.length>0){const n=i[i.length-1];t&&n.decorations.push(new d2(n.content.length+1,n.content.length+1+e[0].length,t,0)),n.content+=e[0],e=e.slice(1)}for(const n of e)i.push({content:n,decorations:t?[new d2(1,n.length+1,t,0)]:[]})}const o=this.editor.getModel().getLineContent(t.lineNumber);let s;this.editor.getModel().getLineTokens(t.lineNumber);let a=0;for(const l of t.parts){let e=l.lines;void 0===s?(n.push({column:l.column,text:e[0]}),e=e.slice(1)):r([o.substring(a,l.column-1)],void 0),e.length>0&&(r(e,"ghost-text"),void 0===s&&l.column<=o.length&&(s=l.column)),a=l.column-1}void 0!==s&&r([o.substring(a)],void 0),this.partsWidget.setParts(t.lineNumber,n,void 0!==s?{column:s,length:o.length+1-s}:void 0),this.additionalLinesWidget.updateLines(t.lineNumber,i,t.additionalReservedLineCount),t.parts.some((e=>e.lines.length<0))?this.viewMoreContentWidget=this.renderViewMoreLines(new IK(t.lineNumber,this.editor.getModel().getLineMaxColumn(t.lineNumber)),"",0):(null===(e=this.viewMoreContentWidget)||void 0===e||e.dispose(),this.viewMoreContentWidget=void 0)}renderViewMoreLines(e,t,n){const i=this.editor.getOption(40),r=document.createElement("div");r.className="suggest-preview-additional-widget",D6.applyFontInfoSlow(r,i);const o=document.createElement("span");o.className="content-spacer",o.append(t),r.append(o);const s=document.createElement("span");s.className="content-newline suggest-preview-text",s.append("⏎  "),r.append(s);const a=new pG,l=document.createElement("div");return l.className="button suggest-preview-text",l.append(`+${n} lines…`),a.add(eY(l,"mousedown",(e=>{var t;null===(t=this.model)||void 0===t||t.setExpanded(!0),e.preventDefault(),this.editor.focus()}))),r.append(l),new JCe(this.editor,e,r,a)}};$Ce=GCe([KCe(2,o$),KCe(3,B5)],$Ce);let YCe=class{constructor(e,t,n){this.editor=e,this.codeEditorService=t,this.themeService=n,this.decorationIds=[],this.disposableStore=new pG}dispose(){this.clear(),this.disposableStore.dispose()}clear(){this.editor.deltaDecorations(this.decorationIds,[]),this.disposableStore.clear()}setParts(e,t,n){this.disposableStore.clear();const i=this.themeService.getColorTheme(),r=i.getColor(Mie);let o,s;r&&(o=String(r.rgba.a),s=Q8.Format.CSS.format(XCe(r)));const a=i.getColor(Tie);let l;a&&(l=`2px dashed ${a}`);const c=this.editor.getModel();if(!c)return;const{tabSize:u}=c.getOptions(),h=c.getLineContent(e)||"";let d=0,f="";const g=new Array;n&&g.push({range:TK.fromPositions(new IK(e,n.column),new IK(e,n.column+n.length)),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}}),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,t.map((t=>{f+=h.substring(d,t.column-1),d=t.column-1;const n=this.renderSingleLineText(t.text,f,u,!1),i=this.disposableStore.add(function(e,t,n,i){const r=n+QCe++;return e.registerDecorationType(t,r,i),{dispose(){e.removeDecorationType(r)},resolve:()=>e.resolveDecorationOptions(r,!0)}}(this.codeEditorService,"ghost-text","0-ghost-text-",{after:{contentText:n,opacity:o,color:s,border:l}}));return{range:TK.fromPositions(new IK(e,t.column)),options:Object.assign({},i.resolve())}})).concat(g))}renderSingleLineText(e,t,n,i){const r=t+e,o=M7.visibleColumnsByColumns(r,n);let s="",a=t.length+1;for(const l of e){if("\t"===l){const e=o[a+1]-o[a];if(i){s+="→";for(let t=1;t<e;t++)s+=" "}else for(let t=0;t<e;t++)s+=" "}else s+=" "===l?i?"·":" ":l;a+=1}return s}};function XCe(e){const{r:t,b:n,g:i}=e.rgba;return new Q8(new Y8(t,i,n,255))}YCe=GCe([KCe(1,o$),KCe(2,B5)],YCe);class ZCe{constructor(e){this.editor=e,this._viewZoneId=void 0}get viewZoneId(){return this._viewZoneId}dispose(){this.clear()}clear(){this.editor.changeViewZones((e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)}))}updateLines(e,t,n){const i=this.editor.getModel();if(!i)return;const{tabSize:r}=i.getOptions();this.editor.changeViewZones((i=>{this._viewZoneId&&(i.removeZone(this._viewZoneId),this._viewZoneId=void 0);const o=Math.max(t.length,n);if(o>0){const n=document.createElement("div");!function(e,t,n,i){const r=i.get(27),o=i.get(103),s="none",a=i.get(80),l=i.get(41),c=i.get(40),u=i.get(56),h=E0(1e4);h.appendASCIIString('<div class="suggest-preview-text">');for(let g=0,p=n.length;g<p;g++){const e=n[g],i=e.content;h.appendASCIIString('<div class="view-line'),h.appendASCIIString('" style="top:'),h.appendASCIIString(String(g*u)),h.appendASCIIString('px;width:1000000px;">');const d=PX(i),f=AX(i),p=u2.createEmpty(i);w2(new v2(c.isMonospace&&!r,c.canUseHalfwidthRightwardsArrow,i,!1,d,f,0,p,e.decorations,t,0,c.spaceWidth,c.middotWidth,c.wsmiddotWidth,o,s,a,l!==zj.OFF,null),h),h.appendASCIIString("</div>")}h.appendASCIIString("</div>"),D6.applyFontInfoSlow(e,c);const d=h.build(),f=qCe?qCe.createHTML(d):d;e.innerHTML=f}(n,r,t,this.editor.getOptions()),this._viewZoneId=i.addZone({afterLineNumber:e,heightInLines:o,domNode:n})}}))}}let QCe=0;class JCe extends mG{constructor(e,t,n,i){super(),this.editor=e,this.position=t,this.domNode=n,this.allowEditorOverflow=!1,this.suppressMouseDown=!1,this._register(i),this._register(gG((()=>{this.editor.removeContentWidget(this)}))),this.editor.addContentWidget(this)}getId(){return"editor.widget.viewMoreLinesWidget"}getDomNode(){return this.domNode}getPosition(){return{position:this.position,preference:[0]}}}G5(((e,t)=>{const n=e.getColor(Mie);if(n){const e=String(n.rgba.a),i=Q8.Format.CSS.format(XCe(n));t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { opacity: ${e}; color: ${i}; }`)}const i=e.getColor(Tie);i&&t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { border: 2px dashed ${i}; }`)}));class eSe{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||(null===(t=this._value)||void 0===t||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,null===(e=this._value)||void 0===e||e.dispose(),this._value=void 0}replace(e){const t=this._value;return this._value=e,t}}class tSe{constructor(e,t,n=0){this.lineNumber=e,this.parts=t,this.additionalReservedLineCount=n}}class nSe extends mG{constructor(e){super(),this.editor=e,this._expanded=void 0,this.onDidChangeEmitter=new EG,this.onDidChange=this.onDidChangeEmitter.event,this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(104)&&void 0===this._expanded&&this.onDidChangeEmitter.fire()})))}get expanded(){return void 0===this._expanded||this._expanded}setExpanded(e){this._expanded=!0,this.onDidChangeEmitter.fire()}}var iSe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let rSe,oSe=class extends mG{constructor(e,t){super(),this.editor=e,this.commandService=t,this.onDidChangeEmitter=new EG,this.onDidChange=this.onDidChangeEmitter.event,this.completionSession=this._register(new eSe),this.active=!1,this._register(t.onDidExecuteCommand((t=>{new Set([v6.id,y6.id,kre.Tab.id,kre.DeleteLeft.id,kre.DeleteRight.id]).has(t.commandId)&&e.hasTextFocus()&&this.handleUserInput()}))),this._register(this.editor.onDidType((e=>{this.handleUserInput()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.session&&!this.session.isValid&&this.hide()})))}handleUserInput(){this.session&&!this.session.isValid&&this.hide(),setTimeout((()=>{this.startSessionIfTriggered()}),0)}get session(){return this.completionSession.value}get ghostText(){var e;return null===(e=this.session)||void 0===e?void 0:e.ghostText}get minReservedLineCount(){return this.session?this.session.minReservedLineCount:0}get expanded(){return!!this.session&&this.session.expanded}setExpanded(e){var t;null===(t=this.session)||void 0===t||t.setExpanded(e)}setActive(e){var t;this.active=e,e&&(null===(t=this.session)||void 0===t||t.scheduleAutomaticUpdate())}startSessionIfTriggered(){this.editor.getOption(52).enabled&&(this.session&&this.session.isValid||this.trigger())}trigger(){this.completionSession.value||(this.completionSession.value=new sSe(this.editor,this.editor.getPosition(),(()=>this.active),this.commandService),this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange((()=>{this.onDidChangeEmitter.fire()}))))}hide(){this.completionSession.clear(),this.onDidChangeEmitter.fire()}commitCurrentSuggestion(){var e;null===(e=this.session)||void 0===e||e.commitCurrentCompletion()}showNext(){var e;null===(e=this.session)||void 0===e||e.showNextInlineCompletion()}showPrevious(){var e;null===(e=this.session)||void 0===e||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return iSe(this,void 0,void 0,(function*(){const t=yield null===(e=this.session)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};oSe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,KZ)],oSe);class sSe extends nSe{constructor(e,t,n,i){let r;super(e),this.triggerPosition=t,this.shouldUpdate=n,this.commandService=i,this.minReservedLineCount=0,this.updateOperation=this._register(new eSe),this.cache=this._register(new eSe),this.updateSoon=this._register(new z$((()=>this.update(yJ.Automatic)),50)),this.textModel=this.editor.getModel(),this.currentlySelectedCompletionId=void 0,this._register(this.onDidChange((()=>{const e=this.currentCompletion;if(e&&e.sourceInlineCompletion!==r){r=e.sourceInlineCompletion;const t=e.sourceProvider;t.handleItemDidShow&&t.handleItemDidShow(e.sourceInlineCompletions,r)}}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.cache.value&&this.onDidChangeEmitter.fire()}))),this._register(this.editor.onDidChangeModelContent((e=>{if(this.cache.value){let e=!1;for(const t of this.cache.value.completions){const n=this.textModel.getDecorationRange(t.decorationId);n?t.synchronizedRange.equalsRange(n)||(e=!0,t.synchronizedRange=n):nG(new Error("Decoration has no range"))}e&&this.onDidChangeEmitter.fire()}this.scheduleAutomaticUpdate()}))),this._register(LJ.onDidChange((()=>{this.updateSoon.schedule()}))),this.scheduleAutomaticUpdate()}fixAndGetIndexOfCurrentSelection(){if(!this.currentlySelectedCompletionId||!this.cache.value)return 0;if(0===this.cache.value.completions.length)return 0;const e=this.cache.value.completions.findIndex((e=>e.semanticId===this.currentlySelectedCompletionId));return-1===e?(this.currentlySelectedCompletionId=void 0,0):e}get currentCachedCompletion(){if(this.cache.value)return this.cache.value.completions[this.fixAndGetIndexOfCurrentSelection()]}showNextInlineCompletion(){var e;return iSe(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const t=(null===(e=this.cache.value)||void 0===e?void 0:e.completions)||[];if(t.length>0){const e=(this.fixAndGetIndexOfCurrentSelection()+1)%t.length;this.currentlySelectedCompletionId=t[e].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}showPreviousInlineCompletion(){var e;return iSe(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const t=(null===(e=this.cache.value)||void 0===e?void 0:e.completions)||[];if(t.length>0){const e=(this.fixAndGetIndexOfCurrentSelection()+t.length-1)%t.length;this.currentlySelectedCompletionId=t[e].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}ensureUpdateWithExplicitContext(){var e;return iSe(this,void 0,void 0,(function*(){this.updateOperation.value?this.updateOperation.value.triggerKind===yJ.Explicit?yield this.updateOperation.value.promise:yield this.update(yJ.Explicit):(null===(e=this.cache.value)||void 0===e?void 0:e.triggerKind)!==yJ.Explicit&&(yield this.update(yJ.Explicit))}))}hasMultipleInlineCompletions(){var e;return iSe(this,void 0,void 0,(function*(){return yield this.ensureUpdateWithExplicitContext(),((null===(e=this.cache.value)||void 0===e?void 0:e.completions.length)||0)>1}))}get ghostText(){const e=this.currentCompletion,t=this.editor.getOptions().get(52).mode;return e?uSe(e,this.editor.getModel(),t,this.editor.getSelection().getEndPosition()):void 0}get currentCompletion(){const e=this.currentCachedCompletion;if(e)return{text:e.inlineCompletion.text,range:e.synchronizedRange,command:e.inlineCompletion.command,sourceProvider:e.inlineCompletion.sourceProvider,sourceInlineCompletions:e.inlineCompletion.sourceInlineCompletions,sourceInlineCompletion:e.inlineCompletion.sourceInlineCompletion}}get isValid(){return this.editor.getPosition().lineNumber===this.triggerPosition.lineNumber}scheduleAutomaticUpdate(){this.updateOperation.clear(),this.updateSoon.schedule()}update(e){return iSe(this,void 0,void 0,(function*(){if(!this.shouldUpdate())return;const t=this.editor.getPosition(),n=I$((n=>iSe(this,void 0,void 0,(function*(){let i;try{i=yield function(e,t,n,i=TG.None){return iSe(this,void 0,void 0,(function*(){const r=function(e,t){const n=t.getWordAtPosition(e),i=t.getLineMaxColumn(e.lineNumber);return n?new TK(e.lineNumber,n.startColumn,e.lineNumber,i):TK.fromPositions(e,e.with(void 0,i))}(e,t),o=LJ.all(t),s=yield Promise.all(o.map((r=>iSe(this,void 0,void 0,(function*(){const o=yield r.provideInlineCompletions(t,e,n,i);return{completions:o,provider:r,dispose:()=>{o&&r.freeInlineCompletions(o)}}}))))),a=new Map;for(const e of s){const t=e.completions;if(t)for(const n of t.items.map((n=>({text:n.text,range:n.range?TK.lift(n.range):r,command:n.command,sourceProvider:e.provider,sourceInlineCompletions:t,sourceInlineCompletion:n}))))n.range.startLineNumber===n.range.endLineNumber&&a.set(JSON.stringify({text:n.text,range:n.range}),n)}return{items:[...a.values()],dispose:()=>{for(const e of s)e.dispose()}}}))}(t,this.editor.getModel(),{triggerKind:e},n)}catch(zWe){return void nG(zWe)}n.isCancellationRequested||(this.cache.value=new lSe(this.editor,i,(()=>this.onDidChangeEmitter.fire()),e),this.onDidChangeEmitter.fire())})))),i=new aSe(n,e);this.updateOperation.value=i,yield n,this.updateOperation.value===i&&this.updateOperation.clear()}))}takeOwnership(e){this._register(e)}commitCurrentCompletion(){if(!this.ghostText)return;const e=this.currentCompletion;e&&this.commit(e)}commit(e){const t=this.cache.replace(void 0);this.editor.executeEdits("inlineSuggestion.accept",[H3.replaceMove(e.range,e.text)]),e.command?this.commandService.executeCommand(e.command.id,...e.command.arguments||[]).finally((()=>{null==t||t.dispose()})).then(void 0,iG):null==t||t.dispose(),this.onDidChangeEmitter.fire()}}class aSe{constructor(e,t){this.promise=e,this.triggerKind=t}dispose(){this.promise.cancel()}}class lSe extends mG{constructor(e,t,n,i){super(),this.triggerKind=i;const r=e.deltaDecorations([],t.items.map((e=>({range:e.range,options:{description:"inline-completion-tracking-range"}}))));this._register(gG((()=>{e.deltaDecorations(r,[])}))),this.completions=t.items.map(((e,t)=>new cSe(e,r[t]))),this._register(e.onDidChangeModelContent((()=>{let t=!1;const i=e.getModel();for(const e of this.completions){const n=i.getDecorationRange(e.decorationId);n?e.synchronizedRange.equalsRange(n)||(t=!0,e.synchronizedRange=n):nG(new Error("Decoration has no range"))}t&&n()}))),this._register(t)}}class cSe{constructor(e,t){this.inlineCompletion=e,this.decorationId=t,this.semanticId=JSON.stringify({text:this.inlineCompletion.text,startLine:this.inlineCompletion.range.startLineNumber,startColumn:this.inlineCompletion.range.startColumn,command:this.inlineCompletion.command}),this.synchronizedRange=e.range}}function uSe(e,t,n,i){if(e.range.startLineNumber!==e.range.endLineNumber)return;const r=t.getValueInRange(e.range),o=function(e,t){if((null==rSe?void 0:rSe.originalValue)===e&&(null==rSe?void 0:rSe.newValue)===t)return null==rSe?void 0:rSe.changes;{const n=X0(e,t,!1);return rSe={originalValue:e,newValue:t,changes:n},n}}(r,e.text),s=e.range.startLineNumber,a=new Array;if("prefix"===n){const e=o.filter((e=>0===e.originalLength));if(e.length>1||1===e.length&&e[0].originalStart!==r.length)return}for(const l of o){const n=e.range.startColumn+l.originalStart+l.originalLength;if(i&&i.lineNumber===e.range.startLineNumber&&n<i.column)return;if(l.originalLength>0){const e=r.substr(l.originalStart,l.originalLength),i=t.getLineFirstNonWhitespaceColumn(s);if(!/^(\t| )*$/.test(e)||!(0===i||n<=i))return}if(0===l.modifiedLength)continue;const o=uX(e.text.substr(l.modifiedStart,l.modifiedLength));a.push({column:n,lines:o})}return new tSe(s,a,0)}class hSe{constructor(){this.value="",this.pos=0}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let e,t=this.pos,n=0,i=this.value.charCodeAt(t);if(e=hSe._table[i],"number"==typeof e)return this.pos+=1,{type:e,pos:t,len:1};if(hSe.isDigitCharacter(i)){e=8;do{n+=1,i=this.value.charCodeAt(t+n)}while(hSe.isDigitCharacter(i));return this.pos+=n,{type:e,pos:t,len:n}}if(hSe.isVariableCharacter(i)){e=9;do{i=this.value.charCodeAt(t+ ++n)}while(hSe.isVariableCharacter(i)||hSe.isDigitCharacter(i));return this.pos+=n,{type:e,pos:t,len:n}}e=10;do{n+=1,i=this.value.charCodeAt(t+n)}while(!isNaN(i)&&void 0===hSe._table[i]&&!hSe.isDigitCharacter(i)&&!hSe.isVariableCharacter(i));return this.pos+=n,{type:e,pos:t,len:n}}}hSe._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};class dSe{constructor(){this._children=[]}appendChild(e){return e instanceof fSe&&this._children[this._children.length-1]instanceof fSe?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){const{parent:n}=e,i=n.children.indexOf(e),r=n.children.slice(0);r.splice(i,1,...t),n._children=r,function e(t,n){for(const i of t)i.parent=n,e(i.children,i)}(t,n)}get children(){return this._children}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof wSe)return e;e=e.parent}}toString(){return this.children.reduce(((e,t)=>e+t.toString()),"")}len(){return 0}}class fSe extends dSe{constructor(e){super(),this.value=e}toString(){return this.value}len(){return this.value.length}clone(){return new fSe(this.value)}}class gSe extends dSe{}class pSe extends gSe{constructor(e){super(),this.index=e}static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0}get isFinalTabstop(){return 0===this.index}get choice(){return 1===this._children.length&&this._children[0]instanceof mSe?this._children[0]:void 0}clone(){let e=new pSe(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map((e=>e.clone())),e}}class mSe extends dSe{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof fSe&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){let e=new mSe;return this.options.forEach(e.appendChild,e),e}}class vSe extends dSe{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(e){const t=this;let n=!1,i=e.replace(this.regexp,(function(){return n=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))}));return!n&&this._children.some((e=>e instanceof ySe&&Boolean(e.elseValue)))&&(i=this._replace([])),i}_replace(e){let t="";for(const n of this._children)if(n instanceof ySe){let i=e[n.index]||"";i=n.resolve(i),t+=i}else t+=n.toString();return t}toString(){return""}clone(){let e=new vSe;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map((e=>e.clone())),e}}class ySe extends dSe{constructor(e,t,n,i){super(),this.index=e,this.shorthandName=t,this.ifValue=n,this.elseValue=i}resolve(e){return"upcase"===this.shorthandName?e?e.toLocaleUpperCase():"":"downcase"===this.shorthandName?e?e.toLocaleLowerCase():"":"capitalize"===this.shorthandName?e?e[0].toLocaleUpperCase()+e.substr(1):"":"pascalcase"===this.shorthandName?e?this._toPascalCase(e):"":"camelcase"===this.shorthandName?e?this._toCamelCase(e):"":Boolean(e)&&"string"==typeof this.ifValue?this.ifValue:Boolean(e)||"string"!=typeof this.elseValue?e||"":this.elseValue}_toPascalCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map((e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())).join(""):e}_toCamelCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map(((e,t)=>0===t?e.toLowerCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())).join(""):e}clone(){return new ySe(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class _Se extends gSe{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),void 0!==t&&(this._children=[new fSe(t)],!0)}clone(){const e=new _Se(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map((e=>e.clone())),e}}function bSe(e,t){const n=[...e];for(;n.length>0;){const e=n.shift();if(!t(e))break;n.unshift(...e.children)}}class wSe extends dSe{get placeholderInfo(){if(!this._placeholders){let e,t=[];this.walk((function(n){return n instanceof pSe&&(t.push(n),e=!e||e.index<n.index?n:e),!0})),this._placeholders={all:t,last:e}}return this._placeholders}get placeholders(){const{all:e}=this.placeholderInfo;return e}offset(e){let t=0,n=!1;return this.walk((i=>i===e?(n=!0,!1):(t+=i.len(),!0))),n?t:-1}fullLen(e){let t=0;return bSe([e],(e=>(t+=e.len(),!0))),t}enclosingPlaceholders(e){let t=[],{parent:n}=e;for(;n;)n instanceof pSe&&t.push(n),n=n.parent;return t}resolveVariables(e){return this.walk((t=>(t instanceof _Se&&t.resolve(e)&&(this._placeholders=void 0),!0))),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}clone(){let e=new wSe;return this._children=this.children.map((e=>e.clone())),e}walk(e){bSe(this.children,e)}}class CSe{constructor(){this._scanner=new hSe,this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}parse(e,t,n){this._scanner.text(e),this._token=this._scanner.next();const i=new wSe;for(;this._parse(i););const r=new Map,o=[];let s=0;i.walk((e=>(e instanceof pSe&&(s+=1,e.isFinalTabstop?r.set(0,void 0):!r.has(e.index)&&e.children.length>0?r.set(e.index,e.children):o.push(e)),!0)));for(const a of o){const e=r.get(a.index);if(e){const t=new pSe(a.index);t.transform=a.transform;for(const n of e)t.appendChild(n.clone());i.replace(a,[t])}}return n||(n=s>0&&t),!r.has(0)&&n&&i.appendChild(new pSe(0)),i}_accept(e,t){if(void 0===e||this._token.type===e){let e=!t||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),e}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){const t=this._token;for(;this._token.type!==e;){if(14===this._token.type)return!1;if(5===this._token.type){const e=this._scanner.next();if(0!==e.type&&4!==e.type&&5!==e.type)return!1}this._token=this._scanner.next()}const n=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),n}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return!!(t=this._accept(5,!0))&&(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new fSe(t)),!0)}_parseTabstopOrVariableName(e){let t;const n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new pSe(Number(t)):new _Se(t)),!0):this._backTo(n)}_parseComplexPlaceholder(e){let t;const n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);const i=new pSe(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(i),!0;if(!this._parse(i))return e.appendChild(new fSe("${"+t+":")),i.children.forEach(e.appendChild,e),!0}else{if(!(i.index>0&&this._accept(7)))return this._accept(6)?this._parseTransform(i)?(e.appendChild(i),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(i),!0):this._backTo(n);{const t=new mSe;for(;;){if(this._parseChoiceElement(t)){if(this._accept(2))continue;if(this._accept(7)&&(i.appendChild(t),this._accept(4)))return e.appendChild(i),!0}return this._backTo(n),!1}}}}_parseChoiceElement(e){const t=this._token,n=[];for(;2!==this._token.type&&7!==this._token.type;){let e;if(e=(e=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||e:this._accept(void 0,!0),!e)return this._backTo(t),!1;n.push(e)}return 0===n.length?(this._backTo(t),!1):(e.appendChild(new fSe(n.join(""))),!0)}_parseComplexVariable(e){let t;const n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);const i=new _Se(t);if(!this._accept(1))return this._accept(6)?this._parseTransform(i)?(e.appendChild(i),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(i),!0):this._backTo(n);for(;;){if(this._accept(4))return e.appendChild(i),!0;if(!this._parse(i))return e.appendChild(new fSe("${"+t+":")),i.children.forEach(e.appendChild,e),!0}}_parseTransform(e){let t=new vSe,n="",i="";for(;!this._accept(6);){let e;if(e=this._accept(5,!0))e=this._accept(6,!0)||e,n+=e;else{if(14===this._token.type)return!1;n+=this._accept(void 0,!0)}}for(;!this._accept(6);){let e;if(e=this._accept(5,!0))e=this._accept(5,!0)||this._accept(6,!0)||e,t.appendChild(new fSe(e));else if(!this._parseFormatString(t)&&!this._parseAnything(t))return!1}for(;!this._accept(4);){if(14===this._token.type)return!1;i+=this._accept(void 0,!0)}try{t.regexp=new RegExp(n,i)}catch(zWe){return!1}return e.transform=t,!0}_parseFormatString(e){const t=this._token;if(!this._accept(0))return!1;let n=!1;this._accept(3)&&(n=!0);let i=this._accept(8,!0);if(!i)return this._backTo(t),!1;if(!n)return e.appendChild(new ySe(Number(i))),!0;if(this._accept(4))return e.appendChild(new ySe(Number(i))),!0;if(!this._accept(1))return this._backTo(t),!1;if(this._accept(6)){let n=this._accept(9,!0);return n&&this._accept(4)?(e.appendChild(new ySe(Number(i),n)),!0):(this._backTo(t),!1)}if(this._accept(11)){let t=this._until(4);if(t)return e.appendChild(new ySe(Number(i),void 0,t,void 0)),!0}else if(this._accept(12)){let t=this._until(4);if(t)return e.appendChild(new ySe(Number(i),void 0,void 0,t)),!0}else if(this._accept(13)){let t=this._until(1);if(t){let n=this._until(4);if(n)return e.appendChild(new ySe(Number(i),void 0,t,n)),!0}}else{let t=this._until(4);if(t)return e.appendChild(new ySe(Number(i),void 0,void 0,t)),!0}return this._backTo(t),!1}_parseAnything(e){return 14!==this._token.type&&(e.appendChild(new fSe(this._scanner.tokenText(this._token))),this._accept(void 0),!0)}}function SSe(e){const t=e;return"string"==typeof(null==t?void 0:t.id)&&_K.isUri(t.uri)}const xSe=new Uint8Array(16),ESe=[];for(let VWe=0;VWe<256;VWe++)ESe.push(VWe.toString(16).padStart(2,"0"));let kSe;kSe="object"==typeof crypto&&"function"==typeof crypto.getRandomValues?crypto.getRandomValues.bind(crypto):function(e){for(let t=0;t<e.length;t++)e[t]=Math.floor(256*Math.random());return e};class LSe{constructor(e){this._delegates=e}resolve(e){for(const t of this._delegates){let n=t.resolve(e);if(void 0!==n)return n}}}class DSe{constructor(e,t,n,i){this._model=e,this._selection=t,this._selectionIdx=n,this._overtypingCapturer=i}resolve(e){const{name:t}=e;if("SELECTION"===t||"TM_SELECTED_TEXT"===t){let t=this._model.getValueInRange(this._selection)||void 0,n=this._selection.startLineNumber!==this._selection.endLineNumber;if(!t&&this._overtypingCapturer){const e=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);e&&(t=e.value,n=e.multiline)}if(t&&n&&e.snippet){const n=dX(this._model.getLineContent(this._selection.startLineNumber),0,this._selection.startColumn-1);let i=n;e.snippet.walk((t=>t!==e&&(t instanceof fSe&&(i=dX(uX(t.value).pop())),!0)));const r=xX(i,n);t=t.replace(/(\r\n|\r|\n)(.*)/g,((e,t,n)=>`${t}${i.substr(r)}${n}`))}return t}if("TM_CURRENT_LINE"===t)return this._model.getLineContent(this._selection.positionLineNumber);if("TM_CURRENT_WORD"===t){const e=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return e&&e.word||void 0}return"TM_LINE_INDEX"===t?String(this._selection.positionLineNumber-1):"TM_LINE_NUMBER"===t?String(this._selection.positionLineNumber):void 0}}class NSe{constructor(e,t){this._labelService=e,this._model=t}resolve(e){const{name:t}=e;if("TM_FILENAME"===t)return uK(this._model.uri.fsPath);if("TM_FILENAME_BASE"===t){const e=uK(this._model.uri.fsPath),t=e.lastIndexOf(".");return t<=0?e:e.slice(0,t)}return"TM_DIRECTORY"===t&&this._labelService?"."===cK(this._model.uri.fsPath)?"":this._labelService.getUriLabel(kZ(this._model.uri)):"TM_FILEPATH"===t&&this._labelService?this._labelService.getUriLabel(this._model.uri):"RELATIVE_FILEPATH"===t&&this._labelService?this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0}):void 0}}class ISe{constructor(e,t,n,i){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=n,this._spread=i}resolve(e){if("CLIPBOARD"!==e.name)return;const t=this._readClipboardText();if(t){if(this._spread){const e=t.split(/\r\n|\n|\r/).filter((e=>!eX(e)));if(e.length===this._selectionCount)return e[this._selectionIdx]}return t}}}class TSe{constructor(e,t){this._model=e,this._selection=t}resolve(e){const{name:t}=e,n=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),i=q0.getComments(n);if(i)return"LINE_COMMENT"===t?i.lineCommentToken||void 0:"BLOCK_COMMENT_START"===t?i.blockCommentStartToken||void 0:"BLOCK_COMMENT_END"===t&&i.blockCommentEndToken||void 0}}class MSe{resolve(e){const{name:t}=e;return"CURRENT_YEAR"===t?String((new Date).getFullYear()):"CURRENT_YEAR_SHORT"===t?String((new Date).getFullYear()).slice(-2):"CURRENT_MONTH"===t?String((new Date).getMonth().valueOf()+1).padStart(2,"0"):"CURRENT_DATE"===t?String((new Date).getDate().valueOf()).padStart(2,"0"):"CURRENT_HOUR"===t?String((new Date).getHours().valueOf()).padStart(2,"0"):"CURRENT_MINUTE"===t?String((new Date).getMinutes().valueOf()).padStart(2,"0"):"CURRENT_SECOND"===t?String((new Date).getSeconds().valueOf()).padStart(2,"0"):"CURRENT_DAY_NAME"===t?MSe.dayNames[(new Date).getDay()]:"CURRENT_DAY_NAME_SHORT"===t?MSe.dayNamesShort[(new Date).getDay()]:"CURRENT_MONTH_NAME"===t?MSe.monthNames[(new Date).getMonth()]:"CURRENT_MONTH_NAME_SHORT"===t?MSe.monthNamesShort[(new Date).getMonth()]:"CURRENT_SECONDS_UNIX"===t?String(Math.floor(Date.now()/1e3)):void 0}}MSe.dayNames=[GH(0,"Sunday"),GH(0,"Monday"),GH(0,"Tuesday"),GH(0,"Wednesday"),GH(0,"Thursday"),GH(0,"Friday"),GH(0,"Saturday")],MSe.dayNamesShort=[GH(0,"Sun"),GH(0,"Mon"),GH(0,"Tue"),GH(0,"Wed"),GH(0,"Thu"),GH(0,"Fri"),GH(0,"Sat")],MSe.monthNames=[GH(0,"January"),GH(0,"February"),GH(0,"March"),GH(0,"April"),GH(0,"May"),GH(0,"June"),GH(0,"July"),GH(0,"August"),GH(0,"September"),GH(0,"October"),GH(0,"November"),GH(0,"December")],MSe.monthNamesShort=[GH(0,"Jan"),GH(0,"Feb"),GH(0,"Mar"),GH(0,"Apr"),GH(0,"May"),GH(0,"Jun"),GH(0,"Jul"),GH(0,"Aug"),GH(0,"Sep"),GH(0,"Oct"),GH(0,"Nov"),GH(0,"Dec")];class ASe{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;const t=(n=this._workspaceService.getWorkspace()).configuration?{id:n.id,configPath:n.configuration}:1===n.folders.length?{id:n.id,uri:n.folders[0].uri}:void 0;var n;return t?"WORKSPACE_NAME"===e.name?this._resolveWorkspaceName(t):"WORKSPACE_FOLDER"===e.name?this._resoveWorkspacePath(t):void 0:void 0}_resolveWorkspaceName(e){if(SSe(e))return uK(e.uri.path);let t=uK(e.configPath.path);return t.endsWith("code-workspace")&&(t=t.substr(0,t.length-"code-workspace".length-1)),t}_resoveWorkspacePath(e){if(SSe(e))return hwe(e.uri.fsPath);let t=uK(e.configPath.path),n=e.configPath.fsPath;return n.endsWith(t)&&(n=n.substr(0,n.length-t.length-1)),n?hwe(n):"/"}}class OSe{resolve(e){const{name:t}=e;return"RANDOM"===t?Math.random().toString().slice(-6):"RANDOM_HEX"===t?Math.random().toString(16).slice(-6):"UUID"===t?function(){kSe(xSe),xSe[6]=15&xSe[6]|64,xSe[8]=63&xSe[8]|128;let e=0,t="";return t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+="-",t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+="-",t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+="-",t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+="-",t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t+=ESe[xSe[e++]],t}():void 0}}G5(((e,t)=>{function n(t){const n=e.getColor(t);return n?n.toString():"transparent"}t.addRule(`.monaco-editor .snippet-placeholder { background-color: ${n(Pne)}; outline-color: ${n(Fne)}; }`),t.addRule(`.monaco-editor .finish-snippet-placeholder { background-color: ${n(Bne)}; outline-color: ${n(Wne)}; }`)}));class RSe{constructor(e,t,n,i){this._editor=e,this._snippet=t,this._offset=n,this._snippetLineLeadingWhitespace=i,this._nestingLevel=1,this._placeholderGroups=M1(t.placeholders,pSe.compareByIndex),this._placeholderGroupsIdx=-1}dispose(){this._placeholderDecorations&&this._editor.deltaDecorations([...this._placeholderDecorations.values()],[]),this._placeholderGroups.length=0}_initDecorations(){if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const e=this._editor.getModel();this._editor.changeDecorations((t=>{for(const n of this._snippet.placeholders){const i=this._snippet.offset(n),r=this._snippet.fullLen(n),o=TK.fromPositions(e.getPositionAt(this._offset+i),e.getPositionAt(this._offset+i+r)),s=n.isFinalTabstop?RSe._decor.inactiveFinal:RSe._decor.inactive,a=t.addDecoration(o,s);this._placeholderDecorations.set(n,a)}}))}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){let e=[];for(const t of this._placeholderGroups[this._placeholderGroupsIdx])if(t.transform){const n=this._placeholderDecorations.get(t),i=this._editor.getModel().getDecorationRange(n),r=this._editor.getModel().getValueInRange(i),o=t.transform.resolve(r).split(/\r\n|\r|\n/);for(let e=1;e<o.length;e++)o[e]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+o[e]);e.push(H3.replace(i,o.join(this._editor.getModel().getEOL())))}e.length>0&&this._editor.executeEdits("snippet.placeholderTransform",e)}let t=!1;!0===e&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):!1===e&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);const n=this._editor.getModel().changeDecorations((e=>{const n=new Set,i=[];for(const r of this._placeholderGroups[this._placeholderGroupsIdx]){const o=this._placeholderDecorations.get(r),s=this._editor.getModel().getDecorationRange(o);i.push(new MK(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(r),e.changeDecorationOptions(o,r.isFinalTabstop?RSe._decor.activeFinal:RSe._decor.active),n.add(r);for(const t of this._snippet.enclosingPlaceholders(r)){const i=this._placeholderDecorations.get(t);e.changeDecorationOptions(i,t.isFinalTabstop?RSe._decor.activeFinal:RSe._decor.active),n.add(t)}}for(const[t,r]of this._placeholderDecorations)n.has(t)||e.changeDecorationOptions(r,t.isFinalTabstop?RSe._decor.inactiveFinal:RSe._decor.inactive);return i}));return t?this.move(e):null!=n?n:[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof pSe){const e=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(e).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||0===this._placeholderGroups.length}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}computePossibleSelections(){const e=new Map;for(const t of this._placeholderGroups){let n;for(const i of t){if(i.isFinalTabstop)break;n||(n=[],e.set(i.index,n));const t=this._placeholderDecorations.get(i),r=this._editor.getModel().getDecorationRange(t);if(!r){e.delete(i.index);break}n.push(r)}}return e}get choice(){return this._placeholderGroups[this._placeholderGroupsIdx][0].choice}merge(e){const t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations((n=>{for(const i of this._placeholderGroups[this._placeholderGroupsIdx]){const r=e.shift();console.assert(!r._placeholderDecorations);const o=r._snippet.placeholderInfo.last.index;for(const e of r._snippet.placeholderInfo.all)e.isFinalTabstop?e.index=i.index+(o+1)/this._nestingLevel:e.index=i.index+e.index/this._nestingLevel;this._snippet.replace(i,r._snippet.children);const s=this._placeholderDecorations.get(i);n.removeDecoration(s),this._placeholderDecorations.delete(i);for(const e of r._snippet.placeholders){const i=r._snippet.offset(e),o=r._snippet.fullLen(e),s=TK.fromPositions(t.getPositionAt(r._offset+i),t.getPositionAt(r._offset+i+o)),a=n.addDecoration(s,RSe._decor.inactive);this._placeholderDecorations.set(e,a)}}this._placeholderGroups=M1(this._snippet.placeholders,pSe.compareByIndex)}))}}RSe._decor={active:v7.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:v7.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:v7.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:v7.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};const PSe={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};class FSe{constructor(e,t,n=PSe){this._templateMerges=[],this._snippets=[],this._editor=e,this._template=t,this._options=n}static adjustWhitespace(e,t,n,i,r){const o=dX(e.getLineContent(t.lineNumber),0,t.column-1);let s;return n.walk((t=>{if(!(t instanceof fSe)||t.parent instanceof mSe)return!0;const r=t.value.split(/\r\n|\r|\n/);if(i){const i=n.offset(t);if(0===i)r[0]=e.normalizeIndentation(r[0]);else{s=null!=s?s:n.toString();let t=s.charCodeAt(i-1);10!==t&&13!==t||(r[0]=e.normalizeIndentation(o+r[0]))}for(let t=1;t<r.length;t++)r[t]=e.normalizeIndentation(o+r[t])}const a=r.join(e.getEOL());return a!==t.value&&(t.parent.replace(t,[new fSe(a)]),s=void 0),!0})),o}static adjustSelection(e,t,n,i){if(0!==n||0!==i){const{positionLineNumber:r,positionColumn:o}=t,s=o-n,a=o+i,l=e.validateRange({startLineNumber:r,startColumn:s,endLineNumber:r,endColumn:a});t=MK.createWithDirection(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn,t.getDirection())}return t}static createEditsAndSnippets(e,t,n,i,r,o,s,a){const l=[],c=[];if(!e.hasModel())return{edits:l,snippets:c};const u=e.getModel(),h=e.invokeWithinContext((e=>e.get(p4,r$))),d=e.invokeWithinContext((e=>new NSe(e.get(pde,r$),u))),f=()=>s;let g=0,p=u.getValueInRange(FSe.adjustSelection(u,e.getSelection(),n,0)),m=u.getValueInRange(FSe.adjustSelection(u,e.getSelection(),0,i)),v=u.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber);const y=e.getSelections().map(((e,t)=>({selection:e,idx:t}))).sort(((e,t)=>TK.compareRangesUsingStarts(e.selection,t.selection)));for(const{selection:_,idx:b}of y){let s=FSe.adjustSelection(u,_,n,0),w=FSe.adjustSelection(u,_,0,i);p!==u.getValueInRange(s)&&(s=_),m!==u.getValueInRange(w)&&(w=_);const C=_.setStartPosition(s.startLineNumber,s.startColumn).setEndPosition(w.endLineNumber,w.endColumn),S=(new CSe).parse(t,!0,r),x=C.getStartPosition(),E=FSe.adjustWhitespace(u,x,S,o||b>0&&v!==u.getLineFirstNonWhitespaceColumn(_.positionLineNumber),!0);S.resolveVariables(new LSe([d,new ISe(f,b,y.length,"spread"===e.getOption(68)),new DSe(u,_,b,a),new TSe(u,_),new MSe,new ASe(h),new OSe]));const k=u.getOffsetAt(x)+g;g+=S.toString().length-u.getValueLengthInRange(C),l[b]=H3.replace(C,S.toString()),l[b].identifier={major:b,minor:0},c[b]=new RSe(e,S,k,E)}return{edits:l,snippets:c}}dispose(){dG(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:e,snippets:t}=FSe.createEditsAndSnippets(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer);this._snippets=t,this._editor.executeEdits("snippet",e,(e=>this._snippets[0].hasPlaceholder?this._move(!0):e.filter((e=>!!e.identifier)).map((e=>MK.fromPositions(e.range.getEndPosition()))))),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=PSe){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);const{edits:n,snippets:i}=FSe.createEditsAndSnippets(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer);this._editor.executeEdits("snippet",n,(e=>{for(const t of this._snippets)t.merge(i);return console.assert(0===i.length),this._snippets[0].hasPlaceholder?this._move(void 0):e.filter((e=>!!e.identifier)).map((e=>MK.fromPositions(e.range.getEndPosition())))}))}next(){const e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){const e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){const t=[];for(const n of this._snippets){const i=n.move(e);t.push(...i)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get choice(){return this._snippets[0].choice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;let t=new Map;for(const n of this._snippets){const i=n.computePossibleSelections();if(0===t.size)for(const[n,r]of i){r.sort(TK.compareRangesUsingStarts);for(const i of e)if(r[0].containsRange(i)){t.set(n,[]);break}}if(0===t.size)return!1;t.forEach(((e,t)=>{e.push(...i.get(t))}))}e.sort(TK.compareRangesUsingStarts);for(let[n,i]of t)if(i.length===e.length){i.sort(TK.compareRangesUsingStarts);for(let r=0;r<i.length;r++)i[r].containsRange(e[r])||t.delete(n)}else t.delete(n);return t.size>0}}var BSe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const WSe={Visible:new M5("suggestWidgetVisible",!1,GH(0,"Whether suggestion are visible")),DetailsVisible:new M5("suggestWidgetDetailsVisible",!1,GH(0,"Whether suggestion details are visible")),MultipleSuggestions:new M5("suggestWidgetMultipleSuggestions",!1,GH(0,"Whether there are multiple suggestions to pick from")),MakesTextEdit:new M5("suggestionMakesTextEdit",!0,GH(0,"Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new M5("acceptSuggestionOnEnter",!0,GH(0,"Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new M5("suggestionHasInsertAndReplaceRange",!1,GH(0,"Whether the current suggestion has insert and replace behaviour")),InsertMode:new M5("suggestionInsertMode",void 0,{type:"string",description:GH(0,"Whether the default behaviour is to insert or replace")}),CanResolve:new M5("suggestionCanResolve",!1,GH(0,"Whether the current suggestion supports to resolve further details"))},zSe=new Y5("suggestWidgetStatusBar");class VSe{constructor(e,t,n,i){this.position=e,this.completion=t,this.container=n,this.provider=i,this.isInvalid=!1,this.score=Nhe.Default,this.distance=0,this.textLabel="string"==typeof t.label?t.label:t.label.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),TK.isIRange(t.range)?(this.editStart=new IK(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new IK(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new IK(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||TK.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new IK(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new IK(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new IK(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||TK.spansMultipleLines(t.range.insert)||TK.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),"function"!=typeof i.resolveCompletionItem&&(this._resolveCache=Promise.resolve(),this._isResolved=!0)}get isResolved(){return!!this._isResolved}resolve(e){return BSe(this,void 0,void 0,(function*(){if(!this._resolveCache){const t=e.onCancellationRequested((()=>{this._resolveCache=void 0,this._isResolved=!1}));this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then((e=>{Object.assign(this.completion,e),this._isResolved=!0,t.dispose()}),(e=>{oG(e)&&(this._resolveCache=void 0,this._isResolved=!1)}))}return this._resolveCache}))}}class USe{constructor(e=2,t=new Set,n=new Set,i=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=n,this.showDeprecated=i}}USe.default=new USe;class HSe{constructor(e,t,n,i){this.items=e,this.needsClipboard=t,this.durations=n,this.disposable=i}}function jSe(e,t,n=USe.default,i={triggerKind:0},r=TG.None){return BSe(this,void 0,void 0,(function*(){const o=new CG(!0);t=t.clone();const s=e.getWordAtPosition(t),a=s?new TK(t.lineNumber,s.startColumn,t.lineNumber,s.endColumn):TK.fromPositions(t),l={replace:a,insert:a.setEndPosition(t.lineNumber,t.column)},c=[],u=new pG,h=[];let d=!1;const f=(e,i,r)=>{var o,s,a;if(i){for(let r of i.suggestions)if(!n.kindFilter.has(r.kind)){if(!n.showDeprecated&&(null===(o=null==r?void 0:r.tags)||void 0===o?void 0:o.includes(1)))continue;r.range||(r.range=l),r.sortText||(r.sortText="string"==typeof r.label?r.label:r.label.label),!d&&r.insertTextRules&&4&r.insertTextRules&&(d=CSe.guessNeedsClipboard(r.insertText)),c.push(new VSe(t,r,i,e))}hG(i)&&u.add(i),h.push({providerName:null!==(s=e._debugDisplayName)&&void 0!==s?s:"unkown_provider",elapsedProvider:null!==(a=i.duration)&&void 0!==a?a:-1,elapsedOverall:r.elapsed()})}},g=(()=>BSe(this,void 0,void 0,(function*(){})))();for(let p of kJ.orderedGroups(e)){let o=c.length;if(yield Promise.all(p.map((o=>BSe(this,void 0,void 0,(function*(){if(!(n.providerFilter.size>0)||n.providerFilter.has(o))try{const n=new CG(!0),s=yield o.provideCompletionItems(e,t,i,r);f(o,s,n)}catch(s){iG(s)}}))))),o!==c.length||r.isCancellationRequested)break}return yield g,r.isCancellationRequested?(u.dispose(),Promise.reject(sG())):new HSe(c.sort(qSe(n.snippetSortOrder)),d,{entries:h,elapsed:o.elapsed()},u)}))}function GSe(e,t){if(e.sortTextLow&&t.sortTextLow){if(e.sortTextLow<t.sortTextLow)return-1;if(e.sortTextLow>t.sortTextLow)return 1}return e.completion.label<t.completion.label?-1:e.completion.label>t.completion.label?1:e.completion.kind-t.completion.kind}const KSe=new Map;function qSe(e){return KSe.get(e)}KSe.set(0,(function(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return-1;if(27===t.completion.kind)return 1}return GSe(e,t)})),KSe.set(2,(function(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return 1;if(27===t.completion.kind)return-1}return GSe(e,t)})),KSe.set(1,GSe),qZ.registerCommand("_executeCompletionItemProvider",((e,...t)=>BSe(void 0,void 0,void 0,(function*(){const[n,i,r,o]=t;WZ(_K.isUri(n)),WZ(IK.isIPosition(i)),WZ("string"==typeof r||!r),WZ("number"==typeof o||!o);const s=yield e.get(n0).createModelReference(n);try{const e={incomplete:!1,suggestions:[]},t=[],n=yield jSe(s.object.textEditorModel,IK.lift(i),void 0,{triggerCharacter:r,triggerKind:r?1:0});for(const i of n.items)t.length<(null!=o?o:0)&&t.push(i.resolve(TG.None)),e.incomplete=e.incomplete||i.container.incomplete,e.suggestions.push(i.completion);try{return yield Promise.all(t),e}finally{setTimeout((()=>n.disposable.dispose()),100)}}finally{s.dispose()}}))));const $Se=new class{constructor(){this.onlyOnceSuggestions=[]}provideCompletionItems(){let e={suggestions:this.onlyOnceSuggestions.slice(0)};return this.onlyOnceSuggestions.length=0,e}};kJ.register("*",$Se);var YSe=function(e,t){return function(n,i){t(n,i,e)}};const XSe={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let ZSe=class e{constructor(t,n,i){this._editor=t,this._logService=n,this._snippetListener=new pG,this._modelVersionId=-1,this._inSnippet=e.InSnippetMode.bindTo(i),this._hasNextTabstop=e.HasNextTabstop.bindTo(i),this._hasPrevTabstop=e.HasPrevTabstop.bindTo(i)}static get(t){return t.getContribution(e.ID)}dispose(){var e;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),null===(e=this._session)||void 0===e||e.dispose(),this._snippetListener.dispose()}insert(e,t){try{this._doInsert(e,void 0===t?XSe:Object.assign(Object.assign({},XSe),t))}catch(zWe){this.cancel(),this._logService.error(zWe),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){this._editor.hasModel()&&(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session?this._session.merge(e,t):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new FSe(this._editor,e,t),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent((e=>e.isFlush&&this.cancel()))),this._snippetListener.add(this._editor.onDidChangeModel((()=>this.cancel()))),this._snippetListener.add(this._editor.onDidChangeCursorSelection((()=>this._updateState()))))}_updateState(){if(this._session&&this._editor.hasModel()){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel())return void(this._currentChoice=void 0);const{choice:e}=this._session;var t,n;if(e){if(this._currentChoice!==e){this._currentChoice=e,this._editor.setSelections(this._editor.getSelections().map((e=>MK.fromPositions(e.getStartPosition()))));const[i]=e.options;t=this._editor,n=e.options.map(((e,t)=>({kind:13,label:e.value,insertText:e.value,sortText:"a".repeat(t+1),range:TK.fromPositions(this._editor.getPosition(),this._editor.getPosition().delta(0,i.value.length))}))),setTimeout((()=>{$Se.onlyOnceSuggestions.push(...n),t.getContribution("editor.contrib.suggestController").triggerSuggest((new Set).add($Se))}),0)}}else this._currentChoice=void 0}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){var t;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),null===(t=this._session)||void 0===t||t.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session&&this._session.prev(),this._updateState()}next(){this._session&&this._session.next(),this._updateState()}isInSnippet(){return Boolean(this._inSnippet.get())}};ZSe.ID="snippetController2",ZSe.InSnippetMode=new M5("inSnippetMode",!1,GH(0,"Whether the editor in current in snippet mode")),ZSe.HasNextTabstop=new M5("hasNextTabstop",!1,GH(0,"Whether there is a next tab stop when in snippet mode")),ZSe.HasPrevTabstop=new M5("hasPrevTabstop",!1,GH(0,"Whether there is a previous tab stop when in snippet mode")),ZSe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([YSe(1,K1),YSe(2,A5)],ZSe),d6(ZSe.ID,ZSe);const QSe=r6.bindToContribution(ZSe.get);l6(new QSe({id:"jumpToNextSnippetPlaceholder",precondition:g5.and(ZSe.InSnippetMode,ZSe.HasNextTabstop),handler:e=>e.next(),kbOpts:{weight:130,kbExpr:gre.editorTextFocus,primary:2}})),l6(new QSe({id:"jumpToPrevSnippetPlaceholder",precondition:g5.and(ZSe.InSnippetMode,ZSe.HasPrevTabstop),handler:e=>e.prev(),kbOpts:{weight:130,kbExpr:gre.editorTextFocus,primary:1026}})),l6(new QSe({id:"leaveSnippet",precondition:ZSe.InSnippetMode,handler:e=>e.cancel(!0),kbOpts:{weight:130,kbExpr:gre.editorTextFocus,primary:9,secondary:[1033]}})),l6(new QSe({id:"acceptSnippet",precondition:ZSe.InSnippetMode,handler:e=>e.finish()}));var JSe=function(e,t){return function(n,i){t(n,i,e)}};class exe{constructor(e){this.name=e}select(e,t,n){if(0===n.length)return 0;let i=n[0].score[0];for(let r=0;r<n.length;r++){const{score:e,completion:t}=n[r];if(e[0]!==i)break;if(t.preselect)return r}return 0}}class txe extends exe{constructor(){super("first")}memorize(e,t,n){}toJSON(){}fromJSON(){}}let nxe=class e{constructor(e,t,n){this._storageService=e,this._modeService=t,this._configService=n,this._disposables=new pG,this._persistSoon=new z$((()=>this._saveState()),500),this._disposables.add(e.onWillSaveState((e=>{e.reason===ype.SHUTDOWN&&this._saveState()})))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,n){this._withStrategy(e,t).memorize(e,t,n),this._persistSoon.schedule()}select(e,t,n){return this._withStrategy(e,t).select(e,t,n)}_withStrategy(t,n){var i,r;const o=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:null===(i=this._modeService.getLanguageIdentifier(t.getLanguageIdAtPosition(n.lineNumber,n.column)))||void 0===i?void 0:i.language,resource:t.uri});if((null===(r=this._strategy)||void 0===r?void 0:r.name)!==o){this._saveState();const t=e._strategyCtors.get(o)||txe;this._strategy=new t;try{const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,n=this._storageService.get(`${e._storagePrefix}/${o}`,t);n&&this._strategy.fromJSON(JSON.parse(n))}catch(zWe){}}return this._strategy}_saveState(){if(this._strategy){const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,n=JSON.stringify(this._strategy);this._storageService.store(`${e._storagePrefix}/${this._strategy.name}`,n,t,1)}}};nxe._strategyCtors=new Map([["recentlyUsedByPrefix",class extends exe{constructor(){super("recentlyUsedByPrefix"),this._trie=iZ.forStrings(),this._seq=0}memorize(e,t,n){const{word:i}=e.getWordUntilPosition(t),r=`${e.getLanguageIdentifier().language}/${i}`;this._trie.set(r,{type:n.completion.kind,insertText:n.completion.insertText,touch:this._seq++})}select(e,t,n){let{word:i}=e.getWordUntilPosition(t);if(!i)return super.select(e,t,n);let r=`${e.getLanguageIdentifier().language}/${i}`,o=this._trie.get(r);if(o||(o=this._trie.findSubstr(r)),o)for(let s=0;s<n.length;s++){let{kind:e,insertText:t}=n[s].completion;if(e===o.type&&t===o.insertText)return s}return super.select(e,t,n)}toJSON(){let e=[];return this._trie.forEach(((t,n)=>e.push([n,t]))),e.sort(((e,t)=>-(e[1].touch-t[1].touch))).forEach(((e,t)=>e[1].touch=t)),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(const[t,n]of e)n.type="number"==typeof n.type?n.type:vJ(n.type),this._trie.set(t,n)}}}],["recentlyUsed",class extends exe{constructor(){super("recentlyUsed"),this._cache=new sZ(300,.66),this._seq=0}memorize(e,t,n){const i=`${e.getLanguageIdentifier().language}/${n.textLabel}`;this._cache.set(i,{touch:this._seq++,type:n.completion.kind,insertText:n.completion.insertText})}select(e,t,n){if(0===n.length)return 0;const i=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(i))return super.select(e,t,n);let r=n[0].score[0],o=-1,s=-1,a=-1;for(let l=0;l<n.length&&n[l].score[0]===r;l++){const t=`${e.getLanguageIdentifier().language}/${n[l].textLabel}`,i=this._cache.peek(t);if(i&&i.touch>a&&i.type===n[l].completion.kind&&i.insertText===n[l].completion.insertText&&(a=i.touch,s=l),n[l].completion.preselect&&-1===o)return l}return-1!==s?s:-1!==o?o:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();for(const[t,n]of e)n.touch=0,n.type="number"==typeof n.type?n.type:vJ(n.type),this._cache.set(t,n);this._seq=this._cache.size}}],["first",txe]]),nxe._storagePrefix="suggest/memories",nxe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([JSe(0,vpe),JSe(1,t0),JSe(2,j3)],nxe);const ixe=i$("ISuggestMemories");cle(ixe,nxe,!0);let rxe=class e{constructor(t,n){this._editor=t,this._index=0,this._ckOtherSuggestions=e.OtherSuggestions.bindTo(n)}dispose(){this.reset()}reset(){var e;this._ckOtherSuggestions.reset(),null===(e=this._listener)||void 0===e||e.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:t,index:n},i){if(0===t.items.length)return void this.reset();e._moveIndex(!0,t,n)!==n?(this._acceptNext=i,this._model=t,this._index=n,this._listener=this._editor.onDidChangeCursorPosition((()=>{this._ignore||this.reset()})),this._ckOtherSuggestions.set(!0)):this.reset()}static _moveIndex(e,t,n){let i=n;for(;i=(i+t.items.length+(e?1:-1))%t.items.length,i!==n&&t.items[i].completion.additionalTextEdits;);return i}next(){this._move(!0)}prev(){this._move(!1)}_move(t){if(this._model)try{this._ignore=!0,this._index=e._moveIndex(t,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};rxe.OtherSuggestions=new M5("hasOtherSuggestions",!1),rxe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,A5)],rxe);class oxe{constructor(e,t,n,i,r,o,s){this.clipboardText=s,this._snippetCompareFn=oxe._compareCompletionItems,this._items=e,this._column=t,this._wordDistance=i,this._options=r,this._refilterKind=1,this._lineContext=n,"top"===o?this._snippetCompareFn=oxe._compareCompletionItemsSnippetsUp:"bottom"===o&&(this._snippetCompareFn=oxe._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(e){this._lineContext.leadingLineContent===e.leadingLineContent&&this._lineContext.characterCountDelta===e.characterCountDelta||(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}get allProvider(){return this._ensureCachedState(),this._providerInfo.keys()}get incomplete(){this._ensureCachedState();const e=new Set;for(let[t,n]of this._providerInfo)n&&e.add(t);return e}adopt(e){let t=[];for(let n=0;n<this._items.length;)e.has(this._items[n].provider)?n++:(t.push(this._items[n]),this._items[n]=this._items[this._items.length-1],this._items.pop());return this._refilterKind=1,t}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){0!==this._refilterKind&&this._createCachedState()}_createCachedState(){this._providerInfo=new Map;const e=[],{leadingLineContent:t,characterCountDelta:n}=this._lineContext;let i="",r="";const o=1===this._refilterKind?this._items:this._filteredItems,s=[],a=!this._options.filterGraceful||o.length>2e3?The:Ahe;for(let l=0;l<o.length;l++){const c=o[l];if(c.isInvalid)continue;this._providerInfo.set(c.provider,Boolean(c.container.incomplete));const u=c.position.column-c.editStart.column,h=u+n-(c.position.column-this._column);if(i.length!==h&&(i=0===h?"":t.slice(-h),r=i.toLowerCase()),c.word=i,0===h)c.score=Nhe.Default;else{let e=0;for(;e<u;){const t=i.charCodeAt(e);if(32!==t&&9!==t)break;e+=1}if(e>=h)c.score=Nhe.Default;else if("string"==typeof c.completion.filterText){let t=a(i,r,e,c.completion.filterText,c.filterTextLow,0,!1);if(!t)continue;0===mX(c.completion.filterText,c.textLabel)?c.score=t:(c.score=vhe(i,r,e,c.textLabel,c.labelLow,0),c.score[0]=t[0])}else{let t=a(i,r,e,c.textLabel,c.labelLow,0,!1);if(!t)continue;c.score=t}}c.idx=l,c.distance=this._wordDistance.distance(c.position,c.completion),s.push(c),e.push(c.textLabel.length)}this._filteredItems=s.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?T1(e.length-.85,e,((e,t)=>e-t)):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return 1;if(27===t.completion.kind)return-1}return oxe._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return-1;if(27===t.completion.kind)return 1}return oxe._compareCompletionItems(e,t)}}var sxe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class axe{provideSelectionRanges(e,t){return sxe(this,void 0,void 0,(function*(){const n=[];for(const i of t){const t=[];n.push(t);const r=new Map;yield new Promise((t=>axe._bracketsRightYield(t,0,e,i,r))),yield new Promise((n=>axe._bracketsLeftYield(n,0,e,i,r,t)))}return n}))}static _bracketsRightYield(e,t,n,i,r){const o=new Map,s=Date.now();for(;;){if(t>=axe._maxRounds){e();break}if(!i){e();break}let a=n.findNextBracket(i);if(!a){e();break}if(Date.now()-s>axe._maxDuration){setTimeout((()=>axe._bracketsRightYield(e,t+1,n,i,r)));break}const l=a.close[0];if(a.isOpen){let e=o.has(l)?o.get(l):0;o.set(l,e+1)}else{let e=o.has(l)?o.get(l):0;if(e-=1,o.set(l,Math.max(0,e)),e<0){let e=r.get(l);e||(e=new bG,r.set(l,e)),e.push(a.range)}}i=a.range.getEndPosition()}}static _bracketsLeftYield(e,t,n,i,r,o){const s=new Map,a=Date.now();for(;;){if(t>=axe._maxRounds&&0===r.size){e();break}if(!i){e();break}let l=n.findPrevBracket(i);if(!l){e();break}if(Date.now()-a>axe._maxDuration){setTimeout((()=>axe._bracketsLeftYield(e,t+1,n,i,r,o)));break}const c=l.close[0];if(l.isOpen){let e=s.has(c)?s.get(c):0;if(e-=1,s.set(c,Math.max(0,e)),e<0){let e=r.get(c);if(e){let t=e.shift();0===e.size&&r.delete(c);const i=TK.fromPositions(l.range.getEndPosition(),t.getStartPosition()),s=TK.fromPositions(l.range.getStartPosition(),t.getEndPosition());o.push({range:i}),o.push({range:s}),axe._addBracketLeading(n,s,o)}}}else{let e=s.has(c)?s.get(c):0;s.set(c,e+1)}i=l.range.getStartPosition()}}static _addBracketLeading(e,t,n){if(t.startLineNumber===t.endLineNumber)return;const i=t.startLineNumber,r=e.getLineFirstNonWhitespaceColumn(i);0!==r&&r!==t.startColumn&&(n.push({range:TK.fromPositions(new IK(i,r),t.getEndPosition())}),n.push({range:TK.fromPositions(new IK(i,1),t.getEndPosition())}));const o=i-1;if(o>0){const i=e.getLineFirstNonWhitespaceColumn(o);i===t.startColumn&&i!==e.getLineLastNonWhitespaceColumn(o)&&(n.push({range:TK.fromPositions(new IK(o,i),t.getEndPosition())}),n.push({range:TK.fromPositions(new IK(o,1),t.getEndPosition())}))}}}axe._maxDuration=30,axe._maxRounds=2;var lxe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class cxe{static create(e,t){return lxe(this,void 0,void 0,(function*(){if(!t.getOption(104).localityBonus)return cxe.None;if(!t.hasModel())return cxe.None;const n=t.getModel(),i=t.getPosition();if(!e.canComputeWordRanges(n.uri))return cxe.None;const[r]=yield(new axe).provideSelectionRanges(n,[i]);if(0===r.length)return cxe.None;const o=yield e.computeWordRanges(n.uri,r[0].range);if(!o)return cxe.None;const s=n.getWordUntilPosition(i);return delete o[s.word],new class extends cxe{distance(e,n){if(!i.equals(t.getPosition()))return 0;if(17===n.kind)return 2<<20;let s="string"==typeof n.label?n.label:n.label.label,a=o[s];if(O1(a))return 2<<20;let l=N1(a,TK.fromPositions(e),TK.compareRangesUsingStarts),c=l>=0?a[l]:a[Math.max(0,~l-1)],u=r.length;for(const t of r){if(!TK.containsRange(t.range,c))break;u-=1}return u}}}))}}cxe.None=new class extends cxe{distance(){return 0}};var uxe=function(e,t){return function(n,i){t(n,i,e)}},hxe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class dxe{constructor(e,t,n,i){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.auto=n,this.shy=i}static shouldAutoTrigger(e){if(!e.hasModel())return!1;const t=e.getModel(),n=e.getPosition();t.tokenizeIfCheap(n.lineNumber);const i=t.getWordAtPosition(n);return!!i&&(i.endColumn===n.column&&!!isNaN(Number(i.word)))}}let fxe=class e{constructor(e,t,n,i,r,o,s){this._editor=e,this._editorWorkerService=t,this._clipboardService=n,this._telemetryService=i,this._logService=r,this._contextKeyService=o,this._configurationService=s,this._toDispose=new pG,this._quickSuggestDelay=10,this._triggerCharacterListener=new pG,this._triggerQuickSuggest=new B$,this._state=0,this._completionDisposables=new pG,this._onDidCancel=new EG,this._onDidTrigger=new EG,this._onDidSuggest=new EG,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new MK(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel((()=>{this._updateTriggerCharacters(),this.cancel()}))),this._toDispose.add(this._editor.onDidChangeModelLanguage((()=>{this._updateTriggerCharacters(),this.cancel()}))),this._toDispose.add(this._editor.onDidChangeConfiguration((()=>{this._updateTriggerCharacters(),this._updateQuickSuggest()}))),this._toDispose.add(kJ.onDidChange((()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}))),this._toDispose.add(this._editor.onDidChangeCursorSelection((e=>{this._onCursorChange(e)})));let a=!1;this._toDispose.add(this._editor.onDidCompositionStart((()=>{a=!0}))),this._toDispose.add(this._editor.onDidCompositionEnd((()=>{a=!1,this._refilterCompletionItems()}))),this._toDispose.add(this._editor.onDidChangeModelContent((()=>{a||this._refilterCompletionItems()}))),this._updateTriggerCharacters(),this._updateQuickSuggest()}dispose(){dG(this._triggerCharacterListener),dG([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateQuickSuggest(){this._quickSuggestDelay=this._editor.getOption(77),(isNaN(this._quickSuggestDelay)||!this._quickSuggestDelay&&0!==this._quickSuggestDelay||this._quickSuggestDelay<0)&&(this._quickSuggestDelay=10)}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(78)||!this._editor.hasModel()||!this._editor.getOption(107))return;const e=new Map;for(const n of kJ.all(this._editor.getModel()))for(const t of n.triggerCharacters||[]){let i=e.get(t);i||(i=new Set,i.add(void 0),e.set(t,i)),i.add(n)}const t=t=>{if(n=this._contextKeyService,i=this._configurationService,Boolean(n.getContextKeyValue("inlineSuggestionVisible"))&&!Boolean(i.getValue("editor.inlineSuggest.allowSuggestOnTriggerCharacters")))return;var n,i;if(!t){const e=this._editor.getPosition();t=this._editor.getModel().getLineContent(e.lineNumber).substr(0,e.column-1)}let r="";LX(t.charCodeAt(t.length-1))?kX(t.charCodeAt(t.length-2))&&(r=t.substr(t.length-2)):r=t.charAt(t.length-1);const o=e.get(r);if(o){const e=this._completionModel?{items:this._completionModel.adopt(o),clipboardText:this._completionModel.clipboardText}:void 0;this.trigger({auto:!0,shy:!1,triggerCharacter:r},Boolean(this._completionModel),o,e)}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(t))}get state(){return this._state}cancel(e=!1){var t;0!==this._state&&(this._triggerQuickSuggest.cancel(),null===(t=this._requestToken)||void 0===t||t.cancel(),this._requestToken=void 0,this._state=0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){0!==this._state&&(this._editor.hasModel()&&kJ.has(this._editor.getModel())?this.trigger({auto:2===this._state,shy:!1},!0):this.cancel())}_onCursorChange(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),n=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||0!==e.reason&&3!==e.reason||"keyboard"!==e.source&&"deleteLeft"!==e.source)this.cancel();else if(kJ.has(t))if(0===this._state&&0===e.reason){if(!1===this._editor.getOption(76))return;if(!n.containsRange(this._currentSelection)&&!n.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))return;if(this._editor.getOption(104).snippetsPreventQuickSuggestions&&ZSe.get(this._editor).isInSnippet())return;this.cancel(),this._triggerQuickSuggest.cancelAndSet((()=>{if(0!==this._state)return;if(!dxe.shouldAutoTrigger(this._editor))return;if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition(),n=this._editor.getOption(76);if(!1!==n){if(!0===n);else{e.tokenizeIfCheap(t.lineNumber);const i=e.getLineTokens(t.lineNumber),r=i.getStandardTokenType(i.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(!(n.other&&0===r||n.comments&&1===r||n.strings&&2===r))return}var i,r;if(i=this._contextKeyService,r=this._configurationService,!Boolean(i.getContextKeyValue("inlineSuggestionVisible"))||Boolean(r.getValue("editor.inlineSuggest.allowQuickSuggestions")))this.trigger({auto:!0,shy:!1})}}),this._quickSuggestDelay)}else 0!==this._state&&3===e.reason&&this._refilterCompletionItems()}_refilterCompletionItems(){Promise.resolve().then((()=>{if(0===this._state)return;if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition(),n=new dxe(e,t,2===this._state,!1);this._onNewContext(n)}))}trigger(t,n=!1,i,r){var o;if(!this._editor.hasModel())return;const s=this._editor.getModel(),a=t.auto,l=new dxe(s,this._editor.getPosition(),a,t.shy);this.cancel(n),this._state=a?2:1,this._onDidTrigger.fire({auto:a,shy:t.shy,position:this._editor.getPosition()}),this._context=l;let c={triggerKind:null!==(o=t.triggerKind)&&void 0!==o?o:0};t.triggerCharacter&&(c={triggerKind:1,triggerCharacter:t.triggerCharacter}),this._requestToken=new OG;const u=this._editor.getOption(99);let h=1;switch(u){case"top":h=0;break;case"bottom":h=2}const{itemKind:d,showDeprecated:f}=e._createSuggestFilter(this._editor),g=cxe.create(this._editorWorkerService,this._editor),p=jSe(s,this._editor.getPosition(),new USe(h,d,i,f),c,this._requestToken.token);Promise.all([p,g]).then((([e,n])=>hxe(this,void 0,void 0,(function*(){var i;if(null===(i=this._requestToken)||void 0===i||i.dispose(),!this._editor.hasModel())return;let o=null==r?void 0:r.clipboardText;if(!o&&e.needsClipboard&&(o=yield this._clipboardService.readText()),0===this._state)return;const s=this._editor.getModel();let l=e.items;if(r){const e=qSe(h);l=l.concat(r.items).sort(e)}const c=new dxe(s,this._editor.getPosition(),a,t.shy);this._completionModel=new oxe(l,this._context.column,{leadingLineContent:c.leadingLineContent,characterCountDelta:c.column-this._context.column},n,this._editor.getOption(104),this._editor.getOption(99),o),this._completionDisposables.add(e.disposable),this._onNewContext(c),this._reportDurationsTelemetry(e.durations)})))).catch(nG)}_reportDurationsTelemetry(e){this._telemetryGate++%230==0&&setTimeout((()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)}))}static _createSuggestFilter(e){const t=new Set;"none"===e.getOption(99)&&t.add(27);const n=e.getOption(104);return n.showMethods||t.add(0),n.showFunctions||t.add(1),n.showConstructors||t.add(2),n.showFields||t.add(3),n.showVariables||t.add(4),n.showClasses||t.add(5),n.showStructs||t.add(6),n.showInterfaces||t.add(7),n.showModules||t.add(8),n.showProperties||t.add(9),n.showEvents||t.add(10),n.showOperators||t.add(11),n.showUnits||t.add(12),n.showValues||t.add(13),n.showConstants||t.add(14),n.showEnums||t.add(15),n.showEnumMembers||t.add(16),n.showKeywords||t.add(17),n.showWords||t.add(18),n.showColors||t.add(19),n.showFiles||t.add(20),n.showReferences||t.add(21),n.showColors||t.add(22),n.showFolders||t.add(23),n.showTypeParameters||t.add(24),n.showSnippets||t.add(27),n.showUsers||t.add(25),n.showIssues||t.add(26),{itemKind:t,showDeprecated:n.showDeprecated}}_onNewContext(e){if(this._context)if(e.lineNumber===this._context.lineNumber)if(dX(e.leadingLineContent)===dX(this._context.leadingLineContent)){if(e.column<this._context.column)e.leadingWord.word?this.trigger({auto:this._context.auto,shy:!1},!0):this.cancel();else if(this._completionModel)if(0!==e.leadingWord.word.length&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){const e=new Set(kJ.all(this._editor.getModel()));for(let n of this._completionModel.allProvider)e.delete(n);const t=this._completionModel.adopt(new Set);this.trigger({auto:this._context.auto,shy:!1},!0,e,{items:t,clipboardText:this._completionModel.clipboardText})}else if(e.column>this._context.column&&this._completionModel.incomplete.size>0&&0!==e.leadingWord.word.length){const{incomplete:e}=this._completionModel,t=this._completionModel.adopt(e);this.trigger({auto:2===this._state,shy:!1,triggerKind:2},!0,e,{items:t,clipboardText:this._completionModel.clipboardText})}else{let t=this._completionModel.lineContext,n=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},0===this._completionModel.items.length){if(dxe.shouldAutoTrigger(this._editor)&&this._context.leadingWord.endColumn<e.leadingWord.startColumn)return void this.trigger({auto:this._context.auto,shy:!1},!0);if(this._context.auto)return void this.cancel();if(this._completionModel.lineContext=t,n=this._completionModel.items.length>0,n&&0===e.leadingWord.word.length)return void this.cancel()}this._onDidSuggest.fire({completionModel:this._completionModel,auto:this._context.auto,shy:this._context.shy,isFrozen:n})}}else this.cancel();else this.cancel()}};fxe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([uxe(1,e0),uxe(2,Ule),uxe(3,e6),uxe(4,K1),uxe(5,A5),uxe(6,j3)],fxe);const gxe=_ee("symbolIcon.arrayForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),pxe=_ee("symbolIcon.booleanForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),mxe=_ee("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},GH(0,"The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),vxe=_ee("symbolIcon.colorForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),yxe=_ee("symbolIcon.constantForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),_xe=_ee("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},GH(0,"The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),bxe=_ee("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},GH(0,"The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),wxe=_ee("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},GH(0,"The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Cxe=_ee("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},GH(0,"The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Sxe=_ee("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},GH(0,"The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),xxe=_ee("symbolIcon.fileForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Exe=_ee("symbolIcon.folderForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),kxe=_ee("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},GH(0,"The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Lxe=_ee("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},GH(0,"The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Dxe=_ee("symbolIcon.keyForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Nxe=_ee("symbolIcon.keywordForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Ixe=_ee("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},GH(0,"The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Txe=_ee("symbolIcon.moduleForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Mxe=_ee("symbolIcon.namespaceForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Axe=_ee("symbolIcon.nullForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Oxe=_ee("symbolIcon.numberForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Rxe=_ee("symbolIcon.objectForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Pxe=_ee("symbolIcon.operatorForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Fxe=_ee("symbolIcon.packageForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Bxe=_ee("symbolIcon.propertyForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Wxe=_ee("symbolIcon.referenceForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),zxe=_ee("symbolIcon.snippetForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Vxe=_ee("symbolIcon.stringForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Uxe=_ee("symbolIcon.structForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Hxe=_ee("symbolIcon.textForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),jxe=_ee("symbolIcon.typeParameterForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Gxe=_ee("symbolIcon.unitForeground",{dark:bee,light:bee,hc:bee},GH(0,"The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),Kxe=_ee("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},GH(0,"The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));G5(((e,t)=>{const n=e.getColor(gxe);n&&t.addRule(`${hJ.symbolArray.cssSelector} { color: ${n}; }`);const i=e.getColor(pxe);i&&t.addRule(`${hJ.symbolBoolean.cssSelector} { color: ${i}; }`);const r=e.getColor(mxe);r&&t.addRule(`${hJ.symbolClass.cssSelector} { color: ${r}; }`);const o=e.getColor(Ixe);o&&t.addRule(`${hJ.symbolMethod.cssSelector} { color: ${o}; }`);const s=e.getColor(vxe);s&&t.addRule(`${hJ.symbolColor.cssSelector} { color: ${s}; }`);const a=e.getColor(yxe);a&&t.addRule(`${hJ.symbolConstant.cssSelector} { color: ${a}; }`);const l=e.getColor(_xe);l&&t.addRule(`${hJ.symbolConstructor.cssSelector} { color: ${l}; }`);const c=e.getColor(bxe);c&&t.addRule(`\n\t\t\t${hJ.symbolValue.cssSelector},${hJ.symbolEnum.cssSelector} { color: ${c}; }`);const u=e.getColor(wxe);u&&t.addRule(`${hJ.symbolEnumMember.cssSelector} { color: ${u}; }`);const h=e.getColor(Cxe);h&&t.addRule(`${hJ.symbolEvent.cssSelector} { color: ${h}; }`);const d=e.getColor(Sxe);d&&t.addRule(`${hJ.symbolField.cssSelector} { color: ${d}; }`);const f=e.getColor(xxe);f&&t.addRule(`${hJ.symbolFile.cssSelector} { color: ${f}; }`);const g=e.getColor(Exe);g&&t.addRule(`${hJ.symbolFolder.cssSelector} { color: ${g}; }`);const p=e.getColor(kxe);p&&t.addRule(`${hJ.symbolFunction.cssSelector} { color: ${p}; }`);const m=e.getColor(Lxe);m&&t.addRule(`${hJ.symbolInterface.cssSelector} { color: ${m}; }`);const v=e.getColor(Dxe);v&&t.addRule(`${hJ.symbolKey.cssSelector} { color: ${v}; }`);const y=e.getColor(Nxe);y&&t.addRule(`${hJ.symbolKeyword.cssSelector} { color: ${y}; }`);const _=e.getColor(Txe);_&&t.addRule(`${hJ.symbolModule.cssSelector} { color: ${_}; }`);const b=e.getColor(Mxe);b&&t.addRule(`${hJ.symbolNamespace.cssSelector} { color: ${b}; }`);const w=e.getColor(Axe);w&&t.addRule(`${hJ.symbolNull.cssSelector} { color: ${w}; }`);const C=e.getColor(Oxe);C&&t.addRule(`${hJ.symbolNumber.cssSelector} { color: ${C}; }`);const S=e.getColor(Rxe);S&&t.addRule(`${hJ.symbolObject.cssSelector} { color: ${S}; }`);const x=e.getColor(Pxe);x&&t.addRule(`${hJ.symbolOperator.cssSelector} { color: ${x}; }`);const E=e.getColor(Fxe);E&&t.addRule(`${hJ.symbolPackage.cssSelector} { color: ${E}; }`);const k=e.getColor(Bxe);k&&t.addRule(`${hJ.symbolProperty.cssSelector} { color: ${k}; }`);const L=e.getColor(Wxe);L&&t.addRule(`${hJ.symbolReference.cssSelector} { color: ${L}; }`);const D=e.getColor(zxe);D&&t.addRule(`${hJ.symbolSnippet.cssSelector} { color: ${D}; }`);const N=e.getColor(Vxe);N&&t.addRule(`${hJ.symbolString.cssSelector} { color: ${N}; }`);const I=e.getColor(Uxe);I&&t.addRule(`${hJ.symbolStruct.cssSelector} { color: ${I}; }`);const T=e.getColor(Hxe);T&&t.addRule(`${hJ.symbolText.cssSelector} { color: ${T}; }`);const M=e.getColor(jxe);M&&t.addRule(`${hJ.symbolTypeParameter.cssSelector} { color: ${M}; }`);const A=e.getColor(Gxe);A&&t.addRule(`${hJ.symbolUnit.cssSelector} { color: ${A}; }`);const O=e.getColor(Kxe);O&&t.addRule(`${hJ.symbolVariable.cssSelector} { color: ${O}; }`)}));class qxe{constructor(){let e;this._onDidWillResize=new EG,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new EG,this.onDidResize=this._onDidResize.event,this._sashListener=new pG,this._size=new gY(0,0),this._minSize=new gY(0,0),this._maxSize=new gY(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new sle(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new sle(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new sle(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:Jae.North}),this._southSash=new sle(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:Jae.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let t=0,n=0;this._sashListener.add(SG.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)((()=>{void 0===e&&(this._onDidWillResize.fire(),e=this._size,t=0,n=0)}))),this._sashListener.add(SG.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)((()=>{void 0!==e&&(e=void 0,t=0,n=0,this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(this._eastSash.onDidChange((i=>{e&&(n=i.currentX-i.startX,this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))}))),this._sashListener.add(this._westSash.onDidChange((i=>{e&&(n=-(i.currentX-i.startX),this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))}))),this._sashListener.add(this._northSash.onDidChange((i=>{e&&(t=-(i.currentY-i.startY),this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))}))),this._sashListener.add(this._southSash.onDidChange((i=>{e&&(t=i.currentY-i.startY,this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))}))),this._sashListener.add(SG.any(this._eastSash.onDidReset,this._westSash.onDidReset)((e=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(SG.any(this._northSash.onDidReset,this._southSash.onDidReset)((e=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))})))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,n,i){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=n?3:0,this._westSash.state=i?3:0}layout(e=this.size.height,t=this.size.width){const{height:n,width:i}=this._minSize,{height:r,width:o}=this._maxSize;e=Math.max(n,Math.min(r,e)),t=Math.max(i,Math.min(o,t));const s=new gY(t,e);gY.equals(s,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=s,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}function $xe(e){return!!e&&Boolean(e.completion.documentation||e.completion.detail&&e.completion.detail!==e.completion.label)}let Yxe=class{constructor(e,t){this._editor=e,this._onDidClose=new EG,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new EG,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new pG,this._renderDisposeable=new pG,this._borderWidth=1,this._size=new gY(330,0),this.domNode=GY(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=t.createInstance(RCe,{editor:e}),this._body=GY(".body"),this._scrollbar=new moe(this._body,{}),WY(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=WY(this._body,GY(".header")),this._close=WY(this._header,GY("span"+hJ.close.cssSelector)),this._close.title=GH(0,"Close"),this._type=WY(this._header,GY("p.type")),this._docs=WY(this._body,GY("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(40)&&this._configureFont()})))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const e=this._editor.getOptions(),t=e.get(40),n=t.fontFamily,i=e.get(105)||t.fontSize,r=e.get(106)||t.lineHeight,o=t.fontWeight,s=`${i}px`,a=`${r}px`;this.domNode.style.fontSize=s,this.domNode.style.lineHeight=a,this.domNode.style.fontWeight=o,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=n,this._close.style.height=a,this._close.style.width=a}getLayoutInfo(){const e=this._editor.getOption(106)||this._editor.getOption(40).lineHeight,t=this._borderWidth;return{lineHeight:e,borderWidth:t,borderHeight:2*t,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=GH(0,"Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,2*this.getLayoutInfo().lineHeight),this._onDidChangeContents.fire(this)}renderItem(e,t){var n,i;this._renderDisposeable.clear();let{detail:r,documentation:o}=e.completion;if(t){let t="";t+=`score: ${e.score[0]}\n`,t+=`prefix: ${null!==(n=e.word)&&void 0!==n?n:"(no prefix)"}\n`,t+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}\n`,t+=`distance: ${e.distance} (localityBonus-setting)\n`,t+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}\n`,t+=`commit_chars: ${null===(i=e.completion.commitCharacters)||void 0===i?void 0:i.join("")}\n`,o=(new z_e).appendCodeblock("empty",t),r=`Provider: ${e.provider._debugDisplayName}`}if(t||$xe(e)){if(this.domNode.classList.remove("no-docs","no-type"),r){const e=r.length>1e5?`${r.substr(0,1e5)}…`:r;this._type.textContent=e,this._type.title=e,KY(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gim.test(e))}else Y$(this._type),this._type.title="",qY(this._type),this.domNode.classList.add("no-type");if(Y$(this._docs),"string"==typeof o)this._docs.classList.remove("markdown-docs"),this._docs.textContent=o;else if(o){this._docs.classList.add("markdown-docs"),Y$(this._docs);const e=this._markdownRenderer.render(o);this._docs.appendChild(e.element),this._renderDisposeable.add(e),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync((()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)})))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=e=>{e.preventDefault(),e.stopPropagation()},this._close.onclick=e=>{e.preventDefault(),e.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}else this.clearContents()}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get size(){return this._size}layout(e,t){const n=new gY(e,t);gY.equals(n,this._size)||(this._size=n,function(e,t,n){"number"==typeof t&&(e.style.width=`${t}px`),"number"==typeof n&&(e.style.height=`${n}px`)}(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}};Yxe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,t$)],Yxe);class Xxe{constructor(e,t){let n,i;this.widget=e,this._editor=t,this._disposables=new pG,this._added=!1,this._resizable=new qxe,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let r=0,o=0;this._disposables.add(this._resizable.onDidWillResize((()=>{n=this._topLeft,i=this._resizable.size}))),this._disposables.add(this._resizable.onDidResize((e=>{if(n&&i){this.widget.layout(e.dimension.width,e.dimension.height);let t=!1;e.west&&(o=i.width-e.dimension.width,t=!0),e.north&&(r=i.height-e.dimension.height,t=!0),t&&this._applyTopLeft({top:n.top+r,left:n.left+o})}e.done&&(n=void 0,i=void 0,r=0,o=0,this._userSize=e.dimension)}))),this._disposables.add(this.widget.onDidChangeContents((()=>{var e;this._anchorBox&&this._placeAtAnchor(this._anchorBox,null!==(e=this._userSize)&&void 0!==e?e:this.widget.size)})))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return null}show(){this._added||(this._editor.addOverlayWidget(this),this.getDomNode().style.position="fixed",this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e){var t;const n=mY(e);this._anchorBox=n,this._placeAtAnchor(this._anchorBox,null!==(t=this._userSize)&&void 0!==t?t:this.widget.size)}_placeAtAnchor(e,t){const n=dY(document.body),i=this.widget.getLayoutInfo();let r,o,s,a,l=new gY(220,2*i.lineHeight),c=0,u=e.top,h=e.top+e.height-i.borderHeight,d=n.width-(e.left+e.width+i.borderWidth+i.horizontalPadding);c=-i.borderWidth+e.left+e.width,a=!0,r=new gY(d,n.height-e.top-i.borderHeight-i.verticalPadding),o=r.with(void 0,e.top+e.height-i.borderHeight-i.verticalPadding),t.width>d&&(e.left>d&&(d=e.left-i.borderWidth-i.horizontalPadding,a=!1,c=Math.max(i.horizontalPadding,e.left-t.width-i.borderWidth),r=r.with(d),o=r.with(void 0,o.height)),e.width>1.3*d&&n.height-(e.top+e.height)>e.height&&(d=e.width,c=e.left,u=-i.borderWidth+e.top+e.height,r=new gY(e.width-i.borderHeight,n.height-e.top-e.height-i.verticalPadding),o=r.with(void 0,e.top-i.verticalPadding),l=l.with(r.width)));let f,g=t.height,p=Math.max(r.height,o.height);g>p&&(g=p),g<=r.height?(s=!0,f=r):(s=!1,f=o),this._applyTopLeft({left:c,top:s?u:h-g}),this.getDomNode().style.position="fixed",this._resizable.enableSashes(!s,a,s,!a),this._resizable.minSize=l,this._resizable.maxSize=f,this._resizable.layout(g,Math.min(f.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this.getDomNode().style.left=`${this._topLeft.left}px`,this.getDomNode().style.top=`${this._topLeft.top}px`}}var Zxe=function(e,t){return function(n,i){t(n,i,e)}};class Qxe extends kwe{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();this.label&&(this.label.textContent=GH(0,"{0} ({1})",this._action.label,Qxe.symbolPrintEnter(e)))}static symbolPrintEnter(e){var t;return null===(t=e.getLabel())||void 0===t?void 0:t.replace(/\benter\b/gi,"⏎")}}let Jxe=class{constructor(e,t,n,i){this._menuService=n,this._contextKeyService=i,this._menuDisposables=new pG,this.element=WY(e,GY(".suggest-status-bar"));const r=e=>e instanceof J5?t.createInstance(Qxe,e,void 0):void 0;this._leftActions=new Sle(this.element,{actionViewItemProvider:r}),this._rightActions=new Sle(this.element,{actionViewItemProvider:r}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this.element.remove()}show(){const e=this._menuService.createMenu(zSe,this._contextKeyService),t=()=>{const t=[],n=[];for(let[i,r]of e.getActions())"left"===i?t.push(...r):n.push(...r);this._leftActions.clear(),this._leftActions.push(t),this._rightActions.clear(),this._rightActions.push(n)};this._menuDisposables.add(e.onDidChange((()=>t()))),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};var eEe,tEe;function nEe(e,t,n,i){const r=i===eEe.ROOT_FOLDER?["rootfolder-icon"]:i===eEe.FOLDER?["folder-icon"]:["file-icon"];if(n){let o;if(n.scheme===j$.data){o=IZ.parseMetaData(n).get(IZ.META_DATA_LABEL)}else o=iEe(xZ(n).toLowerCase());if(i===eEe.FOLDER)r.push(`${o}-name-folder-icon`);else{if(o){if(r.push(`${o}-name-file-icon`),o.length<=255){const e=o.split(".");for(let t=1;t<e.length;t++)r.push(`${e.slice(t).join(".")}-ext-file-icon`)}r.push("ext-file-icon")}const i=function(e,t,n){if(!n)return null;let i=null;if(n.scheme===j$.data){const e=IZ.parseMetaData(n).get(IZ.META_DATA_MIME);e&&(i=t.getModeId(e))}else{const t=e.getModel(n);t&&(i=t.getModeId())}if(i&&"plaintext"!==i)return i;return t.getModeIdByFilepathOrFirstLine(n)}(e,t,n);i&&r.push(`${iEe(i)}-lang-file-icon`)}}return r}function iEe(e){return e.replace(/[\11\12\14\15\40]/g,"/")}Jxe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Zxe(1,t$),Zxe(2,X5),Zxe(3,A5)],Jxe),(tEe=eEe||(eEe={}))[tEe.FILE=0]="FILE",tEe[tEe.FOLDER=1]="FOLDER",tEe[tEe.ROOT_FOLDER=2]="ROOT_FOLDER";var rEe,oEe=function(e,t){return function(n,i){t(n,i,e)}};function sEe(e){return`suggest-aria-id:${e}`}const aEe=Ele("suggest-more-info",hJ.chevronRight,GH(0,"Icon for more information in the suggest widget.")),lEe=new((rEe=class e{extract(t,n){if(t.textLabel.match(e._regexStrict))return n[0]=t.textLabel,!0;if(t.completion.detail&&t.completion.detail.match(e._regexStrict))return n[0]=t.completion.detail,!0;if("string"==typeof t.completion.documentation){const i=e._regexRelaxed.exec(t.completion.documentation);if(i&&(0===i.index||i.index+i[0].length===t.completion.documentation.length))return n[0]=i[0],!0}return!1}})._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,rEe._regexStrict=new RegExp(`^${rEe._regexRelaxed.source}$`,"i"),rEe);let cEe=class{constructor(e,t,n,i){this._editor=e,this._modelService=t,this._modeService=n,this._themeService=i,this._onDidToggleDetails=new EG,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=Object.create(null);t.disposables=new pG,t.root=e,t.root.classList.add("show-file-icons"),t.icon=WY(e,GY(".icon")),t.colorspan=WY(t.icon,GY("span.colorspan"));const n=WY(e,GY(".contents")),i=WY(n,GY(".main"));t.iconContainer=WY(i,GY(".icon-label.codicon")),t.left=WY(i,GY("span.left")),t.right=WY(i,GY("span.right")),t.iconLabel=new ame(t.left,{supportHighlights:!0,supportIcons:!0}),t.disposables.add(t.iconLabel),t.parametersLabel=WY(t.left,GY("span.signature-label")),t.qualifierLabel=WY(t.left,GY("span.qualifier-label")),t.detailsLabel=WY(t.right,GY("span.details-label")),t.readMore=WY(t.right,GY("span.readMore"+z5.asCSSSelector(aEe))),t.readMore.title=GH(0,"Read More");const r=()=>{const e=this._editor.getOptions(),n=e.get(40),r=n.fontFamily,o=n.fontFeatureSettings,s=e.get(105)||n.fontSize,a=e.get(106)||n.lineHeight,l=n.fontWeight,c=`${s}px`,u=`${a}px`;t.root.style.fontSize=c,t.root.style.fontWeight=l,i.style.fontFamily=r,i.style.fontFeatureSettings=o,i.style.lineHeight=u,t.icon.style.height=u,t.icon.style.width=u,t.readMore.style.height=u,t.readMore.style.width=u};return r(),t.disposables.add(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(40)||e.hasChanged(105)||e.hasChanged(106))&&r()}))),t}renderElement(e,t,n){const{completion:i}=e;n.root.id=sEe(t),n.colorspan.style.backgroundColor="";const r={labelEscapeNewLines:!0,matches:yhe(e.score)};let o=[];if(19===i.kind&&lEe.extract(e,o))n.icon.className="icon customcolor",n.iconContainer.className="icon hide",n.colorspan.style.backgroundColor=o[0];else if(20===i.kind&&this._themeService.getFileIconTheme().hasFileIcons){n.icon.className="icon hide",n.iconContainer.className="icon hide";const t=nEe(this._modelService,this._modeService,_K.from({scheme:"fake",path:e.textLabel}),eEe.FILE),o=nEe(this._modelService,this._modeService,_K.from({scheme:"fake",path:i.detail}),eEe.FILE);r.extraClasses=t.length>o.length?t:o}else 23===i.kind&&this._themeService.getFileIconTheme().hasFolderIcons?(n.icon.className="icon hide",n.iconContainer.className="icon hide",r.extraClasses=W1([nEe(this._modelService,this._modeService,_K.from({scheme:"fake",path:e.textLabel}),eEe.FOLDER),nEe(this._modelService,this._modeService,_K.from({scheme:"fake",path:i.detail}),eEe.FOLDER)])):(n.icon.className="icon hide",n.iconContainer.className="",n.iconContainer.classList.add("suggest-icon",...mJ(i.kind).split(" ")));i.tags&&i.tags.indexOf(1)>=0&&(r.extraClasses=(r.extraClasses||[]).concat(["deprecated"]),r.matches=[]),n.iconLabel.setLabel(e.textLabel,void 0,r),"string"==typeof i.label?(n.parametersLabel.textContent="",n.detailsLabel.textContent=uEe(i.detail||""),n.root.classList.add("string-label")):(n.parametersLabel.textContent=uEe(i.label.detail||""),n.detailsLabel.textContent=uEe(i.label.description||""),n.root.classList.remove("string-label")),this._editor.getOption(104).showInlineDetails?KY(n.detailsLabel):qY(n.detailsLabel),$xe(e)?(n.right.classList.add("can-expand-details"),KY(n.readMore),n.readMore.onmousedown=e=>{e.stopPropagation(),e.preventDefault()},n.readMore.onclick=e=>{e.stopPropagation(),e.preventDefault(),this._onDidToggleDetails.fire()}):(n.right.classList.remove("can-expand-details"),qY(n.readMore),n.readMore.onmousedown=null,n.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};function uEe(e){return e.replace(/\r\n|\r|\n/g,"")}cEe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([oEe(1,iJ),oEe(2,t0),oEe(3,B5)],cEe);var hEe=function(e,t){return function(n,i){t(n,i,e)}},dEe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const fEe=_ee("editorSuggestWidget.background",{dark:mte,light:mte,hc:mte},GH(0,"Background color of the suggest widget.")),gEe=_ee("editorSuggestWidget.border",{dark:yte,light:yte,hc:yte},GH(0,"Border color of the suggest widget.")),pEe=_ee("editorSuggestWidget.foreground",{dark:pte,light:pte,hc:pte},GH(0,"Foreground color of the suggest widget.")),mEe=_ee("editorSuggestWidget.selectedForeground",{dark:kne,light:kne,hc:kne},GH(0,"Foreground color of the selected entry in the suggest widget.")),vEe=_ee("editorSuggestWidget.selectedIconForeground",{dark:Lne,light:Lne,hc:Lne},GH(0,"Icon foreground color of the selected entry in the suggest widget.")),yEe=_ee("editorSuggestWidget.selectedBackground",{dark:Dne,light:Dne,hc:Dne},GH(0,"Background color of the selected entry in the suggest widget.")),_Ee=_ee("editorSuggestWidget.highlightForeground",{dark:yne,light:yne,hc:yne},GH(0,"Color of the match highlights in the suggest widget.")),bEe=_ee("editorSuggestWidget.focusHighlightForeground",{dark:_ne,light:_ne,hc:_ne},GH(0,"Color of the match highlights in the suggest widget when an item is focused."));class wEe{constructor(e,t){this._service=e,this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof fwe}`}restore(){var e;const t=null!==(e=this._service.get(this._key,0))&&void 0!==e?e:"";try{const e=JSON.parse(t);if(gY.is(e))return gY.lift(e)}catch(n){}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}}let CEe=class e{constructor(e,t,n,i,r){this.editor=e,this._storageService=t,this._state=0,this._isAuto=!1,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new B$,this._disposables=new pG,this._onDidSelect=new EG,this._onDidFocus=new EG,this._onDidHide=new EG,this._onDidShow=new EG,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new EG,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new qxe,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new SEe(this,e),this._persistedSize=new wEe(t,e);class o{constructor(e,t,n=!1,i=!1){this.persistedSize=e,this.currentSize=t,this.persistHeight=n,this.persistWidth=i}}let s;this._disposables.add(this.element.onDidWillResize((()=>{this._contentWidget.lockPreference(),s=new o(this._persistedSize.restore(),this.element.size)}))),this._disposables.add(this.element.onDidResize((e=>{var t,n,i,r;if(this._resize(e.dimension.width,e.dimension.height),s&&(s.persistHeight=s.persistHeight||!!e.north||!!e.south,s.persistWidth=s.persistWidth||!!e.east||!!e.west),e.done){if(s){const{itemHeight:e,defaultSize:o}=this.getLayoutInfo(),a=Math.round(e/2);let{width:l,height:c}=this.element.size;(!s.persistHeight||Math.abs(s.currentSize.height-c)<=a)&&(c=null!==(n=null===(t=s.persistedSize)||void 0===t?void 0:t.height)&&void 0!==n?n:o.height),(!s.persistWidth||Math.abs(s.currentSize.width-l)<=a)&&(l=null!==(r=null===(i=s.persistedSize)||void 0===i?void 0:i.width)&&void 0!==r?r:o.width),this._persistedSize.store(new gY(l,c))}this._contentWidget.unlockPreference(),s=void 0}}))),this._messageElement=WY(this.element.domNode,GY(".message")),this._listElement=WY(this.element.domNode,GY(".tree"));const a=r.createInstance(Yxe,this.editor);a.onDidClose(this.toggleDetails,this,this._disposables),this._details=new Xxe(a,this.editor);const l=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(104).showIcons);l();const c=r.createInstance(cEe,this.editor);this._disposables.add(c),this._disposables.add(c.onDidToggleDetails((()=>this.toggleDetails()))),this._list=new tfe("SuggestWidget",this._listElement,{getHeight:e=>this.getLayoutInfo().itemHeight,getTemplateId:e=>"suggestion"},[c],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,accessibilityProvider:{getRole:()=>"option",getAriaLabel:e=>{if(e.isResolved&&this._isDetailsVisible()){const{documentation:t,detail:n}=e.completion,i=nX("{0}{1}",n||"",t?"string"==typeof t?t:t.value:"");return GH(0,"{0}, docs: {1}",e.textLabel,i)}return e.textLabel},getWidgetAriaLabel:()=>GH(0,"Suggest"),getWidgetRole:()=>"listbox"}}),this._status=r.createInstance(Jxe,this.element.domNode);const u=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(104).showStatusBar);u(),this._disposables.add(tde(this._list,i,{listInactiveFocusBackground:yEe,listInactiveFocusOutline:Eee})),this._disposables.add(i.onDidColorThemeChange((e=>this._onThemeChange(e)))),this._onThemeChange(i.getColorTheme()),this._disposables.add(this._list.onMouseDown((e=>this._onListMouseDownOrTap(e)))),this._disposables.add(this._list.onTap((e=>this._onListMouseDownOrTap(e)))),this._disposables.add(this._list.onDidChangeSelection((e=>this._onListSelection(e)))),this._disposables.add(this._list.onDidChangeFocus((e=>this._onListFocus(e)))),this._disposables.add(this.editor.onDidChangeCursorSelection((()=>this._onCursorSelectionChanged()))),this._disposables.add(this.editor.onDidChangeConfiguration((e=>{e.hasChanged(104)&&(u(),l())}))),this._ctxSuggestWidgetVisible=WSe.Visible.bindTo(n),this._ctxSuggestWidgetDetailsVisible=WSe.DetailsVisible.bindTo(n),this._ctxSuggestWidgetMultipleSuggestions=WSe.MultipleSuggestions.bindTo(n),this._disposables.add(eY(this._details.widget.domNode,"keydown",(e=>{this._onDetailsKeydown.fire(e)}))),this._disposables.add(this.editor.onMouseDown((e=>this._onEditorMouseDown(e))))}dispose(){var e;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),null===(e=this._loadingTimeout)||void 0===e||e.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){0!==this._state&&this._contentWidget.layout()}_onListMouseDownOrTap(e){void 0!==e.element&&void 0!==e.index&&(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const n=this._completionModel;n&&(this._onDidSelect.fire({item:e,index:t,model:n}),this.editor.focus())}_onThemeChange(e){const t=e.getColor(fEe);t&&(this.element.domNode.style.backgroundColor=t.toString(),this._messageElement.style.backgroundColor=t.toString(),this._details.widget.domNode.style.backgroundColor=t.toString());const n=e.getColor(gEe);n&&(this.element.domNode.style.borderColor=n.toString(),this._messageElement.style.borderColor=n.toString(),this._status.element.style.borderTopColor=n.toString(),this._details.widget.domNode.style.borderColor=n.toString(),this._detailsBorderColor=n.toString());const i=e.getColor(See);i&&(this._detailsFocusBorderColor=i.toString()),this._details.widget.borderWidth="hc"===e.type?2:1}_onListFocus(e){var t;if(this._ignoreFocusEvents)return;if(!e.elements.length)return this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),void this.editor.setAriaOptions({activeDescendant:void 0});if(!this._completionModel)return;const n=e.elements[0],i=e.indexes[0];n!==this._focusedItem&&(null===(t=this._currentSuggestionDetails)||void 0===t||t.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=n,this._list.reveal(i),this._currentSuggestionDetails=I$((e=>dEe(this,void 0,void 0,(function*(){const t=P$((()=>{this._isDetailsVisible()&&this.showDetails(!0)}),250);e.onCancellationRequested((()=>t.dispose()));const i=yield n.resolve(e);return t.dispose(),i})))),this._currentSuggestionDetails.then((()=>{i>=this._list.length||n!==this._list.element(i)||(this._ignoreFocusEvents=!0,this._list.splice(i,1,[n]),this._list.setFocus([i]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:sEe(i)}))})).catch(nG)),this._onDidFocus.fire({item:n,index:i,model:this._completionModel})}_setState(t){if(this._state!==t)switch(this._state=t,this.element.domNode.classList.toggle("frozen",4===t),this.element.domNode.classList.remove("message"),t){case 0:qY(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=e.LOADING_MESSAGE,qY(this._listElement,this._status.element),KY(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=e.NO_SUGGESTIONS_MESSAGE,qY(this._listElement,this._status.element),KY(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 3:case 4:qY(this._messageElement),KY(this._listElement,this._status.element),this._show();break;case 5:qY(this._messageElement),KY(this._listElement,this._status.element),this._details.show(),this._show()}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet((()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)}),100)}showTriggered(e,t){0===this._state&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=P$((()=>this._setState(1)),t)))}showSuggestions(e,t,n,i){var r,o;if(this._contentWidget.setPosition(this.editor.getPosition()),null===(r=this._loadingTimeout)||void 0===r||r.dispose(),null===(o=this._currentSuggestionDetails)||void 0===o||o.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),n&&2!==this._state&&0!==this._state)return void this._setState(4);const s=this._completionModel.items.length,a=0===s;if(this._ctxSuggestWidgetMultipleSuggestions.set(s>1),a)return this._setState(i?0:2),void(this._completionModel=void 0);this._focusedItem=void 0,this._list.splice(0,this._list.length,this._completionModel.items),this._setState(n?4:3),this._list.reveal(t,0),this._list.setFocus([t]),this._layout(this.element.size),this._detailsBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsBorderColor)}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(0!==this._state&&2!==this._state&&1!==this._state&&this._completionModel)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){5===this._state?(this._setState(3),this._detailsBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsBorderColor)):3===this._state&&this._isDetailsVisible()&&(this._setState(5),this._detailsFocusBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsFocusBorderColor))}toggleDetails(){this._isDetailsVisible()?(this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):!$xe(this._list.getFocusedElements()[0])&&!this._explainMode||3!==this._state&&5!==this._state&&4!==this._state||(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(e){this._details.show(),e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._positionDetails(),this.editor.focus(),this.element.domNode.classList.add("shows-details")}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var e;null===(e=this._loadingTimeout)||void 0===e||e.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const t=this._persistedSize.restore(),n=Math.ceil(4.3*this.getLayoutInfo().itemHeight);t&&t.height<n&&this._persistedSize.store(t.with(void 0,n))}isFrozen(){return 4===this._state}_afterRender(e){null!==e?2!==this._state&&1!==this._state&&(this._isDetailsVisible()&&this._details.show(),this._positionDetails()):this._isDetailsVisible()&&this._details.hide()}_layout(e){var t,n,i;if(!this.editor.hasModel())return;if(!this.editor.getDomNode())return;const r=dY(document.body),o=this.getLayoutInfo();e||(e=o.defaultSize);let s=e.height,a=e.width;if(this._status.element.style.lineHeight=`${o.itemHeight}px`,2===this._state||1===this._state)s=o.itemHeight+o.borderHeight,a=o.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new gY(a,s),this._contentWidget.setPreference(2);else{const l=r.width-o.borderHeight-2*o.horizontalPadding;a>l&&(a=l);const c=this._completionModel?this._completionModel.stats.pLabelLen*o.typicalHalfwidthCharacterWidth:a,u=o.statusBarHeight+this._list.contentHeight+o.borderHeight,h=o.itemHeight+o.statusBarHeight,d=mY(this.editor.getDomNode()),f=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),g=d.top+f.top+f.height,p=Math.min(r.height-g-o.verticalPadding,u),m=Math.min(d.top+f.top-o.verticalPadding,u);let v=Math.min(Math.max(m,p)+o.borderHeight,u);s===(null===(t=this._cappedHeight)||void 0===t?void 0:t.capped)&&(s=this._cappedHeight.wanted),s<h&&(s=h),s>v&&(s=v);const y=100;s>p||this._forceRenderingAbove&&m>y?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),v=m):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),v=p),this.element.preferredSize=new gY(c,o.defaultSize.height),this.element.maxSize=new gY(l,v),this.element.minSize=new gY(220,h),this._cappedHeight=s===u?{wanted:null!==(i=null===(n=this._cappedHeight)||void 0===n?void 0:n.wanted)&&void 0!==i?i:e.height,capped:s}:void 0}this._resize(a,s)}_resize(e,t){const{width:n,height:i}=this.element.maxSize;e=Math.min(n,e),t=Math.min(i,t);const{statusBarHeight:r}=this.getLayoutInfo();this._list.layout(t-r,e),this._listElement.style.height=t-r+"px",this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode)}getLayoutInfo(){const e=this.editor.getOption(40),t=RQ(this.editor.getOption(106)||e.lineHeight,8,1e3),n=this.editor.getOption(104).showStatusBar&&2!==this._state&&1!==this._state?t:0,i=this._details.widget.borderWidth,r=2*i;return{itemHeight:t,statusBarHeight:n,borderWidth:i,borderHeight:r,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new gY(430,n+12*t+r)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};CEe.LOADING_MESSAGE=GH(0,"Loading..."),CEe.NO_SUGGESTIONS_MESSAGE=GH(0,"No suggestions."),CEe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([hEe(1,vpe),hEe(2,A5),hEe(3,B5),hEe(4,t$)],CEe);class SEe{constructor(e,t){this._widget=e,this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return!this._hidden&&this._position&&this._preference?{position:this._position,preference:[this._preference]}:null}beforeRender(){const{height:e,width:t}=this._widget.element.size,{borderWidth:n,horizontalPadding:i}=this._widget.getLayoutInfo();return new gY(t+2*n+i,e+2*n)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}}G5(((e,t)=>{const n=e.getColor(_Ee);n&&t.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: ${n}; }`);const i=e.getColor(bEe);n&&t.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused .monaco-highlighted-label .highlight { color: ${i}; }`);const r=e.getColor(pEe);r&&t.addRule(`.monaco-editor .suggest-widget, .monaco-editor .suggest-details { color: ${r}; }`);const o=e.getColor(mEe);o&&t.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused { color: ${o}; }`);const s=e.getColor(vEe);s&&t.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused .codicon { color: ${s}; }`);const a=e.getColor(kee);a&&t.addRule(`.monaco-editor .suggest-details a { color: ${a}; }`);const l=e.getColor(Dee);l&&t.addRule(`.monaco-editor .suggest-details code { background-color: ${l}; }`)}));let xEe=class e{constructor(t,n){this._editor=t,this._enabled=!1,this._ckAtEnd=e.AtEnd.bindTo(n),this._configListener=this._editor.onDidChangeConfiguration((e=>e.hasChanged(109)&&this._update())),this._update()}dispose(){var e;this._configListener.dispose(),null===(e=this._selectionListener)||void 0===e||e.dispose(),this._ckAtEnd.reset()}_update(){const e="on"===this._editor.getOption(109);if(this._enabled!==e)if(this._enabled=e,this._enabled){const e=()=>{if(!this._editor.hasModel())return void this._ckAtEnd.set(!1);const e=this._editor.getModel(),t=this._editor.getSelection(),n=e.getWordAtPosition(t.getStartPosition());n?this._ckAtEnd.set(n.endColumn===t.getStartPosition().column):this._ckAtEnd.set(!1)};this._selectionListener=this._editor.onDidChangeCursorSelection(e),e()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};xEe.AtEnd=new M5("atEndOfWord",!1),xEe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,A5)],xEe);class EEe{constructor(e,t,n){this._disposables=new pG,this._disposables.add(t.onDidShow((()=>this._onItem(t.getFocusedItem())))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType((i=>{if(this._active&&!t.isFrozen()){const t=i.charCodeAt(i.length-1);this._active.acceptCharacters.has(t)&&e.getOption(0)&&n(this._active.item)}})))}_onItem(e){if(!e||!R1(e.item.completion.commitCharacters))return void this.reset();if(this._active&&this._active.item.item===e.item)return;const t=new p1;for(const n of e.item.completion.commitCharacters)n.length>0&&t.add(n.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}class kEe{constructor(e,t){this._disposables=new pG,this._lastOvertyped=[],this._empty=!0,this._disposables.add(e.onWillType((()=>{if(!this._empty)return;if(!e.hasModel())return;const t=e.getSelections(),n=t.length;let i=!1;for(let e=0;e<n;e++)if(!t[e].isEmpty()){i=!0;break}if(!i)return;this._lastOvertyped=[];const r=e.getModel();for(let e=0;e<n;e++){const n=t[e];if(r.getValueLengthInRange(n)>kEe._maxSelectionLength)return;this._lastOvertyped[e]={value:r.getValueInRange(n),multiline:n.startLineNumber!==n.endLineNumber}}this._empty=!1}))),this._disposables.add(t.onDidCancel((e=>{this._empty||e.retrigger||(this._empty=!0)})))}getLastOvertypedInfo(e){if(!this._empty&&e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}}kEe._maxSelectionLength=51200;var LEe=function(e,t){return function(n,i){t(n,i,e)}};class DEe{constructor(e,t){this._model=e,this._position=t;if(e.getLineMaxColumn(t.lineNumber)!==t.column){const n=e.getOffsetAt(t),i=e.getPositionAt(n+1);this._marker=e.deltaDecorations([],[{range:TK.fromPositions(t,i),options:{description:"suggest-line-suffix",stickiness:1}}])}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.deltaDecorations(this._marker,[])}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){const t=this._model.getDecorationRange(this._marker[0]);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}return this._model.getLineMaxColumn(e.lineNumber)-e.column}}let NEe=class e{constructor(e,t,n,i,r,o){this._memoryService=t,this._commandService=n,this._contextKeyService=i,this._instantiationService=r,this._logService=o,this._lineSuffix=new vG,this._toDispose=new pG,this.editor=e,this.model=r.createInstance(fxe,this.editor);const s=WSe.InsertMode.bindTo(i);s.set(e.getOption(104).insertMode),this.model.onDidTrigger((()=>s.set(e.getOption(104).insertMode))),this.widget=this._toDispose.add(new U$((()=>{const e=this._instantiationService.createInstance(CEe,this.editor);this._toDispose.add(e),this._toDispose.add(e.onDidSelect((e=>this._insertSuggestion(e,0)),this));const t=new EEe(this.editor,e,(e=>this._insertSuggestion(e,2)));this._toDispose.add(t),this._toDispose.add(this.model.onDidSuggest((e=>{0===e.completionModel.items.length&&t.reset()})));const n=WSe.MakesTextEdit.bindTo(this._contextKeyService),i=WSe.HasInsertAndReplaceRange.bindTo(this._contextKeyService),r=WSe.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(gG((()=>{n.reset(),i.reset(),r.reset()}))),this._toDispose.add(e.onDidFocus((({item:e})=>{const t=this.editor.getPosition(),o=e.editStart.column,s=t.column;let a=!0;if(!("smart"!==this.editor.getOption(1)||2!==this.model.state||e.completion.command||e.completion.additionalTextEdits||4&e.completion.insertTextRules||s-o!==e.completion.insertText.length)){a=this.editor.getModel().getValueInRange({startLineNumber:t.lineNumber,startColumn:o,endLineNumber:t.lineNumber,endColumn:s})!==e.completion.insertText}n.set(a),i.set(!IK.equals(e.editInsertEnd,e.editReplaceEnd)),r.set(Boolean(e.provider.resolveCompletionItem)||Boolean(e.completion.documentation)||e.completion.detail!==e.completion.label)}))),this._toDispose.add(e.onDetailsKeyDown((e=>{e.toKeybinding().equals(new jG(!0,!1,!1,!1,33))||lj&&e.toKeybinding().equals(new jG(!1,!1,!1,!0,33))?e.stopPropagation():e.toKeybinding().isModifierKey()||this.editor.focus()}))),e}))),this._overtypingCapturer=this._toDispose.add(new U$((()=>this._toDispose.add(new kEe(this.editor,this.model))))),this._alternatives=this._toDispose.add(new U$((()=>this._toDispose.add(new rxe(this.editor,this._contextKeyService))))),this._toDispose.add(r.createInstance(xEe,e)),this._toDispose.add(this.model.onDidTrigger((e=>{this.widget.value.showTriggered(e.auto,e.shy?250:50),this._lineSuffix.value=new DEe(this.editor.getModel(),e.position)}))),this._toDispose.add(this.model.onDidSuggest((e=>{if(!e.shy){let t=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),e.completionModel.items);this.widget.value.showSuggestions(e.completionModel,t,e.isFrozen,e.auto)}}))),this._toDispose.add(this.model.onDidCancel((e=>{e.retrigger||this.widget.value.hideWidget()}))),this._toDispose.add(this.editor.onDidBlurEditorWidget((()=>{this.model.cancel(),this.model.clear()})));let a=WSe.AcceptSuggestionsOnEnter.bindTo(i),l=()=>{const e=this.editor.getOption(1);a.set("on"===e||"smart"===e)};this._toDispose.add(this.editor.onDidChangeConfiguration((()=>l()))),l()}static get(t){return t.getContribution(e.ID)}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose()}_insertSuggestion(e,t){if(!e||!e.item)return this._alternatives.value.reset(),this.model.cancel(),void this.model.clear();if(!this.editor.hasModel())return;const n=this.editor.getModel(),i=n.getAlternativeVersionId(),{item:r}=e,o=[],s=new OG;1&t||this.editor.pushUndoStop();const a=this.getOverwriteInfo(r,Boolean(8&t));if(this._memoryService.memorize(n,this.editor.getPosition(),r),Array.isArray(r.completion.additionalTextEdits)){const e=mle.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",r.completion.additionalTextEdits.map((e=>H3.replace(TK.lift(e.range),e.text)))),e.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!r.isResolved){const e=new CG(!0);let i;const a=n.onDidChangeContent((e=>{if(e.isFlush)return s.cancel(),void a.dispose();for(let t of e.changes){const e=TK.getEndPosition(t.range);i&&!IK.isBefore(e,i)||(i=e)}}));let l=t;t|=2;let c=!1,u=this.editor.onWillType((()=>{u.dispose(),c=!0,2&l||this.editor.pushUndoStop()}));o.push(r.resolve(s.token).then((()=>{if(!r.completion.additionalTextEdits||s.token.isCancellationRequested)return!1;if(i&&r.completion.additionalTextEdits.some((e=>IK.isBefore(i,TK.getStartPosition(e.range)))))return!1;c&&this.editor.pushUndoStop();const e=mle.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",r.completion.additionalTextEdits.map((e=>H3.replace(TK.lift(e.range),e.text)))),e.restoreRelativeVerticalPositionOfCursor(this.editor),!c&&2&l||this.editor.pushUndoStop(),!0})).then((t=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",e.elapsed(),t),a.dispose(),u.dispose()})))}let{insertText:l}=r.completion;4&r.completion.insertTextRules||(l=CSe.escape(l)),ZSe.get(this.editor).insert(l,{overwriteBefore:a.overwriteBefore,overwriteAfter:a.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(1&r.completion.insertTextRules),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),2&t||this.editor.pushUndoStop(),r.completion.command?r.completion.command.id===IEe.id?this.model.trigger({auto:!0,shy:!1},!0):(o.push(this._commandService.executeCommand(r.completion.command.id,...r.completion.command.arguments?[...r.completion.command.arguments]:[]).catch(nG)),this.model.cancel()):this.model.cancel(),4&t&&this._alternatives.value.set(e,(e=>{for(s.cancel();n.canUndo();){i!==n.getAlternativeVersionId()&&n.undo(),this._insertSuggestion(e,3|(8&t?8:0));break}})),this._alertCompletionItem(r),Promise.all(o).finally((()=>{this.model.clear(),s.dispose()}))}getOverwriteInfo(e,t){WZ(this.editor.hasModel());let n="replace"===this.editor.getOption(104).insertMode;t&&(n=!n);const i=e.position.column-e.editStart.column,r=(n?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column;return{overwriteBefore:i+(this.editor.getPosition().column-e.position.column),overwriteAfter:r+(this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0)}}_alertCompletionItem(e){if(R1(e.completion.additionalTextEdits)){t5(GH(0,"Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length))}}triggerSuggest(e){this.editor.hasModel()&&(this.model.trigger({auto:!1,shy:!1},!1,e),this.editor.revealLine(this.editor.getPosition().lineNumber,0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;const t=this.editor.getPosition(),n=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},i=e=>{if(4&e.completion.insertTextRules||e.completion.additionalTextEdits)return!0;const t=this.editor.getPosition(),n=e.editStart.column,i=t.column;if(i-n!==e.completion.insertText.length)return!0;return this.editor.getModel().getValueInRange({startLineNumber:t.lineNumber,startColumn:n,endLineNumber:t.lineNumber,endColumn:i})!==e.completion.insertText};SG.once(this.model.onDidTrigger)((e=>{let t=[];SG.any(this.model.onDidTrigger,this.model.onDidCancel)((()=>{dG(t),n()}),void 0,t),this.model.onDidSuggest((({completionModel:e})=>{if(dG(t),0===e.items.length)return void n();const r=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),e.items),o=e.items[r];i(o)?(this.editor.pushUndoStop(),this._insertSuggestion({index:r,item:o,model:e},7)):n()}),void 0,t)})),this.model.trigger({auto:!1,shy:!0}),this.editor.revealLine(t.lineNumber,0),this.editor.focus()}acceptSelectedSuggestion(e,t){const n=this.widget.value.getFocusedItem();let i=0;e&&(i|=4),t&&(i|=8),this._insertSuggestion(n,i)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.value.stopForceRenderingAbove()}};NEe.ID="editor.contrib.suggestController",NEe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([LEe(1,ixe),LEe(2,KZ),LEe(3,A5),LEe(4,t$),LEe(5,K1)],NEe);class IEe extends o6{constructor(){super({id:IEe.id,label:GH(0,"Trigger Suggest"),alias:"Trigger Suggest",precondition:g5.and(gre.writable,gre.hasCompletionItemProvider),kbOpts:{kbExpr:gre.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t){const n=NEe.get(t);n&&n.triggerSuggest()}}IEe.id="editor.action.triggerSuggest",d6(NEe.ID,NEe),c6(IEe);const TEe=r6.bindToContribution(NEe.get);l6(new TEe({id:"acceptSelectedSuggestion",precondition:WSe.Visible,handler(e){e.acceptSelectedSuggestion(!0,!1)}})),o4.registerKeybindingRule({id:"acceptSelectedSuggestion",when:g5.and(WSe.Visible,gre.textInputFocus),primary:2,weight:190}),o4.registerKeybindingRule({id:"acceptSelectedSuggestion",when:g5.and(WSe.Visible,gre.textInputFocus,WSe.AcceptSuggestionsOnEnter,WSe.MakesTextEdit),primary:3,weight:190}),Z5.appendMenuItem(zSe,{command:{id:"acceptSelectedSuggestion",title:GH(0,"Insert")},group:"left",order:1,when:WSe.HasInsertAndReplaceRange.toNegated()}),Z5.appendMenuItem(zSe,{command:{id:"acceptSelectedSuggestion",title:GH(0,"Insert")},group:"left",order:1,when:g5.and(WSe.HasInsertAndReplaceRange,WSe.InsertMode.isEqualTo("insert"))}),Z5.appendMenuItem(zSe,{command:{id:"acceptSelectedSuggestion",title:GH(0,"Replace")},group:"left",order:1,when:g5.and(WSe.HasInsertAndReplaceRange,WSe.InsertMode.isEqualTo("replace"))}),l6(new TEe({id:"acceptAlternativeSelectedSuggestion",precondition:g5.and(WSe.Visible,gre.textInputFocus),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:1027,secondary:[1026]},handler(e){e.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:zSe,group:"left",order:2,when:g5.and(WSe.HasInsertAndReplaceRange,WSe.InsertMode.isEqualTo("insert")),title:GH(0,"Replace")},{menuId:zSe,group:"left",order:2,when:g5.and(WSe.HasInsertAndReplaceRange,WSe.InsertMode.isEqualTo("replace")),title:GH(0,"Insert")}]})),qZ.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion"),l6(new TEe({id:"hideSuggestWidget",precondition:WSe.Visible,handler:e=>e.cancelSuggestWidget(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:9,secondary:[1033]}})),l6(new TEe({id:"selectNextSuggestion",precondition:g5.and(WSe.Visible,WSe.MultipleSuggestions),handler:e=>e.selectNextSuggestion(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})),l6(new TEe({id:"selectNextPageSuggestion",precondition:g5.and(WSe.Visible,WSe.MultipleSuggestions),handler:e=>e.selectNextPageSuggestion(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:12,secondary:[2060]}})),l6(new TEe({id:"selectLastSuggestion",precondition:g5.and(WSe.Visible,WSe.MultipleSuggestions),handler:e=>e.selectLastSuggestion()})),l6(new TEe({id:"selectPrevSuggestion",precondition:g5.and(WSe.Visible,WSe.MultipleSuggestions),handler:e=>e.selectPrevSuggestion(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})),l6(new TEe({id:"selectPrevPageSuggestion",precondition:g5.and(WSe.Visible,WSe.MultipleSuggestions),handler:e=>e.selectPrevPageSuggestion(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:11,secondary:[2059]}})),l6(new TEe({id:"selectFirstSuggestion",precondition:g5.and(WSe.Visible,WSe.MultipleSuggestions),handler:e=>e.selectFirstSuggestion()})),l6(new TEe({id:"toggleSuggestionDetails",precondition:WSe.Visible,handler:e=>e.toggleSuggestionDetails(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:2058,mac:{primary:266}},menuOpts:[{menuId:zSe,group:"right",order:1,when:g5.and(WSe.DetailsVisible,WSe.CanResolve),title:GH(0,"show less")},{menuId:zSe,group:"right",order:1,when:g5.and(WSe.DetailsVisible.toNegated(),WSe.CanResolve),title:GH(0,"show more")}]})),l6(new TEe({id:"toggleExplainMode",precondition:WSe.Visible,handler:e=>e.toggleExplainMode(),kbOpts:{weight:100,primary:2133}})),l6(new TEe({id:"toggleSuggestionFocus",precondition:WSe.Visible,handler:e=>e.toggleSuggestionFocus(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:2570,mac:{primary:778}}})),l6(new TEe({id:"insertBestCompletion",precondition:g5.and(gre.textInputFocus,g5.equals("config.editor.tabCompletion","on"),xEe.AtEnd,WSe.Visible.toNegated(),rxe.OtherSuggestions.toNegated(),ZSe.InSnippetMode.toNegated()),handler:(e,t)=>{e.triggerSuggestAndAcceptBest(OZ(t)?Object.assign({fallback:"tab"},t):{fallback:"tab"})},kbOpts:{weight:190,primary:2}})),l6(new TEe({id:"insertNextSuggestion",precondition:g5.and(gre.textInputFocus,g5.equals("config.editor.tabCompletion","on"),rxe.OtherSuggestions,WSe.Visible.toNegated(),ZSe.InSnippetMode.toNegated()),handler:e=>e.acceptNextSuggestion(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:2}})),l6(new TEe({id:"insertPrevSuggestion",precondition:g5.and(gre.textInputFocus,g5.equals("config.editor.tabCompletion","on"),rxe.OtherSuggestions,WSe.Visible.toNegated(),ZSe.InSnippetMode.toNegated()),handler:e=>e.acceptPrevSuggestion(),kbOpts:{weight:190,kbExpr:gre.textInputFocus,primary:1026}})),c6(class extends o6{constructor(){super({id:"editor.action.resetSuggestSize",label:GH(0,"Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(e,t){NEe.get(t).resetWidgetSize()}});class MEe extends nSe{constructor(e){super(e),this.isSuggestWidgetVisible=!1,this.currentGhostText=void 0,this._isActive=!1,this.isShiftKeyPressed=!1,this.minReservedLineCount=0,this.setInactiveDelayed=this._register(new z$((()=>{this.isSuggestWidgetVisible||this.isActive&&(this._isActive=!1,this.onDidChangeEmitter.fire())}),100));const t=NEe.get(this.editor);if(t){let e=!1;const n=()=>{e||(e=!0,this._register(t.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this._isActive=!0,this.updateFromSuggestion()}))),this._register(t.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.setInactiveDelayed.schedule(),this.minReservedLineCount=0,this.updateFromSuggestion()}))),this._register(t.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this._isActive=!0,this.updateFromSuggestion()}))))};this._register(SG.once(t.model.onDidTrigger)((e=>{n()})))}this.updateFromSuggestion(),this._register(gG((()=>{const e=NEe.get(this.editor);e&&e.stopForceRenderingAbove()}))),this._register(e.onKeyDown((e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.updateFromSuggestion())}))),this._register(e.onKeyUp((e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.updateFromSuggestion())})))}get isActive(){return this._isActive}setExpanded(e){super.setExpanded(e),this.updateFromSuggestion()}isSuggestionPreviewEnabled(){return this.editor.getOption(104).preview}updateFromSuggestion(){const e=NEe.get(this.editor);if(!e)return void this.setCurrentInlineCompletion(void 0);if(!this.isSuggestWidgetVisible)return void this.setCurrentInlineCompletion(void 0);const t=e.widget.value.getFocusedItem();t?this.setCurrentInlineCompletion(function(e,t,n,i){const r=n.item;if(Array.isArray(r.completion.additionalTextEdits))return{text:"",range:TK.fromPositions(t,t)};let{insertText:o}=r.completion;if(4&r.completion.insertTextRules){const n=(new CSe).parse(o),i=e.editor.getModel();FSe.adjustWhitespace(i,t,n,!0,!0),o=n.toString()}const s=e.getOverwriteInfo(r,i);return{text:o,range:TK.fromPositions(t.delta(0,-s.overwriteBefore),t.delta(0,Math.max(s.overwriteAfter,0)))}}(e,this.editor.getPosition(),t,this.isShiftKeyPressed)):this.setCurrentInlineCompletion(void 0)}setCurrentInlineCompletion(e){const t=this.editor.getOptions().get(104).previewMode;this.currentGhostText=e?uSe(e,this.editor.getModel(),t)||new tSe(e.range.endLineNumber,[],this.minReservedLineCount):void 0,this.currentGhostText&&this.expanded&&(this.minReservedLineCount=Math.max(this.minReservedLineCount,...this.currentGhostText.parts.map((e=>e.lines.length-1))));const n=NEe.get(this.editor);n&&(this.minReservedLineCount>=1&&this.isSuggestionPreviewEnabled()?n.forceRenderingAbove():n.stopForceRenderingAbove()),this.onDidChangeEmitter.fire()}get ghostText(){return this.isSuggestionPreviewEnabled()?this.currentGhostText:void 0}}var AEe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class OEe extends mG{constructor(){super(...arguments),this.onDidChangeEmitter=new EG,this.onDidChange=this.onDidChangeEmitter.event,this.hasCachedGhostText=!1,this.currentModelRef=this._register(new vG)}get targetModel(){var e;return null===(e=this.currentModelRef.value)||void 0===e?void 0:e.object}setTargetModel(e){var t,n;this.currentModelRef.clear(),this.currentModelRef.value=e?(t=e,n=e.onDidChange((()=>{this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire()})),{object:t,dispose:()=>null==n?void 0:n.dispose()}):void 0,this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire()}get ghostText(){var e,t;return this.hasCachedGhostText||(this.cachedGhostText=null===(t=null===(e=this.currentModelRef.value)||void 0===e?void 0:e.object)||void 0===t?void 0:t.ghostText,this.hasCachedGhostText=!0),this.cachedGhostText}setExpanded(e){var t;null===(t=this.targetModel)||void 0===t||t.setExpanded(e)}get expanded(){return!!this.targetModel&&this.targetModel.expanded}get minReservedLineCount(){return this.targetModel?this.targetModel.minReservedLineCount:0}}let REe=class extends OEe{constructor(e,t){super(),this.editor=e,this.commandService=t,this.suggestWidgetAdapterModel=this._register(new MEe(this.editor)),this.inlineCompletionsModel=this._register(new oSe(this.editor,this.commandService)),this._register(this.suggestWidgetAdapterModel.onDidChange((()=>{this.updateModel()}))),this.updateModel()}get activeInlineCompletionsModel(){if(this.targetModel===this.inlineCompletionsModel)return this.inlineCompletionsModel}updateModel(){this.setTargetModel(this.suggestWidgetAdapterModel.isActive?this.suggestWidgetAdapterModel:this.inlineCompletionsModel),this.inlineCompletionsModel.setActive(this.targetModel===this.inlineCompletionsModel)}shouldShowHoverAt(e){var t;const n=null===(t=this.activeInlineCompletionsModel)||void 0===t?void 0:t.ghostText;return!!n&&n.parts.some((t=>e.containsPosition(new IK(n.lineNumber,t.column))))}triggerInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.trigger()}commitInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.commitCurrentSuggestion()}hideInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.hide()}showNextInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.showNext()}showPreviousInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.showPrevious()}hasMultipleInlineCompletions(){var e;return AEe(this,void 0,void 0,(function*(){const t=yield null===(e=this.activeInlineCompletionsModel)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};REe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,KZ)],REe);var PEe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},FEe=function(e,t){return function(n,i){t(n,i,e)}},BEe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let WEe=class e extends mG{constructor(e,t){super(),this.editor=e,this.instantiationService=t,this.triggeredExplicitly=!1,this.activeController=this._register(new vG),this._register(this.editor.onDidChangeModel((()=>{this.updateModelController()}))),this._register(this.editor.onDidChangeConfiguration((e=>{e.hasChanged(104)&&this.updateModelController(),e.hasChanged(52)&&this.updateModelController()}))),this.updateModelController()}static get(t){return t.getContribution(e.ID)}get activeModel(){var e;return null===(e=this.activeController.value)||void 0===e?void 0:e.model}updateModelController(){const e=this.editor.getOption(104),t=this.editor.getOption(52);this.activeController.value=void 0,this.activeController.value=this.editor.hasModel()&&(e.preview||t.enabled||this.triggeredExplicitly)?this.instantiationService.createInstance(VEe,this.editor):void 0}shouldShowHoverAt(e){var t;return(null===(t=this.activeModel)||void 0===t?void 0:t.shouldShowHoverAt(e))||!1}shouldShowHoverAtViewZone(e){var t,n;return(null===(n=null===(t=this.activeController.value)||void 0===t?void 0:t.widget)||void 0===n?void 0:n.shouldShowHoverAtViewZone(e))||!1}trigger(){var e;this.triggeredExplicitly=!0,this.activeController.value||this.updateModelController(),null===(e=this.activeModel)||void 0===e||e.triggerInlineCompletion()}commit(){var e;null===(e=this.activeModel)||void 0===e||e.commitInlineCompletion()}hide(){var e;null===(e=this.activeModel)||void 0===e||e.hideInlineCompletion()}showNextInlineCompletion(){var e;null===(e=this.activeModel)||void 0===e||e.showNextInlineCompletion()}showPreviousInlineCompletion(){var e;null===(e=this.activeModel)||void 0===e||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return BEe(this,void 0,void 0,(function*(){const t=yield null===(e=this.activeModel)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};WEe.inlineSuggestionVisible=new M5("inlineSuggestionVisible",!1,GH(0,"Whether an inline suggestion is visible")),WEe.inlineSuggestionHasIndentation=new M5("inlineSuggestionHasIndentation",!1,GH(0,"Whether the inline suggestion starts with whitespace")),WEe.ID="editor.contrib.ghostTextController",WEe=PEe([FEe(1,t$)],WEe);class zEe{constructor(e){this.contextKeyService=e,this.inlineCompletionVisible=WEe.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=WEe.inlineSuggestionHasIndentation.bindTo(this.contextKeyService)}}let VEe=class extends mG{constructor(e,t,n){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=n,this.contextKeys=new zEe(this.contextKeyService),this.model=this._register(this.instantiationService.createInstance(REe,this.editor)),this.widget=this._register(this.instantiationService.createInstance($Ce,this.editor,this.model)),this._register(gG((()=>{this.contextKeys.inlineCompletionVisible.set(!1),this.contextKeys.inlineCompletionSuggestsIndentation.set(!1)}))),this._register(this.model.onDidChange((()=>{this.updateContextKeys()}))),this.updateContextKeys()}updateContextKeys(){var e;this.contextKeys.inlineCompletionVisible.set(void 0!==(null===(e=this.model.activeInlineCompletionsModel)||void 0===e?void 0:e.ghostText));const t=this.model.inlineCompletionsModel.ghostText;if(t&&t.parts.length>0){const{column:e,lines:n}=t.parts[0],i=n[0].startsWith(" ")||n[0].startsWith("\t"),r=e<=this.editor.getModel().getLineIndentColumn(t.lineNumber);this.contextKeys.inlineCompletionSuggestsIndentation.set(!!this.model.activeInlineCompletionsModel&&i&&r)}else this.contextKeys.inlineCompletionSuggestsIndentation.set(!1)}};VEe=PEe([FEe(1,t$),FEe(2,A5)],VEe);const UEe=r6.bindToContribution(WEe.get),HEe=new UEe({id:"editor.action.inlineSuggest.commit",precondition:g5.and(WEe.inlineSuggestionVisible,WEe.inlineSuggestionHasIndentation.toNegated(),gre.tabMovesFocus.toNegated()),kbOpts:{weight:200,primary:2},handler(e){e.commit(),e.editor.focus()}});l6(HEe),l6(new UEe({id:"editor.action.inlineSuggest.hide",precondition:WEe.inlineSuggestionVisible,kbOpts:{weight:100,primary:9},handler(e){e.hide()}}));class jEe extends o6{constructor(){super({id:jEe.ID,label:GH(0,"Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:g5.and(gre.writable,WEe.inlineSuggestionVisible),kbOpts:{weight:100,primary:601}})}run(e,t){return BEe(this,void 0,void 0,(function*(){const e=WEe.get(t);e&&(e.showNextInlineCompletion(),t.focus())}))}}jEe.ID="editor.action.inlineSuggest.showNext";class GEe extends o6{constructor(){super({id:GEe.ID,label:GH(0,"Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:g5.and(gre.writable,WEe.inlineSuggestionVisible),kbOpts:{weight:100,primary:599}})}run(e,t){return BEe(this,void 0,void 0,(function*(){const e=WEe.get(t);e&&(e.showPreviousInlineCompletion(),t.focus())}))}}GEe.ID="editor.action.inlineSuggest.showPrevious";d6(WEe.ID,WEe),c6(class extends o6{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:GH(0,"Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:gre.writable})}run(e,t){return BEe(this,void 0,void 0,(function*(){const e=WEe.get(t);e&&e.trigger()}))}}),c6(jEe),c6(GEe);var KEe=function(e,t){return function(n,i){t(n,i,e)}};class qEe{constructor(e,t,n){this.owner=e,this.range=t,this.controller=n}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}hasMultipleSuggestions(){return this.controller.hasMultipleInlineCompletions()}}let $Ee=class{constructor(e,t,n,i,r){this._editor=e,this._commandService=n,this._menuService=i,this._contextKeyService=r}suggestHoverAnchor(e){const t=WEe.get(this._editor);if(!t)return null;if(8===e.target.type){const n=e.target.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId))return new HCe(1e3,this,TK.fromPositions(n.positionBefore||n.position,n.positionBefore||n.position))}if(7===e.target.type&&e.target.range&&t.shouldShowHoverAt(e.target.range))return new HCe(1e3,this,e.target.range);if(6===e.target.type&&e.target.range&&e.target.detail){if(e.target.detail.mightBeForeignElement&&t.shouldShowHoverAt(e.target.range))return new HCe(1e3,this,e.target.range)}return null}computeSync(e,t){const n=WEe.get(this._editor);return n&&n.shouldShowHoverAt(e.range)?[new qEe(this,e.range,n)]:[]}renderHoverParts(e,t,n){const i=new pG,r=i.add(this._menuService.createMenu(Y5.InlineCompletionsActions,this._contextKeyService)),o=n.addAction({label:GH(0,"Next"),commandId:jEe.ID,run:()=>this._commandService.executeCommand(jEe.ID)}),s=n.addAction({label:GH(0,"Previous"),commandId:GEe.ID,run:()=>this._commandService.executeCommand(GEe.ID)});n.addAction({label:GH(0,"Accept"),commandId:HEe.id,run:()=>this._commandService.executeCommand(HEe.id)});const a=[o,s];for(const l of a)l.setEnabled(!1);e[0].hasMultipleSuggestions().then((e=>{for(const t of a)t.setEnabled(e)}));for(const[l,c]of r.getActions())for(const e of c)e instanceof J5&&n.addAction({label:e.label,commandId:e.item.id,run:()=>this._commandService.executeCommand(e.item.id)});return i}};$Ee=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([KEe(2,KZ),KEe(3,X5),KEe(4,A5)],$Ee);class YEe{constructor(e,t,n){this.presentationIndex=n,this._onColorFlushed=new EG,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new EG,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new EG,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){for(let n=0;n<this.colorPresentations.length;n++)if(t.toLowerCase()===this.colorPresentations[n].label){this.presentationIndex=n,this._onDidChangePresentation.fire(this.presentation);break}}flushColor(){this._onColorFlushed.fire(this._color)}}const XEe=GY;class ZEe extends mG{constructor(e,t,n){super(),this.model=t,this.domNode=XEe(".colorpicker-header"),WY(e,this.domNode),this.pickedColorNode=WY(this.domNode,XEe(".picked-color"));const i=WY(this.domNode,XEe(".original-color"));i.style.backgroundColor=Q8.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=n.getColorTheme().getColor(Vte)||Q8.white,this._register(G5(((e,t)=>{this.backgroundColor=e.getColor(Vte)||Q8.white}))),this._register(Q$(this.pickedColorNode,RY.CLICK,(()=>this.model.selectNextColorPresentation()))),this._register(Q$(i,RY.CLICK,(()=>{this.model.color=this.model.originalColor,this.model.flushColor()}))),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this.pickedColorNode.style.backgroundColor=Q8.Format.CSS.format(t.color)||"",this.pickedColorNode.classList.toggle("light",t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter())}onDidChangeColor(e){this.pickedColorNode.style.backgroundColor=Q8.Format.CSS.format(e)||"",this.pickedColorNode.classList.toggle("light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this.pickedColorNode.textContent=this.model.presentation?this.model.presentation.label:""}}class QEe extends mG{constructor(e,t,n){super(),this.model=t,this.pixelRatio=n,this.domNode=XEe(".colorpicker-body"),WY(e,this.domNode),this.saturationBox=new JEe(this.domNode,this.model,this.pixelRatio),this._register(this.saturationBox),this._register(this.saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this.saturationBox.onColorFlushed(this.flushColor,this)),this.opacityStrip=new tke(this.domNode,this.model),this._register(this.opacityStrip),this._register(this.opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this.opacityStrip.onColorFlushed(this.flushColor,this)),this.hueStrip=new nke(this.domNode,this.model),this._register(this.hueStrip),this._register(this.hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this.hueStrip.onColorFlushed(this.flushColor,this))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){const n=this.model.color.hsva;this.model.color=new Q8(new Z8(n.h,e,t,n.a))}onDidOpacityChange(e){const t=this.model.color.hsva;this.model.color=new Q8(new Z8(t.h,t.s,t.v,e))}onDidHueChange(e){const t=this.model.color.hsva,n=360*(1-e);this.model.color=new Q8(new Z8(360===n?0:n,t.s,t.v,t.a))}layout(){this.saturationBox.layout(),this.opacityStrip.layout(),this.hueStrip.layout()}}class JEe extends mG{constructor(e,t,n){super(),this.model=t,this.pixelRatio=n,this._onDidChange=new EG,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new EG,this.onColorFlushed=this._onColorFlushed.event,this.domNode=XEe(".saturation-wrap"),WY(e,this.domNode),this.canvas=document.createElement("canvas"),this.canvas.className="saturation-box",WY(this.domNode,this.canvas),this.selection=XEe(".saturation-selection"),WY(this.domNode,this.selection),this.layout(),this._register(tY(this.domNode,(e=>this.onMouseDown(e)))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}onMouseDown(e){this.monitor=this._register(new P6);const t=mY(this.domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.buttons,R6,(e=>this.onDidChangePosition(e.posx-t.left,e.posy-t.top)),(()=>null));const n=nY(document,(()=>{this._onColorFlushed.fire(),n.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)}),!0)}onDidChangePosition(e,t){const n=Math.max(0,Math.min(1,e/this.width)),i=Math.max(0,Math.min(1,1-t/this.height));this.paintSelection(n,i),this._onDidChange.fire({s:n,v:i})}layout(){this.width=this.domNode.offsetWidth,this.height=this.domNode.offsetHeight,this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.paint();const e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){const e=this.model.color.hsva,t=new Q8(new Z8(e.h,1,1,1)),n=this.canvas.getContext("2d"),i=n.createLinearGradient(0,0,this.canvas.width,0);i.addColorStop(0,"rgba(255, 255, 255, 1)"),i.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),i.addColorStop(1,"rgba(255, 255, 255, 0)");const r=n.createLinearGradient(0,0,0,this.canvas.height);r.addColorStop(0,"rgba(0, 0, 0, 0)"),r.addColorStop(1,"rgba(0, 0, 0, 1)"),n.rect(0,0,this.canvas.width,this.canvas.height),n.fillStyle=Q8.Format.CSS.format(t),n.fill(),n.fillStyle=i,n.fill(),n.fillStyle=r,n.fill()}paintSelection(e,t){this.selection.style.left=e*this.width+"px",this.selection.style.top=this.height-t*this.height+"px"}onDidChangeColor(){this.monitor&&this.monitor.isMonitoring()||this.paint()}}class eke extends mG{constructor(e,t){super(),this.model=t,this._onDidChange=new EG,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new EG,this.onColorFlushed=this._onColorFlushed.event,this.domNode=WY(e,XEe(".strip")),this.overlay=WY(this.domNode,XEe(".overlay")),this.slider=WY(this.domNode,XEe(".slider")),this.slider.style.top="0px",this._register(tY(this.domNode,(e=>this.onMouseDown(e)))),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const e=this.getValue(this.model.color);this.updateSliderPosition(e)}onMouseDown(e){const t=this._register(new P6),n=mY(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(e.target,e.buttons,R6,(e=>this.onDidChangeTop(e.posy-n.top)),(()=>null));const i=nY(document,(()=>{this._onColorFlushed.fire(),i.dispose(),t.stopMonitoring(!0),this.domNode.classList.remove("grabbing")}),!0)}onDidChangeTop(e){const t=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=(1-e)*this.height+"px"}}class tke extends eke{constructor(e,t){super(e,t),this.domNode.classList.add("opacity-strip"),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){const{r:t,g:n,b:i}=e.rgba,r=new Q8(new Y8(t,n,i,1)),o=new Q8(new Y8(t,n,i,0));this.overlay.style.background=`linear-gradient(to bottom, ${r} 0%, ${o} 100%)`}getValue(e){return e.hsva.a}}class nke extends eke{constructor(e,t){super(e,t),this.domNode.classList.add("hue-strip")}getValue(e){return 1-e.hsva.h/360}}class ike extends Yre{constructor(e,t,n,i){super(),this.model=t,this.pixelRatio=n,this._register(l$((()=>this.layout())));const r=XEe(".colorpicker-widget");e.appendChild(r);const o=new ZEe(r,this.model,i);this.body=new QEe(r,this.model,this.pixelRatio),this._register(o),this._register(this.body)}layout(){this.body.layout()}}var rke=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class oke{constructor(e,t,n,i){this.owner=e,this.range=t,this.model=n,this.provider=i,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let ske=class{constructor(e,t,n){this._editor=e,this._hover=t,this._themeService=n}computeSync(e,t){return[]}computeAsync(e,t,n){return rke(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return[];const e=owe.get(this._editor);for(const n of t){const t=e.getColorData(n.range.getStartPosition());if(t){return[yield this._createColorHover(this._editor.getModel(),t.colorInfo,t.provider)]}}return[]}))}_createColorHover(e,t,n){return rke(this,void 0,void 0,(function*(){const i=e.getValueInRange(t.range),{red:r,green:o,blue:s,alpha:a}=t.color,l=new Y8(Math.round(255*r),Math.round(255*o),Math.round(255*s),a),c=new Q8(l),u=yield iwe(e,t,n,TG.None),h=new YEe(c,[],0);return h.colorPresentations=u||[],h.guessColorPresentation(c,i),new oke(this,TK.lift(t.range),h,n)}))}renderHoverParts(e,t,n){if(0===e.length||!this._editor.hasModel())return mG.None;const i=new pG,r=e[0],o=this._editor.getModel(),s=r.model,a=i.add(new ike(t,s,this._editor.getOption(126),this._themeService));let l=new TK(r.range.startLineNumber,r.range.startColumn,r.range.endLineNumber,r.range.endColumn);const c=()=>{let e,t;if(s.presentation.textEdit){e=[s.presentation.textEdit],t=new TK(s.presentation.textEdit.range.startLineNumber,s.presentation.textEdit.range.startColumn,s.presentation.textEdit.range.endLineNumber,s.presentation.textEdit.range.endColumn);const n=this._editor.getModel()._setTrackedRange(null,t,3);this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",e),t=this._editor.getModel()._getTrackedRange(n)||t}else e=[{identifier:null,range:l,text:s.presentation.label,forceMoveMarkers:!1}],t=l.setEndPosition(l.endLineNumber,l.startColumn+s.presentation.label.length),this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",e);s.presentation.additionalTextEdits&&(e=[...s.presentation.additionalTextEdits],this._editor.executeEdits("colorpicker",e),this._hover.hide()),this._editor.pushUndoStop(),l=t},u=e=>iwe(o,{range:l,color:{red:e.rgba.r/255,green:e.rgba.g/255,blue:e.rgba.b/255,alpha:e.rgba.a}},r.provider,TG.None).then((e=>{s.colorPresentations=e||[]}));return i.add(s.onColorFlushed((e=>{u(e).then(c)}))),i.add(s.onDidChangeColor(u)),this._hover.setColorPicker(a),i}};ske=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(2,B5)],ske);var ake=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},lke=function(e,t){return function(n,i){t(n,i,e)}},cke=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const uke=GY;let hke=class extends mG{constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=uke("div.hover-row.status-bar"),this.actionsElement=WY(this.hoverElement,uke("div.actions"))}get hasContent(){return this._hasContent}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),n=t?t.getLabel():null;return this._hasContent=!0,this._register(cwe.render(this.actionsElement,e,n))}append(e){const t=WY(this.actionsElement,e);return this._hasContent=!0,t}};hke=ake([lke(0,gce)],hke);class dke{constructor(e,t){this._participants=t,this._editor=e,this._result=[],this._anchor=null}setAnchor(e){this._anchor=e,this._result=[]}clearResult(){this._result=[]}static _getLineDecorations(e,t){if(1!==t.type)return[];const n=e.getModel(),i=t.range.startLineNumber,r=n.getLineMaxColumn(i);return e.getLineDecorations(i).filter((e=>{if(e.options.isWholeLine)return!0;const n=e.range.startLineNumber===i?e.range.startColumn:1,o=e.range.endLineNumber===i?e.range.endColumn:r;return!(n>t.range.startColumn||t.range.endColumn>o)}))}computeAsync(e){return cke(this,void 0,void 0,(function*(){const t=this._anchor;if(!this._editor.hasModel()||!t)return Promise.resolve([]);const n=dke._getLineDecorations(this._editor,t);return W1(yield Promise.all(this._participants.map((i=>this._computeAsync(i,n,t,e)))))}))}_computeAsync(e,t,n,i){return cke(this,void 0,void 0,(function*(){return e.computeAsync?e.computeAsync(n,t,i):[]}))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=dke._getLineDecorations(this._editor,this._anchor);let t=[];for(const n of this._participants)t=t.concat(n.computeSync(this._anchor,e));return A1(t)}onResult(e,t){this._result=t?e.concat(this._result):this._result.concat(e)}getResult(){return this._result.slice(0)}getResultWithLoadingMessage(){if(this._anchor)for(const e of this._participants)if(e.createLoadingMessage){const t=e.createLoadingMessage(this._anchor);if(t)return this._result.slice(0).concat([t])}return this._result.slice(0)}}let fke=class e extends Yre{constructor(t,n,i,r){super(),this._hoverVisibleKey=n,this._keybindingService=r,this.allowEditorOverflow=!0,this._participants=[i.createInstance(ske,t,this),i.createInstance(VCe,t,this),i.createInstance($Ee,t,this),i.createInstance(ECe,t,this)],this._hover=this._register(new lwe),this._id=e.ID,this._editor=t,this._isVisible=!1,this._stoleFocus=!1,this._renderDisposable=null,this.onkeydown(this._hover.containerDomNode,(e=>{e.equals(9)&&this.hide()})),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(40)&&this._updateFont()}))),this._editor.onDidLayoutChange((()=>this.layout())),this.layout(),this._editor.addContentWidget(this),this._showAtPosition=null,this._showAtRange=null,this._stoleFocus=!1,this._messages=[],this._lastAnchor=null,this._computer=new dke(this._editor,this._participants),this._highlightDecorations=[],this._isChangingDecorations=!1,this._shouldFocus=!1,this._colorPicker=null,this._hoverOperation=new swe(this._computer,(e=>this._withResult(e,!0)),null,(e=>this._withResult(e,!1)),this._editor.getOption(50).delay),this._register(eY(this.getDomNode(),RY.FOCUS,(()=>{this._colorPicker&&this.getDomNode().classList.add("colorpicker-hover")}))),this._register(eY(this.getDomNode(),RY.BLUR,(()=>{this.getDomNode().classList.remove("colorpicker-hover")}))),this._register(t.onDidChangeConfiguration((()=>{this._hoverOperation.setHoverTime(this._editor.getOption(50).delay)}))),this._register(YJ.onDidChange((()=>{this._isVisible&&this._lastAnchor&&this._messages.length>0&&(this._hover.contentsDomNode.textContent="",this._renderMessages(this._lastAnchor,this._messages))})))}dispose(){this._hoverOperation.cancel(),this._editor.removeContentWidget(this),super.dispose()}getId(){return this._id}getDomNode(){return this._hover.containerDomNode}_shouldShowAt(e){const t=e.target.type;if(6===t)return!0;if(7===t){const t=this._editor.getOption(40).typicalHalfwidthCharacterWidth/2,n=e.target.detail;if(n&&!n.isAfterLines&&"number"==typeof n.horizontalDistanceToText&&n.horizontalDistanceToText<t)return!0}return!1}maybeShowAt(e){var t;const n=[];for(const i of this._participants)if("function"==typeof i.suggestHoverAnchor){const t=i.suggestHoverAnchor(e);t&&n.push(t)}if(this._shouldShowAt(e)&&e.target.range){const i=[...(null===(t=e.target.element)||void 0===t?void 0:t.classList.values())||[]].find((e=>e.startsWith("ced-colorBox")))&&e.target.range.endColumn-e.target.range.startColumn==1?new TK(e.target.range.startLineNumber,e.target.range.startColumn+1,e.target.range.endLineNumber,e.target.range.endColumn+1):e.target.range;n.push(new UCe(0,i))}return 0!==n.length&&(n.sort(((e,t)=>t.priority-e.priority)),this._startShowingAt(n[0],0,!1),!0)}_showAt(e,t,n){this._showAtPosition=e,this._showAtRange=t,this._hoverVisibleKey.set(!0),this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._editor.layoutContentWidget(this),this._editor.render(),this._stoleFocus=n,n&&this._hover.containerDomNode.focus()}getPosition(){return this._isVisible?{position:this._showAtPosition,range:this._showAtRange,preference:[1,2]}:null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((e=>this._editor.applyFontInfo(e)))}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont(),this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}layout(){const e=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize:t,lineHeight:n}=this._editor.getOption(40);this._hover.contentsDomNode.style.fontSize=`${t}px`,this._hover.contentsDomNode.style.lineHeight=`${n}px`,this._hover.contentsDomNode.style.maxHeight=`${e}px`,this._hover.contentsDomNode.style.maxWidth=`${Math.max(.66*this._editor.getLayoutInfo().width,500)}px`}onModelDecorationsChanged(){this._isChangingDecorations||this._isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._colorPicker||this._hoverOperation.start(0))}startShowingAtRange(e,t,n){this._startShowingAt(new UCe(0,e),t,n)}_startShowingAt(e,t,n){if(!this._lastAnchor||!this._lastAnchor.equals(e)){if(this._hoverOperation.cancel(),this._isVisible)if(this._showAtPosition&&this._lastAnchor&&e.canAdoptVisibleHover(this._lastAnchor,this._showAtPosition)){const t=this._messages.filter((t=>t.isValidForHoverAnchor(e)));if(0===t.length)this.hide();else{if(t.length===this._messages.length)return;this._renderMessages(e,t)}}else this.hide();this._lastAnchor=e,this._computer.setAnchor(e),this._shouldFocus=n,this._hoverOperation.start(t)}}hide(){this._lastAnchor=null,this._hoverOperation.cancel(),this._isVisible&&(setTimeout((()=>{this._isVisible||this._hoverVisibleKey.set(!1)}),0),this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._editor.layoutContentWidget(this),this._stoleFocus&&this._editor.focus()),this._isChangingDecorations=!0,this._highlightDecorations=this._editor.deltaDecorations(this._highlightDecorations,[]),this._isChangingDecorations=!1,this._renderDisposable&&(this._renderDisposable.dispose(),this._renderDisposable=null),this._colorPicker=null}isColorPickerVisible(){return!!this._colorPicker}setColorPicker(e){this._colorPicker=e}onContentsChanged(){this._hover.onContentsChanged()}_withResult(e,t){this._messages=e,this._lastAnchor&&this._messages.length>0?this._renderMessages(this._lastAnchor,this._messages):t&&this.hide()}_renderMessages(t,n){this._renderDisposable&&(this._renderDisposable.dispose(),this._renderDisposable=null),this._colorPicker=null;let i=1073741824,r=n[0].range,o=null,s=document.createDocumentFragment();const a=new pG,l=new Map;for(const e of n){i=Math.min(i,e.range.startColumn),r=TK.plusRange(r,e.range),e.forceShowAtRange&&(o=e.range),l.has(e.owner)||l.set(e.owner,[]);l.get(e.owner).push(e)}const c=a.add(new hke(this._keybindingService));for(const[e,u]of l)a.add(e.renderHoverParts(u,s,c));c.hasContent&&s.appendChild(c.hoverElement),this._renderDisposable=a,s.hasChildNodes()&&(o?this._showAt(o.getStartPosition(),o,this._shouldFocus):this._showAt(new IK(t.range.startLineNumber,i),r,this._shouldFocus),this._updateContents(s)),this._colorPicker&&this._colorPicker.layout(),this._isChangingDecorations=!0,this._highlightDecorations=this._editor.deltaDecorations(this._highlightDecorations,r?[{range:r,options:e._DECORATION_OPTIONS}]:[]),this._isChangingDecorations=!1}};fke.ID="editor.contrib.modesContentHoverWidget",fke._DECORATION_OPTIONS=v7.register({description:"content-hover-highlight",className:"hoverHighlight"}),fke=ake([lke(2,t$),lke(3,gce)],fke),G5(((e,t)=>{const n=e.getColor(kee);n&&t.addRule(`.monaco-hover .hover-contents a.code-link span:hover { color: ${n}; }`)}));class gke extends Yre{constructor(e,t){super(),this._id=e,this._editor=t,this._isVisible=!1,this._domNode=document.createElement("div"),this._domNode.className="monaco-hover hidden",this._domNode.setAttribute("aria-hidden","true"),this._domNode.setAttribute("role","tooltip"),this._showAtLineNumber=-1,this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(40)&&this.updateFont()}))),this._editor.addOverlayWidget(this)}get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e,this._domNode.classList.toggle("hidden",!this._isVisible)}getId(){return this._id}getDomNode(){return this._domNode}showAt(e){this._showAtLineNumber=e,this.isVisible||(this.isVisible=!0);const t=this._editor.getLayoutInfo(),n=this._editor.getTopForLineNumber(this._showAtLineNumber),i=this._editor.getScrollTop(),r=this._editor.getOption(56),o=n-i-(this._domNode.clientHeight-r)/2;this._domNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._domNode.style.top=`${Math.max(Math.round(o),0)}px`}hide(){this.isVisible&&(this.isVisible=!1)}getPosition(){return null}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}updateFont(){[...Array.prototype.slice.call(this._domNode.getElementsByTagName("code")),...Array.prototype.slice.call(this._domNode.getElementsByClassName("code"))].forEach((e=>this._editor.applyFontInfo(e)))}updateContents(e){this._domNode.textContent="",this._domNode.appendChild(e),this.updateFont()}}class pke{constructor(e){this._editor=e,this._lineNumber=-1,this._result=[]}setLineNumber(e){this._lineNumber=e,this._result=[]}clearResult(){this._result=[]}computeSync(){const e=e=>({value:e}),t=this._editor.getLineDecorations(this._lineNumber),n=[];if(!t)return n;for(const i of t){if(!i.options.glyphMarginClassName)continue;const t=i.options.glyphMarginHoverMessage;t&&!V_e(t)&&n.push(...j1(t).map(e))}return n}onResult(e,t){this._result=this._result.concat(e)}getResult(){return this._result}getResultWithLoadingMessage(){return this.getResult()}}class mke extends gke{constructor(e,t,n=QZ){super(mke.ID,e),this._renderDisposeables=this._register(new pG),this._messages=[],this._lastLineNumber=-1,this._markdownRenderer=this._register(new RCe({editor:this._editor},t,n)),this._computer=new pke(this._editor),this._hoverOperation=new swe(this._computer,(e=>this._withResult(e)),void 0,(e=>this._withResult(e)),300)}dispose(){this._hoverOperation.cancel(),super.dispose()}onModelDecorationsChanged(){this.isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._hoverOperation.start(0))}startShowingAt(e){this._lastLineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._lastLineNumber=e,this._computer.setLineNumber(e),this._hoverOperation.start(0))}hide(){this._lastLineNumber=-1,this._hoverOperation.cancel(),super.hide()}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._lastLineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const n=document.createDocumentFragment();for(const i of t){const e=this._markdownRenderer.render(i.value);this._renderDisposeables.add(e),n.appendChild(GY("div.hover-row",void 0,e.element))}this.updateContents(n),this.showAt(e)}}mke.ID="editor.contrib.modesGlyphHoverWidget";var vke=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class yke{constructor(e,t,n,i){this.isProviderFirst=e,this.parent=t,this.link=n,this._rangeCallback=i,this.id=hme.nextId()}get uri(){return this.link.uri}get range(){var e,t;return null!==(t=null!==(e=this._range)&&void 0!==e?e:this.link.targetSelectionRange)&&void 0!==t?t:this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var e;const t=null===(e=this.parent.getPreview(this))||void 0===e?void 0:e.preview(this.range);return t?GH(0,"symbol in {0} on line {1} at column {2}, {3}",EZ(this.uri),this.range.startLineNumber,this.range.startColumn,t.value):GH(0,"symbol in {0} on line {1} at column {2}",EZ(this.uri),this.range.startLineNumber,this.range.startColumn)}}class _ke{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const n=this._modelReference.object.textEditorModel;if(!n)return;const{startLineNumber:i,startColumn:r,endLineNumber:o,endColumn:s}=e,a=n.getWordUntilPosition({lineNumber:i,column:r-t}),l=new TK(i,a.startColumn,i,r),c=new TK(o,s,o,1073741824),u=n.getValueInRange(l).replace(/^\s+/,""),h=n.getValueInRange(e);return{value:u+h+n.getValueInRange(c).replace(/\s+$/,""),highlight:{start:u.length,end:u.length+h.length}}}}class bke{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new rZ}dispose(){dG(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return 1===e?GH(0,"1 symbol in {0}, full path {1}",EZ(this.uri),this.uri.fsPath):GH(0,"{0} symbols in {1}, full path {2}",e,EZ(this.uri),this.uri.fsPath)}resolve(e){return vke(this,void 0,void 0,(function*(){if(0!==this._previews.size)return this;for(let n of this.children)if(!this._previews.has(n.uri))try{const t=yield e.createModelReference(n.uri);this._previews.set(n.uri,new _ke(t))}catch(t){nG(t)}return this}))}}class wke{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new EG,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[n]=e;let i;e.sort(wke._compareReferences);for(let r of e)if(i&&CZ.isEqual(i.uri,r.uri,!0)||(i=new bke(this,r.uri),this.groups.push(i)),0===i.children.length||0!==wke._compareReferences(r,i.children[i.children.length-1])){const e=new yke(n===r,i,r,(e=>this._onDidChangeReferenceRange.fire(e)));this.references.push(e),i.children.push(e)}}dispose(){dG(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new wke(this._links,this._title)}get title(){return this._title}get isEmpty(){return 0===this.groups.length}get ariaMessage(){return this.isEmpty?GH(0,"No results found"):1===this.references.length?GH(0,"Found 1 symbol in {0}",this.references[0].uri.fsPath):1===this.groups.length?GH(0,"Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):GH(0,"Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){let{parent:n}=e,i=n.children.indexOf(e),r=n.children.length,o=n.parent.groups.length;return 1===o||t&&i+1<r||!t&&i>0?(i=t?(i+1)%r:(i+r-1)%r,n.children[i]):(i=n.parent.groups.indexOf(n),t?(i=(i+1)%o,n.parent.groups[i].children[0]):(i=(i+o-1)%o,n.parent.groups[i].children[n.parent.groups[i].children.length-1]))}nearestReference(e,t){const n=this.references.map(((n,i)=>({idx:i,prefixLen:xX(n.uri.toString(),e.toString()),offsetDist:100*Math.abs(n.range.startLineNumber-t.lineNumber)+Math.abs(n.range.startColumn-t.column)}))).sort(((e,t)=>e.prefixLen>t.prefixLen?-1:e.prefixLen<t.prefixLen?1:e.offsetDist<t.offsetDist?-1:e.offsetDist>t.offsetDist?1:0))[0];if(n)return this.references[n.idx]}referenceAt(e,t){for(const n of this.references)if(n.uri.toString()===e.toString()&&TK.containsPosition(n.range,t))return n}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return CZ.compare(e.uri,t.uri)||TK.compareRangesUsingStarts(e.range,t.range)}}var Cke=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function Ske(e,t,n,i){const r=n.ordered(e).map((n=>Promise.resolve(i(n,e,t)).then(void 0,(e=>{iG(e)}))));return Promise.all(r).then((e=>{const t=[];for(let n of e)Array.isArray(n)?t.push(...n):n&&t.push(n);return t}))}function xke(e,t,n){return Ske(e,t,AJ,((e,t,i)=>e.provideDefinition(t,i,n)))}function Eke(e,t,n){return Ske(e,t,OJ,((e,t,i)=>e.provideDeclaration(t,i,n)))}function kke(e,t,n){return Ske(e,t,RJ,((e,t,i)=>e.provideImplementation(t,i,n)))}function Lke(e,t,n){return Ske(e,t,PJ,((e,t,i)=>e.provideTypeDefinition(t,i,n)))}function Dke(e,t,n,i){return Ske(e,t,xJ,((e,t,r)=>Cke(this,void 0,void 0,(function*(){const o=yield e.provideReferences(t,r,{includeDeclaration:!0},i);if(!n||!o||2!==o.length)return o;const s=yield e.provideReferences(t,r,{includeDeclaration:!1},i);return s&&1===s.length?s:o}))))}function Nke(e){return Cke(this,void 0,void 0,(function*(){const t=yield e(),n=new wke(t,""),i=n.references.map((e=>e.link));return n.dispose(),i}))}a6("_executeDefinitionProvider",((e,t)=>Nke((()=>xke(e,t,TG.None))))),a6("_executeDeclarationProvider",((e,t)=>Nke((()=>Eke(e,t,TG.None))))),a6("_executeImplementationProvider",((e,t)=>Nke((()=>kke(e,t,TG.None))))),a6("_executeTypeDefinitionProvider",((e,t)=>Nke((()=>Lke(e,t,TG.None))))),a6("_executeReferenceProvider",((e,t)=>Nke((()=>Dke(e,t,!1,TG.None)))));var Ike=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Tke=function(e,t){return function(n,i){t(n,i,e)}};let Mke=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof wke||e instanceof bke}getChildren(e){if(e instanceof wke)return e.groups;if(e instanceof bke)return e.resolve(this._resolverService).then((e=>e.children));throw new Error("bad tree")}};Mke=Ike([Tke(0,n0)],Mke);class Ake{getHeight(){return 23}getTemplateId(e){return e instanceof bke?Fke.id:Wke.id}}let Oke=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof yke){const n=null===(t=e.parent.getPreview(e))||void 0===t?void 0:t.preview(e.range);if(n)return n.value}return EZ(e.uri)}};Oke=Ike([Tke(0,gce)],Oke);class Rke{getId(e){return e instanceof yke?e.id:e.uri}}let Pke=class extends mG{constructor(e,t,n){super(),this._uriLabel=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new ame(i,{supportHighlights:!0})),this.badge=new Ume(WY(i,GY(".count"))),this._register(function(e,t,n){return ede(t,{badgeBackground:(null==n?void 0:n.badgeBackground)||Xee,badgeForeground:(null==n?void 0:n.badgeForeground)||Zee,badgeBorder:xee},e)}(this.badge,n)),e.appendChild(i)}set(e,t){let n=kZ(e.uri);this.file.setLabel(uwe(e.uri),this._uriLabel.getUriLabel(n,{relative:!0}),{title:this._uriLabel.getUriLabel(e.uri),matches:t});const i=e.children.length;this.badge.setCount(i),i>1?this.badge.setTitleFormat(GH(0,"{0} references",i)):this.badge.setTitleFormat(GH(0,"{0} reference",i))}};Pke=Ike([Tke(1,pde),Tke(2,B5)],Pke);let Fke=class e{constructor(t){this._instantiationService=t,this.templateId=e.id}renderTemplate(e){return this._instantiationService.createInstance(Pke,e)}renderElement(e,t,n){n.set(e.element,yhe(e.filterData))}disposeTemplate(e){e.dispose()}};Fke.id="FileReferencesRenderer",Fke=Ike([Tke(0,t$)],Fke);class Bke{constructor(e){this.label=new ime(e,!1)}set(e,t){var n;const i=null===(n=e.parent.getPreview(e))||void 0===n?void 0:n.preview(e.range);if(i&&i.value){const{value:e,highlight:n}=i;t&&!Nhe.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(e,yhe(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(e,[n]))}else this.label.set(`${EZ(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`)}}class Wke{constructor(){this.templateId=Wke.id}renderTemplate(e){return new Bke(e)}renderElement(e,t,n){n.set(e.element,e.filterData)}disposeTemplate(){}}Wke.id="OneReferenceRenderer";class zke{getWidgetAriaLabel(){return GH(0,"References")}getAriaLabel(e){return e.ariaMessage}}var Vke=function(e,t){return function(n,i){t(n,i,e)}},Uke=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Hke{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new pG,this._callOnModelChange=new pG,this._callOnDispose.add(this._editor.onDidChangeModel((()=>this._onModelChanged()))),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e)for(let t of this._model.references)if(t.uri.toString()===e.uri.toString())return void this._addDecorations(t.parent)}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations((()=>this._onDecorationChanged())));const t=[],n=[];for(let r=0,o=e.children.length;r<o;r++){let i=e.children[r];this._decorationIgnoreSet.has(i.id)||i.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:i.range,options:Hke.DecorationOptions}),n.push(r))}const i=this._editor.deltaDecorations([],t);for(let r=0;r<i.length;r++)this._decorations.set(i[r],e.children[n[r]])}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(let[n,i]of this._decorations){const r=t.getDecorationRange(n);if(!r)continue;let o=!1;if(!TK.equalsRange(r,i.range)){if(TK.spansMultipleLines(r))o=!0;else{i.range.endColumn-i.range.startColumn!==r.endColumn-r.startColumn&&(o=!0)}o?(this._decorationIgnoreSet.add(i.id),e.push(n)):i.range=r}}for(let t=0,n=e.length;t<n;t++)this._decorations.delete(e[t]);this._editor.deltaDecorations(e,[])}}removeDecorations(){this._editor.deltaDecorations([...this._decorations.keys()],[]),this._decorations.clear()}}Hke.DecorationOptions=v7.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class jke extends tpe{}let Gke=class extends Pwe{constructor(e,t,n,i,r,o,s,a,l,c){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0},o),this._defaultTreeKeyboardSupport=t,this.layoutData=n,this._textModelResolverService=r,this._instantiationService=o,this._peekViewService=s,this._uriLabel=a,this._undoRedoService=l,this._keybindingService=c,this._disposeOnNewModel=new pG,this._callOnDispose=new pG,this._onDidSelectReference=new EG,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new gY(0,0),this._applyTheme(i.getColorTheme()),this._callOnDispose.add(i.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),dG(this._preview),dG(this._previewNotAvailableMessage),dG(this._tree),dG(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(zwe)||Q8.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(Fwe)||Q8.transparent,primaryHeadingColor:e.getColor(Bwe),secondaryHeadingColor:e.getColor(Wwe)})}show(e){this.editor.revealRangeInCenterIfOutsideViewport(e,0),super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=WY(e,GY("div.messages")),qY(this._messageContainer),this._splitView=new yge(e,{orientation:1}),this._previewContainer=WY(e,GY("div.preview.inline"));this._preview=this._instantiationService.createInstance(fwe,this._previewContainer,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},this.editor),qY(this._previewContainer),this._previewNotAvailableMessage=new l7(GH(0,"no preview available"),l7.DEFAULT_CREATION_OPTIONS,null,null,this._undoRedoService),this._treeContainer=WY(e,GY("div.ref-tree.inline"));const t={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new zke,keyboardNavigationLabelProvider:this._instantiationService.createInstance(Oke),identityProvider:new Rke,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:Vwe}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(eY(this._treeContainer,"keydown",(e=>{e.equals(9)&&(this._keybindingService.dispatchEvent(e,e.target),e.stopPropagation())}),!0)),this._tree=this._instantiationService.createInstance(jke,"ReferencesWidget",this._treeContainer,new Ake,[this._instantiationService.createInstance(Fke),this._instantiationService.createInstance(Wke)],this._instantiationService.createInstance(Mke),t),this._splitView.addView({onDidChange:SG.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._preview.layout({height:this._dim.height,width:e})}},mge.Distribute),this._splitView.addView({onDidChange:SG.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${e}px`,this._tree.layout(this._dim.height,e)}},mge.Distribute),this._disposables.add(this._splitView.onDidSashChange((()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)}),void 0));let n=(e,t)=>{e instanceof yke&&("show"===t&&this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:t,source:"tree"}))};this._tree.onDidOpen((e=>{e.sideBySide?n(e.element,"side"):e.editorOptions.pinned?n(e.element,"goto"):n(e.element,"show")})),qY(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new gY(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then((()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))}))}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=GH(0,"No results"),KY(this._messageContainer),Promise.resolve(void 0)):(qY(this._messageContainer),this._decorationsManager=new Hke(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange((e=>this._tree.rerender(e)))),this._disposeOnNewModel.add(this._preview.onMouseDown((e=>{const{event:t,target:n}=e;if(2!==t.detail)return;const i=this._getFocusedReference();i&&this._onDidSelectReference.fire({element:{uri:i.uri,range:n.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})}))),this.container.classList.add("results-loaded"),KY(this._treeContainer),KY(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(1===this._model.groups.length?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();return e instanceof yke?e:e instanceof bke&&e.children.length>0?e.children[0]:void 0}revealReference(e){return Uke(this,void 0,void 0,(function*(){yield this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}))}_revealReference(e,t){return Uke(this,void 0,void 0,(function*(){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==j$.inMemory?this.setTitle(xZ(e.uri),this._uriLabel.getUriLabel(kZ(e.uri))):this.setTitle(GH(0,"References"));const n=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent||(t&&this._tree.reveal(e.parent),yield this._tree.expand(e.parent)),this._tree.reveal(e);const i=yield n;if(!this._model)return void i.dispose();dG(this._previewModelReference);const r=i.object;if(r){const t=this._preview.getModel()===r.textEditorModel?0:1,n=TK.lift(e.range).collapseToStart();this._previewModelReference=i,this._preview.setModel(r.textEditorModel),this._preview.setSelection(n),this._preview.revealRangeInCenter(n,t)}else this._preview.setModel(this._previewNotAvailableMessage),i.dispose()}))}};Gke=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Vke(3,B5),Vke(4,n0),Vke(5,t$),Vke(6,Twe),Vke(7,pde),Vke(8,Hce),Vke(9,gce)],Gke),G5(((e,t)=>{const n=e.getColor($we);n&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: ${n}; }`);const i=e.getColor(Ywe);i&&t.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: ${i}; }`);const r=e.getColor(Xwe);r&&t.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid ${r}; box-sizing: border-box; }`);const o=e.getColor(Eee);o&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted ${o}; box-sizing: border-box; }`);const s=e.getColor(Vwe);s&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree { background-color: ${s}; }`);const a=e.getColor(Uwe);a&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree { color: ${a}; }`);const l=e.getColor(Hwe);l&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .reference-file { color: ${l}; }`);const c=e.getColor(jwe);c&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: ${c}; }`);const u=e.getColor(Gwe);u&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: ${u} !important; }`);const h=e.getColor(Kwe);h&&t.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,.monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {\tbackground-color: ${h};}`);const d=e.getColor(qwe);d&&t.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .margin {\tbackground-color: ${d};}`)}));var Kke=function(e,t){return function(n,i){t(n,i,e)}},qke=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const $ke=new M5("referenceSearchVisible",!1,GH(0,"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let Yke=class e{constructor(e,t,n,i,r,o,s,a){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=i,this._notificationService=r,this._instantiationService=o,this._storageService=s,this._configurationService=a,this._disposables=new pG,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=$ke.bindTo(n)}static get(t){return t.getContribution(e.ID)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),null===(e=this._widget)||void 0===e||e.dispose(),null===(t=this._model)||void 0===t||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,n){let i;if(this._widget&&(i=this._widget.position),this.closeWidget(),i&&e.containsPosition(i))return;this._peekMode=n,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>{this.closeWidget()}))),this._disposables.add(this._editor.onDidChangeModel((()=>{this._ignoreModelChangeEvent||this.closeWidget()})));const r="peekViewLayout",o=class{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,n;try{const i=JSON.parse(e);t=i.ratio,n=i.heightInLines}catch(i){}return{ratio:t||.7,heightInLines:n||18}}}.fromJSON(this._storageService.get(r,0,"{}"));this._widget=this._instantiationService.createInstance(Gke,this._editor,this._defaultTreeKeyboardSupport,o),this._widget.setTitle(GH(0,"Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose((()=>{t.cancel(),this._widget&&(this._storageService.store(r,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()}))),this._disposables.add(this._widget.onDidSelectReference((e=>{let{element:t,kind:i}=e;if(t)switch(i){case"open":"editor"===e.source&&this._configurationService.getValue("editor.stablePeek")||this.openReference(t,!1,!1);break;case"side":this.openReference(t,!0,!1);break;case"goto":n?this._gotoReference(t):this.openReference(t,!1,!0)}})));const s=++this._requestIdPool;t.then((t=>{var n;if(s===this._requestIdPool&&this._widget)return null===(n=this._model)||void 0===n||n.dispose(),this._model=t,this._widget.setModel(this._model).then((()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(GH(0,"{0} ({1})",this._model.title,this._model.references.length));let t=this._editor.getModel().uri,n=new IK(e.startLineNumber,e.startColumn),i=this._model.nearestReference(t,n);if(i)return this._widget.setSelection(i).then((()=>{this._widget&&"editor"===this._editor.getOption(74)&&this._widget.focusOnPreviewEditor()}))}}));t.dispose()}),(e=>{this._notificationService.error(e)}))}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(e){return qke(this,void 0,void 0,(function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const n=this._model.nearestReference(this._editor.getModel().uri,t);if(!n)return;const i=this._model.nextOrPreviousReference(n,e),r=this._editor.hasTextFocus(),o=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(i),yield this._gotoReference(i),r?this._editor.focus():this._widget&&o&&this._widget.focusOnPreviewEditor()}))}revealReference(e){return qke(this,void 0,void 0,(function*(){this._editor.hasModel()&&this._model&&this._widget&&(yield this._widget.revealReference(e))}))}closeWidget(e=!0){var t,n;null===(t=this._widget)||void 0===t||t.dispose(),null===(n=this._model)||void 0===n||n.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(t){this._widget&&this._widget.hide(),this._ignoreModelChangeEvent=!0;const n=TK.lift(t.range).collapseToStart();return this._editorService.openCodeEditor({resource:t.uri,options:{selection:n}},this._editor).then((t=>{var i;if(this._ignoreModelChangeEvent=!1,t&&this._widget)if(this._editor===t)this._widget.show(n),this._widget.focusOnReferenceTree();else{const r=e.get(t),o=this._model.clone();this.closeWidget(),t.focus(),r.toggleWidget(n,I$((e=>Promise.resolve(o))),null!==(i=this._peekMode)&&void 0!==i&&i)}else this.closeWidget()}),(e=>{this._ignoreModelChangeEvent=!1,nG(e)}))}openReference(e,t,n){t||this.closeWidget();const{uri:i,range:r}=e;this._editorService.openCodeEditor({resource:i,options:{selection:r,pinned:n}},this._editor,t)}};function Xke(e,t){const n=function(e){let t=e.get(o$).getFocusedCodeEditor();return t instanceof fwe?t.getParentEditor():t}(e);if(!n)return;let i=Yke.get(n);i&&t(i)}Yke.ID="editor.contrib.referencesController",Yke=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([Kke(2,A5),Kke(3,o$),Kke(4,g4),Kke(5,t$),Kke(6,vpe),Kke(7,j3)],Yke),o4.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:VG(2089,60),when:g5.or($ke,Mwe.inPeekEditor),handler(e){Xke(e,(e=>{e.changeFocusBetweenPreviewAndReferences()}))}}),o4.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:g5.or($ke,Mwe.inPeekEditor),handler(e){Xke(e,(e=>{e.goToNextOrPreviousReference(!0)}))}}),o4.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:g5.or($ke,Mwe.inPeekEditor),handler(e){Xke(e,(e=>{e.goToNextOrPreviousReference(!1)}))}}),qZ.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference"),qZ.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference"),qZ.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch"),qZ.registerCommand("closeReferenceSearch",(e=>Xke(e,(e=>e.closeWidget())))),o4.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:g5.and(Mwe.inPeekEditor,g5.not("config.editor.stablePeek"))}),o4.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:g5.and($ke,g5.not("config.editor.stablePeek"))}),o4.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:g5.and($ke,Dge),handler(e){var t;const n=null===(t=e.get(xge).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof yke&&Xke(e,(e=>e.revealReference(n[0])))}}),o4.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:g5.and($ke,Dge),handler(e){var t;const n=null===(t=e.get(xge).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof yke&&Xke(e,(e=>e.openReference(n[0],!0,!0)))}}),qZ.registerCommand("openReference",(e=>{var t;const n=null===(t=e.get(xge).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof yke&&Xke(e,(e=>e.openReference(n[0],!1,!0)))}));var Zke=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Qke=function(e,t){return function(n,i){t(n,i,e)}};const Jke=new M5("hasSymbols",!1,GH(0,"Whether there are symbol locations that can be navigated via keyboard-only.")),eLe=i$("ISymbolNavigationService");let tLe=class{constructor(e,t,n,i){this._editorService=t,this._notificationService=n,this._keybindingService=i,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=Jke.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),null===(e=this._currentState)||void 0===e||e.dispose(),null===(t=this._currentMessage)||void 0===t||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1)return void this.reset();this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const n=new nLe(this._editorService),i=n.onDidChange((e=>{if(this._ignoreEditorChange)return;const n=this._editorService.getActiveCodeEditor();if(!n)return;const i=n.getModel(),r=n.getPosition();if(!i||!r)return;let o=!1,s=!1;for(const a of t.references)if(SZ(a.uri,i.uri))o=!0,s=s||TK.containsPosition(a.range,r);else if(o)break;o&&s||this.reset()}));this._currentState=fG(n,i)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:TK.collapseToStart(t.range),selectionRevealType:3}},e).finally((()=>{this._ignoreEditorChange=!1}))}_showMessage(){var e;null===(e=this._currentMessage)||void 0===e||e.dispose();const t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),n=t?GH(0,"Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):GH(0,"Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(n)}};tLe=Zke([Qke(0,A5),Qke(1,o$),Qke(2,g4),Qke(3,gce)],tLe),cle(eLe,tLe,!0),l6(new class extends r6{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:Jke,kbOpts:{weight:100,primary:70}})}runEditorCommand(e,t){return e.get(eLe).revealNext(t)}}),o4.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:Jke,primary:9,handler(e){e.get(eLe).reset()}});let nLe=class{constructor(e){this._listener=new Map,this._disposables=new pG,this._onDidChange=new EG,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),dG(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,fG(e.onDidChangeCursorPosition((t=>this._onDidChange.fire({editor:e}))),e.onDidChangeModelContent((t=>this._onDidChange.fire({editor:e})))))}_onDidRemoveEditor(e){var t;null===(t=this._listener.get(e))||void 0===t||t.dispose(),this._listener.delete(e)}};nLe=Zke([Qke(0,o$)],nLe);var iLe,rLe,oLe,sLe,aLe,lLe,cLe,uLe,hLe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};Z5.appendMenuItem(Y5.EditorContext,{submenu:Y5.EditorContextPeek,title:GH(0,"Peek"),group:"navigation",order:100});const dLe=new Set;function fLe(e){const t=new e;return h6(t),dLe.add(t.id),t}class gLe extends o6{constructor(e,t){super(t),this._configuration=e}run(e,t){if(!t.hasModel())return Promise.resolve(void 0);const n=e.get(g4),i=e.get(o$),r=e.get(jle),o=e.get(eLe),s=t.getModel(),a=t.getPosition(),l=new gle(t,5),c=T$(this._getLocationModel(s,a,l.token),l.token).then((e=>hLe(this,void 0,void 0,(function*(){if(!e||l.token.isCancellationRequested)return;let n;if(t5(e.ariaMessage),e.referenceAt(s.uri,a)){const e=this._getAlternativeCommand(t);e!==this.id&&dLe.has(e)&&(n=t.getAction(e))}const r=e.references.length;if(0===r){if(!this._configuration.muteMessage){const e=s.getWordAtPosition(a);mbe.get(t).showMessage(this._getNoResultFoundMessage(e),a)}}else{if(1!==r||!n)return this._onResult(i,o,t,e);n.run()}}))),(e=>{n.error(e)})).finally((()=>{l.dispose()}));return r.showWhile(c,250),c}_onResult(e,t,n,i){return hLe(this,void 0,void 0,(function*(){const r=this._getGoToPreference(n);if(n instanceof fwe||!(this._configuration.openInPeek||"peek"===r&&i.references.length>1)){const o=i.firstReference(),s=i.references.length>1&&"gotoAndPeek"===r,a=yield this._openReference(n,e,o,this._configuration.openToSide,!s);s&&a?this._openInPeek(a,i):i.dispose(),"goto"===r&&t.put(o)}else this._openInPeek(n,i)}))}_openReference(e,t,n,i,r){return hLe(this,void 0,void 0,(function*(){let o;var s;if((s=n)&&_K.isUri(s.uri)&&TK.isIRange(s.range)&&(TK.isIRange(s.originSelectionRange)||TK.isIRange(s.targetSelectionRange))&&(o=n.targetSelectionRange),o||(o=n.range),!o)return;const a=yield t.openCodeEditor({resource:n.uri,options:{selection:TK.collapseToStart(o),selectionRevealType:3}},e,i);if(a){if(r){const e=a.getModel(),t=a.deltaDecorations([],[{range:o,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout((()=>{a.getModel()===e&&a.deltaDecorations(t,[])}),350)}return a}}))}_openInPeek(e,t){let n=Yke.get(e);n&&e.hasModel()?n.toggleWidget(e.getSelection(),I$((e=>Promise.resolve(t))),this._configuration.openInPeek):t.dispose()}}class pLe extends gLe{_getLocationModel(e,t,n){return hLe(this,void 0,void 0,(function*(){return new wke(yield xke(e,t,n),GH(0,"Definitions"))}))}_getNoResultFoundMessage(e){return e&&e.word?GH(0,"No definition found for '{0}'",e.word):GH(0,"No definition found")}_getAlternativeCommand(e){return e.getOption(47).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(47).multipleDefinitions}}const mLe=hj&&!v$?2118:70;fLe(((iLe=class e extends pLe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.id,label:GH(0,"Go to Definition"),alias:"Go to Definition",precondition:g5.and(gre.hasDefinitionProvider,gre.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:gre.editorTextFocus,primary:mLe,weight:100},contextMenuOpts:{group:"navigation",order:1.1},menuOpts:{menuId:Y5.MenubarGoMenu,group:"4_symbol_nav",order:2,title:GH(0,"Go to &&Definition")}}),qZ.registerCommandAlias("editor.action.goToDeclaration",e.id)}}).id="editor.action.revealDefinition",iLe)),fLe(((rLe=class e extends pLe{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:e.id,label:GH(0,"Open Definition to the Side"),alias:"Open Definition to the Side",precondition:g5.and(gre.hasDefinitionProvider,gre.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,mLe),weight:100}}),qZ.registerCommandAlias("editor.action.openDeclarationToTheSide",e.id)}}).id="editor.action.revealDefinitionAside",rLe)),fLe(((oLe=class e extends pLe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.id,label:GH(0,"Peek Definition"),alias:"Peek Definition",precondition:g5.and(gre.hasDefinitionProvider,Mwe.notInPeekEditor,gre.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:gre.editorTextFocus,primary:582,linux:{primary:3140},weight:100},contextMenuOpts:{menuId:Y5.EditorContextPeek,group:"peek",order:2}}),qZ.registerCommandAlias("editor.action.previewDeclaration",e.id)}}).id="editor.action.peekDefinition",oLe));class vLe extends gLe{_getLocationModel(e,t,n){return hLe(this,void 0,void 0,(function*(){return new wke(yield Eke(e,t,n),GH(0,"Declarations"))}))}_getNoResultFoundMessage(e){return e&&e.word?GH(0,"No declaration found for '{0}'",e.word):GH(0,"No declaration found")}_getAlternativeCommand(e){return e.getOption(47).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(47).multipleDeclarations}}fLe(((sLe=class e extends vLe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.id,label:GH(0,"Go to Declaration"),alias:"Go to Declaration",precondition:g5.and(gre.hasDeclarationProvider,gre.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{group:"navigation",order:1.3},menuOpts:{menuId:Y5.MenubarGoMenu,group:"4_symbol_nav",order:3,title:GH(0,"Go to &&Declaration")}})}_getNoResultFoundMessage(e){return e&&e.word?GH(0,"No declaration found for '{0}'",e.word):GH(0,"No declaration found")}}).id="editor.action.revealDeclaration",sLe)),fLe(class extends vLe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",label:GH(0,"Peek Declaration"),alias:"Peek Declaration",precondition:g5.and(gre.hasDeclarationProvider,Mwe.notInPeekEditor,gre.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:Y5.EditorContextPeek,group:"peek",order:3}})}});class yLe extends gLe{_getLocationModel(e,t,n){return hLe(this,void 0,void 0,(function*(){return new wke(yield Lke(e,t,n),GH(0,"Type Definitions"))}))}_getNoResultFoundMessage(e){return e&&e.word?GH(0,"No type definition found for '{0}'",e.word):GH(0,"No type definition found")}_getAlternativeCommand(e){return e.getOption(47).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(47).multipleTypeDefinitions}}fLe(((aLe=class e extends yLe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.ID,label:GH(0,"Go to Type Definition"),alias:"Go to Type Definition",precondition:g5.and(gre.hasTypeDefinitionProvider,gre.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:gre.editorTextFocus,primary:0,weight:100},contextMenuOpts:{group:"navigation",order:1.4},menuOpts:{menuId:Y5.MenubarGoMenu,group:"4_symbol_nav",order:3,title:GH(0,"Go to &&Type Definition")}})}}).ID="editor.action.goToTypeDefinition",aLe)),fLe(((lLe=class e extends yLe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.ID,label:GH(0,"Peek Type Definition"),alias:"Peek Type Definition",precondition:g5.and(gre.hasTypeDefinitionProvider,Mwe.notInPeekEditor,gre.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:Y5.EditorContextPeek,group:"peek",order:4}})}}).ID="editor.action.peekTypeDefinition",lLe));class _Le extends gLe{_getLocationModel(e,t,n){return hLe(this,void 0,void 0,(function*(){return new wke(yield kke(e,t,n),GH(0,"Implementations"))}))}_getNoResultFoundMessage(e){return e&&e.word?GH(0,"No implementation found for '{0}'",e.word):GH(0,"No implementation found")}_getAlternativeCommand(e){return e.getOption(47).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(47).multipleImplementations}}fLe(((cLe=class e extends _Le{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.ID,label:GH(0,"Go to Implementations"),alias:"Go to Implementations",precondition:g5.and(gre.hasImplementationProvider,gre.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:gre.editorTextFocus,primary:2118,weight:100},menuOpts:{menuId:Y5.MenubarGoMenu,group:"4_symbol_nav",order:4,title:GH(0,"Go to &&Implementations")},contextMenuOpts:{group:"navigation",order:1.45}})}}).ID="editor.action.goToImplementation",cLe)),fLe(((uLe=class e extends _Le{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.ID,label:GH(0,"Peek Implementations"),alias:"Peek Implementations",precondition:g5.and(gre.hasImplementationProvider,Mwe.notInPeekEditor,gre.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:gre.editorTextFocus,primary:3142,weight:100},contextMenuOpts:{menuId:Y5.EditorContextPeek,group:"peek",order:5}})}}).ID="editor.action.peekImplementation",uLe));class bLe extends gLe{_getNoResultFoundMessage(e){return e?GH(0,"No references found for '{0}'",e.word):GH(0,"No references found")}_getAlternativeCommand(e){return e.getOption(47).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(47).multipleReferences}}fLe(class extends bLe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",label:GH(0,"Go to References"),alias:"Go to References",precondition:g5.and(gre.hasReferenceProvider,Mwe.notInPeekEditor,gre.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:gre.editorTextFocus,primary:1094,weight:100},contextMenuOpts:{group:"navigation",order:1.45},menuOpts:{menuId:Y5.MenubarGoMenu,group:"4_symbol_nav",order:5,title:GH(0,"Go to &&References")}})}_getLocationModel(e,t,n){return hLe(this,void 0,void 0,(function*(){return new wke(yield Dke(e,t,!0,n),GH(0,"References"))}))}}),fLe(class extends bLe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",label:GH(0,"Peek References"),alias:"Peek References",precondition:g5.and(gre.hasReferenceProvider,Mwe.notInPeekEditor,gre.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:Y5.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(e,t,n){return hLe(this,void 0,void 0,(function*(){return new wke(yield Dke(e,t,!1,n),GH(0,"References"))}))}});class wLe extends gLe{constructor(e,t,n){super(e,{id:"editor.action.goToLocation",label:GH(0,"Go To Any Symbol"),alias:"Go To Any Symbol",precondition:g5.and(Mwe.notInPeekEditor,gre.isInWalkThroughSnippet.toNegated())}),this._references=t,this._gotoMultipleBehaviour=n}_getLocationModel(e,t,n){return hLe(this,void 0,void 0,(function*(){return new wke(this._references,GH(0,"Locations"))}))}_getNoResultFoundMessage(e){return e&&GH(0,"No results for '{0}'",e.word)||""}_getGoToPreference(e){var t;return null!==(t=this._gotoMultipleBehaviour)&&void 0!==t?t:e.getOption(47).multipleReferences}_getAlternativeCommand(){return""}}function CLe(e,t){return!!e[t]}qZ.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:_K},{name:"position",description:"The position at which to start",constraint:IK.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(e,t,n,i,r,o,s)=>hLe(void 0,void 0,void 0,(function*(){WZ(_K.isUri(t)),WZ(IK.isIPosition(n)),WZ(Array.isArray(i)),WZ(void 0===r||"string"==typeof r),WZ(void 0===s||"boolean"==typeof s);const a=e.get(o$),l=yield a.openCodeEditor({resource:t},a.getFocusedCodeEditor());if(o3(l))return l.setPosition(n),l.revealPositionInCenterIfOutsideViewport(n,0),l.invokeWithinContext((e=>{const t=new class extends wLe{_getNoResultFoundMessage(e){return o||super._getNoResultFoundMessage(e)}}({muteMessage:!Boolean(o),openInPeek:Boolean(s),openToSide:!1},i,r);e.get(t$).invokeFunction(t.run.bind(t),l)}))}))}),qZ.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:_K},{name:"position",description:"The position at which to start",constraint:IK.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(e,t,n,i,r)=>hLe(void 0,void 0,void 0,(function*(){e.get(KZ).executeCommand("editor.action.goToLocations",t,n,i,r,void 0,!0)}))}),qZ.registerCommand({id:"editor.action.findReferences",handler:(e,t,n)=>{WZ(_K.isUri(t)),WZ(IK.isIPosition(n));const i=e.get(o$);return i.openCodeEditor({resource:t},i.getFocusedCodeEditor()).then((e=>{if(!o3(e)||!e.hasModel())return;const t=Yke.get(e);if(!t)return;const i=I$((t=>Dke(e.getModel(),IK.lift(n),!1,t).then((e=>new wke(e,GH(0,"References")))))),r=new TK(n.lineNumber,n.column,n.lineNumber,n.column);return Promise.resolve(t.toggleWidget(r,i,!1))}))}}),qZ.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");class SLe{constructor(e,t){this.target=e.target,this.hasTriggerModifier=CLe(e.event,t.triggerModifier),this.hasSideBySideModifier=CLe(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class xLe{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=CLe(e,t.triggerModifier)}}class ELe{constructor(e,t,n,i){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=n,this.triggerSideBySideModifier=i}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function kLe(e){return"altKey"===e?lj?new ELe(57,"metaKey",6,"altKey"):new ELe(5,"ctrlKey",6,"altKey"):lj?new ELe(6,"altKey",57,"metaKey"):new ELe(6,"altKey",5,"ctrlKey")}class LLe extends mG{constructor(e){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new EG),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new EG),this.onExecute=this._onExecute.event,this._onCancel=this._register(new EG),this.onCancel=this._onCancel.event,this._editor=e,this._opts=kLe(this._editor.getOption(67)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration((e=>{if(e.hasChanged(67)){const e=kLe(this._editor.getOption(67));if(this._opts.equals(e))return;this._opts=e,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}}))),this._register(this._editor.onMouseMove((e=>this._onEditorMouseMove(new SLe(e,this._opts))))),this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(new SLe(e,this._opts))))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(new SLe(e,this._opts))))),this._register(this._editor.onKeyDown((e=>this._onEditorKeyDown(new xLe(e,this._opts))))),this._register(this._editor.onKeyUp((e=>this._onEditorKeyUp(new xLe(e,this._opts))))),this._register(this._editor.onMouseDrag((()=>this._resetHandler()))),this._register(this._editor.onDidChangeCursorSelection((e=>this._onDidChangeCursorSelection(e)))),this._register(this._editor.onDidChangeModel((e=>this._resetHandler()))),this._register(this._editor.onDidChangeModelContent((()=>this._resetHandler()))),this._register(this._editor.onDidScrollChange((e=>{(e.scrollTopChanged||e.scrollLeftChanged)&&this._resetHandler()})))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=e.target.position?e.target.position.lineNumber:0}_onEditorMouseUp(e){const t=e.target.position?e.target.position.lineNumber:0;this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}var DLe=function(e,t){return function(n,i){t(n,i,e)}};let NLe=class e{constructor(e,t,n){this.textModelResolverService=t,this.modeService=n,this.toUnhook=new pG,this.toUnhookForKeyboard=new pG,this.linkDecorations=[],this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e;let i=new LLe(e);this.toUnhook.add(i),this.toUnhook.add(i.onMouseMoveOrRelevantKeyDown((([e,t])=>{this.startFindDefinitionFromMouse(e,GZ(t))}))),this.toUnhook.add(i.onExecute((e=>{this.isEnabled(e)&&this.gotoDefinition(e.target.position,e.hasSideBySideModifier).then((()=>{this.removeLinkDecorations()}),(e=>{this.removeLinkDecorations(),nG(e)}))}))),this.toUnhook.add(i.onCancel((()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null})))}static get(t){return t.getContribution(e.ID)}startFindDefinitionFromCursor(e){return this.startFindDefinition(e).then((()=>{this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition((()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()}))),this.toUnhookForKeyboard.add(this.editor.onKeyDown((e=>{e&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())})))}))}startFindDefinitionFromMouse(e,t){if(9===e.target.type&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t))return this.currentWordAtPosition=null,void this.removeLinkDecorations();const n=e.target.position;this.startFindDefinition(n)}startFindDefinition(e){var t;this.toUnhookForKeyboard.clear();const n=e?null===(t=this.editor.getModel())||void 0===t?void 0:t.getWordAtPosition(e):null;if(!n)return this.currentWordAtPosition=null,this.removeLinkDecorations(),Promise.resolve(0);if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===n.startColumn&&this.currentWordAtPosition.endColumn===n.endColumn&&this.currentWordAtPosition.word===n.word)return Promise.resolve(0);this.currentWordAtPosition=n;let i=new fle(this.editor,15);return this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=I$((t=>this.findDefinition(e,t))),this.previousPromise.then((t=>{if(t&&t.length&&i.validate(this.editor))if(t.length>1)this.addDecoration(new TK(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn),(new z_e).appendText(GH(0,"Click to show {0} definitions.",t.length)));else{let i=t[0];if(!i.uri)return;this.textModelResolverService.createModelReference(i.uri).then((t=>{if(!t.object||!t.object.textEditorModel)return void t.dispose();const{object:{textEditorModel:r}}=t,{startLineNumber:o}=i.range;if(o<1||o>r.getLineCount())return void t.dispose();const s=this.getPreviewValue(r,o,i);let a;a=i.originSelectionRange?TK.lift(i.originSelectionRange):new TK(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn);const l=this.modeService.getModeIdByFilepathOrFirstLine(r.uri);this.addDecoration(a,(new z_e).appendCodeblock(l||"",s)),t.dispose()}))}else this.removeLinkDecorations()})).then(void 0,nG)}getPreviewValue(t,n,i){let r=i.targetSelectionRange?i.range:this.getPreviewRangeBasedOnBrackets(t,n);r.endLineNumber-r.startLineNumber>=e.MAX_SOURCE_PREVIEW_LINES&&(r=this.getPreviewRangeBasedOnIndentation(t,n));return this.stripIndentationFromPreviewRange(t,n,r)}stripIndentationFromPreviewRange(e,t,n){let i=e.getLineFirstNonWhitespaceColumn(t);for(let r=t+1;r<n.endLineNumber;r++){const t=e.getLineFirstNonWhitespaceColumn(r);i=Math.min(i,t)}return e.getValueInRange(n).replace(new RegExp(`^\\s{${i-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(t,n){const i=t.getLineFirstNonWhitespaceColumn(n),r=Math.min(t.getLineCount(),n+e.MAX_SOURCE_PREVIEW_LINES);let o=n+1;for(;o<r;o++){if(i===t.getLineFirstNonWhitespaceColumn(o))break}return new TK(n,1,o+1,1)}getPreviewRangeBasedOnBrackets(t,n){const i=Math.min(t.getLineCount(),n+e.MAX_SOURCE_PREVIEW_LINES),r=[];let o=!0,s=t.findNextBracket(new IK(n,1));for(;null!==s;){if(0===r.length)r.push(s);else{const e=r[r.length-1];if(e.open[0]===s.open[0]&&e.isOpen&&!s.isOpen?r.pop():r.push(s),0===r.length){if(!o)return new TK(n,1,s.range.endLineNumber+1,1);o=!1}}const e=t.getLineMaxColumn(n);let a=s.range.endLineNumber,l=s.range.endColumn;if(e===s.range.endColumn&&(a++,l=1),a>i)return new TK(n,1,i+1,1);s=t.findNextBracket(new IK(a,l))}return new TK(n,1,i+1,1)}addDecoration(e,t){const n={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[n])}removeLinkDecorations(){this.linkDecorations.length>0&&(this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[]))}isEnabled(e,t){return this.editor.hasModel()&&e.isNoneOrSingleMouseDown&&6===e.target.type&&(e.hasTriggerModifier||!!t&&t.keyCodeIsTriggerKey)&&AJ.has(this.editor.getModel())}findDefinition(e,t){const n=this.editor.getModel();return n?xke(n,e,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext((e=>{const n=!t&&this.editor.getOption(75)&&!this.isInPeekEditor(e);return new pLe({openToSide:t,openInPeek:n,muteMessage:!0},{alias:"",label:"",id:"",precondition:void 0}).run(e,this.editor)}))}isInPeekEditor(e){const t=e.get(A5);return Mwe.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose()}};NLe.ID="editor.contrib.gotodefinitionatposition",NLe.MAX_SOURCE_PREVIEW_LINES=8,NLe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([DLe(1,n0),DLe(2,t0)],NLe),d6(NLe.ID,NLe),G5(((e,t)=>{const n=e.getColor(Gte);n&&t.addRule(`.monaco-editor .goto-definition-link { color: ${n} !important; }`)}));var ILe=function(e,t){return function(n,i){t(n,i,e)}};let TLe=class e{constructor(e,t,n,i,r){this._editor=e,this._instantiationService=t,this._openerService=n,this._modeService=i,this._toUnhook=new pG,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._hookEvents(),this._didChangeConfigurationHandler=this._editor.onDidChangeConfiguration((e=>{e.hasChanged(50)&&(this._unhookEvents(),this._hookEvents())})),this._hoverVisibleKey=gre.hoverVisible.bindTo(r)}static get(t){return t.getContribution(e.ID)}_hookEvents(){const e=()=>this._hideWidgets(),t=this._editor.getOption(50);this._isHoverEnabled=t.enabled,this._isHoverSticky=t.sticky,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._toUnhook.add(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e)))),this._toUnhook.add(this._editor.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged())))):(this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))),this._toUnhook.add(this._editor.onMouseLeave(e)),this._toUnhook.add(this._editor.onDidChangeModel(e)),this._toUnhook.add(this._editor.onDidScrollChange((e=>this._onEditorScrollChanged(e))))}_unhookEvents(){this._toUnhook.clear()}_onModelDecorationsChanged(){var e,t;null===(e=this._contentWidget)||void 0===e||e.onModelDecorationsChanged(),null===(t=this._glyphWidget)||void 0===t||t.onModelDecorationsChanged()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._isMouseDown=!0;const t=e.target.type;9!==t||e.target.detail!==fke.ID?12===t&&e.target.detail===mke.ID||(12!==t&&e.target.detail!==mke.ID&&(this._hoverClicked=!1),this._hideWidgets()):this._hoverClicked=!0}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseMove(e){var t,n,i,r,o;let s=e.target.type;if(this._isMouseDown&&this._hoverClicked)return;if(this._isHoverSticky&&9===s&&e.target.detail===fke.ID)return;if(this._isHoverSticky&&!(null===(n=null===(t=e.event.browserEvent.view)||void 0===t?void 0:t.getSelection())||void 0===n?void 0:n.isCollapsed))return;if(!this._isHoverSticky&&9===s&&e.target.detail===fke.ID&&(null===(i=this._contentWidget)||void 0===i?void 0:i.isColorPickerVisible()))return;if(this._isHoverSticky&&12===s&&e.target.detail===mke.ID)return;if(!this._isHoverEnabled)return void this._hideWidgets();if(!this._getOrCreateContentWidget().maybeShowAt(e))return 2===s&&e.target.position?(null===(o=this._contentWidget)||void 0===o||o.hide(),this._glyphWidget||(this._glyphWidget=new mke(this._editor,this._modeService,this._openerService)),void this._glyphWidget.startShowingAt(e.target.position.lineNumber)):void this._hideWidgets();null===(r=this._glyphWidget)||void 0===r||r.hide()}_onKeyDown(e){5!==e.keyCode&&6!==e.keyCode&&57!==e.keyCode&&4!==e.keyCode&&this._hideWidgets()}_hideWidgets(){var e,t,n;this._isMouseDown&&this._hoverClicked&&(null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible())||(this._hoverClicked=!1,null===(t=this._glyphWidget)||void 0===t||t.hide(),null===(n=this._contentWidget)||void 0===n||n.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(fke,this._editor,this._hoverVisibleKey)),this._contentWidget}isColorPickerVisible(){var e;return(null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible())||!1}showContentHover(e,t,n){this._getOrCreateContentWidget().startShowingAtRange(e,t,n)}dispose(){var e,t;this._unhookEvents(),this._toUnhook.dispose(),this._didChangeConfigurationHandler.dispose(),null===(e=this._glyphWidget)||void 0===e||e.dispose(),null===(t=this._contentWidget)||void 0===t||t.dispose()}};TLe.ID="editor.contrib.hover",TLe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ILe(1,t$),ILe(2,ZZ),ILe(3,t0),ILe(4,A5)],TLe);d6(TLe.ID,TLe),c6(class extends o6{constructor(){super({id:"editor.action.showHover",label:GH(0,"Show Hover"),alias:"Show Hover",precondition:void 0,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2087),weight:100}})}run(e,t){if(!t.hasModel())return;let n=TLe.get(t);if(!n)return;const i=t.getPosition(),r=new TK(i.lineNumber,i.column,i.lineNumber,i.column),o=2===t.getOption(2);n.showContentHover(r,1,o)}}),c6(class extends o6{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:GH(0,"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(e,t){let n=TLe.get(t);if(!n)return;const i=t.getPosition();if(!i)return;const r=new TK(i.lineNumber,i.column,i.lineNumber,i.column);NLe.get(t).startFindDefinitionFromCursor(i).then((()=>{n.showContentHover(r,1,!0)}))}}),G5(((e,t)=>{const n=e.getColor(zte);n&&t.addRule(`.monaco-editor .hoverHighlight { background-color: ${n}; }`);const i=e.getColor(Vte);i&&t.addRule(`.monaco-editor .monaco-hover { background-color: ${i}; }`);const r=e.getColor(Hte);r&&(t.addRule(`.monaco-editor .monaco-hover { border: 1px solid ${r}; }`),t.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${r.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${r.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${r.transparent(.5)}; }`));const o=e.getColor(kee);o&&t.addRule(`.monaco-editor .monaco-hover a { color: ${o}; }`);const s=e.getColor(Lee);s&&t.addRule(`.monaco-editor .monaco-hover a:hover { color: ${s}; }`);const a=e.getColor(Ute);a&&t.addRule(`.monaco-editor .monaco-hover { color: ${a}; }`);const l=e.getColor(jte);l&&t.addRule(`.monaco-editor .monaco-hover .hover-row .actions { background-color: ${l}; }`);const c=e.getColor(Dee);c&&t.addRule(`.monaco-editor .monaco-hover code { background-color: ${c}; }`)}));class MLe extends mG{constructor(e){super(),this._editor=e,this._register(e.onMouseDown((e=>this.onMouseDown(e))))}dispose(){super.dispose()}onMouseDown(e){var t;if(6!==e.target.type)return;if(![...(null===(t=e.target.element)||void 0===t?void 0:t.classList.values())||[]].find((e=>e.startsWith("ced-colorBox"))))return;if(!e.target.range)return;const n=this._editor.getContribution(TLe.ID);if(!n.isColorPickerVisible()){const t=new TK(e.target.range.startLineNumber,e.target.range.startColumn+1,e.target.range.endLineNumber,e.target.range.endColumn+1);n.showContentHover(t,0,!1)}}}MLe.ID="editor.contrib.colorContribution",d6(MLe.ID,MLe);class ALe{constructor(e,t){this._selection=e,this._insertSpace=t,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,n){if(n<0)return!1;const i=t.length;if(n+i>e.length)return!1;for(let r=0;r<i;r++){const i=e.charCodeAt(n+r),o=t.charCodeAt(r);if(i!==o&&!(i>=65&&i<=90&&i+32===o||o>=65&&o<=90&&o+32===i))return!1}return!0}_createOperationsForBlockComment(e,t,n,i,r,o){const s=e.startLineNumber,a=e.startColumn,l=e.endLineNumber,c=e.endColumn,u=r.getLineContent(s),h=r.getLineContent(l);let d,f=u.lastIndexOf(t,a-1+t.length),g=h.indexOf(n,c-1-n.length);if(-1!==f&&-1!==g)if(s===l){u.substring(f+t.length,g).indexOf(n)>=0&&(f=-1,g=-1)}else{const e=u.substring(f+t.length),i=h.substring(0,g);(e.indexOf(n)>=0||i.indexOf(n)>=0)&&(f=-1,g=-1)}-1!==f&&-1!==g?(i&&f+t.length<u.length&&32===u.charCodeAt(f+t.length)&&(t+=" "),i&&g>0&&32===h.charCodeAt(g-1)&&(n=" "+n,g-=1),d=ALe._createRemoveBlockCommentOperations(new TK(s,f+t.length+1,l,g+1),t,n)):(d=ALe._createAddBlockCommentOperations(e,t,n,this._insertSpace),this._usedEndToken=1===d.length?n:null);for(const p of d)o.addTrackedEditOperation(p.range,p.text)}static _createRemoveBlockCommentOperations(e,t,n){let i=[];return TK.isEmpty(e)?i.push(H3.delete(new TK(e.startLineNumber,e.startColumn-t.length,e.endLineNumber,e.endColumn+n.length))):(i.push(H3.delete(new TK(e.startLineNumber,e.startColumn-t.length,e.startLineNumber,e.startColumn))),i.push(H3.delete(new TK(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+n.length)))),i}static _createAddBlockCommentOperations(e,t,n,i){let r=[];return TK.isEmpty(e)?r.push(H3.replace(new TK(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),t+"  "+n)):(r.push(H3.insert(new IK(e.startLineNumber,e.startColumn),t+(i?" ":""))),r.push(H3.insert(new IK(e.endLineNumber,e.endColumn),(i?" ":"")+n))),r}getEditOperations(e,t){const n=this._selection.startLineNumber,i=this._selection.startColumn;e.tokenizeIfCheap(n);const r=e.getLanguageIdAtPosition(n,i),o=q0.getComments(r);o&&o.blockCommentStartToken&&o.blockCommentEndToken&&this._createOperationsForBlockComment(this._selection,o.blockCommentStartToken,o.blockCommentEndToken,this._insertSpace,e,t)}computeCursorState(e,t){const n=t.getInverseEditOperations();if(2===n.length){const e=n[0],t=n[1];return new MK(e.range.endLineNumber,e.range.endColumn,t.range.startLineNumber,t.range.startColumn)}{const e=n[0].range,t=this._usedEndToken?-this._usedEndToken.length-1:0;return new MK(e.endLineNumber,e.endColumn+t,e.endLineNumber,e.endColumn+t)}}}class OLe{constructor(e,t,n,i,r,o){this._selection=e,this._tabSize=t,this._type=n,this._insertSpace=i,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=r,this._ignoreFirstLine=o||!1}static _gatherPreflightCommentStrings(e,t,n){e.tokenizeIfCheap(t);const i=e.getLanguageIdAtPosition(t,1),r=q0.getComments(i),o=r?r.lineCommentToken:null;if(!o)return null;let s=[];for(let a=0,l=n-t+1;a<l;a++)s[a]={ignore:!1,commentStr:o,commentStrOffset:0,commentStrLength:o.length};return s}static _analyzeLines(e,t,n,i,r,o,s){let a,l=!0;a=0===e||1!==e;for(let c=0,u=i.length;c<u;c++){const u=i[c],h=r+c;if(h===r&&s){u.ignore=!0;continue}const d=n.getLineContent(h),f=hX(d);if(-1!==f){if(l=!1,u.ignore=!1,u.commentStrOffset=f,a&&!ALe._haystackHasNeedleAtOffset(d,u.commentStr,f)&&(0===e?a=!1:1===e||(u.ignore=!0)),a&&t){const e=f+u.commentStrLength;e<d.length&&32===d.charCodeAt(e)&&(u.commentStrLength+=1)}}else u.ignore=o,u.commentStrOffset=d.length}if(0===e&&l){a=!1;for(let e=0,t=i.length;e<t;e++)i[e].ignore=!1}return{supported:!0,shouldRemoveComments:a,lines:i}}static _gatherPreflightData(e,t,n,i,r,o,s){const a=OLe._gatherPreflightCommentStrings(n,i,r);return null===a?{supported:!1}:OLe._analyzeLines(e,t,n,a,i,o,s)}_executeLineComments(e,t,n,i){let r;n.shouldRemoveComments?r=OLe._createRemoveLineCommentsOperations(n.lines,i.startLineNumber):(OLe._normalizeInsertionPoint(e,n.lines,i.startLineNumber,this._tabSize),r=this._createAddLineCommentsOperations(n.lines,i.startLineNumber));const o=new IK(i.positionLineNumber,i.positionColumn);for(let s=0,a=r.length;s<a;s++)if(t.addEditOperation(r[s].range,r[s].text),TK.isEmpty(r[s].range)&&TK.getStartPosition(r[s].range).equals(o)){e.getLineContent(o.lineNumber).length+1===o.column&&(this._deltaColumn=(r[s].text||"").length)}this._selectionId=t.trackSelection(i)}_attemptRemoveBlockComment(e,t,n,i){let r=t.startLineNumber,o=t.endLineNumber,s=i.length+Math.max(e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.startColumn),a=e.getLineContent(r).lastIndexOf(n,s-1),l=e.getLineContent(o).indexOf(i,t.endColumn-1-n.length);return-1!==a&&-1===l&&(l=e.getLineContent(r).indexOf(i,a+n.length),o=r),-1===a&&-1!==l&&(a=e.getLineContent(o).lastIndexOf(n,l),r=o),!t.isEmpty()||-1!==a&&-1!==l||(a=e.getLineContent(r).indexOf(n),-1!==a&&(l=e.getLineContent(r).indexOf(i,a+n.length))),-1!==a&&32===e.getLineContent(r).charCodeAt(a+n.length)&&(n+=" "),-1!==l&&32===e.getLineContent(o).charCodeAt(l-1)&&(i=" "+i,l-=1),-1!==a&&-1!==l?ALe._createRemoveBlockCommentOperations(new TK(r,a+n.length+1,o,l+1),n,i):null}_executeBlockComment(e,t,n){e.tokenizeIfCheap(n.startLineNumber);let i=e.getLanguageIdAtPosition(n.startLineNumber,1),r=q0.getComments(i);if(!r||!r.blockCommentStartToken||!r.blockCommentEndToken)return;const o=r.blockCommentStartToken,s=r.blockCommentEndToken;let a=this._attemptRemoveBlockComment(e,n,o,s);if(!a){if(n.isEmpty()){const t=e.getLineContent(n.startLineNumber);let i=hX(t);-1===i&&(i=t.length),a=ALe._createAddBlockCommentOperations(new TK(n.startLineNumber,i+1,n.startLineNumber,t.length+1),o,s,this._insertSpace)}else a=ALe._createAddBlockCommentOperations(new TK(n.startLineNumber,e.getLineFirstNonWhitespaceColumn(n.startLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),o,s,this._insertSpace);1===a.length&&(this._deltaColumn=o.length+1)}this._selectionId=t.trackSelection(n);for(const l of a)t.addEditOperation(l.range,l.text)}getEditOperations(e,t){let n=this._selection;if(this._moveEndPositionDown=!1,n.startLineNumber===n.endLineNumber&&this._ignoreFirstLine)return t.addEditOperation(new TK(n.startLineNumber,e.getLineMaxColumn(n.startLineNumber),n.startLineNumber+1,1),n.startLineNumber===e.getLineCount()?"":"\n"),void(this._selectionId=t.trackSelection(n));n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._moveEndPositionDown=!0,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));const i=OLe._gatherPreflightData(this._type,this._insertSpace,e,n.startLineNumber,n.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine);return i.supported?this._executeLineComments(e,t,i,n):this._executeBlockComment(e,t,n)}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(n=n.setEndPosition(n.endLineNumber+1,1)),new MK(n.selectionStartLineNumber,n.selectionStartColumn+this._deltaColumn,n.positionLineNumber,n.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,t){let n=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];r.ignore||n.push(H3.delete(new TK(t+i,r.commentStrOffset+1,t+i,r.commentStrOffset+r.commentStrLength+1)))}return n}_createAddLineCommentsOperations(e,t){let n=[];const i=this._insertSpace?" ":"";for(let r=0,o=e.length;r<o;r++){const o=e[r];o.ignore||n.push(H3.insert(new IK(t+r,o.commentStrOffset+1),o.commentStr+i))}return n}static nextVisibleColumn(e,t,n,i){return n?e+(t-e%t):e+i}static _normalizeInsertionPoint(e,t,n,i){let r,o,s=1073741824;for(let a=0,l=t.length;a<l;a++){if(t[a].ignore)continue;const r=e.getLineContent(n+a);let o=0;for(let e=0,n=t[a].commentStrOffset;o<s&&e<n;e++)o=OLe.nextVisibleColumn(o,i,9===r.charCodeAt(e),1);o<s&&(s=o)}s=Math.floor(s/i)*i;for(let a=0,l=t.length;a<l;a++){if(t[a].ignore)continue;const l=e.getLineContent(n+a);let c=0;for(r=0,o=t[a].commentStrOffset;c<s&&r<o;r++)c=OLe.nextVisibleColumn(c,i,9===l.charCodeAt(r),1);t[a].commentStrOffset=c>s?r-1:r}}}class RLe extends o6{constructor(e,t){super(t),this._type=e}run(e,t){if(!t.hasModel())return;const n=[],i=t.getModel().getOptions(),r=t.getOption(17),o=t.getSelections().map(((e,t)=>({selection:e,index:t,ignoreFirstLine:!1})));o.sort(((e,t)=>TK.compareRangesUsingStarts(e.selection,t.selection)));let s=o[0];for(let a=1;a<o.length;a++){const e=o[a];s.selection.endLineNumber===e.selection.startLineNumber&&(s.index<e.index?e.ignoreFirstLine=!0:(s.ignoreFirstLine=!0,s=e))}for(const a of o)n.push(new OLe(a.selection,i.tabSize,this._type,r.insertSpace,r.ignoreEmptyLines,a.ignoreFirstLine));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}c6(class extends RLe{constructor(){super(0,{id:"editor.action.commentLine",label:GH(0,"Toggle Line Comment"),alias:"Toggle Line Comment",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:2133,weight:100},menuOpts:{menuId:Y5.MenubarEditMenu,group:"5_insert",title:GH(0,"&&Toggle Line Comment"),order:1}})}}),c6(class extends RLe{constructor(){super(1,{id:"editor.action.addCommentLine",label:GH(0,"Add Line Comment"),alias:"Add Line Comment",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2081),weight:100}})}}),c6(class extends RLe{constructor(){super(2,{id:"editor.action.removeCommentLine",label:GH(0,"Remove Line Comment"),alias:"Remove Line Comment",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2099),weight:100}})}}),c6(class extends o6{constructor(){super({id:"editor.action.blockComment",label:GH(0,"Toggle Block Comment"),alias:"Toggle Block Comment",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:Y5.MenubarEditMenu,group:"5_insert",title:GH(0,"Toggle &&Block Comment"),order:2}})}run(e,t){if(!t.hasModel())return;const n=t.getOption(17),i=[],r=t.getSelections();for(const o of r)i.push(new ALe(o,n.insertSpace));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}});var PLe=function(e,t){return function(n,i){t(n,i,e)}};let FLe=class e{constructor(e,t,n,i,r,o){this._contextMenuService=t,this._contextViewService=n,this._contextKeyService=i,this._keybindingService=r,this._menuService=o,this._toDispose=new pG,this._contextMenuIsBeingShownCount=0,this._editor=e,this._toDispose.add(this._editor.onContextMenu((e=>this._onContextMenu(e)))),this._toDispose.add(this._editor.onMouseWheel((e=>{if(this._contextMenuIsBeingShownCount>0){const t=this._contextViewService.getContextViewElement(),n=e.srcElement;n.shadowRoot&&LY(t)===n.shadowRoot||this._contextViewService.hideContextView()}}))),this._toDispose.add(this._editor.onKeyDown((e=>{58===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.showContextMenu())})))}static get(t){return t.getContribution(e.ID)}_onContextMenu(e){if(!this._editor.hasModel())return;if(!this._editor.getOption(18))return this._editor.focus(),void(e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position));if(12===e.target.type)return;if(e.event.preventDefault(),6!==e.target.type&&7!==e.target.type&&1!==e.target.type)return;if(this._editor.focus(),e.target.position){let t=!1;for(const n of this._editor.getSelections())if(n.containsPosition(e.target.position)){t=!0;break}t||this._editor.setPosition(e.target.position)}let t=null;1!==e.target.type&&(t={x:e.event.posx-1,width:2,y:e.event.posy-1,height:2}),this.showContextMenu(t)}showContextMenu(e){if(!this._editor.getOption(18))return;if(!this._editor.hasModel())return;if(!this._contextMenuService)return void this._editor.focus();const t=this._getMenuActions(this._editor.getModel(),this._editor.isSimpleWidget?Y5.SimpleEditorContext:Y5.EditorContext);t.length>0&&this._doShowContextMenu(t,e)}_getMenuActions(e,t){const n=[],i=this._menuService.createMenu(t,this._contextKeyService),r=i.getActions({arg:e.uri});i.dispose();for(let o of r){const[,t]=o;let i=0;for(const r of t)if(r instanceof Q5){const t=this._getMenuActions(e,r.item.submenu);t.length>0&&(n.push(new c5(r.id,r.label,t)),i++)}else n.push(r),i++;i&&n.push(new l5)}return n.length&&n.pop(),n}_doShowContextMenu(e,t=null){if(!this._editor.hasModel())return;const n=this._editor.getOption(50);if(this._editor.updateOptions({hover:{enabled:!1}}),!t){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const e=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),n=mY(this._editor.getDomNode()),i=n.left+e.left,r=n.top+e.top+e.height;t={x:i,y:r}}const i=this._editor.getOption(112)&&!dj;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:i?this._editor.getDomNode():void 0,getAnchor:()=>t,getActions:()=>e,getActionViewItem:e=>{const t=this._keybindingFor(e);if(t)return new wle(e,e,{label:!0,keybinding:t.getLabel(),isMenu:!0});const n=e;return"function"==typeof n.getActionViewItem?n.getActionViewItem():new wle(e,e,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:e=>this._keybindingFor(e),onHide:e=>{this._contextMenuIsBeingShownCount--,this._editor.focus(),this._editor.updateOptions({hover:n})}})}_keybindingFor(e){return this._keybindingService.lookupKeybinding(e.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};FLe.ID="editor.contrib.contextmenu",FLe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([PLe(1,Wle),PLe(2,Ble),PLe(3,A5),PLe(4,gce),PLe(5,X5)],FLe);d6(FLe.ID,FLe),c6(class extends o6{constructor(){super({id:"editor.action.showContextMenu",label:GH(0,"Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:gre.textInputFocus,primary:1092,weight:100}})}run(e,t){FLe.get(t).showContextMenu()}});class BLe{constructor(e){this.selections=e}equals(e){const t=this.selections.length;if(t!==e.selections.length)return!1;for(let n=0;n<t;n++)if(!this.selections[n].equalsSelection(e.selections[n]))return!1;return!0}}class WLe{constructor(e,t,n){this.cursorState=e,this.scrollTop=t,this.scrollLeft=n}}class zLe extends mG{constructor(e){super(),this._editor=e,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(e.onDidChangeModel((e=>{this._undoStack=[],this._redoStack=[]}))),this._register(e.onDidChangeModelContent((e=>{this._undoStack=[],this._redoStack=[]}))),this._register(e.onDidChangeCursorSelection((t=>{if(this._isCursorUndoRedo)return;if(!t.oldSelections)return;if(t.oldModelVersionId!==t.modelVersionId)return;const n=new BLe(t.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(n)||(this._undoStack.push(new WLe(n,e.getScrollTop(),e.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())})))}static get(e){return e.getContribution(zLe.ID)}cursorUndo(){this._editor.hasModel()&&0!==this._undoStack.length&&(this._redoStack.push(new WLe(new BLe(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){this._editor.hasModel()&&0!==this._redoStack.length&&(this._undoStack.push(new WLe(new BLe(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(e){this._isCursorUndoRedo=!0,this._editor.setSelections(e.cursorState.selections),this._editor.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),this._isCursorUndoRedo=!1}}zLe.ID="editor.contrib.cursorUndoRedoController";d6(zLe.ID,zLe),c6(class extends o6{constructor(){super({id:"cursorUndo",label:GH(0,"Cursor Undo"),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:gre.textInputFocus,primary:2099,weight:100}})}run(e,t,n){zLe.get(t).cursorUndo()}}),c6(class extends o6{constructor(){super({id:"cursorRedo",label:GH(0,"Cursor Redo"),alias:"Cursor Redo",precondition:void 0})}run(e,t,n){zLe.get(t).cursorRedo()}});class VLe{constructor(e,t,n){this.selection=e,this.targetPosition=t,this.copy=n,this.targetSelection=null}getEditOperations(e,t){let n=e.getValueInRange(this.selection);this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new TK(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),n),!this.selection.containsPosition(this.targetPosition)||this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition))?this.copy?this.targetSelection=new MK(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber>this.selection.endLineNumber?this.targetSelection=new MK(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber<this.selection.endLineNumber?this.targetSelection=new MK(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new MK(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,(this.selection.startLineNumber,this.selection.endLineNumber,this.targetPosition.column-this.selection.endColumn+this.selection.startColumn),this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new MK(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn):this.targetSelection=this.selection}computeCursorState(e,t){return this.targetSelection}}function ULe(e){return lj?e.altKey:e.ctrlKey}class HLe extends mG{constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._register(this._editor.onMouseDrag((e=>this._onEditorMouseDrag(e)))),this._register(this._editor.onMouseDrop((e=>this._onEditorMouseDrop(e)))),this._register(this._editor.onMouseDropCanceled((()=>this._onEditorMouseDropCanceled()))),this._register(this._editor.onKeyDown((e=>this.onEditorKeyDown(e)))),this._register(this._editor.onKeyUp((e=>this.onEditorKeyUp(e)))),this._register(this._editor.onDidBlurEditorWidget((()=>this.onEditorBlur()))),this._register(this._editor.onDidBlurEditorText((()=>this.onEditorBlur()))),this._dndDecorationIds=[],this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){this._editor.getOption(29)&&!this._editor.getOption(16)&&(ULe(e)&&(this._modifierPressed=!0),this._mouseDown&&ULe(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){this._editor.getOption(29)&&!this._editor.getOption(16)&&(ULe(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===HLe.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){let t=e.target;if(null===this._dragSelection){let e=(this._editor.getSelections()||[]).filter((e=>t.position&&e.containsPosition(t.position)));if(1!==e.length)return;this._dragSelection=e[0]}ULe(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){let t=new IK(e.target.position.lineNumber,e.target.position.column);if(null===this._dragSelection){let n=null;if(e.event.shiftKey){let e=this._editor.getSelection();if(e){const{selectionStartLineNumber:i,selectionStartColumn:r}=e;n=[new MK(i,r,t.lineNumber,t.column)]}}else n=(this._editor.getSelections()||[]).map((e=>e.containsPosition(t)?new MK(t.lineNumber,t.column,t.lineNumber,t.column):e));this._editor.setSelections(n||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(ULe(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(HLe.ID,new VLe(this._dragSelection,t,ULe(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(e){let t=[{range:new TK(e.lineNumber,e.column,e.lineNumber,e.column),options:HLe._DECORATION_OPTIONS}];this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,t),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,[])}_hitContent(e){return 6===e.type||7===e.type}_hitMargin(e){return 2===e.type||3===e.type||4===e.type}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}HLe.ID="editor.contrib.dragAndDrop",HLe.TRIGGER_KEY_VALUE=lj?6:5,HLe._DECORATION_OPTIONS=v7.register({description:"dnd-target",className:"dnd-target"}),d6(HLe.ID,HLe);class jLe{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.deltaDecorations(this._allDecorations(),[]),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map((e=>this._editor.getModel().getDecorationRange(e))).filter((e=>!!e));if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getCurrentMatchesPosition(e){let t=this._editor.getModel().getDecorationsInRange(e);for(const n of t){const e=n.options;if(e===jLe._FIND_MATCH_DECORATION||e===jLe._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(n.id)}return 0}setCurrentFindMatch(e){let t=null,n=0;if(e)for(let i=0,r=this._decorations.length;i<r;i++){let r=this._editor.getModel().getDecorationRange(this._decorations[i]);if(e.equalsRange(r)){t=this._decorations[i],n=i+1;break}}return null===this._highlightedDecorationId&&null===t||this._editor.changeDecorations((e=>{if(null!==this._highlightedDecorationId&&(e.changeDecorationOptions(this._highlightedDecorationId,jLe._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),null!==t&&(this._highlightedDecorationId=t,e.changeDecorationOptions(this._highlightedDecorationId,jLe._CURRENT_FIND_MATCH_DECORATION)),null!==this._rangeHighlightDecorationId&&(e.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),null!==t){let n=this._editor.getModel().getDecorationRange(t);if(n.startLineNumber!==n.endLineNumber&&1===n.endColumn){let e=n.endLineNumber-1,t=this._editor.getModel().getLineMaxColumn(e);n=new TK(n.startLineNumber,n.startColumn,e,t)}this._rangeHighlightDecorationId=e.addDecoration(n,jLe._RANGE_HIGHLIGHT_DECORATION)}})),n}set(e,t){this._editor.changeDecorations((n=>{let i=jLe._FIND_MATCH_DECORATION,r=[];if(e.length>1e3){i=jLe._FIND_MATCH_NO_OVERVIEW_DECORATION;const t=this._editor.getModel().getLineCount(),n=this._editor.getLayoutInfo().height/t,o=Math.max(2,Math.ceil(3/n));let s=e[0].range.startLineNumber,a=e[0].range.endLineNumber;for(let i=1,l=e.length;i<l;i++){const t=e[i].range;a+o>=t.startLineNumber?t.endLineNumber>a&&(a=t.endLineNumber):(r.push({range:new TK(s,1,a,1),options:jLe._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),s=t.startLineNumber,a=t.endLineNumber)}r.push({range:new TK(s,1,a,1),options:jLe._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}let o=new Array(e.length);for(let t=0,s=e.length;t<s;t++)o[t]={range:e[t].range,options:i};this._decorations=n.deltaDecorations(this._decorations,o),this._overviewRulerApproximateDecorations=n.deltaDecorations(this._overviewRulerApproximateDecorations,r),this._rangeHighlightDecorationId&&(n.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach((e=>n.removeDecoration(e))),this._findScopeDecorationIds=[]),(null==t?void 0:t.length)&&(this._findScopeDecorationIds=t.map((e=>n.addDecoration(e,jLe._FIND_SCOPE_DECORATION))))}))}matchBeforePosition(e){if(0===this._decorations.length)return null;for(let t=this._decorations.length-1;t>=0;t--){let n=this._decorations[t],i=this._editor.getModel().getDecorationRange(n);if(i&&!(i.endLineNumber>e.lineNumber)){if(i.endLineNumber<e.lineNumber)return i;if(!(i.endColumn>e.column))return i}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(0===this._decorations.length)return null;for(let t=0,n=this._decorations.length;t<n;t++){let n=this._decorations[t],i=this._editor.getModel().getDecorationRange(n);if(i&&!(i.startLineNumber<e.lineNumber)){if(i.startLineNumber>e.lineNumber)return i;if(!(i.startColumn<e.column))return i}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}jLe._CURRENT_FIND_MATCH_DECORATION=v7.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:V5(zne),position:wQ.Center},minimap:{color:V5(Une),position:CQ.Inline}}),jLe._FIND_MATCH_DECORATION=v7.register({description:"find-match",stickiness:1,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:V5(zne),position:wQ.Center},minimap:{color:V5(Une),position:CQ.Inline}}),jLe._FIND_MATCH_NO_OVERVIEW_DECORATION=v7.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),jLe._FIND_MATCH_ONLY_OVERVIEW_DECORATION=v7.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:V5(zne),position:wQ.Center}}),jLe._RANGE_HIGHLIGHT_DECORATION=v7.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),jLe._FIND_SCOPE_DECORATION=v7.register({description:"find-scope",className:"findScope",isWholeLine:!0});class GLe{constructor(e,t,n){this._editorSelection=e,this._ranges=t,this._replaceStrings=n,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){let e=[];for(let t=0;t<this._ranges.length;t++)e.push({range:this._ranges[t],text:this._replaceStrings[t]});e.sort(((e,t)=>TK.compareRangesUsingStarts(e.range,t.range)));let n=[],i=e[0];for(let t=1;t<e.length;t++)i.range.endLineNumber===e[t].range.startLineNumber&&i.range.endColumn===e[t].range.startColumn?(i.range=i.range.plusRange(e[t].range),i.text=i.text+e[t].text):(n.push(i),i=e[t]);n.push(i);for(const r of n)t.addEditOperation(r.range,r.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function KLe(e,t){if(e&&""!==e[0]){const n=qLe(e,t,"-"),i=qLe(e,t,"_");return n&&!i?$Le(e,t,"-"):!n&&i?$Le(e,t,"_"):e[0].toUpperCase()===e[0]?t.toUpperCase():e[0].toLowerCase()===e[0]?t.toLowerCase():function(e,t=!1){return!!e&&(t&&(e=e.replace(/\\./g,"")),e.toLowerCase()!==e)}(e[0][0])&&t.length>0?t[0].toUpperCase()+t.substr(1):e[0][0].toUpperCase()!==e[0][0]&&t.length>0?t[0].toLowerCase()+t.substr(1):t}return t}function qLe(e,t,n){return-1!==e[0].indexOf(n)&&-1!==t.indexOf(n)&&e[0].split(n).length===t.split(n).length}function $Le(e,t,n){const i=t.split(n),r=e[0].split(n);let o="";return i.forEach(((e,t)=>{o+=KLe([r[t]],e)+n})),o.slice(0,-1)}class YLe{constructor(e){this.staticValue=e,this.kind=0}}class XLe{constructor(e){this.pieces=e,this.kind=1}}class ZLe{constructor(e){e&&0!==e.length?1===e.length&&null!==e[0].staticValue?this._state=new YLe(e[0].staticValue):this._state=new XLe(e):this._state=new YLe("")}static fromStaticValue(e){return new ZLe([QLe.staticValue(e)])}get hasReplacementPatterns(){return 1===this._state.kind}buildReplaceString(e,t){if(0===this._state.kind)return t?KLe(e,this._state.staticValue):this._state.staticValue;let n="";for(let i=0,r=this._state.pieces.length;i<r;i++){let t=this._state.pieces[i];if(null!==t.staticValue){n+=t.staticValue;continue}let r=ZLe._substitute(t.matchIndex,e);if(null!==t.caseOps&&t.caseOps.length>0){let e=[],n=t.caseOps.length,i=0;for(let o=0,s=r.length;o<s;o++){if(i>=n){e.push(r.slice(o));break}switch(t.caseOps[i]){case"U":e.push(r[o].toUpperCase());break;case"u":e.push(r[o].toUpperCase()),i++;break;case"L":e.push(r[o].toLowerCase());break;case"l":e.push(r[o].toLowerCase()),i++;break;default:e.push(r[o])}}r=e.join("")}n+=r}return n}static _substitute(e,t){if(null===t)return"";if(0===e)return t[0];let n="";for(;e>0;){if(e<t.length){return(t[e]||"")+n}n=String(e%10)+n,e=Math.floor(e/10)}return"$"+n}}class QLe{constructor(e,t,n){this.staticValue=e,this.matchIndex=t,n&&0!==n.length?this.caseOps=n.slice(0):this.caseOps=null}static staticValue(e){return new QLe(e,-1,null)}static caseOps(e,t){return new QLe(null,e,t)}}class JLe{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){0!==e.length&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,n){0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=QLe.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=QLe.caseOps(e,n),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=QLe.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new ZLe(this._result)}}const eDe=new M5("findWidgetVisible",!1),tDe=new M5("findInputFocussed",!1),nDe=new M5("replaceInputFocussed",!1),iDe={primary:545,mac:{primary:2593}},rDe={primary:565,mac:{primary:2613}},oDe={primary:560,mac:{primary:2608}},sDe={primary:554,mac:{primary:2602}},aDe={primary:558,mac:{primary:2606}},lDe="actions.find",cDe="actions.findWithSelection",uDe="editor.action.nextMatchFindAction",hDe="editor.action.previousMatchFindAction",dDe="editor.action.nextSelectionMatchFindAction",fDe="editor.action.previousSelectionMatchFindAction",gDe="editor.action.startFindReplaceAction",pDe="closeFindWidget",mDe="toggleFindCaseSensitive",vDe="toggleFindWholeWord",yDe="toggleFindRegex",_De="toggleFindInSelection",bDe="togglePreserveCase",wDe="editor.action.replaceOne",CDe="editor.action.replaceAll",SDe="editor.action.selectAllMatches";class xDe{constructor(e,t){this._toDispose=new pG,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new B$,this._decorations=new jLe(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new z$((()=>this.research(!1)),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition((e=>{3!==e.reason&&5!==e.reason&&6!==e.reason||this._decorations.setStartPosition(this._editor.getPosition())}))),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent((e=>{this._ignoreModelContentChanged||(e.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())}))),this._toDispose.add(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,dG(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){if(!this._isDisposed&&this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)){this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet((()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}),240)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let n=null;void 0!==t?null!==t&&(n=Array.isArray(t)?t:[t]):n=this._decorations.getFindScopes(),null!==n&&(n=n.map((e=>{if(e.startLineNumber!==e.endLineNumber){let t=e.endLineNumber;return 1===e.endColumn&&(t-=1),new TK(e.startLineNumber,1,t,this._editor.getModel().getLineMaxColumn(t))}return e})));let i=this._findMatches(n,!1,19999);this._decorations.set(i,n);const r=this._editor.getSelection();let o=this._decorations.getCurrentMatchesPosition(r);if(0===o&&i.length>0){const e=I1(i.map((e=>e.range)),(e=>TK.compareRangesUsingStarts(e,r)>=0));o=e>0?e-1+1:o}this._state.changeMatchInfo(o,this._decorations.getCount(),void 0),e&&this._editor.getOption(33).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){let e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){let t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber:n,column:i}=e,r=this._editor.getModel();return t||1===i?(1===n?n=r.getLineCount():n--,i=r.getLineMaxColumn(n)):i--,new IK(n,i)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const t=this._decorations.matchAfterPosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<19999){let t=this._decorations.matchBeforePosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),t=this._decorations.matchBeforePosition(e)),void(t&&this._setCurrentFindMatch(t))}if(this._cannotFind())return;let n=this._decorations.getFindScope(),i=xDe._getSearchRange(this._editor.getModel(),n);i.getEndPosition().isBefore(e)&&(e=i.getEndPosition()),e.isBefore(i.getStartPosition())&&(e=i.getEndPosition());let{lineNumber:r,column:o}=e,s=this._editor.getModel(),a=new IK(r,o),l=s.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(114):null,!1);return l&&l.range.isEmpty()&&l.range.getStartPosition().equals(a)&&(a=this._prevSearchPosition(a),l=s.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(114):null,!1)),l?t||i.containsRange(l.range)?void this._setCurrentFindMatch(l.range):this._moveToPrevMatch(l.range.getStartPosition(),!0):void 0}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber:n,column:i}=e,r=this._editor.getModel();return t||i===r.getLineMaxColumn(n)?(n===r.getLineCount()?n=1:n++,i=1):i++,new IK(n,i)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const t=this._decorations.matchBeforePosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<19999){let t=this._decorations.matchAfterPosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),t=this._decorations.matchAfterPosition(e)),void(t&&this._setCurrentFindMatch(t))}let t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,n,i=!1){if(this._cannotFind())return null;let r=this._decorations.getFindScope(),o=xDe._getSearchRange(this._editor.getModel(),r);o.getEndPosition().isBefore(e)&&(e=o.getStartPosition()),e.isBefore(o.getStartPosition())&&(e=o.getStartPosition());let{lineNumber:s,column:a}=e,l=this._editor.getModel(),c=new IK(s,a),u=l.findNextMatch(this._state.searchString,c,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(114):null,t);return n&&u&&u.range.isEmpty()&&u.range.getStartPosition().equals(c)&&(c=this._nextSearchPosition(c),u=l.findNextMatch(this._state.searchString,c,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(114):null,t)),u?i||o.containsRange(u.range)?u:this._getNextMatch(u.range.getEndPosition(),t,n,!0):null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_getReplacePattern(){return this._state.isRegex?function(e){if(!e||0===e.length)return new ZLe(null);let t=[],n=new JLe(e);for(let i=0,r=e.length;i<r;i++){let o=e.charCodeAt(i);if(92!==o){if(36===o){if(i++,i>=r)break;let o=e.charCodeAt(i);if(36===o){n.emitUnchanged(i-1),n.emitStatic("$",i+1);continue}if(48===o||38===o){n.emitUnchanged(i-1),n.emitMatchIndex(0,i+1,t),t.length=0;continue}if(49<=o&&o<=57){let s=o-48;if(i+1<r){let r=e.charCodeAt(i+1);if(48<=r&&r<=57){i++,s=10*s+(r-48),n.emitUnchanged(i-2),n.emitMatchIndex(s,i+1,t),t.length=0;continue}}n.emitUnchanged(i-1),n.emitMatchIndex(s,i+1,t),t.length=0;continue}}}else{if(i++,i>=r)break;let o=e.charCodeAt(i);switch(o){case 92:n.emitUnchanged(i-1),n.emitStatic("\\",i+1);break;case 110:n.emitUnchanged(i-1),n.emitStatic("\n",i+1);break;case 116:n.emitUnchanged(i-1),n.emitStatic("\t",i+1);break;case 117:case 85:case 108:case 76:n.emitUnchanged(i-1),n.emitStatic("",i+1),t.push(String.fromCharCode(o))}}}return n.finalize()}(this._state.replaceString):ZLe.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;let e=this._getReplacePattern(),t=this._editor.getSelection(),n=this._getNextMatch(t.getStartPosition(),!0,!1);if(n)if(t.equalsRange(n.range)){let i=e.buildReplaceString(n.matches,this._state.preserveCase),r=new jie(t,i);this._executeEditorCommand("replace",r),this._decorations.setStartPosition(new IK(t.startLineNumber,t.startColumn+i.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(n.range)}_findMatches(e,t,n){const i=(e||[null]).map((e=>xDe._getSearchRange(this._editor.getModel(),e)));return this._editor.getModel().findMatches(this._state.searchString,i,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(114):null,t,n)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();null===e&&this._state.matchesCount>=19999?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const e=new a8(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(114):null).parseSearchRequest();if(!e)return;let t=e.regex;if(!t.multiline){let e="mu";t.ignoreCase&&(e+="i"),t.global&&(e+="g"),t=new RegExp(t.source,e)}const n=this._editor.getModel(),i=n.getValue(1),r=n.getFullModelRange(),o=this._getReplacePattern();let s;const a=this._state.preserveCase;s=o.hasReplacementPatterns||a?i.replace(t,(function(){return o.buildReplaceString(arguments,a)})):i.replace(t,o.buildReplaceString(null,a));let l=new $ie(r,s,this._editor.getSelection());this._executeEditorCommand("replaceAll",l)}_regularReplaceAll(e){const t=this._getReplacePattern();let n=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),i=[];for(let o=0,s=n.length;o<s;o++)i[o]=t.buildReplaceString(n[o].matches,this._state.preserveCase);let r=new GLe(this._editor.getSelection(),n.map((e=>e.range)),i);this._executeEditorCommand("replaceAll",r)}selectAllMatches(){if(!this._hasMatches())return;let e=this._decorations.getFindScopes(),t=this._findMatches(e,!1,1073741824).map((e=>new MK(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn))),n=this._editor.getSelection();for(let i=0,r=t.length;i<r;i++){if(t[i].equalsRange(n)){t=[n].concat(t.slice(0,i)).concat(t.slice(i+1));break}}this._editor.setSelections(t)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}const EDe={inputActiveOptionBorder:Q8.fromHex("#007ACC00"),inputActiveOptionForeground:Q8.fromHex("#FFFFFF"),inputActiveOptionBackground:Q8.fromHex("#0E639C50")};class kDe extends Yre{constructor(e){super(),this._onChange=this._register(new EG),this.onChange=this._onChange.event,this._onKeyDown=this._register(new EG),this.onKeyDown=this._onKeyDown.event,this._opts=Object.assign(Object.assign({},EDe),e),this._checked=this._opts.isChecked;const t=["monaco-custom-checkbox"];this._opts.icon&&t.push(...dJ.asClassNameArray(this._opts.icon)),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this.domNode.title=this._opts.title,this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,(e=>{this.checked=!this._checked,this._onChange.fire(!1),e.preventDefault()})),this.ignoreGesture(this.domNode),this.onkeydown(this.domNode,(e=>{if(10===e.keyCode||3===e.keyCode)return this.checked=!this._checked,this._onChange.fire(!0),void e.preventDefault();this._onKeyDown.fire(e)}))}get enabled(){return"true"!==this.domNode.getAttribute("aria-disabled")}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}style(e){e.inputActiveOptionBorder&&(this._opts.inputActiveOptionBorder=e.inputActiveOptionBorder),e.inputActiveOptionForeground&&(this._opts.inputActiveOptionForeground=e.inputActiveOptionForeground),e.inputActiveOptionBackground&&(this._opts.inputActiveOptionBackground=e.inputActiveOptionBackground),this.applyStyles()}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder?this._opts.inputActiveOptionBorder.toString():"transparent",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground?this._opts.inputActiveOptionForeground.toString():"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground?this._opts.inputActiveOptionBackground.toString():"transparent")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}const LDe=GH(0,"Match Case"),DDe=GH(0,"Match Whole Word"),NDe=GH(0,"Use Regular Expression");class IDe extends kDe{constructor(e){super({icon:hJ.caseSensitive,title:LDe+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class TDe extends kDe{constructor(e){super({icon:hJ.wholeWord,title:DDe+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class MDe extends kDe{constructor(e){super({icon:hJ.regex,title:NDe+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class ADe extends Yre{constructor(e,t,n,i){super(),this._hideSoon=this._register(new z$((()=>this._hide()),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=n,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const r=i.getColorTheme().getColor(Aee),o=i.getColorTheme().getColor(Ree),s=i.getColorTheme().getColor(Oee);this.caseSensitive=this._register(new IDe({appendTitle:this._keybindingLabelFor(mDe),isChecked:this._state.matchCase,inputActiveOptionBorder:r,inputActiveOptionForeground:o,inputActiveOptionBackground:s})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange((()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)}))),this.wholeWords=this._register(new TDe({appendTitle:this._keybindingLabelFor(vDe),isChecked:this._state.wholeWord,inputActiveOptionBorder:r,inputActiveOptionForeground:o,inputActiveOptionBackground:s})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange((()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)}))),this.regex=this._register(new MDe({appendTitle:this._keybindingLabelFor(yDe),isChecked:this._state.isRegex,inputActiveOptionBorder:r,inputActiveOptionForeground:o,inputActiveOptionBackground:s})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange((()=>{this._state.change({isRegex:this.regex.checked},!1)}))),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange((e=>{let t=!1;e.isRegex&&(this.regex.checked=this._state.isRegex,t=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,t=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,t=!0),!this._state.isRevealed&&t&&this._revealTemporarily()}))),this._register(iY(this._domNode,(e=>this._onMouseOut()))),this._register(Q$(this._domNode,"mouseover",(e=>this._onMouseOver()))),this._applyTheme(i.getColorTheme()),this._register(i.onDidColorThemeChange(this._applyTheme.bind(this)))}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return ADe.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseOut(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(Aee),inputActiveOptionForeground:e.getColor(Ree),inputActiveOptionBackground:e.getColor(Oee)};this.caseSensitive.style(t),this.wholeWords.style(t),this.regex.style(t)}}function ODe(e,t){return 1===e||2!==e&&t}ADe.ID="editor.contrib.findOptionsWidget",G5(((e,t)=>{const n=e.getColor(mte);n&&t.addRule(`.monaco-editor .findOptionsWidget { background-color: ${n}; }`);const i=e.getColor(vte);i&&t.addRule(`.monaco-editor .findOptionsWidget { color: ${i}; }`);const r=e.getColor(Nee);r&&t.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${r}; }`);const o=e.getColor(xee);o&&t.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${o}; }`)}));class RDe extends mG{constructor(){super(),this._onFindReplaceStateChange=this._register(new EG),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0}get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return ODe(this._isRegexOverride,this._isRegex)}get wholeWord(){return ODe(this._wholeWordOverride,this._wholeWord)}get matchCase(){return ODe(this._matchCaseOverride,this._matchCase)}get preserveCase(){return ODe(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}changeMatchInfo(e,t,n){let i={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1},r=!1;0===t&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,i.matchesPosition=!0,r=!0),this._matchesCount!==t&&(this._matchesCount=t,i.matchesCount=!0,r=!0),void 0!==n&&(TK.equalsRange(this._currentMatch,n)||(this._currentMatch=n,i.currentMatch=!0,r=!0)),r&&this._onFindReplaceStateChange.fire(i)}change(e,t,n=!0){var i;let r={moveCursor:t,updateHistory:n,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1},o=!1;const s=this.isRegex,a=this.wholeWord,l=this.matchCase,c=this.preserveCase;void 0!==e.searchString&&this._searchString!==e.searchString&&(this._searchString=e.searchString,r.searchString=!0,o=!0),void 0!==e.replaceString&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,r.replaceString=!0,o=!0),void 0!==e.isRevealed&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,r.isRevealed=!0,o=!0),void 0!==e.isReplaceRevealed&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,r.isReplaceRevealed=!0,o=!0),void 0!==e.isRegex&&(this._isRegex=e.isRegex),void 0!==e.wholeWord&&(this._wholeWord=e.wholeWord),void 0!==e.matchCase&&(this._matchCase=e.matchCase),void 0!==e.preserveCase&&(this._preserveCase=e.preserveCase),void 0!==e.searchScope&&((null===(i=e.searchScope)||void 0===i?void 0:i.every((e=>{var t;return null===(t=this._searchScope)||void 0===t?void 0:t.some((t=>!TK.equalsRange(t,e)))})))||(this._searchScope=e.searchScope,r.searchScope=!0,o=!0)),void 0!==e.loop&&this._loop!==e.loop&&(this._loop=e.loop,r.loop=!0,o=!0),this._isRegexOverride=void 0!==e.isRegexOverride?e.isRegexOverride:0,this._wholeWordOverride=void 0!==e.wholeWordOverride?e.wholeWordOverride:0,this._matchCaseOverride=void 0!==e.matchCaseOverride?e.matchCaseOverride:0,this._preserveCaseOverride=void 0!==e.preserveCaseOverride?e.preserveCaseOverride:0,s!==this.isRegex&&(o=!0,r.isRegex=!0),a!==this.wholeWord&&(o=!0,r.wholeWord=!0),l!==this.matchCase&&(o=!0,r.matchCase=!0),c!==this.preserveCase&&(o=!0,r.preserveCase=!0),o&&this._onFindReplaceStateChange.fire(r)}canNavigateBack(){return this.canNavigateInLoop()||1!==this.matchesPosition}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=19999}}const PDe=GH(0,"input");class FDe extends Yre{constructor(e,t,n,i){super(),this._showOptionButtons=n,this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this._onDidOptionChange=this._register(new EG),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new EG),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new EG),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new EG),this._onKeyUp=this._register(new EG),this._onCaseSensitiveKeyDown=this._register(new EG),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new EG),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.contextViewProvider=t,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||PDe,this.inputActiveOptionBorder=i.inputActiveOptionBorder,this.inputActiveOptionForeground=i.inputActiveOptionForeground,this.inputActiveOptionBackground=i.inputActiveOptionBackground,this.inputBackground=i.inputBackground,this.inputForeground=i.inputForeground,this.inputBorder=i.inputBorder,this.inputValidationInfoBorder=i.inputValidationInfoBorder,this.inputValidationInfoBackground=i.inputValidationInfoBackground,this.inputValidationInfoForeground=i.inputValidationInfoForeground,this.inputValidationWarningBorder=i.inputValidationWarningBorder,this.inputValidationWarningBackground=i.inputValidationWarningBackground,this.inputValidationWarningForeground=i.inputValidationWarningForeground,this.inputValidationErrorBorder=i.inputValidationErrorBorder,this.inputValidationErrorBackground=i.inputValidationErrorBackground,this.inputValidationErrorForeground=i.inputValidationErrorForeground;const r=i.appendCaseSensitiveLabel||"",o=i.appendWholeWordsLabel||"",s=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,c=!!i.flexibleWidth,u=i.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Bme(this.domNode,this.contextViewProvider,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:a,flexibleHeight:l,flexibleWidth:c,flexibleMaxHeight:u})),this.regex=this._register(new MDe({appendTitle:s,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.regex.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.regex.onKeyDown((e=>{this._onRegexKeyDown.fire(e)}))),this.wholeWords=this._register(new TDe({appendTitle:o,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.wholeWords.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this.caseSensitive=this._register(new IDe({appendTitle:r,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.caseSensitive.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.caseSensitive.onKeyDown((e=>{this._onCaseSensitiveKeyDown.fire(e)}))),this._showOptionButtons&&(this.inputBox.paddingRight=this.caseSensitive.width()+this.wholeWords.width()+this.regex.width());let h=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,(e=>{if(e.equals(15)||e.equals(17)||e.equals(9)){let t=h.indexOf(document.activeElement);if(t>=0){let n=-1;e.equals(17)?n=(t+1)%h.length:e.equals(15)&&(n=0===t?h.length-1:t-1),e.equals(9)?(h[t].blur(),this.inputBox.focus()):n>=0&&h[n].focus(),PY(e,!0)}}}));let d=document.createElement("div");d.className="controls",d.style.display=this._showOptionButtons?"block":"none",d.appendChild(this.caseSensitive.domNode),d.appendChild(this.wholeWords.domNode),d.appendChild(this.regex.domNode),this.domNode.appendChild(d),e&&e.appendChild(this.domNode),this._register(Q$(this.inputBox.inputElement,"compositionstart",(e=>{this.imeSessionInProgress=!0}))),this._register(Q$(this.inputBox.inputElement,"compositionend",(e=>{this.imeSessionInProgress=!1,this._onInput.fire()}))),this.onkeydown(this.inputBox.inputElement,(e=>this._onKeyDown.fire(e))),this.onkeyup(this.inputBox.inputElement,(e=>this._onKeyUp.fire(e))),this.oninput(this.inputBox.inputElement,(e=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(e=>this._onMouseDown.fire(e)))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex.enable(),this.wholeWords.enable(),this.caseSensitive.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex.disable(),this.wholeWords.disable(),this.caseSensitive.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.regex.style(e),this.wholeWords.style(e),this.caseSensitive.style(e);const t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive.checked}setCaseSensitive(e){this.caseSensitive.checked=e}getWholeWords(){return this.wholeWords.checked}setWholeWords(e){this.wholeWords.checked=e}getRegex(){return this.regex.checked}setRegex(e){this.regex.checked=e,this.validate()}focusOnCaseSensitive(){this.caseSensitive.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}clearMessage(){this.inputBox.hideMessage()}}const BDe=GH(0,"input"),WDe=GH(0,"Preserve Case");class zDe extends kDe{constructor(e){super({icon:hJ.preserveCase,title:WDe+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class VDe extends Yre{constructor(e,t,n,i){super(),this._showOptionButtons=n,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new EG),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new EG),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new EG),this._onInput=this._register(new EG),this._onKeyUp=this._register(new EG),this._onPreserveCaseKeyDown=this._register(new EG),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||BDe,this.inputActiveOptionBorder=i.inputActiveOptionBorder,this.inputActiveOptionForeground=i.inputActiveOptionForeground,this.inputActiveOptionBackground=i.inputActiveOptionBackground,this.inputBackground=i.inputBackground,this.inputForeground=i.inputForeground,this.inputBorder=i.inputBorder,this.inputValidationInfoBorder=i.inputValidationInfoBorder,this.inputValidationInfoBackground=i.inputValidationInfoBackground,this.inputValidationInfoForeground=i.inputValidationInfoForeground,this.inputValidationWarningBorder=i.inputValidationWarningBorder,this.inputValidationWarningBackground=i.inputValidationWarningBackground,this.inputValidationWarningForeground=i.inputValidationWarningForeground,this.inputValidationErrorBorder=i.inputValidationErrorBorder,this.inputValidationErrorBackground=i.inputValidationErrorBackground,this.inputValidationErrorForeground=i.inputValidationErrorForeground;const r=i.appendPreserveCaseLabel||"",o=i.history||[],s=!!i.flexibleHeight,a=!!i.flexibleWidth,l=i.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Bme(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:o,flexibleHeight:s,flexibleWidth:a,flexibleMaxHeight:l})),this.preserveCase=this._register(new zDe({appendTitle:r,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.preserveCase.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.preserveCase.onKeyDown((e=>{this._onPreserveCaseKeyDown.fire(e)}))),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let c=[this.preserveCase.domNode];this.onkeydown(this.domNode,(e=>{if(e.equals(15)||e.equals(17)||e.equals(9)){let t=c.indexOf(document.activeElement);if(t>=0){let n=-1;e.equals(17)?n=(t+1)%c.length:e.equals(15)&&(n=0===t?c.length-1:t-1),e.equals(9)?(c[t].blur(),this.inputBox.focus()):n>=0&&c[n].focus(),PY(e,!0)}}}));let u=document.createElement("div");u.className="controls",u.style.display=this._showOptionButtons?"block":"none",u.appendChild(this.preserveCase.domNode),this.domNode.appendChild(u),e&&e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,(e=>this._onKeyDown.fire(e))),this.onkeyup(this.inputBox.inputElement,(e=>this._onKeyUp.fire(e))),this.oninput(this.inputBox.inputElement,(e=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(e=>this._onMouseDown.fire(e)))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.preserveCase.style(e);const t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox&&this.inputBox.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.inputBox.width=e,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var UDe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},HDe=function(e,t){return function(n,i){t(n,i,e)}};function jDe(e,t){return e.getContext(document.activeElement).getValue(t)}function GDe(e,t){const n=function(e,t){return e.createScoped(t.target)}(e,t);!function(e,t,n){new M5(n,t).bindTo(e)}(n,t,"historyNavigationWidget");return{scopedContextKeyService:n,historyNavigationEnablement:new M5("historyNavigationEnabled",!0).bindTo(n)}}let KDe=class extends FDe{constructor(e,t,n,i,r=!1){super(e,t,r,n),this._register(GDe(i,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};KDe=UDe([HDe(3,A5)],KDe);let qDe=class extends VDe{constructor(e,t,n,i,r=!1){super(e,t,r,n),this._register(GDe(i,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};qDe=UDe([HDe(3,A5)],qDe),o4.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:g5.and(g5.has("historyNavigationWidget"),g5.equals("historyNavigationEnabled",!0)),primary:16,secondary:[528],handler:(e,t)=>{const n=jDe(e.get(A5),"historyNavigationWidget");if(n){n.historyNavigator.showPreviousValue()}}}),o4.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:g5.and(g5.has("historyNavigationWidget"),g5.equals("historyNavigationEnabled",!0)),primary:18,secondary:[530],handler:(e,t)=>{const n=jDe(e.get(A5),"historyNavigationWidget");if(n){n.historyNavigator.showNextValue()}}});var $De=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const YDe=Ele("find-selection",hJ.selection,GH(0,"Icon for 'Find in Selection' in the editor find widget.")),XDe=Ele("find-collapsed",hJ.chevronRight,GH(0,"Icon to indicate that the editor find widget is collapsed.")),ZDe=Ele("find-expanded",hJ.chevronDown,GH(0,"Icon to indicate that the editor find widget is expanded.")),QDe=Ele("find-replace",hJ.replace,GH(0,"Icon for 'Replace' in the editor find widget.")),JDe=Ele("find-replace-all",hJ.replaceAll,GH(0,"Icon for 'Replace All' in the editor find widget.")),eNe=Ele("find-previous-match",hJ.arrowUp,GH(0,"Icon for 'Find Previous' in the editor find widget.")),tNe=Ele("find-next-match",hJ.arrowDown,GH(0,"Icon for 'Find Next' in the editor find widget.")),nNe=GH(0,"Find"),iNe=GH(0,"Find"),rNe=GH(0,"Previous match"),oNe=GH(0,"Next match"),sNe=GH(0,"Find in selection"),aNe=GH(0,"Close"),lNe=GH(0,"Replace"),cNe=GH(0,"Replace"),uNe=GH(0,"Replace"),hNe=GH(0,"Replace All"),dNe=GH(0,"Toggle Replace mode"),fNe=GH(0,"Only the first {0} results are highlighted, but all find operations work on the entire text.",19999),gNe=GH(0,"{0} of {1}"),pNe=GH(0,"No results");let mNe=69;const vNe=lj?256:2048;class yNe{constructor(e){this.afterLineNumber=e,this.heightInPx=33,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function _Ne(e,t,n){const i=!!t.match(/\n/);n&&i&&n.selectionStart>0&&e.stopPropagation()}function bNe(e,t,n){const i=!!t.match(/\n/);n&&i&&n.selectionEnd<n.value.length&&e.stopPropagation()}class wNe extends Yre{constructor(e,t,n,i,r,o,s,a,l){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=n,this._contextViewProvider=i,this._keybindingService=r,this._contextKeyService=o,this._storageService=a,this._notificationService=l,this._ctrlEnterReplaceAllWarningPrompted=!!a.getBoolean("ctrlEnterReplaceAll.windows.donotask",0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new A$(500),this._register(gG((()=>this._updateHistoryDelayer.cancel()))),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration((e=>{if(e.hasChanged(78)&&(this._codeEditor.getOption(78)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),e.hasChanged(128)&&this._tryUpdateWidgetWidth(),e.hasChanged(2)&&this.updateAccessibilitySupport(),e.hasChanged(33)){const e=this._codeEditor.getOption(33).addExtraSpaceOnTop;e&&!this._viewZone&&(this._viewZone=new yNe(0),this._showViewZone()),!e&&this._viewZone&&this._removeViewZone()}}))),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection((()=>{this._isVisible&&this._updateToggleSelectionFindButton()}))),this._register(this._codeEditor.onDidFocusEditorWidget((()=>$De(this,void 0,void 0,(function*(){if(this._isVisible){let e=yield this._controller.getGlobalBufferTerm();e&&e!==this._state.searchString&&(this._state.change({searchString:e},!1),this._findInput.select())}}))))),this._findInputFocused=tDe.bindTo(o),this._findFocusTracker=this._register(BY(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus((()=>{this._findInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._findFocusTracker.onDidBlur((()=>{this._findInputFocused.set(!1)}))),this._replaceInputFocused=nDe.bindTo(o),this._replaceFocusTracker=this._register(BY(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus((()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._replaceFocusTracker.onDidBlur((()=>{this._replaceInputFocused.set(!1)}))),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(33).addExtraSpaceOnTop&&(this._viewZone=new yNe(0)),this._applyTheme(s.getColorTheme()),this._register(s.onDidColorThemeChange(this._applyTheme.bind(this))),this._register(this._codeEditor.onDidChangeModel((()=>{this._isVisible&&(this._viewZoneId=void 0)}))),this._register(this._codeEditor.onDidScrollChange((e=>{e.scrollTopChanged?this._layoutViewZone():setTimeout((()=>{this._layoutViewZone()}),0)})))}getId(){return wNe.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?this._codeEditor.getOption(78)||this._isReplaceVisible||(this._isReplaceVisible=!0,this._replaceInput.width=yY(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){let e=this._state.searchString.length>0&&0===this._state.matchesCount;this._domNode.classList.toggle("no-results",e),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,nG)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){let e;if(this._matchesCount.style.minWidth=mNe+"px",this._state.matchesCount>=19999?this._matchesCount.title=fNe:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild),this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=19999&&(t+="+");let n=String(this._state.matchesPosition);"0"===n&&(n="?"),e=nX(gNe,n,t)}else e=pNe;this._matchesCount.appendChild(document.createTextNode(e)),t5(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),mNe=Math.max(mNe,this._matchesCount.clientWidth)}_getAriaLabel(e,t,n){if(e===pNe)return""===n?GH(0,"{0} found",e):GH(0,"{0} found for '{1}'",e,n);if(t){const i=GH(0,"{0} found for '{1}', at {2}",e,n,t.startLineNumber+":"+t.startColumn),r=this._codeEditor.getModel();if(r&&t.startLineNumber<=r.getLineCount()&&t.startLineNumber>=1){return`${r.getLineContent(t.startLineNumber)}, ${i}`}return i}return GH(0,"{0} found for '{1}'",e,n)}_updateToggleSelectionFindButton(){let e=this._codeEditor.getSelection(),t=!!e&&(e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn),n=this._toggleSelectionFind.checked;this._isVisible&&(n||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);let e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);let n=!this._codeEditor.getOption(78);this._toggleReplaceBtn.setEnabled(this._isVisible&&n)}_reveal(){if(this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(33).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":const t=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=t}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout((()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")}),0)),this._revealTimeouts.push(setTimeout((()=>{this._findInput.validate()}),200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(33).seedSearchStringFromSelection&&e){const n=this._codeEditor.getDomNode();if(n){const i=mY(n),r=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),o=i.left+(r?r.left:0),s=r?r.top:0;if(this._viewZone&&s<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const n=pY(this._domNode).left;o>n&&(t=!1);const r=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());i.left+(r?r.left:0)>n&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(33).addExtraSpaceOnTop)return void this._removeViewZone();if(!this._isVisible)return;const t=this._viewZone;void 0===this._viewZoneId&&t&&this._codeEditor.changeViewZones((n=>{t.heightInPx=this._getHeight(),this._viewZoneId=n.addZone(t),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+t.heightInPx)}))}_showViewZone(e=!0){if(!this._isVisible)return;if(!this._codeEditor.getOption(33).addExtraSpaceOnTop)return;void 0===this._viewZone&&(this._viewZone=new yNe(0));const t=this._viewZone;this._codeEditor.changeViewZones((n=>{if(void 0!==this._viewZoneId){const i=this._getHeight();if(i===t.heightInPx)return;let r=i-t.heightInPx;return t.heightInPx=i,n.layoutZone(this._viewZoneId),void(e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+r))}{let i=this._getHeight();if(i-=this._codeEditor.getOption(72).top,i<=0)return;t.heightInPx=i,this._viewZoneId=n.addZone(t),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+i)}}))}_removeViewZone(){this._codeEditor.changeViewZones((e=>{void 0!==this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))}))}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(Aee),inputActiveOptionBackground:e.getColor(Oee),inputActiveOptionForeground:e.getColor(Ree),inputBackground:e.getColor(Iee),inputForeground:e.getColor(Tee),inputBorder:e.getColor(Mee),inputValidationInfoBackground:e.getColor(Pee),inputValidationInfoForeground:e.getColor(Fee),inputValidationInfoBorder:e.getColor(Bee),inputValidationWarningBackground:e.getColor(Wee),inputValidationWarningForeground:e.getColor(zee),inputValidationWarningBorder:e.getColor(Vee),inputValidationErrorBackground:e.getColor(Uee),inputValidationErrorForeground:e.getColor(Hee),inputValidationErrorBorder:e.getColor(jee)};this._findInput.style(t),this._replaceInput.style(t),this._toggleSelectionFind.style(t)}_tryUpdateWidgetWidth(){if(!this._isVisible)return;if(!X$(this._domNode))return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0)return void this._domNode.classList.add("hiddenEditor");this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const t=e.width,n=e.minimap.minimapWidth;let i=!1,r=!1,o=!1;if(this._resized){if(yY(this._domNode)>419)return this._domNode.style.maxWidth=t-28-n-15+"px",void(this._replaceInput.width=yY(this._findInput.domNode))}if(447+n>=t&&(r=!0),447+n-mNe>=t&&(o=!0),447+n-mNe>=t+50&&(i=!0),this._domNode.classList.toggle("collapsed-find-widget",i),this._domNode.classList.toggle("narrow-find-widget",o),this._domNode.classList.toggle("reduced-find-widget",r),o||i||(this._domNode.style.maxWidth=t-28-n-15+"px"),this._resized){this._findInput.inputBox.layout();let e=this._findInput.inputBox.element.clientWidth;e>0&&(this._replaceInput.width=e)}else this._isReplaceVisible&&(this._replaceInput.width=yY(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return(null===this._cachedHeight||this._cachedHeight!==e)&&(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){let e=this._codeEditor.getSelections();e.map((e=>{1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1)));const t=this._state.currentMatch;return e.startLineNumber===e.endLineNumber||TK.equalsRange(e,t)?null:e})).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){return e.equals(3|vNe)?(this._findInput.inputBox.insertAtCursor("\n"),void e.preventDefault()):e.equals(2)?(this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?_Ne(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):e.equals(18)?bNe(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):void 0}_onReplaceInputKeyDown(e){return e.equals(3|vNe)?(aj&&uj&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(GH(0,"Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store("ctrlEnterReplaceAll.windows.donotask",!0,0,0)),this._replaceInput.inputBox.insertAtCursor("\n"),void e.preventDefault()):e.equals(2)?(this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(1026)?(this._findInput.focus(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?_Ne(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):e.equals(18)?bNe(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):void 0}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new KDe(null,this._contextViewProvider,{width:221,label:nNe,placeholder:iNe,appendCaseSensitiveLabel:this._keybindingLabelFor(mDe),appendWholeWordsLabel:this._keybindingLabelFor(vDe),appendRegexLabel:this._keybindingLabelFor(yDe),validation:e=>{if(0===e.length||!this._findInput.getRegex())return null;try{return new RegExp(e,"gu"),null}catch(zWe){return{content:zWe.message}}},flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118},this._contextKeyService,!0)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown((e=>this._onFindInputKeyDown(e)))),this._register(this._findInput.inputBox.onDidChange((()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)}))),this._register(this._findInput.onDidOptionChange((()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)}))),this._register(this._findInput.onCaseSensitiveKeyDown((e=>{e.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),e.preventDefault())}))),this._register(this._findInput.onRegexKeyDown((e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),e.preventDefault())}))),this._register(this._findInput.inputBox.onDidHeightChange((e=>{this._tryUpdateHeight()&&this._showViewZone()}))),cj&&this._register(this._findInput.onMouseDown((e=>this._onFindInputMouseDown(e)))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new CNe({label:rNe+this._keybindingLabelFor(hDe),icon:eNe,onTrigger:()=>{this._codeEditor.getAction(hDe).run().then(void 0,nG)}})),this._nextBtn=this._register(new CNe({label:oNe+this._keybindingLabelFor(uDe),icon:tNe,onTrigger:()=>{this._codeEditor.getAction(uDe).run().then(void 0,nG)}}));let e=document.createElement("div");e.className="find-part",e.appendChild(this._findInput.domNode);const t=document.createElement("div");t.className="find-actions",e.appendChild(t),t.appendChild(this._matchesCount),t.appendChild(this._prevBtn.domNode),t.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new kDe({icon:YDe,title:sNe+this._keybindingLabelFor(_De),isChecked:!1})),this._register(this._toggleSelectionFind.onChange((()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let e=this._codeEditor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}else this._state.change({searchScope:null},!0)}))),t.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new CNe({label:aNe+this._keybindingLabelFor(pDe),icon:Dle,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),e.preventDefault())}})),t.appendChild(this._closeBtn.domNode),this._replaceInput=this._register(new qDe(null,void 0,{label:lNe,placeholder:cNe,appendPreserveCaseLabel:this._keybindingLabelFor(bDe),history:[],flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown((e=>this._onReplaceInputKeyDown(e)))),this._register(this._replaceInput.inputBox.onDidChange((()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)}))),this._register(this._replaceInput.inputBox.onDidHeightChange((e=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()}))),this._register(this._replaceInput.onDidOptionChange((()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)}))),this._register(this._replaceInput.onPreserveCaseKeyDown((e=>{e.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),e.preventDefault())}))),this._replaceBtn=this._register(new CNe({label:uNe+this._keybindingLabelFor(wDe),icon:QDe,onTrigger:()=>{this._controller.replace()},onKeyDown:e=>{e.equals(1026)&&(this._closeBtn.focus(),e.preventDefault())}})),this._replaceAllBtn=this._register(new CNe({label:hNe+this._keybindingLabelFor(CDe),icon:JDe,onTrigger:()=>{this._controller.replaceAll()}}));let n=document.createElement("div");n.className="replace-part",n.appendChild(this._replaceInput.domNode);const i=document.createElement("div");i.className="replace-actions",n.appendChild(i),i.appendChild(this._replaceBtn.domNode),i.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new CNe({label:dNe,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=yY(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.style.width="419px",this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(e),this._domNode.appendChild(n),this._resizeSash=new sle(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let r=419;this._register(this._resizeSash.onDidStart((()=>{r=yY(this._domNode)}))),this._register(this._resizeSash.onDidChange((e=>{this._resized=!0;let t=r+e.startX-e.currentX;if(t<419)return;t>(parseFloat(hY(this._domNode).maxWidth)||0)||(this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=yY(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())}))),this._register(this._resizeSash.onDidReset((()=>{const e=yY(this._domNode);if(e<419)return;let t=419;if(!this._resized||419===e){const e=this._codeEditor.getLayoutInfo();t=e.width-28-e.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=yY(this._findInput.domNode)),this._findInput.inputBox.layout()})))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(2!==e)}}wNe.ID="editor.contrib.findWidget";class CNe extends Yre{constructor(e){super(),this._opts=e;let t="button";this._opts.className&&(t=t+" "+this._opts.className),this._opts.icon&&(t=t+" "+z5.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,(e=>{this._opts.onTrigger(),e.preventDefault()})),this.onkeydown(this._domNode,(e=>{if(e.equals(10)||e.equals(3))return this._opts.onTrigger(),void e.preventDefault();this._opts.onKeyDown&&this._opts.onKeyDown(e)}))}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...z5.asClassNameArray(XDe)),this._domNode.classList.add(...z5.asClassNameArray(ZDe))):(this._domNode.classList.remove(...z5.asClassNameArray(ZDe)),this._domNode.classList.add(...z5.asClassNameArray(XDe)))}}G5(((e,t)=>{const n=(e,n)=>{n&&t.addRule(`.monaco-editor ${e} { background-color: ${n}; }`)};n(".findMatch",e.getColor(Rte)),n(".currentFindMatch",e.getColor(Ote)),n(".findScope",e.getColor(Pte));n(".find-widget",e.getColor(mte));const i=e.getColor(Nee);i&&t.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${i}; }`);const r=e.getColor(Bte);r&&t.addRule(`.monaco-editor .findMatch { border: 1px ${"hc"===e.type?"dotted":"solid"} ${r}; box-sizing: border-box; }`);const o=e.getColor(Fte);o&&t.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${o}; padding: 1px; box-sizing: border-box; }`);const s=e.getColor(Wte);s&&t.addRule(`.monaco-editor .findScope { border: 1px ${"hc"===e.type?"dashed":"solid"} ${s}; }`);const a=e.getColor(xee);a&&t.addRule(`.monaco-editor .find-widget { border: 1px solid ${a}; }`);const l=e.getColor(vte);l&&t.addRule(`.monaco-editor .find-widget { color: ${l}; }`);const c=e.getColor(wee);c&&t.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${c}; }`);const u=e.getColor(_te);if(u)t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${u}; }`);else{const n=e.getColor(yte);n&&t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${n}; }`)}const h=e.getColor(See);h&&t.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${h}; }`)}));var SNe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},xNe=function(e,t){return function(n,i){t(n,i,e)}},ENe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function kNe(e,t="single"){if(!e.hasModel())return null;const n=e.getSelection();if("single"===t&&n.startLineNumber===n.endLineNumber||"multiple"===t)if(n.isEmpty()){const t=e.getConfiguredWordAtPosition(n.getStartPosition());if(t)return t.word}else if(e.getModel().getValueLengthInRange(n)<524288)return e.getModel().getValueInRange(n);return null}let LNe=class e extends mG{constructor(e,t,n,i){super(),this._editor=e,this._findWidgetVisible=eDe.bindTo(t),this._contextKeyService=t,this._storageService=n,this._clipboardService=i,this._updateHistoryDelayer=new A$(500),this._state=this._register(new RDe),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._model=null,this._register(this._editor.onDidChangeModel((()=>{let e=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),e&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(33).loop})})))}get editor(){return this._editor}static get(t){return t.getContribution(e.ID)}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,0),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,0),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,0),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,0)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!tDe.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._editor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=rX(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e){return ENe(this,void 0,void 0,(function*(){if(this.disposeModel(),!this._editor.hasModel())return;let t={isRevealed:!0};if("single"===e.seedSearchStringFromSelection){let n=kNe(this._editor,e.seedSearchStringFromSelection);n&&(this._state.isRegex?t.searchString=rX(n):t.searchString=n)}else if("multiple"===e.seedSearchStringFromSelection&&!e.updateSearchScope){let n=kNe(this._editor,e.seedSearchStringFromSelection);n&&(t.searchString=n)}if(!t.searchString&&e.seedSearchStringFromGlobalClipboard){let e=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;e&&(t.searchString=e)}if(e.forceRevealReplace?t.isReplaceRevealed=!0:this._findWidgetVisible.get()||(t.isReplaceRevealed=!1),e.updateSearchScope){let e=this._editor.getSelections();e.some((e=>!e.isEmpty()))&&(t.searchScope=e)}t.loop=e.loop,this._state.change(t,!1),this._model||(this._model=new xDe(this._editor,this._state))}))}start(e){return this._start(e)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){return!!this._model&&(this._model.replaceAll(),!0)}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}getGlobalBufferTerm(){return ENe(this,void 0,void 0,(function*(){return this._editor.getOption(33).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}))}setGlobalBufferTerm(e){this._editor.getOption(33).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};LNe.ID="editor.contrib.findController",LNe=SNe([xNe(1,A5),xNe(2,vpe),xNe(3,Ule)],LNe);let DNe=class extends LNe{constructor(e,t,n,i,r,o,s,a){super(e,n,s,a),this._contextViewService=t,this._keybindingService=i,this._themeService=r,this._notificationService=o,this._widget=null,this._findOptionsWidget=null}_start(e){const t=Object.create(null,{_start:{get:()=>super._start}});return ENe(this,void 0,void 0,(function*(){this._widget||this._createFindWidget();const n=this._editor.getSelection();let i=!1;switch(this._editor.getOption(33).autoFindInSelection){case"always":i=!0;break;case"never":i=!1;break;case"multiline":i=!!n&&n.startLineNumber!==n.endLineNumber}e.updateSearchScope=i,yield t._start.call(this,e),this._widget&&(2===e.shouldFocus?this._widget.focusReplaceInput():1===e.shouldFocus&&this._widget.focusFindInput())}))}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new wNe(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new ADe(this._editor,this._state,this._keybindingService,this._themeService))}};DNe=SNe([xNe(1,Ble),xNe(2,A5),xNe(3,gce),xNe(4,B5),xNe(5,g4),xNe(6,vpe),xNe(7,Ule)],DNe);u6(new s6({id:lDe,label:GH(0,"Find"),alias:"Find",precondition:g5.or(gre.focus,g5.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:Y5.MenubarEditMenu,group:"3_find",title:GH(0,"&&Find"),order:1}})).addImplementation(0,((e,t,n)=>{const i=LNe.get(t);return!!i&&i.start({forceRevealReplace:!1,seedSearchStringFromSelection:t.getOption(33).seedSearchStringFromSelection?"single":"none",seedSearchStringFromGlobalClipboard:t.getOption(33).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop})}));class NNe extends o6{run(e,t){return ENe(this,void 0,void 0,(function*(){let e=LNe.get(t);e&&!this._run(e)&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&t.getOption(33).seedSearchStringFromSelection?"single":"none",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop}),this._run(e))}))}}class INe extends o6{run(e,t){return ENe(this,void 0,void 0,(function*(){let e=LNe.get(t);if(!e)return;let n=kNe(t);n&&e.setSearchString(n),this._run(e)||(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:t.getOption(33).seedSearchStringFromSelection?"single":"none",seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop}),this._run(e))}))}}u6(new s6({id:gDe,label:GH(0,"Replace"),alias:"Replace",precondition:g5.or(gre.focus,g5.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:Y5.MenubarEditMenu,group:"3_find",title:GH(0,"&&Replace"),order:2}})).addImplementation(0,((e,t,n)=>{if(!t.hasModel()||t.getOption(78))return!1;const i=LNe.get(t);if(!i)return!1;const r=t.getSelection(),o=i.isFindInputFocused(),s=!r.isEmpty()&&r.startLineNumber===r.endLineNumber&&t.getOption(33).seedSearchStringFromSelection&&!o,a=o||s?2:1;return i.start({forceRevealReplace:!0,seedSearchStringFromSelection:s?"single":"none",seedSearchStringFromGlobalClipboard:t.getOption(33).seedSearchStringFromSelection,shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop})})),d6(LNe.ID,DNe),c6(class extends o6{constructor(){super({id:cDe,label:GH(0,"Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return ENe(this,void 0,void 0,(function*(){let e=LNe.get(t);e&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(33).loop}),e.setGlobalBufferTerm(e.getState().searchString))}))}}),c6(class extends NNe{constructor(){super({id:uDe,label:GH(0,"Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:gre.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:g5.and(gre.focus,tDe),primary:3,weight:100}]})}_run(e){return!!e.moveToNextMatch()&&(e.editor.pushUndoStop(),!0)}}),c6(class extends NNe{constructor(){super({id:hDe,label:GH(0,"Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:gre.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:g5.and(gre.focus,tDe),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}),c6(class extends INe{constructor(){super({id:dDe,label:GH(0,"Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}),c6(class extends INe{constructor(){super({id:fDe,label:GH(0,"Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}});const TNe=r6.bindToContribution(LNe.get);l6(new TNe({id:pDe,precondition:eDe,handler:e=>e.closeFindWidget(),kbOpts:{weight:105,kbExpr:g5.and(gre.focus,g5.not("isComposing")),primary:9,secondary:[1033]}})),l6(new TNe({id:mDe,precondition:void 0,handler:e=>e.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:gre.focus,primary:iDe.primary,mac:iDe.mac,win:iDe.win,linux:iDe.linux}})),l6(new TNe({id:vDe,precondition:void 0,handler:e=>e.toggleWholeWords(),kbOpts:{weight:105,kbExpr:gre.focus,primary:rDe.primary,mac:rDe.mac,win:rDe.win,linux:rDe.linux}})),l6(new TNe({id:yDe,precondition:void 0,handler:e=>e.toggleRegex(),kbOpts:{weight:105,kbExpr:gre.focus,primary:oDe.primary,mac:oDe.mac,win:oDe.win,linux:oDe.linux}})),l6(new TNe({id:_De,precondition:void 0,handler:e=>e.toggleSearchScope(),kbOpts:{weight:105,kbExpr:gre.focus,primary:sDe.primary,mac:sDe.mac,win:sDe.win,linux:sDe.linux}})),l6(new TNe({id:bDe,precondition:void 0,handler:e=>e.togglePreserveCase(),kbOpts:{weight:105,kbExpr:gre.focus,primary:aDe.primary,mac:aDe.mac,win:aDe.win,linux:aDe.linux}})),l6(new TNe({id:wDe,precondition:eDe,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:gre.focus,primary:3094}})),l6(new TNe({id:wDe,precondition:eDe,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:g5.and(gre.focus,nDe),primary:3}})),l6(new TNe({id:CDe,precondition:eDe,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:gre.focus,primary:2563}})),l6(new TNe({id:CDe,precondition:eDe,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:g5.and(gre.focus,nDe),primary:void 0,mac:{primary:2051}}})),l6(new TNe({id:SDe,precondition:eDe,handler:e=>e.selectAllMatches(),kbOpts:{weight:105,kbExpr:gre.focus,primary:515}}));class MNe{constructor(e,t,n){if(e.length!==t.length||e.length>65535)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new Uint32Array(Math.ceil(e.length/32)),this._types=n,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],t=(t,n)=>{let i=e[e.length-1];return this.getStartLineNumber(i)<=t&&this.getEndLineNumber(i)>=n};for(let n=0,i=this._startIndexes.length;n<i;n++){let i=this._startIndexes[n],r=this._endIndexes[n];if(i>16777215||r>16777215)throw new Error("startLineNumber or endLineNumber must not exceed 16777215");for(;e.length>0&&!t(i,r);)e.pop();let o=e.length>0?e[e.length-1]:-1;e.push(n),this._startIndexes[n]=i+((255&o)<<24),this._endIndexes[n]=r+((65280&o)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return 16777215&this._startIndexes[e]}getEndLineNumber(e){return 16777215&this._endIndexes[e]}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){let t=e/32|0,n=e%32;return 0!=(this._collapseStates[t]&1<<n)}setCollapsed(e,t){let n=e/32|0,i=e%32,r=this._collapseStates[n];this._collapseStates[n]=t?r|1<<i:r&~(1<<i)}toRegion(e){return new ANe(this,e)}getParentIndex(e){this.ensureParentIndices();let t=((4278190080&this._startIndexes[e])>>>24)+((4278190080&this._endIndexes[e])>>>16);return 65535===t?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,n=this._startIndexes.length;if(0===n)return-1;for(;t<n;){let i=Math.floor((t+n)/2);e<this.getStartLineNumber(i)?n=i:t=i+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);-1!==t;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){let e=[];for(let t=0;t<this.length;t++)e[t]=`[${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}}class ANe{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class ONe{constructor(e,t){this._updateEventEmitter=new EG,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new MNe(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[],this._isInitialized=!1}get regions(){return this._regions}get textModel(){return this._textModel}get isInitialized(){return this._isInitialized}toggleCollapseState(e){if(!e.length)return;e=e.sort(((e,t)=>e.regionIndex-t.regionIndex));const t={};this._decorationProvider.changeDecorations((n=>{let i=0,r=-1,o=-1;const s=e=>{for(;i<e;){const e=this._regions.getEndLineNumber(i),t=this._regions.isCollapsed(i);e<=r&&n.changeDecorationOptions(this._editorDecorationIds[i],this._decorationProvider.getDecorationOption(t,e<=o)),t&&e>o&&(o=e),i++}};for(let a of e){let e=a.regionIndex,n=this._editorDecorationIds[e];if(n&&!t[n]){t[n]=!0,s(e);let i=!this._regions.isCollapsed(e);this._regions.setCollapsed(e,i),r=Math.max(r,this._regions.getEndLineNumber(e))}}s(this._regions.length)})),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}update(e,t=[]){let n=[],i=-1,r=(r,o)=>{const s=e.getStartLineNumber(r),a=e.getEndLineNumber(r);o&&((e,n)=>{for(let i of t)if(e<i&&i<=n)return!0;return!1})(s,a)&&(o=!1),e.setCollapsed(r,o);const l=this._textModel.getLineMaxColumn(s),c={startLineNumber:s,startColumn:Math.max(l-1,1),endLineNumber:s,endColumn:l};n.push({range:c,options:this._decorationProvider.getDecorationOption(o,a<=i)}),o&&a>i&&(i=a)},o=0,s=()=>{for(;o<this._regions.length;){let e=this._regions.isCollapsed(o);if(o++,e)return o-1}return-1},a=0,l=s();for(;-1!==l&&a<e.length;){let t=this._textModel.getDecorationRange(this._editorDecorationIds[l]);if(t){let n=t.startLineNumber;if(t.startColumn===Math.max(t.endColumn-1,1)&&this._textModel.getLineMaxColumn(n)===t.endColumn)for(;a<e.length;){let t=e.getStartLineNumber(a);if(!(n>=t))break;r(a,n===t),a++}}l=s()}for(;a<e.length;)r(a,!1),a++;this._editorDecorationIds=this._decorationProvider.deltaDecorations(this._editorDecorationIds,n),this._regions=e,this._isInitialized=!0,this._updateEventEmitter.fire({model:this})}getMemento(){let e=[];for(let t=0;t<this._regions.length;t++)if(this._regions.isCollapsed(t)){let n=this._textModel.getDecorationRange(this._editorDecorationIds[t]);if(n){let i=n.startLineNumber,r=n.endLineNumber+this._regions.getEndLineNumber(t)-this._regions.getStartLineNumber(t);e.push({startLineNumber:i,endLineNumber:r})}}if(e.length>0)return e}applyMemento(e){if(!Array.isArray(e))return;let t=[];for(let n of e){let e=this.getRegionAtLine(n.startLineNumber);e&&!e.isCollapsed&&t.push(e)}this.toggleCollapseState(t)}dispose(){this._decorationProvider.deltaDecorations(this._editorDecorationIds,[])}getAllRegionsAtLine(e,t){let n=[];if(this._regions){let i=this._regions.findRange(e),r=1;for(;i>=0;){let e=this._regions.toRegion(i);t&&!t(e,r)||n.push(e),r++,i=e.parentIndex}}return n}getRegionAtLine(e){if(this._regions){let t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){let n=[],i=e?e.regionIndex+1:0,r=e?e.endLineNumber:Number.MAX_VALUE;if(t&&2===t.length){const e=[];for(let o=i,s=this._regions.length;o<s;o++){let i=this._regions.toRegion(o);if(!(this._regions.getStartLineNumber(o)<r))break;for(;e.length>0&&!i.containedBy(e[e.length-1]);)e.pop();e.push(i),t(i,e.length)&&n.push(i)}}else for(let o=i,s=this._regions.length;o<s;o++){let e=this._regions.toRegion(o);if(!(this._regions.getStartLineNumber(o)<r))break;t&&!t(e)||n.push(e)}return n}}function RNe(e,t,n=Number.MAX_VALUE,i){let r=[];if(i&&i.length>0)for(let o of i){let i=e.getRegionAtLine(o);if(i&&(i.isCollapsed!==t&&r.push(i),n>1)){let o=e.getRegionsInside(i,((e,i)=>e.isCollapsed!==t&&i<n));r.push(...o)}}else{let i=e.getRegionsInside(null,((e,i)=>e.isCollapsed!==t&&i<n));r.push(...i)}e.toggleCollapseState(r)}function PNe(e,t,n,i){let r=[];for(let o of i){let i=e.getAllRegionsAtLine(o,((e,i)=>e.isCollapsed!==t&&i<=n));r.push(...i)}e.toggleCollapseState(r)}function FNe(e,t,n){let i=[];for(let o of n)i.push(e.getAllRegionsAtLine(o,void 0)[0]);let r=e.getRegionsInside(null,(e=>i.every((t=>!t.containedBy(e)&&!e.containedBy(t)))&&e.isCollapsed!==t));e.toggleCollapseState(r)}function BNe(e,t,n){let i=e.textModel,r=e.regions,o=[];for(let s=r.length-1;s>=0;s--)if(n!==r.isCollapsed(s)){let e=r.getStartLineNumber(s);t.test(i.getLineContent(e))&&o.push(r.toRegion(s))}e.toggleCollapseState(o)}function WNe(e,t,n){let i=e.regions,r=[];for(let o=i.length-1;o>=0;o--)n!==i.isCollapsed(o)&&t===i.getType(o)&&r.push(i.toRegion(o));e.toggleCollapseState(r)}const zNe=Ele("folding-expanded",hJ.chevronDown,GH(0,"Icon for expanded ranges in the editor glyph margin.")),VNe=Ele("folding-collapsed",hJ.chevronRight,GH(0,"Icon for collapsed ranges in the editor glyph margin."));class UNe{constructor(e){this.editor=e,this.autoHideFoldingControls=!0,this.showFoldingHighlights=!0}getDecorationOption(e,t){return t?UNe.HIDDEN_RANGE_DECORATION:e?this.showFoldingHighlights?UNe.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:UNe.COLLAPSED_VISUAL_DECORATION:this.autoHideFoldingControls?UNe.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:UNe.EXPANDED_VISUAL_DECORATION}deltaDecorations(e,t){return this.editor.deltaDecorations(e,t)}changeDecorations(e){return this.editor.changeDecorations(e)}}UNe.COLLAPSED_VISUAL_DECORATION=v7.register({description:"folding-collapsed-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:z5.asClassName(VNe)}),UNe.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=v7.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",className:"folded-background",isWholeLine:!0,firstLineDecorationClassName:z5.asClassName(VNe)}),UNe.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=v7.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:z5.asClassName(zNe)}),UNe.EXPANDED_VISUAL_DECORATION=v7.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+z5.asClassName(zNe)}),UNe.HIDDEN_RANGE_DECORATION=v7.register({description:"folding-hidden-range-decoration",stickiness:1});class HNe{constructor(e){this._updateEventEmitter=new EG,this._foldingModel=e,this._foldingModelListener=e.onDidChange((e=>this.updateHiddenRanges())),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}updateHiddenRanges(){let e=!1,t=[],n=0,i=0,r=Number.MAX_VALUE,o=-1,s=this._foldingModel.regions;for(;n<s.length;n++){if(!s.isCollapsed(n))continue;let a=s.getStartLineNumber(n)+1,l=s.getEndLineNumber(n);r<=a&&l<=o||(!e&&i<this._hiddenRanges.length&&this._hiddenRanges[i].startLineNumber===a&&this._hiddenRanges[i].endLineNumber===l?(t.push(this._hiddenRanges[i]),i++):(e=!0,t.push(new TK(a,1,l,1))),r=a,o=l)}(e||i<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyMemento(e){if(!Array.isArray(e)||0===e.length)return!1;let t=[];for(let n of e){if(!n.startLineNumber||!n.endLineNumber)return!1;t.push(new TK(n.startLineNumber+1,1,n.endLineNumber,1))}return this.applyHiddenRanges(t),!0}getMemento(){return this._hiddenRanges.map((e=>({startLineNumber:e.startLineNumber-1,endLineNumber:e.endLineNumber})))}applyHiddenRanges(e){this._hiddenRanges=e,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return null!==jNe(this._hiddenRanges,e)}adjustSelections(e){let t=!1,n=this._foldingModel.textModel,i=null,r=e=>(i&&function(e,t){return e>=t.startLineNumber&&e<=t.endLineNumber}(e,i)||(i=jNe(this._hiddenRanges,e)),i?i.startLineNumber-1:null);for(let o=0,s=e.length;o<s;o++){let i=e[o],s=r(i.startLineNumber);s&&(i=i.setStartPosition(s,n.getLineMaxColumn(s)),t=!0);let a=r(i.endLineNumber);a&&(i=i.setEndPosition(a,n.getLineMaxColumn(a)),t=!0),e[o]=i}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function jNe(e,t){let n=I1(e,(e=>t<e.startLineNumber))-1;return n>=0&&e[n].endLineNumber>=t?e[n]:null}class GNe{constructor(e){this.editorModel=e,this.id="indent"}dispose(){}compute(e){let t=q0.getFoldingRules(this.editorModel.getLanguageIdentifier().id),n=t&&!!t.offSide,i=t&&t.markers;return Promise.resolve(function(e,t,n,i=5e3){const r=e.getOptions().tabSize;let o,s=new KNe(i);n&&(o=new RegExp(`(${n.start.source})|(?:${n.end.source})`));let a=[],l=e.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let c=e.getLineCount();c>0;c--){let n,i=e.getLineContent(c),l=l7.computeIndentLevel(i,r),u=a[a.length-1];if(-1!==l){if(o&&(n=i.match(o))){if(!n[1]){a.push({indent:-2,endAbove:c,line:c});continue}{let e=a.length-1;for(;e>0&&-2!==a[e].indent;)e--;if(e>0){a.length=e+1,u=a[e],s.insertFirst(c,u.line,l),u.line=c,u.indent=l,u.endAbove=c;continue}}}if(u.indent>l){do{a.pop(),u=a[a.length-1]}while(u.indent>l);let e=u.endAbove-1;e-c>=1&&s.insertFirst(c,e,l)}u.indent===l?u.endAbove=c:a.push({indent:l,endAbove:c,line:c})}else t&&(u.endAbove=c)}return s.toIndentRanges(e)}(this.editorModel,n,i))}}class KNe{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,n){if(e>16777215||t>16777215)return;let i=this._length;this._startIndexes[i]=e,this._endIndexes[i]=t,this._length++,n<1e3&&(this._indentOccurrences[n]=(this._indentOccurrences[n]||0)+1)}toIndentRanges(e){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let n=this._length-1,i=0;n>=0;n--,i++)e[i]=this._startIndexes[n],t[i]=this._endIndexes[n];return new MNe(e,t)}{let t=0,n=this._indentOccurrences.length;for(let e=0;e<this._indentOccurrences.length;e++){let i=this._indentOccurrences[e];if(i){if(i+t>this._foldingRangesLimit){n=e;break}t+=i}}const i=e.getOptions().tabSize;let r=new Uint32Array(this._foldingRangesLimit),o=new Uint32Array(this._foldingRangesLimit);for(let s=this._length-1,a=0;s>=0;s--){let l=this._startIndexes[s],c=e.getLineContent(l),u=l7.computeIndentLevel(c,i);(u<n||u===n&&t++<this._foldingRangesLimit)&&(r[a]=l,o[a]=this._endIndexes[s],a++)}return new MNe(r,o)}}}const qNe={};class $Ne{constructor(e,t,n,i=5e3){this.editorModel=e,this.providers=t,this.limit=i,this.id="syntax";for(const r of t)"function"==typeof r.onDidChange&&(this.disposables||(this.disposables=new pG),this.disposables.add(r.onDidChange(n)))}compute(e){return function(e,t,n){let i=null,r=e.map(((e,r)=>Promise.resolve(e.provideFoldingRanges(t,qNe,n)).then((e=>{if(!n.isCancellationRequested&&Array.isArray(e)){Array.isArray(i)||(i=[]);let n=t.getLineCount();for(let t of e)t.start>0&&t.end>t.start&&t.end<=n&&i.push({start:t.start,end:t.end,rank:r,kind:t.kind})}}),iG)));return Promise.all(r).then((e=>i))}(this.providers,this.editorModel,e).then((e=>{if(e){return XNe(e,this.limit)}return null}))}dispose(){var e;null===(e=this.disposables)||void 0===e||e.dispose()}}class YNe{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,n,i){if(e>16777215||t>16777215)return;let r=this._length;this._startIndexes[r]=e,this._endIndexes[r]=t,this._nestingLevels[r]=i,this._types[r]=n,this._length++,i<30&&(this._nestingLevelCounts[i]=(this._nestingLevelCounts[i]||0)+1)}toIndentRanges(){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let n=0;n<this._length;n++)e[n]=this._startIndexes[n],t[n]=this._endIndexes[n];return new MNe(e,t,this._types)}{let e=0,t=this._nestingLevelCounts.length;for(let o=0;o<this._nestingLevelCounts.length;o++){let n=this._nestingLevelCounts[o];if(n){if(n+e>this._foldingRangesLimit){t=o;break}e+=n}}let n=new Uint32Array(this._foldingRangesLimit),i=new Uint32Array(this._foldingRangesLimit),r=[];for(let o=0,s=0;o<this._length;o++){let a=this._nestingLevels[o];(a<t||a===t&&e++<this._foldingRangesLimit)&&(n[s]=this._startIndexes[o],i[s]=this._endIndexes[o],r[s]=this._types[o],s++)}return new MNe(n,i,r)}}}function XNe(e,t){let n,i=e.sort(((e,t)=>{let n=e.start-t.start;return 0===n&&(n=e.rank-t.rank),n})),r=new YNe(t),o=[];for(let s of i)if(n){if(s.start>n.start)if(s.end<=n.end)o.push(n),n=s,r.add(s.start,s.end,s.kind&&s.kind.value,o.length);else{if(s.start>n.end){do{n=o.pop()}while(n&&s.start>n.end);n&&o.push(n),n=s}r.add(s.start,s.end,s.kind&&s.kind.value,o.length)}}else n=s,r.add(s.start,s.end,s.kind&&s.kind.value,o.length);return r.toIndentRanges()}class ZNe{constructor(e,t,n,i){if(this.editorModel=e,this.id="init",t.length){let r=t=>({range:{startLineNumber:t.startLineNumber,startColumn:0,endLineNumber:t.endLineNumber,endColumn:e.getLineLength(t.endLineNumber)},options:{description:"folding-initializing-range-provider",stickiness:1}});this.decorationIds=e.deltaDecorations([],t.map(r)),this.timeout=setTimeout(n,i)}}dispose(){this.decorationIds&&(this.editorModel.deltaDecorations(this.decorationIds,[]),this.decorationIds=void 0),"number"==typeof this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}compute(e){let t=[];if(this.decorationIds)for(let n of this.decorationIds){let e=this.editorModel.getDecorationRange(n);e&&t.push({start:e.startLineNumber,end:e.endLineNumber,rank:1})}return Promise.resolve(XNe(t,Number.MAX_VALUE))}}const QNe=new M5("foldingEnabled",!1);let JNe=class e extends mG{constructor(e,t){super(),this.contextKeyService=t,this.localToDispose=this._register(new pG),this.editor=e;const n=this.editor.getOptions();this._isEnabled=n.get(35),this._useFoldingProviders="indentation"!==n.get(36),this._unfoldOnClickAfterEndOfLine=n.get(38),this._restoringViewState=!1,this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingStateMemento=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new UNe(e),this.foldingDecorationProvider.autoHideFoldingControls="mouseover"===n.get(97),this.foldingDecorationProvider.showFoldingHighlights=n.get(37),this.foldingEnabled=QNe.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel((()=>this.onModelChanged()))),this._register(this.editor.onDidChangeConfiguration((e=>{if(e.hasChanged(35)&&(this._isEnabled=this.editor.getOptions().get(35),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),e.hasChanged(97)||e.hasChanged(37)){const e=this.editor.getOptions();this.foldingDecorationProvider.autoHideFoldingControls="mouseover"===e.get(97),this.foldingDecorationProvider.showFoldingHighlights=e.get(37),this.onModelContentChanged()}e.hasChanged(36)&&(this._useFoldingProviders="indentation"!==this.editor.getOptions().get(36),this.onFoldingStrategyChanged()),e.hasChanged(38)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(38))}))),this.onModelChanged()}static get(t){return t.getContribution(e.ID)}saveViewState(){let e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){let t=this.foldingModel.isInitialized?this.foldingModel.getMemento():this.hiddenRangeModel.getMemento(),n=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:n}}}restoreViewState(e){let t=this.editor.getModel();if(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)return;if(!e||!e.collapsedRegions||e.lineCount!==t.getLineCount())return;"syntax"!==e.provider&&"init"!==e.provider||(this.foldingStateMemento=e);const n=e.collapsedRegions;if(this.hiddenRangeModel.applyMemento(n)){const e=this.getFoldingModel();e&&e.then((e=>{if(e){this._restoringViewState=!0;try{e.applyMemento(n)}finally{this._restoringViewState=!1}}})).then(void 0,nG)}}onModelChanged(){this.localToDispose.clear();let e=this.editor.getModel();this._isEnabled&&e&&!e.isTooLargeForTokenization()&&(this.foldingModel=new ONe(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new HNe(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange((e=>this.onHiddenRangesChanges(e)))),this.updateScheduler=new A$(200),this.cursorChangedScheduler=new z$((()=>this.revealCursor()),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(KJ.onDidChange((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelContent((()=>this.onModelContentChanged()))),this.localToDispose.add(this.editor.onDidChangeCursorPosition((()=>this.onCursorPositionChanged()))),this.localToDispose.add(this.editor.onMouseDown((e=>this.onEditorMouseDown(e)))),this.localToDispose.add(this.editor.onMouseUp((e=>this.onEditorMouseUp(e)))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.updateScheduler&&this.updateScheduler.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.foldingStateMemento=null,this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null}}),this.onModelContentChanged())}onFoldingStrategyChanged(){this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null,this.onModelContentChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;if(this.rangeProvider=new GNe(e),this._useFoldingProviders&&this.foldingModel){let t=KJ.ordered(this.foldingModel.textModel);if(0===t.length&&this.foldingStateMemento&&this.foldingStateMemento.collapsedRegions){return this.rangeProvider=new ZNe(e,this.foldingStateMemento.collapsedRegions,(()=>{this.foldingStateMemento=null,this.onFoldingStrategyChanged()}),3e4)}t.length>0&&(this.rangeProvider=new $Ne(e,t,(()=>this.onModelContentChanged())))}return this.foldingStateMemento=null,this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onModelContentChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger((()=>{const e=this.foldingModel;if(!e)return null;let t=this.foldingRegionPromise=I$((t=>this.getRangeProvider(e.textModel).compute(t)));return t.then((n=>{if(n&&t===this.foldingRegionPromise){let t=this.editor.getSelections(),i=t?t.map((e=>e.startLineNumber)):[];e.update(n,i)}return e}))})).then(void 0,(e=>(nG(e),null))))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){let e=this.editor.getSelections();e&&this.hiddenRangeModel.adjustSelections(e)&&this.editor.setSelections(e)}this.editor.setHiddenAreas(e)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then((e=>{if(e){let t=this.editor.getSelections();if(t&&t.length>0){let n=[];for(let i of t){let t=i.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(t)&&n.push(...e.getAllRegionsAtLine(t,(e=>e.isCollapsed&&t>e.startLineNumber)))}n.length&&(e.toggleCollapseState(n),this.reveal(t[0].getPosition()))}}})).then(void 0,nG)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range)return;if(!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let n=!1;switch(e.target.type){case 4:const i=e.target.detail,r=e.target.element.offsetLeft;if(i.offsetX-r<5)return;n=!0;break;case 7:if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()){if(!e.target.detail.isAfterLines)break}return;case 6:if(this.hiddenRangeModel.hasRanges()){let e=this.editor.getModel();if(e&&t.startColumn===e.getLineMaxColumn(t.startLineNumber))break}return;default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:n}}onEditorMouseUp(e){const t=this.getFoldingModel();if(!t||!this.mouseDownInfo||!e.target)return;let n=this.mouseDownInfo.lineNumber,i=this.mouseDownInfo.iconClicked,r=e.target.range;if(r&&r.startLineNumber===n){if(i){if(4!==e.target.type)return}else{let e=this.editor.getModel();if(!e||r.startColumn!==e.getLineMaxColumn(n))return}t.then((t=>{if(t){let r=t.getRegionAtLine(n);if(r&&r.startLineNumber===n){let o=r.isCollapsed;if(i||o){let i=[];if(e.event.altKey){let e=e=>!e.containedBy(r)&&!r.containedBy(e),n=t.getRegionsInside(null,e);for(const t of n)t.isCollapsed&&i.push(t);0===i.length&&(i=n)}else{let n=e.event.middleButton||e.event.shiftKey;if(n)for(const e of t.getRegionsInside(r))e.isCollapsed===o&&i.push(e);!o&&n&&0!==i.length||i.push(r)}t.toggleCollapseState(i),this.reveal({lineNumber:n,column:1})}}}})).then(void 0,nG)}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};JNe.ID="editor.contrib.folding",JNe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,A5)],JNe);class eIe extends o6{runEditorCommand(e,t,n){let i=JNe.get(t);if(!i)return;let r=i.getFoldingModel();return r?(this.reportTelemetry(e,t),r.then((e=>{if(e){this.invoke(i,e,t,n);const r=t.getSelection();r&&i.reveal(r.getStartPosition())}}))):void 0}getSelectedLines(e){let t=e.getSelections();return t?t.map((e=>e.startLineNumber)):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map((e=>e+1)):this.getSelectedLines(t)}run(e,t){}}function tIe(e){if(!FZ(e)){if(!OZ(e))return!1;const t=e;if(!FZ(t.levels)&&!RZ(t.levels))return!1;if(!FZ(t.direction)&&!AZ(t.direction))return!1;if(!(FZ(t.selectionLines)||MZ(t.selectionLines)&&t.selectionLines.every(RZ)))return!1}return!0}class nIe extends eIe{getFoldingLevel(){return parseInt(this.id.substr(nIe.ID_PREFIX.length))}invoke(e,t,n){!function(e,t,n,i){let r=e.getRegionsInside(null,((e,r)=>r===t&&e.isCollapsed!==n&&!i.some((t=>e.containsLine(t)))));e.toggleCollapseState(r)}(t,this.getFoldingLevel(),!0,this.getSelectedLines(n))}}nIe.ID_PREFIX="editor.foldLevel",nIe.ID=e=>nIe.ID_PREFIX+e,d6(JNe.ID,JNe),c6(class extends eIe{constructor(){super({id:"editor.unfold",label:GH(0,"Unfold"),alias:"Unfold",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:3161,mac:{primary:2649},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t",constraint:tIe,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,n,i){let r=i&&i.levels||1,o=this.getLineNumbers(i,n);i&&"up"===i.direction?PNe(t,!1,r,o):RNe(t,!1,r,o)}}),c6(class extends eIe{constructor(){super({id:"editor.unfoldRecursively",label:GH(0,"Unfold Recursively"),alias:"Unfold Recursively",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2137),weight:100}})}invoke(e,t,n,i){RNe(t,!1,Number.MAX_VALUE,this.getSelectedLines(n))}}),c6(class extends eIe{constructor(){super({id:"editor.fold",label:GH(0,"Fold"),alias:"Fold",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:3159,mac:{primary:2647},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t",constraint:tIe,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,n,i){let r=this.getLineNumbers(i,n);const o=i&&i.levels,s=i&&i.direction;"number"!=typeof o&&"string"!=typeof s?function(e,t,n){let i=[];for(let r of n){let n=e.getAllRegionsAtLine(r,(e=>e.isCollapsed!==t));n.length>0&&i.push(n[0])}e.toggleCollapseState(i)}(t,!0,r):"up"===s?PNe(t,!0,o||1,r):RNe(t,!0,o||1,r)}}),c6(class extends eIe{constructor(){super({id:"editor.foldRecursively",label:GH(0,"Fold Recursively"),alias:"Fold Recursively",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2135),weight:100}})}invoke(e,t,n){let i=this.getSelectedLines(n);RNe(t,!0,Number.MAX_VALUE,i)}}),c6(class extends eIe{constructor(){super({id:"editor.foldAll",label:GH(0,"Fold All"),alias:"Fold All",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2069),weight:100}})}invoke(e,t,n){RNe(t,!0)}}),c6(class extends eIe{constructor(){super({id:"editor.unfoldAll",label:GH(0,"Unfold All"),alias:"Unfold All",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2088),weight:100}})}invoke(e,t,n){RNe(t,!1)}}),c6(class extends eIe{constructor(){super({id:"editor.foldAllBlockComments",label:GH(0,"Fold All Block Comments"),alias:"Fold All Block Comments",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2133),weight:100}})}invoke(e,t,n){if(t.regions.hasTypes())WNe(t,SJ.Comment.value,!0);else{const e=n.getModel();if(!e)return;let i=q0.getComments(e.getLanguageIdentifier().id);if(i&&i.blockCommentStartToken){BNe(t,new RegExp("^\\s*"+rX(i.blockCommentStartToken)),!0)}}}}),c6(class extends eIe{constructor(){super({id:"editor.foldAllMarkerRegions",label:GH(0,"Fold All Regions"),alias:"Fold All Regions",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2077),weight:100}})}invoke(e,t,n){if(t.regions.hasTypes())WNe(t,SJ.Region.value,!0);else{const e=n.getModel();if(!e)return;let i=q0.getFoldingRules(e.getLanguageIdentifier().id);if(i&&i.markers&&i.markers.start){BNe(t,new RegExp(i.markers.start),!0)}}}}),c6(class extends eIe{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:GH(0,"Unfold All Regions"),alias:"Unfold All Regions",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2078),weight:100}})}invoke(e,t,n){if(t.regions.hasTypes())WNe(t,SJ.Region.value,!1);else{const e=n.getModel();if(!e)return;let i=q0.getFoldingRules(e.getLanguageIdentifier().id);if(i&&i.markers&&i.markers.start){BNe(t,new RegExp(i.markers.start),!1)}}}}),c6(class extends eIe{constructor(){super({id:"editor.foldAllExcept",label:GH(0,"Fold All Regions Except Selected"),alias:"Fold All Regions Except Selected",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2131),weight:100}})}invoke(e,t,n){FNe(t,!0,this.getSelectedLines(n))}}),c6(class extends eIe{constructor(){super({id:"editor.unfoldAllExcept",label:GH(0,"Unfold All Regions Except Selected"),alias:"Unfold All Regions Except Selected",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2129),weight:100}})}invoke(e,t,n){FNe(t,!1,this.getSelectedLines(n))}}),c6(class extends eIe{constructor(){super({id:"editor.toggleFold",label:GH(0,"Toggle Fold"),alias:"Toggle Fold",precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2090),weight:100}})}invoke(e,t,n){!function(e,t,n){let i=[];for(let r of n){let n=e.getRegionAtLine(r);if(n){const r=!n.isCollapsed;if(i.push(n),t>1){let o=e.getRegionsInside(n,((e,n)=>e.isCollapsed!==r&&n<t));i.push(...o)}}}e.toggleCollapseState(i)}(t,1,this.getSelectedLines(n))}});for(let VWe=1;VWe<=7;VWe++)h6(new nIe({id:nIe.ID(VWe),label:GH(0,"Fold Level {0}",VWe),alias:`Fold Level ${VWe}`,precondition:QNe,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2048|21+VWe),weight:100}}));const iIe=_ee("editor.foldBackground",{light:nie(Nte,.3),dark:nie(Nte,.3),hc:null},GH(0,"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0),rIe=_ee("editorGutter.foldingControlForeground",{dark:Cee,light:Cee,hc:Cee},GH(0,"Color of the folding control in the editor gutter."));G5(((e,t)=>{const n=e.getColor(iIe);n&&t.addRule(`.monaco-editor .folded-background { background-color: ${n}; }`);const i=e.getColor(rIe);i&&t.addRule(`\n\t\t.monaco-editor .cldr${z5.asCSSSelector(zNe)},\n\t\t.monaco-editor .cldr${z5.asCSSSelector(VNe)} {\n\t\t\tcolor: ${i} !important;\n\t\t}\n\t\t`)}));c6(class extends o6{constructor(){super({id:"editor.action.fontZoomIn",label:GH(0,"Editor Font Zoom In"),alias:"Editor Font Zoom In",precondition:void 0})}run(e,t){mQ.setZoomLevel(mQ.getZoomLevel()+1)}}),c6(class extends o6{constructor(){super({id:"editor.action.fontZoomOut",label:GH(0,"Editor Font Zoom Out"),alias:"Editor Font Zoom Out",precondition:void 0})}run(e,t){mQ.setZoomLevel(mQ.getZoomLevel()-1)}}),c6(class extends o6{constructor(){super({id:"editor.action.fontZoomReset",label:GH(0,"Editor Font Zoom Reset"),alias:"Editor Font Zoom Reset",precondition:void 0})}run(e,t){mQ.setZoomLevel(0)}});var oIe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},sIe=function(e,t){return function(n,i){t(n,i,e)}},aIe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let lIe=class{constructor(e,t){this._workerService=t,this._callOnDispose=new pG,this._callOnModel=new pG,this._editor=e,this._callOnDispose.add(e.onDidChangeConfiguration((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModel((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModelLanguage((()=>this._update()))),this._callOnDispose.add(UJ.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){if(this._callOnModel.clear(),!this._editor.getOption(45))return;if(!this._editor.hasModel())return;const e=this._editor.getModel(),[t]=UJ.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;let n=new p1;for(let i of t.autoFormatTriggerCharacters)n.add(i.charCodeAt(0));this._callOnModel.add(this._editor.onDidType((e=>{let t=e.charCodeAt(e.length-1);n.has(t)&&this._trigger(String.fromCharCode(t))})))}_trigger(e){if(!this._editor.hasModel())return;if(this._editor.getSelections().length>1)return;const t=this._editor.getModel(),n=this._editor.getPosition();let i=!1;const r=this._editor.onDidChangeModelContent((e=>{if(e.isFlush)return i=!0,void r.dispose();for(let t=0,o=e.changes.length;t<o;t++){if(e.changes[t].range.endLineNumber<=n.lineNumber)return i=!0,void r.dispose()}}));Wye(this._workerService,t,n,e,t.getFormattingOptions()).then((e=>{r.dispose(),i||R1(e)&&(Dye.execute(this._editor,e,!0),Mye(e))}),(e=>{throw r.dispose(),e}))}};lIe.ID="editor.contrib.autoFormat",lIe=oIe([sIe(1,e0)],lIe);let cIe=class{constructor(e,t){this.editor=e,this._instantiationService=t,this._callOnDispose=new pG,this._callOnModel=new pG,this._callOnDispose.add(e.onDidChangeConfiguration((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModel((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModelLanguage((()=>this._update()))),this._callOnDispose.add(VJ.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(44)&&this.editor.hasModel()&&VJ.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste((({range:e})=>this._trigger(e))))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(Rye,this.editor,e,2,Hle.None,TG.None).catch(nG))}};cIe.ID="editor.contrib.formatOnPaste",cIe=oIe([sIe(1,t$)],cIe);d6(lIe.ID,lIe),d6(cIe.ID,cIe),c6(class extends o6{constructor(){super({id:"editor.action.formatDocument",label:GH(0,"Format Document"),alias:"Format Document",precondition:g5.and(gre.notInCompositeEditor,gre.writable,gre.hasDocumentFormattingProvider),kbOpts:{kbExpr:gre.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}run(e,t){return aIe(this,void 0,void 0,(function*(){if(t.hasModel()){const n=e.get(t$),i=e.get(jle);yield i.showWhile(n.invokeFunction(Fye,t,1,Hle.None,TG.None),250)}}))}}),c6(class extends o6{constructor(){super({id:"editor.action.formatSelection",label:GH(0,"Format Selection"),alias:"Format Selection",precondition:g5.and(gre.writable,gre.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2084),weight:100},contextMenuOpts:{when:gre.hasNonEmptySelection,group:"1_modification",order:1.31}})}run(e,t){return aIe(this,void 0,void 0,(function*(){if(!t.hasModel())return;const n=e.get(t$),i=t.getModel(),r=t.getSelections().map((e=>e.isEmpty()?new TK(e.startLineNumber,1,e.startLineNumber,i.getLineMaxColumn(e.startLineNumber)):e)),o=e.get(jle);yield o.showWhile(n.invokeFunction(Rye,t,r,1,Hle.None,TG.None),250)}))}}),qZ.registerCommand("editor.action.format",(e=>aIe(void 0,void 0,void 0,(function*(){const t=e.get(o$).getFocusedCodeEditor();if(!t||!t.hasModel())return;const n=e.get(KZ);t.getSelection().isEmpty()?yield n.executeCommand("editor.action.formatDocument"):yield n.executeCommand("editor.action.formatSelection")}))));class uIe{remove(){this.parent&&this.parent.children.delete(this.id)}static findId(e,t){let n;"string"==typeof e?n=`${t.id}/${e}`:(n=`${t.id}/${e.name}`,void 0!==t.children.get(n)&&(n=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let i=n;for(let r=0;void 0!==t.children.get(i);r++)i=`${n}_${r}`;return i}static empty(e){return 0===e.children.size}}class hIe extends uIe{constructor(e,t,n){super(),this.id=e,this.parent=t,this.symbol=n,this.children=new Map}}class dIe extends uIe{constructor(e,t,n,i){super(),this.id=e,this.parent=t,this.label=n,this.order=i,this.children=new Map}}class fIe extends uIe{constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}static create(e,t){let n=this._keys.for(e,!0),i=fIe._requests.get(n);if(!i){let t=new OG;i={promiseCnt:0,source:t,promise:fIe._create(e,t.token),model:void 0},fIe._requests.set(n,i);const r=Date.now();i.promise.then((()=>{this._requestDurations.update(e,Date.now()-r)}))}return i.model?Promise.resolve(i.model):(i.promiseCnt+=1,t.onCancellationRequested((()=>{0==--i.promiseCnt&&(i.source.cancel(),fIe._requests.delete(n))})),new Promise(((e,t)=>{i.promise.then((t=>{i.model=t,e(t)}),(e=>{fIe._requests.delete(n),t(e)}))})))}static _create(e,t){const n=new OG(t),i=new fIe(e.uri),r=IJ.ordered(e),o=r.map(((t,r)=>{var o;let s=uIe.findId(`provider_${r}`,i),a=new dIe(s,i,null!==(o=t.displayName)&&void 0!==o?o:"Unknown Outline Provider",r);return Promise.resolve(t.provideDocumentSymbols(e,n.token)).then((e=>{for(const t of e||[])fIe._makeOutlineElement(t,a);return a}),(e=>(iG(e),a))).then((e=>{uIe.empty(e)?e.remove():i._groups.set(s,e)}))})),s=IJ.onDidChange((()=>{D1(IJ.ordered(e),r)||n.cancel()}));return Promise.all(o).then((()=>n.token.isCancellationRequested&&!t.isCancellationRequested?fIe._create(e,t):i._compact())).finally((()=>{s.dispose()}))}static _makeOutlineElement(e,t){let n=uIe.findId(e,t),i=new hIe(n,t,e);if(e.children)for(const r of e.children)fIe._makeOutlineElement(r,i);t.children.set(i.id,i)}_compact(){let e=0;for(const[t,n]of this._groups)0===n.children.size?this._groups.delete(t):e+=1;if(1!==e)this.children=this._groups;else{let e=lG.first(this._groups.values());for(let[,t]of e.children)t.parent=this,this.children.set(t.id,t)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof hIe?e.push(t.symbol):e.push(...lG.map(t.children.values(),(e=>e.symbol)));return e.sort(((e,t)=>TK.compareRangesUsingStarts(e.range,t.range)))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return fIe._flattenDocumentSymbols(t,e,""),t.sort(((e,t)=>TK.compareRangesUsingStarts(e.range,t.range)))}static _flattenDocumentSymbols(e,t,n){for(const i of t)e.push({kind:i.kind,tags:i.tags,name:i.name,detail:i.detail,containerName:i.containerName||n,range:i.range,selectionRange:i.selectionRange,children:void 0}),i.children&&fIe._flattenDocumentSymbols(e,i.children,i.name)}}fIe._requestDurations=new aJ(IJ,350),fIe._requests=new sZ(9,.75),fIe._keys=new class{constructor(){this._counter=1,this._data=new WeakMap}for(e,t){return`${e.id}/${t?e.getVersionId():""}/${this._hash(IJ.all(e))}`}_hash(e){let t="";for(const n of e){let e=this._data.get(n);void 0===e&&(e=this._counter++,this._data.set(n,e)),t+=e}return t}};var gIe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function pIe(e,t,n){return gIe(this,void 0,void 0,(function*(){const i=yield fIe.create(e,n);return t?i.asListOfDocumentSymbols():i.getTopLevelSymbols()}))}function mIe(e,t){let n=0;for(let i=0;i<e.length;i++)"\t"===e.charAt(i)?n+=t:n++;return n}function vIe(e,t,n){e=e<0?0:e;let i="";if(!n){let n=Math.floor(e/t);e%=t;for(let e=0;e<n;e++)i+="\t"}for(let r=0;r<e;r++)i+=" ";return i}function yIe(e,t,n,i){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return[];let r=q0.getIndentationRules(e.getLanguageIdentifier().id);if(!r)return[];for(n=Math.min(n,e.getLineCount());t<=n&&r.unIndentedLinePattern;){let n=e.getLineContent(t);if(!r.unIndentedLinePattern.test(n))break;t++}if(t>n-1)return[];const{tabSize:o,indentSize:s,insertSpaces:a}=e.getOptions(),l=(e,t)=>(t=t||1,sre.shiftIndent(e,e.length+t,o,s,a)),c=(e,t)=>(t=t||1,sre.unshiftIndent(e,e.length+t,o,s,a));let u,h=[],d=e.getLineContent(t),f=d;if(null!=i){u=i;let e=dX(d);f=u+d.substring(e.length),r.decreaseIndentPattern&&r.decreaseIndentPattern.test(f)&&(u=c(u),f=u+d.substring(e.length)),d!==f&&h.push(H3.replaceMove(new MK(t,1,t,e.length+1),l7.normalizeIndentation(u,s,a)))}else u=dX(d);let g=u;r.increaseIndentPattern&&r.increaseIndentPattern.test(f)?(g=l(g),u=l(u)):r.indentNextLinePattern&&r.indentNextLinePattern.test(f)&&(g=l(g));for(let p=++t;p<=n;p++){let t=e.getLineContent(p),n=dX(t),i=g+t.substring(n.length);r.decreaseIndentPattern&&r.decreaseIndentPattern.test(i)&&(g=c(g),u=c(u)),n!==g&&h.push(H3.replaceMove(new MK(p,1,p,n.length+1),l7.normalizeIndentation(g,s,a))),r.unIndentedLinePattern&&r.unIndentedLinePattern.test(t)||(r.increaseIndentPattern&&r.increaseIndentPattern.test(i)?(u=l(u),g=u):g=r.indentNextLinePattern&&r.indentNextLinePattern.test(i)?l(g):u)}return h}qZ.registerCommand("_executeDocumentSymbolProvider",(function(e,...t){return gIe(this,void 0,void 0,(function*(){const[n]=t;WZ(_K.isUri(n));const i=e.get(iJ).getModel(n);if(i)return pIe(i,!1,TG.None);const r=yield e.get(n0).createModelReference(n);try{return yield pIe(r.object.textEditorModel,!1,TG.None)}finally{r.dispose()}}))}));class _Ie extends o6{constructor(){super({id:_Ie.ID,label:GH(0,"Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:gre.writable})}run(e,t){let n=t.getModel();if(!n)return;let i=n.getOptions(),r=t.getSelection();if(!r)return;const o=new DIe(r,i.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[o]),t.pushUndoStop(),n.updateOptions({insertSpaces:!0})}}_Ie.ID="editor.action.indentationToSpaces";class bIe extends o6{constructor(){super({id:bIe.ID,label:GH(0,"Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:gre.writable})}run(e,t){let n=t.getModel();if(!n)return;let i=n.getOptions(),r=t.getSelection();if(!r)return;const o=new NIe(r,i.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[o]),t.pushUndoStop(),n.updateOptions({insertSpaces:!1})}}bIe.ID="editor.action.indentationToTabs";class wIe extends o6{constructor(e,t){super(t),this.insertSpaces=e}run(e,t){const n=e.get(Jme),i=e.get(iJ);let r=t.getModel();if(!r)return;let o=i.getCreationOptions(r.getLanguageIdentifier().language,r.uri,r.isForSimpleWidget);const s=[1,2,3,4,5,6,7,8].map((e=>({id:e.toString(),label:e.toString(),description:e===o.tabSize?GH(0,"Configured Tab Size"):void 0}))),a=Math.min(r.getOptions().tabSize-1,7);setTimeout((()=>{n.pick(s,{placeHolder:GH(0,"Select Tab Size for Current File"),activeItem:s[a]}).then((e=>{e&&r&&!r.isDisposed()&&r.updateOptions({tabSize:parseInt(e.label,10),insertSpaces:this.insertSpaces})}))}),50)}}class CIe extends wIe{constructor(){super(!1,{id:CIe.ID,label:GH(0,"Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0})}}CIe.ID="editor.action.indentUsingTabs";class SIe extends wIe{constructor(){super(!0,{id:SIe.ID,label:GH(0,"Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0})}}SIe.ID="editor.action.indentUsingSpaces";class xIe extends o6{constructor(){super({id:xIe.ID,label:GH(0,"Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0})}run(e,t){const n=e.get(iJ);let i=t.getModel();if(!i)return;let r=n.getCreationOptions(i.getLanguageIdentifier().language,i.uri,i.isForSimpleWidget);i.detectIndentation(r.insertSpaces,r.tabSize)}}xIe.ID="editor.action.detectIndentation";class EIe{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(let n of e)n.range&&"string"==typeof n.text&&this._edits.push(n)}getEditOperations(e,t){for(let i of this._edits)t.addEditOperation(TK.lift(i.range),i.text);let n=!1;Array.isArray(this._edits)&&1===this._edits.length&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(n=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(n=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),n||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class kIe{constructor(e){this.callOnDispose=new pG,this.callOnModel=new pG,this.editor=e,this.callOnDispose.add(e.onDidChangeConfiguration((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModel((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModelLanguage((()=>this.update())))}update(){this.callOnModel.clear(),this.editor.getOption(9)<4||this.editor.getOption(44)||this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste((({range:e})=>{this.trigger(e)})))}trigger(e){let t=this.editor.getSelections();if(null===t||t.length>1)return;const n=this.editor.getModel();if(!n)return;if(!n.isCheapToTokenize(e.getStartPosition().lineNumber))return;const i=this.editor.getOption(9),{tabSize:r,indentSize:o,insertSpaces:s}=n.getOptions();let a=[],l={shiftIndent:e=>sre.shiftIndent(e,e.length+1,r,o,s),unshiftIndent:e=>sre.unshiftIndent(e,e.length+1,r,o,s)},c=e.startLineNumber;for(;c<=e.endLineNumber&&this.shouldIgnoreLine(n,c);)c++;if(c>e.endLineNumber)return;let u=n.getLineContent(c);if(!/\S/.test(u.substring(0,e.startColumn-1))){let e=q0.getGoodIndentForLine(i,n,n.getLanguageIdentifier().id,c,l);if(null!==e){let t=dX(u),i=mIe(e,r);if(i!==mIe(t,r)){let e=vIe(i,r,s);a.push({range:new TK(c,1,c,t.length+1),text:e}),u=e+u.substr(t.length)}else{let e=q0.getIndentMetadata(n,c);if(0===e||8===e)return}}}const h=c;for(;c<e.endLineNumber&&!/\S/.test(n.getLineContent(c+1));)c++;if(c!==e.endLineNumber){let t={getLineTokens:e=>n.getLineTokens(e),getLanguageIdentifier:()=>n.getLanguageIdentifier(),getLanguageIdAtPosition:(e,t)=>n.getLanguageIdAtPosition(e,t),getLineContent:e=>e===h?u:n.getLineContent(e)},o=q0.getGoodIndentForLine(i,t,n.getLanguageIdentifier().id,c+1,l);if(null!==o){let t=mIe(o,r),i=mIe(dX(n.getLineContent(c+1)),r);if(t!==i){let o=t-i;for(let t=c+1;t<=e.endLineNumber;t++){let e=dX(n.getLineContent(t)),i=vIe(mIe(e,r)+o,r,s);i!==e&&a.push({range:new TK(t,1,t,e.length+1),text:i})}}}}if(a.length>0){this.editor.pushUndoStop();let e=new EIe(a,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",e),this.editor.pushUndoStop()}}shouldIgnoreLine(e,t){e.forceTokenization(t);let n=e.getLineFirstNonWhitespaceColumn(t);if(0===n)return!0;let i=e.getLineTokens(t);if(i.getCount()>0){let e=i.findTokenIndexAtOffset(n);if(e>=0&&1===i.getStandardTokenType(e))return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}}function LIe(e,t,n,i){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return;let r="";for(let s=0;s<n;s++)r+=" ";let o=new RegExp(r,"gi");for(let s=1,a=e.getLineCount();s<=a;s++){let n=e.getLineFirstNonWhitespaceColumn(s);if(0===n&&(n=e.getLineMaxColumn(s)),1===n)continue;const a=new TK(s,1,s,n),l=e.getValueInRange(a),c=i?l.replace(/\t/gi,r):l.replace(o,"\t");t.addEditOperation(a,c)}}kIe.ID="editor.contrib.autoIndentOnPaste";class DIe{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),LIe(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class NIe{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),LIe(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}d6(kIe.ID,kIe),c6(_Ie),c6(bIe),c6(CIe),c6(SIe),c6(xIe),c6(class extends o6{constructor(){super({id:"editor.action.reindentlines",label:GH(0,"Reindent Lines"),alias:"Reindent Lines",precondition:gre.writable})}run(e,t){let n=t.getModel();if(!n)return;let i=yIe(n,1,n.getLineCount());i.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,i),t.pushUndoStop())}}),c6(class extends o6{constructor(){super({id:"editor.action.reindentselectedlines",label:GH(0,"Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:gre.writable})}run(e,t){let n=t.getModel();if(!n)return;let i=t.getSelections();if(null===i)return;let r=[];for(let o of i){let e=o.startLineNumber,t=o.endLineNumber;if(e!==t&&1===o.endColumn&&t--,1===e){if(e===t)continue}else e--;let i=yIe(n,e,t);r.push(...i)}r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}});var IIe=function(e,t){return function(n,i){t(n,i,e)}},TIe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function MIe(e,t,n){return TIe(this,void 0,void 0,(function*(){const i=[],r=W1(BJ.ordered(e).reverse().map((r=>t.map((t=>Promise.resolve(r.provideInlayHints(e,t,n)).then((e=>{e&&i.push({list:e,provider:r})}),(e=>{iG(e)})))))));return yield Promise.all(r),i}))}let AIe=class{constructor(e,t,n){this._editor=e,this._codeEditorService=t,this._themeService=n,this._disposables=new pG,this._sessionDisposables=new pG,this._getInlayHintsDelays=new aJ(BJ,250,2500),this._decorationsTypeIds=[],this._decorationIds=[],this._disposables.add(BJ.onDidChange((()=>this._update()))),this._disposables.add(n.onDidColorThemeChange((()=>this._update()))),this._disposables.add(e.onDidChangeModel((()=>this._update()))),this._disposables.add(e.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(e.onDidChangeConfiguration((e=>{e.hasChanged(124)&&this._update()}))),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(124).enabled)return void this._removeAllDecorations();const e=this._editor.getModel();if(!e||!BJ.has(e))return void this._removeAllDecorations();const t=new z$((()=>TIe(this,void 0,void 0,(function*(){const n=Date.now(),i=new OG;this._sessionDisposables.add(gG((()=>i.dispose(!0))));const r=this._editor.getVisibleRangesPlusViewportAboveBelow(),o=yield MIe(e,r,i.token),s=this._getInlayHintsDelays.update(e,Date.now()-n);t.delay=s,this._updateHintsDecorators(o)}))),this._getInlayHintsDelays.get(e));this._sessionDisposables.add(t),this._sessionDisposables.add(this._editor.onDidChangeModelContent((()=>t.schedule()))),this._disposables.add(this._editor.onDidScrollChange((()=>t.schedule()))),t.schedule();const n=new pG;this._sessionDisposables.add(n);for(const i of BJ.all(e))"function"==typeof i.onDidChangeInlayHints&&n.add(i.onDidChangeInlayHints((()=>t.schedule())))}_updateHintsDecorators(e){const{fontSize:t,fontFamily:n}=this._getLayoutInfo(),i=this._themeService.getColorTheme().getColor(qte),r=this._themeService.getColorTheme().getColor(Kte),o=[],s=[],a="--inlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(a,n);for(const{list:l}of e)for(let e=0;e<l.length&&s.length<500;e++){const{text:n,position:c,whitespaceBefore:u,whitespaceAfter:h}=l[e],d={contentText:n,backgroundColor:`${i}`,color:`${r}`,margin:`0px ${h?t/3|0:0}px 0px ${u?t/3|0:0}px`,fontSize:`${t}px`,fontFamily:`var(${a})`,padding:`0px ${t/4|0}px`,borderRadius:(t/4|0)+"px"},f="inlayHints-"+LQ(d).toString(16);this._codeEditorService.registerDecorationType("inlay-hints-controller",f,{before:d},void 0,this._editor),o.push(f);const g=this._codeEditorService.resolveDecorationOptions(f,!0);s.push({range:TK.fromPositions(c),options:g})}this._decorationsTypeIds.forEach(this._codeEditorService.removeDecorationType,this._codeEditorService),this._decorationsTypeIds=o,this._decorationIds=this._editor.deltaDecorations(this._decorationIds,s)}_getLayoutInfo(){const e=this._editor.getOption(124),t=this._editor.getOption(42);let n=e.fontSize;(!n||n<5||n>t)&&(n=.9*t|0);return{fontSize:n,fontFamily:e.fontFamily}}_removeAllDecorations(){this._decorationIds=this._editor.deltaDecorations(this._decorationIds,[]),this._decorationsTypeIds.forEach(this._codeEditorService.removeDecorationType,this._codeEditorService),this._decorationsTypeIds=[]}};AIe.ID="editor.contrib.InlayHints",AIe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([IIe(1,o$),IIe(2,B5)],AIe),d6(AIe.ID,AIe),qZ.registerCommand("_executeInlayHintProvider",((e,...t)=>TIe(void 0,void 0,void 0,(function*(){const[n,i]=t;WZ(_K.isUri(n)),WZ(TK.isIRange(i));const r=yield e.get(n0).createModelReference(n);try{return W1((yield MIe(r.object.textEditorModel,[TK.lift(i)],TG.None)).map((e=>e.list))).sort(((e,t)=>IK.compare(e.position,t.position)))}finally{r.dispose()}}))));class OIe{constructor(e,t,n){this._editRange=e,this._originalSelection=t,this._text=n}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new MK(n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn),n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn)):new MK(n.endLineNumber,n.endColumn-this._text.length,n.endLineNumber,n.endColumn)}}let RIe=class e{constructor(e,t){this.decorationIds=[],this.editor=e,this.editorWorkerService=t}static get(t){return t.getContribution(e.ID)}dispose(){}run(t,n){this.currentRequest&&this.currentRequest.cancel();const i=this.editor.getSelection(),r=this.editor.getModel();if(!r||!i)return;let o=i;if(o.startLineNumber!==o.endLineNumber)return;const s=new fle(this.editor,5),a=r.uri;return this.editorWorkerService.canNavigateValueSet(a)?(this.currentRequest=I$((e=>this.editorWorkerService.navigateValueSet(a,o,n))),this.currentRequest.then((n=>{if(!n||!n.range||!n.value)return;if(!s.validate(this.editor))return;let i=TK.lift(n.range),r=n.range,a=n.value.length-(o.endColumn-o.startColumn);r={startLineNumber:r.startLineNumber,startColumn:r.startColumn,endLineNumber:r.endLineNumber,endColumn:r.startColumn+n.value.length},a>1&&(o=new MK(o.startLineNumber,o.startColumn,o.endLineNumber,o.endColumn+a-1));const l=new OIe(i,o,n.value);this.editor.pushUndoStop(),this.editor.executeCommand(t,l),this.editor.pushUndoStop(),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[{range:r,options:e.DECORATION}]),this.decorationRemover&&this.decorationRemover.cancel(),this.decorationRemover=R$(350),this.decorationRemover.then((()=>this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[]))).catch(nG)})).catch(nG)):Promise.resolve(void 0)}};RIe.ID="editor.contrib.inPlaceReplaceController",RIe.DECORATION=v7.register({description:"in-place-replace",className:"valueSetReplacement"}),RIe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,e0)],RIe);d6(RIe.ID,RIe),c6(class extends o6{constructor(){super({id:"editor.action.inPlaceReplace.up",label:GH(0,"Replace with Previous Value"),alias:"Replace with Previous Value",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:3154,weight:100}})}run(e,t){const n=RIe.get(t);return n?n.run(this.id,!0):Promise.resolve(void 0)}}),c6(class extends o6{constructor(){super({id:"editor.action.inPlaceReplace.down",label:GH(0,"Replace with Next Value"),alias:"Replace with Next Value",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:3156,weight:100}})}run(e,t){const n=RIe.get(t);return n?n.run(this.id,!1):Promise.resolve(void 0)}}),G5(((e,t)=>{const n=e.getColor(Eie);n&&t.addRule(`.monaco-editor.vs .valueSetReplacement { outline: solid 2px ${n}; }`)}));class PIe{constructor(e,t){this._selection=e,this._cursors=t,this._selectionId=null}getEditOperations(e,t){let n=function(e,t){t.sort(((e,t)=>e.lineNumber===t.lineNumber?e.column-t.column:e.lineNumber-t.lineNumber));for(let s=t.length-2;s>=0;s--)t[s].lineNumber===t[s+1].lineNumber&&t.splice(s,1);let n=[],i=0,r=0,o=t.length;for(let s=1,a=e.getLineCount();s<=a;s++){let a=e.getLineContent(s),l=a.length+1,c=0;if(r<o&&t[r].lineNumber===s&&(c=t[r].column,r++,c===l))continue;if(0===a.length)continue;let u=fX(a),h=0;if(-1===u)h=1;else{if(u===a.length-1)continue;h=u+2}h=Math.max(c,h),n[i++]=H3.delete(new TK(s,h,s,l))}return n}(e,this._cursors);for(let i=0,r=n.length;i<r;i++){let e=n[i];t.addEditOperation(e.range,e.text)}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class FIe{constructor(e,t,n){this._selection=e,this._isCopyingDown=t,this._noop=n||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let n=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._endLineNumberDelta=1,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));let i=[];for(let o=n.startLineNumber;o<=n.endLineNumber;o++)i.push(e.getLineContent(o));const r=i.join("\n");""===r&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new TK(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber+1,1),n.endLineNumber===e.getLineCount()?"":"\n"):this._isCopyingDown?t.addEditOperation(new TK(n.startLineNumber,1,n.startLineNumber,1),r+"\n"):t.addEditOperation(new TK(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),"\n"+r),this._selectionId=t.trackSelection(n),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);if(0!==this._startLineNumberDelta||0!==this._endLineNumberDelta){let e=n.startLineNumber,t=n.startColumn,i=n.endLineNumber,r=n.endColumn;0!==this._startLineNumberDelta&&(e+=this._startLineNumberDelta,t=1),0!==this._endLineNumberDelta&&(i+=this._endLineNumberDelta,r=1),n=MK.createWithDirection(e,t,i,r,this._selectionDirection)}return n}}class BIe{constructor(e,t,n){this._selection=e,this._isMovingDown=t,this._autoIndent=n,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){let n=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===n)return void(this._selectionId=t.trackSelection(this._selection));if(!this._isMovingDown&&1===this._selection.startLineNumber)return void(this._selectionId=t.trackSelection(this._selection));this._moveEndPositionDown=!1;let i=this._selection;i.startLineNumber<i.endLineNumber&&1===i.endColumn&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const{tabSize:r,indentSize:o,insertSpaces:s}=e.getOptions();let a=this.buildIndentConverter(r,o,s),l={getLineTokens:t=>e.getLineTokens(t),getLanguageIdentifier:()=>e.getLanguageIdentifier(),getLanguageIdAtPosition:(t,n)=>e.getLanguageIdAtPosition(t,n),getLineContent:null};if(i.startLineNumber===i.endLineNumber&&1===e.getLineMaxColumn(i.startLineNumber)){let n=i.startLineNumber,r=this._isMovingDown?n+1:n-1;1===e.getLineMaxColumn(r)?t.addEditOperation(new TK(1,1,1,1),null):(t.addEditOperation(new TK(n,1,n,1),e.getLineContent(r)),t.addEditOperation(new TK(r,1,r,e.getLineMaxColumn(r)),null)),i=new MK(r,1,r,1)}else{let n,o;if(this._isMovingDown){n=i.endLineNumber+1,o=e.getLineContent(n),t.addEditOperation(new TK(n-1,e.getLineMaxColumn(n-1),n,e.getLineMaxColumn(n)),null);let c=o;if(this.shouldAutoIndent(e,i)){let u=this.matchEnterRule(e,a,r,n,i.startLineNumber-1);if(null!==u){let t=vIe(u+mIe(dX(e.getLineContent(n)),r),r,s);c=t+this.trimLeft(o)}else{l.getLineContent=t=>t===i.startLineNumber?e.getLineContent(n):e.getLineContent(t);let t=q0.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(n,1),i.startLineNumber,a);if(null!==t){let i=dX(e.getLineContent(n)),a=mIe(t,r);if(a!==mIe(i,r)){let e=vIe(a,r,s);c=e+this.trimLeft(o)}}}t.addEditOperation(new TK(i.startLineNumber,1,i.startLineNumber,1),c+"\n");let h=this.matchEnterRuleMovingDown(e,a,r,i.startLineNumber,n,c);if(null!==h)0!==h&&this.getIndentEditsOfMovingBlock(e,t,i,r,s,h);else{l.getLineContent=t=>t===i.startLineNumber?c:t>=i.startLineNumber+1&&t<=i.endLineNumber+1?e.getLineContent(t-1):e.getLineContent(t);let o=q0.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(n,1),i.startLineNumber+1,a);if(null!==o){const n=dX(e.getLineContent(i.startLineNumber)),a=mIe(o,r),l=mIe(n,r);if(a!==l){const n=a-l;this.getIndentEditsOfMovingBlock(e,t,i,r,s,n)}}}}else t.addEditOperation(new TK(i.startLineNumber,1,i.startLineNumber,1),c+"\n")}else if(n=i.startLineNumber-1,o=e.getLineContent(n),t.addEditOperation(new TK(n,1,n+1,1),null),t.addEditOperation(new TK(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),"\n"+o),this.shouldAutoIndent(e,i)){l.getLineContent=t=>t===n?e.getLineContent(i.startLineNumber):e.getLineContent(t);let o=this.matchEnterRule(e,a,r,i.startLineNumber,i.startLineNumber-2);if(null!==o)0!==o&&this.getIndentEditsOfMovingBlock(e,t,i,r,s,o);else{let o=q0.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(i.startLineNumber,1),n,a);if(null!==o){let n=dX(e.getLineContent(i.startLineNumber)),a=mIe(o,r),l=mIe(n,r);if(a!==l){let n=a-l;this.getIndentEditsOfMovingBlock(e,t,i,r,s,n)}}}}}this._selectionId=t.trackSelection(i)}buildIndentConverter(e,t,n){return{shiftIndent:i=>sre.shiftIndent(i,i.length+1,e,t,n),unshiftIndent:i=>sre.unshiftIndent(i,i.length+1,e,t,n)}}parseEnterResult(e,t,n,i,r){if(r){let o=r.indentation;r.indentAction===h0.None||r.indentAction===h0.Indent?o=r.indentation+r.appendText:r.indentAction===h0.IndentOutdent?o=r.indentation:r.indentAction===h0.Outdent&&(o=t.unshiftIndent(r.indentation)+r.appendText);let s=e.getLineContent(i);if(this.trimLeft(s).indexOf(this.trimLeft(o))>=0){let r=dX(e.getLineContent(i)),s=dX(o),a=q0.getIndentMetadata(e,i);return null!==a&&2&a&&(s=t.unshiftIndent(s)),mIe(s,n)-mIe(r,n)}}return null}matchEnterRuleMovingDown(e,t,n,i,r,o){if(fX(o)>=0){let o=e.getLineMaxColumn(r),s=q0.getEnterAction(this._autoIndent,e,new TK(r,o,r,o));return this.parseEnterResult(e,t,n,i,s)}{let r=i-1;for(;r>=1;){if(fX(e.getLineContent(r))>=0)break;r--}if(r<1||i>e.getLineCount())return null;let o=e.getLineMaxColumn(r),s=q0.getEnterAction(this._autoIndent,e,new TK(r,o,r,o));return this.parseEnterResult(e,t,n,i,s)}}matchEnterRule(e,t,n,i,r,o){let s=r;for(;s>=1;){let t;if(t=s===r&&void 0!==o?o:e.getLineContent(s),fX(t)>=0)break;s--}if(s<1||i>e.getLineCount())return null;let a=e.getLineMaxColumn(s),l=q0.getEnterAction(this._autoIndent,e,new TK(s,a,s,a));return this.parseEnterResult(e,t,n,i,l)}trimLeft(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4)return!1;if(!e.isCheapToTokenize(t.startLineNumber))return!1;let n=e.getLanguageIdAtPosition(t.startLineNumber,1);return n===e.getLanguageIdAtPosition(t.endLineNumber,1)&&null!==q0.getIndentRulesSupport(n)}getIndentEditsOfMovingBlock(e,t,n,i,r,o){for(let s=n.startLineNumber;s<=n.endLineNumber;s++){let a=dX(e.getLineContent(s)),l=vIe(mIe(a,i)+o,i,r);l!==a&&(t.addEditOperation(new TK(s,1,s,a.length+1),l),s===n.endLineNumber&&n.endColumn<=a.length+1&&""===l&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(n=n.setEndPosition(n.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&n.startLineNumber<n.endLineNumber&&(n=n.setEndPosition(n.endLineNumber,2)),n}}class WIe{constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}static getCollator(){return WIe._COLLATOR||(WIe._COLLATOR=new Intl.Collator),WIe._COLLATOR}getEditOperations(e,t){let n=function(e,t,n){let i=zIe(e,t,n);if(!i)return null;return H3.replace(new TK(i.startLineNumber,1,i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),i.after.join("\n"))}(e,this.selection,this.descending);n&&t.addEditOperation(n.range,n.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,n){if(null===e)return!1;let i=zIe(e,t,n);if(!i)return!1;for(let r=0,o=i.before.length;r<o;r++)if(i.before[r]!==i.after[r])return!0;return!1}}function zIe(e,t,n){let i=t.startLineNumber,r=t.endLineNumber;if(1===t.endColumn&&r--,i>=r)return null;let o=[];for(let a=i;a<=r;a++)o.push(e.getLineContent(a));let s=o.slice(0);return s.sort(WIe.getCollator().compare),!0===n&&(s=s.reverse()),{startLineNumber:i,endLineNumber:r,before:o,after:s}}WIe._COLLATOR=null;class VIe extends o6{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const n=t.getSelections().map(((e,t)=>({selection:e,index:t,ignore:!1})));n.sort(((e,t)=>TK.compareRangesUsingStarts(e.selection,t.selection)));let i=n[0];for(let o=1;o<n.length;o++){const e=n[o];i.selection.endLineNumber===e.selection.startLineNumber&&(i.index<e.index?e.ignore=!0:(i.ignore=!0,i=e))}const r=[];for(const o of n)r.push(new FIe(o.selection,this.down,o.ignore));t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}class UIe extends o6{constructor(e,t){super(t),this.down=e}run(e,t){let n=[],i=t.getSelections()||[];const r=t.getOption(9);for(const o of i)n.push(new BIe(o,this.down,r));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class HIe extends o6{constructor(e,t){super(t),this.descending=e}run(e,t){const n=t.getSelections()||[];for(const r of n)if(!WIe.canRun(t.getModel(),r,this.descending))return;let i=[];for(let r=0,o=n.length;r<o;r++)i[r]=new WIe(n[r],this.descending);t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class jIe extends o6{constructor(){super({id:jIe.ID,label:GH(0,"Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:VG(2089,2102),weight:100}})}run(e,t,n){let i=[];"auto-save"===n.reason&&(i=(t.getSelections()||[]).map((e=>new IK(e.positionLineNumber,e.positionColumn))));let r=t.getSelection();if(null===r)return;let o=new PIe(r,i);t.pushUndoStop(),t.executeCommands(this.id,[o]),t.pushUndoStop()}}jIe.ID="editor.action.trimTrailingWhitespace";class GIe extends o6{run(e,t){if(!t.hasModel())return;const n=t.getSelection();let i=this._getRangesToDelete(t),r=[];for(let a=0,l=i.length-1;a<l;a++){let e=i[a],t=i[a+1];null===TK.intersectRanges(e,t)?r.push(e):i[a+1]=TK.plusRange(e,t)}r.push(i[i.length-1]);let o=this._getEndCursorState(n,r),s=r.map((e=>H3.replace(e,"")));t.pushUndoStop(),t.executeEdits(this.id,s,o),t.pushUndoStop()}}class KIe extends o6{run(e,t){const n=t.getSelections();if(null===n)return;const i=t.getModel();if(null===i)return;const r=t.getOption(114),o=[];for(const s of n)if(s.isEmpty()){const e=s.getStartPosition(),n=t.getConfiguredWordAtPosition(e);if(!n)continue;const a=new TK(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn),l=i.getValueInRange(a);o.push(H3.replace(a,this._modifyText(l,r)))}else{const e=i.getValueInRange(s);o.push(H3.replace(s,this._modifyText(e,r)))}t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop()}}class qIe{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch(e){}}return this._actual}isSupported(){return null!==this.get()}}class $Ie extends KIe{constructor(){super({id:"editor.action.transformToSnakecase",label:GH(0,"Transform to Snake Case"),alias:"Transform to Snake Case",precondition:gre.writable})}_modifyText(e,t){const n=$Ie.regExp1.get(),i=$Ie.regExp2.get();return n&&i?e.replace(n,"$1_$2").replace(i,"$1_$2$3").toLocaleLowerCase():e}}$Ie.regExp1=new qIe("(\\p{Ll})(\\p{Lu})","gmu"),$Ie.regExp2=new qIe("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu"),c6(class extends VIe{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:GH(0,"Copy Line Up"),alias:"Copy Line Up",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"2_line",title:GH(0,"&&Copy Line Up"),order:1}})}}),c6(class extends VIe{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:GH(0,"Copy Line Down"),alias:"Copy Line Down",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"2_line",title:GH(0,"Co&&py Line Down"),order:2}})}}),c6(class extends o6{constructor(){super({id:"editor.action.duplicateSelection",label:GH(0,"Duplicate Selection"),alias:"Duplicate Selection",precondition:gre.writable,menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"2_line",title:GH(0,"&&Duplicate Selection"),order:5}})}run(e,t,n){if(!t.hasModel())return;const i=[],r=t.getSelections(),o=t.getModel();for(const s of r)if(s.isEmpty())i.push(new FIe(s,!0));else{const e=new MK(s.endLineNumber,s.endColumn,s.endLineNumber,s.endColumn);i.push(new Gie(e,o.getValueInRange(s)))}t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}),c6(class extends UIe{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:GH(0,"Move Line Up"),alias:"Move Line Up",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"2_line",title:GH(0,"Mo&&ve Line Up"),order:3}})}}),c6(class extends UIe{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:GH(0,"Move Line Down"),alias:"Move Line Down",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"2_line",title:GH(0,"Move &&Line Down"),order:4}})}}),c6(class extends HIe{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:GH(0,"Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:gre.writable})}}),c6(class extends HIe{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:GH(0,"Sort Lines Descending"),alias:"Sort Lines Descending",precondition:gre.writable})}}),c6(jIe),c6(class extends o6{constructor(){super({id:"editor.action.deleteLines",label:GH(0,"Delete Line"),alias:"Delete Line",precondition:gre.writable,kbOpts:{kbExpr:gre.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;let n=this._getLinesToRemove(t),i=t.getModel();if(1===i.getLineCount()&&1===i.getLineMaxColumn(1))return;let r=0,o=[],s=[];for(let a=0,l=n.length;a<l;a++){const e=n[a];let t=e.startLineNumber,l=e.endLineNumber,c=1,u=i.getLineMaxColumn(l);l<i.getLineCount()?(l+=1,u=1):t>1&&(t-=1,c=i.getLineMaxColumn(t)),o.push(H3.replace(new MK(t,c,l,u),"")),s.push(new MK(t-r,e.positionColumn,t-r,e.positionColumn)),r+=e.endLineNumber-e.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,o,s),t.pushUndoStop()}_getLinesToRemove(e){let t=e.getSelections().map((e=>{let t=e.endLineNumber;return e.startLineNumber<e.endLineNumber&&1===e.endColumn&&(t-=1),{startLineNumber:e.startLineNumber,selectionStartColumn:e.selectionStartColumn,endLineNumber:t,positionColumn:e.positionColumn}}));t.sort(((e,t)=>e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber));let n=[],i=t[0];for(let r=1;r<t.length;r++)i.endLineNumber+1>=t[r].startLineNumber?i.endLineNumber=t[r].endLineNumber:(n.push(i),i=t[r]);return n.push(i),n}}),c6(class extends o6{constructor(){super({id:"editor.action.indentLines",label:GH(0,"Indent Line"),alias:"Indent Line",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:2137,weight:100}})}run(e,t){const n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,lre.indent(n.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}),c6(class extends o6{constructor(){super({id:"editor.action.outdentLines",label:GH(0,"Outdent Line"),alias:"Outdent Line",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:2135,weight:100}})}run(e,t){kre.Outdent.runEditorCommand(e,t,null)}}),c6(class extends o6{constructor(){super({id:"editor.action.insertLineBefore",label:GH(0,"Insert Line Above"),alias:"Insert Line Above",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:3075,weight:100}})}run(e,t){const n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,lre.lineInsertBefore(n.cursorConfig,t.getModel(),t.getSelections())))}}),c6(class extends o6{constructor(){super({id:"editor.action.insertLineAfter",label:GH(0,"Insert Line Below"),alias:"Insert Line Below",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:2051,weight:100}})}run(e,t){const n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,lre.lineInsertAfter(n.cursorConfig,t.getModel(),t.getSelections())))}}),c6(class extends GIe{constructor(){super({id:"deleteAllLeft",label:GH(0,"Delete All Left"),alias:"Delete All Left",precondition:gre.writable,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let n=null,i=[],r=0;return t.forEach((t=>{let o;if(1===t.endColumn&&r>0){let e=t.startLineNumber-r;o=new MK(e,t.startColumn,e,t.startColumn)}else o=new MK(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn);r+=t.endLineNumber-t.startLineNumber,t.intersectRanges(e)?n=o:i.push(o)})),n&&i.unshift(n),i}_getRangesToDelete(e){let t=e.getSelections();if(null===t)return[];let n=t,i=e.getModel();return null===i?[]:(n.sort(TK.compareRangesUsingStarts),n=n.map((e=>{if(e.isEmpty()){if(1===e.startColumn){let t=Math.max(1,e.startLineNumber-1),n=1===e.startLineNumber?1:i.getLineContent(t).length+1;return new TK(t,n,e.startLineNumber,1)}return new TK(e.startLineNumber,1,e.startLineNumber,e.startColumn)}return new TK(e.startLineNumber,1,e.endLineNumber,e.endColumn)})),n)}}),c6(class extends GIe{constructor(){super({id:"deleteAllRight",label:GH(0,"Delete All Right"),alias:"Delete All Right",precondition:gre.writable,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let n=null,i=[];for(let r=0,o=t.length,s=0;r<o;r++){let o=t[r],a=new MK(o.startLineNumber-s,o.startColumn,o.startLineNumber-s,o.startColumn);o.intersectRanges(e)?n=a:i.push(a)}return n&&i.unshift(n),i}_getRangesToDelete(e){let t=e.getModel();if(null===t)return[];let n=e.getSelections();if(null===n)return[];let i=n.map((e=>{if(e.isEmpty()){const n=t.getLineMaxColumn(e.startLineNumber);return e.startColumn===n?new TK(e.startLineNumber,e.startColumn,e.startLineNumber+1,1):new TK(e.startLineNumber,e.startColumn,e.startLineNumber,n)}return e}));return i.sort(TK.compareRangesUsingStarts),i}}),c6(class extends o6{constructor(){super({id:"editor.action.joinLines",label:GH(0,"Join Lines"),alias:"Join Lines",precondition:gre.writable,kbOpts:{kbExpr:gre.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){let n=t.getSelections();if(null===n)return;let i=t.getSelection();if(null===i)return;n.sort(TK.compareRangesUsingStarts);let r=[],o=n.reduce(((e,t)=>e.isEmpty()?e.endLineNumber===t.startLineNumber?(i.equalsSelection(e)&&(i=t),t):t.startLineNumber>e.endLineNumber+1?(r.push(e),t):new MK(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn):t.startLineNumber>e.endLineNumber?(r.push(e),t):new MK(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn)));r.push(o);let s=t.getModel();if(null===s)return;let a=[],l=[],c=i,u=0;for(let h=0,d=r.length;h<d;h++){let e,t,n=r[h],o=n.startLineNumber,d=1,f=0,g=s.getLineContent(n.endLineNumber).length-n.endColumn;if(n.isEmpty()||n.startLineNumber===n.endLineNumber){let i=n.getStartPosition();i.lineNumber<s.getLineCount()?(e=o+1,t=s.getLineMaxColumn(e)):(e=i.lineNumber,t=s.getLineMaxColumn(i.lineNumber))}else e=n.endLineNumber,t=s.getLineMaxColumn(e);let p=s.getLineContent(o);for(let i=o+1;i<=e;i++){let e=s.getLineContent(i),t=s.getLineFirstNonWhitespaceColumn(i);if(t>=1){let n=!0;""===p&&(n=!1),!n||" "!==p.charAt(p.length-1)&&"\t"!==p.charAt(p.length-1)||(n=!1,p=p.replace(/[\s\uFEFF\xA0]+$/g," "));let i=e.substr(t-1);p+=(n?" ":"")+i,f=n?i.length+1:i.length}else f=0}let m=new TK(o,d,e,t);if(!m.isEmpty()){let e;n.isEmpty()?(a.push(H3.replace(m,p)),e=new MK(m.startLineNumber-u,p.length-f+1,o-u,p.length-f+1)):n.startLineNumber===n.endLineNumber?(a.push(H3.replace(m,p)),e=new MK(n.startLineNumber-u,n.startColumn,n.endLineNumber-u,n.endColumn)):(a.push(H3.replace(m,p)),e=new MK(n.startLineNumber-u,n.startColumn,n.startLineNumber-u,p.length-g)),null!==TK.intersectRanges(m,i)?c=e:l.push(e)}u+=m.endLineNumber-m.startLineNumber}l.unshift(c),t.pushUndoStop(),t.executeEdits(this.id,a,l),t.pushUndoStop()}}),c6(class extends o6{constructor(){super({id:"editor.action.transpose",label:GH(0,"Transpose characters around the cursor"),alias:"Transpose characters around the cursor",precondition:gre.writable})}run(e,t){let n=t.getSelections();if(null===n)return;let i=t.getModel();if(null===i)return;let r=[];for(let o=0,s=n.length;o<s;o++){let e=n[o];if(!e.isEmpty())continue;let t=e.getStartPosition(),s=i.getLineMaxColumn(t.lineNumber);if(t.column>=s){if(t.lineNumber===i.getLineCount())continue;let e=new TK(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),n=i.getValueInRange(e).split("").reverse().join("");r.push(new jie(new MK(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),n))}else{let e=new TK(t.lineNumber,Math.max(1,t.column-1),t.lineNumber,t.column+1),n=i.getValueInRange(e).split("").reverse().join("");r.push(new $ie(e,n,new MK(t.lineNumber,t.column+1,t.lineNumber,t.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}),c6(class extends KIe{constructor(){super({id:"editor.action.transformToUppercase",label:GH(0,"Transform to Uppercase"),alias:"Transform to Uppercase",precondition:gre.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}}),c6(class extends KIe{constructor(){super({id:"editor.action.transformToLowercase",label:GH(0,"Transform to Lowercase"),alias:"Transform to Lowercase",precondition:gre.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}}),c6(class extends KIe{constructor(){super({id:"editor.action.transformToTitlecase",label:GH(0,"Transform to Title Case"),alias:"Transform to Title Case",precondition:gre.writable})}_modifyText(e,t){const n=("\r\n\t "+t).split("");let i="",r=!0;for(let o=0;o<e.length;o++){let t=e[o];n.indexOf(t)>=0?(r=!0,i+=t):r?(r=!1,i+=t.toLocaleUpperCase()):i+=t.toLocaleLowerCase()}return i}}),$Ie.regExp1.isSupported()&&$Ie.regExp2.isSupported()&&c6($Ie);var YIe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const XIe=new M5("LinkedEditingInputVisible",!1);let ZIe=class e extends mG{constructor(e,t){super(),this._debounceDuration=200,this._localToDispose=this._register(new pG),this._editor=e,this._enabled=!1,this._visibleContextKey=XIe.bindTo(t),this._currentDecorations=[],this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new pG),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequest=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel((()=>this.reinitialize(!0)))),this._register(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(59)||e.hasChanged(79))&&this.reinitialize(!1)}))),this._register(MJ.onDidChange((()=>this.reinitialize(!1)))),this._register(this._editor.onDidChangeModelLanguage((()=>this.reinitialize(!0)))),this.reinitialize(!0)}static get(t){return t.getContribution(e.ID)}reinitialize(e){const t=this._editor.getModel(),n=null!==t&&(this._editor.getOption(59)||this._editor.getOption(79))&&MJ.has(t);if(n===this._enabled&&!e)return;if(this._enabled=n,this.clearRanges(),this._localToDispose.clear(),!n||null===t)return;this._languageWordPattern=q0.getWordDefinition(t.getLanguageIdentifier().id),this._localToDispose.add(t.onDidChangeLanguageConfiguration((()=>{this._languageWordPattern=q0.getWordDefinition(t.getLanguageIdentifier().id)})));const i=new A$(this._debounceDuration),r=()=>{this._rangeUpdateTriggerPromise=i.trigger((()=>this.updateRanges()),this._debounceDuration)},o=new A$(0),s=e=>{this._rangeSyncTriggerPromise=o.trigger((()=>this._syncRanges(e)))};this._localToDispose.add(this._editor.onDidChangeCursorPosition((()=>{r()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((e=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const n=t.getDecorationRange(this._currentDecorations[0]);if(n&&e.changes.every((e=>n.intersectRanges(e.range))))return void s(this._currentDecorations)}r()}))),this._localToDispose.add({dispose:()=>{i.cancel(),o.cancel()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._currentDecorations||0===e.length)return;const t=this._editor.getModel(),n=t.getDecorationRange(e[0]);if(!n||n.startLineNumber!==n.endLineNumber)return this.clearRanges();const i=t.getValueInRange(n);if(this._currentWordPattern){const e=i.match(this._currentWordPattern);if((e?e[0].length:0)!==i.length)return this.clearRanges()}let r=[];for(let o=1,s=e.length;o<s;o++){const n=t.getDecorationRange(e[o]);if(n)if(n.startLineNumber!==n.endLineNumber)r.push({range:n,text:i});else{let e=t.getValueInRange(n),o=i,s=n.startColumn,a=n.endColumn;const l=xX(e,o);s+=l,e=e.substr(l),o=o.substr(l);const c=EX(e,o);a-=c,e=e.substr(0,e.length-c),o=o.substr(0,o.length-c),s===a&&0===o.length||r.push({range:new TK(n.startLineNumber,s,n.endLineNumber,a),text:o})}}if(0!==r.length)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const e=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",r),this._editor._getViewModel().setPrevEditOperationType(e)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,[]),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}updateRanges(t=!1){return YIe(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return void this.clearRanges();const n=this._editor.getPosition();if(!this._enabled&&!t||this._editor.getSelections().length>1)return void this.clearRanges();const i=this._editor.getModel(),r=i.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===r){if(n.equals(this._currentRequestPosition))return;if(this._currentDecorations&&this._currentDecorations.length>0){const e=i.getDecorationRange(this._currentDecorations[0]);if(e&&e.containsPosition(n))return}}this._currentRequestPosition=n,this._currentRequestModelVersion=r;const o=I$((t=>YIe(this,void 0,void 0,(function*(){try{const s=yield QIe(i,n,t);if(o!==this._currentRequest)return;if(this._currentRequest=null,r!==i.getVersionId())return;let a=[];(null==s?void 0:s.ranges)&&(a=s.ranges),this._currentWordPattern=(null==s?void 0:s.wordPattern)||this._languageWordPattern;let l=!1;for(let e=0,t=a.length;e<t;e++)if(TK.containsPosition(a[e],n)){if(l=!0,0!==e){const t=a[e];a.splice(e,1),a.unshift(t)}break}if(!l)return void this.clearRanges();const c=a.map((t=>({range:t,options:e.DECORATION})));this._visibleContextKey.set(!0),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,c)}catch(s){oG(s)||nG(s),this._currentRequest!==o&&this._currentRequest||this.clearRanges()}}))));return this._currentRequest=o,o}))}};ZIe.ID="editor.contrib.linkedEditing",ZIe.DECORATION=v7.register({description:"linked-editing",stickiness:0,className:"linked-editing-decoration"}),ZIe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,A5)],ZIe);function QIe(e,t,n){return F$(MJ.ordered(e).map((i=>()=>YIe(this,void 0,void 0,(function*(){try{return yield i.provideLinkedEditingRanges(e,t,n)}catch(zWe){return void iG(zWe)}})))),(e=>!!e&&R1(null==e?void 0:e.ranges)))}l6(new(r6.bindToContribution(ZIe.get))({id:"cancelLinkedEditingInput",precondition:XIe,handler:e=>e.clearRanges(),kbOpts:{kbExpr:gre.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));const JIe=_ee("editor.linkedEditingBackground",{dark:Q8.fromHex("#f00").transparent(.3),light:Q8.fromHex("#f00").transparent(.3),hc:Q8.fromHex("#f00").transparent(.3)},GH(0,"Background color when the editor auto renames on type."));G5(((e,t)=>{const n=e.getColor(JIe);n&&t.addRule(`.monaco-editor .linked-editing-decoration { background: ${n}; border-left-color: ${n}; }`)})),a6("_executeLinkedEditingProvider",((e,t)=>QIe(e,t,TG.None))),d6(ZIe.ID,ZIe),c6(class extends o6{constructor(){super({id:"editor.action.linkedEditing",label:GH(0,"Start Linked Editing"),alias:"Start Linked Editing",precondition:g5.and(gre.writable,gre.hasRenameProvider),kbOpts:{kbExpr:gre.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const n=e.get(o$),[i,r]=Array.isArray(t)&&t||[void 0,void 0];return _K.isUri(i)&&IK.isIPosition(r)?n.openCodeEditor({resource:i},n.getActiveCodeEditor()).then((e=>{e&&(e.setPosition(r),e.invokeWithinContext((t=>(this.reportTelemetry(t,e),this.run(t,e)))))}),nG):super.runCommand(e,t)}run(e,t){const n=ZIe.get(t);return n?Promise.resolve(n.updateRanges(!0)):Promise.resolve()}});var eTe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class tTe{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}resolve(e){return eTe(this,void 0,void 0,(function*(){return this._link.url?this._link.url:"function"==typeof this._provider.resolveLink?Promise.resolve(this._provider.resolveLink(this._link,e)).then((t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing"))))):Promise.reject(new Error("missing"))}))}}class nTe{constructor(e){this._disposables=new pG;let t=[];for(const[n,i]of e){const e=n.links.map((e=>new tTe(e,i)));t=nTe._union(t,e),hG(n)&&this._disposables.add(n)}this.links=t}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){let n,i,r,o,s=[];for(n=0,r=0,i=e.length,o=t.length;n<i&&r<o;){const i=e[n],o=t[r];if(TK.areIntersectingOrTouching(i.range,o.range)){n++;continue}TK.compareRangesUsingStarts(i.range,o.range)<0?(s.push(i),n++):(s.push(o),r++)}for(;n<i;n++)s.push(e[n]);for(;r<o;r++)s.push(t[r]);return s}}function iTe(e,t){const n=[],i=HJ.ordered(e).reverse().map(((i,r)=>Promise.resolve(i.provideLinks(e,t)).then((e=>{e&&(n[r]=[e,i])}),iG)));return Promise.all(i).then((()=>{const e=new nTe(A1(n));return t.isCancellationRequested?(e.dispose(),new nTe([])):e}))}qZ.registerCommand("_executeLinkProvider",((e,...t)=>eTe(void 0,void 0,void 0,(function*(){let[n,i]=t;WZ(n instanceof _K),"number"!=typeof i&&(i=0);const r=e.get(iJ).getModel(n);if(!r)return[];const o=yield iTe(r,TG.None);if(!o)return[];for(let e=0;e<Math.min(i,o.links.length);e++)yield o.links[e].resolve(TG.None);const s=o.links.slice(0);return o.dispose(),s}))));var rTe=function(e,t){return function(n,i){t(n,i,e)}},oTe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const sTe={general:v7.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:v7.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class aTe{constructor(e,t){this.link=e,this.decorationId=t}static decoration(e,t){return{range:e.range,options:aTe._getOptions(e,t,!1)}}static _getOptions(e,t,n){const i=Object.assign({},n?sTe.active:sTe.general);return i.hoverMessage=function(e,t){const n=e.url&&/^command:/i.test(e.url.toString()),i=e.tooltip?e.tooltip:GH(0,n?"Execute command":"Follow link"),r=GH(0,t?lj?"cmd + click":"ctrl + click":lj?"option + click":"alt + click");if(e.url){let t="";if(/^command:/i.test(e.url.toString())){const n=e.url.toString().match(/^command:([^?#]+)/);n&&(t=` "${GH(0,"Execute command {0}",n[1])}"`)}return new z_e("",!0).appendMarkdown(`[${i}](${e.url.toString(!0)}${t}) (${r})`)}return(new z_e).appendText(`${i} (${r})`)}(e,t),i}activate(e,t){e.changeDecorationOptions(this.decorationId,aTe._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,aTe._getOptions(this.link,t,!1))}}let lTe=class e{constructor(e,t,n){this.listenersToRemove=new pG,this.editor=e,this.openerService=t,this.notificationService=n;let i=new LLe(e);this.listenersToRemove.add(i),this.listenersToRemove.add(i.onMouseMoveOrRelevantKeyDown((([e,t])=>{this._onEditorMouseMove(e,t)}))),this.listenersToRemove.add(i.onExecute((e=>{this.onEditorMouseUp(e)}))),this.listenersToRemove.add(i.onCancel((e=>{this.cleanUpActiveLinkDecoration()}))),this.enabled=e.getOption(60),this.listenersToRemove.add(e.onDidChangeConfiguration((t=>{const n=e.getOption(60);this.enabled!==n&&(this.enabled=n,this.updateDecorations([]),this.stop(),this.beginCompute())}))),this.listenersToRemove.add(e.onDidChangeModelContent((e=>this.onChange()))),this.listenersToRemove.add(e.onDidChangeModel((e=>this.onModelChanged()))),this.listenersToRemove.add(e.onDidChangeModelLanguage((e=>this.onModelModeChanged()))),this.listenersToRemove.add(HJ.onDidChange((e=>this.onModelModeChanged()))),this.timeout=new B$,this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null,this.beginCompute()}static get(t){return t.getContribution(e.ID)}onModelChanged(){this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.beginCompute()}onModelModeChanged(){this.stop(),this.beginCompute()}onChange(){this.timeout.setIfNotSet((()=>this.beginCompute()),e.RECOMPUTE_TIME)}beginCompute(){return oTe(this,void 0,void 0,(function*(){if(!this.editor.hasModel()||!this.enabled)return;const e=this.editor.getModel();if(HJ.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=I$((t=>iTe(e,t)));try{this.activeLinksList=yield this.computePromise,this.updateDecorations(this.activeLinksList.links)}catch(t){nG(t)}finally{this.computePromise=null}}}))}updateDecorations(e){const t="altKey"===this.editor.getOption(67);let n=[],i=Object.keys(this.currentOccurrences);for(let s=0,a=i.length;s<a;s++){let e=i[s],t=this.currentOccurrences[e];n.push(t.decorationId)}let r=[];if(e)for(const s of e)r.push(aTe.decoration(s,t));let o=this.editor.deltaDecorations(n,r);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let s=0,a=o.length;s<a;s++){let t=new aTe(e[s],o[s]);this.currentOccurrences[t.decorationId]=t}}_onEditorMouseMove(e,t){const n="altKey"===this.editor.getOption(67);if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const t=this.getLinkOccurrence(e.target.position);t&&this.editor.changeDecorations((e=>{t.activate(e,n),this.activeLinkDecorationId=t.decorationId}))}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e="altKey"===this.editor.getOption(67);if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations((n=>{t.deactivate(n,e)})),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t,n=!1){if(!this.openerService)return;const{link:i}=e;i.resolve(TG.None).then((e=>{if("string"==typeof e&&this.editor.hasModel()){const t=this.editor.getModel().uri;if(t.scheme===j$.file&&e.startsWith(`${j$.file}:`)){const n=_K.parse(e);if(n.scheme===j$.file){const i=wZ(n);let r=null;i.startsWith("/./")?r=`.${i.substr(1)}`:i.startsWith("//./")&&(r=`.${i.substr(2)}`),r&&(e=LZ(t,r))}}}return this.openerService.open(e,{openToSide:t,fromUserGesture:n,allowContributedOpeners:!0,allowCommands:!0})}),(e=>{const t=e instanceof Error?e.message:e;"invalid"===t?this.notificationService.warn(GH(0,"Failed to open this link because it is not well-formed: {0}",i.url.toString())):"missing"===t?this.notificationService.warn(GH(0,"Failed to open this link because its target is missing.")):nG(e)}))}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const n of t){const e=this.currentOccurrences[n.id];if(e)return e}return null}isEnabled(e,t){return Boolean(6===e.target.type&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){var e;this.timeout.cancel(),this.activeLinksList&&(null===(e=this.activeLinksList)||void 0===e||e.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){this.listenersToRemove.dispose(),this.stop(),this.timeout.dispose()}};lTe.ID="editor.linkDetector",lTe.RECOMPUTE_TIME=1e3,lTe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([rTe(1,ZZ),rTe(2,g4)],lTe);function cTe(e,t){const n=t.filter((t=>!e.find((e=>e.equals(t)))));if(n.length>=1){const e=n.map((e=>`line ${e.viewState.position.lineNumber} column ${e.viewState.position.column}`)).join(", ");n5(1===n.length?GH(0,"Cursor added: {0}",e):GH(0,"Cursors added: {0}",e))}}d6(lTe.ID,lTe),c6(class extends o6{constructor(){super({id:"editor.action.openLink",label:GH(0,"Open Link"),alias:"Open Link",precondition:void 0})}run(e,t){let n=lTe.get(t);if(!n)return;if(!t.hasModel())return;let i=t.getSelections();for(let r of i){let e=n.getLinkOccurrence(r.getEndPosition());e&&n.openLinkOccurrence(e,!1)}}}),G5(((e,t)=>{const n=e.getColor(Gte);n&&t.addRule(`.monaco-editor .detected-link-active { color: ${n} !important; }`)}));class uTe{constructor(e,t,n){this.selections=e,this.revealRange=t,this.revealScrollType=n}}class hTe{constructor(e,t,n,i,r,o,s){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=n,this.searchText=i,this.wholeWord=r,this.matchCase=o,this.currentMatch=s}static create(e,t){if(!e.hasModel())return null;const n=t.getState();if(!e.hasTextFocus()&&n.isRevealed&&n.searchString.length>0)return new hTe(e,t,!1,n.searchString,n.wholeWord,n.matchCase,null);let i,r,o=!1;const s=e.getSelections();1===s.length&&s[0].isEmpty()?(o=!0,i=!0,r=!0):(i=n.wholeWord,r=n.matchCase);const a=e.getSelection();let l,c=null;if(a.isEmpty()){const t=e.getConfiguredWordAtPosition(a.getStartPosition());if(!t)return null;l=t.word,c=new MK(a.startLineNumber,t.startColumn,a.startLineNumber,t.endColumn)}else l=e.getModel().getValueInRange(a).replace(/\r\n/g,"\n");return new hTe(e,t,o,l,i,r,c)}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new uTe(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new uTe(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],n=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(114):null,!1);return n?new MK(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new uTe(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new uTe(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],n=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(114):null,!1);return n?new MK(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn):null}selectAll(){return this._editor.hasModel()?(this.findController.highlightFindOptions(),this._editor.getModel().findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(114):null,!1,1073741824)):[]}}class dTe extends mG{constructor(e){super(),this._sessionDispose=this._register(new pG),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}static get(e){return e.getContribution(dTe.ID)}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=hTe.create(this._editor,e);if(!t)return;this._session=t;const n={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(n.wholeWordOverride=1,n.matchCaseOverride=1,n.isRegexOverride=2),e.getState().change(n,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e=>{this._ignoreSelectionChange||this._endSession()}))),this._sessionDispose.add(this._editor.onDidBlurEditorText((()=>{this._endSession()}))),this._sessionDispose.add(e.getState().onFindReplaceStateChange((e=>{(e.matchCase||e.wholeWord)&&this._endSession()})))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const n=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return n?new MK(t.startLineNumber,n.startColumn,t.startLineNumber,n.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const n=e.getState().matchCase;if(!mTe(this._editor.getModel(),t,n)){const e=this._editor.getModel();let n=[];for(let i=0,r=t.length;i<r;i++)n[i]=this._expandEmptyToWord(e,t[i]);return void this._editor.setSelections(n)}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const n=e.getState();if(n.isRevealed&&n.searchString.length>0&&n.isRegex)t=this._editor.getModel().findMatches(n.searchString,!0,n.isRegex,n.matchCase,n.wholeWord?this._editor.getOption(114):null,!1,1073741824);else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll()}if(n.searchScope){const e=n.searchScope;let i=[];t.forEach((t=>{e.forEach((e=>{t.range.endLineNumber<=e.endLineNumber&&t.range.startLineNumber>=e.startLineNumber&&i.push(t)}))})),t=i}if(t.length>0){const e=this._editor.getSelection();for(let n=0,i=t.length;n<i;n++){const i=t[n];if(i.range.intersectRanges(e)){t[n]=t[0],t[0]=i;break}}this._setSelections(t.map((e=>new MK(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn))))}}}dTe.ID="editor.contrib.multiCursorController";class fTe extends o6{run(e,t){const n=dTe.get(t);if(!n)return;const i=LNe.get(t);if(!i)return;const r=t._getViewModel();if(r){const e=r.getCursorStates();this._run(n,i),cTe(e,r.getCursorStates())}}}class gTe{constructor(e,t,n,i){this.searchText=e,this.matchCase=t,this.wordSeparators=n,this.modelVersionId=i}static softEquals(e,t){return!e&&!t||!(!e||!t)&&(e.searchText===t.searchText&&e.matchCase===t.matchCase&&e.wordSeparators===t.wordSeparators&&e.modelVersionId===t.modelVersionId)}}class pTe extends mG{constructor(e){super(),this.editor=e,this._isEnabled=e.getOption(95),this.decorations=[],this.updateSoon=this._register(new z$((()=>this._update()),300)),this.state=null,this._register(e.onDidChangeConfiguration((t=>{this._isEnabled=e.getOption(95)}))),this._register(e.onDidChangeCursorSelection((e=>{this._isEnabled&&(e.selection.isEmpty()?3===e.reason?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())}))),this._register(e.onDidChangeModel((e=>{this._setState(null)}))),this._register(e.onDidChangeModelContent((e=>{this._isEnabled&&this.updateSoon.schedule()}))),this._register(LNe.get(e).getState().onFindReplaceStateChange((e=>{this._update()})))}_update(){this._setState(pTe._createState(this._isEnabled,this.editor))}static _createState(e,t){if(!e)return null;if(!t.hasModel())return null;const n=t.getSelection();if(n.startLineNumber!==n.endLineNumber)return null;const i=dTe.get(t);if(!i)return null;const r=LNe.get(t);if(!r)return null;let o=i.getSession(r);if(!o){const e=t.getSelections();if(e.length>1){const n=r.getState().matchCase;if(!mTe(t.getModel(),e,n))return null}o=hTe.create(t,r)}if(!o)return null;if(o.currentMatch)return null;if(/^[ \t]+$/.test(o.searchText))return null;if(o.searchText.length>200)return null;const s=r.getState(),a=s.matchCase;if(s.isRevealed){let e=s.searchString;a||(e=e.toLowerCase());let t=o.searchText;if(a||(t=t.toLowerCase()),e===t&&o.matchCase===s.matchCase&&o.wholeWord===s.wholeWord&&!s.isRegex)return null}return new gTe(o.searchText,o.matchCase,o.wholeWord?t.getOption(114):null,t.getModel().getVersionId())}_setState(e){if(gTe.softEquals(this.state,e))return void(this.state=e);if(this.state=e,!this.state)return void(this.decorations=this.editor.deltaDecorations(this.decorations,[]));if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const n=TJ.has(t)&&this.editor.getOption(69);let i=t.findMatches(this.state.searchText,!0,!1,this.state.matchCase,this.state.wordSeparators,!1).map((e=>e.range));i.sort(TK.compareRangesUsingStarts);let r=this.editor.getSelections();r.sort(TK.compareRangesUsingStarts);let o=[];for(let a=0,l=0,c=i.length,u=r.length;a<c;){const e=i[a];if(l>=u)o.push(e),a++;else{const t=TK.compareRangesUsingStarts(e,r[l]);t<0?(!r[l].isEmpty()&&TK.areIntersecting(e,r[l])||o.push(e),a++):(t>0||a++,l++)}}const s=o.map((e=>({range:e,options:n?pTe._SELECTION_HIGHLIGHT:pTe._SELECTION_HIGHLIGHT_OVERVIEW})));this.decorations=this.editor.deltaDecorations(this.decorations,s)}dispose(){this._setState(null),super.dispose()}}function mTe(e,t,n){const i=vTe(e,t[0],!n);for(let r=1,o=t.length;r<o;r++){const o=t[r];if(o.isEmpty())return!1;if(i!==vTe(e,o,!n))return!1}return!0}function vTe(e,t,n){const i=e.getValueInRange(t);return n?i.toLowerCase():i}pTe.ID="editor.contrib.selectionHighlighter",pTe._SELECTION_HIGHLIGHT_OVERVIEW=v7.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:V5(Vne),position:wQ.Center}}),pTe._SELECTION_HIGHLIGHT=v7.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),d6(dTe.ID,dTe),d6(pTe.ID,pTe),c6(class extends o6{constructor(){super({id:"editor.action.insertCursorAbove",label:GH(0,"Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:gre.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"3_multi",title:GH(0,"&&Add Cursor Above"),order:2}})}run(e,t,n){if(!t.hasModel())return;const i=n&&!0===n.logicalLine,r=t._getViewModel();if(r.cursorConfig.readOnly)return;r.pushStackElement();const o=r.getCursorStates();r.setCursorStates(n.source,3,tre.addCursorUp(r,o,i)),r.revealTopMostCursor(n.source),cTe(o,r.getCursorStates())}}),c6(class extends o6{constructor(){super({id:"editor.action.insertCursorBelow",label:GH(0,"Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:gre.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"3_multi",title:GH(0,"A&&dd Cursor Below"),order:3}})}run(e,t,n){if(!t.hasModel())return;const i=n&&!0===n.logicalLine,r=t._getViewModel();if(r.cursorConfig.readOnly)return;r.pushStackElement();const o=r.getCursorStates();r.setCursorStates(n.source,3,tre.addCursorDown(r,o,i)),r.revealBottomMostCursor(n.source),cTe(o,r.getCursorStates())}}),c6(class extends o6{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:GH(0,"Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:gre.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"3_multi",title:GH(0,"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,n){if(!e.isEmpty()){for(let i=e.startLineNumber;i<e.endLineNumber;i++){let e=t.getLineMaxColumn(i);n.push(new MK(i,e,i,e))}e.endColumn>1&&n.push(new MK(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const n=t.getModel(),i=t.getSelections(),r=t._getViewModel(),o=r.getCursorStates();let s=[];i.forEach((e=>this.getCursorsForSelection(e,n,s))),s.length>0&&t.setSelections(s),cTe(o,r.getCursorStates())}}),c6(class extends fTe{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:GH(0,"Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:2082,weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"3_multi",title:GH(0,"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}),c6(class extends fTe{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:GH(0,"Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"3_multi",title:GH(0,"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}),c6(class extends fTe{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:GH(0,"Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:VG(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}),c6(class extends fTe{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:GH(0,"Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}),c6(class extends fTe{constructor(){super({id:"editor.action.selectHighlights",label:GH(0,"Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:3114,weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"3_multi",title:GH(0,"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}),c6(class extends fTe{constructor(){super({id:"editor.action.changeAll",label:GH(0,"Change All Occurrences"),alias:"Change All Occurrences",precondition:g5.and(gre.writable,gre.editorTextFocus),kbOpts:{kbExpr:gre.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}),c6(class extends o6{constructor(){super({id:"editor.action.addCursorsToBottom",label:GH(0,"Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const n=t.getSelections(),i=t.getModel().getLineCount();let r=[];for(let a=n[0].startLineNumber;a<=i;a++)r.push(new MK(a,n[0].startColumn,a,n[0].endColumn));const o=t._getViewModel(),s=o.getCursorStates();r.length>0&&t.setSelections(r),cTe(s,o.getCursorStates())}}),c6(class extends o6{constructor(){super({id:"editor.action.addCursorsToTop",label:GH(0,"Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const n=t.getSelections();let i=[];for(let s=n[0].startLineNumber;s>=1;s--)i.push(new MK(s,n[0].startColumn,s,n[0].endColumn));const r=t._getViewModel(),o=r.getCursorStates();i.length>0&&t.setSelections(i),cTe(o,r.getCursorStates())}});var yTe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const _Te={Visible:new M5("parameterHintsVisible",!1),MultipleSignatures:new M5("parameterHintsMultipleSignatures",!1)};function bTe(e,t,n,i){return yTe(this,void 0,void 0,(function*(){const r=DJ.ordered(e);for(const s of r)try{const r=yield s.provideSignatureHelp(e,t,i,n);if(r)return r}catch(o){iG(o)}}))}qZ.registerCommand("_executeSignatureHelpProvider",((e,...t)=>yTe(void 0,void 0,void 0,(function*(){const[n,i,r]=t;WZ(_K.isUri(n)),WZ(IK.isIPosition(i)),WZ("string"==typeof r||!r);const o=yield e.get(n0).createModelReference(n);try{const e=yield bTe(o.object.textEditorModel,IK.lift(i),{triggerKind:_J.Invoke,isRetrigger:!1,triggerCharacter:r},TG.None);if(!e)return;return setTimeout((()=>e.dispose()),0),e.value}finally{o.dispose()}}))));var wTe,CTe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};!function(e){e.Default={type:0};e.Pending=class{constructor(e,t){this.request=e,this.previouslyActiveHints=t,this.type=2}};e.Active=class{constructor(e){this.hints=e,this.type=1}}}(wTe||(wTe={}));class STe extends mG{constructor(e,t=STe.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new EG),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=wTe.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new vG),this.triggerChars=new p1,this.retriggerChars=new p1,this.triggerId=0,this.editor=e,this.throttledDelayer=new A$(t),this._register(this.editor.onDidBlurEditorWidget((()=>this.cancel()))),this._register(this.editor.onDidChangeConfiguration((()=>this.onEditorConfigurationChange()))),this._register(this.editor.onDidChangeModel((e=>this.onModelChanged()))),this._register(this.editor.onDidChangeModelLanguage((e=>this.onModelChanged()))),this._register(this.editor.onDidChangeCursorSelection((e=>this.onCursorChange(e)))),this._register(this.editor.onDidChangeModelContent((e=>this.onModelContentChange()))),this._register(DJ.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType((e=>this.onDidType(e)))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(e){2===this._state.type&&this._state.request.cancel(),this._state=e}cancel(e=!1){this.state=wTe.Default,this.throttledDelayer.cancel(),e||this._onChangedHints.fire(void 0)}trigger(e,t){const n=this.editor.getModel();if(!n||!DJ.has(n))return;const i=++this.triggerId;this._pendingTriggers.push(e),this.throttledDelayer.trigger((()=>this.doTrigger(i)),t).catch(nG)}next(){if(1!==this.state.type)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,n=t%e==e-1,i=this.editor.getOption(73).cycle;!(e<2||n)||i?this.updateActiveSignature(n&&i?0:t+1):this.cancel()}previous(){if(1!==this.state.type)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,n=0===t,i=this.editor.getOption(73).cycle;!(e<2||n)||i?this.updateActiveSignature(n&&i?e-1:t-1):this.cancel()}updateActiveSignature(e){1===this.state.type&&(this.state=new wTe.Active(Object.assign(Object.assign({},this.state.hints),{activeSignature:e})),this._onChangedHints.fire(this.state.hints))}doTrigger(e){return CTe(this,void 0,void 0,(function*(){const t=1===this.state.type||2===this.state.type,n=this.getLastActiveHints();if(this.cancel(!0),0===this._pendingTriggers.length)return!1;const i=this._pendingTriggers.reduce(xTe);this._pendingTriggers=[];const r={triggerKind:i.triggerKind,triggerCharacter:i.triggerCharacter,isRetrigger:t,activeSignatureHelp:n};if(!this.editor.hasModel())return!1;const o=this.editor.getModel(),s=this.editor.getPosition();this.state=new wTe.Pending(I$((e=>bTe(o,s,r,e))),n);try{const t=yield this.state.request;return e!==this.triggerId?(null==t||t.dispose(),!1):t&&t.value.signatures&&0!==t.value.signatures.length?(this.state=new wTe.Active(t.value),this._lastSignatureHelpResult.value=t,this._onChangedHints.fire(this.state.hints),!0):(null==t||t.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1)}catch(a){return e===this.triggerId&&(this.state=wTe.Default),nG(a),!1}}))}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return 1===this.state.type||2===this.state.type||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars=new p1,this.retriggerChars=new p1;const e=this.editor.getModel();if(e)for(const t of DJ.ordered(e)){for(const e of t.signatureHelpTriggerCharacters||[])this.triggerChars.add(e.charCodeAt(0)),this.retriggerChars.add(e.charCodeAt(0));for(const e of t.signatureHelpRetriggerCharacters||[])this.retriggerChars.add(e.charCodeAt(0))}}onDidType(e){if(!this.triggerOnType)return;const t=e.length-1,n=e.charCodeAt(t);(this.triggerChars.has(n)||this.isTriggered&&this.retriggerChars.has(n))&&this.trigger({triggerKind:_J.TriggerCharacter,triggerCharacter:e.charAt(t)})}onCursorChange(e){"mouse"===e.source?this.cancel():this.isTriggered&&this.trigger({triggerKind:_J.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:_J.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(73).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}}function xTe(e,t){switch(t.triggerKind){case _J.Invoke:return t;case _J.ContentChange:return e;case _J.TriggerCharacter:default:return t}}STe.DEFAULT_DELAY=120;var ETe=function(e,t){return function(n,i){t(n,i,e)}};const kTe=GY,LTe=Ele("parameter-hints-next",hJ.chevronDown,GH(0,"Icon for show next parameter hint.")),DTe=Ele("parameter-hints-previous",hJ.chevronUp,GH(0,"Icon for show previous parameter hint."));let NTe=class e extends mG{constructor(e,t,n,i){super(),this.editor=e,this.renderDisposeables=this._register(new pG),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new RCe({editor:e},i,n)),this.model=this._register(new STe(e)),this.keyVisible=_Te.Visible.bindTo(t),this.keyMultipleSignatures=_Te.MultipleSignatures.bindTo(t),this._register(this.model.onChangedHints((e=>{e?(this.show(),this.render(e)):this.hide()})))}createParamaterHintDOMNodes(){const e=kTe(".editor-widget.parameter-hints-widget"),t=WY(e,kTe(".phwrapper"));t.tabIndex=-1;const n=WY(t,kTe(".controls")),i=WY(n,kTe(".button"+z5.asCSSSelector(DTe))),r=WY(n,kTe(".overloads")),o=WY(n,kTe(".button"+z5.asCSSSelector(LTe)));this._register(Q$(i,"click",(e=>{PY(e),this.previous()}))),this._register(Q$(o,"click",(e=>{PY(e),this.next()})));const s=kTe(".body"),a=new moe(s,{});this._register(a),t.appendChild(a.getDomNode());const l=WY(s,kTe(".signature")),c=WY(s,kTe(".docs"));e.style.userSelect="text",this.domNodes={element:e,signature:l,overloads:r,docs:c,scrollbar:a},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection((e=>{this.visible&&this.editor.layoutContentWidget(this)})));const u=()=>{if(!this.domNodes)return;const e=this.editor.getOption(40);this.domNodes.element.style.fontSize=`${e.fontSize}px`};u(),this._register(SG.chain(this.editor.onDidChangeConfiguration.bind(this.editor)).filter((e=>e.hasChanged(40))).on(u,null)),this._register(this.editor.onDidLayoutChange((e=>this.updateMaxHeight()))),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParamaterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout((()=>{this.domNodes&&this.domNodes.element.classList.add("visible")}),100),this.editor.layoutContentWidget(this))}hide(){this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,this.domNodes&&this.domNodes.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(e){var t;if(this.renderDisposeables.clear(),!this.domNodes)return;const n=e.signatures.length>1;this.domNodes.element.classList.toggle("multiple",n),this.keyMultipleSignatures.set(n),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const i=e.signatures[e.activeSignature];if(!i)return;const r=WY(this.domNodes.signature,kTe(".code")),o=this.editor.getOption(40);r.style.fontSize=`${o.fontSize}px`,r.style.fontFamily=o.fontFamily;const s=i.parameters.length>0,a=null!==(t=i.activeParameter)&&void 0!==t?t:e.activeParameter;if(s)this.renderParameters(r,i,a);else{WY(r,kTe("span")).textContent=i.label}const l=i.parameters[a];if(null==l?void 0:l.documentation){const e=kTe("span.documentation");if("string"==typeof l.documentation)e.textContent=l.documentation;else{const t=this.renderMarkdownDocs(l.documentation);e.appendChild(t.element)}WY(this.domNodes.docs,kTe("p",{},e))}if(void 0===i.documentation);else if("string"==typeof i.documentation)WY(this.domNodes.docs,kTe("p",{},i.documentation));else{const e=this.renderMarkdownDocs(i.documentation);WY(this.domNodes.docs,e.element)}const c=this.hasDocs(i,l);if(this.domNodes.signature.classList.toggle("has-docs",c),this.domNodes.docs.classList.toggle("empty",!c),this.domNodes.overloads.textContent=String(e.activeSignature+1).padStart(e.signatures.length.toString().length,"0")+"/"+e.signatures.length,l){const e=this.getParameterLabel(i,a);this.announcedLabel!==e&&(t5(GH(0,"{0}, hint",e)),this.announcedLabel=e)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(e){const t=this.renderDisposeables.add(this.markdownRenderer.render(e,{asyncRenderCallback:()=>{var e;null===(e=this.domNodes)||void 0===e||e.scrollbar.scanDomNode()}}));return t.element.classList.add("markdown-docs"),t}hasDocs(e,t){return!!(t&&"string"==typeof t.documentation&&zZ(t.documentation).length>0)||(!!(t&&"object"==typeof t.documentation&&zZ(t.documentation).value.length>0)||(!!(e.documentation&&"string"==typeof e.documentation&&zZ(e.documentation).length>0)||!!(e.documentation&&"object"==typeof e.documentation&&zZ(e.documentation.value).length>0)))}renderParameters(e,t,n){const[i,r]=this.getParameterLabelOffsets(t,n),o=document.createElement("span");o.textContent=t.label.substring(0,i);const s=document.createElement("span");s.textContent=t.label.substring(i,r),s.className="parameter active";const a=document.createElement("span");a.textContent=t.label.substring(r),WY(e,o,s,a)}getParameterLabel(e,t){const n=e.parameters[t];return Array.isArray(n.label)?e.label.substring(n.label[0],n.label[1]):n.label}getParameterLabelOffsets(e,t){const n=e.parameters[t];if(n){if(Array.isArray(n.label))return n.label;if(n.label.length){const t=new RegExp(`(\\W|^)${rX(n.label)}(?=\\W|$)`,"g");t.test(e.label);const i=t.lastIndex-n.label.length;return i>=0?[i,t.lastIndex]:[0,0]}return[0,0]}return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}cancel(){this.model.cancel()}getDomNode(){return this.domNodes||this.createParamaterHintDOMNodes(),this.domNodes.element}getId(){return e.ID}trigger(e){this.model.trigger(e,0)}updateMaxHeight(){if(!this.domNodes)return;const e=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=e;const t=this.domNodes.element.getElementsByClassName("phwrapper");t.length&&(t[0].style.maxHeight=e)}};NTe.ID="editor.widget.parameterHintsWidget",NTe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ETe(1,A5),ETe(2,ZZ),ETe(3,t0)],NTe),G5(((e,t)=>{const n=e.getColor(Hte);if(n){const i=e.type===P5.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .parameter-hints-widget { border: ${i}px solid ${n}; }`),t.addRule(`.monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid ${n.transparent(.5)}; }`),t.addRule(`.monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid ${n.transparent(.5)}; }`)}const i=e.getColor(Vte);i&&t.addRule(`.monaco-editor .parameter-hints-widget { background-color: ${i}; }`);const r=e.getColor(kee);r&&t.addRule(`.monaco-editor .parameter-hints-widget a { color: ${r}; }`);const o=e.getColor(Ute);o&&t.addRule(`.monaco-editor .parameter-hints-widget { color: ${o}; }`);const s=e.getColor(Dee);s&&t.addRule(`.monaco-editor .parameter-hints-widget code { background-color: ${s}; }`)}));let ITe=class e extends mG{constructor(e,t){super(),this.editor=e,this.widget=this._register(t.createInstance(NTe,this.editor))}static get(t){return t.getContribution(e.ID)}cancel(){this.widget.cancel()}previous(){this.widget.previous()}next(){this.widget.next()}trigger(e){this.widget.trigger(e)}};ITe.ID="editor.controller.parameterHints",ITe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,t$)],ITe);d6(ITe.ID,ITe),c6(class extends o6{constructor(){super({id:"editor.action.triggerParameterHints",label:GH(0,"Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:gre.hasSignatureHelpProvider,kbOpts:{kbExpr:gre.editorTextFocus,primary:3082,weight:100}})}run(e,t){const n=ITe.get(t);n&&n.trigger({triggerKind:_J.Invoke})}});const TTe=r6.bindToContribution(ITe.get);l6(new TTe({id:"closeParameterHints",precondition:_Te.Visible,handler:e=>e.cancel(),kbOpts:{weight:175,kbExpr:gre.focus,primary:9,secondary:[1033]}})),l6(new TTe({id:"showPrevParameterHint",precondition:g5.and(_Te.Visible,_Te.MultipleSignatures),handler:e=>e.previous(),kbOpts:{weight:175,kbExpr:gre.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}})),l6(new TTe({id:"showNextParameterHint",precondition:g5.and(_Te.Visible,_Te.MultipleSignatures),handler:e=>e.next(),kbOpts:{weight:175,kbExpr:gre.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));var MTe=function(e,t){return function(n,i){t(n,i,e)}};const ATe=new M5("renameInputVisible",!1,GH(0,"Whether the rename input widget is visible"));let OTe=class{constructor(e,t,n,i,r){this._editor=e,this._acceptKeybindings=t,this._themeService=n,this._keybindingService=i,this._disposables=new pG,this.allowEditorOverflow=!0,this._visibleContextKey=ATe.bindTo(r),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(40)&&this._updateFont()}))),this._disposables.add(n.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){if(!this._domNode){this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._input=document.createElement("input"),this._input.className="rename-input",this._input.type="text",this._input.setAttribute("aria-label",GH(0,"Rename input. Type new name and press Enter to commit.")),this._domNode.appendChild(this._input),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label);const e=()=>{var e,t;const[n,i]=this._acceptKeybindings;this._keybindingService.lookupKeybinding(n),this._label.innerText=GH(0,"{0} to Rename, {1} to Preview",null===(e=this._keybindingService.lookupKeybinding(n))||void 0===e?void 0:e.getLabel(),null===(t=this._keybindingService.lookupKeybinding(i))||void 0===t?void 0:t.getLabel())};e(),this._disposables.add(this._keybindingService.onDidUpdateKeybindings(e)),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())}return this._domNode}_updateStyles(e){var t,n,i,r;if(!this._input||!this._domNode)return;const o=e.getColor(Nee);this._domNode.style.backgroundColor=String(null!==(t=e.getColor(mte))&&void 0!==t?t:""),this._domNode.style.boxShadow=o?` 0 0 8px 2px ${o}`:"",this._domNode.style.color=String(null!==(n=e.getColor(Tee))&&void 0!==n?n:""),this._input.style.backgroundColor=String(null!==(i=e.getColor(Iee))&&void 0!==i?i:"");const s=e.getColor(Mee);this._input.style.borderWidth=s?"1px":"0px",this._input.style.borderStyle=s?"solid":"none",this._input.style.borderColor=null!==(r=null==s?void 0:s.toString())&&void 0!==r?r:"none"}_updateFont(){if(!this._input||!this._label)return;const e=this._editor.getOption(40);this._input.style.fontFamily=e.fontFamily,this._input.style.fontWeight=e.fontWeight,this._input.style.fontSize=`${e.fontSize}px`,this._label.style.fontSize=.8*e.fontSize+"px"}getPosition(){return this._visible?{position:this._position,preference:[2,1]}:null}afterRender(e){e||this.cancelInput(!0)}acceptInput(e){this._currentAcceptInput&&this._currentAcceptInput(e)}cancelInput(e){this._currentCancelInput&&this._currentCancelInput(e)}getInput(e,t,n,i,r,o){this._domNode.classList.toggle("preview",r),this._position=new IK(e.startLineNumber,e.startColumn),this._input.value=t,this._input.setAttribute("selectionStart",n.toString()),this._input.setAttribute("selectionEnd",i.toString()),this._input.size=Math.max(1.1*(e.endColumn-e.startColumn),20);const s=new pG;return new Promise((e=>{this._currentCancelInput=t=>(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,e(t),!0),this._currentAcceptInput=n=>{0!==this._input.value.trim().length&&this._input.value!==t?(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,e({newName:this._input.value,wantsPreview:r&&n})):this.cancelInput(!0)},o.onCancellationRequested((()=>this.cancelInput(!0))),s.add(this._editor.onDidBlurEditorWidget((()=>this.cancelInput(!1)))),this._show()})).finally((()=>{s.dispose(),this._hide()}))}_show(){this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout((()=>{this._input.focus(),this._input.setSelectionRange(parseInt(this._input.getAttribute("selectionStart")),parseInt(this._input.getAttribute("selectionEnd")))}),100)}_hide(){this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}};OTe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([MTe(2,B5),MTe(3,gce),MTe(4,A5)],OTe);var RTe=function(e,t){return function(n,i){t(n,i,e)}},PTe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class FTe{constructor(e,t){this.model=e,this.position=t,this._providerRenameIdx=0,this._providers=EJ.ordered(e)}hasProvider(){return this._providers.length>0}resolveRenameLocation(e){return PTe(this,void 0,void 0,(function*(){const t=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const n=this._providers[this._providerRenameIdx];if(!n.resolveRenameLocation)break;let i=yield n.resolveRenameLocation(this.model,this.position,e);if(i){if(!i.rejectReason)return i;t.push(i.rejectReason)}}const n=this.model.getWordAtPosition(this.position);return n?{range:new TK(this.position.lineNumber,n.startColumn,this.position.lineNumber,n.endColumn),text:n.word,rejectReason:t.length>0?t.join("\n"):void 0}:{range:TK.fromPositions(this.position),text:"",rejectReason:t.length>0?t.join("\n"):void 0}}))}provideRenameEdits(e,t){return PTe(this,void 0,void 0,(function*(){return this._provideRenameEdits(e,this._providerRenameIdx,[],t)}))}_provideRenameEdits(e,t,n,i){return PTe(this,void 0,void 0,(function*(){const r=this._providers[t];if(!r)return{edits:[],rejectReason:n.join("\n")};const o=yield r.provideRenameEdits(this.model,this.position,e,i);return o?o.rejectReason?this._provideRenameEdits(e,t+1,n.concat(o.rejectReason),i):o:this._provideRenameEdits(e,t+1,n.concat(GH(0,"No result.")),i)}))}}let BTe=class e{constructor(e,t,n,i,r,o,s){this.editor=e,this._instaService=t,this._notificationService=n,this._bulkEditService=i,this._progressService=r,this._logService=o,this._configService=s,this._dispoableStore=new pG,this._cts=new OG,this._renameInputField=this._dispoableStore.add(new U$((()=>this._dispoableStore.add(this._instaService.createInstance(OTe,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"])))))}static get(t){return t.getContribution(e.ID)}dispose(){this._dispoableStore.dispose(),this._cts.dispose(!0)}run(){return PTe(this,void 0,void 0,(function*(){if(this._cts.dispose(!0),!this.editor.hasModel())return;const e=this.editor.getPosition(),t=new FTe(this.editor.getModel(),e);if(!t.hasProvider())return;let n;this._cts=new gle(this.editor,5);try{const e=t.resolveRenameLocation(this._cts.token);this._progressService.showWhile(e,250),n=yield e}catch(zWe){return void mbe.get(this.editor).showMessage(zWe||GH(0,"An unknown error occurred while resolving rename location"),e)}if(!n)return;if(n.rejectReason)return void mbe.get(this.editor).showMessage(n.rejectReason,e);if(this._cts.token.isCancellationRequested)return;this._cts.dispose(),this._cts=new gle(this.editor,5,n.range);let i=this.editor.getSelection(),r=0,o=n.text.length;TK.isEmpty(i)||TK.spansMultipleLines(i)||!TK.containsRange(n.range,i)||(r=Math.max(0,i.startColumn-n.range.startColumn),o=Math.min(n.range.endColumn,i.endColumn)-n.range.startColumn);const s=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),a=yield this._renameInputField.value.getInput(n.range,n.text,r,o,s,this._cts.token);if("boolean"==typeof a)return void(a&&this.editor.focus());this.editor.focus();const l=T$(t.provideRenameEdits(a.newName,this._cts.token),this._cts.token).then((e=>PTe(this,void 0,void 0,(function*(){e&&this.editor.hasModel()&&(e.rejectReason?this._notificationService.info(e.rejectReason):this._bulkEditService.apply(c3.convert(e),{editor:this.editor,showPreview:a.wantsPreview,label:GH(0,"Renaming '{0}'",null==n?void 0:n.text),quotableLabel:GH(0,"Renaming {0}",null==n?void 0:n.text)}).then((e=>{e.ariaSummary&&t5(GH(0,"Successfully renamed '{0}' to '{1}'. Summary: {2}",n.text,a.newName,e.ariaSummary))})).catch((e=>{this._notificationService.error(GH(0,"Rename failed to apply edits")),this._logService.error(e)})))}))),(e=>{this._notificationService.error(GH(0,"Rename failed to compute edits")),this._logService.error(e)}));return this._progressService.showWhile(l,250),l}))}acceptRenameInput(e){this._renameInputField.value.acceptInput(e)}cancelRenameInput(){this._renameInputField.value.cancelInput(!0)}};BTe.ID="editor.contrib.renameController",BTe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([RTe(1,t$),RTe(2,g4),RTe(3,l3),RTe(4,jle),RTe(5,K1),RTe(6,E1)],BTe);d6(BTe.ID,BTe),c6(class extends o6{constructor(){super({id:"editor.action.rename",label:GH(0,"Rename Symbol"),alias:"Rename Symbol",precondition:g5.and(gre.writable,gre.hasRenameProvider),kbOpts:{kbExpr:gre.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1}})}runCommand(e,t){const n=e.get(o$),[i,r]=Array.isArray(t)&&t||[void 0,void 0];return _K.isUri(i)&&IK.isIPosition(r)?n.openCodeEditor({resource:i},n.getActiveCodeEditor()).then((e=>{e&&(e.setPosition(r),e.invokeWithinContext((t=>(this.reportTelemetry(t,e),this.run(t,e)))))}),nG):super.runCommand(e,t)}run(e,t){const n=BTe.get(t);return n?n.run():Promise.resolve()}});const WTe=r6.bindToContribution(BTe.get);l6(new WTe({id:"acceptRenameInput",precondition:ATe,handler:e=>e.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:gre.focus,primary:3}})),l6(new WTe({id:"acceptRenameInputWithPreview",precondition:g5.and(ATe,g5.has("config.editor.rename.enablePreview")),handler:e=>e.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:gre.focus,primary:1027}})),l6(new WTe({id:"cancelRenameInput",precondition:ATe,handler:e=>e.cancelRenameInput(),kbOpts:{weight:199,kbExpr:gre.focus,primary:9,secondary:[1033]}})),a6("_executeDocumentRenameProvider",(function(e,t,...n){const[i]=n;return WZ("string"==typeof i),function(e,t,n){return PTe(this,void 0,void 0,(function*(){const i=new FTe(e,t),r=yield i.resolveRenameLocation(TG.None);return(null==r?void 0:r.rejectReason)?{edits:[],rejectReason:r.rejectReason}:i.provideRenameEdits(n,TG.None)}))}(e,t,i)})),d3.as(p3).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:5,description:GH(0,"Enable/disable the ability to preview changes before renaming"),default:!0,type:"boolean"}}});var zTe,VTe,UTe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class HTe{constructor(e,t){this.index=e,this.ranges=t}mov(e){let t=this.index+(e?1:-1);if(t<0||t>=this.ranges.length)return this;const n=new HTe(t,this.ranges);return n.ranges[t].equalsRange(this.ranges[this.index])?n.mov(e):n}}class jTe{constructor(e){this._editor=e,this._ignoreSelection=!1}static get(e){return e.getContribution(jTe.ID)}dispose(){var e;null===(e=this._selectionListener)||void 0===e||e.dispose()}run(e){return UTe(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return;const t=this._editor.getSelections(),n=this._editor.getModel();if(!GJ.has(n))return;if(this._state||(yield KTe(n,t.map((e=>e.getPosition())),this._editor.getOption(100),TG.None).then((e=>{var n;if(R1(e)&&e.length===t.length&&this._editor.hasModel()&&D1(this._editor.getSelections(),t,((e,t)=>e.equalsSelection(t)))){for(let n=0;n<e.length;n++)e[n]=e[n].filter((e=>e.containsPosition(t[n].getStartPosition())&&e.containsPosition(t[n].getEndPosition()))),e[n].unshift(t[n]);this._state=e.map((e=>new HTe(0,e))),null===(n=this._selectionListener)||void 0===n||n.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition((()=>{var e;this._ignoreSelection||(null===(e=this._selectionListener)||void 0===e||e.dispose(),this._state=void 0)}))}}))),!this._state)return;this._state=this._state.map((t=>t.mov(e)));const i=this._state.map((e=>MK.fromPositions(e.ranges[e.index].getStartPosition(),e.ranges[e.index].getEndPosition())));this._ignoreSelection=!0;try{this._editor.setSelections(i)}finally{this._ignoreSelection=!1}}))}}jTe.ID="editor.contrib.smartSelectController";class GTe extends o6{constructor(e,t){super(t),this._forward=e}run(e,t){return UTe(this,void 0,void 0,(function*(){let e=jTe.get(t);e&&(yield e.run(this._forward))}))}}qZ.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");function KTe(e,t,n,i){return UTe(this,void 0,void 0,(function*(){const r=GJ.all(e);1===r.length&&r.unshift(new axe);let o=[],s=[];for(const n of r)o.push(Promise.resolve(n.provideSelectionRanges(e,t,i)).then((e=>{if(R1(e)&&e.length===t.length)for(let n=0;n<t.length;n++){s[n]||(s[n]=[]);for(const i of e[n])TK.isIRange(i.range)&&TK.containsPosition(i.range,t[n])&&s[n].push(TK.lift(i.range))}}),iG));return yield Promise.all(o),s.map((t=>{if(0===t.length)return[];t.sort(((e,t)=>IK.isBefore(e.getStartPosition(),t.getStartPosition())?1:IK.isBefore(t.getStartPosition(),e.getStartPosition())||IK.isBefore(e.getEndPosition(),t.getEndPosition())?-1:IK.isBefore(t.getEndPosition(),e.getEndPosition())?1:0));let i,r=[];for(const e of t)(!i||TK.containsRange(e,i)&&!TK.equalsRange(e,i))&&(r.push(e),i=e);if(!n.selectLeadingAndTrailingWhitespace)return r;let o=[r[0]];for(let n=1;n<r.length;n++){const t=r[n-1],i=r[n];if(i.startLineNumber!==t.startLineNumber||i.endLineNumber!==t.endLineNumber){const n=new TK(t.startLineNumber,e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.endLineNumber,e.getLineLastNonWhitespaceColumn(t.endLineNumber));n.containsRange(t)&&!n.equalsRange(t)&&i.containsRange(n)&&!i.equalsRange(n)&&o.push(n);const r=new TK(t.startLineNumber,1,t.endLineNumber,e.getLineMaxColumn(t.endLineNumber));r.containsRange(t)&&!r.equalsRange(n)&&i.containsRange(r)&&!i.equalsRange(r)&&o.push(r)}o.push(i)}return o}))}))}d6(jTe.ID,jTe),c6(class extends GTe{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:GH(0,"Expand Selection"),alias:"Expand Selection",precondition:void 0,kbOpts:{kbExpr:gre.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"1_basic",title:GH(0,"&&Expand Selection"),order:2}})}}),c6(class extends GTe{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:GH(0,"Shrink Selection"),alias:"Shrink Selection",precondition:void 0,kbOpts:{kbExpr:gre.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:Y5.MenubarSelectionMenu,group:"1_basic",title:GH(0,"&&Shrink Selection"),order:3}})}}),GJ.register("*",new class{provideSelectionRanges(e,t){const n=[];for(const i of t){const t=[];n.push(t),this._addInWordRanges(t,e,i),this._addWordRanges(t,e,i),this._addWhitespaceLine(t,e,i),t.push({range:e.getFullModelRange()})}return n}_addInWordRanges(e,t,n){const i=t.getWordAtPosition(n);if(!i)return;let{word:r,startColumn:o}=i,s=n.column-o,a=s,l=s,c=0;for(;a>=0;a--){let e=r.charCodeAt(a);if(a!==s&&(95===e||45===e))break;if(yX(e)&&_X(c))break;c=e}for(a+=1;l<r.length;l++){let e=r.charCodeAt(l);if(_X(e)&&yX(c))break;if(95===e||45===e)break;c=e}a<l&&e.push({range:new TK(n.lineNumber,o+a,n.lineNumber,o+l)})}_addWordRanges(e,t,n){const i=t.getWordAtPosition(n);i&&e.push({range:new TK(n.lineNumber,i.startColumn,n.lineNumber,i.endColumn)})}_addWhitespaceLine(e,t,n){t.getLineLength(n.lineNumber)>0&&0===t.getLineFirstNonWhitespaceColumn(n.lineNumber)&&0===t.getLineLastNonWhitespaceColumn(n.lineNumber)&&e.push({range:new TK(n.lineNumber,1,n.lineNumber,t.getLineMaxColumn(n.lineNumber))})}}),zTe="_executeSelectionRangeProvider",VTe=function(e,...t){const[n]=t;return KTe(e,n,{selectLeadingAndTrailingWhitespace:!0},TG.None)},qZ.registerCommand(zTe,(function(e,...t){const[n]=t;WZ(_K.isUri(n));const i=e.get(iJ).getModel(n);return i?VTe(i,...t.slice(1)):e.get(n0).createModelReference(n).then((e=>new Promise(((n,i)=>{try{n(VTe(e.object.textEditorModel,t.slice(1)))}catch(r){i(r)}})).finally((()=>{e.dispose()}))))}));c6(class extends o6{constructor(){super({id:"editor.action.forceRetokenize",label:GH(0,"Developer: Force Retokenize"),alias:"Developer: Force Retokenize",precondition:void 0})}run(e,t){if(!t.hasModel())return;const n=t.getModel();n.resetTokenization();const i=new CG(!0);n.forceTokenization(n.getLineCount()),i.stop(),console.log(`tokenization took ${i.elapsed()}`)}});class qTe extends o6{constructor(){super({id:qTe.ID,label:GH(0,"Toggle Tab Key Moves Focus"),alias:"Toggle Tab Key Moves Focus",precondition:void 0,kbOpts:{kbExpr:null,primary:2091,mac:{primary:1323},weight:100}})}run(e,t){const n=!N3.getTabFocusMode();N3.setTabFocusMode(n),t5(GH(0,n?"Pressing Tab will now move focus to the next focusable element":"Pressing Tab will now insert the tab character"))}}qTe.ID="editor.action.toggleTabFocusMode",c6(qTe);var $Te=function(e,t){return function(n,i){t(n,i,e)}},YTe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let XTe=class extends mG{constructor(e,t,n){super(),this._editor=e,this._dialogService=t,this._codeEditorService=n,this._config=this._editor.getOption(111),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(111)&&(this._config=this._editor.getOption(111),this._checkForUnusualLineTerminators())}))),this._register(this._editor.onDidChangeModel((()=>{this._checkForUnusualLineTerminators()}))),this._register(this._editor.onDidChangeModelContent((e=>{e.isUndoing||this._checkForUnusualLineTerminators()})))}_checkForUnusualLineTerminators(){return YTe(this,void 0,void 0,(function*(){if("off"===this._config)return;if(!this._editor.hasModel())return;const e=this._editor.getModel();if(!e.mightContainUnusualLineTerminators())return;if(!0===function(e,t){return e.getModelProperty(t.uri,"ignoreUnusualLineTerminators")}(this._codeEditorService,e))return;if(this._editor.getOption(78))return;if("auto"===this._config)return void e.removeUnusualLineTerminators(this._editor.getSelections());(yield this._dialogService.confirm({title:GH(0,"Unusual Line Terminators"),message:GH(0,"Detected unusual line terminators"),detail:GH(0,"The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",EZ(e.uri)),primaryButton:GH(0,"Remove Unusual Line Terminators"),secondaryButton:GH(0,"Ignore")})).confirmed?e.removeUnusualLineTerminators(this._editor.getSelections()):function(e,t,n){e.setModelProperty(t.uri,"ignoreUnusualLineTerminators",n)}(this._codeEditorService,e,!0)}))}};XTe.ID="editor.contrib.unusualLineTerminatorsDetector",XTe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([$Te(1,cde),$Te(2,o$)],XTe),d6(XTe.ID,XTe);var ZTe=function(e,t){return function(n,i){t(n,i,e)}};let QTe=class extends mG{constructor(e,t,n,i){super(),this._modelService=t,this._themeService=n,this._configurationService=i,this._editor=e,this._tokenizeViewport=new z$((()=>this._tokenizeViewportNow()),100),this._outstandingRequests=[],this._register(this._editor.onDidScrollChange((()=>{this._tokenizeViewport.schedule()}))),this._register(this._editor.onDidChangeModel((()=>{this._cancelAll(),this._tokenizeViewport.schedule()}))),this._register(this._editor.onDidChangeModelContent((e=>{this._cancelAll(),this._tokenizeViewport.schedule()}))),this._register($J.onDidChange((()=>{this._cancelAll(),this._tokenizeViewport.schedule()}))),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("editor.semanticHighlighting")&&(this._cancelAll(),this._tokenizeViewport.schedule())}))),this._register(this._themeService.onDidColorThemeChange((()=>{this._cancelAll(),this._tokenizeViewport.schedule()})))}_cancelAll(){for(const e of this._outstandingRequests)e.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(e){for(let t=0,n=this._outstandingRequests.length;t<n;t++)if(this._outstandingRequests[t]===e)return void this._outstandingRequests.splice(t,1)}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const e=this._editor.getModel();if(e.hasCompleteSemanticTokens())return;if(!uue(e,this._themeService,this._configurationService))return void(e.hasSomeSemanticTokens()&&e.setSemanticTokens(null,!1));const t=nue(e);if(!t)return void(e.hasSomeSemanticTokens()&&e.setSemanticTokens(null,!1));const n=this._modelService.getSemanticTokensProviderStyling(t),i=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(i.map((i=>this._requestRange(e,i,t,n))))}_requestRange(e,t,n,i){const r=e.getVersionId(),o=I$((i=>Promise.resolve(n.provideDocumentRangeSemanticTokens(e,t,i))));return o.then((n=>{n&&!e.isDisposed()&&e.getVersionId()===r&&e.setPartialSemanticTokens(t,$ce(n,i,e.getLanguageIdentifier()))})).then((()=>this._removeOutstandingRequest(o)),(()=>this._removeOutstandingRequest(o))),o}};QTe.ID="editor.contrib.viewportSemanticTokens",QTe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([ZTe(1,iJ),ZTe(2,B5),ZTe(3,j3)],QTe),d6(QTe.ID,QTe);const JTe=_ee("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hc:null},GH(0,"Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0),eMe=_ee("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hc:null},GH(0,"Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0),tMe=_ee("editor.wordHighlightBorder",{light:null,dark:null,hc:Eee},GH(0,"Border color of a symbol during read-access, like reading a variable.")),nMe=_ee("editor.wordHighlightStrongBorder",{light:null,dark:null,hc:Eee},GH(0,"Border color of a symbol during write-access, like writing to a variable.")),iMe=_ee("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hc:"#A0A0A0CC"},GH(0,"Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),rMe=_ee("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0CC",light:"#C0A0C0CC",hc:"#C0A0C0CC"},GH(0,"Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),oMe=new M5("hasWordHighlights",!1);function sMe(e,t,n){return F$(TJ.ordered(e).map((i=>()=>Promise.resolve(i.provideDocumentHighlights(e,t,n)).then(void 0,iG))),R1)}class aMe{constructor(e,t,n){this._wordRange=this._getCurrentWordRange(e,t),this.result=I$((i=>this._compute(e,t,n,i)))}_getCurrentWordRange(e,t){const n=e.getWordAtPosition(t.getPosition());return n?new TK(t.startLineNumber,n.startColumn,t.startLineNumber,n.endColumn):null}isValid(e,t,n){const i=t.startLineNumber,r=t.startColumn,o=t.endColumn,s=this._getCurrentWordRange(e,t);let a=Boolean(this._wordRange&&this._wordRange.equalsRange(s));for(let l=0,c=n.length;!a&&l<c;l++){let t=e.getDecorationRange(n[l]);t&&t.startLineNumber===i&&t.startColumn<=r&&t.endColumn>=o&&(a=!0)}return a}cancel(){this.result.cancel()}}class lMe extends aMe{_compute(e,t,n,i){return sMe(e,t.getPosition(),i).then((e=>e||[]))}}class cMe extends aMe{constructor(e,t,n){super(e,t,n),this._selectionIsEmpty=t.isEmpty()}_compute(e,t,n,i){return R$(250,i).then((()=>{if(!t.isEmpty())return[];const i=e.getWordAtPosition(t.getPosition());if(!i||i.word.length>1e3)return[];return e.findMatches(i.word,!0,!1,!0,n,!1).map((e=>({range:e.range,kind:bJ.Text})))}))}isValid(e,t,n){const i=t.isEmpty();return this._selectionIsEmpty===i&&super.isValid(e,t,n)}}a6("_executeDocumentHighlights",((e,t)=>sMe(e,t,TG.None)));class uMe{constructor(e,t){this.toUnhook=new pG,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=[],this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.editor=e,this._hasWordHighlights=oMe.bindTo(t),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(69),this.model=this.editor.getModel(),this.toUnhook.add(e.onDidChangeCursorPosition((e=>{this._ignorePositionChangeEvent||this.occurrencesHighlight&&this._onPositionChanged(e)}))),this.toUnhook.add(e.onDidChangeModelContent((e=>{this._stopAll()}))),this.toUnhook.add(e.onDidChangeConfiguration((e=>{let t=this.editor.getOption(69);this.occurrencesHighlight!==t&&(this.occurrencesHighlight=t,this._stopAll())}))),this._decorationIds=[],this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1}hasDecorations(){return this._decorationIds.length>0}restore(){this.occurrencesHighlight&&this._run()}_getSortedHighlights(){return A1(this._decorationIds.map((e=>this.model.getDecorationRange(e))).sort(TK.compareRangesUsingStarts))}moveNext(){let e=this._getSortedHighlights(),t=(e.findIndex((e=>e.containsPosition(this.editor.getPosition())))+1)%e.length,n=e[t];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const i=this._getWord();if(i){t5(`${this.editor.getModel().getLineContent(n.startLineNumber)}, ${t+1} of ${e.length} for '${i.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}moveBack(){let e=this._getSortedHighlights(),t=(e.findIndex((e=>e.containsPosition(this.editor.getPosition())))-1+e.length)%e.length,n=e[t];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const i=this._getWord();if(i){t5(`${this.editor.getModel().getLineContent(n.startLineNumber)}, ${t+1} of ${e.length} for '${i.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}_removeDecorations(){this._decorationIds.length>0&&(this._decorationIds=this.editor.deltaDecorations(this._decorationIds,[]),this._hasWordHighlights.set(!1))}_stopAll(){this._removeDecorations(),-1!==this.renderDecorationsTimer&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),null!==this.workerRequest&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(e){this.occurrencesHighlight&&3===e.reason?this._run():this._stopAll()}_getWord(){let e=this.editor.getSelection(),t=e.startLineNumber,n=e.startColumn;return this.model.getWordAtPosition({lineNumber:t,column:n})}_run(){let e=this.editor.getSelection();if(e.startLineNumber!==e.endLineNumber)return void this._stopAll();let t=e.startColumn,n=e.endColumn;const i=this._getWord();if(!i||i.startColumn>t||i.endColumn<n)return void this._stopAll();const r=this.workerRequest&&this.workerRequest.isValid(this.model,e,this._decorationIds);if(this.lastCursorPositionChangeTime=(new Date).getTime(),r)this.workerRequestCompleted&&-1!==this.renderDecorationsTimer&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else{this._stopAll();let e=++this.workerRequestTokenId;this.workerRequestCompleted=!1,this.workerRequest=function(e,t,n){return TJ.has(e)?new lMe(e,t,n):new cMe(e,t,n)}(this.model,this.editor.getSelection(),this.editor.getOption(114)),this.workerRequest.result.then((t=>{e===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=t||[],this._beginRenderDecorations())}),nG)}}_beginRenderDecorations(){let e=(new Date).getTime(),t=this.lastCursorPositionChangeTime+250;e>=t?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout((()=>{this.renderDecorations()}),t-e)}renderDecorations(){this.renderDecorationsTimer=-1;let e=[];for(const t of this.workerRequestValue)t.range&&e.push({range:t.range,options:uMe._getDecorationOptions(t.kind)});this._decorationIds=this.editor.deltaDecorations(this._decorationIds,e),this._hasWordHighlights.set(this.hasDecorations())}static _getDecorationOptions(e){return e===bJ.Write?this._WRITE_OPTIONS:e===bJ.Text?this._TEXT_OPTIONS:this._REGULAR_OPTIONS}dispose(){this._stopAll(),this.toUnhook.dispose()}}uMe._WRITE_OPTIONS=v7.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:V5(rMe),position:wQ.Center}}),uMe._TEXT_OPTIONS=v7.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight",overviewRuler:{color:V5(Vne),position:wQ.Center}}),uMe._REGULAR_OPTIONS=v7.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:V5(iMe),position:wQ.Center}});let hMe=class e extends mG{constructor(e,t){super(),this.wordHighlighter=null;const n=()=>{e.hasModel()&&(this.wordHighlighter=new uMe(e,t))};this._register(e.onDidChangeModel((e=>{this.wordHighlighter&&(this.wordHighlighter.dispose(),this.wordHighlighter=null),n()}))),n()}static get(t){return t.getContribution(e.ID)}saveViewState(){return!(!this.wordHighlighter||!this.wordHighlighter.hasDecorations())}moveNext(){this.wordHighlighter&&this.wordHighlighter.moveNext()}moveBack(){this.wordHighlighter&&this.wordHighlighter.moveBack()}restoreViewState(e){this.wordHighlighter&&e&&this.wordHighlighter.restore()}dispose(){this.wordHighlighter&&(this.wordHighlighter.dispose(),this.wordHighlighter=null),super.dispose()}};hMe.ID="editor.contrib.wordHighlighter",hMe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(1,A5)],hMe);class dMe extends o6{constructor(e,t){super(t),this._isNext=e}run(e,t){const n=hMe.get(t);n&&(this._isNext?n.moveNext():n.moveBack())}}d6(hMe.ID,hMe),c6(class extends dMe{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:GH(0,"Go to Next Symbol Highlight"),alias:"Go to Next Symbol Highlight",precondition:oMe,kbOpts:{kbExpr:gre.editorTextFocus,primary:65,weight:100}})}}),c6(class extends dMe{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:GH(0,"Go to Previous Symbol Highlight"),alias:"Go to Previous Symbol Highlight",precondition:oMe,kbOpts:{kbExpr:gre.editorTextFocus,primary:1089,weight:100}})}}),c6(class extends o6{constructor(){super({id:"editor.action.wordHighlight.trigger",label:GH(0,"Trigger Symbol Highlight"),alias:"Trigger Symbol Highlight",precondition:oMe.toNegated(),kbOpts:{kbExpr:gre.editorTextFocus,primary:0,weight:100}})}run(e,t,n){const i=hMe.get(t);i&&i.restoreViewState(!0)}}),G5(((e,t)=>{const n=e.getColor(Mte);n&&(t.addRule(`.monaco-editor .focused .selectionHighlight { background-color: ${n}; }`),t.addRule(`.monaco-editor .selectionHighlight { background-color: ${n.transparent(.5)}; }`));const i=e.getColor(JTe);i&&t.addRule(`.monaco-editor .wordHighlight { background-color: ${i}; }`);const r=e.getColor(eMe);r&&t.addRule(`.monaco-editor .wordHighlightStrong { background-color: ${r}; }`);const o=e.getColor(Ate);o&&t.addRule(`.monaco-editor .selectionHighlight { border: 1px ${"hc"===e.type?"dotted":"solid"} ${o}; box-sizing: border-box; }`);const s=e.getColor(tMe);s&&t.addRule(`.monaco-editor .wordHighlight { border: 1px ${"hc"===e.type?"dashed":"solid"} ${s}; box-sizing: border-box; }`);const a=e.getColor(nMe);a&&t.addRule(`.monaco-editor .wordHighlightStrong { border: 1px ${"hc"===e.type?"dashed":"solid"} ${a}; box-sizing: border-box; }`)}));class fMe extends r6{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,n){if(!t.hasModel())return;const i=s8(t.getOption(114)),r=t.getModel(),o=t.getSelections().map((e=>{const t=new IK(e.positionLineNumber,e.positionColumn),n=this._move(i,r,t,this._wordNavigationType);return this._moveTo(e,n,this._inSelectionMode)}));if(r.pushStackElement(),t._getViewModel().setCursorStates("moveWordCommand",3,o.map((e=>I7.fromModelSelection(e)))),1===o.length){const e=new IK(o[0].positionLineNumber,o[0].positionColumn);t.revealPosition(e,0)}}_moveTo(e,t,n){return n?new MK(e.selectionStartLineNumber,e.selectionStartColumn,t.lineNumber,t.column):new MK(t.lineNumber,t.column,t.lineNumber,t.column)}}class gMe extends fMe{_move(e,t,n,i){return Qie.moveWordLeft(e,t,n,i)}}class pMe extends fMe{_move(e,t,n,i){return Qie.moveWordRight(e,t,n,i)}}class mMe extends r6{constructor(e){super(e),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,n){if(!t.hasModel())return;const i=s8(t.getOption(114)),r=t.getModel(),o=t.getSelections(),s=t.getOption(5),a=t.getOption(8),l=q0.getAutoClosingPairs(r.getLanguageIdentifier().id),c=t._getViewModel(),u=o.map((e=>{const n=this._delete({wordSeparators:i,model:r,selection:e,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:t.getOption(6),autoClosingBrackets:s,autoClosingQuotes:a,autoClosingPairs:l,autoClosedCharacters:c.getCursorAutoClosedCharacters()},this._wordNavigationType);return new jie(n,"")}));t.pushUndoStop(),t.executeCommands(this.id,u),t.pushUndoStop()}}class vMe extends mMe{_delete(e,t){let n=Qie.deleteWordLeft(e,t);return n||new TK(1,1,1,1)}}class yMe extends mMe{_delete(e,t){let n=Qie.deleteWordRight(e,t);if(n)return n;const i=e.model.getLineCount(),r=e.model.getLineMaxColumn(i);return new TK(i,r,i,r)}}l6(new class extends gMe{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}),l6(new class extends gMe{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}),l6(new class extends gMe{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:g5.and(gre.textInputFocus,null===(e=g5.and(_ae,rfe))||void 0===e?void 0:e.negate()),primary:2063,mac:{primary:527},weight:100}})}}),l6(new class extends gMe{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}),l6(new class extends gMe{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}),l6(new class extends gMe{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:g5.and(gre.textInputFocus,null===(e=g5.and(_ae,rfe))||void 0===e?void 0:e.negate()),primary:3087,mac:{primary:1551},weight:100}})}}),l6(new class extends pMe{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}),l6(new class extends pMe{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:g5.and(gre.textInputFocus,null===(e=g5.and(_ae,rfe))||void 0===e?void 0:e.negate()),primary:2065,mac:{primary:529},weight:100}})}}),l6(new class extends pMe{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}),l6(new class extends pMe{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}),l6(new class extends pMe{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:g5.and(gre.textInputFocus,null===(e=g5.and(_ae,rfe))||void 0===e?void 0:e.negate()),primary:3089,mac:{primary:1553},weight:100}})}}),l6(new class extends pMe{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}),l6(new class extends gMe{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(e,t,n,i){return super._move(s8(eG.wordSeparators.defaultValue),t,n,i)}}),l6(new class extends gMe{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(e,t,n,i){return super._move(s8(eG.wordSeparators.defaultValue),t,n,i)}}),l6(new class extends pMe{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(e,t,n,i){return super._move(s8(eG.wordSeparators.defaultValue),t,n,i)}}),l6(new class extends pMe{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(e,t,n,i){return super._move(s8(eG.wordSeparators.defaultValue),t,n,i)}}),l6(new class extends vMe{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:gre.writable})}}),l6(new class extends vMe{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:gre.writable})}}),l6(new class extends vMe{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:gre.writable,kbOpts:{kbExpr:gre.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}),l6(new class extends yMe{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:gre.writable})}}),l6(new class extends yMe{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:gre.writable})}}),l6(new class extends yMe{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:gre.writable,kbOpts:{kbExpr:gre.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}),c6(class extends o6{constructor(){super({id:"deleteInsideWord",precondition:gre.writable,label:GH(0,"Delete Word"),alias:"Delete Word"})}run(e,t,n){if(!t.hasModel())return;const i=s8(t.getOption(114)),r=t.getModel(),o=t.getSelections().map((e=>{const t=Qie.deleteInsideWord(i,r,e);return new jie(t,"")}));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}});class _Me extends fMe{_move(e,t,n,i){return Jie.moveWordPartLeft(e,t,n)}}qZ.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");qZ.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class bMe extends fMe{_move(e,t,n,i){return Jie.moveWordPartRight(e,t,n)}}l6(new class extends mMe{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:gre.writable,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(e,t){let n=Jie.deleteWordPartLeft(e);return n||new TK(1,1,1,1)}}),l6(new class extends mMe{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:gre.writable,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(e,t){let n=Jie.deleteWordPartRight(e);if(n)return n;const i=e.model.getLineCount(),r=e.model.getLineMaxColumn(i);return new TK(i,r,i,r)}}),l6(new class extends _Me{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}),l6(new class extends _Me{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}),l6(new class extends bMe{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}),l6(new class extends bMe{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:gre.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}});var wMe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},CMe=function(e,t){return function(n,i){t(n,i,e)}};const SMe=new M5("accessibilityHelpWidgetVisible",!1);let xMe=class e extends mG{constructor(e,t){super(),this._editor=e,this._widget=this._register(t.createInstance(EMe,this._editor))}static get(t){return t.getContribution(e.ID)}show(){this._widget.show()}hide(){this._widget.hide()}};xMe.ID="editor.contrib.accessibilityHelpController",xMe=wMe([CMe(1,t$)],xMe);let EMe=class e extends Yre{constructor(e,t,n,i){super(),this._contextKeyService=t,this._keybindingService=n,this._openerService=i,this._editor=e,this._isVisibleKey=SMe.bindTo(this._contextKeyService),this._domNode=I6(document.createElement("div")),this._domNode.setClassName("accessibilityHelpWidget"),this._domNode.setDisplay("none"),this._domNode.setAttribute("role","dialog"),this._domNode.setAttribute("aria-hidden","true"),this._contentDomNode=I6(document.createElement("div")),this._contentDomNode.setAttribute("role","document"),this._domNode.appendChild(this._contentDomNode),this._isVisible=!1,this._register(this._editor.onDidLayoutChange((()=>{this._isVisible&&this._layout()}))),this._register(eY(this._contentDomNode.domNode,"keydown",(e=>{if(this._isVisible&&(e.equals(2083)&&(t5(v4.emergencyConfOn),this._editor.updateOptions({accessibilitySupport:"on"}),Y$(this._contentDomNode.domNode),this._buildContent(),this._contentDomNode.domNode.focus(),e.preventDefault(),e.stopPropagation()),e.equals(2086))){t5(v4.openingDocs);let t=this._editor.getRawOptions().accessibilityHelpUrl;void 0===t&&(t="https://go.microsoft.com/fwlink/?linkid=852450"),this._openerService.open(_K.parse(t)),e.preventDefault(),e.stopPropagation()}}))),this.onblur(this._contentDomNode.domNode,(()=>{this.hide()})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return e.ID}getDomNode(){return this._domNode.domNode}getPosition(){return{preference:null}}show(){this._isVisible||(this._isVisible=!0,this._isVisibleKey.set(!0),this._layout(),this._domNode.setDisplay("block"),this._domNode.setAttribute("aria-hidden","false"),this._contentDomNode.domNode.tabIndex=0,this._buildContent(),this._contentDomNode.domNode.focus())}_descriptionForCommand(e,t,n){let i=this._keybindingService.lookupKeybinding(e);return i?nX(t,i.getAriaLabel()):nX(n,e)}_buildContent(){const e=this._editor.getOptions(),t=this._editor.getSelections();let n=0;if(t){const e=this._editor.getModel();e&&t.forEach((t=>{n+=e.getValueLengthInRange(t)}))}let i=function(e,t){return e&&0!==e.length?1===e.length?t?nX(v4.singleSelectionRange,e[0].positionLineNumber,e[0].positionColumn,t):nX(v4.singleSelection,e[0].positionLineNumber,e[0].positionColumn):t?nX(v4.multiSelectionRange,e.length,t):e.length>0?nX(v4.multiSelection,e.length):"":v4.noSelection}(t,n);e.get(51)?e.get(78)?i+=v4.readonlyDiffEditor:i+=v4.editableDiffEditor:e.get(78)?i+=v4.readonlyEditor:i+=v4.editableEditor;const r=lj?v4.changeConfigToOnMac:v4.changeConfigToOnWinLinux;switch(e.get(2)){case 0:i+="\n\n - "+r;break;case 2:i+="\n\n - "+v4.auto_on;break;case 1:i+="\n\n - "+v4.auto_off,i+=" "+r}e.get(127)?i+="\n\n - "+this._descriptionForCommand(qTe.ID,v4.tabFocusModeOnMsg,v4.tabFocusModeOnMsgNoKb):i+="\n\n - "+this._descriptionForCommand(qTe.ID,v4.tabFocusModeOffMsg,v4.tabFocusModeOffMsgNoKb);i+="\n\n - "+(lj?v4.openDocMac:v4.openDocWinLinux),i+="\n\n"+v4.outroMsg,this._contentDomNode.domNode.appendChild(Lme(i)),this._contentDomNode.domNode.setAttribute("aria-label",i)}hide(){this._isVisible&&(this._isVisible=!1,this._isVisibleKey.reset(),this._domNode.setDisplay("none"),this._domNode.setAttribute("aria-hidden","true"),this._contentDomNode.domNode.tabIndex=-1,Y$(this._contentDomNode.domNode),this._editor.focus())}_layout(){let t=this._editor.getLayoutInfo(),n=Math.max(5,Math.min(e.WIDTH,t.width-40)),i=Math.max(5,Math.min(e.HEIGHT,t.height-40));this._domNode.setWidth(n),this._domNode.setHeight(i);let r=Math.round((t.height-i)/2);this._domNode.setTop(r);let o=Math.round((t.width-n)/2);this._domNode.setLeft(o)}};EMe.ID="editor.contrib.accessibilityHelpWidget",EMe.WIDTH=500,EMe.HEIGHT=300,EMe=wMe([CMe(1,A5),CMe(2,gce),CMe(3,ZZ)],EMe);d6(xMe.ID,xMe),c6(class extends o6{constructor(){super({id:"editor.action.showAccessibilityHelp",label:v4.showAccessibilityHelpAction,alias:"Show Accessibility Help",precondition:void 0,kbOpts:{primary:571,weight:100,linux:{primary:1595,secondary:[571]}}})}run(e,t){let n=xMe.get(t);n&&n.show()}});l6(new(r6.bindToContribution(xMe.get))({id:"closeAccessibilityHelp",precondition:SMe,handler:e=>e.hide(),kbOpts:{weight:200,kbExpr:gre.focus,primary:9,secondary:[1033]}})),G5(((e,t)=>{const n=e.getColor(mte);n&&t.addRule(`.monaco-editor .accessibilityHelpWidget { background-color: ${n}; }`);const i=e.getColor(vte);i&&t.addRule(`.monaco-editor .accessibilityHelpWidget { color: ${i}; }`);const r=e.getColor(Nee);r&&t.addRule(`.monaco-editor .accessibilityHelpWidget { box-shadow: 0 2px 8px ${r}; }`);const o=e.getColor(xee);o&&t.addRule(`.monaco-editor .accessibilityHelpWidget { border: 2px solid ${o}; }`)}));class kMe extends mG{constructor(e){super(),this.editor=e,this.widget=null,dj&&(this._register(e.onDidChangeConfiguration((()=>this.update()))),this.update())}update(){const e=!this.editor.getOption(78);!this.widget&&e?this.widget=new LMe(this.editor):this.widget&&!e&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&(this.widget.dispose(),this.widget=null)}}kMe.ID="editor.contrib.iPadShowKeyboard";class LMe extends mG{constructor(e){super(),this.editor=e,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._register(Q$(this._domNode,"touchstart",(e=>{this.editor.focus()}))),this._register(Q$(this._domNode,"focus",(e=>{this.editor.focus()}))),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return LMe.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}}LMe.ID="editor.contrib.ShowKeyboardWidget",d6(kMe.ID,kMe);var DMe=function(e,t){return function(n,i){t(n,i,e)}};let NMe=class e extends mG{constructor(e,t,n){super(),this._editor=e,this._modeService=n,this._widget=null,this._register(this._editor.onDidChangeModel((e=>this.stop()))),this._register(this._editor.onDidChangeModelLanguage((e=>this.stop()))),this._register(YJ.onDidChange((e=>this.stop()))),this._register(this._editor.onKeyUp((e=>9===e.keyCode&&this.stop())))}static get(t){return t.getContribution(e.ID)}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new IMe(this._editor,this._modeService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}};NMe.ID="editor.contrib.inspectTokens",NMe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([DMe(1,fce),DMe(2,t0)],NMe);class IMe extends mG{constructor(e,t){var n;super(),this.allowEditorOverflow=!0,this._editor=e,this._modeService=t,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="tokens-inspect-widget",this._tokenizationSupport=(n=this._model.getLanguageIdentifier(),YJ.get(n.language)||{getInitialState:()=>XJ,tokenize:(e,t,i,r)=>QJ(n.language,0,i,r),tokenize2:(e,t,i,r)=>JJ(n.id,0,i,r)}),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition((e=>this._compute(this._editor.getPosition())))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return IMe._ID}_compute(e){let t=this._getTokensAtLine(e.lineNumber),n=0;for(let a=t.tokens1.length-1;a>=0;a--){let i=t.tokens1[a];if(e.column-1>=i.offset){n=a;break}}let i=0;for(let a=t.tokens2.length>>>1;a>=0;a--)if(e.column-1>=t.tokens2[a<<1]){i=a;break}let r=this._model.getLineContent(e.lineNumber),o="";if(n<t.tokens1.length){let e=t.tokens1[n].offset,i=n+1<t.tokens1.length?t.tokens1[n+1].offset:r.length;o=r.substring(e,i)}zY(this._domNode,GY("h2.tm-token",void 0,function(e){let t="";for(let n=0,i=e.length;n<i;n++){let i=e.charCodeAt(n);switch(i){case 9:t+="→";break;case 32:t+="·";break;default:t+=String.fromCharCode(i)}}return t}(o),GY("span.tm-token-length",void 0,`${o.length} ${1===o.length?"char":"chars"}`))),WY(this._domNode,GY("hr.tokens-inspect-separator",{style:"clear:both"}));const s=1+(i<<1)<t.tokens2.length?this._decodeMetadata(t.tokens2[1+(i<<1)]):null;WY(this._domNode,GY("table.tm-metadata-table",void 0,GY("tbody",void 0,GY("tr",void 0,GY("td.tm-metadata-key",void 0,"language"),GY("td.tm-metadata-value",void 0,`${s?s.languageIdentifier.language:"-?-"}`)),GY("tr",void 0,GY("td.tm-metadata-key",void 0,"token type"),GY("td.tm-metadata-value",void 0,`${s?this._tokenTypeToString(s.tokenType):"-?-"}`)),GY("tr",void 0,GY("td.tm-metadata-key",void 0,"font style"),GY("td.tm-metadata-value",void 0,`${s?this._fontStyleToString(s.fontStyle):"-?-"}`)),GY("tr",void 0,GY("td.tm-metadata-key",void 0,"foreground"),GY("td.tm-metadata-value",void 0,`${s?Q8.Format.CSS.formatHex(s.foreground):"-?-"}`)),GY("tr",void 0,GY("td.tm-metadata-key",void 0,"background"),GY("td.tm-metadata-value",void 0,`${s?Q8.Format.CSS.formatHex(s.background):"-?-"}`))))),WY(this._domNode,GY("hr.tokens-inspect-separator")),n<t.tokens1.length&&WY(this._domNode,GY("span.tm-token-type",void 0,t.tokens1[n].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(e){let t=YJ.getColorMap(),n=pJ.getLanguageId(e),i=pJ.getTokenType(e),r=pJ.getFontStyle(e),o=pJ.getForeground(e),s=pJ.getBackground(e);return{languageIdentifier:this._modeService.getLanguageIdentifier(n),tokenType:i,fontStyle:r,foreground:t[o],background:t[s]}}_tokenTypeToString(e){switch(e){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 4:return"RegEx";default:return"??"}}_fontStyleToString(e){let t="";return 1&e&&(t+="italic "),2&e&&(t+="bold "),4&e&&(t+="underline "),0===t.length&&(t="---"),t}_getTokensAtLine(e){let t=this._getStateBeforeLine(e),n=this._tokenizationSupport.tokenize(this._model.getLineContent(e),!0,t,0),i=this._tokenizationSupport.tokenize2(this._model.getLineContent(e),!0,t,0);return{startState:t,tokens1:n.tokens,tokens2:i.tokens,endState:n.endState}}_getStateBeforeLine(e){let t=this._tokenizationSupport.getInitialState();for(let n=1;n<e;n++){t=this._tokenizationSupport.tokenize(this._model.getLineContent(n),!0,t,0).endState}return t}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}}IMe._ID="editor.contrib.inspectTokensWidget",d6(NMe.ID,NMe),c6(class extends o6{constructor(){super({id:"editor.action.inspectTokens",label:_4.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(e,t){let n=NMe.get(t);n&&n.launch()}}),G5(((e,t)=>{const n=e.getColor(Hte);if(n){let i=e.type===P5.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .tokens-inspect-widget { border: ${i}px solid ${n}; }`),t.addRule(`.monaco-editor .tokens-inspect-widget .tokens-inspect-separator { background-color: ${n}; }`)}const i=e.getColor(Vte);i&&t.addRule(`.monaco-editor .tokens-inspect-widget { background-color: ${i}; }`);const r=e.getColor(Ute);r&&t.addRule(`.monaco-editor .tokens-inspect-widget { color: ${r}; }`)}));let TMe=class e{constructor(e){this.quickInputService=e,this.registry=d3.as(nve)}provide(t){const n=new pG;n.add(t.onDidAccept((()=>{const[e]=t.selectedItems;e&&this.quickInputService.quickAccess.show(e.prefix,{preserveValue:!0})}))),n.add(t.onDidChangeValue((t=>{const n=this.registry.getQuickAccessProvider(t.substr(e.PREFIX.length));n&&n.prefix&&n.prefix!==e.PREFIX&&this.quickInputService.quickAccess.show(n.prefix,{preserveValue:!0})})));const{editorProviders:i,globalProviders:r}=this.getQuickAccessProviders();return t.items=0===i.length||0===r.length?[...0===i.length?r:i]:[{label:GH(0,"global commands"),type:"separator"},...r,{label:GH(0,"editor commands"),type:"separator"},...i],n}getQuickAccessProviders(){const t=[],n=[];for(const i of this.registry.getQuickAccessProviders().sort(((e,t)=>e.prefix.localeCompare(t.prefix))))if(i.prefix!==e.PREFIX)for(const e of i.helpEntries){const r=e.prefix||i.prefix,o=r||"…";(e.needsEditor?n:t).push({prefix:r,label:o,ariaLabel:GH(0,"{0}, {1}",o,e.description),description:e.description})}return{editorProviders:n,globalProviders:t}}};TMe.PREFIX="?",TMe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(0,Jme)],TMe),d3.as(nve).registerQuickAccessProvider({ctor:TMe,prefix:"",helpEntries:[{description:w4.helpQuickAccessActionLabel,needsEditor:!0}]});class MMe{constructor(e){this.options=e,this.rangeHighlightDecorationId=void 0}provide(e,t){var n;const i=new pG;e.canAcceptInBackground=!!(null===(n=this.options)||void 0===n?void 0:n.canAcceptInBackground),e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;const r=i.add(new vG);return r.value=this.doProvide(e,t),i.add(this.onDidActiveTextEditorControlChange((()=>{r.value=void 0,r.value=this.doProvide(e,t)}))),i}doProvide(e,t){const n=new pG,i=this.activeTextEditorControl;if(i&&this.canProvideWithTextEditor(i)){const r={editor:i},o=a3(i);if(o){let e=GZ(i.saveViewState());n.add(o.onDidChangeCursorPosition((()=>{e=GZ(i.saveViewState())}))),r.restoreViewState=()=>{e&&i===this.activeTextEditorControl&&i.restoreViewState(e)},n.add(Moe(t.onCancellationRequested)((()=>{var e;return null===(e=r.restoreViewState)||void 0===e?void 0:e.call(r)})))}n.add(gG((()=>this.clearDecorations(i)))),n.add(this.provideWithTextEditor(r,e,t))}else n.add(this.provideWithoutTextEditor(e,t));return n}canProvideWithTextEditor(e){return!0}gotoLocation({editor:e},t){e.setSelection(t.range),e.revealRangeInCenter(t.range,0),t.preserveFocus||e.focus()}getModel(e){var t;return s3(e)?null===(t=e.getModel())||void 0===t?void 0:t.modified:e.getModel()}addDecorations(e,t){e.changeDecorations((e=>{const n=[];this.rangeHighlightDecorationId&&(n.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),n.push(this.rangeHighlightDecorationId.rangeHighlightId),this.rangeHighlightDecorationId=void 0);const i=[{range:t,options:{description:"quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"quick-access-range-highlight-overview",overviewRuler:{color:V5(Oie),position:wQ.Full}}}],[r,o]=e.deltaDecorations(n,i);this.rangeHighlightDecorationId={rangeHighlightId:r,overviewRulerDecorationId:o}}))}clearDecorations(e){const t=this.rangeHighlightDecorationId;t&&(e.changeDecorations((e=>{e.deltaDecorations([t.overviewRulerDecorationId,t.rangeHighlightId],[])})),this.rangeHighlightDecorationId=void 0)}}class AMe extends MMe{constructor(){super({canAcceptInBackground:!0})}provideWithoutTextEditor(e){const t=GH(0,"Open a text editor first to go to a line.");return e.items=[{label:t}],e.ariaLabel=t,mG.None}provideWithTextEditor(e,t,n){const i=e.editor,r=new pG;r.add(t.onDidAccept((n=>{const[r]=t.selectedItems;if(r){if(!this.isValidLineNumber(i,r.lineNumber))return;this.gotoLocation(e,{range:this.toRange(r.lineNumber,r.column),keyMods:t.keyMods,preserveFocus:n.inBackground}),n.inBackground||t.hide()}})));const o=()=>{const e=this.parsePosition(i,t.value.trim().substr(AMe.PREFIX.length)),n=this.getPickLabel(i,e.lineNumber,e.column);if(t.items=[{lineNumber:e.lineNumber,column:e.column,label:n}],t.ariaLabel=n,!this.isValidLineNumber(i,e.lineNumber))return void this.clearDecorations(i);const r=this.toRange(e.lineNumber,e.column);i.revealRangeInCenter(r,0),this.addDecorations(i,r)};o(),r.add(t.onDidChangeValue((()=>o())));const s=a3(i);if(s){2===s.getOptions().get(57).renderType&&(s.updateOptions({lineNumbers:"on"}),r.add(gG((()=>s.updateOptions({lineNumbers:"relative"})))))}return r}toRange(e=1,t=1){return{startLineNumber:e,startColumn:t,endLineNumber:e,endColumn:t}}parsePosition(e,t){const n=t.split(/,|:|#/).map((e=>parseInt(e,10))).filter((e=>!isNaN(e))),i=this.lineCount(e)+1;return{lineNumber:n[0]>0?n[0]:i+n[0],column:n[1]}}getPickLabel(e,t,n){if(this.isValidLineNumber(e,t))return this.isValidColumn(e,t,n)?GH(0,"Go to line {0} and character {1}.",t,n):GH(0,"Go to line {0}.",t);const i=e.getPosition()||{lineNumber:1,column:1},r=this.lineCount(e);return r>1?GH(0,"Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.",i.lineNumber,i.column,r):GH(0,"Current Line: {0}, Character: {1}. Type a line number to navigate to.",i.lineNumber,i.column)}isValidLineNumber(e,t){return!(!t||"number"!=typeof t)&&(t>0&&t<=this.lineCount(e))}isValidColumn(e,t,n){if(!n||"number"!=typeof n)return!1;const i=this.getModel(e);if(!i)return!1;const r={lineNumber:t,column:n};return i.validatePosition(r).equals(r)}lineCount(e){var t,n;return null!==(n=null===(t=this.getModel(e))||void 0===t?void 0:t.getLineCount())&&void 0!==n?n:0}}AMe.PREFIX=":";let OMe=class extends AMe{constructor(e){super(),this.editorService=e,this.onDidActiveTextEditorControlChange=SG.None}get activeTextEditorControl(){return GZ(this.editorService.getFocusedCodeEditor())}};OMe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(0,o$)],OMe),d3.as(nve).registerQuickAccessProvider({ctor:OMe,prefix:OMe.PREFIX,helpEntries:[{description:b4.gotoLineActionLabel,needsEditor:!0}]});c6(class extends o6{constructor(){super({id:"editor.action.gotoLine",label:b4.gotoLineActionLabel,alias:"Go to Line/Column...",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:2085,mac:{primary:293},weight:100}})}run(e){e.get(Jme).quickAccess.show(OMe.PREFIX)}});const RMe=[void 0,[]];function PMe(e,t,n=0,i=0){const r=t;return r.values&&r.values.length>1?function(e,t,n,i){let r=0;const o=[];for(const s of t){const[t,a]=FMe(e,s,n,i);if("number"!=typeof t)return RMe;r+=t,o.push(...a)}return[r,BMe(o)]}(e,r.values,n,i):FMe(e,t,n,i)}function FMe(e,t,n,i){const r=The(t.original,t.originalLowercase,n,e,e.toLowerCase(),i,!0);return r?[r[0],yhe(r)]:RMe}function BMe(e){const t=e.sort(((e,t)=>e.start-t.start)),n=[];let i;for(const r of t)i&&WMe(i,r)?(i.start=Math.min(i.start,r.start),i.end=Math.max(i.end,r.end)):(i=r,n.push(r));return n}function WMe(e,t){return!(e.end<t.start)&&!(t.end<e.start)}function zMe(e){"string"!=typeof e&&(e="");const t=e.toLowerCase(),{pathNormalized:n,normalized:i,normalizedLowercase:r}=VMe(e),o=n.indexOf(dK)>=0;let s;const a=e.split(" ");if(a.length>1)for(const l of a){const{pathNormalized:e,normalized:t,normalizedLowercase:n}=VMe(l);t&&(s||(s=[]),s.push({original:l,originalLowercase:l.toLowerCase(),pathNormalized:e,normalized:t,normalizedLowercase:n}))}return{original:e,originalLowercase:t,pathNormalized:n,normalized:i,normalizedLowercase:r,values:s,containsPathSeparator:o}}function VMe(e){let t;t=aj?e.replace(/\//g,dK):e.replace(/\\/g,dK);const n=(i=t,i.replace(/\*/g,"")).replace(/\s/g,"");var i;return{pathNormalized:t,normalized:n,normalizedLowercase:n.toLowerCase()}}function UMe(e){return Array.isArray(e)?zMe(e.map((e=>e.original)).join(" ")):zMe(e.original)}var HMe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class jMe extends MMe{constructor(e=Object.create(null)){super(e),this.options=e,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(e){return this.provideLabelPick(e,GH(0,"To go to a symbol, first open a text editor with symbol information.")),mG.None}provideWithTextEditor(e,t,n){const i=e.editor,r=this.getModel(i);return r?IJ.has(r)?this.doProvideWithEditorSymbols(e,r,t,n):this.doProvideWithoutEditorSymbols(e,r,t,n):mG.None}doProvideWithoutEditorSymbols(e,t,n,i){const r=new pG;return this.provideLabelPick(n,GH(0,"The active text editor does not provide symbol information.")),(()=>{HMe(this,void 0,void 0,(function*(){(yield this.waitForLanguageSymbolRegistry(t,r))&&!i.isCancellationRequested&&r.add(this.doProvideWithEditorSymbols(e,t,n,i))}))})(),r}provideLabelPick(e,t){e.items=[{label:t,index:0,kind:14}],e.ariaLabel=t}waitForLanguageSymbolRegistry(e,t){return HMe(this,void 0,void 0,(function*(){if(IJ.has(e))return!0;let n;const i=new Promise((e=>n=e)),r=t.add(IJ.onDidChange((()=>{IJ.has(e)&&(r.dispose(),n(!0))})));return t.add(gG((()=>n(!1)))),i}))}doProvideWithEditorSymbols(e,t,n,i){const r=e.editor,o=new pG;o.add(n.onDidAccept((t=>{const[i]=n.selectedItems;i&&i.range&&(this.gotoLocation(e,{range:i.range.selection,keyMods:n.keyMods,preserveFocus:t.inBackground}),t.inBackground||n.hide())}))),o.add(n.onDidTriggerItemButton((({item:t})=>{t&&t.range&&(this.gotoLocation(e,{range:t.range.selection,keyMods:n.keyMods,forceSideBySide:!0}),n.hide())})));const s=this.getDocumentSymbols(t,i);let a;const l=()=>HMe(this,void 0,void 0,(function*(){null==a||a.dispose(!0),n.busy=!1,a=new OG(i),n.busy=!0;try{const e=zMe(n.value.substr(jMe.PREFIX.length).trim()),t=yield this.doGetSymbolPicks(s,e,void 0,a.token);if(i.isCancellationRequested)return;t.length>0?n.items=t:e.original.length>0?this.provideLabelPick(n,GH(0,"No matching editor symbols")):this.provideLabelPick(n,GH(0,"No editor symbols"))}finally{i.isCancellationRequested||(n.busy=!1)}}));o.add(n.onDidChangeValue((()=>l()))),l();let c=!0;return o.add(n.onDidChangeActive((()=>{const[e]=n.activeItems;if(e&&e.range){if(c)return void(c=!1);r.revealRangeInCenter(e.range.selection,0),this.addDecorations(r,e.range.decoration)}}))),o}doGetSymbolPicks(e,t,n,i){return HMe(this,void 0,void 0,(function*(){const r=yield e;if(i.isCancellationRequested)return[];const o=0===t.original.indexOf(jMe.SCOPE_PREFIX),s=o?1:0;let a,l;t.values&&t.values.length>1?(a=UMe(t.values[0]),l=UMe(t.values.slice(1))):a=t;const c=[];for(let e=0;e<r.length;e++){const i=r[e],o=oX(i.name),u=`$(symbol-${wJ.toString(i.kind)||"property"}) ${o}`,h=u.length-o.length;let d,f,g,p,m=i.containerName;if((null==n?void 0:n.extraContainerLabel)&&(m=m?`${n.extraContainerLabel} • ${m}`:n.extraContainerLabel),t.original.length>s){let e=!1;if(a!==t&&([d,f]=PMe(u,Object.assign(Object.assign({},t),{values:void 0}),s,h),"number"==typeof d&&(e=!0)),"number"!=typeof d&&([d,f]=PMe(u,a,s,h),"number"!=typeof d))continue;if(!e&&l){if(m&&l.original.length>0&&([g,p]=PMe(m,l)),"number"!=typeof g)continue;"number"==typeof d&&(d+=g)}}const v=i.tags&&i.tags.indexOf(1)>=0;c.push({index:e,kind:i.kind,score:d,label:u,ariaLabel:o,description:m,highlights:v?void 0:{label:f,description:p},range:{selection:TK.collapseToStart(i.selectionRange),decoration:i.range},strikethrough:v,buttons:(()=>{var e,t;const n=(null===(e=this.options)||void 0===e?void 0:e.openSideBySideDirection)?null===(t=this.options)||void 0===t?void 0:t.openSideBySideDirection():void 0;if(n)return[{iconClass:"right"===n?hJ.splitHorizontal.classNames:hJ.splitVertical.classNames,tooltip:GH(0,"right"===n?"Open to the Side":"Open to the Bottom")}]})()})}const u=c.sort(((e,t)=>o?this.compareByKindAndScore(e,t):this.compareByScore(e,t)));let h=[];if(o){let e,t,n=function(){t&&"number"==typeof e&&i>0&&(t.label=nX(KMe[e]||GMe,i))},i=0;for(const r of u)e!==r.kind?(n(),e=r.kind,i=1,t={type:"separator"},h.push(t)):i++,h.push(r);n()}else u.length>0&&(h=[{label:GH(0,"symbols ({0})",c.length),type:"separator"},...u]);return h}))}compareByScore(e,t){if("number"!=typeof e.score&&"number"==typeof t.score)return 1;if("number"==typeof e.score&&"number"!=typeof t.score)return-1;if("number"==typeof e.score&&"number"==typeof t.score){if(e.score>t.score)return-1;if(e.score<t.score)return 1}return e.index<t.index?-1:e.index>t.index?1:0}compareByKindAndScore(e,t){const n=KMe[e.kind]||GMe,i=KMe[t.kind]||GMe,r=n.localeCompare(i);return 0===r?this.compareByScore(e,t):r}getDocumentSymbols(e,t){return HMe(this,void 0,void 0,(function*(){const n=yield fIe.create(e,t);return t.isCancellationRequested?[]:n.asListOfDocumentSymbols()}))}}jMe.PREFIX="@",jMe.SCOPE_PREFIX=":",jMe.PREFIX_BY_CATEGORY=`${jMe.PREFIX}${jMe.SCOPE_PREFIX}`;const GMe=GH(0,"properties ({0})"),KMe={5:GH(0,"methods ({0})"),11:GH(0,"functions ({0})"),8:GH(0,"constructors ({0})"),12:GH(0,"variables ({0})"),4:GH(0,"classes ({0})"),22:GH(0,"structs ({0})"),23:GH(0,"events ({0})"),24:GH(0,"operators ({0})"),10:GH(0,"interfaces ({0})"),2:GH(0,"namespaces ({0})"),3:GH(0,"packages ({0})"),25:GH(0,"type parameters ({0})"),1:GH(0,"modules ({0})"),6:GH(0,"properties ({0})"),9:GH(0,"enumerations ({0})"),21:GH(0,"enumeration members ({0})"),14:GH(0,"strings ({0})"),0:GH(0,"files ({0})"),17:GH(0,"arrays ({0})"),15:GH(0,"numbers ({0})"),16:GH(0,"booleans ({0})"),18:GH(0,"objects ({0})"),19:GH(0,"keys ({0})"),7:GH(0,"fields ({0})"),13:GH(0,"constants ({0})")};let qMe=class extends jMe{constructor(e){super(),this.editorService=e,this.onDidActiveTextEditorControlChange=SG.None}get activeTextEditorControl(){return GZ(this.editorService.getFocusedCodeEditor())}};qMe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([function(e,t){return function(n,i){t(n,i,e)}}(0,o$)],qMe),d3.as(nve).registerQuickAccessProvider({ctor:qMe,prefix:jMe.PREFIX,helpEntries:[{description:x4.quickOutlineActionLabel,prefix:jMe.PREFIX,needsEditor:!0},{description:x4.quickOutlineByCategoryActionLabel,prefix:jMe.PREFIX_BY_CATEGORY,needsEditor:!0}]});c6(class extends o6{constructor(){super({id:"editor.action.quickOutline",label:x4.quickOutlineActionLabel,alias:"Go to Symbol...",precondition:gre.hasDocumentSymbolProvider,kbOpts:{kbExpr:gre.focus,primary:3117,weight:100},contextMenuOpts:{group:"navigation",order:3}})}run(e){e.get(Jme).quickAccess.show(jMe.PREFIX)}});var $Me,YMe,XMe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function ZMe(e){const t=e;return Array.isArray(t.items)}(YMe=$Me||($Me={}))[YMe.NO_ACTION=0]="NO_ACTION",YMe[YMe.CLOSE_PICKER=1]="CLOSE_PICKER",YMe[YMe.REFRESH_PICKER=2]="REFRESH_PICKER",YMe[YMe.REMOVE_ITEM=3]="REMOVE_ITEM";class QMe extends mG{constructor(e,t){super(),this.prefix=e,this.options=t}provide(e,t){var n;const i=new pG;let r;e.canAcceptInBackground=!!(null===(n=this.options)||void 0===n?void 0:n.canAcceptInBackground),e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;const o=i.add(new vG),s=()=>XMe(this,void 0,void 0,(function*(){const n=o.value=new pG;null==r||r.dispose(!0),e.busy=!1,r=new OG(t);const i=r.token,s=e.value.substr(this.prefix.length).trim(),a=this._getPicks(s,n,i),l=(t,n)=>{var i;let r,o;if(ZMe(t)?(r=t.items,o=t.active):r=t,0===r.length){if(n)return!1;s.length>0&&(null===(i=this.options)||void 0===i?void 0:i.noResultsPick)&&(r=[this.options.noResultsPick])}return e.items=r,o&&(e.activeItems=[o]),!0};if(null===a);else if(function(e){const t=e;return!!t.picks&&t.additionalPicks instanceof Promise}(a)){let t=!1,n=!1;yield Promise.all([(()=>XMe(this,void 0,void 0,(function*(){yield R$(QMe.FAST_PICKS_RACE_DELAY),i.isCancellationRequested||n||(t=l(a.picks,!0))})))(),(()=>XMe(this,void 0,void 0,(function*(){e.busy=!0;try{const r=yield a.additionalPicks;if(i.isCancellationRequested)return;let o,s,c,u;if(ZMe(a.picks)?(o=a.picks.items,s=a.picks.active):o=a.picks,ZMe(r)?(c=r.items,u=r.active):c=r,c.length>0||!t){let t;if(!s&&!u){const n=e.activeItems[0];n&&-1!==o.indexOf(n)&&(t=n)}l({items:[...o,...c],active:s||u||t})}}finally{i.isCancellationRequested||(e.busy=!1),n=!0}})))()])}else if(a instanceof Promise){e.busy=!0;try{const t=yield a;if(i.isCancellationRequested)return;l(t)}finally{i.isCancellationRequested||(e.busy=!1)}}else l(a)}));return i.add(e.onDidChangeValue((()=>s()))),s(),i.add(e.onDidAccept((t=>{const[n]=e.selectedItems;"function"==typeof(null==n?void 0:n.accept)&&(t.inBackground||e.hide(),n.accept(e.keyMods,t))}))),i.add(e.onDidTriggerItemButton((({button:n,item:i})=>XMe(this,void 0,void 0,(function*(){var r,o;if("function"==typeof i.trigger){const a=null!==(o=null===(r=i.buttons)||void 0===r?void 0:r.indexOf(n))&&void 0!==o?o:-1;if(a>=0){const n=i.trigger(a,e.keyMods),r="number"==typeof n?n:yield n;if(t.isCancellationRequested)return;switch(r){case $Me.NO_ACTION:break;case $Me.CLOSE_PICKER:e.hide();break;case $Me.REFRESH_PICKER:s();break;case $Me.REMOVE_ITEM:const t=e.items.indexOf(i);if(-1!==t){const n=e.items.slice();n.splice(t,1),e.items=n}}}}}))))),i}}function JMe(e,t){return t&&(e.stack||e.stacktrace)?GH(0,"{0}: {1}",tAe(e),eAe(e.stack)||eAe(e.stacktrace)):tAe(e)}function eAe(e){return Array.isArray(e)?e.join("\n"):e}function tAe(e){return"string"==typeof e.code&&"number"==typeof e.errno&&"string"==typeof e.syscall?GH(0,"A system error occurred ({0})",e.message):e.message||GH(0,"An unknown error occurred. Please consult the log for more details.")}function nAe(e=null,t=!1){if(!e)return GH(0,"An unknown error occurred. Please consult the log for more details.");if(Array.isArray(e)){const n=A1(e),i=nAe(n[0],t);return n.length>1?GH(0,"{0} ({1} errors in total)",i,n.length):i}if(AZ(e))return e;if(e.detail){const n=e.detail;if(n.error)return JMe(n.error,t);if(n.exception)return JMe(n.exception,t)}return e.stack?JMe(e,t):e.message?e.message:GH(0,"An unknown error occurred. Please consult the log for more details.")}QMe.FAST_PICKS_RACE_DELAY=200;var iAe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},rAe=function(e,t){return function(n,i){t(n,i,e)}},oAe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let sAe=class e extends QMe{constructor(t,n,i,r,o,s){super(e.PREFIX,t),this.instantiationService=n,this.keybindingService=i,this.commandService=r,this.telemetryService=o,this.dialogService=s,this.commandsHistory=this._register(this.instantiationService.createInstance(aAe)),this.options=t}_getPicks(t,n,i){return oAe(this,void 0,void 0,(function*(){const r=yield this.getCommandPicks(n,i);if(i.isCancellationRequested)return[];const o=[];for(const n of r){const i=GZ(e.WORD_FILTER(t,n.label)),r=n.commandAlias?GZ(e.WORD_FILTER(t,n.commandAlias)):void 0;i||r?(n.highlights={label:i,detail:this.options.showAlias?r:void 0},o.push(n)):t===n.commandId&&o.push(n)}const s=new Map;for(const e of o){const t=s.get(e.label);t?(e.description=e.commandId,t.description=t.commandId):s.set(e.label,e)}o.sort(((e,t)=>{const n=this.commandsHistory.peek(e.commandId),i=this.commandsHistory.peek(t.commandId);return n&&i?n>i?-1:1:n?-1:i?1:e.label.localeCompare(t.label)}));const a=[];let l=!1;for(let e=0;e<o.length;e++){const t=o[e],n=this.keybindingService.lookupKeybinding(t.commandId),i=n?GH(0,"{0}, {1}",t.label,n.getAriaLabel()):t.label;0===e&&this.commandsHistory.peek(t.commandId)&&(a.push({type:"separator",label:GH(0,"recently used")}),l=!0),0!==e&&l&&!this.commandsHistory.peek(t.commandId)&&(a.push({type:"separator",label:GH(0,"other commands")}),l=!1),a.push(Object.assign(Object.assign({},t),{ariaLabel:i,detail:this.options.showAlias&&t.commandAlias!==t.label?t.commandAlias:void 0,keybinding:n,accept:()=>oAe(this,void 0,void 0,(function*(){this.commandsHistory.push(t.commandId),this.telemetryService.publicLog2("workbenchActionExecuted",{id:t.commandId,from:"quick open"});try{yield this.commandService.executeCommand(t.commandId)}catch(e){oG(e)||this.dialogService.show(r3.Error,GH(0,"Command '{0}' resulted in an error ({1})",t.label,nAe(e)))}}))}))}return a}))}};sAe.PREFIX=">",sAe.WORD_FILTER=Xue(Zue,(function(e,t,n=!1){if(!t||0===t.length)return null;let i=null,r=0;for(e=e.toLowerCase(),t=t.toLowerCase();r<t.length&&null===(i=hhe(e,t,0,r,n));)r=dhe(t,r+1);return i}),Que),sAe=iAe([rAe(1,t$),rAe(2,gce),rAe(3,KZ),rAe(4,e6),rAe(5,cde)],sAe);let aAe=class e extends mG{constructor(e,t){super(),this.storageService=e,this.configurationService=t,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration((()=>this.updateConfiguration())))}updateConfiguration(){this.configuredCommandsHistoryLength=e.getConfiguredCommandHistoryLength(this.configurationService),e.cache&&e.cache.limit!==this.configuredCommandsHistoryLength&&(e.cache.limit=this.configuredCommandsHistoryLength,e.saveState(this.storageService))}load(){const t=this.storageService.get(e.PREF_KEY_CACHE,0);let n;if(t)try{n=JSON.parse(t)}catch(r){}const i=e.cache=new sZ(this.configuredCommandsHistoryLength,1);if(n){let e;e=n.usesLRU?n.entries:n.entries.sort(((e,t)=>e.value-t.value)),e.forEach((e=>i.set(e.key,e.value)))}e.counter=this.storageService.getNumber(e.PREF_KEY_COUNTER,0,e.counter)}push(t){e.cache&&(e.cache.set(t,e.counter++),e.saveState(this.storageService))}peek(t){var n;return null===(n=e.cache)||void 0===n?void 0:n.peek(t)}static saveState(t){if(!e.cache)return;const n={usesLRU:!0,entries:[]};e.cache.forEach(((e,t)=>n.entries.push({key:t,value:e}))),t.store(e.PREF_KEY_CACHE,JSON.stringify(n),0,0),t.store(e.PREF_KEY_COUNTER,e.counter,0,0)}static getConfiguredCommandHistoryLength(t){var n,i;const r=null===(i=null===(n=t.getValue().workbench)||void 0===n?void 0:n.commandPalette)||void 0===i?void 0:i.history;return"number"==typeof r?r:e.DEFAULT_COMMANDS_HISTORY_LENGTH}};aAe.DEFAULT_COMMANDS_HISTORY_LENGTH=50,aAe.PREF_KEY_CACHE="commandPalette.mru.cache",aAe.PREF_KEY_COUNTER="commandPalette.mru.counter",aAe.counter=1,aAe=iAe([rAe(0,vpe),rAe(1,j3)],aAe);class lAe extends sAe{constructor(e,t,n,i,r,o){super(e,t,n,i,r,o)}getCodeEditorCommandPicks(){const e=this.activeTextEditorControl;if(!e)return[];const t=[];for(const n of e.getSupportedActions())t.push({commandId:n.id,commandAlias:n.alias,label:Whe(n.label)||n.id});return t}}var cAe=function(e,t){return function(n,i){t(n,i,e)}},uAe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(zWe){o(zWe)}}function a(e){try{l(i.throw(e))}catch(zWe){o(zWe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let hAe=class extends lAe{constructor(e,t,n,i,r,o){super({showAlias:!1},e,n,i,r,o),this.codeEditorService=t}get activeTextEditorControl(){return GZ(this.codeEditorService.getFocusedCodeEditor())}getCommandPicks(){return uAe(this,void 0,void 0,(function*(){return this.getCodeEditorCommandPicks()}))}};hAe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([cAe(0,t$),cAe(1,o$),cAe(2,gce),cAe(3,KZ),cAe(4,e6),cAe(5,cde)],hAe),d3.as(nve).registerQuickAccessProvider({ctor:hAe,prefix:hAe.PREFIX,helpEntries:[{description:C4.quickCommandHelp,needsEditor:!0}]});c6(class extends o6{constructor(){super({id:"editor.action.quickCommand",label:C4.quickCommandActionLabel,alias:"Command Palette",precondition:void 0,kbOpts:{kbExpr:gre.focus,primary:59,weight:100},contextMenuOpts:{group:"z_commands",order:1}})}run(e){e.get(Jme).quickAccess.show(hAe.PREFIX)}});var dAe=function(e,t){return function(n,i){t(n,i,e)}};let fAe=class extends Yke{constructor(e,t,n,i,r,o,s){super(!0,e,t,n,i,r,o,s)}};fAe=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}([dAe(1,A5),dAe(2,o$),dAe(3,g4),dAe(4,t$),dAe(5,vpe),dAe(6,j3)],fAe),d6(Yke.ID,fAe);c6(class extends o6{constructor(){super({id:"editor.action.toggleHighContrast",label:D4.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0}),this._originalThemeName=null}run(e,t){const n=e.get(fce);this._originalThemeName?(n.setTheme(this._originalThemeName),this._originalThemeName=null):(this._originalThemeName=n.getColorTheme().themeName,n.setTheme("hc-black"))}});var gAe=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:Vye,Emitter:Uye,KeyCode:Hye,KeyMod:jye,Position:Gye,Range:Kye,Selection:qye,SelectionDirection:$ye,MarkerSeverity:Yye,MarkerTag:Xye,Uri:Zye,Token:Qye,editor:Jye,languages:e_e},Symbol.toStringTag,{value:"Module"}));function pAe(e){return/^\d+$/.test(e)?`${e}px`:e}function mAe(){}function vAe(){return new Worker("/assets/editor.worker.a85e11ab.js",{type:"module"})}function yAe(){return new Worker("/assets/json.worker.d2a0e557.js",{type:"module"})}function _Ae(){return new Worker("/assets/css.worker.951d3382.js",{type:"module"})}function bAe(){return new Worker("/assets/html.worker.3c90cac7.js",{type:"module"})}function wAe(){return new Worker("/assets/ts.worker.d3a2ad56.js",{type:"module"})}window.MonacoEnvironment={getWorker:(e,t)=>"json"===t?new yAe:"css"===t||"scss"===t||"less"===t?new _Ae:"html"===t||"handlebars"===t||"razor"===t?new bAe:"typescript"===t||"javascript"===t?new wAe:new vAe};class CAe extends h.exports.Component{constructor(e){super(e),u(this,"editor"),u(this,"containerElement"),u(this,"_subscription"),u(this,"__prevent_trigger_change_event"),u(this,"assignRef",(e=>{this.containerElement=e})),this.containerElement=void 0}componentDidMount(){this.initMonaco()}componentDidUpdate(e){const{value:t,language:n,theme:i,height:r,options:o,width:s,className:l}=this.props,{editor:u}=this,h=u.getModel();if(null!=this.props.value&&this.props.value!==h.getValue()&&(this.__prevent_trigger_change_event=!0,this.editor.pushUndoStop(),h.pushEditOperations([],[{range:h.getFullModelRange(),text:t}]),this.editor.pushUndoStop(),this.__prevent_trigger_change_event=!1),e.language!==n&&Jye.setModelLanguage(h,n),e.theme!==i&&Jye.setTheme(i),!u||s===e.width&&r===e.height||u.layout(),e.options!==o){const e=o,{model:t}=e,n=c(e,["model"]);u.updateOptions(a(a({},l?{extraEditorClassName:l}:{}),n))}}componentWillUnmount(){this.destroyMonaco()}destroyMonaco(){if(this.editor){this.editor.dispose();const e=this.editor.getModel();e&&e.dispose()}this._subscription&&this._subscription.dispose()}initMonaco(){const e=null!=this.props.value?this.props.value:this.props.defaultValue,{language:t,theme:n,overrideServices:i,className:r}=this.props;if(this.containerElement){const o=a(a({},this.props.options),this.editorWillMount());this.editor=Jye.create(this.containerElement,a(a(a({value:e,language:t},r?{extraEditorClassName:r}:{}),o),n?{theme:n}:{}),i),this.editorDidMount(this.editor)}}editorWillMount(){const{editorWillMount:e}=this.props;return e(gAe)||{}}editorDidMount(e){this.props.editorDidMount(e,gAe),this._subscription=e.onDidChangeModelContent((t=>{this.__prevent_trigger_change_event||this.props.onChange(e.getValue(),t)}))}render(){const{width:e,height:t}=this.props,n={width:pAe(e),height:pAe(t)};return h.exports.createElement("div",{ref:this.assignRef,style:n,className:"react-monaco-editor-container"})}}u(CAe,"propTypes",{width:m.exports.oneOfType([m.exports.string,m.exports.number]),height:m.exports.oneOfType([m.exports.string,m.exports.number]),value:m.exports.string,defaultValue:m.exports.string,language:m.exports.string,theme:m.exports.string,options:m.exports.object,overrideServices:m.exports.object,editorDidMount:m.exports.func,editorWillMount:m.exports.func,onChange:m.exports.func,className:m.exports.string}),u(CAe,"defaultProps",{width:"100%",height:"100%",value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorDidMount:mAe,editorWillMount:mAe,onChange:mAe,className:null}),e_e.register({id:"log"}),Jye.defineTheme("log-light",{base:"vs",inherit:!0,colors:{},rules:[{token:"custom-INFO",foreground:"000000"},{token:"custom-ERROR",foreground:"EF4444",fontStyle:"bold"},{token:"custom-WARN",foreground:"F59E0B"},{token:"custom-DEBUG",foreground:"808080"},{token:"error",foreground:"ff0000",fontStyle:" italic"},{token:"time",foreground:"4B5563",fontStyle:"italic bold"},{token:"url",foreground:"3B82F6"}]}),Jye.defineTheme("log-dark",{base:"vs-dark",inherit:!0,colors:{},rules:[{token:"custom-INFO",foreground:"cccccc"},{token:"custom-ERROR",foreground:"EF4444",fontStyle:"bold"},{token:"custom-WARN",foreground:"FCD34D"},{token:"custom-DEBUG",foreground:"808080"},{token:"error",foreground:"F87171",fontStyle:"italic"},{token:"time",foreground:"9CA3AF",fontStyle:"italic bold"},{token:"url",foreground:"3B82F6"}]}),e_e.setMonarchTokensProvider("log",{header:/^(.*?)(\[?(INFO|WARN|ERROR|DEBUG)\]?)/,tokenizer:{root:[[/^(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2} )(?=(\[?(INFO|WARN|ERROR)\]?))/,{token:"time",next:"@root"}],[/@header/,{token:"custom-$3",next:"@text.$3"}]],text:[[/@header/,{token:"@rematch",next:"@pop"}],[/\[?(Error|error|ERROR|Failed|FAILED|failed)\]?(.*|\n)/,{token:"error",next:"@innerError"}],[/.*/,{token:"custom-$S2"}]],innerError:[[/@header/,{token:"@rematch",next:"@pop"}],[/.*/,{token:"error"},"@push"]]}});const SAe=A((e=>{const{fileData:t}=e,n="database"===t.content.category,[i,r]=h.exports.useState([]);h.exports.useEffect((()=>{var i;n&&ue(e.workspaceId,-1,"resource",(i=t.content.fileType,"mysql"===i?"jdbc_mysql":"sparkSql"===i||"hive"===i?"jdbc_hive":"jdbc_mysql")).then((e=>{r(e.map((e=>({value:e.id,label:e.name}))))}))}),[e.fileData]);return d.createElement(d.Fragment,null,d.createElement("div",{className:"px-10"},(()=>{if(n){const n=t.cfg;return d.createElement(d.Fragment,null,d.createElement(O,null,d.createElement(O.Item,{label:"选择数据源"},d.createElement("select",{value:n.datasourceFileId,className:"select",onChange:t=>{e.onChangeCfg((e=>e.datasourceFileId=Number(t.target.value)))}},d.createElement("option",{style:{display:"none"}}),i.map((e=>d.createElement("option",{key:e.value,value:e.value},e.label)))))))}})()))})),xAe=p((e=>{const{windowTab:t,fileData:n}=e,i="query"===t.menu||"database"===Di(t.type);return d.createElement(d.Fragment,null,i&&d.createElement("div",{className:"editor-header"},d.createElement(SAe,{workspaceId:e.workspaceId,onChangeCfg:e.onChangeCfg,fileData:n})),d.createElement(CAe,{width:"100%",height:i?"calc(100% - 35px)":"100%",language:Li(n),theme:e.theme,onChange:t=>{e.onChangeContent((e=>e.code=t))},value:n.content.code||"",options:{readOnly:"trash"===t.menu,fontSize:14,automaticLayout:!0,renderLineHighlight:"none"}}))}));const EAe=e=>{const{columns:t,data:n}=e;return d.createElement(d.Fragment,null,d.createElement("div",{className:f("table-container",e.className),style:e.style},d.createElement("table",null,d.createElement("thead",null,d.createElement("tr",null,t.map(((e,t)=>{let n;return n="string"==typeof e?{key:e,label:e}:e,d.createElement("th",{key:n.key},n.label)})))),d.createElement("tbody",null,n.map(((e,n)=>d.createElement("tr",{key:n},d.createElement(d.Fragment,null,Array.isArray(e)?e.map(((e,t)=>d.createElement("td",{onClick:()=>{},key:`${n}-${t}`},e))):d.createElement(d.Fragment,null,t.map((t=>{const i=t,r=e[i.key];return d.createElement("td",{onClick:()=>{},key:`${n}-${i.key}`},(null==i?void 0:i.render)?i.render(i.key,e):r)})))))))))))},kAe=p((e=>{const{fileData:t}=e,{dataStore:n}=be("BenchStore");return h.exports.useEffect((()=>{t.commitRecords||n.fetchCommitRecords(t.id)}),[t]),d.createElement(d.Fragment,null,d.createElement("div",{className:"px-10"},t.commitRecords&&d.createElement(EAe,{data:t.commitRecords,columns:[{key:"version",label:"版本",render:(e,t)=>{const n=t.inProd||t.inDev?`(${t.inDev?"开发":""}/${t.inProd?"生产":""})`:"";return`V${t.version}${n}`}},{key:"createBy",label:"提交人"},{key:"createTime",label:"提交时间",render:(e,t)=>Fi(t.createTime)},{key:"commitType",label:"变更类型"},{key:"comment",label:"备注"},{key:"action",label:"操作",render:(e,t)=>d.createElement(d.Fragment,null,d.createElement("a",null,"代码"),d.createElement("a",null,"回滚"))}]})))})),LAe=A((e=>d.createElement("div",{className:"px-20"}))),DAe=p((e=>{const{fileData:t,onChangeCfg:n}=e,[i,r]=h.exports.useState(""),[o,s]=h.exports.useState([]),a=n,l=t.cfg;return h.exports.useEffect((()=>{he().then((e=>{var t;const n=e.map((e=>({value:e.name,label:(""===e.tableName?e.name:`${e.fileName} (${e.tableName})`)+` [${e.fileName}]`})));s(n),r(null==(t=n[0])?void 0:t.value)}))}),[t]),d.createElement("div",{className:"p-20 pt-10"},d.createElement("div",{className:" font-bold text-lg"},"基础属性"),d.createElement("div",{className:" mt-10"},[{name:"name",label:"名称"},{name:"nodeId",label:"节点id"},{name:"nodeType",label:"节点类型"}].map((e=>d.createElement("div",{key:e.name,className:"flex mt-4"},d.createElement("div",{style:{minWidth:"90px"},className:"font-bold mr-10"},e.label,"："),t.content[e.name]||"-")))),d.createElement("div",{className:"mt-20 mb-10 font-bold text-lg"},"时间属性"),d.createElement("div",{className:"mt-6 flex items-center"},d.createElement("div",{style:{minWidth:"90px"},className:"font-bold mr-10"},"cron表达式："),d.createElement("input",{spellCheck:!1,value:l.cronExpression,className:"input",onChange:e=>{a((t=>t.cronExpression=e.target.value.trim()))}})),d.createElement("div",{className:"mt-6 flex items-center"},d.createElement("div",{style:{minWidth:"90px"},className:"font-bold mr-10"},"超时时间："),d.createElement("input",{spellCheck:!1,value:l.timeout,className:"input mr-6",onChange:e=>{const t=Number(e.target.value.trim());Number.isNaN(t)||a((e=>e.timeout=t))}}),"分钟"),d.createElement("div",{className:"mt-6 flex items-center"},d.createElement("div",{style:{minWidth:"90px"},className:"font-bold mr-10"},"重试次数："),d.createElement("input",{spellCheck:!1,value:l.retryCfg.count,className:"input",onChange:e=>{const t=Number(e.target.value.trim());Number.isNaN(t)||a((e=>e.retryCfg.count=t))}})),d.createElement("div",{className:"mt-6 flex items-center"},d.createElement("div",{style:{minWidth:"90px"},className:"font-bold mr-10"},"重试间隔："),d.createElement("input",{spellCheck:!1,value:l.retryCfg.interval,className:"input mr-6",onChange:e=>{const t=Number(e.target.value.trim());Number.isNaN(t)||a((e=>e.retryCfg.interval=t))}}),"分钟"),d.createElement("div",{className:"mt-20 font-bold text-lg"},"调度依赖"),d.createElement("div",{className:"my-10 "},d.createElement("div",{className:"mr-10 mb-10"},"依赖的上游节点："),d.createElement("div",null,d.createElement("select",{value:i,className:"select",onChange:e=>{r(e.target.value)}},o.filter((e=>!l.inputs.map((e=>e.name)).includes(e.value)&&!l.outputs.map((e=>e.name)).includes(e.value))).map((e=>d.createElement("option",{key:e.value,value:e.value},e.label)))),d.createElement("button",{className:"button ml-12",onClick:()=>{a((e=>e.inputs.push({name:i,tableName:"",source:"manual_record",outputNodes:[]})))}},"添加"))),d.createElement("div",{className:""},d.createElement(EAe,{columns:[{key:"name",label:"输出节点名称"},{key:"tableName",label:"输出表名"},{key:"node",label:"节点",render:(e,t)=>0==t.outputNodes.length?"-":t.outputNodes.map((e=>d.createElement("a",null,`${e.name}[${e.id}]`)))},{key:"source",label:"来源",render:(e,t)=>ui[t.source]},{key:"action",label:"操作",render:(e,t)=>d.createElement("a",{onClick:()=>{a((e=>{const n=e.inputs.findIndex((e=>e.name===t.name));-1!==n&&e.inputs.splice(n,1)}))}},"删除")}],data:l.inputs})),d.createElement("div",{className:"my-10 "},d.createElement("div",{className:"mr-10 mb-10"},"本节点的输出：")),d.createElement("div",{className:""},d.createElement(EAe,{columns:[{key:"name",label:"输出节点名称"},{key:"tableName",label:"输出表名"},{key:"node",label:"下游",render:(e,t)=>0==t.outputNodes.length?"-":d.createElement("div",{className:"flex flex-col"},t.outputNodes.map((e=>d.createElement("div",null,e.fileName,"(",e.id?d.createElement("a",null,`${e.name}[${e.id}]`):"-",")"))))},{key:"source",label:"来源",render:(e,t)=>ui[t.source]},{key:"action",label:"操作",render:(e,t)=>d.createElement("a",{className:f("link",{disabled:"system"===t.source}),onClick:()=>{}},"删除")}],data:l.outputs})))}));const NAe=e=>{const t=h.exports.useRef(null),n=e=>{var n;!(null==(n=t.current)?void 0:n.contains(e.target))&&i&&o()};h.exports.useEffect((()=>(window.addEventListener("click",n),()=>{window.removeEventListener("click",n)})));const{visible:i,onOk:r,onCancel:o}=e;return d.createElement(d.Fragment,null,d.createElement("div",{ref:t,style:{left:"calc(50% - 300px)",width:"600px",display:i?"block":"none"},className:"fixed top-6 \n        bg-vs-light-module dark:bg-vs-dark-module shadow-2xl\n         text-vs-light-text1 dark:text-vs-dark-text1"},d.createElement("div",{className:" relative w-full h-full"},i&&e.children)))},IAe=()=>{const{render:e,show:t}=(e=>{const[t,n]=h.exports.useState(!1);return{render:()=>d.createElement(d.Fragment,null,d.createElement(NAe,{visible:t,onCancel:()=>{n(!1)}},e())),show:()=>{n(!0)},hide:()=>{n(!1)}}})((()=>d.createElement("div",null,"我是黑色")));return{renderLinkDocModal:e,showLinkDockModal:t}},TAe={rightMenu:"",rightPaneSizes:{"版本":400,"调度配置":400,"参数配置":400},originCode:""},MAe=p((e=>{const{windowTab:t,theme:n,workspaceId:i}=e,r=t.key,o=t.id,{getCache:s,getUpdateCacheValue:l,removeCache:c}=si("___file_window_caches",a({},TAe)),u=s(r),h=l(r);let{inited:f,cfg:g,fileData:p,dataStore:m,changeCfg:v,changeContent:y,hideWindowFooter:_,refresh:b,save:w}=Hi(t,(e=>{h((t=>t.originCode=e.content.code)),m.fetchJobHistoryList(r)}),(()=>c));const{showLinkDockModal:C,renderLinkDocModal:S}=IAe();return d.createElement(d.Fragment,null,f&&d.createElement("div",{className:"editor-content-container"},d.createElement(zi,{options:(()=>{const e=m.isConsoleRun(r)?{name:"stop",label:"停止",icon:"stop"}:{name:"run",label:"运行",icon:"play"},n={name:"format",label:"格式化",icon:"formatter"},i=[{name:"save",label:"保存",icon:"save"},{name:"commit",label:"提交",icon:"commit2"},{name:"refresh",label:"刷新",icon:"refresh2"}];return"document"!==t.menu&&(i.push(e),i.push(n),i.push({name:"linkDoc",label:"关联文档",icon:"doc"})),"trash"===t.menu&&i.forEach((e=>{"refresh"!==e.name&&(e.disabled=!0)})),i})(),onClick:async e=>{switch(e.name){case"save":w();break;case"commit":fe(o,"test").then((()=>{M.success("提交成功!"),m.fetchCommitRecords(o)}));break;case"refresh":b();break;case"stop":m.cancelConsoleJob(r);break;case"run":"query"!==t.menu&&"development"!==t.menu||de(o,{content:p.content,cfg:g}).then((e=>{m.fetchJobHistoryList(r),m.changeConsoleJobId(r,e),_()}));break;case"format":ki(t.type)&&y((e=>e.code=HH(e.code)));break;case"linkDoc":C()}}}),d.createElement("div",{className:"content-center"},d.createElement("div",{className:"content-left"},d.createElement(Xe,{allowResize:""!==u.rightMenu,primary:"second",size:""===u.rightMenu?0:u.rightPaneSizes[u.rightMenu],split:"vertical",onChange:e=>{h((t=>t.rightPaneSizes[u.rightMenu]=e))},pane1Style:{minWidth:"0px",maxWidth:"calc(100% - 1px)"},minSize:150,maxSize:550},d.createElement("div",{className:"content-pane-left"},d.createElement(xAe,{workspaceId:i,theme:`vs-${n}`,fileData:p,windowTab:t,onChangeContent:y,onChangeCfg:v})),d.createElement("div",{className:"content-pane-right"},d.createElement("div",{className:"title"},d.createElement(_e,{type:"close_small",onClick:()=>h((e=>e.rightMenu=""))}),u.rightMenu),d.createElement("div",{className:"pane-main"},(x=p,"调度配置"===(E=u.rightMenu)?d.createElement(DAe,{fileData:x,onChangeCfg:v}):"版本"===E?d.createElement(kAe,{fileData:x}):"参数配置"===E?d.createElement(LAe,{fileData:x}):d.createElement("div",null)))))),d.createElement("div",{className:"right-nav"},d.createElement(Ui,{mode:"vertical",activeKey:u.rightMenu,options:(()=>{const e=p.moduleType;return"development"===e||"development"===t.menu?["调度配置","参数配置","版本"]:"query"===e||"query"===t.menu?["参数配置","版本"]:("document"===e||t.menu,["版本"])})().map((e=>({key:e,label:e}))),onChangeTab:e=>h((t=>t.rightMenu=e===t.rightMenu?"":e))})))),S());var x,E}));const AAe=p((e=>{const{windowTab:t,workspaceId:n,theme:i}=e,[r,o]=h.exports.useState(-1),[s,a]=h.exports.useState(),[l,c]=h.exports.useState([]),u=e=>{var t,n,i,r;(t=e,n=!1,i=!1,r=6,le.GET(`node/graph?nodeId=${t}&parent=${n}&prod=${i}&depth=${r}`)).then((t=>{a(t),o(e)}))};return h.exports.useEffect((()=>{((e,t)=>le.POST(`node/page?workspaceId=${e}`,t))(n,{pageNum:1,pageSize:10,filter:{prod:!1}}).then((e=>{var t;c(e.data);const n=null==(t=e.data[0])?void 0:t.id;n&&u(n)}))}),[t]),d.createElement("div",{className:"schedule-node-container"},d.createElement("div",{className:"header-container"}),d.createElement("div",{className:"main-container"},d.createElement("div",{className:"left-list"},l.map((e=>d.createElement("div",{className:f("item",{active:r===e.id}),onClick:()=>{u(e.id)},key:e.id},e.name)))),d.createElement("div",{className:"graph-container whitespace-pre"},s&&d.createElement($U,{graphData:YU(i,{edges:s.edges,nodes:s.nodes.map((e=>({id:e.id,name:e.name,type:e.nodeType})))}),onGraphEvent:(e,t,n)=>{"nodeClick"===e&&J((e=>{}))}}))))})),OAe=["http","https","mailto","tel"];
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
var RAe=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)};function PAe(e){return e&&"object"==typeof e?"position"in e||"type"in e?BAe(e.position):"start"in e||"end"in e?BAe(e):"line"in e||"column"in e?FAe(e):"":""}function FAe(e){return WAe(e&&e.line)+":"+WAe(e&&e.column)}function BAe(e){return FAe(e&&e.start)+"-"+FAe(e&&e.end)}function WAe(e){return e&&"number"==typeof e?e:1}class zAe extends Error{constructor(e,t,n){const i=[null,null];let r={start:{line:null,column:null},end:{line:null,column:null}};if(super(),"string"==typeof t&&(n=t,t=void 0),"string"==typeof n){const e=n.indexOf(":");-1===e?i[1]=n:(i[0]=n.slice(0,e),i[1]=n.slice(e+1))}t&&("type"in t||"position"in t?t.position&&(r=t.position):"start"in t||"end"in t?r=t:("line"in t||"column"in t)&&(r.start=t)),this.name=PAe(t)||"1:1",this.message="object"==typeof e?e.message:e,this.stack="object"==typeof e?e.stack:"",this.reason=this.message,this.fatal,this.line=r.start.line,this.column=r.start.column,this.source=i[0],this.ruleId=i[1],this.position=r,this.actual,this.expected,this.file,this.url,this.note}}zAe.prototype.file="",zAe.prototype.name="",zAe.prototype.reason="",zAe.prototype.message="",zAe.prototype.stack="",zAe.prototype.fatal=null,zAe.prototype.column=null,zAe.prototype.line=null,zAe.prototype.source=null,zAe.prototype.ruleId=null,zAe.prototype.position=null;const VAe={basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');UAe(e);let n,i=0,r=-1,o=e.length;if(void 0===t||0===t.length||t.length>e.length){for(;o--;)if(47===e.charCodeAt(o)){if(n){i=o+1;break}}else r<0&&(n=!0,r=o+1);return r<0?"":e.slice(i,r)}if(t===e)return"";let s=-1,a=t.length-1;for(;o--;)if(47===e.charCodeAt(o)){if(n){i=o+1;break}}else s<0&&(n=!0,s=o+1),a>-1&&(e.charCodeAt(o)===t.charCodeAt(a--)?a<0&&(r=o):(a=-1,r=s));i===r?r=s:r<0&&(r=e.length);return e.slice(i,r)},dirname:function(e){if(UAe(e),0===e.length)return".";let t,n=-1,i=e.length;for(;--i;)if(47===e.charCodeAt(i)){if(t){n=i;break}}else t||(t=!0);return n<0?47===e.charCodeAt(0)?"/":".":1===n&&47===e.charCodeAt(0)?"//":e.slice(0,n)},extname:function(e){UAe(e);let t,n=e.length,i=-1,r=0,o=-1,s=0;for(;n--;){const a=e.charCodeAt(n);if(47!==a)i<0&&(t=!0,i=n+1),46===a?o<0?o=n:1!==s&&(s=1):o>-1&&(s=-1);else if(t){r=n+1;break}}if(o<0||i<0||0===s||1===s&&o===i-1&&o===r+1)return"";return e.slice(o,i)},join:function(...e){let t,n=-1;for(;++n<e.length;)UAe(e[n]),e[n]&&(t=void 0===t?e[n]:t+"/"+e[n]);return void 0===t?".":function(e){UAe(e);const t=47===e.charCodeAt(0);let n=function(e,t){let n,i,r="",o=0,s=-1,a=0,l=-1;for(;++l<=e.length;){if(l<e.length)n=e.charCodeAt(l);else{if(47===n)break;n=47}if(47===n){if(s===l-1||1===a);else if(s!==l-1&&2===a){if(r.length<2||2!==o||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){if(i=r.lastIndexOf("/"),i!==r.length-1){i<0?(r="",o=0):(r=r.slice(0,i),o=r.length-1-r.lastIndexOf("/")),s=l,a=0;continue}}else if(r.length>0){r="",o=0,s=l,a=0;continue}t&&(r=r.length>0?r+"/..":"..",o=2)}else r.length>0?r+="/"+e.slice(s+1,l):r=e.slice(s+1,l),o=l-s-1;s=l,a=0}else 46===n&&a>-1?a++:a=-1}return r}(e,!t);0!==n.length||t||(n=".");n.length>0&&47===e.charCodeAt(e.length-1)&&(n+="/");return t?"/"+n:n}(t)},sep:"/"};function UAe(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const HAe={cwd:function(){return"/"}};function jAe(e){return null!==e&&"object"==typeof e&&e.href&&e.origin}function GAe(e){if("string"==typeof e)e=new URL(e);else if(!jAe(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if("file:"!==e.protocol){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return function(e){if(""!==e.hostname){const e=new TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}const t=e.pathname;let n=-1;for(;++n<t.length;)if(37===t.charCodeAt(n)&&50===t.charCodeAt(n+1)){const e=t.charCodeAt(n+2);if(70===e||102===e){const e=new TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(t)}(e)}const KAe=["history","path","basename","stem","extname","dirname"];class qAe{constructor(e){let t;t=e?"string"==typeof e||RAe(e)?{value:e}:jAe(e)?{path:e}:e:{},this.data={},this.messages=[],this.history=[],this.cwd=HAe.cwd(),this.value,this.stored,this.result,this.map;let n,i=-1;for(;++i<KAe.length;){const e=KAe[i];e in t&&void 0!==t[e]&&(this[e]="history"===e?[...t[e]]:t[e])}for(n in t)KAe.includes(n)||(this[n]=t[n])}get path(){return this.history[this.history.length-1]}set path(e){jAe(e)&&(e=GAe(e)),YAe(e,"path"),this.path!==e&&this.history.push(e)}get dirname(){return"string"==typeof this.path?VAe.dirname(this.path):void 0}set dirname(e){XAe(this.basename,"dirname"),this.path=VAe.join(e||"",this.basename)}get basename(){return"string"==typeof this.path?VAe.basename(this.path):void 0}set basename(e){YAe(e,"basename"),$Ae(e,"basename"),this.path=VAe.join(this.dirname||"",e)}get extname(){return"string"==typeof this.path?VAe.extname(this.path):void 0}set extname(e){if($Ae(e,"extname"),XAe(this.dirname,"extname"),e){if(46!==e.charCodeAt(0))throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=VAe.join(this.dirname,this.stem+(e||""))}get stem(){return"string"==typeof this.path?VAe.basename(this.path,this.extname):void 0}set stem(e){YAe(e,"stem"),$Ae(e,"stem"),this.path=VAe.join(this.dirname||"",e+(this.extname||""))}toString(e){return(this.value||"").toString(e)}message(e,t,n){const i=new zAe(e,t,n);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}info(e,t,n){const i=this.message(e,t,n);return i.fatal=null,i}fail(e,t,n){const i=this.message(e,t,n);throw i.fatal=!0,i}}function $Ae(e,t){if(e&&e.includes(VAe.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+VAe.sep+"`")}function YAe(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function XAe(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function ZAe(e){if(e)throw e}var QAe=Object.prototype.hasOwnProperty,JAe=Object.prototype.toString,eOe=Object.defineProperty,tOe=Object.getOwnPropertyDescriptor,nOe=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===JAe.call(e)},iOe=function(e){if(!e||"[object Object]"!==JAe.call(e))return!1;var t,n=QAe.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&QAe.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!i)return!1;for(t in e);return void 0===t||QAe.call(e,t)},rOe=function(e,t){eOe&&"__proto__"===t.name?eOe(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},oOe=function(e,t){if("__proto__"===t){if(!QAe.call(e,t))return;if(tOe)return tOe(e,t).value}return e[t]},sOe=function e(){var t,n,i,r,o,s,a=arguments[0],l=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},l=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});l<c;++l)if(null!=(t=arguments[l]))for(n in t)i=oOe(a,n),a!==(r=oOe(t,n))&&(u&&r&&(iOe(r)||(o=nOe(r)))?(o?(o=!1,s=i&&nOe(i)?i:[]):s=i&&iOe(i)?i:{},rOe(a,{name:n,newValue:e(u,s,r)})):void 0!==r&&rOe(a,{name:n,newValue:r}));return a};function aOe(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function lOe(){const e=[],t={run:function(...t){let n=-1;const i=t.pop();if("function"!=typeof i)throw new TypeError("Expected function as last argument, not "+i);!function r(o,...s){const a=e[++n];let l=-1;if(o)i(o);else{for(;++l<t.length;)null!==s[l]&&void 0!==s[l]||(s[l]=t[l]);t=s,a?function(e,t){let n;return i;function i(...t){const i=e.length>t.length;let a;i&&t.push(r);try{a=e.apply(this,t)}catch(o){const t=o;if(i&&n)throw t;return r(t)}i||(a instanceof Promise?a.then(s,r):a instanceof Error?r(a):s(a))}function r(e,...i){n||(n=!0,t(e,...i))}function s(e){r(null,e)}}(a,r)(...s):i(null,...s)}}(null,...t)},use:function(n){if("function"!=typeof n)throw new TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}};return t}const cOe=function e(){const t=lOe(),n=[];let i,r={},o=-1;return s.data=function(e,t){if("string"==typeof e)return 2===arguments.length?(gOe("data",i),r[e]=t,s):uOe.call(r,e)&&r[e]||null;if(e)return gOe("data",i),r=e,s;return r},s.Parser=void 0,s.Compiler=void 0,s.freeze=function(){if(i)return s;for(;++o<n.length;){const[e,...i]=n[o];if(!1===i[0])continue;!0===i[0]&&(i[0]=void 0);const r=e.call(s,...i);"function"==typeof r&&t.use(r)}return i=!0,o=Number.POSITIVE_INFINITY,s},s.attachers=n,s.use=function(e,...t){let o;if(gOe("use",i),null==e);else if("function"==typeof e)u(e,...t);else{if("object"!=typeof e)throw new TypeError("Expected usable value, not `"+e+"`");Array.isArray(e)?c(e):l(e)}o&&(r.settings=Object.assign(r.settings||{},o));return s;function a(e){if("function"==typeof e)u(e);else{if("object"!=typeof e)throw new TypeError("Expected usable value, not `"+e+"`");if(Array.isArray(e)){const[t,...n]=e;u(t,...n)}else l(e)}}function l(e){c(e.plugins),e.settings&&(o=Object.assign(o||{},e.settings))}function c(e){let t=-1;if(null==e);else{if(!Array.isArray(e))throw new TypeError("Expected a list of plugins, not `"+e+"`");for(;++t<e.length;){a(e[t])}}}function u(e,t){let i,r=-1;for(;++r<n.length;)if(n[r][0]===e){i=n[r];break}i?(aOe(i[1])&&aOe(t)&&(t=sOe(!0,i[1],t)),i[1]=t):n.push([...arguments])}},s.parse=function(e){s.freeze();const t=vOe(e),n=s.Parser;if(dOe("parse",n),hOe(n,"parse"))return new n(String(t),t).parse();return n(String(t),t)},s.stringify=function(e,t){s.freeze();const n=vOe(t),i=s.Compiler;if(fOe("stringify",i),pOe(e),hOe(i,"compile"))return new i(e,n).compile();return i(e,n)},s.run=function(e,n,i){pOe(e),s.freeze(),i||"function"!=typeof n||(i=n,n=void 0);if(!i)return new Promise(r);function r(r,o){function s(t,n,s){n=n||e,t?o(t):r?r(n):i(null,n,s)}t.run(e,vOe(n),s)}r(null,i)},s.runSync=function(e,t){let n,i;return s.run(e,t,r),mOe("runSync","run",i),n;function r(e,t){ZAe(e),n=t,i=!0}},s.process=function(e,t){if(s.freeze(),dOe("process",s.Parser),fOe("process",s.Compiler),!t)return new Promise(n);function n(n,i){const r=vOe(e);function o(e,r){e||!r?i(e):n?n(r):t(null,r)}s.run(s.parse(r),r,((e,t,n)=>{if(!e&&t&&n){const r=s.stringify(t,n);null==r||("string"==typeof(i=r)||RAe(i)?n.value=r:n.result=r),o(e,n)}else o(e);var i}))}n(null,t)},s.processSync=function(e){let t;s.freeze(),dOe("processSync",s.Parser),fOe("processSync",s.Compiler);const n=vOe(e);return s.process(n,i),mOe("processSync","process",t),n;function i(e){t=!0,ZAe(e)}},s;function s(){const t=e();let i=-1;for(;++i<n.length;)t.use(...n[i]);return t.data(sOe(!0,{},r)),t}}().freeze(),uOe={}.hasOwnProperty;function hOe(e,t){return"function"==typeof e&&e.prototype&&(function(e){let t;for(t in e)if(uOe.call(e,t))return!0;return!1}(e.prototype)||t in e.prototype)}function dOe(e,t){if("function"!=typeof t)throw new TypeError("Cannot `"+e+"` without `Parser`")}function fOe(e,t){if("function"!=typeof t)throw new TypeError("Cannot `"+e+"` without `Compiler`")}function gOe(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function pOe(e){if(!aOe(e)||"string"!=typeof e.type)throw new TypeError("Expected node, got `"+e+"`")}function mOe(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function vOe(e){return function(e){return Boolean(e&&"object"==typeof e&&"message"in e&&"messages"in e)}(e)?e:new qAe(e)}function yOe(e,t){return e&&"object"==typeof e&&(e.value||(t?e.alt:"")||"children"in e&&_Oe(e.children,t)||Array.isArray(e)&&_Oe(e,t))||""}function _Oe(e,t){for(var n=[],i=-1;++i<e.length;)n[i]=yOe(e[i],t);return n.join("")}function bOe(e,t,n,i){const r=e.length;let o,s=0;if(t=t<0?-t>r?0:r+t:t>r?r:t,n=n>0?n:0,i.length<1e4)o=Array.from(i),o.unshift(t,n),[].splice.apply(e,o);else for(n&&[].splice.apply(e,[t,n]);s<i.length;)o=i.slice(s,s+1e4),o.unshift(t,0),[].splice.apply(e,o),s+=1e4,t+=1e4}function wOe(e,t){return e.length>0?(bOe(e,e.length,0,t),e):t}const COe={}.hasOwnProperty;function SOe(e){const t={};let n=-1;for(;++n<e.length;)xOe(t,e[n]);return t}function xOe(e,t){let n;for(n in t){const i=(COe.call(e,n)?e[n]:void 0)||(e[n]={}),r=t[n];let o;for(o in r){COe.call(i,o)||(i[o]=[]);const e=r[o];EOe(i[o],Array.isArray(e)?e:e?[e]:[])}}}function EOe(e,t){let n=-1;const i=[];for(;++n<t.length;)("after"===t[n].add?e:i).push(t[n]);bOe(e,0,0,i)}const kOe=BOe(/[A-Za-z]/),LOe=BOe(/\d/),DOe=BOe(/[\dA-Fa-f]/),NOe=BOe(/[\dA-Za-z]/),IOe=BOe(/[!-/:-@[-`{-~]/),TOe=BOe(/[#-'*+\--9=?A-Z^-~]/);function MOe(e){return null!==e&&(e<32||127===e)}function AOe(e){return null!==e&&(e<0||32===e)}function OOe(e){return null!==e&&e<-2}function ROe(e){return-2===e||-1===e||32===e}const POe=BOe(/\s/),FOe=BOe(/[!-/:-@[-`{-~\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/);function BOe(e){return function(t){return null!==t&&e.test(String.fromCharCode(t))}}function WOe(e,t,n,i){const r=i?i-1:Number.POSITIVE_INFINITY;let o=0;return function(i){if(ROe(i))return e.enter(n),s(i);return t(i)};function s(i){return ROe(i)&&o++<r?(e.consume(i),s):(e.exit(n),t(i))}}const zOe={tokenize:function(e){const t=e.attempt(this.parser.constructs.contentInitial,(function(n){if(null===n)return void e.consume(n);return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),WOe(e,t,"linePrefix")}),(function(t){return e.enter("paragraph"),i(t)}));let n;return t;function i(t){const i=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=i),n=i,r(t)}function r(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):OOe(t)?(e.consume(t),e.exit("chunkText"),i):(e.consume(t),r)}}};const VOe={tokenize:function(e){const t=this,n=[];let i,r,o,s=0;return a;function a(i){if(s<n.length){const r=n[s];return t.containerState=r[1],e.attempt(r[0].continuation,l,c)(i)}return c(i)}function l(e){if(s++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&y();const n=t.events.length;let r,o=n;for(;o--;)if("exit"===t.events[o][0]&&"chunkFlow"===t.events[o][1].type){r=t.events[o][1].end;break}v(s);let a=n;for(;a<t.events.length;)t.events[a][1].end=Object.assign({},r),a++;return bOe(t.events,o+1,0,t.events.slice(n)),t.events.length=a,c(e)}return a(e)}function c(r){if(s===n.length){if(!i)return d(r);if(i.currentConstruct&&i.currentConstruct.concrete)return g(r);t.interrupt=Boolean(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(UOe,u,h)(r)}function u(e){return i&&y(),v(s),d(e)}function h(e){return t.parser.lazy[t.now().line]=s!==n.length,o=t.now().offset,g(e)}function d(n){return t.containerState={},e.attempt(UOe,f,g)(n)}function f(e){return s++,n.push([t.currentConstruct,t.containerState]),d(e)}function g(n){return null===n?(i&&y(),v(0),void e.consume(n)):(i=i||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:r,_tokenizer:i}),p(n))}function p(n){return null===n?(m(e.exit("chunkFlow"),!0),v(0),void e.consume(n)):OOe(n)?(e.consume(n),m(e.exit("chunkFlow")),s=0,t.interrupt=void 0,a):(e.consume(n),p)}function m(e,n){const a=t.sliceStream(e);if(n&&a.push(null),e.previous=r,r&&(r.next=e),r=e,i.defineSkip(e.start),i.write(a),t.parser.lazy[e.start.line]){let e=i.events.length;for(;e--;)if(i.events[e][1].start.offset<o&&(!i.events[e][1].end||i.events[e][1].end.offset>o))return;const n=t.events.length;let r,a,l=n;for(;l--;)if("exit"===t.events[l][0]&&"chunkFlow"===t.events[l][1].type){if(r){a=t.events[l][1].end;break}r=!0}for(v(s),e=n;e<t.events.length;)t.events[e][1].end=Object.assign({},a),e++;bOe(t.events,l+1,0,t.events.slice(n)),t.events.length=e}}function v(i){let r=n.length;for(;r-- >i;){const i=n[r];t.containerState=i[1],i[0].exit.call(t,e)}n.length=i}function y(){i.write([null]),r=void 0,i=void 0,t.containerState._closeFlow=void 0}}},UOe={tokenize:function(e,t,n){return WOe(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};function HOe(e){return null===e||AOe(e)||POe(e)?1:FOe(e)?2:void 0}function jOe(e,t,n){const i=[];let r=-1;for(;++r<e.length;){const o=e[r].resolveAll;o&&!i.includes(o)&&(t=o(t,n),i.push(o))}return t}const GOe={name:"attention",tokenize:function(e,t){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,r=HOe(i);let o;return function(t){return e.enter("attentionSequence"),o=t,s(t)};function s(a){if(a===o)return e.consume(a),s;const l=e.exit("attentionSequence"),c=HOe(a),u=!c||2===c&&r||n.includes(a),h=!r||2===r&&c||n.includes(i);return l._open=Boolean(42===o?u:u&&(r||!h)),l._close=Boolean(42===o?h:h&&(c||!u)),t(a)}},resolveAll:function(e,t){let n,i,r,o,s,a,l,c,u=-1;for(;++u<e.length;)if("enter"===e[u][0]&&"attentionSequence"===e[u][1].type&&e[u][1]._close)for(n=u;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[u][1]).charCodeAt(0)){if((e[n][1]._close||e[u][1]._open)&&(e[u][1].end.offset-e[u][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[u][1].end.offset-e[u][1].start.offset)%3))continue;a=e[n][1].end.offset-e[n][1].start.offset>1&&e[u][1].end.offset-e[u][1].start.offset>1?2:1;const h=Object.assign({},e[n][1].end),d=Object.assign({},e[u][1].start);KOe(h,-a),KOe(d,a),o={type:a>1?"strongSequence":"emphasisSequence",start:h,end:Object.assign({},e[n][1].end)},s={type:a>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[u][1].start),end:d},r={type:a>1?"strongText":"emphasisText",start:Object.assign({},e[n][1].end),end:Object.assign({},e[u][1].start)},i={type:a>1?"strong":"emphasis",start:Object.assign({},o.start),end:Object.assign({},s.end)},e[n][1].end=Object.assign({},o.start),e[u][1].start=Object.assign({},s.end),l=[],e[n][1].end.offset-e[n][1].start.offset&&(l=wOe(l,[["enter",e[n][1],t],["exit",e[n][1],t]])),l=wOe(l,[["enter",i,t],["enter",o,t],["exit",o,t],["enter",r,t]]),l=wOe(l,jOe(t.parser.constructs.insideSpan.null,e.slice(n+1,u),t)),l=wOe(l,[["exit",r,t],["enter",s,t],["exit",s,t],["exit",i,t]]),e[u][1].end.offset-e[u][1].start.offset?(c=2,l=wOe(l,[["enter",e[u][1],t],["exit",e[u][1],t]])):c=0,bOe(e,n-1,u-n+3,l),u=n+l.length-c-2;break}u=-1;for(;++u<e.length;)"attentionSequence"===e[u][1].type&&(e[u][1].type="data");return e}};function KOe(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const qOe={name:"autolink",tokenize:function(e,t,n){let i=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),r};function r(t){return kOe(t)?(e.consume(t),o):TOe(t)?l(t):n(t)}function o(e){return 43===e||45===e||46===e||NOe(e)?s(e):l(e)}function s(t){return 58===t?(e.consume(t),a):(43===t||45===t||46===t||NOe(t))&&i++<32?(e.consume(t),s):l(t)}function a(t){return 62===t?(e.exit("autolinkProtocol"),d(t)):null===t||32===t||60===t||MOe(t)?n(t):(e.consume(t),a)}function l(t){return 64===t?(e.consume(t),i=0,c):TOe(t)?(e.consume(t),l):n(t)}function c(e){return NOe(e)?u(e):n(e)}function u(t){return 46===t?(e.consume(t),i=0,c):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",d(t)):h(t)}function h(t){return(45===t||NOe(t))&&i++<63?(e.consume(t),45===t?h:u):n(t)}function d(n){return e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t}}};const $Oe={tokenize:function(e,t,n){return WOe(e,(function(e){return null===e||OOe(e)?t(e):n(e)}),"linePrefix")},partial:!0};const YOe={name:"blockQuote",tokenize:function(e,t,n){const i=this;return function(t){if(62===t){const n=i.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),r}return n(t)};function r(n){return ROe(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}},continuation:{tokenize:function(e,t,n){return WOe(e,e.attempt(YOe,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}},exit:function(e){e.exit("blockQuote")}};const XOe={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return IOe(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}};const ZOe=document.createElement("i");function QOe(e){const t="&"+e+";";ZOe.innerHTML=t;const n=ZOe.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&(n!==t&&n)}const JOe={name:"characterReference",tokenize:function(e,t,n){const i=this;let r,o,s=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),a};function a(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),l):(e.enter("characterReferenceValue"),r=31,o=NOe,c(t))}function l(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),r=6,o=DOe,c):(e.enter("characterReferenceValue"),r=7,o=LOe,c(t))}function c(a){let l;return 59===a&&s?(l=e.exit("characterReferenceValue"),o!==NOe||QOe(i.sliceSerialize(l))?(e.enter("characterReferenceMarker"),e.consume(a),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(a)):o(a)&&s++<r?(e.consume(a),c):n(a)}}};const eRe={name:"codeFenced",tokenize:function(e,t,n){const i=this,r={tokenize:function(e,t,n){let i=0;return WOe(e,r,"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function r(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),o(t)}function o(t){return t===l?(e.consume(t),i++,o):i<c?n(t):(e.exit("codeFencedFenceSequence"),WOe(e,s,"whitespace")(t))}function s(i){return null===i||OOe(i)?(e.exit("codeFencedFence"),t(i)):n(i)}},partial:!0},o={tokenize:function(e,t,n){const i=this;return r;function r(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o}function o(e){return i.parser.lazy[i.now().line]?n(e):t(e)}},partial:!0},s=this.events[this.events.length-1],a=s&&"linePrefix"===s[1].type?s[2].sliceSerialize(s[1],!0).length:0;let l,c=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),l=t,u(t)};function u(t){return t===l?(e.consume(t),c++,u):(e.exit("codeFencedFenceSequence"),c<3?n(t):WOe(e,h,"whitespace")(t))}function h(t){return null===t||OOe(t)?p(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return null===t||AOe(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),WOe(e,f,"whitespace")(t)):96===t&&t===l?n(t):(e.consume(t),d)}function f(t){return null===t||OOe(t)?p(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(t))}function g(t){return null===t||OOe(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),p(t)):96===t&&t===l?n(t):(e.consume(t),g)}function p(n){return e.exit("codeFencedFence"),i.interrupt?t(n):m(n)}function m(t){return null===t?y(t):OOe(t)?e.attempt(o,e.attempt(r,y,a?WOe(e,m,"linePrefix",a+1):m),y)(t):(e.enter("codeFlowValue"),v(t))}function v(t){return null===t||OOe(t)?(e.exit("codeFlowValue"),m(t)):(e.consume(t),v)}function y(n){return e.exit("codeFenced"),t(n)}},concrete:!0};const tRe={name:"codeIndented",tokenize:function(e,t,n){const i=this;return function(t){return e.enter("codeIndented"),WOe(e,r,"linePrefix",5)(t)};function r(e){const t=i.events[i.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?o(e):n(e)}function o(t){return null===t?a(t):OOe(t)?e.attempt(nRe,o,a)(t):(e.enter("codeFlowValue"),s(t))}function s(t){return null===t||OOe(t)?(e.exit("codeFlowValue"),o(t)):(e.consume(t),s)}function a(n){return e.exit("codeIndented"),t(n)}}},nRe={tokenize:function(e,t,n){const i=this;return r;function r(t){return i.parser.lazy[i.now().line]?n(t):OOe(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r):WOe(e,o,"linePrefix",5)(t)}function o(e){const o=i.events[i.events.length-1];return o&&"linePrefix"===o[1].type&&o[2].sliceSerialize(o[1],!0).length>=4?t(e):OOe(e)?r(e):n(e)}},partial:!0};const iRe={name:"codeText",tokenize:function(e,t,n){let i,r,o=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),s(t)};function s(t){return 96===t?(e.consume(t),o++,s):(e.exit("codeTextSequence"),a(t))}function a(t){return null===t?n(t):96===t?(r=e.enter("codeTextSequence"),i=0,c(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),a):OOe(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a):(e.enter("codeTextData"),l(t))}function l(t){return null===t||32===t||96===t||OOe(t)?(e.exit("codeTextData"),a(t)):(e.consume(t),l)}function c(n){return 96===n?(e.consume(n),i++,c):i===o?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(r.type="codeTextData",l(n))}},resolve:function(e){let t,n,i=e.length-4,r=3;if(!("lineEnding"!==e[r][1].type&&"space"!==e[r][1].type||"lineEnding"!==e[i][1].type&&"space"!==e[i][1].type))for(t=r;++t<i;)if("codeTextData"===e[t][1].type){e[r][1].type="codeTextPadding",e[i][1].type="codeTextPadding",r+=2,i-=2;break}t=r-1,i++;for(;++t<=i;)void 0===n?t!==i&&"lineEnding"!==e[t][1].type&&(n=t):t!==i&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),i-=t-n-2,t=n+2),n=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};function rRe(e){const t={};let n,i,r,o,s,a,l,c=-1;for(;++c<e.length;){for(;c in t;)c=t[c];if(n=e[c],c&&"chunkFlow"===n[1].type&&"listItemPrefix"===e[c-1][1].type&&(a=n[1]._tokenizer.events,r=0,r<a.length&&"lineEndingBlank"===a[r][1].type&&(r+=2),r<a.length&&"content"===a[r][1].type))for(;++r<a.length&&"content"!==a[r][1].type;)"chunkText"===a[r][1].type&&(a[r][1]._isInFirstContentOfListItem=!0,r++);if("enter"===n[0])n[1].contentType&&(Object.assign(t,oRe(e,c)),c=t[c],l=!0);else if(n[1]._container){for(r=c,i=void 0;r--&&(o=e[r],"lineEnding"===o[1].type||"lineEndingBlank"===o[1].type);)"enter"===o[0]&&(i&&(e[i][1].type="lineEndingBlank"),o[1].type="lineEnding",i=r);i&&(n[1].end=Object.assign({},e[i][1].start),s=e.slice(i,c),s.unshift(n),bOe(e,i,c-i+1,s))}}return!l}function oRe(e,t){const n=e[t][1],i=e[t][2];let r=t-1;const o=[],s=n._tokenizer||i.parser[n.contentType](n.start),a=s.events,l=[],c={};let u,h,d=-1,f=n,g=0,p=0;const m=[p];for(;f;){for(;e[++r][1]!==f;);o.push(r),f._tokenizer||(u=i.sliceStream(f),f.next||u.push(null),h&&s.defineSkip(f.start),f._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(u),f._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),h=f,f=f.next}for(f=n;++d<a.length;)"exit"===a[d][0]&&"enter"===a[d-1][0]&&a[d][1].type===a[d-1][1].type&&a[d][1].start.line!==a[d][1].end.line&&(p=d+1,m.push(p),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(s.events=[],f?(f._tokenizer=void 0,f.previous=void 0):m.pop(),d=m.length;d--;){const t=a.slice(m[d],m[d+1]),n=o.pop();l.unshift([n,n+t.length-1]),bOe(e,n,2,t)}for(d=-1;++d<l.length;)c[g+l[d][0]]=g+l[d][1],g+=l[d][1]-l[d][0]-1;return c}const sRe={tokenize:function(e,t){let n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?r(t):OOe(t)?e.check(aRe,o,r)(t):(e.consume(t),i)}function r(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function o(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}},resolve:function(e){return rRe(e),e}},aRe={tokenize:function(e,t,n){const i=this;return function(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),WOe(e,r,"linePrefix")};function r(r){if(null===r||OOe(r))return n(r);const o=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&o&&"linePrefix"===o[1].type&&o[2].sliceSerialize(o[1],!0).length>=4?t(r):e.interrupt(i.parser.constructs.flow,n,t)(r)}},partial:!0};function lRe(e,t,n,i,r,o,s,a,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return function(t){if(60===t)return e.enter(i),e.enter(r),e.enter(o),e.consume(t),e.exit(o),h;if(null===t||41===t||MOe(t))return n(t);return e.enter(i),e.enter(s),e.enter(a),e.enter("chunkString",{contentType:"string"}),g(t)};function h(n){return 62===n?(e.enter(o),e.consume(n),e.exit(o),e.exit(r),e.exit(i),t):(e.enter(a),e.enter("chunkString",{contentType:"string"}),d(n))}function d(t){return 62===t?(e.exit("chunkString"),e.exit(a),h(t)):null===t||60===t||OOe(t)?n(t):(e.consume(t),92===t?f:d)}function f(t){return 60===t||62===t||92===t?(e.consume(t),d):d(t)}function g(r){return 40===r?++u>c?n(r):(e.consume(r),g):41===r?u--?(e.consume(r),g):(e.exit("chunkString"),e.exit(a),e.exit(s),e.exit(i),t(r)):null===r||AOe(r)?u?n(r):(e.exit("chunkString"),e.exit(a),e.exit(s),e.exit(i),t(r)):MOe(r)?n(r):(e.consume(r),92===r?p:g)}function p(t){return 40===t||41===t||92===t?(e.consume(t),g):g(t)}}function cRe(e,t,n,i,r,o){const s=this;let a,l=0;return function(t){return e.enter(i),e.enter(r),e.consume(t),e.exit(r),e.enter(o),c};function c(h){return null===h||91===h||93===h&&!a||94===h&&!l&&"_hiddenFootnoteSupport"in s.parser.constructs||l>999?n(h):93===h?(e.exit(o),e.enter(r),e.consume(h),e.exit(r),e.exit(i),t):OOe(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),u(h))}function u(t){return null===t||91===t||93===t||OOe(t)||l++>999?(e.exit("chunkString"),c(t)):(e.consume(t),a=a||!ROe(t),92===t?h:u)}function h(t){return 91===t||92===t||93===t?(e.consume(t),l++,u):u(t)}}function uRe(e,t,n,i,r,o){let s;return function(t){return e.enter(i),e.enter(r),e.consume(t),e.exit(r),s=40===t?41:t,a};function a(n){return n===s?(e.enter(r),e.consume(n),e.exit(r),e.exit(i),t):(e.enter(o),l(n))}function l(t){return t===s?(e.exit(o),a(s)):null===t?n(t):OOe(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),WOe(e,l,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(t))}function c(t){return t===s||null===t||OOe(t)?(e.exit("chunkString"),l(t)):(e.consume(t),92===t?u:c)}function u(t){return t===s||92===t?(e.consume(t),c):c(t)}}function hRe(e,t){let n;return function i(r){if(OOe(r))return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),n=!0,i;if(ROe(r))return WOe(e,i,n?"linePrefix":"lineSuffix")(r);return t(r)}}function dRe(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const fRe={name:"definition",tokenize:function(e,t,n){const i=this;let r;return function(t){return e.enter("definition"),cRe.call(i,e,o,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function o(t){return r=dRe(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),hRe(e,lRe(e,e.attempt(gRe,WOe(e,s,"whitespace"),WOe(e,s,"whitespace")),n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):n(t)}function s(o){return null===o||OOe(o)?(e.exit("definition"),i.parser.defined.includes(r)||i.parser.defined.push(r),t(o)):n(o)}}},gRe={tokenize:function(e,t,n){return function(t){return AOe(t)?hRe(e,i)(t):n(t)};function i(t){return 34===t||39===t||40===t?uRe(e,WOe(e,r,"whitespace"),n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):n(t)}function r(e){return null===e||OOe(e)?t(e):n(e)}},partial:!0};const pRe={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),i};function i(i){return OOe(i)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(i)):n(i)}}};const mRe={name:"headingAtx",tokenize:function(e,t,n){const i=this;let r=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),o(t)};function o(a){return 35===a&&r++<6?(e.consume(a),o):null===a||AOe(a)?(e.exit("atxHeadingSequence"),i.interrupt?t(a):s(a)):n(a)}function s(n){return 35===n?(e.enter("atxHeadingSequence"),a(n)):null===n||OOe(n)?(e.exit("atxHeading"),t(n)):ROe(n)?WOe(e,s,"whitespace")(n):(e.enter("atxHeadingText"),l(n))}function a(t){return 35===t?(e.consume(t),a):(e.exit("atxHeadingSequence"),s(t))}function l(t){return null===t||35===t||AOe(t)?(e.exit("atxHeadingText"),s(t)):(e.consume(t),l)}},resolve:function(e,t){let n,i,r=e.length-2,o=3;"whitespace"===e[o][1].type&&(o+=2);r-2>o&&"whitespace"===e[r][1].type&&(r-=2);"atxHeadingSequence"===e[r][1].type&&(o===r-1||r-4>o&&"whitespace"===e[r-2][1].type)&&(r-=o+1===r?2:4);r>o&&(n={type:"atxHeadingText",start:e[o][1].start,end:e[r][1].end},i={type:"chunkText",start:e[o][1].start,end:e[r][1].end,contentType:"text"},bOe(e,o,r-o+1,[["enter",n,t],["enter",i,t],["exit",i,t],["exit",n,t]]));return e}};const vRe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],yRe=["pre","script","style","textarea"],_Re={name:"htmlFlow",tokenize:function(e,t,n){const i=this;let r,o,s,a,l;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),c};function c(a){return 33===a?(e.consume(a),u):47===a?(e.consume(a),f):63===a?(e.consume(a),r=3,i.interrupt?t:O):kOe(a)?(e.consume(a),s=String.fromCharCode(a),o=!0,g):n(a)}function u(o){return 45===o?(e.consume(o),r=2,h):91===o?(e.consume(o),r=5,s="CDATA[",a=0,d):kOe(o)?(e.consume(o),r=4,i.interrupt?t:O):n(o)}function h(r){return 45===r?(e.consume(r),i.interrupt?t:O):n(r)}function d(r){return r===s.charCodeAt(a++)?(e.consume(r),a===s.length?i.interrupt?t:k:d):n(r)}function f(t){return kOe(t)?(e.consume(t),s=String.fromCharCode(t),g):n(t)}function g(a){return null===a||47===a||62===a||AOe(a)?47!==a&&o&&yRe.includes(s.toLowerCase())?(r=1,i.interrupt?t(a):k(a)):vRe.includes(s.toLowerCase())?(r=6,47===a?(e.consume(a),p):i.interrupt?t(a):k(a)):(r=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(a):o?v(a):m(a)):45===a||NOe(a)?(e.consume(a),s+=String.fromCharCode(a),g):n(a)}function p(r){return 62===r?(e.consume(r),i.interrupt?t:k):n(r)}function m(t){return ROe(t)?(e.consume(t),m):x(t)}function v(t){return 47===t?(e.consume(t),x):58===t||95===t||kOe(t)?(e.consume(t),y):ROe(t)?(e.consume(t),v):x(t)}function y(t){return 45===t||46===t||58===t||95===t||NOe(t)?(e.consume(t),y):_(t)}function _(t){return 61===t?(e.consume(t),b):ROe(t)?(e.consume(t),_):v(t)}function b(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,w):ROe(t)?(e.consume(t),b):(l=null,C(t))}function w(t){return null===t||OOe(t)?n(t):t===l?(e.consume(t),S):(e.consume(t),w)}function C(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||AOe(t)?_(t):(e.consume(t),C)}function S(e){return 47===e||62===e||ROe(e)?v(e):n(e)}function x(t){return 62===t?(e.consume(t),E):n(t)}function E(t){return ROe(t)?(e.consume(t),E):null===t||OOe(t)?k(t):n(t)}function k(t){return 45===t&&2===r?(e.consume(t),I):60===t&&1===r?(e.consume(t),T):62===t&&4===r?(e.consume(t),R):63===t&&3===r?(e.consume(t),O):93===t&&5===r?(e.consume(t),A):!OOe(t)||6!==r&&7!==r?null===t||OOe(t)?L(t):(e.consume(t),k):e.check(bRe,R,L)(t)}function L(t){return e.exit("htmlFlowData"),D(t)}function D(t){return null===t?P(t):OOe(t)?e.attempt({tokenize:N,partial:!0},D,P)(t):(e.enter("htmlFlowData"),k(t))}function N(e,t,n){return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r};function r(e){return i.parser.lazy[i.now().line]?n(e):t(e)}}function I(t){return 45===t?(e.consume(t),O):k(t)}function T(t){return 47===t?(e.consume(t),s="",M):k(t)}function M(t){return 62===t&&yRe.includes(s.toLowerCase())?(e.consume(t),R):kOe(t)&&s.length<8?(e.consume(t),s+=String.fromCharCode(t),M):k(t)}function A(t){return 93===t?(e.consume(t),O):k(t)}function O(t){return 62===t?(e.consume(t),R):45===t&&2===r?(e.consume(t),O):k(t)}function R(t){return null===t||OOe(t)?(e.exit("htmlFlowData"),P(t)):(e.consume(t),R)}function P(n){return e.exit("htmlFlow"),t(n)}},resolveTo:function(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2));return e},concrete:!0},bRe={tokenize:function(e,t,n){return function(i){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),e.attempt($Oe,t,n)}},partial:!0};const wRe={name:"htmlText",tokenize:function(e,t,n){const i=this;let r,o,s,a;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),l};function l(t){return 33===t?(e.consume(t),c):47===t?(e.consume(t),C):63===t?(e.consume(t),b):kOe(t)?(e.consume(t),E):n(t)}function c(t){return 45===t?(e.consume(t),u):91===t?(e.consume(t),o="CDATA[",s=0,p):kOe(t)?(e.consume(t),_):n(t)}function u(t){return 45===t?(e.consume(t),h):n(t)}function h(t){return null===t||62===t?n(t):45===t?(e.consume(t),d):f(t)}function d(e){return null===e||62===e?n(e):f(e)}function f(t){return null===t?n(t):45===t?(e.consume(t),g):OOe(t)?(a=f,A(t)):(e.consume(t),f)}function g(t){return 45===t?(e.consume(t),R):f(t)}function p(t){return t===o.charCodeAt(s++)?(e.consume(t),s===o.length?m:p):n(t)}function m(t){return null===t?n(t):93===t?(e.consume(t),v):OOe(t)?(a=m,A(t)):(e.consume(t),m)}function v(t){return 93===t?(e.consume(t),y):m(t)}function y(t){return 62===t?R(t):93===t?(e.consume(t),y):m(t)}function _(t){return null===t||62===t?R(t):OOe(t)?(a=_,A(t)):(e.consume(t),_)}function b(t){return null===t?n(t):63===t?(e.consume(t),w):OOe(t)?(a=b,A(t)):(e.consume(t),b)}function w(e){return 62===e?R(e):b(e)}function C(t){return kOe(t)?(e.consume(t),S):n(t)}function S(t){return 45===t||NOe(t)?(e.consume(t),S):x(t)}function x(t){return OOe(t)?(a=x,A(t)):ROe(t)?(e.consume(t),x):R(t)}function E(t){return 45===t||NOe(t)?(e.consume(t),E):47===t||62===t||AOe(t)?k(t):n(t)}function k(t){return 47===t?(e.consume(t),R):58===t||95===t||kOe(t)?(e.consume(t),L):OOe(t)?(a=k,A(t)):ROe(t)?(e.consume(t),k):R(t)}function L(t){return 45===t||46===t||58===t||95===t||NOe(t)?(e.consume(t),L):D(t)}function D(t){return 61===t?(e.consume(t),N):OOe(t)?(a=D,A(t)):ROe(t)?(e.consume(t),D):k(t)}function N(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),r=t,I):OOe(t)?(a=N,A(t)):ROe(t)?(e.consume(t),N):(e.consume(t),r=void 0,M)}function I(t){return t===r?(e.consume(t),T):null===t?n(t):OOe(t)?(a=I,A(t)):(e.consume(t),I)}function T(e){return 62===e||47===e||AOe(e)?k(e):n(e)}function M(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):62===t||AOe(t)?k(t):(e.consume(t),M)}function A(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),WOe(e,O,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function O(t){return e.enter("htmlTextData"),a(t)}function R(i){return 62===i?(e.consume(i),e.exit("htmlTextData"),e.exit("htmlText"),t):n(i)}}};const CRe={name:"labelEnd",tokenize:function(e,t,n){const i=this;let r,o,s=i.events.length;for(;s--;)if(("labelImage"===i.events[s][1].type||"labelLink"===i.events[s][1].type)&&!i.events[s][1]._balanced){r=i.events[s][1];break}return function(t){if(!r)return n(t);return r._inactive?l(t):(o=i.parser.defined.includes(dRe(i.sliceSerialize({start:r.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),a)};function a(n){return 40===n?e.attempt(SRe,t,o?t:l)(n):91===n?e.attempt(xRe,t,o?e.attempt(ERe,t,l):l)(n):o?t(n):l(n)}function l(e){return r._balanced=!0,n(e)}},resolveTo:function(e,t){let n,i,r,o,s=e.length,a=0;for(;s--;)if(n=e[s][1],i){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[s][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(r){if("enter"===e[s][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(i=s,"labelLink"!==n.type)){a=2;break}}else"labelEnd"===n.type&&(r=s);const l={type:"labelLink"===e[i][1].type?"link":"image",start:Object.assign({},e[i][1].start),end:Object.assign({},e[e.length-1][1].end)},c={type:"label",start:Object.assign({},e[i][1].start),end:Object.assign({},e[r][1].end)},u={type:"labelText",start:Object.assign({},e[i+a+2][1].end),end:Object.assign({},e[r-2][1].start)};return o=[["enter",l,t],["enter",c,t]],o=wOe(o,e.slice(i+1,i+a+3)),o=wOe(o,[["enter",u,t]]),o=wOe(o,jOe(t.parser.constructs.insideSpan.null,e.slice(i+a+4,r-3),t)),o=wOe(o,[["exit",u,t],e[r-2],e[r-1],["exit",c,t]]),o=wOe(o,e.slice(r+1)),o=wOe(o,[["exit",l,t]]),bOe(e,i,e.length,o),e},resolveAll:function(e){let t,n=-1;for(;++n<e.length;)t=e[n][1],"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(n+1,"labelImage"===t.type?4:2),t.type="data",n++);return e}},SRe={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),hRe(e,i)};function i(t){return 41===t?s(t):lRe(e,r,n,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function r(t){return AOe(t)?hRe(e,o)(t):s(t)}function o(t){return 34===t||39===t||40===t?uRe(e,hRe(e,s),n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):s(t)}function s(i){return 41===i?(e.enter("resourceMarker"),e.consume(i),e.exit("resourceMarker"),e.exit("resource"),t):n(i)}}},xRe={tokenize:function(e,t,n){const i=this;return function(t){return cRe.call(i,e,r,n,"reference","referenceMarker","referenceString")(t)};function r(e){return i.parser.defined.includes(dRe(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?t(e):n(e)}}},ERe={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),i};function i(i){return 93===i?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}};const kRe={name:"labelStartImage",tokenize:function(e,t,n){const i=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),r};function r(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),o):n(t)}function o(e){return 94===e&&"_hiddenFootnoteSupport"in i.parser.constructs?n(e):t(e)}},resolveAll:CRe.resolveAll};const LRe={name:"labelStartLink",tokenize:function(e,t,n){const i=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),r};function r(e){return 94===e&&"_hiddenFootnoteSupport"in i.parser.constructs?n(e):t(e)}},resolveAll:CRe.resolveAll};const DRe={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),WOe(e,t,"linePrefix")}}};const NRe={name:"thematicBreak",tokenize:function(e,t,n){let i,r=0;return function(t){return e.enter("thematicBreak"),i=t,o(t)};function o(a){return a===i?(e.enter("thematicBreakSequence"),s(a)):ROe(a)?WOe(e,o,"whitespace")(a):r<3||null!==a&&!OOe(a)?n(a):(e.exit("thematicBreak"),t(a))}function s(t){return t===i?(e.consume(t),r++,s):(e.exit("thematicBreakSequence"),o(t))}}};const IRe={name:"list",tokenize:function(e,t,n){const i=this,r=i.events[i.events.length-1];let o=r&&"linePrefix"===r[1].type?r[2].sliceSerialize(r[1],!0).length:0,s=0;return function(t){const r=i.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===r?!i.containerState.marker||t===i.containerState.marker:LOe(t)){if(i.containerState.type||(i.containerState.type=r,e.enter(r,{_container:!0})),"listUnordered"===r)return e.enter("listItemPrefix"),42===t||45===t?e.check(NRe,n,l)(t):l(t);if(!i.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),a(t)}return n(t)};function a(t){return LOe(t)&&++s<10?(e.consume(t),a):(!i.interrupt||s<2)&&(i.containerState.marker?t===i.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),l(t)):n(t)}function l(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||t,e.check($Oe,i.interrupt?n:c,e.attempt(TRe,h,u))}function c(e){return i.containerState.initialBlankLine=!0,o++,h(e)}function u(t){return ROe(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),h):n(t)}function h(n){return i.containerState.size=o+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}},continuation:{tokenize:function(e,t,n){const i=this;return i.containerState._closeFlow=void 0,e.check($Oe,(function(n){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,WOe(e,t,"listItemIndent",i.containerState.size+1)(n)}),(function(n){if(i.containerState.furtherBlankLines||!ROe(n))return i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,r(n);return i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(MRe,t,r)(n)}));function r(r){return i.containerState._closeFlow=!0,i.interrupt=void 0,WOe(e,e.attempt(IRe,t,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(r)}}},exit:function(e){e.exit(this.containerState.type)}},TRe={tokenize:function(e,t,n){const i=this;return WOe(e,(function(e){const r=i.events[i.events.length-1];return!ROe(e)&&r&&"listItemPrefixWhitespace"===r[1].type?t(e):n(e)}),"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5)},partial:!0},MRe={tokenize:function(e,t,n){const i=this;return WOe(e,(function(e){const r=i.events[i.events.length-1];return r&&"listItemIndent"===r[1].type&&r[2].sliceSerialize(r[1],!0).length===i.containerState.size?t(e):n(e)}),"listItemIndent",i.containerState.size+1)},partial:!0};const ARe={name:"setextUnderline",tokenize:function(e,t,n){const i=this;let r,o,s=i.events.length;for(;s--;)if("lineEnding"!==i.events[s][1].type&&"linePrefix"!==i.events[s][1].type&&"content"!==i.events[s][1].type){o="paragraph"===i.events[s][1].type;break}return function(t){if(!i.parser.lazy[i.now().line]&&(i.interrupt||o))return e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),r=t,a(t);return n(t)};function a(t){return t===r?(e.consume(t),a):(e.exit("setextHeadingLineSequence"),WOe(e,l,"lineSuffix")(t))}function l(i){return null===i||OOe(i)?(e.exit("setextHeadingLine"),t(i)):n(i)}},resolveTo:function(e,t){let n,i,r,o=e.length;for(;o--;)if("enter"===e[o][0]){if("content"===e[o][1].type){n=o;break}"paragraph"===e[o][1].type&&(i=o)}else"content"===e[o][1].type&&e.splice(o,1),r||"definition"!==e[o][1].type||(r=o);const s={type:"setextHeading",start:Object.assign({},e[i][1].start),end:Object.assign({},e[e.length-1][1].end)};e[i][1].type="setextHeadingText",r?(e.splice(i,0,["enter",s,t]),e.splice(r+1,0,["exit",e[n][1],t]),e[n][1].end=Object.assign({},e[r][1].end)):e[n][1]=s;return e.push(["exit",s,t]),e}};const ORe={tokenize:function(e){const t=this,n=e.attempt($Oe,(function(i){if(null===i)return void e.consume(i);return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}),e.attempt(this.parser.constructs.flowInitial,i,WOe(e,e.attempt(this.parser.constructs.flow,i,e.attempt(sRe,i)),"linePrefix")));return n;function i(i){if(null!==i)return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(i)}}};const RRe={resolveAll:WRe()},PRe=BRe("string"),FRe=BRe("text");function BRe(e){return{tokenize:function(t){const n=this,i=this.parser.constructs[e],r=t.attempt(i,o,s);return o;function o(e){return l(e)?r(e):s(e)}function s(e){if(null!==e)return t.enter("data"),t.consume(e),a;t.consume(e)}function a(e){return l(e)?(t.exit("data"),r(e)):(t.consume(e),a)}function l(e){if(null===e)return!0;const t=i[e];let r=-1;if(t)for(;++r<t.length;){const e=t[r];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}},resolveAll:WRe("text"===e?zRe:void 0)}}function WRe(e){return function(t,n){let i,r=-1;for(;++r<=t.length;)void 0===i?t[r]&&"data"===t[r][1].type&&(i=r,r++):t[r]&&"data"===t[r][1].type||(r!==i+2&&(t[i][1].end=t[r-1][1].end,t.splice(i+2,r-i-2),r=i+2),i=void 0);return e?e(t,n):t}}function zRe(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){const i=e[n-1][1],r=t.sliceStream(i);let o,s=r.length,a=-1,l=0;for(;s--;){const e=r[s];if("string"==typeof e){for(a=e.length;32===e.charCodeAt(a-1);)l++,a--;if(a)break;a=-1}else if(-2===e)o=!0,l++;else if(-1!==e){s++;break}}if(l){const r={type:n===e.length||o||l<2?"lineSuffix":"hardBreakTrailing",start:{line:i.end.line,column:i.end.column-l,offset:i.end.offset-l,_index:i.start._index+s,_bufferIndex:s?a:i.start._bufferIndex+a},end:Object.assign({},i.end)};i.end=Object.assign({},r.start),i.start.offset===i.end.offset?Object.assign(i,r):(e.splice(n,0,["enter",r,t],["exit",r,t]),n+=2)}n++}return e}function VRe(e,t,n){let i=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const r={},o=[];let s=[],a=[];const l={consume:function(e){OOe(e)?(i.line++,i.column=1,i.offset+=-3===e?2:1,y()):-1!==e&&(i.column++,i.offset++);i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===s[i._index].length&&(i._bufferIndex=-1,i._index++));c.previous=e},enter:function(e,t){const n=t||{};return n.type=e,n.start=d(),c.events.push(["enter",n,c]),a.push(n),n},exit:function(e){const t=a.pop();return t.end=d(),c.events.push(["exit",t,c]),t},attempt:m((function(e,t){v(e,t.from)})),check:m(p),interrupt:m(p,{interrupt:!0})},c={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:h,sliceSerialize:function(e,t){return function(e,t){let n=-1;const i=[];let r;for(;++n<e.length;){const o=e[n];let s;if("string"==typeof o)s=o;else switch(o){case-5:s="\r";break;case-4:s="\n";break;case-3:s="\r\n";break;case-2:s=t?" ":"\t";break;case-1:if(!t&&r)continue;s=" ";break;default:s=String.fromCharCode(o)}r=-2===o,i.push(s)}return i.join("")}(h(e),t)},now:d,defineSkip:function(e){r[e.line]=e.column,y()},write:function(e){if(s=wOe(s,e),f(),null!==s[s.length-1])return[];return v(t,0),c.events=jOe(o,c.events,c),c.events}};let u=t.tokenize.call(c,l);return t.resolveAll&&o.push(t),c;function h(e){return function(e,t){const n=t.start._index,i=t.start._bufferIndex,r=t.end._index,o=t.end._bufferIndex;let s;n===r?s=[e[n].slice(i,o)]:(s=e.slice(n,r),i>-1&&(s[0]=s[0].slice(i)),o>0&&s.push(e[r].slice(0,o)));return s}(s,e)}function d(){return Object.assign({},i)}function f(){let e;for(;i._index<s.length;){const t=s[i._index];if("string"==typeof t)for(e=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===e&&i._bufferIndex<t.length;)g(t.charCodeAt(i._bufferIndex));else g(t)}}function g(e){u=u(e)}function p(e,t){t.restore()}function m(e,t){return function(n,r,o){let s,u,h,f;return Array.isArray(n)?g(n):"tokenize"in n?g([n]):function(e){return t;function t(t){const n=null!==t&&e[t],i=null!==t&&e.null;return g([...Array.isArray(n)?n:n?[n]:[],...Array.isArray(i)?i:i?[i]:[]])(t)}}(n);function g(e){return s=e,u=0,0===e.length?o:p(e[u])}function p(e){return function(n){f=function(){const e=d(),t=c.previous,n=c.currentConstruct,r=c.events.length,o=Array.from(a);return{restore:s,from:r};function s(){i=e,c.previous=t,c.currentConstruct=n,c.events.length=r,a=o,y()}}(),h=e,e.partial||(c.currentConstruct=e);if(e.name&&c.parser.constructs.disable.null.includes(e.name))return v();return e.tokenize.call(t?Object.assign(Object.create(c),t):c,l,m,v)(n)}}function m(t){return e(h,f),r}function v(e){return f.restore(),++u<s.length?p(s[u]):o}}}function v(e,t){e.resolveAll&&!o.includes(e)&&o.push(e),e.resolve&&bOe(c.events,t,c.events.length-t,e.resolve(c.events.slice(t),c)),e.resolveTo&&(c.events=e.resolveTo(c.events,c))}function y(){i.line in r&&i.column<2&&(i.column=r[i.line],i.offset+=r[i.line]-1)}}const URe={42:IRe,43:IRe,45:IRe,48:IRe,49:IRe,50:IRe,51:IRe,52:IRe,53:IRe,54:IRe,55:IRe,56:IRe,57:IRe,62:YOe},HRe={91:fRe},jRe={[-2]:tRe,[-1]:tRe,32:tRe},GRe={35:mRe,42:NRe,45:[ARe,NRe],60:_Re,61:ARe,95:NRe,96:eRe,126:eRe},KRe={38:JOe,92:XOe},qRe={[-5]:DRe,[-4]:DRe,[-3]:DRe,33:kRe,38:JOe,42:GOe,60:[qOe,wRe],91:LRe,92:[pRe,XOe],93:CRe,95:GOe,96:iRe},$Re={null:[GOe,RRe]};var YRe=Object.freeze(Object.defineProperty({__proto__:null,document:URe,contentInitial:HRe,flowInitial:jRe,flow:GRe,string:KRe,text:qRe,insideSpan:$Re,attentionMarkers:{null:[42,95]},disable:{null:[]}},Symbol.toStringTag,{value:"Module"}));const XRe=/[\0\t\n\r]/g;function ZRe(e,t){const n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535==(65535&n)||65534==(65535&n)||n>1114111?"�":String.fromCharCode(n)}const QRe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function JRe(e){return e.replace(QRe,ePe)}function ePe(e,t,n){if(t)return t;if(35===n.charCodeAt(0)){const e=n.charCodeAt(1),t=120===e||88===e;return ZRe(n.slice(t?2:1),t?16:10)}return QOe(n)||e}const tPe={}.hasOwnProperty,nPe=function(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),function(e={}){const t=iPe({transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(ie),autolinkProtocol:D,autolinkEmail:D,atxHeading:l(J),blockQuote:l($),characterEscape:D,characterReference:D,codeFenced:l(Y),codeFencedFenceInfo:c,codeFencedFenceMeta:c,codeIndented:l(Y,c),codeText:l(X,c),codeTextData:D,data:D,codeFlowValue:D,definition:l(Z),definitionDestinationString:c,definitionLabelString:c,definitionTitleString:c,emphasis:l(Q),hardBreakEscape:l(ee),hardBreakTrailing:l(ee),htmlFlow:l(te,c),htmlFlowData:D,htmlText:l(te,c),htmlTextData:D,image:l(ne),label:c,link:l(ie),listItem:l(oe),listItemValue:p,listOrdered:l(re,g),listUnordered:l(re),paragraph:l(se),reference:U,referenceString:c,resourceDestinationString:c,resourceTitleString:c,setextHeading:l(J),strong:l(ae),thematicBreak:l(ce)},exit:{atxHeading:h(),atxHeadingSequence:x,autolink:h(),autolinkEmail:q,autolinkProtocol:K,blockQuote:h(),characterEscapeValue:N,characterReferenceMarkerHexadecimal:j,characterReferenceMarkerNumeric:j,characterReferenceValue:G,codeFenced:h(_),codeFencedFence:y,codeFencedFenceInfo:m,codeFencedFenceMeta:v,codeFlowValue:N,codeIndented:h(b),codeText:h(O),codeTextData:N,data:N,definition:h(),definitionDestinationString:S,definitionLabelString:w,definitionTitleString:C,emphasis:h(),hardBreakEscape:h(T),hardBreakTrailing:h(T),htmlFlow:h(M),htmlFlowData:N,htmlText:h(A),htmlTextData:N,image:h(P),label:B,labelText:F,lineEnding:I,link:h(R),listItem:h(),listOrdered:h(),listUnordered:h(),paragraph:h(),referenceString:H,resourceDestinationString:W,resourceTitleString:z,resource:V,setextHeading:h(L),setextHeadingLineSequence:k,setextHeadingText:E,strong:h(),thematicBreak:h()}},e.mdastExtensions||[]),n={};return i;function i(e){let n={type:"root",children:[]};const i=[],l=[],h={stack:[n],tokenStack:i,config:t,enter:u,exit:d,buffer:c,resume:f,setData:o,getData:s};let g=-1;for(;++g<e.length;)if("listOrdered"===e[g][1].type||"listUnordered"===e[g][1].type)if("enter"===e[g][0])l.push(g);else{g=r(e,l.pop(),g)}for(g=-1;++g<e.length;){const n=t[e[g][0]];tPe.call(n,e[g][1].type)&&n[e[g][1].type].call(Object.assign({sliceSerialize:e[g][2].sliceSerialize},h),e[g][1])}if(i.length>0){const e=i[i.length-1];(e[1]||oPe).call(h,void 0,e[0])}for(n.position={start:a(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:a(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},g=-1;++g<t.transforms.length;)n=t.transforms[g](n)||n;return n}function r(e,t,n){let i,r,o,s,a=t-1,l=-1,c=!1;for(;++a<=n;){const t=e[a];if("listUnordered"===t[1].type||"listOrdered"===t[1].type||"blockQuote"===t[1].type?("enter"===t[0]?l++:l--,s=void 0):"lineEndingBlank"===t[1].type?"enter"===t[0]&&(!i||s||l||o||(o=a),s=void 0):"linePrefix"===t[1].type||"listItemValue"===t[1].type||"listItemMarker"===t[1].type||"listItemPrefix"===t[1].type||"listItemPrefixWhitespace"===t[1].type||(s=void 0),!l&&"enter"===t[0]&&"listItemPrefix"===t[1].type||-1===l&&"exit"===t[0]&&("listUnordered"===t[1].type||"listOrdered"===t[1].type)){if(i){let s=a;for(r=void 0;s--;){const t=e[s];if("lineEnding"===t[1].type||"lineEndingBlank"===t[1].type){if("exit"===t[0])continue;r&&(e[r][1].type="lineEndingBlank",c=!0),t[1].type="lineEnding",r=s}else if("linePrefix"!==t[1].type&&"blockQuotePrefix"!==t[1].type&&"blockQuotePrefixWhitespace"!==t[1].type&&"blockQuoteMarker"!==t[1].type&&"listItemIndent"!==t[1].type)break}o&&(!r||o<r)&&(i._spread=!0),i.end=Object.assign({},r?e[r][1].start:t[1].end),e.splice(r||a,0,["exit",i,t[2]]),a++,n++}"listItemPrefix"===t[1].type&&(i={type:"listItem",_spread:!1,start:Object.assign({},t[1].start)},e.splice(a,0,["enter",i,t[2]]),a++,n++,o=void 0,s=!0)}}return e[t][1]._spread=c,n}function o(e,t){n[e]=t}function s(e){return n[e]}function a(e){return{line:e.line,column:e.column,offset:e.offset}}function l(e,t){return n;function n(n){u.call(this,e(n),n),t&&t.call(this,n)}}function c(){this.stack.push({type:"fragment",children:[]})}function u(e,t,n){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n]),e.position={start:a(t.start)},e}function h(e){return t;function t(t){e&&e.call(this,t),d.call(this,t)}}function d(e,t){const n=this.stack.pop(),i=this.tokenStack.pop();if(!i)throw new Error("Cannot close `"+e.type+"` ("+PAe({start:e.start,end:e.end})+"): it’s not open");if(i[0].type!==e.type)if(t)t.call(this,e,i[0]);else{(i[1]||oPe).call(this,e,i[0])}return n.position.end=a(e.end),n}function f(){return function(e,t){var{includeImageAlt:n=!0}=t||{};return yOe(e,n)}(this.stack.pop())}function g(){o("expectingFirstListItemValue",!0)}function p(e){if(s("expectingFirstListItemValue")){this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(e),10),o("expectingFirstListItemValue")}}function m(){const e=this.resume();this.stack[this.stack.length-1].lang=e}function v(){const e=this.resume();this.stack[this.stack.length-1].meta=e}function y(){s("flowCodeInside")||(this.buffer(),o("flowCodeInside",!0))}function _(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),o("flowCodeInside")}function b(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/(\r?\n|\r)$/g,"")}function w(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=dRe(this.sliceSerialize(e)).toLowerCase()}function C(){const e=this.resume();this.stack[this.stack.length-1].title=e}function S(){const e=this.resume();this.stack[this.stack.length-1].url=e}function x(e){const t=this.stack[this.stack.length-1];if(!t.depth){const n=this.sliceSerialize(e).length;t.depth=n}}function E(){o("setextHeadingSlurpLineEnding",!0)}function k(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2}function L(){o("setextHeadingSlurpLineEnding")}function D(e){const t=this.stack[this.stack.length-1];let n=t.children[t.children.length-1];n&&"text"===n.type||(n=le(),n.position={start:a(e.start)},t.children.push(n)),this.stack.push(n)}function N(e){const t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=a(e.end)}function I(e){const n=this.stack[this.stack.length-1];if(s("atHardBreak")){return n.children[n.children.length-1].position.end=a(e.end),void o("atHardBreak")}!s("setextHeadingSlurpLineEnding")&&t.canContainEols.includes(n.type)&&(D.call(this,e),N.call(this,e))}function T(){o("atHardBreak",!0)}function M(){const e=this.resume();this.stack[this.stack.length-1].value=e}function A(){const e=this.resume();this.stack[this.stack.length-1].value=e}function O(){const e=this.resume();this.stack[this.stack.length-1].value=e}function R(){const e=this.stack[this.stack.length-1];s("inReference")?(e.type+="Reference",e.referenceType=s("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label),o("referenceType")}function P(){const e=this.stack[this.stack.length-1];s("inReference")?(e.type+="Reference",e.referenceType=s("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label),o("referenceType")}function F(e){const t=this.stack[this.stack.length-2],n=this.sliceSerialize(e);t.label=JRe(n),t.identifier=dRe(n).toLowerCase()}function B(){const e=this.stack[this.stack.length-1],t=this.resume(),n=this.stack[this.stack.length-1];o("inReference",!0),"link"===n.type?n.children=e.children:n.alt=t}function W(){const e=this.resume();this.stack[this.stack.length-1].url=e}function z(){const e=this.resume();this.stack[this.stack.length-1].title=e}function V(){o("inReference")}function U(){o("referenceType","collapsed")}function H(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=dRe(this.sliceSerialize(e)).toLowerCase(),o("referenceType","full")}function j(e){o("characterReferenceType",e.type)}function G(e){const t=this.sliceSerialize(e),n=s("characterReferenceType");let i;n?(i=ZRe(t,"characterReferenceMarkerNumeric"===n?10:16),o("characterReferenceType")):i=QOe(t);const r=this.stack.pop();r.value+=i,r.position.end=a(e.end)}function K(e){N.call(this,e);this.stack[this.stack.length-1].url=this.sliceSerialize(e)}function q(e){N.call(this,e);this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)}function $(){return{type:"blockquote",children:[]}}function Y(){return{type:"code",lang:null,meta:null,value:""}}function X(){return{type:"inlineCode",value:""}}function Z(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Q(){return{type:"emphasis",children:[]}}function J(){return{type:"heading",depth:void 0,children:[]}}function ee(){return{type:"break"}}function te(){return{type:"html",value:""}}function ne(){return{type:"image",title:null,url:"",alt:null}}function ie(){return{type:"link",title:null,url:"",children:[]}}function re(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function oe(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function se(){return{type:"paragraph",children:[]}}function ae(){return{type:"strong",children:[]}}function le(){return{type:"text",value:""}}function ce(){return{type:"thematicBreak"}}}(n)(function(e){for(;!rRe(e););return e}(function(e={}){const t={defined:[],lazy:{},constructs:SOe([YRe].concat(e.extensions||[])),content:n(zOe),document:n(VOe),flow:n(ORe),string:n(PRe),text:n(FRe)};return t;function n(e){return function(n){return VRe(t,e,n)}}}(n).document().write(function(){let e,t=1,n="",i=!0;return function(r,o,s){const a=[];let l,c,u,h,d;for(r=n+r.toString(o),u=0,n="",i&&(65279===r.charCodeAt(0)&&u++,i=void 0);u<r.length;){if(XRe.lastIndex=u,l=XRe.exec(r),h=l&&void 0!==l.index?l.index:r.length,d=r.charCodeAt(h),!l){n=r.slice(u);break}if(10===d&&u===h&&e)a.push(-3),e=void 0;else switch(e&&(a.push(-5),e=void 0),u<h&&(a.push(r.slice(u,h)),t+=h-u),d){case 0:a.push(65533),t++;break;case 9:for(c=4*Math.ceil(t/4),a.push(-2);t++<c;)a.push(-1);break;case 10:a.push(-4),t=1;break;default:e=!0,t=1}u=h+1}return s&&(e&&a.push(-5),n&&a.push(n),a.push(null)),a}}()(e,t,!0))))};function iPe(e,t){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?iPe(e,i):rPe(e,i)}return e}function rPe(e,t){let n;for(n in t)if(tPe.call(t,n)){const i="canContainEols"===n||"transforms"===n,r=(tPe.call(e,n)?e[n]:void 0)||(e[n]=i?[]:{}),o=t[n];o&&(i?e[n]=[...r,...o]:Object.assign(r,o))}}function oPe(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+PAe({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+PAe({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+PAe({start:t.start,end:t.end})+") is still open")}function sPe(e){Object.assign(this,{Parser:t=>{const n=this.data("settings");return nPe(t,Object.assign({},n,e,{extensions:this.data("micromarkExtensions")||[],mdastExtensions:this.data("fromMarkdownExtensions")||[]}))}})}var aPe=function(e,t,n){var i={type:String(e)};return null!=n||"string"!=typeof t&&!Array.isArray(t)?Object.assign(i,t):n=t,Array.isArray(n)?i.children=n:null!=n&&(i.value=String(n)),i};const lPe={}.hasOwnProperty;function cPe(e,t){const n=t.data||{};return"value"in t&&!(lPe.call(n,"hName")||lPe.call(n,"hProperties")||lPe.call(n,"hChildren"))?e.augment(t,aPe("text",t.value)):e(t,"div",dPe(e,t))}function uPe(e,t,n){const i=t&&t.type;let r;if(!i)throw new Error("Expected node, got `"+t+"`");return r=lPe.call(e.handlers,i)?e.handlers[i]:e.passThrough&&e.passThrough.includes(i)?hPe:e.unknownHandler,("function"==typeof r?r:cPe)(e,t,n)}function hPe(e,t){return"children"in t?l(a({},t),{children:dPe(e,t)}):t}function dPe(e,t){const n=[];if("children"in t){const i=t.children;let r=-1;for(;++r<i.length;){const o=uPe(e,i[r],t);if(o){if(r&&"break"===i[r-1].type&&(Array.isArray(o)||"text"!==o.type||(o.value=o.value.replace(/^\s+/,"")),!Array.isArray(o)&&"element"===o.type)){const e=o.children[0];e&&"text"===e.type&&(e.value=e.value.replace(/^\s+/,""))}Array.isArray(o)?n.push(...o):n.push(o)}}}return n}const fPe=function(e){if(null==e)return pPe;if("string"==typeof e)return function(e){return gPe(t);function t(t){return t&&t.type===e}}(e);if("object"==typeof e)return Array.isArray(e)?function(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=fPe(e[n]);return gPe(i);function i(...e){let n=-1;for(;++n<t.length;)if(t[n].call(this,...e))return!0;return!1}}(e):function(e){return gPe(t);function t(t){let n;for(n in e)if(t[n]!==e[n])return!1;return!0}}(e);if("function"==typeof e)return gPe(e);throw new Error("Expected function, string, or object as test")};function gPe(e){return function(...t){return Boolean(e.call(this,...t))}}function pPe(){return!0}const mPe=function(e,t,n,i){"function"==typeof t&&"function"!=typeof n&&(i=n,n=t,t=null);const r=fPe(t),o=i?-1:1;!function e(s,a,l){const c="object"==typeof s&&null!==s?s:{};let u;"string"==typeof c.type&&(u="string"==typeof c.tagName?c.tagName:"string"==typeof c.name?c.name:void 0,Object.defineProperty(h,"name",{value:"node ("+c.type+(u?"<"+u+">":"")+")"}));return h;function h(){let c,u,h,d=[];if((!t||r(s,a,l[l.length-1]||null))&&(d=function(e){if(Array.isArray(e))return e;if("number"==typeof e)return[true,e];return[e]}(n(s,l)),false===d[0]))return d;if(s.children&&"skip"!==d[0])for(u=(i?s.children.length:-1)+o,h=l.concat(s);u>-1&&u<s.children.length;){if(c=e(s.children[u],u,h)(),false===c[0])return c;u="number"==typeof c[1]?c[1]:u+o}return d}}(e,null,[])()};const vPe=function(e,t,n,i){"function"==typeof t&&"function"!=typeof n&&(i=n,n=t,t=null),mPe(e,t,(function(e,t){const i=t[t.length-1];return n(e,i?i.children.indexOf(e):null,i)}),i)},yPe=bPe("start"),_Pe=bPe("end");function bPe(e){return function(t){const n=t&&t.position&&t.position[e]||{};return{line:n.line||null,column:n.column||null,offset:n.offset>-1?n.offset:null}}}const wPe=function(e,t,n,i){"function"==typeof t&&"function"!=typeof n&&(i=n,n=t,t=null);var r=fPe(t),o=i?-1:1;!function e(s,a,l){var c,u="object"==typeof s&&null!==s?s:{};"string"==typeof u.type&&(c="string"==typeof u.tagName?u.tagName:"string"==typeof u.name?u.name:void 0,Object.defineProperty(h,"name",{value:"node ("+u.type+(c?"<"+c+">":"")+")"}));return h;function h(){var c,u,h,d=[];if((!t||r(s,a,l[l.length-1]||null))&&false===(d=function(e){if(Array.isArray(e))return e;if("number"==typeof e)return[true,e];return[e]}(n(s,l)))[0])return d;if(s.children&&"skip"!==d[0])for(u=(i?s.children.length:-1)+o,h=l.concat(s);u>-1&&u<s.children.length;){if(false===(c=e(s.children[u],u,h)())[0])return c;u="number"==typeof c[1]?c[1]:u+o}return d}}(e,null,[])()};const CPe={}.hasOwnProperty;function SPe(e){const t=Object.create(null);if(!e||!e.type)throw new Error("mdast-util-definitions expected node");var n,i,r;return i=function(e){const n=xPe(e.identifier);n&&!CPe.call(t,n)&&(t[n]=e)},"function"==typeof(n="definition")&&"function"!=typeof i&&(r=i,i=n,n=null),wPe(e,n,(function(e,t){var n=t[t.length-1];return i(e,n?n.children.indexOf(e):null,n)}),r),function(e){const n=xPe(e);return n&&CPe.call(t,n)?t[n]:null}}function xPe(e){return String(e||"").toUpperCase()}const EPe={'"':"quot","&":"amp","<":"lt",">":"gt"};function kPe(e,t){const n=function(e){return e.replace(/["&<>]/g,(function(e){return"&"+EPe[e]+";"}))}(function(e){const t=[];let n=-1,i=0,r=0;for(;++n<e.length;){const o=e.charCodeAt(n);let s="";if(37===o&&NOe(e.charCodeAt(n+1))&&NOe(e.charCodeAt(n+2)))r=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(s=String.fromCharCode(o));else if(o>55295&&o<57344){const t=e.charCodeAt(n+1);o<56320&&t>56319&&t<57344?(s=String.fromCharCode(o,t),r=1):s="�"}else s=String.fromCharCode(o);s&&(t.push(e.slice(i,n),encodeURIComponent(s)),i=n+r+1,s=""),r&&(n+=r,r=0)}return t.join("")+e.slice(i)}(e||""));if(!t)return n;const i=n.indexOf(":"),r=n.indexOf("?"),o=n.indexOf("#"),s=n.indexOf("/");return i<0||s>-1&&i>s||r>-1&&i>r||o>-1&&i>o||t.test(n.slice(0,i))?n:""}function LPe(e,t){const n=[];let i=-1;for(t&&n.push(aPe("text","\n"));++i<e.length;)i&&n.push(aPe("text","\n")),n.push(e[i]);return t&&e.length>0&&n.push(aPe("text","\n")),n}function DPe(e,t){const n=String(t.identifier),i=kPe(n.toLowerCase()),r=e.footnoteOrder.indexOf(n);let o;-1===r?(e.footnoteOrder.push(n),e.footnoteCounts[n]=1,o=e.footnoteOrder.length):(e.footnoteCounts[n]++,o=r+1);const s=e.footnoteCounts[n];return e(t,"sup",[e(t.position,"a",{href:"#"+e.clobberPrefix+"fn-"+i,id:e.clobberPrefix+"fnref-"+i+(s>1?"-"+s:""),dataFootnoteRef:!0,ariaDescribedBy:"footnote-label"},[aPe("text",String(o))])])}var NPe={};function IPe(e,t,n){var i,r,o,s,a,l="";for("string"!=typeof t&&(n=t,t=IPe.defaultChars),void 0===n&&(n=!0),a=function(e){var t,n,i=NPe[e];if(i)return i;for(i=NPe[e]=[],t=0;t<128;t++)n=String.fromCharCode(t),/^[0-9a-z]$/i.test(n)?i.push(n):i.push("%"+("0"+t.toString(16).toUpperCase()).slice(-2));for(t=0;t<e.length;t++)i[e.charCodeAt(t)]=e[t];return i}(t),i=0,r=e.length;i<r;i++)if(o=e.charCodeAt(i),n&&37===o&&i+2<r&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3)))l+=e.slice(i,i+3),i+=2;else if(o<128)l+=a[o];else if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<r&&(s=e.charCodeAt(i+1))>=56320&&s<=57343){l+=encodeURIComponent(e[i]+e[i+1]),i++;continue}l+="%EF%BF%BD"}else l+=encodeURIComponent(e[i]);return l}IPe.defaultChars=";/?:@&=+$,-_.!~*'()#",IPe.componentChars="-_.!~*'()";var TPe=IPe;function MPe(e,t){const n=t.referenceType;let i="]";if("collapsed"===n?i+="[]":"full"===n&&(i+="["+(t.label||t.identifier)+"]"),"imageReference"===t.type)return aPe("text","!["+t.alt+i);const r=dPe(e,t),o=r[0];o&&"text"===o.type?o.value="["+o.value:r.unshift(aPe("text","["));const s=r[r.length-1];return s&&"text"===s.type?s.value+=i:r.push(aPe("text",i)),r}function APe(e){const t=e.spread;return null==t?e.children.length>1:t}const OPe={blockquote:function(e,t){return e(t,"blockquote",LPe(dPe(e,t),!0))},break:function(e,t){return[e(t,"br"),aPe("text","\n")]},code:function(e,t){const n=t.value?t.value+"\n":"",i=t.lang&&t.lang.match(/^[^ \t]+(?=[ \t]|$)/),r={};i&&(r.className=["language-"+i]);const o=e(t,"code",r,[aPe("text",n)]);return t.meta&&(o.data={meta:t.meta}),e(t.position,"pre",[o])},delete:function(e,t){return e(t,"del",dPe(e,t))},emphasis:function(e,t){return e(t,"em",dPe(e,t))},footnoteReference:DPe,footnote:function(e,t){const n=e.footnoteById;let i=1;for(;i in n;)i++;const r=String(i);return n[r]={type:"footnoteDefinition",identifier:r,children:[{type:"paragraph",children:t.children}],position:t.position},DPe(e,{type:"footnoteReference",identifier:r,position:t.position})},heading:function(e,t){return e(t,"h"+t.depth,dPe(e,t))},html:function(e,t){return e.dangerous?e.augment(t,aPe("raw",t.value)):null},imageReference:function(e,t){const n=e.definition(t.identifier);if(!n)return MPe(e,t);const i={src:TPe(n.url||""),alt:t.alt};return null!==n.title&&void 0!==n.title&&(i.title=n.title),e(t,"img",i)},image:function(e,t){const n={src:TPe(t.url),alt:t.alt};return null!==t.title&&void 0!==t.title&&(n.title=t.title),e(t,"img",n)},inlineCode:function(e,t){return e(t,"code",[aPe("text",t.value.replace(/\r?\n|\r/g," "))])},linkReference:function(e,t){const n=e.definition(t.identifier);if(!n)return MPe(e,t);const i={href:TPe(n.url||"")};return null!==n.title&&void 0!==n.title&&(i.title=n.title),e(t,"a",i,dPe(e,t))},link:function(e,t){const n={href:TPe(t.url)};return null!==t.title&&void 0!==t.title&&(n.title=t.title),e(t,"a",n,dPe(e,t))},listItem:function(e,t,n){const i=dPe(e,t),r=n?function(e){let t=e.spread;const n=e.children;let i=-1;for(;!t&&++i<n.length;)t=APe(n[i]);return Boolean(t)}(n):APe(t),o={},s=[];if("boolean"==typeof t.checked){let n;i[0]&&"element"===i[0].type&&"p"===i[0].tagName?n=i[0]:(n=e(null,"p",[]),i.unshift(n)),n.children.length>0&&n.children.unshift(aPe("text"," ")),n.children.unshift(e(null,"input",{type:"checkbox",checked:t.checked,disabled:!0})),o.className=["task-list-item"]}let a=-1;for(;++a<i.length;){const e=i[a];(r||0!==a||"element"!==e.type||"p"!==e.tagName)&&s.push(aPe("text","\n")),"element"!==e.type||"p"!==e.tagName||r?s.push(e):s.push(...e.children)}const l=i[i.length-1];return!l||!r&&"tagName"in l&&"p"===l.tagName||s.push(aPe("text","\n")),e(t,"li",o,s)},list:function(e,t){const n={},i=t.ordered?"ol":"ul",r=dPe(e,t);let o=-1;for("number"==typeof t.start&&1!==t.start&&(n.start=t.start);++o<r.length;){const e=r[o];if("element"===e.type&&"li"===e.tagName&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}return e(t,i,n,LPe(r,!0))},paragraph:function(e,t){return e(t,"p",dPe(e,t))},root:function(e,t){return e.augment(t,aPe("root",LPe(dPe(e,t))))},strong:function(e,t){return e(t,"strong",dPe(e,t))},table:function(e,t){const n=t.children;let i=-1;const r=t.align||[],o=[];for(;++i<n.length;){const s=n[i].children,a=0===i?"th":"td",l=[];let c=-1;const u=t.align?r.length:s.length;for(;++c<u;){const t=s[c];l.push(e(t,a,{align:r[c]},t?dPe(e,t):[]))}o[i]=e(n[i],"tr",LPe(l,!0))}return e(t,"table",LPe([e(o[0].position,"thead",LPe([o[0]],!0))].concat(o[1]?e({start:yPe(o[1]),end:_Pe(o[o.length-1])},"tbody",LPe(o.slice(1),!0)):[]),!0))},text:function(e,t){return e.augment(t,aPe("text",String(t.value).replace(/[ \t]*(\r?\n|\r)[ \t]*/g,"$1")))},thematicBreak:function(e,t){return e(t,"hr")},toml:RPe,yaml:RPe,definition:RPe,footnoteDefinition:RPe};function RPe(){return null}const PPe={}.hasOwnProperty;function FPe(e,t){const n=function(e,t){const n=t||{},i=n.allowDangerousHtml||!1,r={};return s.dangerous=i,s.clobberPrefix=void 0===n.clobberPrefix||null===n.clobberPrefix?"user-content-":n.clobberPrefix,s.footnoteLabel=n.footnoteLabel||"Footnotes",s.footnoteBackLabel=n.footnoteBackLabel||"Back to content",s.definition=SPe(e),s.footnoteById=r,s.footnoteOrder=[],s.footnoteCounts={},s.augment=o,s.handlers=a(a({},OPe),n.handlers),s.unknownHandler=n.unknownHandler,s.passThrough=n.passThrough,vPe(e,"footnoteDefinition",(e=>{const t=String(e.identifier).toUpperCase();PPe.call(r,t)||(r[t]=e)})),s;function o(e,t){if(e&&"data"in e&&e.data){const n=e.data;n.hName&&("element"!==t.type&&(t={type:"element",tagName:"",properties:{},children:[]}),t.tagName=n.hName),"element"===t.type&&n.hProperties&&(t.properties=a(a({},t.properties),n.hProperties)),"children"in t&&t.children&&n.hChildren&&(t.children=n.hChildren)}if(e){const i="type"in e?e:{position:e};(n=i)&&n.position&&n.position.start&&n.position.start.line&&n.position.start.column&&n.position.end&&n.position.end.line&&n.position.end.column&&(t.position={start:yPe(i),end:_Pe(i)})}var n;return t}function s(e,t,n,i){return Array.isArray(n)&&(i=n,n={}),o(e,{type:"element",tagName:t,properties:n||{},children:i||[]})}}(e,t),i=uPe(n,e,null),r=function(e){let t=-1;const n=[];for(;++t<e.footnoteOrder.length;){const i=e.footnoteById[e.footnoteOrder[t].toUpperCase()];if(!i)continue;const r=dPe(e,i),o=String(i.identifier),s=kPe(o.toLowerCase());let a=0;const l=[];for(;++a<=e.footnoteCounts[o];){const t={type:"element",tagName:"a",properties:{href:"#"+e.clobberPrefix+"fnref-"+s+(a>1?"-"+a:""),dataFootnoteBackref:!0,className:["data-footnote-backref"],ariaLabel:e.footnoteBackLabel},children:[{type:"text",value:"↩"}]};a>1&&t.children.push({type:"element",tagName:"sup",children:[{type:"text",value:String(a)}]}),l.length>0&&l.push({type:"text",value:" "}),l.push(t)}const c=r[r.length-1];if(c&&"element"===c.type&&"p"===c.tagName){const e=c.children[c.children.length-1];e&&"text"===e.type?e.value+=" ":c.children.push({type:"text",value:" "}),c.children.push(...l)}else r.push(...l);const u={type:"element",tagName:"li",properties:{id:e.clobberPrefix+"fn-"+s},children:LPe(r,!0)};i.position&&(u.position=i.position),n.push(u)}return 0===n.length?null:{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:"h2",properties:{id:"footnote-label",className:["sr-only"]},children:[aPe("text",e.footnoteLabel)]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:LPe(n,!0)},{type:"text",value:"\n"}]}}(n);return r&&i.children.push(aPe("text","\n"),r),Array.isArray(i)?{type:"root",children:i}:i}var BPe=function(e,t){return e&&"run"in e?function(e,t){return(n,i,r)=>{e.run(FPe(n,t),i,(e=>{r(e)}))}}(e,t):function(e){return t=>FPe(t,e)}(e||t)};class WPe{constructor(e,t,n){this.property=e,this.normal=t,n&&(this.space=n)}}function zPe(e,t){const n={},i={};let r=-1;for(;++r<e.length;)Object.assign(n,e[r].property),Object.assign(i,e[r].normal);return new WPe(n,i,t)}function VPe(e){return e.toLowerCase()}WPe.prototype.property={},WPe.prototype.normal={},WPe.prototype.space=null;class UPe{constructor(e,t){this.property=e,this.attribute=t}}UPe.prototype.space=null,UPe.prototype.boolean=!1,UPe.prototype.booleanish=!1,UPe.prototype.overloadedBoolean=!1,UPe.prototype.number=!1,UPe.prototype.commaSeparated=!1,UPe.prototype.spaceSeparated=!1,UPe.prototype.commaOrSpaceSeparated=!1,UPe.prototype.mustUseProperty=!1,UPe.prototype.defined=!1;let HPe=0;const jPe=ZPe(),GPe=ZPe(),KPe=ZPe(),qPe=ZPe(),$Pe=ZPe(),YPe=ZPe(),XPe=ZPe();function ZPe(){return 2**++HPe}var QPe=Object.freeze(Object.defineProperty({__proto__:null,boolean:jPe,booleanish:GPe,overloadedBoolean:KPe,number:qPe,spaceSeparated:$Pe,commaSeparated:YPe,commaOrSpaceSeparated:XPe},Symbol.toStringTag,{value:"Module"}));const JPe=Object.keys(QPe);class eFe extends UPe{constructor(e,t,n,i){let r=-1;if(super(e,t),tFe(this,"space",i),"number"==typeof n)for(;++r<JPe.length;){const e=JPe[r];tFe(this,JPe[r],(n&QPe[e])===QPe[e])}}}function tFe(e,t,n){n&&(e[t]=n)}eFe.prototype.defined=!0;const nFe={}.hasOwnProperty;function iFe(e){const t={},n={};let i;for(i in e.properties)if(nFe.call(e.properties,i)){const r=e.properties[i],o=new eFe(i,e.transform(e.attributes||{},i),r,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),t[i]=o,n[VPe(i)]=i,n[VPe(o.attribute)]=i}return new WPe(t,n,e.space)}const rFe=iFe({space:"xlink",transform:(e,t)=>"xlink:"+t.slice(5).toLowerCase(),properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),oFe=iFe({space:"xml",transform:(e,t)=>"xml:"+t.slice(3).toLowerCase(),properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function sFe(e,t){return t in e?e[t]:t}function aFe(e,t){return sFe(e,t.toLowerCase())}const lFe=iFe({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:aFe,properties:{xmlns:null,xmlnsXLink:null}}),cFe=iFe({transform:(e,t)=>"role"===t?t:"aria-"+t.slice(4).toLowerCase(),properties:{ariaActiveDescendant:null,ariaAtomic:GPe,ariaAutoComplete:null,ariaBusy:GPe,ariaChecked:GPe,ariaColCount:qPe,ariaColIndex:qPe,ariaColSpan:qPe,ariaControls:$Pe,ariaCurrent:null,ariaDescribedBy:$Pe,ariaDetails:null,ariaDisabled:GPe,ariaDropEffect:$Pe,ariaErrorMessage:null,ariaExpanded:GPe,ariaFlowTo:$Pe,ariaGrabbed:GPe,ariaHasPopup:null,ariaHidden:GPe,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:$Pe,ariaLevel:qPe,ariaLive:null,ariaModal:GPe,ariaMultiLine:GPe,ariaMultiSelectable:GPe,ariaOrientation:null,ariaOwns:$Pe,ariaPlaceholder:null,ariaPosInSet:qPe,ariaPressed:GPe,ariaReadOnly:GPe,ariaRelevant:null,ariaRequired:GPe,ariaRoleDescription:$Pe,ariaRowCount:qPe,ariaRowIndex:qPe,ariaRowSpan:qPe,ariaSelected:GPe,ariaSetSize:qPe,ariaSort:null,ariaValueMax:qPe,ariaValueMin:qPe,ariaValueNow:qPe,ariaValueText:null,role:null}}),uFe=iFe({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:aFe,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:YPe,acceptCharset:$Pe,accessKey:$Pe,action:null,allow:null,allowFullScreen:jPe,allowPaymentRequest:jPe,allowUserMedia:jPe,alt:null,as:null,async:jPe,autoCapitalize:null,autoComplete:$Pe,autoFocus:jPe,autoPlay:jPe,capture:jPe,charSet:null,checked:jPe,cite:null,className:$Pe,cols:qPe,colSpan:null,content:null,contentEditable:GPe,controls:jPe,controlsList:$Pe,coords:qPe|YPe,crossOrigin:null,data:null,dateTime:null,decoding:null,default:jPe,defer:jPe,dir:null,dirName:null,disabled:jPe,download:KPe,draggable:GPe,encType:null,enterKeyHint:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:jPe,formTarget:null,headers:$Pe,height:qPe,hidden:jPe,high:qPe,href:null,hrefLang:null,htmlFor:$Pe,httpEquiv:$Pe,id:null,imageSizes:null,imageSrcSet:null,inputMode:null,integrity:null,is:null,isMap:jPe,itemId:null,itemProp:$Pe,itemRef:$Pe,itemScope:jPe,itemType:$Pe,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:jPe,low:qPe,manifest:null,max:null,maxLength:qPe,media:null,method:null,min:null,minLength:qPe,multiple:jPe,muted:jPe,name:null,nonce:null,noModule:jPe,noValidate:jPe,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforePrint:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:jPe,optimum:qPe,pattern:null,ping:$Pe,placeholder:null,playsInline:jPe,poster:null,preload:null,readOnly:jPe,referrerPolicy:null,rel:$Pe,required:jPe,reversed:jPe,rows:qPe,rowSpan:qPe,sandbox:$Pe,scope:null,scoped:jPe,seamless:jPe,selected:jPe,shape:null,size:qPe,sizes:null,slot:null,span:qPe,spellCheck:GPe,src:null,srcDoc:null,srcLang:null,srcSet:null,start:qPe,step:null,style:null,tabIndex:qPe,target:null,title:null,translate:null,type:null,typeMustMatch:jPe,useMap:null,value:GPe,width:qPe,wrap:null,align:null,aLink:null,archive:$Pe,axis:null,background:null,bgColor:null,border:qPe,borderColor:null,bottomMargin:qPe,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:jPe,declare:jPe,event:null,face:null,frame:null,frameBorder:null,hSpace:qPe,leftMargin:qPe,link:null,longDesc:null,lowSrc:null,marginHeight:qPe,marginWidth:qPe,noResize:jPe,noHref:jPe,noShade:jPe,noWrap:jPe,object:null,profile:null,prompt:null,rev:null,rightMargin:qPe,rules:null,scheme:null,scrolling:GPe,standby:null,summary:null,text:null,topMargin:qPe,valueType:null,version:null,vAlign:null,vLink:null,vSpace:qPe,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:jPe,disableRemotePlayback:jPe,prefix:null,property:null,results:qPe,security:null,unselectable:null}}),hFe=iFe({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:sFe,properties:{about:XPe,accentHeight:qPe,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:qPe,amplitude:qPe,arabicForm:null,ascent:qPe,attributeName:null,attributeType:null,azimuth:qPe,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:qPe,by:null,calcMode:null,capHeight:qPe,className:$Pe,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:qPe,diffuseConstant:qPe,direction:null,display:null,dur:null,divisor:qPe,dominantBaseline:null,download:jPe,dx:null,dy:null,edgeMode:null,editable:null,elevation:qPe,enableBackground:null,end:null,event:null,exponent:qPe,externalResourcesRequired:null,fill:null,fillOpacity:qPe,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:YPe,g2:YPe,glyphName:YPe,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:qPe,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:qPe,horizOriginX:qPe,horizOriginY:qPe,id:null,ideographic:qPe,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:qPe,k:qPe,k1:qPe,k2:qPe,k3:qPe,k4:qPe,kernelMatrix:XPe,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:qPe,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:qPe,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:qPe,overlineThickness:qPe,paintOrder:null,panose1:null,path:null,pathLength:qPe,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:$Pe,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:qPe,pointsAtY:qPe,pointsAtZ:qPe,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:XPe,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:XPe,rev:XPe,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:XPe,requiredFeatures:XPe,requiredFonts:XPe,requiredFormats:XPe,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:qPe,specularExponent:qPe,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:qPe,strikethroughThickness:qPe,string:null,stroke:null,strokeDashArray:XPe,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:qPe,strokeOpacity:qPe,strokeWidth:null,style:null,surfaceScale:qPe,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:XPe,tabIndex:qPe,tableValues:null,target:null,targetX:qPe,targetY:qPe,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:XPe,to:null,transform:null,u1:null,u2:null,underlinePosition:qPe,underlineThickness:qPe,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:qPe,values:null,vAlphabetic:qPe,vMathematical:qPe,vectorEffect:null,vHanging:qPe,vIdeographic:qPe,version:null,vertAdvY:qPe,vertOriginX:qPe,vertOriginY:qPe,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:qPe,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),dFe=/^data[-\w.:]+$/i,fFe=/-[a-z]/g,gFe=/[A-Z]/g;function pFe(e){return"-"+e.toLowerCase()}function mFe(e){return e.charAt(1).toUpperCase()}const vFe={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},yFe=zPe([oFe,rFe,lFe,cFe,uFe],"html"),_Fe=zPe([oFe,rFe,lFe,cFe,hFe],"svg");function bFe(e){if(e.allowedElements&&e.disallowedElements)throw new TypeError("Only one of `allowedElements` and `disallowedElements` should be defined");if(e.allowedElements||e.disallowedElements||e.allowElement)return t=>{vPe(t,"element",((t,n,i)=>{const r=i;let o;if(e.allowedElements?o=!e.allowedElements.includes(t.tagName):e.disallowedElements&&(o=e.disallowedElements.includes(t.tagName)),!o&&e.allowElement&&"number"==typeof n&&(o=!e.allowElement(t,n,r)),o&&"number"==typeof n)return e.unwrapDisallowed&&t.children?r.children.splice(n,1,...t.children):r.children.splice(n,1),n}))}}var wFe={exports:{}},CFe={},SFe=Symbol.for("react.element"),xFe=Symbol.for("react.portal"),EFe=Symbol.for("react.fragment"),kFe=Symbol.for("react.strict_mode"),LFe=Symbol.for("react.profiler"),DFe=Symbol.for("react.provider"),NFe=Symbol.for("react.context"),IFe=Symbol.for("react.server_context"),TFe=Symbol.for("react.forward_ref"),MFe=Symbol.for("react.suspense"),AFe=Symbol.for("react.suspense_list"),OFe=Symbol.for("react.memo"),RFe=Symbol.for("react.lazy"),PFe=Symbol.for("react.offscreen"),FFe=Symbol.for("react.module.reference");function BFe(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case SFe:switch(e=e.type){case EFe:case LFe:case kFe:case MFe:case AFe:return e;default:switch(e=e&&e.$$typeof){case IFe:case NFe:case TFe:case RFe:case OFe:case DFe:return e;default:return t}}case xFe:return t}}}CFe.ContextConsumer=NFe,CFe.ContextProvider=DFe,CFe.Element=SFe,CFe.ForwardRef=TFe,CFe.Fragment=EFe,CFe.Lazy=RFe,CFe.Memo=OFe,CFe.Portal=xFe,CFe.Profiler=LFe,CFe.StrictMode=kFe,CFe.Suspense=MFe,CFe.SuspenseList=AFe,CFe.isAsyncMode=function(){return!1},CFe.isConcurrentMode=function(){return!1},CFe.isContextConsumer=function(e){return BFe(e)===NFe},CFe.isContextProvider=function(e){return BFe(e)===DFe},CFe.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===SFe},CFe.isForwardRef=function(e){return BFe(e)===TFe},CFe.isFragment=function(e){return BFe(e)===EFe},CFe.isLazy=function(e){return BFe(e)===RFe},CFe.isMemo=function(e){return BFe(e)===OFe},CFe.isPortal=function(e){return BFe(e)===xFe},CFe.isProfiler=function(e){return BFe(e)===LFe},CFe.isStrictMode=function(e){return BFe(e)===kFe},CFe.isSuspense=function(e){return BFe(e)===MFe},CFe.isSuspenseList=function(e){return BFe(e)===AFe},CFe.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===EFe||e===LFe||e===kFe||e===MFe||e===AFe||e===PFe||"object"==typeof e&&null!==e&&(e.$$typeof===RFe||e.$$typeof===OFe||e.$$typeof===DFe||e.$$typeof===NFe||e.$$typeof===TFe||e.$$typeof===FFe||void 0!==e.getModuleId)},CFe.typeOf=BFe,wFe.exports=CFe;var WFe=wFe.exports;var zFe=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,VFe=/\n/g,UFe=/^\s*/,HFe=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,jFe=/^:\s*/,GFe=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,KFe=/^[;\s]*/,qFe=/^\s+|\s+$/g;function $Fe(e){return e?e.replace(qFe,""):""}var YFe=function(e,t){if("string"!=typeof e)throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,i=1;function r(e){var t=e.match(VFe);t&&(n+=t.length);var r=e.lastIndexOf("\n");i=~r?e.length-r:i+e.length}function o(){var e={line:n,column:i};return function(t){return t.position=new s(e),c(),t}}function s(e){this.start=e,this.end={line:n,column:i},this.source=t.source}function a(r){var o=new Error(t.source+":"+n+":"+i+": "+r);if(o.reason=r,o.filename=t.source,o.line=n,o.column=i,o.source=e,!t.silent)throw o}function l(t){var n=t.exec(e);if(n){var i=n[0];return r(i),e=e.slice(i.length),n}}function c(){l(UFe)}function u(e){var t;for(e=e||[];t=h();)!1!==t&&e.push(t);return e}function h(){var t=o();if("/"==e.charAt(0)&&"*"==e.charAt(1)){for(var n=2;""!=e.charAt(n)&&("*"!=e.charAt(n)||"/"!=e.charAt(n+1));)++n;if(n+=2,""===e.charAt(n-1))return a("End of comment missing");var s=e.slice(2,n-2);return i+=2,r(s),e=e.slice(n),i+=2,t({type:"comment",comment:s})}}function d(){var e=o(),t=l(HFe);if(t){if(h(),!l(jFe))return a("property missing ':'");var n=l(GFe),i=e({type:"declaration",property:$Fe(t[0].replace(zFe,"")),value:n?$Fe(n[0].replace(zFe,"")):""});return l(KFe),i}}return s.prototype.content=e,c(),function(){var e,t=[];for(u(t);e=d();)!1!==e&&(t.push(e),u(t));return t}()};var XFe=function(e,t){var n,i=null;if(!e||"string"!=typeof e)return i;for(var r,o,s=YFe(e),a="function"==typeof t,l=0,c=s.length;l<c;l++)r=(n=s[l]).property,o=n.value,a?t(r,o,n):o&&(i||(i={}),i[r]=o);return i};const ZFe={}.hasOwnProperty,QFe=new Set(["table","thead","tbody","tfoot","tr"]);function JFe(e,t){const n=[];let i,r=-1;for(;++r<t.children.length;)i=t.children[r],"element"===i.type?n.push(eBe(e,i,r,t)):"text"===i.type?"element"===t.type&&QFe.has(t.tagName)&&(s=void 0,"string"==typeof(s=(o=i)&&"object"==typeof o&&"text"===o.type?o.value||"":o)&&""===s.replace(/[ \t\n\f\r]/g,""))||n.push(i.value):"raw"!==i.type||e.options.skipHtml||n.push(i.value);var o,s;return n}function eBe(e,t,n,i){const r=e.options,o=e.schema,s=t.tagName,a={};let l,c=o;if("html"===o.space&&"svg"===s&&(c=_Fe,e.schema=c),t.properties)for(l in t.properties)ZFe.call(t.properties,l)&&nBe(a,l,t.properties[l],e);"ol"!==s&&"ul"!==s||e.listDepth++;const u=JFe(e,t);"ol"!==s&&"ul"!==s||e.listDepth--,e.schema=o;const h=t.position||{start:{line:null,column:null,offset:null},end:{line:null,column:null,offset:null}},f=r.components&&ZFe.call(r.components,s)?r.components[s]:s,g="string"==typeof f||f===d.Fragment;if(!WFe.isValidElementType(f))throw new TypeError(`Component for name \`${s}\` not defined or is not renderable`);if(a.key=[s,h.start.line,h.start.column,n].join("-"),"a"===s&&r.linkTarget&&(a.target="function"==typeof r.linkTarget?r.linkTarget(String(a.href||""),t.children,"string"==typeof a.title?a.title:null):r.linkTarget),"a"===s&&r.transformLinkUri&&(a.href=r.transformLinkUri(String(a.href||""),t.children,"string"==typeof a.title?a.title:null)),g||"code"!==s||"element"!==i.type||"pre"===i.tagName||(a.inline=!0),g||"h1"!==s&&"h2"!==s&&"h3"!==s&&"h4"!==s&&"h5"!==s&&"h6"!==s||(a.level=Number.parseInt(s.charAt(1),10)),"img"===s&&r.transformImageUri&&(a.src=r.transformImageUri(String(a.src||""),String(a.alt||""),"string"==typeof a.title?a.title:null)),!g&&"li"===s&&"element"===i.type){const e=function(e){let t=-1;for(;++t<e.children.length;){const n=e.children[t];if("element"===n.type&&"input"===n.tagName)return n}return null}(t);a.checked=e&&e.properties?Boolean(e.properties.checked):null,a.index=tBe(i,t),a.ordered="ol"===i.tagName}var p;return g||"ol"!==s&&"ul"!==s||(a.ordered="ol"===s,a.depth=e.listDepth),"td"!==s&&"th"!==s||(a.align&&(a.style||(a.style={}),a.style.textAlign=a.align,delete a.align),g||(a.isHeader="th"===s)),g||"tr"!==s||"element"!==i.type||(a.isHeader=Boolean("thead"===i.tagName)),r.sourcePos&&(a["data-sourcepos"]=[(p=h).start.line,":",p.start.column,"-",p.end.line,":",p.end.column].map((e=>String(e))).join("")),!g&&r.rawSourcePos&&(a.sourcePosition=t.position),!g&&r.includeElementIndex&&(a.index=tBe(i,t),a.siblingCount=tBe(i)),g||(a.node=t),u.length>0?d.createElement(f,a,u):d.createElement(f,a)}function tBe(e,t){let n=-1,i=0;for(;++n<e.children.length&&e.children[n]!==t;)"element"===e.children[n].type&&i++;return i}function nBe(e,t,n,i){const r=function(e,t){const n=VPe(t);let i=t,r=UPe;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&"data"===n.slice(0,4)&&dFe.test(t)){if("-"===t.charAt(4)){const e=t.slice(5).replace(fFe,mFe);i="data"+e.charAt(0).toUpperCase()+e.slice(1)}else{const e=t.slice(4);if(!fFe.test(e)){let n=e.replace(gFe,pFe);"-"!==n.charAt(0)&&(n="-"+n),t="data"+n}}r=eFe}return new r(i,t)}(i.schema,t);let o=n;var s,a,l;null!=o&&o==o&&(Array.isArray(o)&&(o=r.commaSeparated?(l=a||{},""===(s=o)[s.length-1]&&(s=s.concat("")),s.join((l.padRight?" ":"")+","+(!1===l.padLeft?"":" ")).trim()):function(e){return e.join(" ").trim()}(o)),"style"===r.property&&"string"==typeof o&&(o=function(e){const t={};try{XFe(e,n)}catch{}return t;function n(e,n){const i="-ms-"===e.slice(0,4)?`ms-${e.slice(4)}`:e;t[i.replace(/-([a-z])/g,iBe)]=n}}(o)),r.space&&r.property?e[ZFe.call(vFe,r.property)?vFe[r.property]:r.property]=o:r.attribute&&(e[r.attribute]=o))}function iBe(e,t){return t.toUpperCase()}const rBe={}.hasOwnProperty,oBe={plugins:{to:"plugins",id:"change-plugins-to-remarkplugins"},renderers:{to:"components",id:"change-renderers-to-components"},astPlugins:{id:"remove-buggy-html-in-markdown-parser"},allowDangerousHtml:{id:"remove-buggy-html-in-markdown-parser"},escapeHtml:{id:"remove-buggy-html-in-markdown-parser"},source:{to:"children",id:"change-source-to-children"},allowNode:{to:"allowElement",id:"replace-allownode-allowedtypes-and-disallowedtypes"},allowedTypes:{to:"allowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},disallowedTypes:{to:"disallowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},includeNodeIndex:{to:"includeElementIndex",id:"change-includenodeindex-to-includeelementindex"}};function sBe(e){for(const o in oBe)if(rBe.call(oBe,o)&&rBe.call(e,o)){const e=oBe[o];console.warn(`[react-markdown] Warning: please ${e.to?`use \`${e.to}\` instead of`:"remove"} \`${o}\` (see <https://github.com/remarkjs/react-markdown/blob/main/changelog.md#${e.id}> for more info)`),delete oBe[o]}const t=cOe().use(sPe).use(e.remarkPlugins||[]).use(BPe,l(a({},e.remarkRehypeOptions),{allowDangerousHtml:!0})).use(e.rehypePlugins||[]).use(bFe,e),n=new qAe;"string"==typeof e.children?n.value=e.children:void 0!==e.children&&null!==e.children&&console.warn(`[react-markdown] Warning: please pass a string as \`children\` (not: \`${e.children}\`)`);const i=t.runSync(t.parse(n),n);if("root"!==i.type)throw new TypeError("Expected a `root` node");let r=d.createElement(d.Fragment,{},JFe({options:e,schema:yFe,listDepth:0},i));return e.className&&(r=d.createElement("div",{className:e.className},r)),r}sBe.defaultProps={transformLinkUri:function(e){const t=(e||"").trim(),n=t.charAt(0);if("#"===n||"/"===n)return t;const i=t.indexOf(":");if(-1===i)return t;let r=-1;for(;++r<OAe.length;){const e=OAe[r];if(i===e.length&&t.slice(0,e.length).toLowerCase()===e)return t}return r=t.indexOf("?"),-1!==r&&i>r?t:(r=t.indexOf("#"),-1!==r&&i>r?t:"javascript:void(0)")}},sBe.propTypes={children:v.string,className:v.string,allowElement:v.func,allowedElements:v.arrayOf(v.string),disallowedElements:v.arrayOf(v.string),unwrapDisallowed:v.bool,remarkPlugins:v.arrayOf(v.oneOfType([v.object,v.func,v.arrayOf(v.oneOfType([v.object,v.func]))])),rehypePlugins:v.arrayOf(v.oneOfType([v.object,v.func,v.arrayOf(v.oneOfType([v.object,v.func]))])),sourcePos:v.bool,rawSourcePos:v.bool,skipHtml:v.bool,includeElementIndex:v.bool,transformLinkUri:v.oneOfType([v.func,v.bool]),linkTarget:v.oneOfType([v.func,v.string]),transformImageUri:v.func,components:v.object};const aBe={tokenize:function(e,t,n){return function(t){return e.consume(t),i};function i(t){return 87===t||119===t?(e.consume(t),r):n(t)}function r(t){return 87===t||119===t?(e.consume(t),o):n(t)}function o(t){return 46===t?(e.consume(t),s):n(t)}function s(e){return null===e||OOe(e)?n(e):t(e)}},partial:!0},lBe={tokenize:function(e,t,n){let i,r;return o;function o(t){return 38===t?e.check(hBe,a,s)(t):46===t||95===t?e.check(uBe,a,s)(t):null===t||MOe(t)||POe(t)||45!==t&&FOe(t)?a(t):(e.consume(t),o)}function s(t){return 46===t?(r=i,i=void 0,e.consume(t),o):(95===t&&(i=!0),e.consume(t),o)}function a(e){return r||i?n(e):t(e)}},partial:!0},cBe={tokenize:function(e,t){let n=0;return i;function i(s){return 38===s?e.check(hBe,t,r)(s):(40===s&&n++,41===s?e.check(uBe,o,r)(s):_Be(s)?t(s):yBe(s)?e.check(uBe,t,r)(s):(e.consume(s),i))}function r(t){return e.consume(t),i}function o(e){return n--,n<0?t(e):r(e)}},partial:!0},uBe={tokenize:function(e,t,n){return function(t){return e.consume(t),i};function i(r){return yBe(r)?(e.consume(r),i):_Be(r)?t(r):n(r)}},partial:!0},hBe={tokenize:function(e,t,n){return function(t){return e.consume(t),i};function i(t){return kOe(t)?(e.consume(t),i):59===t?(e.consume(t),r):n(t)}function r(e){return _Be(e)?t(e):n(e)}},partial:!0},dBe={tokenize:function(e,t,n){const i=this;return function(t){if(87!==t&&119!==t||!wBe(i.previous)||xBe(i.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(aBe,e.attempt(lBe,e.attempt(cBe,r),n),n)(t)};function r(n){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(n)}},previous:wBe},fBe={tokenize:function(e,t,n){const i=this;return function(t){if(72!==t&&104!==t||!CBe(i.previous)||xBe(i.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),e.consume(t),r};function r(t){return 84===t||116===t?(e.consume(t),o):n(t)}function o(t){return 84===t||116===t?(e.consume(t),s):n(t)}function s(t){return 80===t||112===t?(e.consume(t),a):n(t)}function a(t){return 83===t||115===t?(e.consume(t),l):l(t)}function l(t){return 58===t?(e.consume(t),c):n(t)}function c(t){return 47===t?(e.consume(t),u):n(t)}function u(t){return 47===t?(e.consume(t),h):n(t)}function h(t){return null===t||MOe(t)||POe(t)||FOe(t)?n(t):e.attempt(lBe,e.attempt(cBe,d),n)(t)}function d(n){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(n)}},previous:CBe},gBe={tokenize:function(e,t,n){const i=this;let r,o;return function(t){if(!bBe(t)||!SBe(i.previous)||xBe(i.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),s(t)};function s(t){return bBe(t)?(e.consume(t),s):64===t?(e.consume(t),a):n(t)}function a(t){return 46===t?e.check(uBe,h,l)(t):45===t||95===t?e.check(uBe,n,c)(t):NOe(t)?(!o&&LOe(t)&&(o=!0),e.consume(t),a):h(t)}function l(t){return e.consume(t),r=!0,o=void 0,a}function c(t){return e.consume(t),u}function u(t){return 46===t?e.check(uBe,n,l)(t):a(t)}function h(i){return r&&!o?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(i)):n(i)}},previous:SBe},pBe={},mBe={text:pBe};let vBe=48;for(;vBe<123;)pBe[vBe]=gBe,vBe++,58===vBe?vBe=65:91===vBe&&(vBe=97);function yBe(e){return 33===e||34===e||39===e||41===e||42===e||44===e||46===e||58===e||59===e||60===e||63===e||95===e||126===e}function _Be(e){return null===e||60===e||AOe(e)}function bBe(e){return 43===e||45===e||46===e||95===e||NOe(e)}function wBe(e){return null===e||40===e||42===e||95===e||126===e||AOe(e)}function CBe(e){return null===e||!kOe(e)}function SBe(e){return 47!==e&&CBe(e)}function xBe(e){let t=e.length,n=!1;for(;t--;){const i=e[t][1];if(("labelLink"===i.type||"labelImage"===i.type)&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}pBe[43]=gBe,pBe[45]=gBe,pBe[46]=gBe,pBe[95]=gBe,pBe[72]=[gBe,fBe],pBe[104]=[gBe,fBe],pBe[87]=[gBe,dBe],pBe[119]=[gBe,dBe];const EBe={tokenize:function(e,t,n){const i=this;return WOe(e,(function(e){const r=i.events[i.events.length-1];return r&&"gfmFootnoteDefinitionIndent"===r[1].type&&4===r[2].sliceSerialize(r[1],!0).length?t(e):n(e)}),"gfmFootnoteDefinitionIndent",5)},partial:!0};function kBe(e,t,n){const i=this;let r=i.events.length;const o=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s;for(;r--;){const e=i.events[r][1];if("labelImage"===e.type){s=e;break}if("gfmFootnoteCall"===e.type||"labelLink"===e.type||"label"===e.type||"image"===e.type||"link"===e.type)break}return function(r){if(!s||!s._balanced)return n(r);const a=dRe(i.sliceSerialize({start:s.end,end:i.now()}));if(94!==a.charCodeAt(0)||!o.includes(a.slice(1)))return n(r);return e.enter("gfmFootnoteCallLabelMarker"),e.consume(r),e.exit("gfmFootnoteCallLabelMarker"),t(r)}}function LBe(e,t){let n=e.length;for(;n--;)if("labelImage"===e[n][1].type&&"enter"===e[n][0]){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},e[e.length-1][1].start)},s={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},a=[e[n+1],e[n+2],["enter",i,t],e[n+3],e[n+4],["enter",r,t],["exit",r,t],["enter",o,t],["enter",s,t],["exit",s,t],["exit",o,t],e[e.length-2],e[e.length-1],["exit",i,t]];return e.splice(n,e.length-n+1,...a),e}function DBe(e,t,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o,s=0;return function(t){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(t),e.exit("gfmFootnoteCallLabelMarker"),a};function a(t){return 94!==t?n(t):(e.enter("gfmFootnoteCallMarker"),e.consume(t),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",l)}function l(a){let u;return null===a||91===a||s++>999?n(a):93===a?o?(e.exit("chunkString"),u=e.exit("gfmFootnoteCallString"),r.includes(dRe(i.sliceSerialize(u)))?function(n){return e.enter("gfmFootnoteCallLabelMarker"),e.consume(n),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t}(a):n(a)):n(a):(e.consume(a),AOe(a)||(o=!0),92===a?c:l)}function c(t){return 91===t||92===t||93===t?(e.consume(t),s++,l):l(t)}}function NBe(e,t,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o,s,a=0;return function(t){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),l};function l(t){return 94===t?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),c):n(t)}function c(t){let r;return null===t||91===t||a>999?n(t):93===t?s?(r=e.exit("gfmFootnoteDefinitionLabelString"),o=dRe(i.sliceSerialize(r)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),d):n(t):OOe(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a++,c):(e.enter("chunkString").contentType="string",u(t))}function u(t){return null===t||OOe(t)||91===t||93===t||a>999?(e.exit("chunkString"),c(t)):(AOe(t)||(s=!0),a++,e.consume(t),92===t?h:u)}function h(t){return 91===t||92===t||93===t?(e.consume(t),a++,u):u(t)}function d(t){return 58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),WOe(e,f,"gfmFootnoteDefinitionWhitespace")):n(t)}function f(e){return r.includes(o)||r.push(o),t(e)}}function IBe(e,t,n){return e.check($Oe,t,e.attempt(EBe,t,n))}function TBe(e){e.exit("gfmFootnoteDefinition")}function MBe(e={}){let t=e.singleTilde;const n={tokenize:function(e,n,i){const r=this.previous,o=this.events;let s=0;return function(t){if(126===r&&"characterEscape"!==o[o.length-1][1].type)return i(t);return e.enter("strikethroughSequenceTemporary"),a(t)};function a(o){const l=HOe(r);if(126===o)return s>1?i(o):(e.consume(o),s++,a);if(s<2&&!t)return i(o);const c=e.exit("strikethroughSequenceTemporary"),u=HOe(o);return c._open=!u||2===u&&Boolean(l),c._close=!l||2===l&&Boolean(u),n(o)}},resolveAll:function(e,t){let n=-1;for(;++n<e.length;)if("enter"===e[n][0]&&"strikethroughSequenceTemporary"===e[n][1].type&&e[n][1]._close){let i=n;for(;i--;)if("exit"===e[i][0]&&"strikethroughSequenceTemporary"===e[i][1].type&&e[i][1]._open&&e[n][1].end.offset-e[n][1].start.offset==e[i][1].end.offset-e[i][1].start.offset){e[n][1].type="strikethroughSequence",e[i][1].type="strikethroughSequence";const r={type:"strikethrough",start:Object.assign({},e[i][1].start),end:Object.assign({},e[n][1].end)},o={type:"strikethroughText",start:Object.assign({},e[i][1].end),end:Object.assign({},e[n][1].start)},s=[["enter",r,t],["enter",e[i][1],t],["exit",e[i][1],t],["enter",o,t]];bOe(s,s.length,0,jOe(t.parser.constructs.insideSpan.null,e.slice(i+1,n),t)),bOe(s,s.length,0,[["exit",o,t],["enter",e[n][1],t],["exit",e[n][1],t],["exit",r,t]]),bOe(e,i-1,n-i+3,s),n=i+s.length-2;break}}n=-1;for(;++n<e.length;)"strikethroughSequenceTemporary"===e[n][1].type&&(e[n][1].type="data");return e}};return null==t&&(t=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}}}const ABe={flow:{null:{tokenize:function(e,t,n){const i=this,r=[];let o,s,a=0;return function(t){if(e.enter("table")._align=r,e.enter("tableHead"),e.enter("tableRow"),124===t)return l(t);return a++,e.enter("temporaryTableCellContent"),h(t)};function l(t){return e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),o=!0,c}function c(t){return null===t||OOe(t)?function(t){if(null===t)return n(t);e.exit("tableRow"),e.exit("tableHead");const r=i.interrupt;return i.interrupt=!0,e.attempt({tokenize:D,partial:!0},(function(t){return i.interrupt=r,e.enter("tableDelimiterRow"),f(t)}),(function(e){return i.interrupt=r,n(e)}))(t)}(t):ROe(t)?(e.enter("whitespace"),e.consume(t),u):(o&&(o=void 0,a++),124===t?l(t):(e.enter("temporaryTableCellContent"),h(t)))}function u(t){return ROe(t)?(e.consume(t),u):(e.exit("whitespace"),c(t))}function h(t){return null===t||124===t||AOe(t)?(e.exit("temporaryTableCellContent"),c(t)):(e.consume(t),92===t?d:h)}function d(t){return 92===t||124===t?(e.consume(t),h):h(t)}function f(t){return null===t||OOe(t)?y(t):ROe(t)?(e.enter("whitespace"),e.consume(t),g):45===t?(e.enter("tableDelimiterFiller"),e.consume(t),s=!0,r.push("none"),p):58===t?(e.enter("tableDelimiterAlignment"),e.consume(t),e.exit("tableDelimiterAlignment"),r.push("left"),m):124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),f):n(t)}function g(t){return ROe(t)?(e.consume(t),g):(e.exit("whitespace"),f(t))}function p(t){return 45===t?(e.consume(t),p):(e.exit("tableDelimiterFiller"),58===t?(e.enter("tableDelimiterAlignment"),e.consume(t),e.exit("tableDelimiterAlignment"),r[r.length-1]="left"===r[r.length-1]?"center":"right",v):f(t))}function m(t){return 45===t?(e.enter("tableDelimiterFiller"),e.consume(t),s=!0,p):n(t)}function v(t){return null===t||OOe(t)?y(t):ROe(t)?(e.enter("whitespace"),e.consume(t),g):124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),f):n(t)}function y(t){return e.exit("tableDelimiterRow"),s&&a===r.length?null===t?_(t):e.check(OBe,_,e.attempt({tokenize:D,partial:!0},WOe(e,b,"linePrefix",4),_))(t):n(t)}function _(n){return e.exit("table"),t(n)}function b(t){return e.enter("tableBody"),w(t)}function w(t){return e.enter("tableRow"),124===t?C(t):(e.enter("temporaryTableCellContent"),E(t))}function C(t){return e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),S}function S(t){return null===t||OOe(t)?function(t){if(e.exit("tableRow"),null===t)return L(t);return e.check(OBe,L,e.attempt({tokenize:D,partial:!0},WOe(e,w,"linePrefix",4),L))(t)}(t):ROe(t)?(e.enter("whitespace"),e.consume(t),x):124===t?C(t):(e.enter("temporaryTableCellContent"),E(t))}function x(t){return ROe(t)?(e.consume(t),x):(e.exit("whitespace"),S(t))}function E(t){return null===t||124===t||AOe(t)?(e.exit("temporaryTableCellContent"),S(t)):(e.consume(t),92===t?k:E)}function k(t){return 92===t||124===t?(e.consume(t),E):E(t)}function L(t){return e.exit("tableBody"),_(t)}function D(e,t,n){return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),WOe(e,r,"linePrefix")};function r(r){if(i.parser.lazy[i.now().line]||null===r||OOe(r))return n(r);const o=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&o&&"linePrefix"===o[1].type&&o[2].sliceSerialize(o[1],!0).length>=4?n(r):(i._gfmTableDynamicInterruptHack=!0,e.check(i.parser.constructs.flow,(function(e){return i._gfmTableDynamicInterruptHack=!1,n(e)}),(function(e){return i._gfmTableDynamicInterruptHack=!1,t(e)}))(r))}}},resolve:function(e,t){let n,i,r,o,s,a,l,c=-1;for(;++c<e.length;){const u=e[c][1];if(r&&("temporaryTableCellContent"===u.type&&(o=o||c,s=c),("tableCellDivider"===u.type||"tableRow"===u.type)&&s)){const n={type:"tableContent",start:e[o][1].start,end:e[s][1].end},i={type:"chunkText",start:n.start,end:n.end,contentType:"text"};e.splice(o,s-o+1,["enter",n,t],["enter",i,t],["exit",i,t],["exit",n,t]),c-=s-o-3,o=void 0,s=void 0}if("exit"===e[c][0]&&void 0!==a&&a+(l?0:1)<c&&("tableCellDivider"===u.type||"tableRow"===u.type&&(a+3<c||"whitespace"!==e[a][1].type))){const r={type:i?"tableDelimiter":n?"tableHeader":"tableData",start:e[a][1].start,end:e[c][1].end};e.splice(c+("tableCellDivider"===u.type?1:0),0,["exit",r,t]),e.splice(a,0,["enter",r,t]),c+=2,a=c+1,l=!0}"tableRow"===u.type&&(r="enter"===e[c][0],r&&(a=c+1,l=!1)),"tableDelimiterRow"===u.type&&(i="enter"===e[c][0],i&&(a=c+1,l=!1)),"tableHead"===u.type&&(n="enter"===e[c][0])}return e}}}},OBe={tokenize:function(e,t,n){let i=0;return function(t){return e.enter("check"),e.consume(t),r};function r(o){return-1===o||32===o?(e.consume(o),i++,4===i?t:r):null===o||AOe(o)?t(o):n(o)}},partial:!0};const RBe={text:{91:{tokenize:function(e,t,n){const i=this;return function(t){if(null!==i.previous||!i._gfmTasklistFirstContentOfListItem)return n(t);return e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),r};function r(t){return AOe(t)?(e.enter("taskListCheckValueUnchecked"),e.consume(t),e.exit("taskListCheckValueUnchecked"),o):88===t||120===t?(e.enter("taskListCheckValueChecked"),e.consume(t),e.exit("taskListCheckValueChecked"),o):n(t)}function o(i){return 93===i?(e.enter("taskListCheckMarker"),e.consume(i),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),e.check({tokenize:PBe},t,n)):n(i)}}}}};function PBe(e,t,n){const i=this;return WOe(e,(function(e){const r=i.events[i.events.length-1];return(r&&"whitespace"===r[1].type||OOe(e))&&null!==e?t(e):n(e)}),"whitespace")}function FBe(e,t){const n=String(e);if("string"!=typeof t)throw new TypeError("Expected character");let i=0,r=n.indexOf(t);for(;-1!==r;)i++,r=n.indexOf(t,r+t.length);return i}const BBe={}.hasOwnProperty,WBe=function(e,t,n,i){let r,o;"string"==typeof t||t instanceof RegExp?(o=[[t,n]],r=i):(o=t,r=n),r||(r={});const s=fPe(r.ignore||[]),a=function(e){const t=[];if("object"!=typeof e)throw new TypeError("Expected array or object as schema");if(Array.isArray(e)){let n=-1;for(;++n<e.length;)t.push([zBe(e[n][0]),VBe(e[n][1])])}else{let n;for(n in e)BBe.call(e,n)&&t.push([zBe(n),VBe(e[n])])}return t}(o);let l=-1;for(;++l<a.length;)wPe(e,"text",c);return e;function c(e,t){let n,i=-1;for(;++i<t.length;){const e=t[i];if(s(e,n?n.children.indexOf(e):void 0,n))return;n=e}if(n)return function(e,t){const n=a[l][0],i=a[l][1];let r,o=0,s=t.children.indexOf(e),c=[];n.lastIndex=0;let u=n.exec(e.value);for(;u;){r=u.index;let t=i(...u,{index:u.index,input:u.input});if("string"==typeof t&&(t=t.length>0?{type:"text",value:t}:void 0),!1!==t&&(o!==r&&c.push({type:"text",value:e.value.slice(o,r)}),Array.isArray(t)?c.push(...t):t&&c.push(t),o=r+u[0].length),!n.global)break;u=n.exec(e.value)}void 0===r?(c=[e],s--):(o<e.value.length&&c.push({type:"text",value:e.value.slice(o)}),t.children.splice(s,1,...c));return s+c.length+1}(e,n)}};function zBe(e){return"string"==typeof e?new RegExp(function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(e),"g"):e}function VBe(e){return"function"==typeof e?e:()=>e}const UBe=["autolink","link","image","label"],HBe={transforms:[function(e){WBe(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,KBe],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/g,qBe]],{ignore:["link","linkReference"]})}],enter:{literalAutolink:function(e){this.enter({type:"link",title:null,url:"",children:[]},e)},literalAutolinkEmail:GBe,literalAutolinkHttp:GBe,literalAutolinkWww:GBe},exit:{literalAutolink:function(e){this.exit(e)},literalAutolinkEmail:function(e){this.config.exit.autolinkEmail.call(this,e)},literalAutolinkHttp:function(e){this.config.exit.autolinkProtocol.call(this,e)},literalAutolinkWww:function(e){this.config.exit.data.call(this,e);this.stack[this.stack.length-1].url="http://"+this.sliceSerialize(e)}}},jBe={unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct:UBe},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct:UBe},{character:":",before:"[ps]",after:"\\/",inConstruct:"phrasing",notInConstruct:UBe}]};function GBe(e){this.config.enter.autolinkProtocol.call(this,e)}function KBe(e,t,n,i,r){let o="";if(!$Be(r))return!1;if(/^w/i.test(t)&&(n=t+n,t="",o="http://"),!function(e){const t=e.split(".");if(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))return!1;return!0}(n))return!1;const s=function(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);let n,i,r,o;if(t)for(e=e.slice(0,t.index),o=t[0],n=o.indexOf(")"),i=FBe(e,"("),r=FBe(e,")");-1!==n&&i>r;)e+=o.slice(0,n+1),o=o.slice(n+1),n=o.indexOf(")"),r++;return[e,o]}(n+i);if(!s[0])return!1;const a={type:"link",title:null,url:o+t+s[0],children:[{type:"text",value:t+s[0]}]};return s[1]?[a,{type:"text",value:s[1]}]:a}function qBe(e,t,n,i){return!(!$Be(i,!0)||/[_-\d]$/.test(n))&&{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function $Be(e,t){const n=e.input.charCodeAt(e.index-1);return(0===e.index||POe(n)||FOe(n))&&(!t||47!==n)}function YBe(e){return e.label||!e.identifier?e.label||"":JRe(e.identifier)}function XBe(e){const t=e||{},n=t.now||{};let i=t.lineShift||0,r=n.line||1,o=n.column||1;return{move:function(e=""){const t=e.split(/\r?\n|\r/g),n=t[t.length-1];return r+=t.length-1,o=1===t.length?o+n.length:1+n.length+i,e},current:function(){return{now:{line:r,column:o},lineShift:i}},shift:function(e){i+=e}}}function ZBe(e,t,n){const i=t.indexStack,r=e.children||[],o=XBe(n),s=[];let l=-1;for(i.push(-1);++l<r.length;){const n=r[l];i[i.length-1]=l,s.push(o.move(t.handle(n,e,t,a({before:"\n",after:"\n"},o.current())))),"list"!==n.type&&(t.bulletLastUsed=void 0),l<r.length-1&&s.push(o.move(c(n,r[l+1])))}return i.pop(),s.join("");function c(n,i){let r=t.join.length;for(;r--;){const o=t.join[r](n,i,e,t);if(!0===o||1===o)break;if("number"==typeof o)return"\n".repeat(1+o);if(!1===o)return"\n\n\x3c!----\x3e\n\n"}return"\n\n"}}const QBe=/\r?\n|\r/g;function JBe(e,t){const n=[];let i,r=0,o=0;for(;i=QBe.exec(e);)s(e.slice(r,i.index)),n.push(i[0]),r=i.index+i[0].length,o++;return s(e.slice(r)),n.join("");function s(e){n.push(t(e,o,!e))}}function eWe(e){if(!e._compiled){const t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function tWe(e,t){return nWe(e,t.inConstruct,!0)&&!nWe(e,t.notInConstruct,!1)}function nWe(e,t,n){if(!t)return n;"string"==typeof t&&(t=[t]);let i=-1;for(;++i<t.length;)if(e.includes(t[i]))return!0;return!1}function iWe(e,t,n){const i=(n.before||"")+(t||"")+(n.after||""),r=[],o=[],s={};let a=-1;for(;++a<e.unsafe.length;){const t=e.unsafe[a];if(!tWe(e.stack,t))continue;const n=eWe(t);let o;for(;o=n.exec(i);){const e="before"in t||Boolean(t.atBreak),n="after"in t,i=o.index+(e?o[1].length:0);r.includes(i)?(s[i].before&&!e&&(s[i].before=!1),s[i].after&&!n&&(s[i].after=!1)):(r.push(i),s[i]={before:e,after:n})}}r.sort(rWe);let l=n.before?n.before.length:0;const c=i.length-(n.after?n.after.length:0);for(a=-1;++a<r.length;){const e=r[a];e<l||e>=c||(e+1<c&&r[a+1]===e+1&&s[e].after&&!s[e+1].before&&!s[e+1].after||r[a-1]===e-1&&s[e].before&&!s[e-1].before&&!s[e-1].after||(l!==e&&o.push(oWe(i.slice(l,e),"\\")),l=e,!/[!-/:-@[-`{-~]/.test(i.charAt(e))||n.encode&&n.encode.includes(i.charAt(e))?(o.push("&#x"+i.charCodeAt(e).toString(16).toUpperCase()+";"),l++):o.push("\\")))}return o.push(oWe(i.slice(l,c),n.after)),o.join("")}function rWe(e,t){return e-t}function oWe(e,t){const n=/\\(?=[!-/:-@[-`{-~])/g,i=[],r=[],o=e+t;let s,a=-1,l=0;for(;s=n.exec(o);)i.push(s.index);for(;++a<i.length;)l!==i[a]&&r.push(e.slice(l,i[a])),r.push("\\"),l=i[a];return r.push(e.slice(l)),r.join("")}function sWe(){return e.peek=function(){return"["},{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:function(e,t,n,i){const r=XBe(i);let o=r.move("[^");const s=n.enter("footnoteDefinition"),c=n.enter("label");return o+=r.move(iWe(n,YBe(e),l(a({},r.current()),{before:o,after:"]"}))),c(),o+=r.move("]:"+(e.children&&e.children.length>0?" ":"")),r.shift(4),o+=r.move(JBe(ZBe(e,n,r.current()),(function(e,t,n){if(t)return(n?"":"    ")+e;return e}))),s(),o},footnoteReference:e}};function e(e,t,n,i){const r=XBe(i);let o=r.move("[^");const s=n.enter("footnoteReference"),c=n.enter("reference");return o+=r.move(iWe(n,YBe(e),l(a({},r.current()),{before:o,after:"]"}))),c(),s(),o+=r.move("]"),o}}function aWe(e,t,n){const i=t.indexStack,r=e.children||[],o=[];let s=-1,c=n.before;i.push(-1);let u=XBe(n);for(;++s<r.length;){const h=r[s];let d;if(i[i.length-1]=s,s+1<r.length){let n=t.handle.handlers[r[s+1].type];n&&n.peek&&(n=n.peek),d=n?n(r[s+1],e,t,a({before:"",after:""},u.current())).charAt(0):""}else d=n.after;o.length>0&&("\r"===c||"\n"===c)&&"html"===h.type&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),c=" ",u=XBe(n),u.move(o.join(""))),o.push(u.move(t.handle(h,e,t,l(a({},u.current()),{before:c,after:d})))),c=o[o.length-1].slice(-1)}return i.pop(),o.join("")}const lWe={canContainEols:["delete"],enter:{strikethrough:function(e){this.enter({type:"delete",children:[]},e)}},exit:{strikethrough:function(e){this.exit(e)}}},cWe={unsafe:[{character:"~",inConstruct:"phrasing"}],handlers:{delete:uWe}};function uWe(e,t,n,i){const r=XBe(i),o=n.enter("emphasis");let s=r.move("~~");return s+=aWe(e,n,l(a({},r.current()),{before:s,after:"~"})),s+=r.move("~~"),o(),s}function hWe(e,t,n){let i=e.value||"",r="`",o=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++o<n.unsafe.length;){const e=n.unsafe[o],t=eWe(e);let r;if(e.atBreak)for(;r=t.exec(i);){let e=r.index;10===i.charCodeAt(e)&&13===i.charCodeAt(e-1)&&e--,i=i.slice(0,e)+" "+i.slice(r.index+1)}}return r+i+r}function dWe(e){return e.length}function fWe(e){const t="string"==typeof e?e.codePointAt(0):0;return 67===t||99===t?99:76===t||108===t?108:82===t||114===t?114:0}uWe.peek=function(){return"~"},hWe.peek=function(){return"`"};const gWe={enter:{table:function(e){const t=e._align;this.enter({type:"table",align:t.map((e=>"none"===e?null:e)),children:[]},e),this.setData("inTable",!0)},tableData:mWe,tableHeader:mWe,tableRow:function(e){this.enter({type:"tableRow",children:[]},e)}},exit:{codeText:function(e){let t=this.resume();this.getData("inTable")&&(t=t.replace(/\\([\\|])/g,vWe));this.stack[this.stack.length-1].value=t,this.exit(e)},table:function(e){this.exit(e),this.setData("inTable")},tableData:pWe,tableHeader:pWe,tableRow:pWe}};function pWe(e){this.exit(e)}function mWe(e){this.enter({type:"tableCell",children:[]},e)}function vWe(e,t){return"|"===t?t:e}function yWe(e){const t=e||{},n=t.tableCellPadding,i=t.tablePipeAlign,r=t.stringLength,o=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:"\n",inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[\t :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{table:function(e,t,n,i){return c(function(e,t,n){const i=e.children;let r=-1;const o=[],s=t.enter("table");for(;++r<i.length;)o[r]=u(i[r],t,n);return s(),o}(e,n,i),e.align)},tableRow:function(e,t,n,i){const r=c([u(e,n,i)]);return r.slice(0,r.indexOf("\n"))},tableCell:s,inlineCode:function(e,t,n){let i=hWe(e,0,n);n.stack.includes("tableCell")&&(i=i.replace(/\|/g,"\\$&"));return i}}};function s(e,t,n,i){const r=n.enter("tableCell"),s=n.enter("phrasing"),c=aWe(e,n,l(a({},i),{before:o,after:o}));return s(),r(),c}function c(e,t){return function(e,t={}){const n=(t.align||[]).concat(),i=t.stringLength||dWe,r=[],o=[],s=[],a=[];let l=0,c=-1;for(;++c<e.length;){const n=[],r=[];let h=-1;for(e[c].length>l&&(l=e[c].length);++h<e[c].length;){const o=null==(u=e[c][h])?"":String(u);if(!1!==t.alignDelimiters){const e=i(o);r[h]=e,(void 0===a[h]||e>a[h])&&(a[h]=e)}n.push(o)}o[c]=n,s[c]=r}var u;let h=-1;if("object"==typeof n&&"length"in n)for(;++h<l;)r[h]=fWe(n[h]);else{const e=fWe(n);for(;++h<l;)r[h]=e}h=-1;const d=[],f=[];for(;++h<l;){const e=r[h];let n="",i="";99===e?(n=":",i=":"):108===e?n=":":114===e&&(i=":");let o=!1===t.alignDelimiters?1:Math.max(1,a[h]-n.length-i.length);const s=n+"-".repeat(o)+i;!1!==t.alignDelimiters&&(o=n.length+o+i.length,o>a[h]&&(a[h]=o),f[h]=o),d[h]=s}o.splice(1,0,d),s.splice(1,0,f),c=-1;const g=[];for(;++c<o.length;){const e=o[c],n=s[c];h=-1;const i=[];for(;++h<l;){const o=e[h]||"";let s="",c="";if(!1!==t.alignDelimiters){const e=a[h]-(n[h]||0),t=r[h];114===t?s=" ".repeat(e):99===t?e%2?(s=" ".repeat(e/2+.5),c=" ".repeat(e/2-.5)):(s=" ".repeat(e/2),c=s):c=" ".repeat(e)}!1===t.delimiterStart||h||i.push("|"),!1===t.padding||!1===t.alignDelimiters&&""===o||!1===t.delimiterStart&&!h||i.push(" "),!1!==t.alignDelimiters&&i.push(s),i.push(o),!1!==t.alignDelimiters&&i.push(c),!1!==t.padding&&i.push(" "),!1===t.delimiterEnd&&h===l-1||i.push("|")}g.push(!1===t.delimiterEnd?i.join("").replace(/ +$/,""):i.join(""))}return g.join("\n")}(e,{align:t,alignDelimiters:i,padding:n,stringLength:r})}function u(e,t,n){const i=e.children;let r=-1;const o=[],a=t.enter("tableRow");for(;++r<i.length;)o[r]=s(i[r],0,t,n);return a(),o}}function _We(e,t,n,i){const r=function(e){const t=e.options.listItemIndent||"tab";if(1===t||"1"===t)return"one";if("tab"!==t&&"one"!==t&&"mixed"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}(n);let o=n.bulletCurrent||function(e){const t=e.options.bullet||"*";if("*"!==t&&"+"!==t&&"-"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}(n);t&&"list"===t.type&&t.ordered&&(o=("number"==typeof t.start&&t.start>-1?t.start:1)+(!1===n.options.incrementListMarker?0:t.children.indexOf(e))+o);let s=o.length+1;("tab"===r||"mixed"===r&&(t&&"list"===t.type&&t.spread||e.spread))&&(s=4*Math.ceil(s/4));const a=XBe(i);a.move(o+" ".repeat(s-o.length)),a.shift(s);const l=n.enter("listItem"),c=JBe(ZBe(e,n,a.current()),(function(e,t,n){if(t)return(n?"":" ".repeat(s))+e;return(n?o:o+" ".repeat(s-o.length))+e}));return l(),c}const bWe={exit:{taskListCheckValueChecked:CWe,taskListCheckValueUnchecked:CWe,paragraph:function(e){const t=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],i=t.children,r=n.children[0];let o,s=-1;if(t&&"listItem"===t.type&&"boolean"==typeof t.checked&&r&&"text"===r.type){for(;++s<i.length;){const e=i[s];if("paragraph"===e.type){o=e;break}}o===n&&(r.value=r.value.slice(1),0===r.value.length?n.children.shift():n.position&&r.position&&"number"==typeof r.position.start.offset&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}this.exit(e)}}},wWe={unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:function(e,t,n,i){const r=e.children[0],o="boolean"==typeof e.checked&&r&&"paragraph"===r.type,s="["+(e.checked?"x":" ")+"] ",l=XBe(i);o&&l.move(s);let c=_We(e,t,n,a(a({},i),l.current()));o&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,(function(e){return e+s})));return c}}};function CWe(e){this.stack[this.stack.length-2].checked="taskListCheckValueChecked"===e.type}function SWe(e={}){const t=this.data();function n(e,n){(t[e]?t[e]:t[e]=[]).push(n)}n("micromarkExtensions",function(e){return SOe([mBe,{document:{91:{tokenize:NBe,continuation:{tokenize:IBe},exit:TBe}},text:{91:{tokenize:DBe},93:{add:"after",tokenize:kBe,resolveTo:LBe}}},MBe(e),ABe,RBe])}(e)),n("fromMarkdownExtensions",[HBe,{enter:{gfmFootnoteDefinition:function(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)},gfmFootnoteDefinitionLabelString:function(){this.buffer()},gfmFootnoteCall:function(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)},gfmFootnoteCallString:function(){this.buffer()}},exit:{gfmFootnoteDefinition:function(e){this.exit(e)},gfmFootnoteDefinitionLabelString:function(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=dRe(this.sliceSerialize(e)).toLowerCase()},gfmFootnoteCall:function(e){this.exit(e)},gfmFootnoteCallString:function(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=dRe(this.sliceSerialize(e)).toLowerCase()}}},lWe,gWe,bWe]),n("toMarkdownExtensions",function(e){return{extensions:[jBe,sWe(),cWe,yWe(e),wWe]}}(e))}const xWe=p((e=>{var t;const{dataStore:n,uiStore:i}=be("BenchStore"),{windowTab:r}=e,{menu:o}=r,s=r.key,c="development"===o||"query"===o,u="operation"===o,g=n.workspaceData.consoleDataList.find((e=>e.winTabKey===s)),p=()=>{if(c)return[{key:"log",label:"运行日志"},{key:"result",label:"运行结果"}];if(u){const e=[{key:"info",label:"作业属性"}];return"周期实例"===r.type&&e.push({key:"log",label:"运行日志"}),e.push({key:"code1",label:"作业代码"}),e}return"markdown"===r.type?[{key:"markdown",label:"效果"}]:[]},{getCache:m,getUpdateCacheValue:v}=si("___console_caches",{tab:null==(t=p()[0])?void 0:t.key,splitSize:250,visible:!0}),y=v(s),_=m(s),b=u&&"log"!==_.tab||"markdown"===_.tab,w=((null==g?void 0:g.jobHistoryList)||[]).find((e=>e.jobId===(null==g?void 0:g.jobId))),C=null==w?void 0:w.log;var S,x,E,k,L;S=()=>{const e=null==g?void 0:g.jobId;e&&((null==w?void 0:w.done)||n.checkConsoleJobDone(s,e),"log"===_.tab?(null==C?void 0:C.done)||n.fetchConsoleLog(s,e):"result"===_.tab&&((null==w?void 0:w.done)&&w.result||n.fetchConsoleResult(s,e)))},x=1e3,k=null==E?void 0:E.immediate,(L=h.exports.useRef()).current=S,h.exports.useEffect((function(){var e;if(null!=x){k&&(null===(e=L.current)||void 0===e||e.call(L));var t=setInterval((function(){var e;null===(e=L.current)||void 0===e||e.call(L)}),x);return function(){clearInterval(t)}}}),[x]);return d.createElement(d.Fragment,null,d.createElement("div",{className:"console-container"},d.createElement("div",{className:"console-header"},d.createElement(Ui,{className:"tabs",activeKey:_.tab,onChangeTab:e=>y((t=>t.tab=e)),options:p()}),d.createElement("div",{className:"operation-bar"},d.createElement(_e,{type:_.visible?"left2":"right2",onClick:()=>y((e=>e.visible=!e.visible))}),d.createElement(_e,{type:"refresh2",onClick:()=>{n.fetchJobHistoryList(s)}}),d.createElement(_e,{type:i.uiSetting.windowFooterFull?"down2":"up2",onClick:()=>i.setWindowFooterFull(!i.uiSetting.windowFooterFull)}),d.createElement(_e,{type:"close",onClick:()=>i.setWindowFooterVisible(!1)}))),d.createElement("div",{className:"console-main"},(()=>{if("markdown"===_.tab){const e=n.workspaceData.fileList.find((e=>e.id===r.id));return e&&d.createElement($,null,(()=>d.createElement("div",{className:"markdown-container "},d.createElement(sBe,{children:e.content.code,remarkPlugins:[SWe]}))))}return!c||(null==g?void 0:g.jobHistoryList)&&0!==g.jobHistoryList.length?d.createElement(Xe,{pane2Style:{minWidth:"0px"},split:"vertical",size:!b&&_.visible?_.splitSize:0,minSize:250,maxSize:400,onChange:e=>_.visible&&y((t=>t.splitSize=e))},d.createElement(Ui,{className:f("tabs log-list",b||!_.visible?"hidden":""),mode:"vertical",onChangeTab:e=>n.changeConsoleJobId(s,e),activeKey:(null==g?void 0:g.jobId)||"",titleRender:e=>d.createElement($,null,(()=>{const t=e,i=ge(s);return d.createElement("div",{className:f("log-item")},d.createElement("div",{className:"title"},d.createElement(_e,{type:e.done?t.status:"ing1",className:f("mr-8","icon",t.status,e.done?"done":"undone",i?"biz":"")}),d.createElement("div",{className:f("flex items-start flex-col"),style:{lineHeight:i?"18px":"30px"}},d.createElement("div",null,Fi(t.createTime,"{m}-{d} {h}:{i}:{s}"),d.createElement("span",{className:"ml-8"},t.createBy)),i&&d.createElement("div",{className:"name"},t.name))),d.createElement("div",{className:"operation-bar"},!e.done&&d.createElement(_e,{className:f(e.done?"done":"undone"),type:"stop2",onClick:t=>{t.stopPropagation(),n.cancelConsoleJob(s,e.jobId)}})))})),options:(null==g?void 0:g.jobHistoryList.map((e=>l(a({},e),{key:e.jobId,label:""}))))||[]}),d.createElement("div",{className:"console-main-content"},"log"===_.tab?(null==C?void 0:C.lines)&&d.createElement(CAe,{options:{fontSize:13,lineHeight:24,automaticLayout:!0,renderLineHighlight:"none",readOnly:!0},width:"100%",height:"100%",value:(null==C?void 0:C.lines.join("\n"))+"\n",language:"log",theme:`log-${i.uiSetting.theme}`}):"result"===_.tab?d.createElement("div",{className:"relative p-10 h-full w-full overflow-auto"},(null==w?void 0:w.done)?(null==w?void 0:w.result)&&(w.result.data.length>0?d.createElement(EAe,{columns:w.result.columns,data:w.result.data}):d.createElement("div",{className:" text-center pt-20"},"没有运行结果")):d.createElement("div",{className:"text-center pt-20"},"正在运行中，请稍等……")):void _.tab)):d.createElement("div",{className:"text-center pt-20"},"当前没有运行记录")})())))}));const EWe={script:"本地脚本执行",remoteScript:"远程脚本执行",client:"客户端执行"},kWe=p((e=>{const{inited:t,changeCfg:n,cfg:i,refresh:r,save:o}=Hi(e.windowTab,(()=>{n((e=>{e.pluginInfo||(e.pluginInfo={name:"",version:""})}))}));return d.createElement(d.Fragment,null,t&&i&&d.createElement("div",{className:"p-10 whitespace-pre"},d.createElement("div",{className:"p-10 whitespace-pre"},d.createElement("button",{className:"button",onClick:r},"刷新"),d.createElement("button",{className:"button",onClick:o},"保存"),d.createElement("div",{className:"py-20"},d.createElement(O,{labelAlign:"left",labelCol:{span:2}},d.createElement(O.Item,{label:"模式"},EWe[i.mode]),d.createElement(O.Item,{label:"插件"},d.createElement("input",{style:{width:"200px"},spellCheck:!1,className:"input w-full",value:i.pluginInfo.name,onChange:e=>n((t=>{t.pluginInfo.name=e.target.value}))}),d.createElement("input",{spellCheck:!1,style:{width:"200px"},className:"input w-full",value:i.pluginInfo.version,onChange:e=>n((t=>{t.pluginInfo.version=e.target.value}))})),d.createElement(O.Item,{label:"支持类型"},i.supportSet.map((e=>d.createElement("span",{key:e,className:"mr-10"},e)))))))))}));const LWe=p((e=>{const[t,n]=h.exports.useState([]),{inited:i,cfg:r,refresh:o,save:s,changeCfg:a}=Hi(e.windowTab,(()=>{ue(e.workspaceId,0,"component").then((e=>{n(e)}))}));return d.createElement(d.Fragment,null,i&&d.createElement("div",{className:"p-20 whitespace-pre"},d.createElement("button",{className:"button",onClick:o},"刷新"),d.createElement("button",{className:"button",onClick:s},"保存"),d.createElement("div",{className:"p-20"},d.createElement(O,{labelAlign:"left",labelCol:{span:2}},d.createElement(O.Item,{label:"模式"},r.mode),d.createElement(O.Item,{label:"租户"},d.createElement("input",{style:{width:"200px"},spellCheck:!1,className:"input w-full",value:r.tenant,onChange:e=>a((t=>{t.tenant=e.target.value}))})),d.createElement(O.Item,{label:"组件"},t.filter((e=>r.componentFileIdSet.includes(e.id))).map((e=>e.name)).map((e=>d.createElement("span",{key:e,className:"mr-10"},e))))))))}));var DWe=p((e=>{const{className:t}=e,{uiStore:n,dataStore:i}=be("BenchStore"),r=n.curTab.get(),o=e=>d.createElement(d.Fragment,null,e&&d.createElement("div",{className:f("tab-title",{tmp:e.tmp})},(e=>d.createElement(d.Fragment,null,d.createElement("div",{className:"mr-8 text-vs-light-text-light dark:text-vs-dark-text-light  "},Ce[e.menu].label),"dep_kanban"===e.type?"dependency3":["trash","query","development","resource","document","component"].includes(e.menu)?Ii(e.type):d.createElement(_e,{type:"webpage"})))(e),d.createElement("div",{className:f({deleted:"trash"==e.menu})},e.label),e.changed&&d.createElement("div",{className:"dot"}," "))),s=e=>d.createElement(N,{onClick:t=>{if(null==e?void 0:e.key)switch(t.key){case"close":n.closeTab(e.key);break;case"close_others":n.closeOtherTabs(e.key);break;case"close_to_the_right":n.closeToTheRightTabs(e.key);break;case"keep_open":n.keepTabOpen(e.key)}switch(t.key){case"close_all":n.closeAllTabs();break;case"close_saved":n.closeSavedTabs()}}},e&&d.createElement(N.Item,{key:"close"},"关闭"),e&&d.createElement(N.Item,{key:"close_others"},"关闭其他"),e&&d.createElement(N.Item,{key:"close_to_the_right"},"关闭到右侧"),d.createElement(N.Item,{key:"close_saved"},"关闭已保存"),d.createElement(N.Item,{key:"close_all"},"全部关闭"),(null==e?void 0:e.tmp)&&d.createElement(N.Item,{key:"keep_open"},"保持打开状态"));return d.createElement("div",{className:f("window-container",t)},r?d.createElement(d.Fragment,null,d.createElement("div",{className:"window-top-container"},d.createElement("span",{className:"hidden"},JSON.stringify(n.tabs.map((e=>e.key)))),d.createElement(Ui,{titleRender:e=>d.createElement($,null,(()=>o(e))),showCloseIcon:e=>!(null==e?void 0:e.changed),className:"tab-list",options:n.tabs,activeKey:n.uiSetting.curTabKey,onChangeTab:n.changeTab,onCloseTab:(e,t)=>{n.closeTab(e)},renderRightMenu:s}),d.createElement("div",{className:"right-operations "},d.createElement(x,{key:"more",trigger:["contextMenu","click"],overlay:s()},d.createElement("div",{className:"operation-bar"},d.createElement(_e,{className:"icon",type:"more"}))))),d.createElement("div",{className:"window-content-container"},d.createElement(Xe,{allowResize:!n.uiSetting.windowFooterFull,primary:"second",pane1Style:{minHeight:"0px",maxHeight:"calc(100% - 1px)"},size:(a=r,!n.uiSetting.windowFooterVsible||(e=>{let t=!1;return"datasource"!==Di(e.type)&&"trash"!==e.menu&&"component"!==e.menu&&"executor"!==Di(e.type)||(t=!0),t})(a)?0:n.uiSetting.windowFooterFull?"100%":n.uiSetting.windowFooterSplitSize),split:"horizontal",onChange:n.changeWindowFooterSplitSize,minSize:150},d.createElement(Ze.exports.AliveScope,null,(e=>{const t=e.type,r=n.uiSetting.theme,o=i.workspaceData.id;return["development","query","trash","history","document"].includes(e.menu)&&!["dep_kanban","file","jar","function"].includes(t)?d.createElement(Ze.exports.KeepAlive,{id:e.key},d.createElement(MAe,{windowTab:e,workspaceId:o,theme:r})):"dep_kanban"===t?d.createElement(Ze.exports.KeepAlive,{id:e.key},d.createElement(XU,{windowTab:e,bizId:e.id,workspaceId:o,theme:r})):"周期作业"===t?d.createElement(Ze.exports.KeepAlive,{id:e.key},d.createElement(AAe,{windowTab:e,workspaceId:o,theme:r})):"datasource"===Di(t)?d.createElement(Ze.exports.KeepAlive,{id:e.key},d.createElement(Gi,{windowTab:e,workspaceId:o,theme:r})):"component"===e.menu?d.createElement(Ze.exports.KeepAlive,{id:e.key},d.createElement(kWe,{windowTab:e,workspaceId:o,theme:r})):"executor"===Di(t)?d.createElement(Ze.exports.KeepAlive,{id:e.key},d.createElement(LWe,{windowTab:e,workspaceId:o,theme:r})):d.createElement("div",{className:"p-20"}," ",`${e.label}[${null==e?void 0:e.type}]`,"页面待开发")})(r)),d.createElement("div",{className:"window-bottom-container"},d.createElement(Ze.exports.AliveScope,null,(e=>"query"===e.menu||"development"===e.menu||"operation"===e.menu||"document"===e.menu?d.createElement(Ze.exports.KeepAlive,{id:e.key},d.createElement(xWe,{windowTab:e})):d.createElement(d.Fragment,null))(r)))))):d.createElement("div",{className:"empty-container"},d.createElement(_e,{className:"logo",type:"bigdata"})));var a})),NWe={},IWe=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)),TWe=new RegExp("%[a-f0-9]{2}","gi"),MWe=new RegExp("(%[a-f0-9]{2})+","gi");function AWe(e,t){try{return decodeURIComponent(e.join(""))}catch(r){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],AWe(n),AWe(i))}function OWe(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(TWe),n=1;n<t.length;n++)t=(e=AWe(t,n).join("")).match(TWe);return e}}var RWe=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var n={"%FE%FF":"��","%FF%FE":"��"},i=MWe.exec(e);i;){try{n[i[0]]=decodeURIComponent(i[0])}catch(t){var r=OWe(i[0]);r!==i[0]&&(n[i[0]]=r)}i=MWe.exec(e)}n["%C2"]="�";for(var o=Object.keys(n),s=0;s<o.length;s++){var a=o[s];e=e.replace(new RegExp(a,"g"),n[a])}return e}(e)}},PWe=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]},FWe=function(e,t){for(var n={},i=Object.keys(e),r=Array.isArray(t),o=0;o<i.length;o++){var s=i[o],a=e[s];(r?-1!==t.indexOf(s):t(s,a,e))&&(n[s]=a)}return n};!function(e){const t=IWe,n=RWe,i=PWe,r=FWe,o=Symbol("encodeFragmentIdentifier");function s(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(e,n){return n.encode?n.strict?t(e):encodeURIComponent(e):e}function l(e,t){return t.decode?n(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function u(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function h(e){const t=(e=u(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function d(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function f(e,t){s((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"colon-list-separator":return(e,n,i)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const r="string"==typeof n&&n.includes(e.arrayFormatSeparator),o="string"==typeof n&&!r&&l(n,e).includes(e.arrayFormatSeparator);n=o?l(n,e):n;const s=r||o?n.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===n?n:l(n,e);i[t]=s};case"bracket-separator":return(t,n,i)=>{const r=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!r)return void(i[t]=n?l(n,e):n);const o=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>l(t,e)));void 0!==i[t]?i[t]=[].concat(i[t],o):i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const o of e.split("&")){if(""===o)continue;let[e,s]=i(t.decode?o.replace(/\+/g," "):o,"=");s=void 0===s?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?s:l(s,t),n(l(e,t),s,r)}for(const i of Object.keys(r)){const e=r[i];if("object"==typeof e&&null!==e)for(const n of Object.keys(e))e[n]=d(e[n],t);else r[i]=d(e,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=c(n):e[t]=n,e}),Object.create(null))}e.extract=h,e.parse=f,e.stringify=(e,t)=>{if(!e)return"";s((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],i=function(e){switch(e.arrayFormat){case"index":return t=>(n,i)=>{const r=n.length;return void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[a(t,e),"[",r,"]"].join("")]:[...n,[a(t,e),"[",a(r,e),"]=",a(i,e)].join("")]};case"bracket":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[a(t,e),"[]"].join("")]:[...n,[a(t,e),"[]=",a(i,e)].join("")];case"colon-list-separator":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[a(t,e),":list="].join("")]:[...n,[a(t,e),":list=",a(i,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(i,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?i:(r=null===r?"":r,0===i.length?[[a(n,e),t,a(r,e)].join("")]:[[i,a(r,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,a(t,e)]:[...n,[a(t,e),"=",a(i,e)].join("")]}}(t),r={};for(const s of Object.keys(e))n(s)||(r[s]=e[s]);const o=Object.keys(r);return!1!==t.sort&&o.sort(t.sort),o.map((n=>{const r=e[n];return void 0===r?"":null===r?a(n,t):Array.isArray(r)?0===r.length&&"bracket-separator"===t.arrayFormat?a(n,t)+"[]":r.reduce(i(n),[]).join("&"):a(n,t)+"="+a(r,t)})).filter((e=>e.length>0)).join("&")},e.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,r]=i(e,"#");return Object.assign({url:n.split("?")[0]||"",query:f(h(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:l(r,t)}:{})},e.stringifyUrl=(t,n)=>{n=Object.assign({encode:!0,strict:!0,[o]:!0},n);const i=u(t.url).split("?")[0]||"",r=e.extract(t.url),s=e.parse(r,{sort:!1}),l=Object.assign(s,t.query);let c=e.stringify(l,n);c&&(c=`?${c}`);let h=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(t.url);return t.fragmentIdentifier&&(h=`#${n[o]?a(t.fragmentIdentifier,n):t.fragmentIdentifier}`),`${i}${c}${h}`},e.pick=(t,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0,[o]:!1},i);const{url:s,query:a,fragmentIdentifier:l}=e.parseUrl(t,i);return e.stringifyUrl({url:s,query:r(a,n),fragmentIdentifier:l},i)},e.exclude=(t,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return e.pick(t,r,i)}}(NWe);var BWe=NWe,WWe=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[e,t]=qn("___menu","development"),[n,i]=qn("__split",320),[r,o]=h.exports.useState("development"),s=Y(),a=X(),{uiStore:l,dataStore:c}=be("BenchStore"),u=h.exports.useRef(e),f=Ce[r],[g,p]=h.exports.useState();ni("ctrl.`",(e=>{l.toggleWindowFooterVisible()})),h.exports.useEffect((()=>{u.current=e})),h.exports.useEffect((()=>{p(void 0);const e=BWe.parse(s.search);if(e.workspace){const t=c.workspaceData.id;c.fetchWorkspace(e.workspace).then((e=>{p(e),t!==e.id&&0!==t&&(localStorage.clear(),l.closeAllTabs())}))}else a.push("/workspace");Z((()=>{""!==u.current&&l.getTab(l.uiSetting.curTabKey)}))}),[]),h.exports.useEffect((()=>{""!==e&&o(e)}),[e]),h.exports.useEffect((()=>(document.oncontextmenu=function(e){return!1},()=>{})));return d.createElement(d.Fragment,null,d.createElement("div",{className:"databench-container"},g&&d.createElement("div",{className:"layout"},d.createElement("div",{className:"center"},d.createElement(ke,{activeMenu:e,chooseMenu:n=>{t(e===n?"":n)},className:"menus"}),d.createElement("div",{className:"center-main"},d.createElement(Xe,{pane2Style:{minWidth:"0px"},split:"vertical",size:""===e?0:n,minSize:240,maxSize:420,onChange:e=>i(e)},d.createElement(Vi,{className:"module",moduleName:e}),d.createElement(DWe,{className:"window",menu:f})))),d.createElement(we,{className:"footer"}))))}},Symbol.toStringTag,{value:"Module"}));export{Xye as M,Kye as R,Zye as U,Yye as a,Jye as e,WWe as i,e_e as l,d_e as t};
//# sourceMappingURL=index.9266bdc9.js.map
